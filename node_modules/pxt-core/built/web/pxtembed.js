/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved. 
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0  
 
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, 
MERCHANTABLITY OR NON-INFRINGEMENT. 
 
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
"use strict";var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts;!function(e){!function(e){e[e.Unknown=0]="Unknown",e[e.EndOfFileToken=1]="EndOfFileToken",e[e.SingleLineCommentTrivia=2]="SingleLineCommentTrivia",e[e.MultiLineCommentTrivia=3]="MultiLineCommentTrivia",e[e.NewLineTrivia=4]="NewLineTrivia",e[e.WhitespaceTrivia=5]="WhitespaceTrivia",e[e.ShebangTrivia=6]="ShebangTrivia",e[e.ConflictMarkerTrivia=7]="ConflictMarkerTrivia",e[e.NumericLiteral=8]="NumericLiteral",e[e.StringLiteral=9]="StringLiteral",e[e.JsxText=10]="JsxText",e[e.JsxTextAllWhiteSpaces=11]="JsxTextAllWhiteSpaces",e[e.RegularExpressionLiteral=12]="RegularExpressionLiteral",e[e.NoSubstitutionTemplateLiteral=13]="NoSubstitutionTemplateLiteral",e[e.TemplateHead=14]="TemplateHead",e[e.TemplateMiddle=15]="TemplateMiddle",e[e.TemplateTail=16]="TemplateTail",e[e.OpenBraceToken=17]="OpenBraceToken",e[e.CloseBraceToken=18]="CloseBraceToken",e[e.OpenParenToken=19]="OpenParenToken",e[e.CloseParenToken=20]="CloseParenToken",e[e.OpenBracketToken=21]="OpenBracketToken",e[e.CloseBracketToken=22]="CloseBracketToken",e[e.DotToken=23]="DotToken",e[e.DotDotDotToken=24]="DotDotDotToken",e[e.SemicolonToken=25]="SemicolonToken",e[e.CommaToken=26]="CommaToken",e[e.LessThanToken=27]="LessThanToken",e[e.LessThanSlashToken=28]="LessThanSlashToken",e[e.GreaterThanToken=29]="GreaterThanToken",e[e.LessThanEqualsToken=30]="LessThanEqualsToken",e[e.GreaterThanEqualsToken=31]="GreaterThanEqualsToken",e[e.EqualsEqualsToken=32]="EqualsEqualsToken",e[e.ExclamationEqualsToken=33]="ExclamationEqualsToken",e[e.EqualsEqualsEqualsToken=34]="EqualsEqualsEqualsToken",e[e.ExclamationEqualsEqualsToken=35]="ExclamationEqualsEqualsToken",e[e.EqualsGreaterThanToken=36]="EqualsGreaterThanToken",e[e.PlusToken=37]="PlusToken",e[e.MinusToken=38]="MinusToken",e[e.AsteriskToken=39]="AsteriskToken",e[e.AsteriskAsteriskToken=40]="AsteriskAsteriskToken",e[e.SlashToken=41]="SlashToken",e[e.PercentToken=42]="PercentToken",e[e.PlusPlusToken=43]="PlusPlusToken",e[e.MinusMinusToken=44]="MinusMinusToken",e[e.LessThanLessThanToken=45]="LessThanLessThanToken",e[e.GreaterThanGreaterThanToken=46]="GreaterThanGreaterThanToken",e[e.GreaterThanGreaterThanGreaterThanToken=47]="GreaterThanGreaterThanGreaterThanToken",e[e.AmpersandToken=48]="AmpersandToken",e[e.BarToken=49]="BarToken",e[e.CaretToken=50]="CaretToken",e[e.ExclamationToken=51]="ExclamationToken",e[e.TildeToken=52]="TildeToken",e[e.AmpersandAmpersandToken=53]="AmpersandAmpersandToken",e[e.BarBarToken=54]="BarBarToken",e[e.QuestionToken=55]="QuestionToken",e[e.ColonToken=56]="ColonToken",e[e.AtToken=57]="AtToken",e[e.EqualsToken=58]="EqualsToken",e[e.PlusEqualsToken=59]="PlusEqualsToken",e[e.MinusEqualsToken=60]="MinusEqualsToken",e[e.AsteriskEqualsToken=61]="AsteriskEqualsToken",e[e.AsteriskAsteriskEqualsToken=62]="AsteriskAsteriskEqualsToken",e[e.SlashEqualsToken=63]="SlashEqualsToken",e[e.PercentEqualsToken=64]="PercentEqualsToken",e[e.LessThanLessThanEqualsToken=65]="LessThanLessThanEqualsToken",e[e.GreaterThanGreaterThanEqualsToken=66]="GreaterThanGreaterThanEqualsToken",e[e.GreaterThanGreaterThanGreaterThanEqualsToken=67]="GreaterThanGreaterThanGreaterThanEqualsToken",e[e.AmpersandEqualsToken=68]="AmpersandEqualsToken",e[e.BarEqualsToken=69]="BarEqualsToken",e[e.CaretEqualsToken=70]="CaretEqualsToken",e[e.Identifier=71]="Identifier",e[e.BreakKeyword=72]="BreakKeyword",e[e.CaseKeyword=73]="CaseKeyword",e[e.CatchKeyword=74]="CatchKeyword",e[e.ClassKeyword=75]="ClassKeyword",e[e.ConstKeyword=76]="ConstKeyword",e[e.ContinueKeyword=77]="ContinueKeyword",e[e.DebuggerKeyword=78]="DebuggerKeyword",e[e.DefaultKeyword=79]="DefaultKeyword",e[e.DeleteKeyword=80]="DeleteKeyword",e[e.DoKeyword=81]="DoKeyword",e[e.ElseKeyword=82]="ElseKeyword",e[e.EnumKeyword=83]="EnumKeyword",e[e.ExportKeyword=84]="ExportKeyword",e[e.ExtendsKeyword=85]="ExtendsKeyword",e[e.FalseKeyword=86]="FalseKeyword",e[e.FinallyKeyword=87]="FinallyKeyword",e[e.ForKeyword=88]="ForKeyword",e[e.FunctionKeyword=89]="FunctionKeyword",e[e.IfKeyword=90]="IfKeyword",e[e.ImportKeyword=91]="ImportKeyword",e[e.InKeyword=92]="InKeyword",e[e.InstanceOfKeyword=93]="InstanceOfKeyword",e[e.NewKeyword=94]="NewKeyword",e[e.NullKeyword=95]="NullKeyword",e[e.ReturnKeyword=96]="ReturnKeyword",e[e.SuperKeyword=97]="SuperKeyword",e[e.SwitchKeyword=98]="SwitchKeyword",e[e.ThisKeyword=99]="ThisKeyword",e[e.ThrowKeyword=100]="ThrowKeyword",e[e.TrueKeyword=101]="TrueKeyword",e[e.TryKeyword=102]="TryKeyword",e[e.TypeOfKeyword=103]="TypeOfKeyword",e[e.VarKeyword=104]="VarKeyword",e[e.VoidKeyword=105]="VoidKeyword",e[e.WhileKeyword=106]="WhileKeyword",e[e.WithKeyword=107]="WithKeyword",e[e.ImplementsKeyword=108]="ImplementsKeyword",e[e.InterfaceKeyword=109]="InterfaceKeyword",e[e.LetKeyword=110]="LetKeyword",e[e.PackageKeyword=111]="PackageKeyword",e[e.PrivateKeyword=112]="PrivateKeyword",e[e.ProtectedKeyword=113]="ProtectedKeyword",e[e.PublicKeyword=114]="PublicKeyword",e[e.StaticKeyword=115]="StaticKeyword",e[e.YieldKeyword=116]="YieldKeyword",e[e.AbstractKeyword=117]="AbstractKeyword",e[e.AsKeyword=118]="AsKeyword",e[e.AnyKeyword=119]="AnyKeyword",e[e.AsyncKeyword=120]="AsyncKeyword",e[e.AwaitKeyword=121]="AwaitKeyword",e[e.BooleanKeyword=122]="BooleanKeyword",e[e.ConstructorKeyword=123]="ConstructorKeyword",e[e.DeclareKeyword=124]="DeclareKeyword",e[e.GetKeyword=125]="GetKeyword",e[e.IsKeyword=126]="IsKeyword",e[e.KeyOfKeyword=127]="KeyOfKeyword",e[e.ModuleKeyword=128]="ModuleKeyword",e[e.NamespaceKeyword=129]="NamespaceKeyword",e[e.NeverKeyword=130]="NeverKeyword",e[e.ReadonlyKeyword=131]="ReadonlyKeyword",e[e.RequireKeyword=132]="RequireKeyword",e[e.NumberKeyword=133]="NumberKeyword",e[e.ObjectKeyword=134]="ObjectKeyword",e[e.SetKeyword=135]="SetKeyword",e[e.StringKeyword=136]="StringKeyword",e[e.SymbolKeyword=137]="SymbolKeyword",e[e.TypeKeyword=138]="TypeKeyword",e[e.UndefinedKeyword=139]="UndefinedKeyword",e[e.FromKeyword=140]="FromKeyword",e[e.GlobalKeyword=141]="GlobalKeyword",e[e.OfKeyword=142]="OfKeyword",e[e.QualifiedName=143]="QualifiedName",e[e.ComputedPropertyName=144]="ComputedPropertyName",e[e.TypeParameter=145]="TypeParameter",e[e.Parameter=146]="Parameter",e[e.Decorator=147]="Decorator",e[e.PropertySignature=148]="PropertySignature",e[e.PropertyDeclaration=149]="PropertyDeclaration",e[e.MethodSignature=150]="MethodSignature",e[e.MethodDeclaration=151]="MethodDeclaration",e[e.Constructor=152]="Constructor",e[e.GetAccessor=153]="GetAccessor",e[e.SetAccessor=154]="SetAccessor",e[e.CallSignature=155]="CallSignature",e[e.ConstructSignature=156]="ConstructSignature",e[e.IndexSignature=157]="IndexSignature",e[e.TypePredicate=158]="TypePredicate",e[e.TypeReference=159]="TypeReference",e[e.FunctionType=160]="FunctionType",e[e.ConstructorType=161]="ConstructorType",e[e.TypeQuery=162]="TypeQuery",e[e.TypeLiteral=163]="TypeLiteral",e[e.ArrayType=164]="ArrayType",e[e.TupleType=165]="TupleType",e[e.UnionType=166]="UnionType",e[e.IntersectionType=167]="IntersectionType",e[e.ParenthesizedType=168]="ParenthesizedType",e[e.ThisType=169]="ThisType",e[e.TypeOperator=170]="TypeOperator",e[e.IndexedAccessType=171]="IndexedAccessType",e[e.MappedType=172]="MappedType",e[e.LiteralType=173]="LiteralType",e[e.ObjectBindingPattern=174]="ObjectBindingPattern",e[e.ArrayBindingPattern=175]="ArrayBindingPattern",e[e.BindingElement=176]="BindingElement",e[e.ArrayLiteralExpression=177]="ArrayLiteralExpression",e[e.ObjectLiteralExpression=178]="ObjectLiteralExpression",e[e.PropertyAccessExpression=179]="PropertyAccessExpression",e[e.ElementAccessExpression=180]="ElementAccessExpression",e[e.CallExpression=181]="CallExpression",e[e.NewExpression=182]="NewExpression",e[e.TaggedTemplateExpression=183]="TaggedTemplateExpression",e[e.TypeAssertionExpression=184]="TypeAssertionExpression",e[e.ParenthesizedExpression=185]="ParenthesizedExpression",e[e.FunctionExpression=186]="FunctionExpression",e[e.ArrowFunction=187]="ArrowFunction",e[e.DeleteExpression=188]="DeleteExpression",e[e.TypeOfExpression=189]="TypeOfExpression",e[e.VoidExpression=190]="VoidExpression",e[e.AwaitExpression=191]="AwaitExpression",e[e.PrefixUnaryExpression=192]="PrefixUnaryExpression",e[e.PostfixUnaryExpression=193]="PostfixUnaryExpression",e[e.BinaryExpression=194]="BinaryExpression",e[e.ConditionalExpression=195]="ConditionalExpression",e[e.TemplateExpression=196]="TemplateExpression",e[e.YieldExpression=197]="YieldExpression",e[e.SpreadElement=198]="SpreadElement",e[e.ClassExpression=199]="ClassExpression",e[e.OmittedExpression=200]="OmittedExpression",e[e.ExpressionWithTypeArguments=201]="ExpressionWithTypeArguments",e[e.AsExpression=202]="AsExpression",e[e.NonNullExpression=203]="NonNullExpression",e[e.MetaProperty=204]="MetaProperty",e[e.TemplateSpan=205]="TemplateSpan",e[e.SemicolonClassElement=206]="SemicolonClassElement",e[e.Block=207]="Block",e[e.VariableStatement=208]="VariableStatement",e[e.EmptyStatement=209]="EmptyStatement",e[e.ExpressionStatement=210]="ExpressionStatement",e[e.IfStatement=211]="IfStatement",e[e.DoStatement=212]="DoStatement",e[e.WhileStatement=213]="WhileStatement",e[e.ForStatement=214]="ForStatement",e[e.ForInStatement=215]="ForInStatement",e[e.ForOfStatement=216]="ForOfStatement",e[e.ContinueStatement=217]="ContinueStatement",e[e.BreakStatement=218]="BreakStatement",e[e.ReturnStatement=219]="ReturnStatement",e[e.WithStatement=220]="WithStatement",e[e.SwitchStatement=221]="SwitchStatement",e[e.LabeledStatement=222]="LabeledStatement",e[e.ThrowStatement=223]="ThrowStatement",e[e.TryStatement=224]="TryStatement",e[e.DebuggerStatement=225]="DebuggerStatement",e[e.VariableDeclaration=226]="VariableDeclaration",e[e.VariableDeclarationList=227]="VariableDeclarationList",e[e.FunctionDeclaration=228]="FunctionDeclaration",e[e.ClassDeclaration=229]="ClassDeclaration",e[e.InterfaceDeclaration=230]="InterfaceDeclaration",e[e.TypeAliasDeclaration=231]="TypeAliasDeclaration",e[e.EnumDeclaration=232]="EnumDeclaration",e[e.ModuleDeclaration=233]="ModuleDeclaration",e[e.ModuleBlock=234]="ModuleBlock",e[e.CaseBlock=235]="CaseBlock",e[e.NamespaceExportDeclaration=236]="NamespaceExportDeclaration",e[e.ImportEqualsDeclaration=237]="ImportEqualsDeclaration",e[e.ImportDeclaration=238]="ImportDeclaration",e[e.ImportClause=239]="ImportClause",e[e.NamespaceImport=240]="NamespaceImport",e[e.NamedImports=241]="NamedImports",e[e.ImportSpecifier=242]="ImportSpecifier",e[e.ExportAssignment=243]="ExportAssignment",e[e.ExportDeclaration=244]="ExportDeclaration",e[e.NamedExports=245]="NamedExports",e[e.ExportSpecifier=246]="ExportSpecifier",e[e.MissingDeclaration=247]="MissingDeclaration",e[e.ExternalModuleReference=248]="ExternalModuleReference",e[e.JsxElement=249]="JsxElement",e[e.JsxSelfClosingElement=250]="JsxSelfClosingElement",e[e.JsxOpeningElement=251]="JsxOpeningElement",e[e.JsxClosingElement=252]="JsxClosingElement",e[e.JsxAttribute=253]="JsxAttribute",e[e.JsxAttributes=254]="JsxAttributes",e[e.JsxSpreadAttribute=255]="JsxSpreadAttribute",e[e.JsxExpression=256]="JsxExpression",e[e.CaseClause=257]="CaseClause",e[e.DefaultClause=258]="DefaultClause",e[e.HeritageClause=259]="HeritageClause",e[e.CatchClause=260]="CatchClause",e[e.PropertyAssignment=261]="PropertyAssignment",e[e.ShorthandPropertyAssignment=262]="ShorthandPropertyAssignment",e[e.SpreadAssignment=263]="SpreadAssignment",e[e.EnumMember=264]="EnumMember",e[e.SourceFile=265]="SourceFile",e[e.Bundle=266]="Bundle",e[e.JSDocTypeExpression=267]="JSDocTypeExpression",e[e.JSDocAllType=268]="JSDocAllType",e[e.JSDocUnknownType=269]="JSDocUnknownType",e[e.JSDocNullableType=270]="JSDocNullableType",e[e.JSDocNonNullableType=271]="JSDocNonNullableType",e[e.JSDocOptionalType=272]="JSDocOptionalType",e[e.JSDocFunctionType=273]="JSDocFunctionType",e[e.JSDocVariadicType=274]="JSDocVariadicType",e[e.JSDocComment=275]="JSDocComment",e[e.JSDocTag=276]="JSDocTag",e[e.JSDocAugmentsTag=277]="JSDocAugmentsTag",e[e.JSDocClassTag=278]="JSDocClassTag",e[e.JSDocParameterTag=279]="JSDocParameterTag",e[e.JSDocReturnTag=280]="JSDocReturnTag",e[e.JSDocTypeTag=281]="JSDocTypeTag",e[e.JSDocTemplateTag=282]="JSDocTemplateTag",e[e.JSDocTypedefTag=283]="JSDocTypedefTag",e[e.JSDocPropertyTag=284]="JSDocPropertyTag",e[e.JSDocTypeLiteral=285]="JSDocTypeLiteral",e[e.SyntaxList=286]="SyntaxList",e[e.NotEmittedStatement=287]="NotEmittedStatement",e[e.PartiallyEmittedExpression=288]="PartiallyEmittedExpression",e[e.CommaListExpression=289]="CommaListExpression",e[e.MergeDeclarationMarker=290]="MergeDeclarationMarker",e[e.EndOfDeclarationMarker=291]="EndOfDeclarationMarker",e[e.Count=292]="Count",e[e.FirstAssignment=58]="FirstAssignment",e[e.LastAssignment=70]="LastAssignment",e[e.FirstCompoundAssignment=59]="FirstCompoundAssignment",e[e.LastCompoundAssignment=70]="LastCompoundAssignment",e[e.FirstReservedWord=72]="FirstReservedWord",e[e.LastReservedWord=107]="LastReservedWord",e[e.FirstKeyword=72]="FirstKeyword",e[e.LastKeyword=142]="LastKeyword",e[e.FirstFutureReservedWord=108]="FirstFutureReservedWord",e[e.LastFutureReservedWord=116]="LastFutureReservedWord",e[e.FirstTypeNode=158]="FirstTypeNode",e[e.LastTypeNode=173]="LastTypeNode",e[e.FirstPunctuation=17]="FirstPunctuation",e[e.LastPunctuation=70]="LastPunctuation",e[e.FirstToken=0]="FirstToken",e[e.LastToken=142]="LastToken",e[e.FirstTriviaToken=2]="FirstTriviaToken",e[e.LastTriviaToken=7]="LastTriviaToken",e[e.FirstLiteralToken=8]="FirstLiteralToken",e[e.LastLiteralToken=13]="LastLiteralToken",e[e.FirstTemplateToken=13]="FirstTemplateToken",e[e.LastTemplateToken=16]="LastTemplateToken",e[e.FirstBinaryOperator=27]="FirstBinaryOperator",e[e.LastBinaryOperator=70]="LastBinaryOperator",e[e.FirstNode=143]="FirstNode",e[e.FirstJSDocNode=267]="FirstJSDocNode",e[e.LastJSDocNode=285]="LastJSDocNode",e[e.FirstJSDocTagNode=276]="FirstJSDocTagNode",e[e.LastJSDocTagNode=285]="LastJSDocTagNode"}(e.SyntaxKind||(e.SyntaxKind={})),function(e){e[e.None=0]="None",e[e.Let=1]="Let",e[e.Const=2]="Const",e[e.NestedNamespace=4]="NestedNamespace",e[e.Synthesized=8]="Synthesized",e[e.Namespace=16]="Namespace",e[e.ExportContext=32]="ExportContext",e[e.ContainsThis=64]="ContainsThis",e[e.HasImplicitReturn=128]="HasImplicitReturn",e[e.HasExplicitReturn=256]="HasExplicitReturn",e[e.GlobalAugmentation=512]="GlobalAugmentation",e[e.HasAsyncFunctions=1024]="HasAsyncFunctions",e[e.DisallowInContext=2048]="DisallowInContext",e[e.YieldContext=4096]="YieldContext",e[e.DecoratorContext=8192]="DecoratorContext",e[e.AwaitContext=16384]="AwaitContext",e[e.ThisNodeHasError=32768]="ThisNodeHasError",e[e.JavaScriptFile=65536]="JavaScriptFile",e[e.ThisNodeOrAnySubNodesHasError=131072]="ThisNodeOrAnySubNodesHasError",e[e.HasAggregatedChildData=262144]="HasAggregatedChildData",e[e.PossiblyContainsDynamicImport=524288]="PossiblyContainsDynamicImport",e[e.JSDoc=1048576]="JSDoc",e[e.BlockScoped=3]="BlockScoped",e[e.ReachabilityCheckFlags=384]="ReachabilityCheckFlags",e[e.ReachabilityAndEmitFlags=1408]="ReachabilityAndEmitFlags",e[e.ContextFlags=96256]="ContextFlags",e[e.TypeExcludesFlags=20480]="TypeExcludesFlags"}(e.NodeFlags||(e.NodeFlags={})),function(e){e[e.None=0]="None",e[e.Export=1]="Export",e[e.Ambient=2]="Ambient",e[e.Public=4]="Public",e[e.Private=8]="Private",e[e.Protected=16]="Protected",e[e.Static=32]="Static",e[e.Readonly=64]="Readonly",e[e.Abstract=128]="Abstract",e[e.Async=256]="Async",e[e.Default=512]="Default",e[e.Const=2048]="Const",e[e.HasComputedFlags=536870912]="HasComputedFlags",e[e.AccessibilityModifier=28]="AccessibilityModifier",e[e.ParameterPropertyModifier=92]="ParameterPropertyModifier",e[e.NonPublicAccessibilityModifier=24]="NonPublicAccessibilityModifier",e[e.TypeScriptModifier=2270]="TypeScriptModifier",e[e.ExportDefault=513]="ExportDefault"}(e.ModifierFlags||(e.ModifierFlags={})),function(e){e[e.None=0]="None",e[e.IntrinsicNamedElement=1]="IntrinsicNamedElement",e[e.IntrinsicIndexedElement=2]="IntrinsicIndexedElement",e[e.IntrinsicElement=3]="IntrinsicElement"}(e.JsxFlags||(e.JsxFlags={})),function(e){e[e.Succeeded=1]="Succeeded",e[e.Failed=2]="Failed",e[e.FailedAndReported=3]="FailedAndReported"}(e.RelationComparisonResult||(e.RelationComparisonResult={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Loop=2]="Loop",e[e.Unique=3]="Unique",e[e.Node=4]="Node"}(e.GeneratedIdentifierKind||(e.GeneratedIdentifierKind={})),function(e){e[e.None=0]="None",e[e.Scientific=2]="Scientific",e[e.Octal=4]="Octal",e[e.HexSpecifier=8]="HexSpecifier",e[e.BinarySpecifier=16]="BinarySpecifier",e[e.OctalSpecifier=32]="OctalSpecifier",e[e.BinaryOrOctalSpecifier=48]="BinaryOrOctalSpecifier"}(e.NumericLiteralFlags||(e.NumericLiteralFlags={})),function(e){e[e.Unreachable=1]="Unreachable",e[e.Start=2]="Start",e[e.BranchLabel=4]="BranchLabel",e[e.LoopLabel=8]="LoopLabel",e[e.Assignment=16]="Assignment",e[e.TrueCondition=32]="TrueCondition",e[e.FalseCondition=64]="FalseCondition",e[e.SwitchClause=128]="SwitchClause",e[e.ArrayMutation=256]="ArrayMutation",e[e.Referenced=512]="Referenced",e[e.Shared=1024]="Shared",e[e.PreFinally=2048]="PreFinally",e[e.AfterFinally=4096]="AfterFinally",e[e.Label=12]="Label",e[e.Condition=96]="Condition"}(e.FlowFlags||(e.FlowFlags={}));var t=function(){};e.OperationCanceledException=t,function(e){e[e.Not=0]="Not",e[e.SafeModules=1]="SafeModules",e[e.Completely=2]="Completely"}(e.StructureIsReused||(e.StructureIsReused={})),function(e){e[e.Success=0]="Success",e[e.DiagnosticsPresent_OutputsSkipped=1]="DiagnosticsPresent_OutputsSkipped",e[e.DiagnosticsPresent_OutputsGenerated=2]="DiagnosticsPresent_OutputsGenerated"}(e.ExitStatus||(e.ExitStatus={})),function(e){e[e.None=0]="None",e[e.NoTruncation=1]="NoTruncation",e[e.WriteArrayAsGenericType=2]="WriteArrayAsGenericType",e[e.WriteTypeArgumentsOfSignature=32]="WriteTypeArgumentsOfSignature",e[e.UseFullyQualifiedType=64]="UseFullyQualifiedType",e[e.SuppressAnyReturnType=256]="SuppressAnyReturnType",e[e.WriteTypeParametersInQualifiedName=512]="WriteTypeParametersInQualifiedName",e[e.AllowThisInObjectLiteral=1024]="AllowThisInObjectLiteral",e[e.AllowQualifedNameInPlaceOfIdentifier=2048]="AllowQualifedNameInPlaceOfIdentifier",e[e.AllowAnonymousIdentifier=8192]="AllowAnonymousIdentifier",e[e.AllowEmptyUnionOrIntersection=16384]="AllowEmptyUnionOrIntersection",e[e.AllowEmptyTuple=32768]="AllowEmptyTuple",e[e.IgnoreErrors=60416]="IgnoreErrors",e[e.InObjectTypeLiteral=1048576]="InObjectTypeLiteral",e[e.InTypeAlias=8388608]="InTypeAlias"}(e.NodeBuilderFlags||(e.NodeBuilderFlags={})),function(e){e[e.None=0]="None",e[e.WriteArrayAsGenericType=1]="WriteArrayAsGenericType",e[e.UseTypeOfFunction=4]="UseTypeOfFunction",e[e.NoTruncation=8]="NoTruncation",e[e.WriteArrowStyleSignature=16]="WriteArrowStyleSignature",e[e.WriteOwnNameForAnyLike=32]="WriteOwnNameForAnyLike",e[e.WriteTypeArgumentsOfSignature=64]="WriteTypeArgumentsOfSignature",e[e.InElementType=128]="InElementType",e[e.UseFullyQualifiedType=256]="UseFullyQualifiedType",e[e.InFirstTypeArgument=512]="InFirstTypeArgument",e[e.InTypeAlias=1024]="InTypeAlias",e[e.SuppressAnyReturnType=4096]="SuppressAnyReturnType",e[e.AddUndefined=8192]="AddUndefined",e[e.WriteClassExpressionAsTypeLiteral=16384]="WriteClassExpressionAsTypeLiteral",e[e.InArrayType=32768]="InArrayType",e[e.UseAliasDefinedOutsideCurrentScope=65536]="UseAliasDefinedOutsideCurrentScope"}(e.TypeFormatFlags||(e.TypeFormatFlags={})),function(e){e[e.None=0]="None",e[e.WriteTypeParametersOrArguments=1]="WriteTypeParametersOrArguments",e[e.UseOnlyExternalAliasing=2]="UseOnlyExternalAliasing"}(e.SymbolFormatFlags||(e.SymbolFormatFlags={})),function(e){e[e.Accessible=0]="Accessible",e[e.NotAccessible=1]="NotAccessible",e[e.CannotBeNamed=2]="CannotBeNamed"}(e.SymbolAccessibility||(e.SymbolAccessibility={})),function(e){e[e.UnionOrIntersection=0]="UnionOrIntersection",e[e.Spread=1]="Spread"}(e.SyntheticSymbolKind||(e.SyntheticSymbolKind={})),function(e){e[e.This=0]="This",e[e.Identifier=1]="Identifier"}(e.TypePredicateKind||(e.TypePredicateKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.TypeWithConstructSignatureAndValue=1]="TypeWithConstructSignatureAndValue",e[e.VoidNullableOrNeverType=2]="VoidNullableOrNeverType",e[e.NumberLikeType=3]="NumberLikeType",e[e.StringLikeType=4]="StringLikeType",e[e.BooleanType=5]="BooleanType",e[e.ArrayLikeType=6]="ArrayLikeType",e[e.ESSymbolType=7]="ESSymbolType",e[e.Promise=8]="Promise",e[e.TypeWithCallSignature=9]="TypeWithCallSignature",e[e.ObjectType=10]="ObjectType"}(e.TypeReferenceSerializationKind||(e.TypeReferenceSerializationKind={})),function(e){e[e.None=0]="None",e[e.FunctionScopedVariable=1]="FunctionScopedVariable",e[e.BlockScopedVariable=2]="BlockScopedVariable",e[e.Property=4]="Property",e[e.EnumMember=8]="EnumMember",e[e.Function=16]="Function",e[e.Class=32]="Class",e[e.Interface=64]="Interface",e[e.ConstEnum=128]="ConstEnum",e[e.RegularEnum=256]="RegularEnum",e[e.ValueModule=512]="ValueModule",e[e.NamespaceModule=1024]="NamespaceModule",e[e.TypeLiteral=2048]="TypeLiteral",e[e.ObjectLiteral=4096]="ObjectLiteral",e[e.Method=8192]="Method",e[e.Constructor=16384]="Constructor",e[e.GetAccessor=32768]="GetAccessor",e[e.SetAccessor=65536]="SetAccessor",e[e.Signature=131072]="Signature",e[e.TypeParameter=262144]="TypeParameter",e[e.TypeAlias=524288]="TypeAlias",e[e.ExportValue=1048576]="ExportValue",e[e.Alias=2097152]="Alias",e[e.Prototype=4194304]="Prototype",e[e.ExportStar=8388608]="ExportStar",e[e.Optional=16777216]="Optional",e[e.Transient=33554432]="Transient",e[e.Enum=384]="Enum",e[e.Variable=3]="Variable",e[e.Value=107455]="Value",e[e.Type=793064]="Type",e[e.Namespace=1920]="Namespace",e[e.Module=1536]="Module",e[e.Accessor=98304]="Accessor",e[e.FunctionScopedVariableExcludes=107454]="FunctionScopedVariableExcludes",e[e.BlockScopedVariableExcludes=107455]="BlockScopedVariableExcludes",e[e.ParameterExcludes=107455]="ParameterExcludes",e[e.PropertyExcludes=0]="PropertyExcludes",e[e.EnumMemberExcludes=900095]="EnumMemberExcludes",e[e.FunctionExcludes=106927]="FunctionExcludes",e[e.ClassExcludes=899519]="ClassExcludes",e[e.InterfaceExcludes=792968]="InterfaceExcludes",e[e.RegularEnumExcludes=899327]="RegularEnumExcludes",e[e.ConstEnumExcludes=899967]="ConstEnumExcludes",e[e.ValueModuleExcludes=106639]="ValueModuleExcludes",e[e.NamespaceModuleExcludes=0]="NamespaceModuleExcludes",e[e.MethodExcludes=99263]="MethodExcludes",e[e.GetAccessorExcludes=41919]="GetAccessorExcludes",e[e.SetAccessorExcludes=74687]="SetAccessorExcludes",e[e.TypeParameterExcludes=530920]="TypeParameterExcludes",e[e.TypeAliasExcludes=793064]="TypeAliasExcludes",e[e.AliasExcludes=2097152]="AliasExcludes",e[e.ModuleMember=2623475]="ModuleMember",e[e.ExportHasLocal=944]="ExportHasLocal",e[e.HasExports=1952]="HasExports",e[e.HasMembers=6240]="HasMembers",e[e.BlockScoped=418]="BlockScoped",e[e.PropertyOrAccessor=98308]="PropertyOrAccessor",e[e.ClassMember=106500]="ClassMember",e[e.Classifiable=788448]="Classifiable"}(e.SymbolFlags||(e.SymbolFlags={})),function(e){e[e.Numeric=0]="Numeric",e[e.Literal=1]="Literal"}(e.EnumKind||(e.EnumKind={})),function(e){e[e.Instantiated=1]="Instantiated",e[e.SyntheticProperty=2]="SyntheticProperty",e[e.SyntheticMethod=4]="SyntheticMethod",e[e.Readonly=8]="Readonly",e[e.Partial=16]="Partial",e[e.HasNonUniformType=32]="HasNonUniformType",e[e.ContainsPublic=64]="ContainsPublic",e[e.ContainsProtected=128]="ContainsProtected",e[e.ContainsPrivate=256]="ContainsPrivate",e[e.ContainsStatic=512]="ContainsStatic",e[e.Synthetic=6]="Synthetic"}(e.CheckFlags||(e.CheckFlags={})),function(e){e.Call="__call",e.Constructor="__constructor",e.New="__new",e.Index="__index",e.ExportStar="__export",e.Global="__global",e.Missing="__missing",e.Type="__type",e.Object="__object",e.JSXAttributes="__jsxAttributes",e.Class="__class",e.Function="__function",e.Computed="__computed",e.Resolving="__resolving__",e.ExportEquals="export=",e.Default="default"}(e.InternalSymbolName||(e.InternalSymbolName={})),function(e){e[e.TypeChecked=1]="TypeChecked",e[e.LexicalThis=2]="LexicalThis",e[e.CaptureThis=4]="CaptureThis",e[e.CaptureNewTarget=8]="CaptureNewTarget",e[e.SuperInstance=256]="SuperInstance",e[e.SuperStatic=512]="SuperStatic",e[e.ContextChecked=1024]="ContextChecked",e[e.AsyncMethodWithSuper=2048]="AsyncMethodWithSuper",e[e.AsyncMethodWithSuperBinding=4096]="AsyncMethodWithSuperBinding",e[e.CaptureArguments=8192]="CaptureArguments",e[e.EnumValuesComputed=16384]="EnumValuesComputed",e[e.LexicalModuleMergesWithClass=32768]="LexicalModuleMergesWithClass",e[e.LoopWithCapturedBlockScopedBinding=65536]="LoopWithCapturedBlockScopedBinding",e[e.CapturedBlockScopedBinding=131072]="CapturedBlockScopedBinding",e[e.BlockScopedBindingInLoop=262144]="BlockScopedBindingInLoop",e[e.ClassWithBodyScopedClassBinding=524288]="ClassWithBodyScopedClassBinding",e[e.BodyScopedClassBinding=1048576]="BodyScopedClassBinding",e[e.NeedsLoopOutParameter=2097152]="NeedsLoopOutParameter",e[e.AssignmentsMarked=4194304]="AssignmentsMarked",e[e.ClassWithConstructorReference=8388608]="ClassWithConstructorReference",e[e.ConstructorReferenceInClass=16777216]="ConstructorReferenceInClass"}(e.NodeCheckFlags||(e.NodeCheckFlags={})),function(e){e[e.Any=1]="Any",e[e.String=2]="String",e[e.Number=4]="Number",e[e.Boolean=8]="Boolean",e[e.Enum=16]="Enum",e[e.StringLiteral=32]="StringLiteral",e[e.NumberLiteral=64]="NumberLiteral",e[e.BooleanLiteral=128]="BooleanLiteral",e[e.EnumLiteral=256]="EnumLiteral",e[e.ESSymbol=512]="ESSymbol",e[e.Void=1024]="Void",e[e.Undefined=2048]="Undefined",e[e.Null=4096]="Null",e[e.Never=8192]="Never",e[e.TypeParameter=16384]="TypeParameter",e[e.Object=32768]="Object",e[e.Union=65536]="Union",e[e.Intersection=131072]="Intersection",e[e.Index=262144]="Index",e[e.IndexedAccess=524288]="IndexedAccess",e[e.FreshLiteral=1048576]="FreshLiteral",e[e.ContainsWideningType=2097152]="ContainsWideningType",e[e.ContainsObjectLiteral=4194304]="ContainsObjectLiteral",e[e.ContainsAnyFunctionType=8388608]="ContainsAnyFunctionType",e[e.NonPrimitive=16777216]="NonPrimitive",e[e.JsxAttributes=33554432]="JsxAttributes",e[e.MarkerType=67108864]="MarkerType",e[e.Nullable=6144]="Nullable",e[e.Literal=224]="Literal",e[e.Unit=6368]="Unit",e[e.StringOrNumberLiteral=96]="StringOrNumberLiteral",e[e.DefinitelyFalsy=7392]="DefinitelyFalsy",e[e.PossiblyFalsy=7406]="PossiblyFalsy",e[e.Intrinsic=16793231]="Intrinsic",e[e.Primitive=8190]="Primitive",e[e.StringLike=262178]="StringLike",e[e.NumberLike=84]="NumberLike",e[e.BooleanLike=136]="BooleanLike",e[e.EnumLike=272]="EnumLike",e[e.UnionOrIntersection=196608]="UnionOrIntersection",e[e.StructuredType=229376]="StructuredType",e[e.StructuredOrTypeVariable=1032192]="StructuredOrTypeVariable",e[e.TypeVariable=540672]="TypeVariable",e[e.Narrowable=17810175]="Narrowable",e[e.NotUnionOrUnit=16810497]="NotUnionOrUnit",e[e.RequiresWidening=6291456]="RequiresWidening",e[e.PropagatingFlags=14680064]="PropagatingFlags"}(e.TypeFlags||(e.TypeFlags={})),function(e){e[e.Class=1]="Class",e[e.Interface=2]="Interface",e[e.Reference=4]="Reference",e[e.Tuple=8]="Tuple",e[e.Anonymous=16]="Anonymous",e[e.Mapped=32]="Mapped",e[e.Instantiated=64]="Instantiated",e[e.ObjectLiteral=128]="ObjectLiteral",e[e.EvolvingArray=256]="EvolvingArray",e[e.ObjectLiteralPatternWithComputedProperties=512]="ObjectLiteralPatternWithComputedProperties",e[e.ClassOrInterface=3]="ClassOrInterface"}(e.ObjectFlags||(e.ObjectFlags={})),function(e){e[e.Invariant=0]="Invariant",e[e.Covariant=1]="Covariant",e[e.Contravariant=2]="Contravariant",e[e.Bivariant=3]="Bivariant",e[e.Independent=4]="Independent"}(e.Variance||(e.Variance={})),function(e){e[e.Call=0]="Call",e[e.Construct=1]="Construct"}(e.SignatureKind||(e.SignatureKind={})),function(e){e[e.String=0]="String",e[e.Number=1]="Number"}(e.IndexKind||(e.IndexKind={})),function(e){e[e.Contravariant=1]="Contravariant",e[e.NakedTypeVariable=2]="NakedTypeVariable",e[e.MappedType=4]="MappedType",e[e.ReturnType=8]="ReturnType"}(e.InferencePriority||(e.InferencePriority={})),function(e){e[e.InferUnionTypes=1]="InferUnionTypes",e[e.NoDefault=2]="NoDefault",e[e.AnyDefault=4]="AnyDefault"}(e.InferenceFlags||(e.InferenceFlags={})),function(e){e[e.False=0]="False",e[e.Maybe=1]="Maybe",e[e.True=-1]="True"}(e.Ternary||(e.Ternary={})),function(e){e[e.None=0]="None",e[e.ExportsProperty=1]="ExportsProperty",e[e.ModuleExports=2]="ModuleExports",e[e.PrototypeProperty=3]="PrototypeProperty",e[e.ThisProperty=4]="ThisProperty",e[e.Property=5]="Property"}(e.SpecialPropertyAssignmentKind||(e.SpecialPropertyAssignmentKind={})),function(e){e[e.Warning=0]="Warning",e[e.Error=1]="Error",e[e.Message=2]="Message"}(e.DiagnosticCategory||(e.DiagnosticCategory={})),function(e){e[e.Classic=1]="Classic",e[e.NodeJs=2]="NodeJs"}(e.ModuleResolutionKind||(e.ModuleResolutionKind={})),function(e){e[e.None=0]="None",e[e.CommonJS=1]="CommonJS",e[e.AMD=2]="AMD",e[e.UMD=3]="UMD",e[e.System=4]="System",e[e.ES2015=5]="ES2015",e[e.ESNext=6]="ESNext"}(e.ModuleKind||(e.ModuleKind={})),function(e){e[e.None=0]="None",e[e.Preserve=1]="Preserve",e[e.React=2]="React",e[e.ReactNative=3]="ReactNative"}(e.JsxEmit||(e.JsxEmit={})),function(e){e[e.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",e[e.LineFeed=1]="LineFeed"}(e.NewLineKind||(e.NewLineKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.JS=1]="JS",e[e.JSX=2]="JSX",e[e.TS=3]="TS",e[e.TSX=4]="TSX",e[e.External=5]="External",e[e.JSON=6]="JSON"}(e.ScriptKind||(e.ScriptKind={})),function(e){e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES2015=2]="ES2015",e[e.ES2016=3]="ES2016",e[e.ES2017=4]="ES2017",e[e.ESNext=5]="ESNext",e[e.Latest=5]="Latest"}(e.ScriptTarget||(e.ScriptTarget={})),function(e){e[e.Standard=0]="Standard",e[e.JSX=1]="JSX"}(e.LanguageVariant||(e.LanguageVariant={})),function(e){e[e.Simple=0]="Simple",e[e.Pretty=1]="Pretty"}(e.DiagnosticStyle||(e.DiagnosticStyle={})),function(e){e[e.None=0]="None",e[e.Recursive=1]="Recursive"}(e.WatchDirectoryFlags||(e.WatchDirectoryFlags={})),function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.backtick=96]="backtick",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.hash=35]="hash",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"}(e.CharacterCodes||(e.CharacterCodes={})),function(e){e.Ts=".ts",e.Tsx=".tsx",e.Dts=".d.ts",e.Js=".js",e.Jsx=".jsx",e.Json=".json"}(e.Extension||(e.Extension={})),function(e){e[e.None=0]="None",e[e.TypeScript=1]="TypeScript",e[e.ContainsTypeScript=2]="ContainsTypeScript",e[e.ContainsJsx=4]="ContainsJsx",e[e.ContainsESNext=8]="ContainsESNext",e[e.ContainsES2017=16]="ContainsES2017",e[e.ContainsES2016=32]="ContainsES2016",e[e.ES2015=64]="ES2015",e[e.ContainsES2015=128]="ContainsES2015",e[e.Generator=256]="Generator",e[e.ContainsGenerator=512]="ContainsGenerator",e[e.DestructuringAssignment=1024]="DestructuringAssignment",e[e.ContainsDestructuringAssignment=2048]="ContainsDestructuringAssignment",e[e.ContainsDecorators=4096]="ContainsDecorators",e[e.ContainsPropertyInitializer=8192]="ContainsPropertyInitializer",e[e.ContainsLexicalThis=16384]="ContainsLexicalThis",e[e.ContainsCapturedLexicalThis=32768]="ContainsCapturedLexicalThis",e[e.ContainsLexicalThisInComputedPropertyName=65536]="ContainsLexicalThisInComputedPropertyName",e[e.ContainsDefaultValueAssignments=131072]="ContainsDefaultValueAssignments",e[e.ContainsParameterPropertyAssignments=262144]="ContainsParameterPropertyAssignments",e[e.ContainsSpread=524288]="ContainsSpread",e[e.ContainsObjectSpread=1048576]="ContainsObjectSpread",e[e.ContainsRest=524288]="ContainsRest",e[e.ContainsObjectRest=1048576]="ContainsObjectRest",e[e.ContainsComputedPropertyName=2097152]="ContainsComputedPropertyName",e[e.ContainsBlockScopedBinding=4194304]="ContainsBlockScopedBinding",e[e.ContainsBindingPattern=8388608]="ContainsBindingPattern",e[e.ContainsYield=16777216]="ContainsYield",e[e.ContainsHoistedDeclarationOrCompletion=33554432]="ContainsHoistedDeclarationOrCompletion",e[e.ContainsDynamicImport=67108864]="ContainsDynamicImport",e[e.HasComputedFlags=536870912]="HasComputedFlags",e[e.AssertTypeScript=3]="AssertTypeScript",e[e.AssertJsx=4]="AssertJsx",e[e.AssertESNext=8]="AssertESNext",e[e.AssertES2017=16]="AssertES2017",e[e.AssertES2016=32]="AssertES2016",e[e.AssertES2015=192]="AssertES2015",e[e.AssertGenerator=768]="AssertGenerator",e[e.AssertDestructuringAssignment=3072]="AssertDestructuringAssignment",e[e.NodeExcludes=536872257]="NodeExcludes",e[e.ArrowFunctionExcludes=601249089]="ArrowFunctionExcludes",e[e.FunctionExcludes=601281857]="FunctionExcludes",e[e.ConstructorExcludes=601015617]="ConstructorExcludes",e[e.MethodOrAccessorExcludes=601015617]="MethodOrAccessorExcludes",e[e.ClassExcludes=539358529]="ClassExcludes",e[e.ModuleExcludes=574674241]="ModuleExcludes",e[e.TypeExcludes=-3]="TypeExcludes",e[e.ObjectLiteralExcludes=540087617]="ObjectLiteralExcludes",e[e.ArrayLiteralOrCallOrNewExcludes=537396545]="ArrayLiteralOrCallOrNewExcludes",e[e.VariableDeclarationListExcludes=546309441]="VariableDeclarationListExcludes",e[e.ParameterExcludes=536872257]="ParameterExcludes",e[e.CatchClauseExcludes=537920833]="CatchClauseExcludes",e[e.BindingPatternExcludes=537396545]="BindingPatternExcludes",e[e.TypeScriptClassSyntaxMask=274432]="TypeScriptClassSyntaxMask",e[e.ES2015FunctionSyntaxMask=163840]="ES2015FunctionSyntaxMask"}(e.TransformFlags||(e.TransformFlags={})),function(e){e[e.SingleLine=1]="SingleLine",e[e.AdviseOnEmitNode=2]="AdviseOnEmitNode",e[e.NoSubstitution=4]="NoSubstitution",e[e.CapturesThis=8]="CapturesThis",e[e.NoLeadingSourceMap=16]="NoLeadingSourceMap",e[e.NoTrailingSourceMap=32]="NoTrailingSourceMap",e[e.NoSourceMap=48]="NoSourceMap",e[e.NoNestedSourceMaps=64]="NoNestedSourceMaps",e[e.NoTokenLeadingSourceMaps=128]="NoTokenLeadingSourceMaps",e[e.NoTokenTrailingSourceMaps=256]="NoTokenTrailingSourceMaps",e[e.NoTokenSourceMaps=384]="NoTokenSourceMaps",e[e.NoLeadingComments=512]="NoLeadingComments",e[e.NoTrailingComments=1024]="NoTrailingComments",e[e.NoComments=1536]="NoComments",e[e.NoNestedComments=2048]="NoNestedComments",e[e.HelperName=4096]="HelperName",e[e.ExportName=8192]="ExportName",e[e.LocalName=16384]="LocalName",e[e.InternalName=32768]="InternalName",e[e.Indented=65536]="Indented",e[e.NoIndentation=131072]="NoIndentation",e[e.AsyncFunctionBody=262144]="AsyncFunctionBody",e[e.ReuseTempVariableScope=524288]="ReuseTempVariableScope",e[e.CustomPrologue=1048576]="CustomPrologue",e[e.NoHoisting=2097152]="NoHoisting",e[e.HasEndOfDeclarationMarker=4194304]="HasEndOfDeclarationMarker",e[e.Iterator=8388608]="Iterator",e[e.NoAsciiEscaping=16777216]="NoAsciiEscaping",e[e.TypeScriptClassWrapper=33554432]="TypeScriptClassWrapper"}(e.EmitFlags||(e.EmitFlags={})),function(e){e[e.Extends=1]="Extends",e[e.Assign=2]="Assign",e[e.Rest=4]="Rest",e[e.Decorate=8]="Decorate",e[e.Metadata=16]="Metadata",e[e.Param=32]="Param",e[e.Awaiter=64]="Awaiter",e[e.Generator=128]="Generator",e[e.Values=256]="Values",e[e.Read=512]="Read",e[e.Spread=1024]="Spread",e[e.Await=2048]="Await",e[e.AsyncGenerator=4096]="AsyncGenerator",e[e.AsyncDelegator=8192]="AsyncDelegator",e[e.AsyncValues=16384]="AsyncValues",e[e.ExportStar=32768]="ExportStar",e[e.MakeTemplateObject=65536]="MakeTemplateObject",e[e.FirstEmitHelper=1]="FirstEmitHelper",e[e.LastEmitHelper=65536]="LastEmitHelper",e[e.ForOfIncludes=256]="ForOfIncludes",e[e.ForAwaitOfIncludes=16384]="ForAwaitOfIncludes",e[e.AsyncGeneratorIncludes=6144]="AsyncGeneratorIncludes",e[e.AsyncDelegatorIncludes=26624]="AsyncDelegatorIncludes",e[e.SpreadIncludes=1536]="SpreadIncludes"}(e.ExternalEmitHelpers||(e.ExternalEmitHelpers={})),function(e){e[e.SourceFile=0]="SourceFile",e[e.Expression=1]="Expression",e[e.IdentifierName=2]="IdentifierName",e[e.MappedTypeParameter=3]="MappedTypeParameter",e[e.Unspecified=4]="Unspecified"}(e.EmitHint||(e.EmitHint={}))}(ts||(ts={})),function(e){e.timestamp="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now?Date.now:function(){return+new Date}}(ts||(ts={})),function(e){!function(t){var n,i,r,s="function"==typeof onProfilerEvent&&!0===onProfilerEvent.profiler?onProfilerEvent:function(e){},o=!1,a=0;t.mark=function(t){o&&(i.set(t,e.timestamp()),n.set(t,(n.get(t)||0)+1),s(t))},t.measure=function(t,n,s){if(o){var l=s&&i.get(s)||e.timestamp(),c=n&&i.get(n)||a;r.set(t,(r.get(t)||0)+(l-c))}},t.getCount=function(e){return n&&n.get(e)||0},t.getDuration=function(e){return r&&r.get(e)||0},t.forEachMeasure=function(e){r.forEach(function(t,n){e(n,t)})},t.enable=function(){n=e.createMap(),i=e.createMap(),r=e.createMap(),o=!0,a=e.timestamp()},t.disable=function(){o=!1}}(e.performance||(e.performance={}))}(ts||(ts={})),function(e){e.versionMajorMinor="2.6",e.version=e.versionMajorMinor+".1"}(ts||(ts={})),function(e){e.isExternalModuleNameRelative=function(t){return e.pathIsRelative(t)||e.isRootedDiskPath(t)}}(ts||(ts={})),function(e){function t(){var e=Object.create(null);return e.__=void 0,delete e.__,e}function n(){return new r}e.collator="object"==typeof Intl&&"function"==typeof Intl.Collator?new Intl.Collator(void 0,{usage:"sort",sensitivity:"accent"}):void 0,e.localeCompareIsCorrect=e.collator&&e.collator.compare("a","B")<0,e.createMap=n,e.createUnderscoreEscapedMap=function(){return new r},e.createSymbolTable=function(e){var t=n();if(e)for(var i=0,r=e;i<r.length;i++){var s=r[i];t.set(s.escapedName,s)}return t},e.createMapFromTemplate=function(e){var t=new r;for(var n in e)x.call(e,n)&&t.set(n,e[n]);return t};var i,r="undefined"!=typeof Map&&"entries"in Map.prototype?Map:(i=function(){function e(e,t){this.index=0,this.data=e,this.selector=t,this.keys=Object.keys(e)}return e.prototype.next=function(){var e=this.index;return e<this.keys.length?(this.index++,{value:this.selector(this.data,this.keys[e]),done:!1}):{value:void 0,done:!0}},e}(),function(){function e(){this.data=t(),this.size=0}return e.prototype.get=function(e){return this.data[e]},e.prototype.set=function(e,t){return this.has(e)||this.size++,this.data[e]=t,this},e.prototype.has=function(e){return e in this.data},e.prototype.delete=function(e){return!!this.has(e)&&(this.size--,delete this.data[e],!0)},e.prototype.clear=function(){this.data=t(),this.size=0},e.prototype.keys=function(){return new i(this.data,function(e,t){return t})},e.prototype.values=function(){return new i(this.data,function(e,t){return e[t]})},e.prototype.entries=function(){return new i(this.data,function(e,t){return[t,e[t]]})},e.prototype.forEach=function(e){for(var t in this.data)e(this.data[t],t)},e}());function s(e,t){if(e)for(var n=0;n<e.length;n++){var i=t(e[n],n);if(i)return i}}function o(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(t(i,n))return i}}function a(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n))return n;return-1}function l(e,t){if(e)for(var n=0,i=e;n<i.length;n++){if(i[n]===t)return!0}return!1}function c(e,t,n){for(var i=n||0;i<e.length;i++)if(l(t,e.charCodeAt(i)))return i;return-1}function u(e,t){for(var n=0,i=0;i<e.length;i++)t(e[i],i,e)&&(e[n]=e[i],n++);e.length=n}function d(e,t){var n;if(e){n=[];for(var i=0;i<e.length;i++)n.push(t(e[i],i))}return n}function p(e){var t;if(e){t=[];for(var n=0,i=e;n<i.length;n++){var r=i[n];r&&(N(r)?y(t,r):t.push(r))}}return t}function h(e,t){var n;if(e){n=[];for(var i=0;i<e.length;i++){var r=t(e[i],i);r&&(N(r)?y(n,r):n.push(r))}}return n}function f(e,t){if(e){if(!t)return e.length>0;for(var n=0,i=e;n<i.length;n++){if(t(i[n]))return!0}}return!1}function m(e,t){var n;if(e){n=[];e:for(var i=0,r=e;i<r.length;i++){for(var s=r[i],o=0,a=n;o<a.length;o++){var l=a[o];if(t?t(l,s):l===s)continue e}n.push(s)}}return n}function g(e,t,n){if(!e||!t)return e===t;if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++){if(!(n?n(e[i],t[i]):e[i]===t[i]))return!1}return!0}function _(e,t){return t<0?e.length+t:t}function y(e,t,n,i){if(void 0===t||0===t.length)return e;if(void 0===e)return t.slice(n,i);n=void 0===n?0:_(t,n),i=void 0===i?t.length:_(t,i);for(var r=n;r<i&&r<t.length;r++){void 0!==t[r]&&e.push(t[r])}return e}function b(e,t){return!l(e,t)&&(e.push(t),!0)}function v(e,t){if(e&&(t=_(e,t))<e.length)return e[t]}function T(e){return v(e,-1)}function k(e,t,n,i,r){if(e&&e.length>0){var s=e.length;if(s>0){var o=void 0===i||i<0?0:i,a=void 0===r||o+r>s-1?s-1:o+r,l=void 0;for(arguments.length<=2?(l=e[o],o++):l=n;o<=a;)l=t(l,e[o],o),o++;return l}}return n}e.toPath=function(e,t,n){return n(ee(e)?z(e):ie(e,t))},function(e){e[e.LessThan=-1]="LessThan",e[e.EqualTo=0]="EqualTo",e[e.GreaterThan=1]="GreaterThan"}(e.Comparison||(e.Comparison={})),e.length=function(e){return e?e.length:0},e.forEach=s,e.firstDefined=function(e,t){for(var n=0;n<e.length;n++){var i=t(e[n],n);if(void 0!==i)return i}},e.findAncestor=function(e,t){for(;e;){var n=t(e);if("quit"===n)return;if(n)return e;e=e.parent}},e.zipWith=function(e,t,n){var i=[];Me.assert(e.length===t.length);for(var r=0;r<e.length;r++)i.push(n(e[r],t[r],r));return i},e.zipToMap=function(e,t){Me.assert(e.length===t.length);for(var i=n(),r=0;r<e.length;++r)i.set(e[r],t[r]);return i},e.every=function(e,t){if(e)for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0},e.find=o,e.findLast=function(e,t){for(var n=e.length-1;n>=0;n--){var i=e[n];if(t(i,n))return i}},e.findIndex=a,e.findMap=function(e,t){for(var n=0;n<e.length;n++){var i=t(e[n],n);if(i)return i}Me.fail()},e.contains=l,e.indexOf=function(e,t){if(e)for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},e.indexOfAnyCharCode=c,e.countWhere=function(e,t){var n=0;if(e)for(var i=0;i<e.length;i++){t(e[i],i)&&n++}return n},e.filter=function(e,t){if(e){for(var n=e.length,i=0;i<n&&t(e[i]);)i++;if(i<n){var r=e.slice(0,i);for(i++;i<n;){var s=e[i];t(s)&&r.push(s),i++}return r}}return e},e.filterMutate=u,e.clear=function(e){e.length=0},e.map=d,e.sameMap=function(e,t){var n;if(e)for(var i=0;i<e.length;i++)if(n)n.push(t(e[i],i));else{var r=e[i],s=t(r,i);r!==s&&(n=e.slice(0,i)).push(s)}return n||e},e.flatten=p,e.flatMap=h,e.flatMapIter=function(e,t){for(var n=[];;){var i=e.next(),r=i.value;if(i.done)break;var s=t(r);s&&(N(s)?n.push.apply(n,s):n.push(s))}return n},e.sameFlatMap=function(e,t){var n;if(e)for(var i=0;i<e.length;i++){var r=e[i],s=t(r,i);(n||r!==s||N(s))&&(n||(n=e.slice(0,i)),N(s)?y(n,s):n.push(s))}return n||e},e.mapDefined=function(e,t){var n=[];if(e)for(var i=0;i<e.length;i++){var r=t(e[i],i);void 0!==r&&n.push(r)}return n},e.mapDefinedIter=function(e,t){for(var n=[];;){var i=e.next(),r=i.value;if(i.done)break;var s=t(r);void 0!==s&&n.push(s)}return n},e.span=function(e,t){if(e){for(var n=0;n<e.length;n++)if(!t(e[n],n))return[e.slice(0,n),e.slice(n)];return[e.slice(0),[]]}},e.spanMap=function(e,t,n){var i;if(e){i=[];for(var r=e.length,s=void 0,o=void 0,a=0,l=0;a<r;){for(;l<r;){if(o=t(e[l],l),0===l)s=o;else if(o!==s)break;l++}if(a<l){var c=n(e.slice(a,l),s,a,l);c&&i.push(c),a=l}s=o,l++}}return i},e.mapEntries=function(e,t){if(e){var i=n();return e.forEach(function(e,n){var r=t(n,e),s=r[0],o=r[1];i.set(s,o)}),i}},e.some=f,e.concatenate=function(e,t){return f(t)?f(e)?e.concat(t):t:e},e.deduplicate=m,e.arrayIsEqualTo=g,e.changesAffectModuleResolution=function(e,t){return!(e&&e.module===t.module&&e.moduleResolution===t.moduleResolution&&e.noResolve===t.noResolve&&e.target===t.target&&e.noLib===t.noLib&&e.jsx===t.jsx&&e.allowJs===t.allowJs&&e.rootDir===t.rootDir&&e.configFilePath===t.configFilePath&&e.baseUrl===t.baseUrl&&e.maxNodeModuleJsDepth===t.maxNodeModuleJsDepth&&g(e.lib,t.lib)&&g(e.typeRoots,t.typeRoots)&&g(e.rootDirs,t.rootDirs)&&C(e.paths,t.paths))},e.compact=function(e){var t;if(e)for(var n=0;n<e.length;n++){var i=e[n];!t&&i||(t||(t=e.slice(0,n)),i&&t.push(i))}return t||e},e.relativeComplement=function(e,t,n,i,r){if(void 0===n&&(n=M),void 0===i&&(i=0),void 0===r&&(r=0),!t||!e||0===t.length||0===e.length)return t;var s=[];e:for(;r<t.length;r++){t:for(;i<e.length;i++)switch(n(t[r],e[i])){case-1:break t;case 0:continue e;case 1:continue t}s.push(t[r])}return s},e.sum=function(e,t){for(var n=0,i=0,r=e;i<r.length;i++){n+=r[i][t]}return n},e.append=function(e,t){return void 0===t?e:void 0===e?[t]:(e.push(t),e)},e.addRange=y,e.pushIfUnique=b,e.appendIfUnique=function(e,t){return e?(b(e,t),e):[t]},e.stableSort=function(e,t){return void 0===t&&(t=M),e.map(function(e,t){return t}).sort(function(n,i){return t(e[n],e[i])||M(n,i)}).map(function(t){return e[t]})},e.rangeEquals=function(e,t,n,i){for(;n<i;){if(e[n]!==t[n])return!1;n++}return!0},e.elementAt=v,e.firstOrUndefined=function(e){return v(e,0)},e.first=function(e){return Me.assert(0!==e.length),e[0]},e.lastOrUndefined=T,e.last=function(e){return Me.assert(0!==e.length),e[e.length-1]},e.singleOrUndefined=function(e){return e&&1===e.length?e[0]:void 0},e.singleOrMany=function(e){return e&&1===e.length?e[0]:e},e.replaceElement=function(e,t,n){var i=e.slice(0);return i[t]=n,i},e.binarySearch=function(e,t,n,i){if(!e||0===e.length)return-1;var r=i||0,s=e.length-1;for(n=void 0!==n?n:function(e,t){return e<t?-1:e>t?1:0};r<=s;){var o=r+(s-r>>1),a=e[o];if(0===n(a,t))return o;n(a,t)>0?s=o-1:r=o+1}return~r},e.reduceLeft=k,e.reduceRight=function(e,t,n,i,r){if(e){var s=e.length;if(s>0){var o=void 0===i||i>s-1?s-1:i,a=void 0===r||o-r<0?0:o-r,l=void 0;for(arguments.length<=2?(l=e[o],o--):l=n;o>=a;)l=t(l,e[o],o),o--;return l}}return n};var x=Object.prototype.hasOwnProperty;function E(e,t){return x.call(e,t)}function S(e,t){e.forEach(function(e,n){t.set(n,e)})}function C(e,t,n){if(e===t)return!0;if(!e||!t)return!1;for(var i in e)if(x.call(e,i)){if(void 0===!x.call(t,i))return!1;if(n?!n(e[i],t[i]):e[i]!==t[i])return!1}for(var i in t)if(x.call(t,i)&&!x.call(e,i))return!1;return!0}function w(e,t,i){for(var r=n(),s=0,o=e;s<o.length;s++){var a=o[s];r.set(t(a),i?i(a):a)}return r}function I(e,t){var n=this.get(e);return n?n.push(t):this.set(e,n=[t]),n}function A(e,t){var n=this.get(e);n&&(qe(n,t),n.length||this.delete(e))}function N(e){return Array.isArray?Array.isArray(e):e instanceof Array}function D(e){return"string"==typeof e}function O(e){var t;return function(){return e&&(t=e(),e=void 0),t}}function R(e,t,n,i,r){if(r){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return function(e){return k(s,function(e,t){return t(e)},e)}}return i?function(r){return i(n(t(e(r))))}:n?function(i){return n(t(e(i)))}:t?function(n){return t(e(n))}:e?function(t){return e(t)}:function(e){return e}}function L(e,t,n){return n=n||0,e.replace(/{(\d+)}/g,function(e,i){return t[+i+n]})}function P(t){return e.localizedDiagnosticMessages&&e.localizedDiagnosticMessages[t.key]||t.message}function M(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e<t?-1:1}function F(t,n,i){if(t===n)return 0;if(void 0===t)return-1;if(void 0===n)return 1;if(i){if(e.collator){var r=e.localeCompareIsCorrect?e.collator.compare(t,n):t.localeCompare(n,void 0,{usage:"sort",sensitivity:"accent"});return r<0?-1:r>0?1:0}if((t=t.toUpperCase())===(n=n.toUpperCase()))return 0}return t<n?-1:1}function B(e,t){return F(e,t,!0)}function $(e){return e.file?e.file.fileName:void 0}function U(e,t){return M($(e),$(t))||M(e.start,t.start)||M(e.length,t.length)||M(e.code,t.code)||function(e,t){for(;e&&t;){var n=M(D(e)?e:e.messageText,D(t)?t:t.messageText);if(n)return n;e=D(e)?void 0:e.next,t=D(t)?void 0:t.next}if(!e&&!t)return 0;return e?1:-1}(e.messageText,t.messageText)||0}function V(e){if(e.length<2)return e;for(var t=[e[0]],n=e[0],i=1;i<e.length;i++){var r=e[i];0===U(r,n)||(t.push(r),n=r)}return t}function H(e){return e.replace(/\\/g,"/")}function G(e){if(47===e.charCodeAt(0)){if(47!==e.charCodeAt(1))return 1;var t=e.indexOf("/",2);if(t<0)return 2;var n=e.indexOf("/",t+1);return n<0?t+1:n+1}if(58===e.charCodeAt(1))return 47===e.charCodeAt(2)?3:2;if(0===e.lastIndexOf("file:///",0))return 8;var i=e.indexOf("://");return-1!==i?i+3:0}e.hasProperty=E,e.getProperty=function(e,t){return x.call(e,t)?e[t]:void 0},e.getOwnKeys=function(e){var t=[];for(var n in e)x.call(e,n)&&t.push(n);return t},e.getOwnValues=function(e){var t=[];for(var n in e)x.call(e,n)&&t.push(e[n]);return t},e.arrayFrom=function(e,t){for(var n,i=[],r=e.next(),s=r.value,o=r.done;!o;s=(n=e.next()).value,o=n.done,n)i.push(t?t(s):s);return i},e.forEachEntry=function(e,t){for(var n,i=e.entries(),r=i.next(),s=r.value,o=r.done;!o;s=(n=i.next()).value,o=n.done,n){var a=s[0],l=t(s[1],a);if(l)return l}},e.forEachKey=function(e,t){for(var n,i=e.keys(),r=i.next(),s=r.value,o=r.done;!o;s=(n=i.next()).value,o=n.done,n){var a=t(s);if(a)return a}},e.copyEntries=S,e.assign=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=0,r=t;i<r.length;i++){var s=r[i];for(var o in s)E(s,o)&&(e[o]=s[o])}return e},e.equalOwnProperties=C,e.arrayToMap=w,e.arrayToNumericMap=function(e,t){for(var n=[],i=0,r=e;i<r.length;i++){var s=r[i];n[t(s)]=s}return n},e.arrayToSet=function(e,t){return w(e,t||function(e){return e},function(){return!0})},e.cloneMap=function(e){var t=n();return S(e,t),t},e.clone=function(e){var t={};for(var n in e)x.call(e,n)&&(t[n]=e[n]);return t},e.extend=function(e,t){var n={};for(var i in t)x.call(t,i)&&(n[i]=t[i]);for(var i in e)x.call(e,i)&&(n[i]=e[i]);return n},e.createMultiMap=function(){var e=n();return e.add=I,e.remove=A,e},e.isArray=N,e.isString=D,e.tryCast=function(e,t){return void 0!==e&&t(e)?e:void 0},e.cast=function(e,t){if(void 0!==e&&t(e))return e;Me.fail("Invalid cast. The supplied value did not pass the test '"+Me.getFunctionName(t)+"'.")},e.noop=function(){},e.returnFalse=function(){return!1},e.returnTrue=function(){return!0},e.identity=function(e){return e},e.notImplemented=function(){throw new Error("Not implemented")},e.memoize=O,e.chain=function(e,t,n,i,r){if(r){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return function(e){return R.apply(void 0,d(s,function(t){return t(e)}))}}return i?function(r){return R(e(r),t(r),n(r),i(r))}:n?function(i){return R(e(i),t(i),n(i))}:t?function(n){return R(e(n),t(n))}:e?function(t){return R(e(t))}:function(e){return function(e){return e}}},e.compose=R,e.formatStringFromArgs=L,e.localizedDiagnosticMessages=void 0,e.getLocaleSpecificMessage=P,e.createFileDiagnostic=function(e,t,n,i){Me.assertGreaterThanOrEqual(t,0),Me.assertGreaterThanOrEqual(n,0),e&&(Me.assertLessThanOrEqual(t,e.text.length),Me.assertLessThanOrEqual(t+n,e.text.length));var r=P(i);return arguments.length>4&&(r=L(r,arguments,4)),{file:e,start:t,length:n,messageText:r,category:i.category,code:i.code}},e.formatMessage=function(e,t){var n=P(t);return arguments.length>2&&(n=L(n,arguments,2)),n},e.createCompilerDiagnostic=function(e){var t=P(e);return arguments.length>1&&(t=L(t,arguments,1)),{file:void 0,start:void 0,length:void 0,messageText:t,category:e.category,code:e.code}},e.createCompilerDiagnosticFromMessageChain=function(e){return{file:void 0,start:void 0,length:void 0,code:e.code,category:e.category,messageText:e.next?e:e.messageText}},e.chainDiagnosticMessages=function(e,t){var n=P(t);return arguments.length>2&&(n=L(n,arguments,2)),{messageText:n,category:t.category,code:t.code,next:e}},e.concatenateDiagnosticMessageChains=function(e,t){for(var n=e;n.next;)n=n.next;return n.next=t,e},e.compareValues=M,e.compareStrings=F,e.compareStringsCaseInsensitive=B,e.compareDiagnostics=U,e.sortAndDeduplicateDiagnostics=function(e){return V(e.sort(U))},e.deduplicateSortedDiagnostics=V,e.normalizeSlashes=H,e.getRootLength=G,e.directorySeparator="/";var j=47;function K(t,n){for(var i=[],r=0,s=t.substr(n).split(e.directorySeparator);r<s.length;r++){var o=s[r];"."!==o&&(".."===o&&i.length>0&&".."!==T(i)?i.pop():o&&i.push(o))}return i}function z(e){return W(e).path}function W(t){var n=G(t=H(t)),i=t.substr(0,n),r=K(t,n);if(r.length){var s=i+r.join(e.directorySeparator);return{path:q(t)?s+e.directorySeparator:s,parts:r}}return{path:i,parts:r}}function q(e){return e.charCodeAt(e.length-1)===j}function J(t){return t.substr(0,Math.max(G(t),t.lastIndexOf(e.directorySeparator)))}function Y(e){return e&&!ee(e)&&he(e,"://")}function X(e){return e.target||0}function Z(t){return"number"==typeof t.module?t.module:X(t)>=2?e.ModuleKind.ES2015:e.ModuleKind.CommonJS}function Q(e){for(var t=!1,n=0;n<e.length;n++)if(42===e.charCodeAt(n)){if(t)return!1;t=!0}return!0}function ee(e){return e&&0!==G(e)}function te(e,t){var n=K(e,t);return[e.substr(0,t)].concat(n)}function ne(e,t){var n=G(e=H(e));return 0===n&&(n=G(e=le(H(t),e))),te(e,n)}function ie(e,t){return re(ne(e,t))}function re(t){if(t&&t.length)return t[0]+t.slice(1).join(e.directorySeparator)}function se(t,n){return Y(t)?function(t){for(var n=t.length,i=t.indexOf("://")+3;i<n&&47===t.charCodeAt(i);)i++;if(i===n)return[t];var r=t.indexOf(e.directorySeparator,i);return-1!==r?te(t,i=r+1):[t+e.directorySeparator]}(t):ne(t,n)}function oe(t,n,i,r,s){var o,a=se(n,i),l=se(t,i);for(l.length>1&&""===T(l)&&l.pop(),o=0;o<a.length&&o<l.length&&r(l[o])===r(a[o]);o++);if(o){for(var c="",u=a.slice(o,a.length);o<l.length;o++)""!==l[o]&&(c=c+".."+e.directorySeparator);return c+u.join(e.directorySeparator)}var d=re(a);return s&&ee(d)&&(d="file:///"+d),d}function ae(t){if(void 0!==t){var n=t.lastIndexOf(e.directorySeparator);return n<0?t:t.substring(n+1)}}function le(t,n){return t&&t.length?n&&n.length?0!==G(n)?n:t.charAt(t.length-1)===e.directorySeparator?t+n:t+e.directorySeparator+n:t:n}function ce(t){return t.charAt(t.length-1)===e.directorySeparator?t.substr(0,t.length-1):t}function ue(e,t,n,i){if(void 0===e||void 0===t)return!1;if(e===t)return!0;if((e=ce(e))===(t=ce(t)))return!0;var r=ne(e,n),s=ne(t,n);if(s.length<r.length)return!1;for(var o=0;o<r.length;o++){if(0!==F(r[o],s[o],i))return!1}return!0}function de(e,t){return 0===e.lastIndexOf(t,0)}function pe(e,t){var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n}function he(e,t){return-1!==e.indexOf(t)}function fe(e){return he(ae(e),".")}function me(e,t){return e.length>t.length&&pe(e,t)}function ge(e,t){for(var n=0,i=t;n<i.length;n++){if(me(e,i[n]))return!0}return!1}e.normalizePath=z,e.normalizePathAndParts=W,e.pathEndsWithDirectorySeparator=q,e.getDirectoryPath=J,e.isUrl=Y,e.pathIsRelative=function(e){return/^\.\.?($|[\\/])/.test(e)},e.moduleHasNonRelativeName=function(t){return!e.isExternalModuleNameRelative(t)},e.getEmitScriptTarget=X,e.getEmitModuleKind=Z,e.getEmitModuleResolutionKind=function(t){var n=t.moduleResolution;return void 0===n&&(n=Z(t)===e.ModuleKind.CommonJS?e.ModuleResolutionKind.NodeJs:e.ModuleResolutionKind.Classic),n},e.hasZeroOrOneAsteriskCharacter=Q,e.isRootedDiskPath=ee,e.convertToRelativePath=function(e,t,n){return ee(e)?oe(t,e,t,n,!1):e},e.getNormalizedPathComponents=ne,e.getNormalizedAbsolutePath=ie,e.getNormalizedPathFromPathComponents=re,e.getRelativePathToDirectoryOrUrl=oe,e.getBaseFileName=ae,e.combinePaths=le,e.removeTrailingDirectorySeparator=ce,e.ensureTrailingDirectorySeparator=function(t){return t.charAt(t.length-1)!==e.directorySeparator?t+e.directorySeparator:t},e.comparePaths=function(e,t,n,i){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;e=ce(e),t=ce(t);for(var r=ne(e,n),s=ne(t,n),o=Math.min(r.length,s.length),a=0;a<o;a++){var l=F(r[a],s[a],i);if(0!==l)return l}return M(r.length,s.length)},e.containsPath=ue,e.startsWith=de,e.removePrefix=function(e,t){return de(e,t)?e.substr(t.length):e},e.endsWith=pe,e.stringContains=he,e.hasExtension=fe,e.fileExtensionIs=me,e.fileExtensionIsOneOf=ge;var _e=/[^\w\s\/]/g,ye=[42,63];e.commonPackageFolders=["node_modules","bower_components","jspm_packages"];var be="(?!("+e.commonPackageFolders.join("|")+")(/|$))",ve={singleAsteriskRegexFragment:"([^./]|(\\.(?!min\\.js$))?)*",doubleAsteriskRegexFragment:"(/"+be+"[^/.][^/]*)*?",replaceWildcardCharacter:function(e){return we(e,ve.singleAsteriskRegexFragment)}},Te={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:"(/"+be+"[^/.][^/]*)*?",replaceWildcardCharacter:function(e){return we(e,Te.singleAsteriskRegexFragment)}},ke={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:"(/.+?)?",replaceWildcardCharacter:function(e){return we(e,ke.singleAsteriskRegexFragment)}},xe={files:ve,directories:Te,exclude:ke};function Ee(e,t,n){var i=Se(e,t,n);if(i&&i.length)return"^("+i.map(function(e){return"("+e+")"}).join("|")+")"+("exclude"===n?"($|/)":"$")}function Se(t,n,i){if(void 0!==t&&0!==t.length)return h(t,function(t){return t&&function(t,n,i,r){var s=r.singleAsteriskRegexFragment,o=r.doubleAsteriskRegexFragment,a=r.replaceWildcardCharacter,l="",c=!1,u=!1,d=ne(t,n),p=T(d);if("exclude"!==i&&"**"===p)return;d[0]=ce(d[0]),Ce(p)&&d.push("**","*");for(var h=0,f=0,m=d;f<m.length;f++){var g=m[f];if("**"===g){if(c)return;l+=o,c=!0}else if("directories"===i&&(l+="(",h++),u&&(l+=e.directorySeparator),"exclude"!==i){var _="";42===g.charCodeAt(0)?(_+="([^./]"+s+")?",g=g.substr(1)):63===g.charCodeAt(0)&&(_+="[^./]",g=g.substr(1)),(_+=g.replace(_e,a))!==g&&(l+=be),l+=_}else l+=g.replace(_e,a);u=!0}for(;h>0;)l+=")?",h--;return l}(t,n,i,xe[i])})}function Ce(e){return!/[.*?]/.test(e)}function we(e,t){return"*"===e?t:"?"===e?"[^/]":"\\"+e}function Ie(e,t,n,i,r){e=z(e);var s=le(r=z(r),e);return{includeFilePatterns:d(Se(n,s,"files"),function(e){return"^"+e+"$"}),includeFilePattern:Ee(n,s,"files"),includeDirectoryPattern:Ee(n,s,"directories"),excludePattern:Ee(t,s,"exclude"),basePaths:Ne(e,n,i)}}function Ae(e,t,n,i,r,s,o,l){for(var c=Ie(e=z(e),n,i,r,s=z(s)),u=r?"":"i",d=c.includeFilePatterns&&c.includeFilePatterns.map(function(e){return new RegExp(e,u)}),h=c.includeDirectoryPattern&&new RegExp(c.includeDirectoryPattern,u),f=c.excludePattern&&new RegExp(c.excludePattern,u),m=d?d.map(function(){return[]}):[[]],g=r?F:B,_=0,y=c.basePaths;_<y.length;_++){var b=y[_];v(b,le(s,b),o)}return p(m);function v(e,n,i){for(var r=l(e),s=r.files,o=r.directories,c=function(i){var r=le(e,i),s=le(n,i);if(t&&!ge(r,t))return"continue";if(f&&f.test(s))return"continue";if(d){var o=a(d,function(e){return e.test(s)});-1!==o&&m[o].push(r)}else m[0].push(r)},u=0,p=s=s.slice().sort(g);u<p.length;u++){c(b=p[u])}if(void 0===i||0!==--i)for(var _=0,y=o=o.slice().sort(g);_<y.length;_++){var b=y[_],T=le(e,b),k=le(n,b);h&&!h.test(k)||f&&f.test(k)||v(T,k,i)}}}function Ne(t,n,i){var r=[t];if(n){for(var s=[],o=0,a=n;o<a.length;o++){var l=a[o],c=ee(l)?l:z(le(t,l));s.push(De(c))}s.sort(i?F:B);for(var u=function(n){e.every(r,function(e){return!ue(e,n,t,!i)})&&r.push(n)},d=0,p=s;d<p.length;d++){u(p[d])}}return r}function De(t){var n=c(t,ye);return n<0?fe(t)?ce(J(t)):t:t.substring(0,t.lastIndexOf(e.directorySeparator,n))}function Oe(e){switch(e.substr(e.lastIndexOf(".")).toLowerCase()){case".js":return 1;case".jsx":return 2;case".ts":return 3;case".tsx":return 4;case".json":return 6;default:return 0}}e.getRegularExpressionForWildcard=Ee,e.isImplicitGlob=Ce,e.getFileMatcherPatterns=Ie,e.matchFiles=Ae,e.ensureScriptKind=function(e,t){return t||Oe(e)||3},e.getScriptKindFromFileName=Oe,e.supportedTypeScriptExtensions=[".ts",".tsx",".d.ts"],e.supportedTypescriptExtensionsForExtractExtension=[".d.ts",".ts",".tsx"],e.supportedJavascriptExtensions=[".js",".jsx"];var Re=e.supportedTypeScriptExtensions.concat(e.supportedJavascriptExtensions);function Le(t,n){var i=t&&t.allowJs;return n&&0!==n.length&&i?m(Re.concat(n.map(function(e){return e.extension}))):i?Re:e.supportedTypeScriptExtensions}function Pe(e,t){return e<2?0:e<t.length?2:t.length}e.getSupportedExtensions=Le,e.hasJavaScriptFileExtension=function(t){return s(e.supportedJavascriptExtensions,function(e){return me(t,e)})},e.hasTypeScriptFileExtension=function(t){return s(e.supportedTypeScriptExtensions,function(e){return me(t,e)})},e.isSupportedSourceFileName=function(e,t,n){if(!e)return!1;for(var i=0,r=Le(t,n);i<r.length;i++){if(me(e,r[i]))return!0}return!1},function(e){e[e.TypeScriptFiles=0]="TypeScriptFiles",e[e.DeclarationAndJavaScriptFiles=2]="DeclarationAndJavaScriptFiles",e[e.Highest=0]="Highest",e[e.Lowest=2]="Lowest"}(e.ExtensionPriority||(e.ExtensionPriority={})),e.getExtensionPriority=function(e,t){for(var n=t.length-1;n>=0;n--)if(me(e,t[n]))return Pe(n,t);return 0},e.adjustExtensionPriority=Pe,e.getNextLowestExtensionPriority=function(e,t){return e<2?2:t.length};var Me,Fe=[".d.ts",".ts",".js",".tsx",".jsx"];function Be(e){for(var t=0,n=Fe;t<n.length;t++){var i=$e(e,n[t]);if(void 0!==i)return i}return e}function $e(e,t){return me(e,t)?Ue(e,t):void 0}function Ue(e,t){return e.substring(0,e.length-t.length)}function Ve(e,t){this.flags=e,this.escapedName=t,this.declarations=void 0}function He(e,t){this.flags=t,Me.isDebugging&&(this.checker=e)}function Ge(){}function je(e,t,n){this.id=0,this.kind=e,this.pos=t,this.end=n,this.flags=0,this.modifierFlagsCache=0,this.transformFlags=0,this.parent=void 0,this.original=void 0}function Ke(e,t,n){this.fileName=e,this.text=t,this.skipTrivia=n||function(e){return e}}function ze(e,t){for(var n=t;n<e.length-1;n++)e[n]=e[n+1];e.pop()}function We(e,t){e[t]=e[e.length-1],e.pop()}function qe(e,t){!function(e,t){for(var n=0;n<e.length;n++)if(t(e[n])){We(e,n);break}}(e,function(e){return e===t})}function Je(e){return e?function(e){return e}:function(e){return e.toLowerCase()}}function Ye(e,t,n){for(var i=void 0,r=-1,s=0,o=e;s<o.length;s++){var a=o[s],l=t(a);Xe(l,n)&&l.prefix.length>r&&(r=l.prefix.length,i=a)}return i}function Xe(e,t){var n=e.prefix,i=e.suffix;return t.length>=n.length+i.length&&de(t,n)&&pe(t,i)}function Ze(e){Me.assert(Q(e));var t=e.indexOf("*");return-1===t?void 0:{prefix:e.substr(0,t),suffix:e.substr(t+1)}}function Qe(t){return o(e.supportedTypescriptExtensionsForExtractExtension,function(e){return me(t,e)})||o(e.supportedJavascriptExtensions,function(e){return me(t,e)})}e.removeFileExtension=Be,e.tryRemoveExtension=$e,e.removeExtension=Ue,e.changeExtension=function(e,t){return Be(e)+t},e.objectAllocator={getNodeConstructor:function(){return je},getTokenConstructor:function(){return je},getIdentifierConstructor:function(){return je},getSourceFileConstructor:function(){return je},getSymbolConstructor:function(){return Ve},getTypeConstructor:function(){return He},getSignatureConstructor:function(){return Ge},getSourceMapSourceConstructor:function(){return Ke}},function(e){e[e.None=0]="None",e[e.Normal=1]="Normal",e[e.Aggressive=2]="Aggressive",e[e.VeryAggressive=3]="VeryAggressive"}(e.AssertionLevel||(e.AssertionLevel={})),function(e){function t(e,n){var i=new Error(e?"Debug Failure. "+e:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(i,n||t),i}e.currentAssertionLevel=0,e.isDebugging=!1,e.shouldAssert=function(t){return e.currentAssertionLevel>=t},e.assert=function e(n,i,r,s){n||(r&&(i+="\r\nVerbose Debug Information: "+("string"==typeof r?r:r())),t(i?"False expression: "+i:"False expression.",s||e))},e.assertEqual=function(e,n,i,r){e!==n&&t("Expected "+e+" === "+n+". "+(i?r?i+" "+r:i:""))},e.assertLessThan=function(e,n,i){e>=n&&t("Expected "+e+" < "+n+". "+(i||""))},e.assertLessThanOrEqual=function(e,n){e>n&&t("Expected "+e+" <= "+n)},e.assertGreaterThanOrEqual=function(e,n){e<n&&t("Expected "+e+" >= "+n)},e.fail=t,e.assertNever=function e(n,i,r){return t(i||"Illegal value: "+n,r||e)},e.getFunctionName=function(e){if("function"!=typeof e)return"";if(e.hasOwnProperty("name"))return e.name;var t=Function.prototype.toString.call(e),n=/^function\s+([\w\$]+)\s*\(/.exec(t);return n?n[1]:""}}(Me=e.Debug||(e.Debug={})),e.orderedRemoveItem=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return ze(e,n),!0;return!1},e.orderedRemoveItemAt=ze,e.unorderedRemoveItemAt=We,e.unorderedRemoveItem=qe,e.createGetCanonicalFileName=Je,e.matchPatternOrExact=function(e,t){for(var n=[],i=0,r=e;i<r.length;i++){var s=r[i],o=Ze(s);if(o)n.push(o);else if(s===t)return s}return Ye(n,function(e){return e},t)},e.patternText=function(e){return e.prefix+"*"+e.suffix},e.matchedText=function(e,t){return Me.assert(Xe(e,t)),t.substr(e.prefix.length,t.length-e.suffix.length)},e.findBestPatternMatch=Ye,e.tryParsePattern=Ze,e.positionIsSynthesized=function(e){return!(e>=0)},e.extensionIsTypeScript=function(e){return".ts"===e||".tsx"===e||".d.ts"===e},e.extensionFromPath=function(e){var t=Qe(e);if(void 0!==t)return t;Me.fail("File "+e+" has unknown extension.")},e.isAnySupportedFileExtension=function(e){return void 0!==Qe(e)},e.tryGetExtensionFromPath=Qe,e.getAnyExtensionFromPath=function(e){var t=ae(e),n=t.lastIndexOf(".");if(n>=0)return t.substring(n)},e.isCheckJsEnabledForFile=function(e,t){return e.checkJsDirective?e.checkJsDirective.enabled:t.checkJs},e.and=function(e,t){return function(n){return e(n)&&t(n)}},e.assertTypeIsNever=function(e){},e.createCachedDirectoryStructureHost=function(t){var i=n(),r=O(function(){return t.getCurrentDirectory()}),s=Je(t.useCaseSensitiveFileNames);return{useCaseSensitiveFileNames:t.useCaseSensitiveFileNames,newLine:t.newLine,readFile:function(e,n){return t.readFile(e,n)},write:function(e){return t.write(e)},writeFile:function(e,n,i){var r=l(o(e));r&&y(r,c(e),!0);return t.writeFile(e,n,i)},fileExists:function(e){var n=l(o(e));return n&&g(n.files,c(e))||t.fileExists(e)},directoryExists:function(e){var n=o(e);return i.has(n)||t.directoryExists(e)},createDirectory:function(e){var n=l(o(e)),i=c(e);n&&_(n.directories,i,!0);t.createDirectory(e)},getCurrentDirectory:r,getDirectories:function(e){var n=o(e),i=h(e,n);if(i)return i.directories.slice();return t.getDirectories(e)},readDirectory:function(e,n,i,s,l){var c=o(e),u=h(e,c);if(u)return Ae(e,n,i,s,t.useCaseSensitiveFileNames,r(),l,function(e){var t=o(e);if(t===c)return u;return a(t)||p(e,t)});return t.readDirectory(e,n,i,s,l)},addOrDeleteFileOrDirectory:function(e,n){if(a(n))t.directoryExists(e)||i.delete(n);else{var r=l(n);if(r){var s=c(e);if(r){var o={fileExists:t.fileExists(n),directoryExists:t.directoryExists(n)};return y(r,s,o.fileExists),_(r.directories,s,o.directoryExists),o}}}},addOrDeleteFile:function(t,n,i){if(i===e.FileWatcherEventKind.Changed)return;var r=l(n);r&&y(r,c(t),i===e.FileWatcherEventKind.Created)},clearCache:function(){i.clear()},exit:function(e){return t.exit(e)}};function o(t){return e.toPath(t,r(),s)}function a(e){return i.get(e)}function l(e){return a(J(e))}function c(e){return ae(z(e))}function p(e,n){var r={files:d(t.readDirectory(e,void 0,void 0,["*.*"]),c)||[],directories:t.getDirectories(e)||[]};return i.set(n,r),r}function h(e,t){var n=a(t);if(n)return n;try{return p(e,t)}catch(e){return void Me.assert(!i.has(t))}}function m(e,t){return s(e)===s(t)}function g(e,t){return f(e,function(e){return m(e,t)})}function _(e,t,n){if(g(e,t)){if(!n)return u(e,function(e){return!m(e,t)})}else if(n)return e.push(t)}function y(e,t,n){_(e.files,t,n)}}}(ts||(ts={})),function(e){var t;function n(){if("undefined"!=typeof process){var e=process.version;if(e){var t=e.indexOf(".");if(-1!==t)return parseInt(e.substring(1,t))}}}e.setStackTraceLimit=function(){Error.stackTraceLimit<100&&(Error.stackTraceLimit=100)},function(e){e[e.Created=0]="Created",e[e.Changed=1]="Changed",e[e.Deleted=2]="Deleted"}(t=e.FileWatcherEventKind||(e.FileWatcherEventKind={})),e.getNodeMajorVersion=n,e.sys=function(){function i(t,n){var r=e.getDirectoryPath(t),s=""!==r&&t!==r&&!n.directoryExists(r);s&&i(r,n),!s&&n.directoryExists(t)||n.createDirectory(t)}var r,s;if("undefined"!=typeof ChakraHost?(s=ChakraHost.realpath&&function(e){return ChakraHost.realpath(e)},r={newLine:ChakraHost.newLine||"\r\n",args:ChakraHost.args,useCaseSensitiveFileNames:!!ChakraHost.useCaseSensitiveFileNames,write:ChakraHost.echo,readFile:function(e,t){return ChakraHost.readFile(e)},writeFile:function(e,t,n){n&&(t="\ufeff"+t),ChakraHost.writeFile(e,t)},resolvePath:ChakraHost.resolvePath,fileExists:ChakraHost.fileExists,directoryExists:ChakraHost.directoryExists,createDirectory:ChakraHost.createDirectory,getExecutingFilePath:function(){return ChakraHost.executingFile},getCurrentDirectory:function(){return ChakraHost.currentDirectory},getDirectories:ChakraHost.getDirectories,getEnvironmentVariable:ChakraHost.getEnvironmentVariable||function(){return""},readDirectory:function(t,n,i,r,s){var o=e.getFileMatcherPatterns(t,i,r,!!ChakraHost.useCaseSensitiveFileNames,ChakraHost.currentDirectory);return ChakraHost.readDirectory(t,n,o.basePaths,o.excludePattern,o.includeFilePattern,o.includeDirectoryPattern)},exit:ChakraHost.quit,realpath:s}):"undefined"!=typeof process&&process.nextTick&&!process.browser&&"undefined"!=typeof require&&(r=function(){var i,r,s=require("fs"),o=require("path"),a=require("os"),l=require("crypto"),c=process.env.TSC_NONPOLLING_WATCHER,u=function(){var n=e.createMap(),i=e.createMultiMap();return{addFile:function(t,n){return s(t,n),r(e.getDirectoryPath(t)),{fileName:t,callback:n}},removeFile:function(t){var r,s,o,a,l;a=t.fileName,l=t.callback,i.remove(a,l),r=t.fileName,s=e.getDirectoryPath(r),(o=n.get(s))&&(o.referenceCount-=1,o.referenceCount<=0&&(o.close(),n.delete(s)))}};function r(r){var s=n.get(r);s?s.referenceCount+=1:((s=m(r||".",function(n,s){return function(n,r,s){var o=e.isString(r)?e.getNormalizedAbsolutePath(r,s):void 0;if("change"===n||"rename"===n){var a=i.get(o);if(a)for(var l=0,c=a;l<c.length;l++)(0,c[l])(o,t.Changed)}}(n,s,r)})).referenceCount=1,n.set(r,s))}function s(e,t){i.add(e,t)}}(),d=n()>=4,p=a.platform(),h="win32"!==p&&"win64"!==p&&!y((i=__filename,i.replace(/\w/g,function(e){var t=e.toUpperCase();return e===t?e.toLowerCase():t})));function f(e,n,i){return s.watchFile(e,{persistent:!0,interval:i||250},r),{close:function(){return s.unwatchFile(e,r)}};function r(i,r){var s=0===+i.mtime,o=0===+r.mtime,a=s&&!o,l=!s&&o?t.Created:a?t.Deleted:t.Changed;l===t.Changed&&+i.mtime<=+r.mtime||n(e,l)}}function m(e,n,i){var r,o=b(e)?a():l();return{close:function(){o.close()}};function a(){void 0===r&&(r=!d||"win32"!==process.platform&&"darwin"!==process.platform?{persistent:!0}:{persistent:!0,recursive:!!i});var t=s.watch(e,r,n);return t.on("error",function(){b(e)||(o=l(),n("rename",""))}),t}function l(){return f(e,function(i,r){r===t.Created&&b(e)&&(o.close(),o=a(),n("rename",""))})}}function g(t){try{for(var n=s.readdirSync(t||".").sort(),i=[],r=[],o=0,a=n;o<a.length;o++){var l=a[o];if("."!==l&&".."!==l){var c=e.combinePaths(t,l),u=void 0;try{u=s.statSync(c)}catch(e){continue}u.isFile()?i.push(l):u.isDirectory()&&r.push(l)}}return{files:i,directories:r}}catch(e){return{files:[],directories:[]}}}function _(e,t){try{var n=s.statSync(e);switch(t){case 0:return n.isFile();case 1:return n.isDirectory()}}catch(e){return!1}}function y(e){return _(e,0)}function b(e){return _(e,1)}!function(e){e[e.File=0]="File",e[e.Directory=1]="Directory"}(r||(r={}));var v={args:process.argv.slice(2),newLine:a.EOL,useCaseSensitiveFileNames:h,write:function(e){process.stdout.write(e)},readFile:function(e,t){if(y(e)){var n=s.readFileSync(e),i=n.length;if(i>=2&&254===n[0]&&255===n[1]){i&=-2;for(var r=0;r<i;r+=2){var o=n[r];n[r]=n[r+1],n[r+1]=o}return n.toString("utf16le",2)}return i>=2&&255===n[0]&&254===n[1]?n.toString("utf16le",2):i>=3&&239===n[0]&&187===n[1]&&191===n[2]?n.toString("utf8",3):n.toString("utf8")}},writeFile:function(e,t,n){var i;n&&(t="\ufeff"+t);try{i=s.openSync(e,"w"),s.writeSync(i,t,void 0,"utf8")}finally{void 0!==i&&s.closeSync(i)}},watchFile:function(e,t,n){if(c){var i=u.addFile(e,t);return{close:function(){return u.removeFile(i)}}}return f(e,t,n)},watchDirectory:function(t,n,i){return m(t,function(i,r){"rename"===i&&n(r?e.normalizePath(e.combinePaths(t,r)):r)},i)},resolvePath:function(e){return o.resolve(e)},fileExists:y,directoryExists:b,createDirectory:function(e){v.directoryExists(e)||s.mkdirSync(e)},getExecutingFilePath:function(){return __filename},getCurrentDirectory:function(){return process.cwd()},getDirectories:function(t){return e.filter(s.readdirSync(t),function(n){return _(e.combinePaths(t,n),1)})},getEnvironmentVariable:function(e){return process.env[e]||""},readDirectory:function(t,n,i,r,s){return e.matchFiles(t,n,i,r,h,process.cwd(),s,g)},getModifiedTime:function(e){try{return s.statSync(e).mtime}catch(e){return}},createHash:function(e){var t=l.createHash("md5");return t.update(e),t.digest("hex")},getMemoryUsage:function(){return global.gc&&global.gc(),process.memoryUsage().heapUsed},getFileSize:function(e){try{var t=s.statSync(e);if(t.isFile())return t.size}catch(e){}return 0},exit:function(e){process.exit(e)},realpath:function(e){return s.realpathSync(e)},debugMode:e.some(process.execArgv,function(e){return/^--(inspect|debug)(-brk)?(=\d+)?$/i.test(e)}),tryEnableSourceMapsForHost:function(){try{require("source-map-support").install()}catch(e){}},setTimeout:setTimeout,clearTimeout:clearTimeout};return v}()),r){var o=r.writeFile;r.writeFile=function(t,n,s){var a=e.getDirectoryPath(e.normalizeSlashes(t));a&&!r.directoryExists(a)&&i(a,r),o.call(r,t,n,s)}}return r}(),e.sys&&e.sys.getEnvironmentVariable&&(e.Debug.currentAssertionLevel=/^development$/i.test(e.sys.getEnvironmentVariable("NODE_ENV"))?1:0),e.sys&&e.sys.debugMode&&(e.Debug.isDebugging=!0)}(ts||(ts={})),function(e){function t(e,t,n,i){return{code:e,category:t,key:n,message:i}}e.Diagnostics={Unterminated_string_literal:t(1002,e.DiagnosticCategory.Error,"Unterminated_string_literal_1002","Unterminated string literal."),Identifier_expected:t(1003,e.DiagnosticCategory.Error,"Identifier_expected_1003","Identifier expected."),_0_expected:t(1005,e.DiagnosticCategory.Error,"_0_expected_1005","'{0}' expected."),A_file_cannot_have_a_reference_to_itself:t(1006,e.DiagnosticCategory.Error,"A_file_cannot_have_a_reference_to_itself_1006","A file cannot have a reference to itself."),Trailing_comma_not_allowed:t(1009,e.DiagnosticCategory.Error,"Trailing_comma_not_allowed_1009","Trailing comma not allowed."),Asterisk_Slash_expected:t(1010,e.DiagnosticCategory.Error,"Asterisk_Slash_expected_1010","'*/' expected."),Unexpected_token:t(1012,e.DiagnosticCategory.Error,"Unexpected_token_1012","Unexpected token."),A_rest_parameter_must_be_last_in_a_parameter_list:t(1014,e.DiagnosticCategory.Error,"A_rest_parameter_must_be_last_in_a_parameter_list_1014","A rest parameter must be last in a parameter list."),Parameter_cannot_have_question_mark_and_initializer:t(1015,e.DiagnosticCategory.Error,"Parameter_cannot_have_question_mark_and_initializer_1015","Parameter cannot have question mark and initializer."),A_required_parameter_cannot_follow_an_optional_parameter:t(1016,e.DiagnosticCategory.Error,"A_required_parameter_cannot_follow_an_optional_parameter_1016","A required parameter cannot follow an optional parameter."),An_index_signature_cannot_have_a_rest_parameter:t(1017,e.DiagnosticCategory.Error,"An_index_signature_cannot_have_a_rest_parameter_1017","An index signature cannot have a rest parameter."),An_index_signature_parameter_cannot_have_an_accessibility_modifier:t(1018,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_an_accessibility_modifier_1018","An index signature parameter cannot have an accessibility modifier."),An_index_signature_parameter_cannot_have_a_question_mark:t(1019,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_a_question_mark_1019","An index signature parameter cannot have a question mark."),An_index_signature_parameter_cannot_have_an_initializer:t(1020,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_an_initializer_1020","An index signature parameter cannot have an initializer."),An_index_signature_must_have_a_type_annotation:t(1021,e.DiagnosticCategory.Error,"An_index_signature_must_have_a_type_annotation_1021","An index signature must have a type annotation."),An_index_signature_parameter_must_have_a_type_annotation:t(1022,e.DiagnosticCategory.Error,"An_index_signature_parameter_must_have_a_type_annotation_1022","An index signature parameter must have a type annotation."),An_index_signature_parameter_type_must_be_string_or_number:t(1023,e.DiagnosticCategory.Error,"An_index_signature_parameter_type_must_be_string_or_number_1023","An index signature parameter type must be 'string' or 'number'."),readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature:t(1024,e.DiagnosticCategory.Error,"readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature_1024","'readonly' modifier can only appear on a property declaration or index signature."),Accessibility_modifier_already_seen:t(1028,e.DiagnosticCategory.Error,"Accessibility_modifier_already_seen_1028","Accessibility modifier already seen."),_0_modifier_must_precede_1_modifier:t(1029,e.DiagnosticCategory.Error,"_0_modifier_must_precede_1_modifier_1029","'{0}' modifier must precede '{1}' modifier."),_0_modifier_already_seen:t(1030,e.DiagnosticCategory.Error,"_0_modifier_already_seen_1030","'{0}' modifier already seen."),_0_modifier_cannot_appear_on_a_class_element:t(1031,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_class_element_1031","'{0}' modifier cannot appear on a class element."),super_must_be_followed_by_an_argument_list_or_member_access:t(1034,e.DiagnosticCategory.Error,"super_must_be_followed_by_an_argument_list_or_member_access_1034","'super' must be followed by an argument list or member access."),Only_ambient_modules_can_use_quoted_names:t(1035,e.DiagnosticCategory.Error,"Only_ambient_modules_can_use_quoted_names_1035","Only ambient modules can use quoted names."),Statements_are_not_allowed_in_ambient_contexts:t(1036,e.DiagnosticCategory.Error,"Statements_are_not_allowed_in_ambient_contexts_1036","Statements are not allowed in ambient contexts."),A_declare_modifier_cannot_be_used_in_an_already_ambient_context:t(1038,e.DiagnosticCategory.Error,"A_declare_modifier_cannot_be_used_in_an_already_ambient_context_1038","A 'declare' modifier cannot be used in an already ambient context."),Initializers_are_not_allowed_in_ambient_contexts:t(1039,e.DiagnosticCategory.Error,"Initializers_are_not_allowed_in_ambient_contexts_1039","Initializers are not allowed in ambient contexts."),_0_modifier_cannot_be_used_in_an_ambient_context:t(1040,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_in_an_ambient_context_1040","'{0}' modifier cannot be used in an ambient context."),_0_modifier_cannot_be_used_with_a_class_declaration:t(1041,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_with_a_class_declaration_1041","'{0}' modifier cannot be used with a class declaration."),_0_modifier_cannot_be_used_here:t(1042,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_here_1042","'{0}' modifier cannot be used here."),_0_modifier_cannot_appear_on_a_data_property:t(1043,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_data_property_1043","'{0}' modifier cannot appear on a data property."),_0_modifier_cannot_appear_on_a_module_or_namespace_element:t(1044,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_module_or_namespace_element_1044","'{0}' modifier cannot appear on a module or namespace element."),A_0_modifier_cannot_be_used_with_an_interface_declaration:t(1045,e.DiagnosticCategory.Error,"A_0_modifier_cannot_be_used_with_an_interface_declaration_1045","A '{0}' modifier cannot be used with an interface declaration."),A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file:t(1046,e.DiagnosticCategory.Error,"A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file_1046","A 'declare' modifier is required for a top level declaration in a .d.ts file."),A_rest_parameter_cannot_be_optional:t(1047,e.DiagnosticCategory.Error,"A_rest_parameter_cannot_be_optional_1047","A rest parameter cannot be optional."),A_rest_parameter_cannot_have_an_initializer:t(1048,e.DiagnosticCategory.Error,"A_rest_parameter_cannot_have_an_initializer_1048","A rest parameter cannot have an initializer."),A_set_accessor_must_have_exactly_one_parameter:t(1049,e.DiagnosticCategory.Error,"A_set_accessor_must_have_exactly_one_parameter_1049","A 'set' accessor must have exactly one parameter."),A_set_accessor_cannot_have_an_optional_parameter:t(1051,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_an_optional_parameter_1051","A 'set' accessor cannot have an optional parameter."),A_set_accessor_parameter_cannot_have_an_initializer:t(1052,e.DiagnosticCategory.Error,"A_set_accessor_parameter_cannot_have_an_initializer_1052","A 'set' accessor parameter cannot have an initializer."),A_set_accessor_cannot_have_rest_parameter:t(1053,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_rest_parameter_1053","A 'set' accessor cannot have rest parameter."),A_get_accessor_cannot_have_parameters:t(1054,e.DiagnosticCategory.Error,"A_get_accessor_cannot_have_parameters_1054","A 'get' accessor cannot have parameters."),Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value:t(1055,e.DiagnosticCategory.Error,"Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Prom_1055","Type '{0}' is not a valid async function return type in ES5/ES3 because it does not refer to a Promise-compatible constructor value."),Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher:t(1056,e.DiagnosticCategory.Error,"Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher_1056","Accessors are only available when targeting ECMAScript 5 and higher."),An_async_function_or_method_must_have_a_valid_awaitable_return_type:t(1057,e.DiagnosticCategory.Error,"An_async_function_or_method_must_have_a_valid_awaitable_return_type_1057","An async function or method must have a valid awaitable return type."),The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1058,e.DiagnosticCategory.Error,"The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_t_1058","The return type of an async function must either be a valid promise or must not contain a callable 'then' member."),A_promise_must_have_a_then_method:t(1059,e.DiagnosticCategory.Error,"A_promise_must_have_a_then_method_1059","A promise must have a 'then' method."),The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback:t(1060,e.DiagnosticCategory.Error,"The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback_1060","The first parameter of the 'then' method of a promise must be a callback."),Enum_member_must_have_initializer:t(1061,e.DiagnosticCategory.Error,"Enum_member_must_have_initializer_1061","Enum member must have initializer."),Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method:t(1062,e.DiagnosticCategory.Error,"Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method_1062","Type is referenced directly or indirectly in the fulfillment callback of its own 'then' method."),An_export_assignment_cannot_be_used_in_a_namespace:t(1063,e.DiagnosticCategory.Error,"An_export_assignment_cannot_be_used_in_a_namespace_1063","An export assignment cannot be used in a namespace."),The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type:t(1064,e.DiagnosticCategory.Error,"The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type_1064","The return type of an async function or method must be the global Promise<T> type."),In_ambient_enum_declarations_member_initializer_must_be_constant_expression:t(1066,e.DiagnosticCategory.Error,"In_ambient_enum_declarations_member_initializer_must_be_constant_expression_1066","In ambient enum declarations member initializer must be constant expression."),Unexpected_token_A_constructor_method_accessor_or_property_was_expected:t(1068,e.DiagnosticCategory.Error,"Unexpected_token_A_constructor_method_accessor_or_property_was_expected_1068","Unexpected token. A constructor, method, accessor, or property was expected."),_0_modifier_cannot_appear_on_a_type_member:t(1070,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_type_member_1070","'{0}' modifier cannot appear on a type member."),_0_modifier_cannot_appear_on_an_index_signature:t(1071,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_an_index_signature_1071","'{0}' modifier cannot appear on an index signature."),A_0_modifier_cannot_be_used_with_an_import_declaration:t(1079,e.DiagnosticCategory.Error,"A_0_modifier_cannot_be_used_with_an_import_declaration_1079","A '{0}' modifier cannot be used with an import declaration."),Invalid_reference_directive_syntax:t(1084,e.DiagnosticCategory.Error,"Invalid_reference_directive_syntax_1084","Invalid 'reference' directive syntax."),Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0:t(1085,e.DiagnosticCategory.Error,"Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0_1085","Octal literals are not available when targeting ECMAScript 5 and higher. Use the syntax '{0}'."),An_accessor_cannot_be_declared_in_an_ambient_context:t(1086,e.DiagnosticCategory.Error,"An_accessor_cannot_be_declared_in_an_ambient_context_1086","An accessor cannot be declared in an ambient context."),_0_modifier_cannot_appear_on_a_constructor_declaration:t(1089,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_constructor_declaration_1089","'{0}' modifier cannot appear on a constructor declaration."),_0_modifier_cannot_appear_on_a_parameter:t(1090,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_parameter_1090","'{0}' modifier cannot appear on a parameter."),Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement:t(1091,e.DiagnosticCategory.Error,"Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement_1091","Only a single variable declaration is allowed in a 'for...in' statement."),Type_parameters_cannot_appear_on_a_constructor_declaration:t(1092,e.DiagnosticCategory.Error,"Type_parameters_cannot_appear_on_a_constructor_declaration_1092","Type parameters cannot appear on a constructor declaration."),Type_annotation_cannot_appear_on_a_constructor_declaration:t(1093,e.DiagnosticCategory.Error,"Type_annotation_cannot_appear_on_a_constructor_declaration_1093","Type annotation cannot appear on a constructor declaration."),An_accessor_cannot_have_type_parameters:t(1094,e.DiagnosticCategory.Error,"An_accessor_cannot_have_type_parameters_1094","An accessor cannot have type parameters."),A_set_accessor_cannot_have_a_return_type_annotation:t(1095,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_a_return_type_annotation_1095","A 'set' accessor cannot have a return type annotation."),An_index_signature_must_have_exactly_one_parameter:t(1096,e.DiagnosticCategory.Error,"An_index_signature_must_have_exactly_one_parameter_1096","An index signature must have exactly one parameter."),_0_list_cannot_be_empty:t(1097,e.DiagnosticCategory.Error,"_0_list_cannot_be_empty_1097","'{0}' list cannot be empty."),Type_parameter_list_cannot_be_empty:t(1098,e.DiagnosticCategory.Error,"Type_parameter_list_cannot_be_empty_1098","Type parameter list cannot be empty."),Type_argument_list_cannot_be_empty:t(1099,e.DiagnosticCategory.Error,"Type_argument_list_cannot_be_empty_1099","Type argument list cannot be empty."),Invalid_use_of_0_in_strict_mode:t(1100,e.DiagnosticCategory.Error,"Invalid_use_of_0_in_strict_mode_1100","Invalid use of '{0}' in strict mode."),with_statements_are_not_allowed_in_strict_mode:t(1101,e.DiagnosticCategory.Error,"with_statements_are_not_allowed_in_strict_mode_1101","'with' statements are not allowed in strict mode."),delete_cannot_be_called_on_an_identifier_in_strict_mode:t(1102,e.DiagnosticCategory.Error,"delete_cannot_be_called_on_an_identifier_in_strict_mode_1102","'delete' cannot be called on an identifier in strict mode."),A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator:t(1103,e.DiagnosticCategory.Error,"A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator_1103","A 'for-await-of' statement is only allowed within an async function or async generator."),A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement:t(1104,e.DiagnosticCategory.Error,"A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement_1104","A 'continue' statement can only be used within an enclosing iteration statement."),A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement:t(1105,e.DiagnosticCategory.Error,"A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement_1105","A 'break' statement can only be used within an enclosing iteration or switch statement."),Jump_target_cannot_cross_function_boundary:t(1107,e.DiagnosticCategory.Error,"Jump_target_cannot_cross_function_boundary_1107","Jump target cannot cross function boundary."),A_return_statement_can_only_be_used_within_a_function_body:t(1108,e.DiagnosticCategory.Error,"A_return_statement_can_only_be_used_within_a_function_body_1108","A 'return' statement can only be used within a function body."),Expression_expected:t(1109,e.DiagnosticCategory.Error,"Expression_expected_1109","Expression expected."),Type_expected:t(1110,e.DiagnosticCategory.Error,"Type_expected_1110","Type expected."),A_default_clause_cannot_appear_more_than_once_in_a_switch_statement:t(1113,e.DiagnosticCategory.Error,"A_default_clause_cannot_appear_more_than_once_in_a_switch_statement_1113","A 'default' clause cannot appear more than once in a 'switch' statement."),Duplicate_label_0:t(1114,e.DiagnosticCategory.Error,"Duplicate_label_0_1114","Duplicate label '{0}'."),A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement:t(1115,e.DiagnosticCategory.Error,"A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement_1115","A 'continue' statement can only jump to a label of an enclosing iteration statement."),A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement:t(1116,e.DiagnosticCategory.Error,"A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement_1116","A 'break' statement can only jump to a label of an enclosing statement."),An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode:t(1117,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode_1117","An object literal cannot have multiple properties with the same name in strict mode."),An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name:t(1118,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name_1118","An object literal cannot have multiple get/set accessors with the same name."),An_object_literal_cannot_have_property_and_accessor_with_the_same_name:t(1119,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_property_and_accessor_with_the_same_name_1119","An object literal cannot have property and accessor with the same name."),An_export_assignment_cannot_have_modifiers:t(1120,e.DiagnosticCategory.Error,"An_export_assignment_cannot_have_modifiers_1120","An export assignment cannot have modifiers."),Octal_literals_are_not_allowed_in_strict_mode:t(1121,e.DiagnosticCategory.Error,"Octal_literals_are_not_allowed_in_strict_mode_1121","Octal literals are not allowed in strict mode."),A_tuple_type_element_list_cannot_be_empty:t(1122,e.DiagnosticCategory.Error,"A_tuple_type_element_list_cannot_be_empty_1122","A tuple type element list cannot be empty."),Variable_declaration_list_cannot_be_empty:t(1123,e.DiagnosticCategory.Error,"Variable_declaration_list_cannot_be_empty_1123","Variable declaration list cannot be empty."),Digit_expected:t(1124,e.DiagnosticCategory.Error,"Digit_expected_1124","Digit expected."),Hexadecimal_digit_expected:t(1125,e.DiagnosticCategory.Error,"Hexadecimal_digit_expected_1125","Hexadecimal digit expected."),Unexpected_end_of_text:t(1126,e.DiagnosticCategory.Error,"Unexpected_end_of_text_1126","Unexpected end of text."),Invalid_character:t(1127,e.DiagnosticCategory.Error,"Invalid_character_1127","Invalid character."),Declaration_or_statement_expected:t(1128,e.DiagnosticCategory.Error,"Declaration_or_statement_expected_1128","Declaration or statement expected."),Statement_expected:t(1129,e.DiagnosticCategory.Error,"Statement_expected_1129","Statement expected."),case_or_default_expected:t(1130,e.DiagnosticCategory.Error,"case_or_default_expected_1130","'case' or 'default' expected."),Property_or_signature_expected:t(1131,e.DiagnosticCategory.Error,"Property_or_signature_expected_1131","Property or signature expected."),Enum_member_expected:t(1132,e.DiagnosticCategory.Error,"Enum_member_expected_1132","Enum member expected."),Variable_declaration_expected:t(1134,e.DiagnosticCategory.Error,"Variable_declaration_expected_1134","Variable declaration expected."),Argument_expression_expected:t(1135,e.DiagnosticCategory.Error,"Argument_expression_expected_1135","Argument expression expected."),Property_assignment_expected:t(1136,e.DiagnosticCategory.Error,"Property_assignment_expected_1136","Property assignment expected."),Expression_or_comma_expected:t(1137,e.DiagnosticCategory.Error,"Expression_or_comma_expected_1137","Expression or comma expected."),Parameter_declaration_expected:t(1138,e.DiagnosticCategory.Error,"Parameter_declaration_expected_1138","Parameter declaration expected."),Type_parameter_declaration_expected:t(1139,e.DiagnosticCategory.Error,"Type_parameter_declaration_expected_1139","Type parameter declaration expected."),Type_argument_expected:t(1140,e.DiagnosticCategory.Error,"Type_argument_expected_1140","Type argument expected."),String_literal_expected:t(1141,e.DiagnosticCategory.Error,"String_literal_expected_1141","String literal expected."),Line_break_not_permitted_here:t(1142,e.DiagnosticCategory.Error,"Line_break_not_permitted_here_1142","Line break not permitted here."),or_expected:t(1144,e.DiagnosticCategory.Error,"or_expected_1144","'{' or ';' expected."),Declaration_expected:t(1146,e.DiagnosticCategory.Error,"Declaration_expected_1146","Declaration expected."),Import_declarations_in_a_namespace_cannot_reference_a_module:t(1147,e.DiagnosticCategory.Error,"Import_declarations_in_a_namespace_cannot_reference_a_module_1147","Import declarations in a namespace cannot reference a module."),Cannot_use_imports_exports_or_module_augmentations_when_module_is_none:t(1148,e.DiagnosticCategory.Error,"Cannot_use_imports_exports_or_module_augmentations_when_module_is_none_1148","Cannot use imports, exports, or module augmentations when '--module' is 'none'."),File_name_0_differs_from_already_included_file_name_1_only_in_casing:t(1149,e.DiagnosticCategory.Error,"File_name_0_differs_from_already_included_file_name_1_only_in_casing_1149","File name '{0}' differs from already included file name '{1}' only in casing."),new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead:t(1150,e.DiagnosticCategory.Error,"new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead_1150","'new T[]' cannot be used to create an array. Use 'new Array<T>()' instead."),const_declarations_must_be_initialized:t(1155,e.DiagnosticCategory.Error,"const_declarations_must_be_initialized_1155","'const' declarations must be initialized."),const_declarations_can_only_be_declared_inside_a_block:t(1156,e.DiagnosticCategory.Error,"const_declarations_can_only_be_declared_inside_a_block_1156","'const' declarations can only be declared inside a block."),let_declarations_can_only_be_declared_inside_a_block:t(1157,e.DiagnosticCategory.Error,"let_declarations_can_only_be_declared_inside_a_block_1157","'let' declarations can only be declared inside a block."),Unterminated_template_literal:t(1160,e.DiagnosticCategory.Error,"Unterminated_template_literal_1160","Unterminated template literal."),Unterminated_regular_expression_literal:t(1161,e.DiagnosticCategory.Error,"Unterminated_regular_expression_literal_1161","Unterminated regular expression literal."),An_object_member_cannot_be_declared_optional:t(1162,e.DiagnosticCategory.Error,"An_object_member_cannot_be_declared_optional_1162","An object member cannot be declared optional."),A_yield_expression_is_only_allowed_in_a_generator_body:t(1163,e.DiagnosticCategory.Error,"A_yield_expression_is_only_allowed_in_a_generator_body_1163","A 'yield' expression is only allowed in a generator body."),Computed_property_names_are_not_allowed_in_enums:t(1164,e.DiagnosticCategory.Error,"Computed_property_names_are_not_allowed_in_enums_1164","Computed property names are not allowed in enums."),A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol:t(1165,e.DiagnosticCategory.Error,"A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol_1165","A computed property name in an ambient context must directly refer to a built-in symbol."),A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol:t(1166,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol_1166","A computed property name in a class property declaration must directly refer to a built-in symbol."),A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol:t(1168,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol_1168","A computed property name in a method overload must directly refer to a built-in symbol."),A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol:t(1169,e.DiagnosticCategory.Error,"A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol_1169","A computed property name in an interface must directly refer to a built-in symbol."),A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol:t(1170,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol_1170","A computed property name in a type literal must directly refer to a built-in symbol."),A_comma_expression_is_not_allowed_in_a_computed_property_name:t(1171,e.DiagnosticCategory.Error,"A_comma_expression_is_not_allowed_in_a_computed_property_name_1171","A comma expression is not allowed in a computed property name."),extends_clause_already_seen:t(1172,e.DiagnosticCategory.Error,"extends_clause_already_seen_1172","'extends' clause already seen."),extends_clause_must_precede_implements_clause:t(1173,e.DiagnosticCategory.Error,"extends_clause_must_precede_implements_clause_1173","'extends' clause must precede 'implements' clause."),Classes_can_only_extend_a_single_class:t(1174,e.DiagnosticCategory.Error,"Classes_can_only_extend_a_single_class_1174","Classes can only extend a single class."),implements_clause_already_seen:t(1175,e.DiagnosticCategory.Error,"implements_clause_already_seen_1175","'implements' clause already seen."),Interface_declaration_cannot_have_implements_clause:t(1176,e.DiagnosticCategory.Error,"Interface_declaration_cannot_have_implements_clause_1176","Interface declaration cannot have 'implements' clause."),Binary_digit_expected:t(1177,e.DiagnosticCategory.Error,"Binary_digit_expected_1177","Binary digit expected."),Octal_digit_expected:t(1178,e.DiagnosticCategory.Error,"Octal_digit_expected_1178","Octal digit expected."),Unexpected_token_expected:t(1179,e.DiagnosticCategory.Error,"Unexpected_token_expected_1179","Unexpected token. '{' expected."),Property_destructuring_pattern_expected:t(1180,e.DiagnosticCategory.Error,"Property_destructuring_pattern_expected_1180","Property destructuring pattern expected."),Array_element_destructuring_pattern_expected:t(1181,e.DiagnosticCategory.Error,"Array_element_destructuring_pattern_expected_1181","Array element destructuring pattern expected."),A_destructuring_declaration_must_have_an_initializer:t(1182,e.DiagnosticCategory.Error,"A_destructuring_declaration_must_have_an_initializer_1182","A destructuring declaration must have an initializer."),An_implementation_cannot_be_declared_in_ambient_contexts:t(1183,e.DiagnosticCategory.Error,"An_implementation_cannot_be_declared_in_ambient_contexts_1183","An implementation cannot be declared in ambient contexts."),Modifiers_cannot_appear_here:t(1184,e.DiagnosticCategory.Error,"Modifiers_cannot_appear_here_1184","Modifiers cannot appear here."),Merge_conflict_marker_encountered:t(1185,e.DiagnosticCategory.Error,"Merge_conflict_marker_encountered_1185","Merge conflict marker encountered."),A_rest_element_cannot_have_an_initializer:t(1186,e.DiagnosticCategory.Error,"A_rest_element_cannot_have_an_initializer_1186","A rest element cannot have an initializer."),A_parameter_property_may_not_be_declared_using_a_binding_pattern:t(1187,e.DiagnosticCategory.Error,"A_parameter_property_may_not_be_declared_using_a_binding_pattern_1187","A parameter property may not be declared using a binding pattern."),Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement:t(1188,e.DiagnosticCategory.Error,"Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement_1188","Only a single variable declaration is allowed in a 'for...of' statement."),The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer:t(1189,e.DiagnosticCategory.Error,"The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer_1189","The variable declaration of a 'for...in' statement cannot have an initializer."),The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer:t(1190,e.DiagnosticCategory.Error,"The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer_1190","The variable declaration of a 'for...of' statement cannot have an initializer."),An_import_declaration_cannot_have_modifiers:t(1191,e.DiagnosticCategory.Error,"An_import_declaration_cannot_have_modifiers_1191","An import declaration cannot have modifiers."),Module_0_has_no_default_export:t(1192,e.DiagnosticCategory.Error,"Module_0_has_no_default_export_1192","Module '{0}' has no default export."),An_export_declaration_cannot_have_modifiers:t(1193,e.DiagnosticCategory.Error,"An_export_declaration_cannot_have_modifiers_1193","An export declaration cannot have modifiers."),Export_declarations_are_not_permitted_in_a_namespace:t(1194,e.DiagnosticCategory.Error,"Export_declarations_are_not_permitted_in_a_namespace_1194","Export declarations are not permitted in a namespace."),Catch_clause_variable_cannot_have_a_type_annotation:t(1196,e.DiagnosticCategory.Error,"Catch_clause_variable_cannot_have_a_type_annotation_1196","Catch clause variable cannot have a type annotation."),Catch_clause_variable_cannot_have_an_initializer:t(1197,e.DiagnosticCategory.Error,"Catch_clause_variable_cannot_have_an_initializer_1197","Catch clause variable cannot have an initializer."),An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive:t(1198,e.DiagnosticCategory.Error,"An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive_1198","An extended Unicode escape value must be between 0x0 and 0x10FFFF inclusive."),Unterminated_Unicode_escape_sequence:t(1199,e.DiagnosticCategory.Error,"Unterminated_Unicode_escape_sequence_1199","Unterminated Unicode escape sequence."),Line_terminator_not_permitted_before_arrow:t(1200,e.DiagnosticCategory.Error,"Line_terminator_not_permitted_before_arrow_1200","Line terminator not permitted before arrow."),Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_ns_from_mod_import_a_from_mod_import_d_from_mod_or_another_module_format_instead:t(1202,e.DiagnosticCategory.Error,"Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_1202","Import assignment cannot be used when targeting ECMAScript modules. Consider using 'import * as ns from \"mod\"', 'import {a} from \"mod\"', 'import d from \"mod\"', or another module format instead."),Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or_another_module_format_instead:t(1203,e.DiagnosticCategory.Error,"Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or__1203","Export assignment cannot be used when targeting ECMAScript modules. Consider using 'export default' or another module format instead."),Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided:t(1205,e.DiagnosticCategory.Error,"Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided_1205","Cannot re-export a type when the '--isolatedModules' flag is provided."),Decorators_are_not_valid_here:t(1206,e.DiagnosticCategory.Error,"Decorators_are_not_valid_here_1206","Decorators are not valid here."),Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name:t(1207,e.DiagnosticCategory.Error,"Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name_1207","Decorators cannot be applied to multiple get/set accessors of the same name."),Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided:t(1208,e.DiagnosticCategory.Error,"Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided_1208","Cannot compile namespaces when the '--isolatedModules' flag is provided."),Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided:t(1209,e.DiagnosticCategory.Error,"Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided_1209","Ambient const enums are not allowed when the '--isolatedModules' flag is provided."),Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode:t(1210,e.DiagnosticCategory.Error,"Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode_1210","Invalid use of '{0}'. Class definitions are automatically in strict mode."),A_class_declaration_without_the_default_modifier_must_have_a_name:t(1211,e.DiagnosticCategory.Error,"A_class_declaration_without_the_default_modifier_must_have_a_name_1211","A class declaration without the 'default' modifier must have a name."),Identifier_expected_0_is_a_reserved_word_in_strict_mode:t(1212,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_1212","Identifier expected. '{0}' is a reserved word in strict mode."),Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_strict_mode:t(1213,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_stric_1213","Identifier expected. '{0}' is a reserved word in strict mode. Class definitions are automatically in strict mode."),Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode:t(1214,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode_1214","Identifier expected. '{0}' is a reserved word in strict mode. Modules are automatically in strict mode."),Invalid_use_of_0_Modules_are_automatically_in_strict_mode:t(1215,e.DiagnosticCategory.Error,"Invalid_use_of_0_Modules_are_automatically_in_strict_mode_1215","Invalid use of '{0}'. Modules are automatically in strict mode."),Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules:t(1216,e.DiagnosticCategory.Error,"Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules_1216","Identifier expected. '__esModule' is reserved as an exported marker when transforming ECMAScript modules."),Export_assignment_is_not_supported_when_module_flag_is_system:t(1218,e.DiagnosticCategory.Error,"Export_assignment_is_not_supported_when_module_flag_is_system_1218","Export assignment is not supported when '--module' flag is 'system'."),Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning:t(1219,e.DiagnosticCategory.Error,"Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_t_1219","Experimental support for decorators is a feature that is subject to change in a future release. Set the 'experimentalDecorators' option to remove this warning."),Generators_are_only_available_when_targeting_ECMAScript_2015_or_higher:t(1220,e.DiagnosticCategory.Error,"Generators_are_only_available_when_targeting_ECMAScript_2015_or_higher_1220","Generators are only available when targeting ECMAScript 2015 or higher."),Generators_are_not_allowed_in_an_ambient_context:t(1221,e.DiagnosticCategory.Error,"Generators_are_not_allowed_in_an_ambient_context_1221","Generators are not allowed in an ambient context."),An_overload_signature_cannot_be_declared_as_a_generator:t(1222,e.DiagnosticCategory.Error,"An_overload_signature_cannot_be_declared_as_a_generator_1222","An overload signature cannot be declared as a generator."),_0_tag_already_specified:t(1223,e.DiagnosticCategory.Error,"_0_tag_already_specified_1223","'{0}' tag already specified."),Signature_0_must_be_a_type_predicate:t(1224,e.DiagnosticCategory.Error,"Signature_0_must_be_a_type_predicate_1224","Signature '{0}' must be a type predicate."),Cannot_find_parameter_0:t(1225,e.DiagnosticCategory.Error,"Cannot_find_parameter_0_1225","Cannot find parameter '{0}'."),Type_predicate_0_is_not_assignable_to_1:t(1226,e.DiagnosticCategory.Error,"Type_predicate_0_is_not_assignable_to_1_1226","Type predicate '{0}' is not assignable to '{1}'."),Parameter_0_is_not_in_the_same_position_as_parameter_1:t(1227,e.DiagnosticCategory.Error,"Parameter_0_is_not_in_the_same_position_as_parameter_1_1227","Parameter '{0}' is not in the same position as parameter '{1}'."),A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods:t(1228,e.DiagnosticCategory.Error,"A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods_1228","A type predicate is only allowed in return type position for functions and methods."),A_type_predicate_cannot_reference_a_rest_parameter:t(1229,e.DiagnosticCategory.Error,"A_type_predicate_cannot_reference_a_rest_parameter_1229","A type predicate cannot reference a rest parameter."),A_type_predicate_cannot_reference_element_0_in_a_binding_pattern:t(1230,e.DiagnosticCategory.Error,"A_type_predicate_cannot_reference_element_0_in_a_binding_pattern_1230","A type predicate cannot reference element '{0}' in a binding pattern."),An_export_assignment_can_only_be_used_in_a_module:t(1231,e.DiagnosticCategory.Error,"An_export_assignment_can_only_be_used_in_a_module_1231","An export assignment can only be used in a module."),An_import_declaration_can_only_be_used_in_a_namespace_or_module:t(1232,e.DiagnosticCategory.Error,"An_import_declaration_can_only_be_used_in_a_namespace_or_module_1232","An import declaration can only be used in a namespace or module."),An_export_declaration_can_only_be_used_in_a_module:t(1233,e.DiagnosticCategory.Error,"An_export_declaration_can_only_be_used_in_a_module_1233","An export declaration can only be used in a module."),An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file:t(1234,e.DiagnosticCategory.Error,"An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file_1234","An ambient module declaration is only allowed at the top level in a file."),A_namespace_declaration_is_only_allowed_in_a_namespace_or_module:t(1235,e.DiagnosticCategory.Error,"A_namespace_declaration_is_only_allowed_in_a_namespace_or_module_1235","A namespace declaration is only allowed in a namespace or module."),The_return_type_of_a_property_decorator_function_must_be_either_void_or_any:t(1236,e.DiagnosticCategory.Error,"The_return_type_of_a_property_decorator_function_must_be_either_void_or_any_1236","The return type of a property decorator function must be either 'void' or 'any'."),The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any:t(1237,e.DiagnosticCategory.Error,"The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any_1237","The return type of a parameter decorator function must be either 'void' or 'any'."),Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression:t(1238,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression_1238","Unable to resolve signature of class decorator when called as an expression."),Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression:t(1239,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression_1239","Unable to resolve signature of parameter decorator when called as an expression."),Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression:t(1240,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression_1240","Unable to resolve signature of property decorator when called as an expression."),Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression:t(1241,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression_1241","Unable to resolve signature of method decorator when called as an expression."),abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration:t(1242,e.DiagnosticCategory.Error,"abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration_1242","'abstract' modifier can only appear on a class, method, or property declaration."),_0_modifier_cannot_be_used_with_1_modifier:t(1243,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_with_1_modifier_1243","'{0}' modifier cannot be used with '{1}' modifier."),Abstract_methods_can_only_appear_within_an_abstract_class:t(1244,e.DiagnosticCategory.Error,"Abstract_methods_can_only_appear_within_an_abstract_class_1244","Abstract methods can only appear within an abstract class."),Method_0_cannot_have_an_implementation_because_it_is_marked_abstract:t(1245,e.DiagnosticCategory.Error,"Method_0_cannot_have_an_implementation_because_it_is_marked_abstract_1245","Method '{0}' cannot have an implementation because it is marked abstract."),An_interface_property_cannot_have_an_initializer:t(1246,e.DiagnosticCategory.Error,"An_interface_property_cannot_have_an_initializer_1246","An interface property cannot have an initializer."),A_type_literal_property_cannot_have_an_initializer:t(1247,e.DiagnosticCategory.Error,"A_type_literal_property_cannot_have_an_initializer_1247","A type literal property cannot have an initializer."),A_class_member_cannot_have_the_0_keyword:t(1248,e.DiagnosticCategory.Error,"A_class_member_cannot_have_the_0_keyword_1248","A class member cannot have the '{0}' keyword."),A_decorator_can_only_decorate_a_method_implementation_not_an_overload:t(1249,e.DiagnosticCategory.Error,"A_decorator_can_only_decorate_a_method_implementation_not_an_overload_1249","A decorator can only decorate a method implementation, not an overload."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5:t(1250,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_1250","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_definitions_are_automatically_in_strict_mode:t(1251,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_d_1251","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'. Class definitions are automatically in strict mode."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_are_automatically_in_strict_mode:t(1252,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_1252","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'. Modules are automatically in strict mode."),_0_tag_cannot_be_used_independently_as_a_top_level_JSDoc_tag:t(1253,e.DiagnosticCategory.Error,"_0_tag_cannot_be_used_independently_as_a_top_level_JSDoc_tag_1253","'{0}' tag cannot be used independently as a top level JSDoc tag."),A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal:t(1254,e.DiagnosticCategory.Error,"A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal_1254","A 'const' initializer in an ambient context must be a string or numeric literal."),with_statements_are_not_allowed_in_an_async_function_block:t(1300,e.DiagnosticCategory.Error,"with_statements_are_not_allowed_in_an_async_function_block_1300","'with' statements are not allowed in an async function block."),await_expression_is_only_allowed_within_an_async_function:t(1308,e.DiagnosticCategory.Error,"await_expression_is_only_allowed_within_an_async_function_1308","'await' expression is only allowed within an async function."),can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment:t(1312,e.DiagnosticCategory.Error,"can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment_1312","'=' can only be used in an object literal property inside a destructuring assignment."),The_body_of_an_if_statement_cannot_be_the_empty_statement:t(1313,e.DiagnosticCategory.Error,"The_body_of_an_if_statement_cannot_be_the_empty_statement_1313","The body of an 'if' statement cannot be the empty statement."),Global_module_exports_may_only_appear_in_module_files:t(1314,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_in_module_files_1314","Global module exports may only appear in module files."),Global_module_exports_may_only_appear_in_declaration_files:t(1315,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_in_declaration_files_1315","Global module exports may only appear in declaration files."),Global_module_exports_may_only_appear_at_top_level:t(1316,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_at_top_level_1316","Global module exports may only appear at top level."),A_parameter_property_cannot_be_declared_using_a_rest_parameter:t(1317,e.DiagnosticCategory.Error,"A_parameter_property_cannot_be_declared_using_a_rest_parameter_1317","A parameter property cannot be declared using a rest parameter."),An_abstract_accessor_cannot_have_an_implementation:t(1318,e.DiagnosticCategory.Error,"An_abstract_accessor_cannot_have_an_implementation_1318","An abstract accessor cannot have an implementation."),A_default_export_can_only_be_used_in_an_ECMAScript_style_module:t(1319,e.DiagnosticCategory.Error,"A_default_export_can_only_be_used_in_an_ECMAScript_style_module_1319","A default export can only be used in an ECMAScript-style module."),Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1320,e.DiagnosticCategory.Error,"Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member_1320","Type of 'await' operand must either be a valid promise or must not contain a callable 'then' member."),Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1321,e.DiagnosticCategory.Error,"Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_cal_1321","Type of 'yield' operand in an async generator must either be a valid promise or must not contain a callable 'then' member."),Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1322,e.DiagnosticCategory.Error,"Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_con_1322","Type of iterated elements of a 'yield*' operand must either be a valid promise or must not contain a callable 'then' member."),Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules:t(1323,e.DiagnosticCategory.Error,"Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules_1323","Dynamic import cannot be used when targeting ECMAScript 2015 modules."),Dynamic_import_must_have_one_specifier_as_an_argument:t(1324,e.DiagnosticCategory.Error,"Dynamic_import_must_have_one_specifier_as_an_argument_1324","Dynamic import must have one specifier as an argument."),Specifier_of_dynamic_import_cannot_be_spread_element:t(1325,e.DiagnosticCategory.Error,"Specifier_of_dynamic_import_cannot_be_spread_element_1325","Specifier of dynamic import cannot be spread element."),Dynamic_import_cannot_have_type_arguments:t(1326,e.DiagnosticCategory.Error,"Dynamic_import_cannot_have_type_arguments_1326","Dynamic import cannot have type arguments"),String_literal_with_double_quotes_expected:t(1327,e.DiagnosticCategory.Error,"String_literal_with_double_quotes_expected_1327","String literal with double quotes expected."),Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_literal:t(1328,e.DiagnosticCategory.Error,"Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_li_1328","Property value can only be string literal, numeric literal, 'true', 'false', 'null', object literal or array literal."),_0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0:t(1329,e.DiagnosticCategory.Error,"_0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write__1329","'{0}' accepts too few arguments to be used as a decorator here. Did you mean to call it first and write '@{0}()'?"),Duplicate_identifier_0:t(2300,e.DiagnosticCategory.Error,"Duplicate_identifier_0_2300","Duplicate identifier '{0}'."),Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor:t(2301,e.DiagnosticCategory.Error,"Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor_2301","Initializer of instance member variable '{0}' cannot reference identifier '{1}' declared in the constructor."),Static_members_cannot_reference_class_type_parameters:t(2302,e.DiagnosticCategory.Error,"Static_members_cannot_reference_class_type_parameters_2302","Static members cannot reference class type parameters."),Circular_definition_of_import_alias_0:t(2303,e.DiagnosticCategory.Error,"Circular_definition_of_import_alias_0_2303","Circular definition of import alias '{0}'."),Cannot_find_name_0:t(2304,e.DiagnosticCategory.Error,"Cannot_find_name_0_2304","Cannot find name '{0}'."),Module_0_has_no_exported_member_1:t(2305,e.DiagnosticCategory.Error,"Module_0_has_no_exported_member_1_2305","Module '{0}' has no exported member '{1}'."),File_0_is_not_a_module:t(2306,e.DiagnosticCategory.Error,"File_0_is_not_a_module_2306","File '{0}' is not a module."),Cannot_find_module_0:t(2307,e.DiagnosticCategory.Error,"Cannot_find_module_0_2307","Cannot find module '{0}'."),Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambiguity:t(2308,e.DiagnosticCategory.Error,"Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambig_2308","Module {0} has already exported a member named '{1}'. Consider explicitly re-exporting to resolve the ambiguity."),An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements:t(2309,e.DiagnosticCategory.Error,"An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements_2309","An export assignment cannot be used in a module with other exported elements."),Type_0_recursively_references_itself_as_a_base_type:t(2310,e.DiagnosticCategory.Error,"Type_0_recursively_references_itself_as_a_base_type_2310","Type '{0}' recursively references itself as a base type."),A_class_may_only_extend_another_class:t(2311,e.DiagnosticCategory.Error,"A_class_may_only_extend_another_class_2311","A class may only extend another class."),An_interface_may_only_extend_a_class_or_another_interface:t(2312,e.DiagnosticCategory.Error,"An_interface_may_only_extend_a_class_or_another_interface_2312","An interface may only extend a class or another interface."),Type_parameter_0_has_a_circular_constraint:t(2313,e.DiagnosticCategory.Error,"Type_parameter_0_has_a_circular_constraint_2313","Type parameter '{0}' has a circular constraint."),Generic_type_0_requires_1_type_argument_s:t(2314,e.DiagnosticCategory.Error,"Generic_type_0_requires_1_type_argument_s_2314","Generic type '{0}' requires {1} type argument(s)."),Type_0_is_not_generic:t(2315,e.DiagnosticCategory.Error,"Type_0_is_not_generic_2315","Type '{0}' is not generic."),Global_type_0_must_be_a_class_or_interface_type:t(2316,e.DiagnosticCategory.Error,"Global_type_0_must_be_a_class_or_interface_type_2316","Global type '{0}' must be a class or interface type."),Global_type_0_must_have_1_type_parameter_s:t(2317,e.DiagnosticCategory.Error,"Global_type_0_must_have_1_type_parameter_s_2317","Global type '{0}' must have {1} type parameter(s)."),Cannot_find_global_type_0:t(2318,e.DiagnosticCategory.Error,"Cannot_find_global_type_0_2318","Cannot find global type '{0}'."),Named_property_0_of_types_1_and_2_are_not_identical:t(2319,e.DiagnosticCategory.Error,"Named_property_0_of_types_1_and_2_are_not_identical_2319","Named property '{0}' of types '{1}' and '{2}' are not identical."),Interface_0_cannot_simultaneously_extend_types_1_and_2:t(2320,e.DiagnosticCategory.Error,"Interface_0_cannot_simultaneously_extend_types_1_and_2_2320","Interface '{0}' cannot simultaneously extend types '{1}' and '{2}'."),Excessive_stack_depth_comparing_types_0_and_1:t(2321,e.DiagnosticCategory.Error,"Excessive_stack_depth_comparing_types_0_and_1_2321","Excessive stack depth comparing types '{0}' and '{1}'."),Type_0_is_not_assignable_to_type_1:t(2322,e.DiagnosticCategory.Error,"Type_0_is_not_assignable_to_type_1_2322","Type '{0}' is not assignable to type '{1}'."),Cannot_redeclare_exported_variable_0:t(2323,e.DiagnosticCategory.Error,"Cannot_redeclare_exported_variable_0_2323","Cannot redeclare exported variable '{0}'."),Property_0_is_missing_in_type_1:t(2324,e.DiagnosticCategory.Error,"Property_0_is_missing_in_type_1_2324","Property '{0}' is missing in type '{1}'."),Property_0_is_private_in_type_1_but_not_in_type_2:t(2325,e.DiagnosticCategory.Error,"Property_0_is_private_in_type_1_but_not_in_type_2_2325","Property '{0}' is private in type '{1}' but not in type '{2}'."),Types_of_property_0_are_incompatible:t(2326,e.DiagnosticCategory.Error,"Types_of_property_0_are_incompatible_2326","Types of property '{0}' are incompatible."),Property_0_is_optional_in_type_1_but_required_in_type_2:t(2327,e.DiagnosticCategory.Error,"Property_0_is_optional_in_type_1_but_required_in_type_2_2327","Property '{0}' is optional in type '{1}' but required in type '{2}'."),Types_of_parameters_0_and_1_are_incompatible:t(2328,e.DiagnosticCategory.Error,"Types_of_parameters_0_and_1_are_incompatible_2328","Types of parameters '{0}' and '{1}' are incompatible."),Index_signature_is_missing_in_type_0:t(2329,e.DiagnosticCategory.Error,"Index_signature_is_missing_in_type_0_2329","Index signature is missing in type '{0}'."),Index_signatures_are_incompatible:t(2330,e.DiagnosticCategory.Error,"Index_signatures_are_incompatible_2330","Index signatures are incompatible."),this_cannot_be_referenced_in_a_module_or_namespace_body:t(2331,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_module_or_namespace_body_2331","'this' cannot be referenced in a module or namespace body."),this_cannot_be_referenced_in_current_location:t(2332,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_current_location_2332","'this' cannot be referenced in current location."),this_cannot_be_referenced_in_constructor_arguments:t(2333,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_constructor_arguments_2333","'this' cannot be referenced in constructor arguments."),this_cannot_be_referenced_in_a_static_property_initializer:t(2334,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_static_property_initializer_2334","'this' cannot be referenced in a static property initializer."),super_can_only_be_referenced_in_a_derived_class:t(2335,e.DiagnosticCategory.Error,"super_can_only_be_referenced_in_a_derived_class_2335","'super' can only be referenced in a derived class."),super_cannot_be_referenced_in_constructor_arguments:t(2336,e.DiagnosticCategory.Error,"super_cannot_be_referenced_in_constructor_arguments_2336","'super' cannot be referenced in constructor arguments."),Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors:t(2337,e.DiagnosticCategory.Error,"Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors_2337","Super calls are not permitted outside constructors or in nested functions inside constructors."),super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_derived_class:t(2338,e.DiagnosticCategory.Error,"super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_der_2338","'super' property access is permitted only in a constructor, member function, or member accessor of a derived class."),Property_0_does_not_exist_on_type_1:t(2339,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_type_1_2339","Property '{0}' does not exist on type '{1}'."),Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword:t(2340,e.DiagnosticCategory.Error,"Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword_2340","Only public and protected methods of the base class are accessible via the 'super' keyword."),Property_0_is_private_and_only_accessible_within_class_1:t(2341,e.DiagnosticCategory.Error,"Property_0_is_private_and_only_accessible_within_class_1_2341","Property '{0}' is private and only accessible within class '{1}'."),An_index_expression_argument_must_be_of_type_string_number_symbol_or_any:t(2342,e.DiagnosticCategory.Error,"An_index_expression_argument_must_be_of_type_string_number_symbol_or_any_2342","An index expression argument must be of type 'string', 'number', 'symbol', or 'any'."),This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1:t(2343,e.DiagnosticCategory.Error,"This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1_2343","This syntax requires an imported helper named '{1}', but module '{0}' has no exported member '{1}'."),Type_0_does_not_satisfy_the_constraint_1:t(2344,e.DiagnosticCategory.Error,"Type_0_does_not_satisfy_the_constraint_1_2344","Type '{0}' does not satisfy the constraint '{1}'."),Argument_of_type_0_is_not_assignable_to_parameter_of_type_1:t(2345,e.DiagnosticCategory.Error,"Argument_of_type_0_is_not_assignable_to_parameter_of_type_1_2345","Argument of type '{0}' is not assignable to parameter of type '{1}'."),Call_target_does_not_contain_any_signatures:t(2346,e.DiagnosticCategory.Error,"Call_target_does_not_contain_any_signatures_2346","Call target does not contain any signatures."),Untyped_function_calls_may_not_accept_type_arguments:t(2347,e.DiagnosticCategory.Error,"Untyped_function_calls_may_not_accept_type_arguments_2347","Untyped function calls may not accept type arguments."),Value_of_type_0_is_not_callable_Did_you_mean_to_include_new:t(2348,e.DiagnosticCategory.Error,"Value_of_type_0_is_not_callable_Did_you_mean_to_include_new_2348","Value of type '{0}' is not callable. Did you mean to include 'new'?"),Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures:t(2349,e.DiagnosticCategory.Error,"Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatur_2349","Cannot invoke an expression whose type lacks a call signature. Type '{0}' has no compatible call signatures."),Only_a_void_function_can_be_called_with_the_new_keyword:t(2350,e.DiagnosticCategory.Error,"Only_a_void_function_can_be_called_with_the_new_keyword_2350","Only a void function can be called with the 'new' keyword."),Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature:t(2351,e.DiagnosticCategory.Error,"Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature_2351","Cannot use 'new' with an expression whose type lacks a call or construct signature."),Type_0_cannot_be_converted_to_type_1:t(2352,e.DiagnosticCategory.Error,"Type_0_cannot_be_converted_to_type_1_2352","Type '{0}' cannot be converted to type '{1}'."),Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1:t(2353,e.DiagnosticCategory.Error,"Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1_2353","Object literal may only specify known properties, and '{0}' does not exist in type '{1}'."),This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found:t(2354,e.DiagnosticCategory.Error,"This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found_2354","This syntax requires an imported helper but module '{0}' cannot be found."),A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value:t(2355,e.DiagnosticCategory.Error,"A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value_2355","A function whose declared type is neither 'void' nor 'any' must return a value."),An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type:t(2356,e.DiagnosticCategory.Error,"An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type_2356","An arithmetic operand must be of type 'any', 'number' or an enum type."),The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access:t(2357,e.DiagnosticCategory.Error,"The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access_2357","The operand of an increment or decrement operator must be a variable or a property access."),The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2358,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_paramete_2358","The left-hand side of an 'instanceof' expression must be of type 'any', an object type or a type parameter."),The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_Function_interface_type:t(2359,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_F_2359","The right-hand side of an 'instanceof' expression must be of type 'any' or of a type assignable to the 'Function' interface type."),The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol:t(2360,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol_2360","The left-hand side of an 'in' expression must be of type 'any', 'string', 'number', or 'symbol'."),The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2361,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter_2361","The right-hand side of an 'in' expression must be of type 'any', an object type or a type parameter."),The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type:t(2362,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type_2362","The left-hand side of an arithmetic operation must be of type 'any', 'number' or an enum type."),The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type:t(2363,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type_2363","The right-hand side of an arithmetic operation must be of type 'any', 'number' or an enum type."),The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access:t(2364,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access_2364","The left-hand side of an assignment expression must be a variable or a property access."),Operator_0_cannot_be_applied_to_types_1_and_2:t(2365,e.DiagnosticCategory.Error,"Operator_0_cannot_be_applied_to_types_1_and_2_2365","Operator '{0}' cannot be applied to types '{1}' and '{2}'."),Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined:t(2366,e.DiagnosticCategory.Error,"Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined_2366","Function lacks ending return statement and return type does not include 'undefined'."),Type_parameter_name_cannot_be_0:t(2368,e.DiagnosticCategory.Error,"Type_parameter_name_cannot_be_0_2368","Type parameter name cannot be '{0}'."),A_parameter_property_is_only_allowed_in_a_constructor_implementation:t(2369,e.DiagnosticCategory.Error,"A_parameter_property_is_only_allowed_in_a_constructor_implementation_2369","A parameter property is only allowed in a constructor implementation."),A_rest_parameter_must_be_of_an_array_type:t(2370,e.DiagnosticCategory.Error,"A_rest_parameter_must_be_of_an_array_type_2370","A rest parameter must be of an array type."),A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation:t(2371,e.DiagnosticCategory.Error,"A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation_2371","A parameter initializer is only allowed in a function or constructor implementation."),Parameter_0_cannot_be_referenced_in_its_initializer:t(2372,e.DiagnosticCategory.Error,"Parameter_0_cannot_be_referenced_in_its_initializer_2372","Parameter '{0}' cannot be referenced in its initializer."),Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it:t(2373,e.DiagnosticCategory.Error,"Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it_2373","Initializer of parameter '{0}' cannot reference identifier '{1}' declared after it."),Duplicate_string_index_signature:t(2374,e.DiagnosticCategory.Error,"Duplicate_string_index_signature_2374","Duplicate string index signature."),Duplicate_number_index_signature:t(2375,e.DiagnosticCategory.Error,"Duplicate_number_index_signature_2375","Duplicate number index signature."),A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_properties_or_has_parameter_properties:t(2376,e.DiagnosticCategory.Error,"A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_proper_2376","A 'super' call must be the first statement in the constructor when a class contains initialized properties or has parameter properties."),Constructors_for_derived_classes_must_contain_a_super_call:t(2377,e.DiagnosticCategory.Error,"Constructors_for_derived_classes_must_contain_a_super_call_2377","Constructors for derived classes must contain a 'super' call."),A_get_accessor_must_return_a_value:t(2378,e.DiagnosticCategory.Error,"A_get_accessor_must_return_a_value_2378","A 'get' accessor must return a value."),Getter_and_setter_accessors_do_not_agree_in_visibility:t(2379,e.DiagnosticCategory.Error,"Getter_and_setter_accessors_do_not_agree_in_visibility_2379","Getter and setter accessors do not agree in visibility."),get_and_set_accessor_must_have_the_same_type:t(2380,e.DiagnosticCategory.Error,"get_and_set_accessor_must_have_the_same_type_2380","'get' and 'set' accessor must have the same type."),A_signature_with_an_implementation_cannot_use_a_string_literal_type:t(2381,e.DiagnosticCategory.Error,"A_signature_with_an_implementation_cannot_use_a_string_literal_type_2381","A signature with an implementation cannot use a string literal type."),Specialized_overload_signature_is_not_assignable_to_any_non_specialized_signature:t(2382,e.DiagnosticCategory.Error,"Specialized_overload_signature_is_not_assignable_to_any_non_specialized_signature_2382","Specialized overload signature is not assignable to any non-specialized signature."),Overload_signatures_must_all_be_exported_or_non_exported:t(2383,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_exported_or_non_exported_2383","Overload signatures must all be exported or non-exported."),Overload_signatures_must_all_be_ambient_or_non_ambient:t(2384,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_ambient_or_non_ambient_2384","Overload signatures must all be ambient or non-ambient."),Overload_signatures_must_all_be_public_private_or_protected:t(2385,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_public_private_or_protected_2385","Overload signatures must all be public, private or protected."),Overload_signatures_must_all_be_optional_or_required:t(2386,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_optional_or_required_2386","Overload signatures must all be optional or required."),Function_overload_must_be_static:t(2387,e.DiagnosticCategory.Error,"Function_overload_must_be_static_2387","Function overload must be static."),Function_overload_must_not_be_static:t(2388,e.DiagnosticCategory.Error,"Function_overload_must_not_be_static_2388","Function overload must not be static."),Function_implementation_name_must_be_0:t(2389,e.DiagnosticCategory.Error,"Function_implementation_name_must_be_0_2389","Function implementation name must be '{0}'."),Constructor_implementation_is_missing:t(2390,e.DiagnosticCategory.Error,"Constructor_implementation_is_missing_2390","Constructor implementation is missing."),Function_implementation_is_missing_or_not_immediately_following_the_declaration:t(2391,e.DiagnosticCategory.Error,"Function_implementation_is_missing_or_not_immediately_following_the_declaration_2391","Function implementation is missing or not immediately following the declaration."),Multiple_constructor_implementations_are_not_allowed:t(2392,e.DiagnosticCategory.Error,"Multiple_constructor_implementations_are_not_allowed_2392","Multiple constructor implementations are not allowed."),Duplicate_function_implementation:t(2393,e.DiagnosticCategory.Error,"Duplicate_function_implementation_2393","Duplicate function implementation."),Overload_signature_is_not_compatible_with_function_implementation:t(2394,e.DiagnosticCategory.Error,"Overload_signature_is_not_compatible_with_function_implementation_2394","Overload signature is not compatible with function implementation."),Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local:t(2395,e.DiagnosticCategory.Error,"Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local_2395","Individual declarations in merged declaration '{0}' must be all exported or all local."),Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters:t(2396,e.DiagnosticCategory.Error,"Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters_2396","Duplicate identifier 'arguments'. Compiler uses 'arguments' to initialize rest parameters."),Declaration_name_conflicts_with_built_in_global_identifier_0:t(2397,e.DiagnosticCategory.Error,"Declaration_name_conflicts_with_built_in_global_identifier_0_2397","Declaration name conflicts with built-in global identifier '{0}'."),Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference:t(2399,e.DiagnosticCategory.Error,"Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference_2399","Duplicate identifier '_this'. Compiler uses variable declaration '_this' to capture 'this' reference."),Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference:t(2400,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference_2400","Expression resolves to variable declaration '_this' that compiler uses to capture 'this' reference."),Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference:t(2401,e.DiagnosticCategory.Error,"Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference_2401","Duplicate identifier '_super'. Compiler uses '_super' to capture base class reference."),Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference:t(2402,e.DiagnosticCategory.Error,"Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference_2402","Expression resolves to '_super' that compiler uses to capture base class reference."),Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2:t(2403,e.DiagnosticCategory.Error,"Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_t_2403","Subsequent variable declarations must have the same type.  Variable '{0}' must be of type '{1}', but here has type '{2}'."),The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation:t(2404,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation_2404","The left-hand side of a 'for...in' statement cannot use a type annotation."),The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any:t(2405,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any_2405","The left-hand side of a 'for...in' statement must be of type 'string' or 'any'."),The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access:t(2406,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access_2406","The left-hand side of a 'for...in' statement must be a variable or a property access."),The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2407,e.DiagnosticCategory.Error,"The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter_2407","The right-hand side of a 'for...in' statement must be of type 'any', an object type or a type parameter."),Setters_cannot_return_a_value:t(2408,e.DiagnosticCategory.Error,"Setters_cannot_return_a_value_2408","Setters cannot return a value."),Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class:t(2409,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class_2409","Return type of constructor signature must be assignable to the instance type of the class."),The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any:t(2410,e.DiagnosticCategory.Error,"The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any_2410","The 'with' statement is not supported. All symbols in a 'with' block will have type 'any'."),Property_0_of_type_1_is_not_assignable_to_string_index_type_2:t(2411,e.DiagnosticCategory.Error,"Property_0_of_type_1_is_not_assignable_to_string_index_type_2_2411","Property '{0}' of type '{1}' is not assignable to string index type '{2}'."),Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2:t(2412,e.DiagnosticCategory.Error,"Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2_2412","Property '{0}' of type '{1}' is not assignable to numeric index type '{2}'."),Numeric_index_type_0_is_not_assignable_to_string_index_type_1:t(2413,e.DiagnosticCategory.Error,"Numeric_index_type_0_is_not_assignable_to_string_index_type_1_2413","Numeric index type '{0}' is not assignable to string index type '{1}'."),Class_name_cannot_be_0:t(2414,e.DiagnosticCategory.Error,"Class_name_cannot_be_0_2414","Class name cannot be '{0}'."),Class_0_incorrectly_extends_base_class_1:t(2415,e.DiagnosticCategory.Error,"Class_0_incorrectly_extends_base_class_1_2415","Class '{0}' incorrectly extends base class '{1}'."),Class_static_side_0_incorrectly_extends_base_class_static_side_1:t(2417,e.DiagnosticCategory.Error,"Class_static_side_0_incorrectly_extends_base_class_static_side_1_2417","Class static side '{0}' incorrectly extends base class static side '{1}'."),Class_0_incorrectly_implements_interface_1:t(2420,e.DiagnosticCategory.Error,"Class_0_incorrectly_implements_interface_1_2420","Class '{0}' incorrectly implements interface '{1}'."),A_class_may_only_implement_another_class_or_interface:t(2422,e.DiagnosticCategory.Error,"A_class_may_only_implement_another_class_or_interface_2422","A class may only implement another class or interface."),Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_accessor:t(2423,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_access_2423","Class '{0}' defines instance member function '{1}', but extended class '{2}' defines it as instance member accessor."),Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_property:t(2424,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_proper_2424","Class '{0}' defines instance member function '{1}', but extended class '{2}' defines it as instance member property."),Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_function:t(2425,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_functi_2425","Class '{0}' defines instance member property '{1}', but extended class '{2}' defines it as instance member function."),Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_function:t(2426,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_functi_2426","Class '{0}' defines instance member accessor '{1}', but extended class '{2}' defines it as instance member function."),Interface_name_cannot_be_0:t(2427,e.DiagnosticCategory.Error,"Interface_name_cannot_be_0_2427","Interface name cannot be '{0}'."),All_declarations_of_0_must_have_identical_type_parameters:t(2428,e.DiagnosticCategory.Error,"All_declarations_of_0_must_have_identical_type_parameters_2428","All declarations of '{0}' must have identical type parameters."),Interface_0_incorrectly_extends_interface_1:t(2430,e.DiagnosticCategory.Error,"Interface_0_incorrectly_extends_interface_1_2430","Interface '{0}' incorrectly extends interface '{1}'."),Enum_name_cannot_be_0:t(2431,e.DiagnosticCategory.Error,"Enum_name_cannot_be_0_2431","Enum name cannot be '{0}'."),In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enum_element:t(2432,e.DiagnosticCategory.Error,"In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enu_2432","In an enum with multiple declarations, only one declaration can omit an initializer for its first enum element."),A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merged:t(2433,e.DiagnosticCategory.Error,"A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merg_2433","A namespace declaration cannot be in a different file from a class or function with which it is merged."),A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged:t(2434,e.DiagnosticCategory.Error,"A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged_2434","A namespace declaration cannot be located prior to a class or function with which it is merged."),Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces:t(2435,e.DiagnosticCategory.Error,"Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces_2435","Ambient modules cannot be nested in other modules or namespaces."),Ambient_module_declaration_cannot_specify_relative_module_name:t(2436,e.DiagnosticCategory.Error,"Ambient_module_declaration_cannot_specify_relative_module_name_2436","Ambient module declaration cannot specify relative module name."),Module_0_is_hidden_by_a_local_declaration_with_the_same_name:t(2437,e.DiagnosticCategory.Error,"Module_0_is_hidden_by_a_local_declaration_with_the_same_name_2437","Module '{0}' is hidden by a local declaration with the same name."),Import_name_cannot_be_0:t(2438,e.DiagnosticCategory.Error,"Import_name_cannot_be_0_2438","Import name cannot be '{0}'."),Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relative_module_name:t(2439,e.DiagnosticCategory.Error,"Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relati_2439","Import or export declaration in an ambient module declaration cannot reference module through relative module name."),Import_declaration_conflicts_with_local_declaration_of_0:t(2440,e.DiagnosticCategory.Error,"Import_declaration_conflicts_with_local_declaration_of_0_2440","Import declaration conflicts with local declaration of '{0}'."),Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module:t(2441,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_2441","Duplicate identifier '{0}'. Compiler reserves name '{1}' in top level scope of a module."),Types_have_separate_declarations_of_a_private_property_0:t(2442,e.DiagnosticCategory.Error,"Types_have_separate_declarations_of_a_private_property_0_2442","Types have separate declarations of a private property '{0}'."),Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2:t(2443,e.DiagnosticCategory.Error,"Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2_2443","Property '{0}' is protected but type '{1}' is not a class derived from '{2}'."),Property_0_is_protected_in_type_1_but_public_in_type_2:t(2444,e.DiagnosticCategory.Error,"Property_0_is_protected_in_type_1_but_public_in_type_2_2444","Property '{0}' is protected in type '{1}' but public in type '{2}'."),Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses:t(2445,e.DiagnosticCategory.Error,"Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses_2445","Property '{0}' is protected and only accessible within class '{1}' and its subclasses."),Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1:t(2446,e.DiagnosticCategory.Error,"Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1_2446","Property '{0}' is protected and only accessible through an instance of class '{1}'."),The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead:t(2447,e.DiagnosticCategory.Error,"The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead_2447","The '{0}' operator is not allowed for boolean types. Consider using '{1}' instead."),Block_scoped_variable_0_used_before_its_declaration:t(2448,e.DiagnosticCategory.Error,"Block_scoped_variable_0_used_before_its_declaration_2448","Block-scoped variable '{0}' used before its declaration."),Class_0_used_before_its_declaration:t(2449,e.DiagnosticCategory.Error,"Class_0_used_before_its_declaration_2449","Class '{0}' used before its declaration."),Enum_0_used_before_its_declaration:t(2450,e.DiagnosticCategory.Error,"Enum_0_used_before_its_declaration_2450","Enum '{0}' used before its declaration."),Cannot_redeclare_block_scoped_variable_0:t(2451,e.DiagnosticCategory.Error,"Cannot_redeclare_block_scoped_variable_0_2451","Cannot redeclare block-scoped variable '{0}'."),An_enum_member_cannot_have_a_numeric_name:t(2452,e.DiagnosticCategory.Error,"An_enum_member_cannot_have_a_numeric_name_2452","An enum member cannot have a numeric name."),The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_type_arguments_explicitly:t(2453,e.DiagnosticCategory.Error,"The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_typ_2453","The type argument for type parameter '{0}' cannot be inferred from the usage. Consider specifying the type arguments explicitly."),Variable_0_is_used_before_being_assigned:t(2454,e.DiagnosticCategory.Error,"Variable_0_is_used_before_being_assigned_2454","Variable '{0}' is used before being assigned."),Type_argument_candidate_1_is_not_a_valid_type_argument_because_it_is_not_a_supertype_of_candidate_0:t(2455,e.DiagnosticCategory.Error,"Type_argument_candidate_1_is_not_a_valid_type_argument_because_it_is_not_a_supertype_of_candidate_0_2455","Type argument candidate '{1}' is not a valid type argument because it is not a supertype of candidate '{0}'."),Type_alias_0_circularly_references_itself:t(2456,e.DiagnosticCategory.Error,"Type_alias_0_circularly_references_itself_2456","Type alias '{0}' circularly references itself."),Type_alias_name_cannot_be_0:t(2457,e.DiagnosticCategory.Error,"Type_alias_name_cannot_be_0_2457","Type alias name cannot be '{0}'."),An_AMD_module_cannot_have_multiple_name_assignments:t(2458,e.DiagnosticCategory.Error,"An_AMD_module_cannot_have_multiple_name_assignments_2458","An AMD module cannot have multiple name assignments."),Type_0_has_no_property_1_and_no_string_index_signature:t(2459,e.DiagnosticCategory.Error,"Type_0_has_no_property_1_and_no_string_index_signature_2459","Type '{0}' has no property '{1}' and no string index signature."),Type_0_has_no_property_1:t(2460,e.DiagnosticCategory.Error,"Type_0_has_no_property_1_2460","Type '{0}' has no property '{1}'."),Type_0_is_not_an_array_type:t(2461,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_2461","Type '{0}' is not an array type."),A_rest_element_must_be_last_in_a_destructuring_pattern:t(2462,e.DiagnosticCategory.Error,"A_rest_element_must_be_last_in_a_destructuring_pattern_2462","A rest element must be last in a destructuring pattern."),A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature:t(2463,e.DiagnosticCategory.Error,"A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature_2463","A binding pattern parameter cannot be optional in an implementation signature."),A_computed_property_name_must_be_of_type_string_number_symbol_or_any:t(2464,e.DiagnosticCategory.Error,"A_computed_property_name_must_be_of_type_string_number_symbol_or_any_2464","A computed property name must be of type 'string', 'number', 'symbol', or 'any'."),this_cannot_be_referenced_in_a_computed_property_name:t(2465,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_computed_property_name_2465","'this' cannot be referenced in a computed property name."),super_cannot_be_referenced_in_a_computed_property_name:t(2466,e.DiagnosticCategory.Error,"super_cannot_be_referenced_in_a_computed_property_name_2466","'super' cannot be referenced in a computed property name."),A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type:t(2467,e.DiagnosticCategory.Error,"A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type_2467","A computed property name cannot reference a type parameter from its containing type."),Cannot_find_global_value_0:t(2468,e.DiagnosticCategory.Error,"Cannot_find_global_value_0_2468","Cannot find global value '{0}'."),The_0_operator_cannot_be_applied_to_type_symbol:t(2469,e.DiagnosticCategory.Error,"The_0_operator_cannot_be_applied_to_type_symbol_2469","The '{0}' operator cannot be applied to type 'symbol'."),Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object:t(2470,e.DiagnosticCategory.Error,"Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object_2470","'Symbol' reference does not refer to the global Symbol constructor object."),A_computed_property_name_of_the_form_0_must_be_of_type_symbol:t(2471,e.DiagnosticCategory.Error,"A_computed_property_name_of_the_form_0_must_be_of_type_symbol_2471","A computed property name of the form '{0}' must be of type 'symbol'."),Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher:t(2472,e.DiagnosticCategory.Error,"Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher_2472","Spread operator in 'new' expressions is only available when targeting ECMAScript 5 and higher."),Enum_declarations_must_all_be_const_or_non_const:t(2473,e.DiagnosticCategory.Error,"Enum_declarations_must_all_be_const_or_non_const_2473","Enum declarations must all be const or non-const."),In_const_enum_declarations_member_initializer_must_be_constant_expression:t(2474,e.DiagnosticCategory.Error,"In_const_enum_declarations_member_initializer_must_be_constant_expression_2474","In 'const' enum declarations member initializer must be constant expression."),const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_import_declaration_or_export_assignment:t(2475,e.DiagnosticCategory.Error,"const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_im_2475","'const' enums can only be used in property or index access expressions or the right hand side of an import declaration or export assignment."),A_const_enum_member_can_only_be_accessed_using_a_string_literal:t(2476,e.DiagnosticCategory.Error,"A_const_enum_member_can_only_be_accessed_using_a_string_literal_2476","A const enum member can only be accessed using a string literal."),const_enum_member_initializer_was_evaluated_to_a_non_finite_value:t(2477,e.DiagnosticCategory.Error,"const_enum_member_initializer_was_evaluated_to_a_non_finite_value_2477","'const' enum member initializer was evaluated to a non-finite value."),const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN:t(2478,e.DiagnosticCategory.Error,"const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN_2478","'const' enum member initializer was evaluated to disallowed value 'NaN'."),Property_0_does_not_exist_on_const_enum_1:t(2479,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_const_enum_1_2479","Property '{0}' does not exist on 'const' enum '{1}'."),let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations:t(2480,e.DiagnosticCategory.Error,"let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations_2480","'let' is not allowed to be used as a name in 'let' or 'const' declarations."),Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1:t(2481,e.DiagnosticCategory.Error,"Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1_2481","Cannot initialize outer scoped variable '{0}' in the same scope as block scoped declaration '{1}'."),The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation:t(2483,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation_2483","The left-hand side of a 'for...of' statement cannot use a type annotation."),Export_declaration_conflicts_with_exported_declaration_of_0:t(2484,e.DiagnosticCategory.Error,"Export_declaration_conflicts_with_exported_declaration_of_0_2484","Export declaration conflicts with exported declaration of '{0}'."),The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access:t(2487,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access_2487","The left-hand side of a 'for...of' statement must be a variable or a property access."),Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2488,e.DiagnosticCategory.Error,"Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator_2488","Type must have a '[Symbol.iterator]()' method that returns an iterator."),An_iterator_must_have_a_next_method:t(2489,e.DiagnosticCategory.Error,"An_iterator_must_have_a_next_method_2489","An iterator must have a 'next()' method."),The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property:t(2490,e.DiagnosticCategory.Error,"The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property_2490","The type returned by the 'next()' method of an iterator must have a 'value' property."),The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern:t(2491,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern_2491","The left-hand side of a 'for...in' statement cannot be a destructuring pattern."),Cannot_redeclare_identifier_0_in_catch_clause:t(2492,e.DiagnosticCategory.Error,"Cannot_redeclare_identifier_0_in_catch_clause_2492","Cannot redeclare identifier '{0}' in catch clause."),Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2:t(2493,e.DiagnosticCategory.Error,"Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2_2493","Tuple type '{0}' with length '{1}' cannot be assigned to tuple with length '{2}'."),Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher:t(2494,e.DiagnosticCategory.Error,"Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher_2494","Using a string in a 'for...of' statement is only supported in ECMAScript 5 and higher."),Type_0_is_not_an_array_type_or_a_string_type:t(2495,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_a_string_type_2495","Type '{0}' is not an array type or a string type."),The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_standard_function_expression:t(2496,e.DiagnosticCategory.Error,"The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_stand_2496","The 'arguments' object cannot be referenced in an arrow function in ES3 and ES5. Consider using a standard function expression."),Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct:t(2497,e.DiagnosticCategory.Error,"Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct_2497","Module '{0}' resolves to a non-module entity and cannot be imported using this construct."),Module_0_uses_export_and_cannot_be_used_with_export_Asterisk:t(2498,e.DiagnosticCategory.Error,"Module_0_uses_export_and_cannot_be_used_with_export_Asterisk_2498","Module '{0}' uses 'export =' and cannot be used with 'export *'."),An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments:t(2499,e.DiagnosticCategory.Error,"An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments_2499","An interface can only extend an identifier/qualified-name with optional type arguments."),A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments:t(2500,e.DiagnosticCategory.Error,"A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments_2500","A class can only implement an identifier/qualified-name with optional type arguments."),A_rest_element_cannot_contain_a_binding_pattern:t(2501,e.DiagnosticCategory.Error,"A_rest_element_cannot_contain_a_binding_pattern_2501","A rest element cannot contain a binding pattern."),_0_is_referenced_directly_or_indirectly_in_its_own_type_annotation:t(2502,e.DiagnosticCategory.Error,"_0_is_referenced_directly_or_indirectly_in_its_own_type_annotation_2502","'{0}' is referenced directly or indirectly in its own type annotation."),Cannot_find_namespace_0:t(2503,e.DiagnosticCategory.Error,"Cannot_find_namespace_0_2503","Cannot find namespace '{0}'."),Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator:t(2504,e.DiagnosticCategory.Error,"Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator_2504","Type must have a '[Symbol.asyncIterator]()' method that returns an async iterator."),A_generator_cannot_have_a_void_type_annotation:t(2505,e.DiagnosticCategory.Error,"A_generator_cannot_have_a_void_type_annotation_2505","A generator cannot have a 'void' type annotation."),_0_is_referenced_directly_or_indirectly_in_its_own_base_expression:t(2506,e.DiagnosticCategory.Error,"_0_is_referenced_directly_or_indirectly_in_its_own_base_expression_2506","'{0}' is referenced directly or indirectly in its own base expression."),Type_0_is_not_a_constructor_function_type:t(2507,e.DiagnosticCategory.Error,"Type_0_is_not_a_constructor_function_type_2507","Type '{0}' is not a constructor function type."),No_base_constructor_has_the_specified_number_of_type_arguments:t(2508,e.DiagnosticCategory.Error,"No_base_constructor_has_the_specified_number_of_type_arguments_2508","No base constructor has the specified number of type arguments."),Base_constructor_return_type_0_is_not_a_class_or_interface_type:t(2509,e.DiagnosticCategory.Error,"Base_constructor_return_type_0_is_not_a_class_or_interface_type_2509","Base constructor return type '{0}' is not a class or interface type."),Base_constructors_must_all_have_the_same_return_type:t(2510,e.DiagnosticCategory.Error,"Base_constructors_must_all_have_the_same_return_type_2510","Base constructors must all have the same return type."),Cannot_create_an_instance_of_the_abstract_class_0:t(2511,e.DiagnosticCategory.Error,"Cannot_create_an_instance_of_the_abstract_class_0_2511","Cannot create an instance of the abstract class '{0}'."),Overload_signatures_must_all_be_abstract_or_non_abstract:t(2512,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_abstract_or_non_abstract_2512","Overload signatures must all be abstract or non-abstract."),Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression:t(2513,e.DiagnosticCategory.Error,"Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression_2513","Abstract method '{0}' in class '{1}' cannot be accessed via super expression."),Classes_containing_abstract_methods_must_be_marked_abstract:t(2514,e.DiagnosticCategory.Error,"Classes_containing_abstract_methods_must_be_marked_abstract_2514","Classes containing abstract methods must be marked abstract."),Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2:t(2515,e.DiagnosticCategory.Error,"Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2_2515","Non-abstract class '{0}' does not implement inherited abstract member '{1}' from class '{2}'."),All_declarations_of_an_abstract_method_must_be_consecutive:t(2516,e.DiagnosticCategory.Error,"All_declarations_of_an_abstract_method_must_be_consecutive_2516","All declarations of an abstract method must be consecutive."),Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type:t(2517,e.DiagnosticCategory.Error,"Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type_2517","Cannot assign an abstract constructor type to a non-abstract constructor type."),A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard:t(2518,e.DiagnosticCategory.Error,"A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard_2518","A 'this'-based type guard is not compatible with a parameter-based type guard."),An_async_iterator_must_have_a_next_method:t(2519,e.DiagnosticCategory.Error,"An_async_iterator_must_have_a_next_method_2519","An async iterator must have a 'next()' method."),Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions:t(2520,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions_2520","Duplicate identifier '{0}'. Compiler uses declaration '{1}' to support async functions."),Expression_resolves_to_variable_declaration_0_that_compiler_uses_to_support_async_functions:t(2521,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_0_that_compiler_uses_to_support_async_functions_2521","Expression resolves to variable declaration '{0}' that compiler uses to support async functions."),The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_using_a_standard_function_or_method:t(2522,e.DiagnosticCategory.Error,"The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_usi_2522","The 'arguments' object cannot be referenced in an async function or method in ES3 and ES5. Consider using a standard function or method."),yield_expressions_cannot_be_used_in_a_parameter_initializer:t(2523,e.DiagnosticCategory.Error,"yield_expressions_cannot_be_used_in_a_parameter_initializer_2523","'yield' expressions cannot be used in a parameter initializer."),await_expressions_cannot_be_used_in_a_parameter_initializer:t(2524,e.DiagnosticCategory.Error,"await_expressions_cannot_be_used_in_a_parameter_initializer_2524","'await' expressions cannot be used in a parameter initializer."),Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value:t(2525,e.DiagnosticCategory.Error,"Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value_2525","Initializer provides no value for this binding element and the binding element has no default value."),A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface:t(2526,e.DiagnosticCategory.Error,"A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface_2526","A 'this' type is available only in a non-static member of a class or interface."),The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary:t(2527,e.DiagnosticCategory.Error,"The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary_2527","The inferred type of '{0}' references an inaccessible 'this' type. A type annotation is necessary."),A_module_cannot_have_multiple_default_exports:t(2528,e.DiagnosticCategory.Error,"A_module_cannot_have_multiple_default_exports_2528","A module cannot have multiple default exports."),Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_functions:t(2529,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_func_2529","Duplicate identifier '{0}'. Compiler reserves name '{1}' in top level scope of a module containing async functions."),Property_0_is_incompatible_with_index_signature:t(2530,e.DiagnosticCategory.Error,"Property_0_is_incompatible_with_index_signature_2530","Property '{0}' is incompatible with index signature."),Object_is_possibly_null:t(2531,e.DiagnosticCategory.Error,"Object_is_possibly_null_2531","Object is possibly 'null'."),Object_is_possibly_undefined:t(2532,e.DiagnosticCategory.Error,"Object_is_possibly_undefined_2532","Object is possibly 'undefined'."),Object_is_possibly_null_or_undefined:t(2533,e.DiagnosticCategory.Error,"Object_is_possibly_null_or_undefined_2533","Object is possibly 'null' or 'undefined'."),A_function_returning_never_cannot_have_a_reachable_end_point:t(2534,e.DiagnosticCategory.Error,"A_function_returning_never_cannot_have_a_reachable_end_point_2534","A function returning 'never' cannot have a reachable end point."),Enum_type_0_has_members_with_initializers_that_are_not_literals:t(2535,e.DiagnosticCategory.Error,"Enum_type_0_has_members_with_initializers_that_are_not_literals_2535","Enum type '{0}' has members with initializers that are not literals."),Type_0_cannot_be_used_to_index_type_1:t(2536,e.DiagnosticCategory.Error,"Type_0_cannot_be_used_to_index_type_1_2536","Type '{0}' cannot be used to index type '{1}'."),Type_0_has_no_matching_index_signature_for_type_1:t(2537,e.DiagnosticCategory.Error,"Type_0_has_no_matching_index_signature_for_type_1_2537","Type '{0}' has no matching index signature for type '{1}'."),Type_0_cannot_be_used_as_an_index_type:t(2538,e.DiagnosticCategory.Error,"Type_0_cannot_be_used_as_an_index_type_2538","Type '{0}' cannot be used as an index type."),Cannot_assign_to_0_because_it_is_not_a_variable:t(2539,e.DiagnosticCategory.Error,"Cannot_assign_to_0_because_it_is_not_a_variable_2539","Cannot assign to '{0}' because it is not a variable."),Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property:t(2540,e.DiagnosticCategory.Error,"Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property_2540","Cannot assign to '{0}' because it is a constant or a read-only property."),The_target_of_an_assignment_must_be_a_variable_or_a_property_access:t(2541,e.DiagnosticCategory.Error,"The_target_of_an_assignment_must_be_a_variable_or_a_property_access_2541","The target of an assignment must be a variable or a property access."),Index_signature_in_type_0_only_permits_reading:t(2542,e.DiagnosticCategory.Error,"Index_signature_in_type_0_only_permits_reading_2542","Index signature in type '{0}' only permits reading."),Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_meta_property_reference:t(2543,e.DiagnosticCategory.Error,"Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_me_2543","Duplicate identifier '_newTarget'. Compiler uses variable declaration '_newTarget' to capture 'new.target' meta-property reference."),Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta_property_reference:t(2544,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta__2544","Expression resolves to variable declaration '_newTarget' that compiler uses to capture 'new.target' meta-property reference."),A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any:t(2545,e.DiagnosticCategory.Error,"A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any_2545","A mixin class must have a constructor with a single rest parameter of type 'any[]'."),Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1:t(2546,e.DiagnosticCategory.Error,"Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1_2546","Property '{0}' has conflicting declarations and is inaccessible in type '{1}'."),The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property:t(2547,e.DiagnosticCategory.Error,"The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value__2547","The type returned by the 'next()' method of an async iterator must be a promise for a type with a 'value' property."),Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2548,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator_2548","Type '{0}' is not an array type or does not have a '[Symbol.iterator]()' method that returns an iterator."),Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2549,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns__2549","Type '{0}' is not an array type or a string type or does not have a '[Symbol.iterator]()' method that returns an iterator."),Generic_type_instantiation_is_excessively_deep_and_possibly_infinite:t(2550,e.DiagnosticCategory.Error,"Generic_type_instantiation_is_excessively_deep_and_possibly_infinite_2550","Generic type instantiation is excessively deep and possibly infinite."),Property_0_does_not_exist_on_type_1_Did_you_mean_2:t(2551,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_type_1_Did_you_mean_2_2551","Property '{0}' does not exist on type '{1}'. Did you mean '{2}'?"),Cannot_find_name_0_Did_you_mean_1:t(2552,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_1_2552","Cannot find name '{0}'. Did you mean '{1}'?"),Computed_values_are_not_permitted_in_an_enum_with_string_valued_members:t(2553,e.DiagnosticCategory.Error,"Computed_values_are_not_permitted_in_an_enum_with_string_valued_members_2553","Computed values are not permitted in an enum with string valued members."),Expected_0_arguments_but_got_1:t(2554,e.DiagnosticCategory.Error,"Expected_0_arguments_but_got_1_2554","Expected {0} arguments, but got {1}."),Expected_at_least_0_arguments_but_got_1:t(2555,e.DiagnosticCategory.Error,"Expected_at_least_0_arguments_but_got_1_2555","Expected at least {0} arguments, but got {1}."),Expected_0_arguments_but_got_a_minimum_of_1:t(2556,e.DiagnosticCategory.Error,"Expected_0_arguments_but_got_a_minimum_of_1_2556","Expected {0} arguments, but got a minimum of {1}."),Expected_at_least_0_arguments_but_got_a_minimum_of_1:t(2557,e.DiagnosticCategory.Error,"Expected_at_least_0_arguments_but_got_a_minimum_of_1_2557","Expected at least {0} arguments, but got a minimum of {1}."),Expected_0_type_arguments_but_got_1:t(2558,e.DiagnosticCategory.Error,"Expected_0_type_arguments_but_got_1_2558","Expected {0} type arguments, but got {1}."),Type_0_has_no_properties_in_common_with_type_1:t(2559,e.DiagnosticCategory.Error,"Type_0_has_no_properties_in_common_with_type_1_2559","Type '{0}' has no properties in common with type '{1}'."),Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it:t(2560,e.DiagnosticCategory.Error,"Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it_2560","Value of type '{0}' has no properties in common with type '{1}'. Did you mean to call it?"),Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_write_2:t(2561,e.DiagnosticCategory.Error,"Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_writ_2561","Object literal may only specify known properties, but '{0}' does not exist in type '{1}'. Did you mean to write '{2}'?"),Base_class_expressions_cannot_reference_class_type_parameters:t(2562,e.DiagnosticCategory.Error,"Base_class_expressions_cannot_reference_class_type_parameters_2562","Base class expressions cannot reference class type parameters."),The_containing_function_or_module_body_is_too_large_for_control_flow_analysis:t(2563,e.DiagnosticCategory.Error,"The_containing_function_or_module_body_is_too_large_for_control_flow_analysis_2563","The containing function or module body is too large for control flow analysis."),JSX_element_attributes_type_0_may_not_be_a_union_type:t(2600,e.DiagnosticCategory.Error,"JSX_element_attributes_type_0_may_not_be_a_union_type_2600","JSX element attributes type '{0}' may not be a union type."),The_return_type_of_a_JSX_element_constructor_must_return_an_object_type:t(2601,e.DiagnosticCategory.Error,"The_return_type_of_a_JSX_element_constructor_must_return_an_object_type_2601","The return type of a JSX element constructor must return an object type."),JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist:t(2602,e.DiagnosticCategory.Error,"JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist_2602","JSX element implicitly has type 'any' because the global type 'JSX.Element' does not exist."),Property_0_in_type_1_is_not_assignable_to_type_2:t(2603,e.DiagnosticCategory.Error,"Property_0_in_type_1_is_not_assignable_to_type_2_2603","Property '{0}' in type '{1}' is not assignable to type '{2}'."),JSX_element_type_0_does_not_have_any_construct_or_call_signatures:t(2604,e.DiagnosticCategory.Error,"JSX_element_type_0_does_not_have_any_construct_or_call_signatures_2604","JSX element type '{0}' does not have any construct or call signatures."),JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements:t(2605,e.DiagnosticCategory.Error,"JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements_2605","JSX element type '{0}' is not a constructor function for JSX elements."),Property_0_of_JSX_spread_attribute_is_not_assignable_to_target_property:t(2606,e.DiagnosticCategory.Error,"Property_0_of_JSX_spread_attribute_is_not_assignable_to_target_property_2606","Property '{0}' of JSX spread attribute is not assignable to target property."),JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property:t(2607,e.DiagnosticCategory.Error,"JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property_2607","JSX element class does not support attributes because it does not have a '{0}' property."),The_global_type_JSX_0_may_not_have_more_than_one_property:t(2608,e.DiagnosticCategory.Error,"The_global_type_JSX_0_may_not_have_more_than_one_property_2608","The global type 'JSX.{0}' may not have more than one property."),JSX_spread_child_must_be_an_array_type:t(2609,e.DiagnosticCategory.Error,"JSX_spread_child_must_be_an_array_type_2609","JSX spread child must be an array type."),Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity:t(2649,e.DiagnosticCategory.Error,"Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity_2649","Cannot augment module '{0}' with value exports because it resolves to a non-module entity."),A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums:t(2651,e.DiagnosticCategory.Error,"A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_memb_2651","A member initializer in a enum declaration cannot reference members declared after it, including members defined in other enums."),Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_default_0_declaration_instead:t(2652,e.DiagnosticCategory.Error,"Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_d_2652","Merged declaration '{0}' cannot include a default export declaration. Consider adding a separate 'export default {0}' declaration instead."),Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1:t(2653,e.DiagnosticCategory.Error,"Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1_2653","Non-abstract class expression does not implement inherited abstract member '{0}' from class '{1}'."),Exported_external_package_typings_file_cannot_contain_tripleslash_references_Please_contact_the_package_author_to_update_the_package_definition:t(2654,e.DiagnosticCategory.Error,"Exported_external_package_typings_file_cannot_contain_tripleslash_references_Please_contact_the_pack_2654","Exported external package typings file cannot contain tripleslash references. Please contact the package author to update the package definition."),Exported_external_package_typings_file_0_is_not_a_module_Please_contact_the_package_author_to_update_the_package_definition:t(2656,e.DiagnosticCategory.Error,"Exported_external_package_typings_file_0_is_not_a_module_Please_contact_the_package_author_to_update_2656","Exported external package typings file '{0}' is not a module. Please contact the package author to update the package definition."),JSX_expressions_must_have_one_parent_element:t(2657,e.DiagnosticCategory.Error,"JSX_expressions_must_have_one_parent_element_2657","JSX expressions must have one parent element."),Type_0_provides_no_match_for_the_signature_1:t(2658,e.DiagnosticCategory.Error,"Type_0_provides_no_match_for_the_signature_1_2658","Type '{0}' provides no match for the signature '{1}'."),super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_higher:t(2659,e.DiagnosticCategory.Error,"super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_highe_2659","'super' is only allowed in members of object literal expressions when option 'target' is 'ES2015' or higher."),super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions:t(2660,e.DiagnosticCategory.Error,"super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions_2660","'super' can only be referenced in members of derived classes or object literal expressions."),Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module:t(2661,e.DiagnosticCategory.Error,"Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module_2661","Cannot export '{0}'. Only local declarations can be exported from a module."),Cannot_find_name_0_Did_you_mean_the_static_member_1_0:t(2662,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_the_static_member_1_0_2662","Cannot find name '{0}'. Did you mean the static member '{1}.{0}'?"),Cannot_find_name_0_Did_you_mean_the_instance_member_this_0:t(2663,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_the_instance_member_this_0_2663","Cannot find name '{0}'. Did you mean the instance member 'this.{0}'?"),Invalid_module_name_in_augmentation_module_0_cannot_be_found:t(2664,e.DiagnosticCategory.Error,"Invalid_module_name_in_augmentation_module_0_cannot_be_found_2664","Invalid module name in augmentation, module '{0}' cannot be found."),Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augmented:t(2665,e.DiagnosticCategory.Error,"Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augm_2665","Invalid module name in augmentation. Module '{0}' resolves to an untyped module at '{1}', which cannot be augmented."),Exports_and_export_assignments_are_not_permitted_in_module_augmentations:t(2666,e.DiagnosticCategory.Error,"Exports_and_export_assignments_are_not_permitted_in_module_augmentations_2666","Exports and export assignments are not permitted in module augmentations."),Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_module:t(2667,e.DiagnosticCategory.Error,"Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_mod_2667","Imports are not permitted in module augmentations. Consider moving them to the enclosing external module."),export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always_visible:t(2668,e.DiagnosticCategory.Error,"export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always__2668","'export' modifier cannot be applied to ambient modules and module augmentations since they are always visible."),Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations:t(2669,e.DiagnosticCategory.Error,"Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_2669","Augmentations for the global scope can only be directly nested in external modules or ambient module declarations."),Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambient_context:t(2670,e.DiagnosticCategory.Error,"Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambien_2670","Augmentations for the global scope should have 'declare' modifier unless they appear in already ambient context."),Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity:t(2671,e.DiagnosticCategory.Error,"Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity_2671","Cannot augment module '{0}' because it resolves to a non-module entity."),Cannot_assign_a_0_constructor_type_to_a_1_constructor_type:t(2672,e.DiagnosticCategory.Error,"Cannot_assign_a_0_constructor_type_to_a_1_constructor_type_2672","Cannot assign a '{0}' constructor type to a '{1}' constructor type."),Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration:t(2673,e.DiagnosticCategory.Error,"Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration_2673","Constructor of class '{0}' is private and only accessible within the class declaration."),Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration:t(2674,e.DiagnosticCategory.Error,"Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration_2674","Constructor of class '{0}' is protected and only accessible within the class declaration."),Cannot_extend_a_class_0_Class_constructor_is_marked_as_private:t(2675,e.DiagnosticCategory.Error,"Cannot_extend_a_class_0_Class_constructor_is_marked_as_private_2675","Cannot extend a class '{0}'. Class constructor is marked as private."),Accessors_must_both_be_abstract_or_non_abstract:t(2676,e.DiagnosticCategory.Error,"Accessors_must_both_be_abstract_or_non_abstract_2676","Accessors must both be abstract or non-abstract."),A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type:t(2677,e.DiagnosticCategory.Error,"A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type_2677","A type predicate's type must be assignable to its parameter's type."),Type_0_is_not_comparable_to_type_1:t(2678,e.DiagnosticCategory.Error,"Type_0_is_not_comparable_to_type_1_2678","Type '{0}' is not comparable to type '{1}'."),A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void:t(2679,e.DiagnosticCategory.Error,"A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void_2679","A function that is called with the 'new' keyword cannot have a 'this' type that is 'void'."),A_0_parameter_must_be_the_first_parameter:t(2680,e.DiagnosticCategory.Error,"A_0_parameter_must_be_the_first_parameter_2680","A '{0}' parameter must be the first parameter."),A_constructor_cannot_have_a_this_parameter:t(2681,e.DiagnosticCategory.Error,"A_constructor_cannot_have_a_this_parameter_2681","A constructor cannot have a 'this' parameter."),get_and_set_accessor_must_have_the_same_this_type:t(2682,e.DiagnosticCategory.Error,"get_and_set_accessor_must_have_the_same_this_type_2682","'get' and 'set' accessor must have the same 'this' type."),this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation:t(2683,e.DiagnosticCategory.Error,"this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_2683","'this' implicitly has type 'any' because it does not have a type annotation."),The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1:t(2684,e.DiagnosticCategory.Error,"The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1_2684","The 'this' context of type '{0}' is not assignable to method's 'this' of type '{1}'."),The_this_types_of_each_signature_are_incompatible:t(2685,e.DiagnosticCategory.Error,"The_this_types_of_each_signature_are_incompatible_2685","The 'this' types of each signature are incompatible."),_0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead:t(2686,e.DiagnosticCategory.Error,"_0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead_2686","'{0}' refers to a UMD global, but the current file is a module. Consider adding an import instead."),All_declarations_of_0_must_have_identical_modifiers:t(2687,e.DiagnosticCategory.Error,"All_declarations_of_0_must_have_identical_modifiers_2687","All declarations of '{0}' must have identical modifiers."),Cannot_find_type_definition_file_for_0:t(2688,e.DiagnosticCategory.Error,"Cannot_find_type_definition_file_for_0_2688","Cannot find type definition file for '{0}'."),Cannot_extend_an_interface_0_Did_you_mean_implements:t(2689,e.DiagnosticCategory.Error,"Cannot_extend_an_interface_0_Did_you_mean_implements_2689","Cannot extend an interface '{0}'. Did you mean 'implements'?"),An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead:t(2691,e.DiagnosticCategory.Error,"An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead_2691","An import path cannot end with a '{0}' extension. Consider importing '{1}' instead."),_0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible:t(2692,e.DiagnosticCategory.Error,"_0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible_2692","'{0}' is a primitive, but '{1}' is a wrapper object. Prefer using '{0}' when possible."),_0_only_refers_to_a_type_but_is_being_used_as_a_value_here:t(2693,e.DiagnosticCategory.Error,"_0_only_refers_to_a_type_but_is_being_used_as_a_value_here_2693","'{0}' only refers to a type, but is being used as a value here."),Namespace_0_has_no_exported_member_1:t(2694,e.DiagnosticCategory.Error,"Namespace_0_has_no_exported_member_1_2694","Namespace '{0}' has no exported member '{1}'."),Left_side_of_comma_operator_is_unused_and_has_no_side_effects:t(2695,e.DiagnosticCategory.Error,"Left_side_of_comma_operator_is_unused_and_has_no_side_effects_2695","Left side of comma operator is unused and has no side effects."),The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead:t(2696,e.DiagnosticCategory.Error,"The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead_2696","The 'Object' type is assignable to very few other types. Did you mean to use the 'any' type instead?"),An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:t(2697,e.DiagnosticCategory.Error,"An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_in_2697","An async function or method must return a 'Promise'. Make sure you have a declaration for 'Promise' or include 'ES2015' in your `--lib` option."),Spread_types_may_only_be_created_from_object_types:t(2698,e.DiagnosticCategory.Error,"Spread_types_may_only_be_created_from_object_types_2698","Spread types may only be created from object types."),Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1:t(2699,e.DiagnosticCategory.Error,"Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1_2699","Static property '{0}' conflicts with built-in property 'Function.{0}' of constructor function '{1}'."),Rest_types_may_only_be_created_from_object_types:t(2700,e.DiagnosticCategory.Error,"Rest_types_may_only_be_created_from_object_types_2700","Rest types may only be created from object types."),The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access:t(2701,e.DiagnosticCategory.Error,"The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access_2701","The target of an object rest assignment must be a variable or a property access."),_0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here:t(2702,e.DiagnosticCategory.Error,"_0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here_2702","'{0}' only refers to a type, but is being used as a namespace here."),The_operand_of_a_delete_operator_must_be_a_property_reference:t(2703,e.DiagnosticCategory.Error,"The_operand_of_a_delete_operator_must_be_a_property_reference_2703","The operand of a delete operator must be a property reference."),The_operand_of_a_delete_operator_cannot_be_a_read_only_property:t(2704,e.DiagnosticCategory.Error,"The_operand_of_a_delete_operator_cannot_be_a_read_only_property_2704","The operand of a delete operator cannot be a read-only property."),An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:t(2705,e.DiagnosticCategory.Error,"An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_de_2705","An async function or method in ES5/ES3 requires the 'Promise' constructor.  Make sure you have a declaration for the 'Promise' constructor or include 'ES2015' in your `--lib` option."),Required_type_parameters_may_not_follow_optional_type_parameters:t(2706,e.DiagnosticCategory.Error,"Required_type_parameters_may_not_follow_optional_type_parameters_2706","Required type parameters may not follow optional type parameters."),Generic_type_0_requires_between_1_and_2_type_arguments:t(2707,e.DiagnosticCategory.Error,"Generic_type_0_requires_between_1_and_2_type_arguments_2707","Generic type '{0}' requires between {1} and {2} type arguments."),Cannot_use_namespace_0_as_a_value:t(2708,e.DiagnosticCategory.Error,"Cannot_use_namespace_0_as_a_value_2708","Cannot use namespace '{0}' as a value."),Cannot_use_namespace_0_as_a_type:t(2709,e.DiagnosticCategory.Error,"Cannot_use_namespace_0_as_a_type_2709","Cannot use namespace '{0}' as a type."),_0_are_specified_twice_The_attribute_named_0_will_be_overwritten:t(2710,e.DiagnosticCategory.Error,"_0_are_specified_twice_The_attribute_named_0_will_be_overwritten_2710","'{0}' are specified twice. The attribute named '{0}' will be overwritten."),A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:t(2711,e.DiagnosticCategory.Error,"A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES20_2711","A dynamic import call returns a 'Promise'. Make sure you have a declaration for 'Promise' or include 'ES2015' in your `--lib` option."),A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:t(2712,e.DiagnosticCategory.Error,"A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declarat_2712","A dynamic import call in ES5/ES3 requires the 'Promise' constructor.  Make sure you have a declaration for the 'Promise' constructor or include 'ES2015' in your `--lib` option."),Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1:t(2713,e.DiagnosticCategory.Error,"Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_p_2713","Cannot access '{0}.{1}' because '{0}' is a type, but not a namespace. Did you mean to retrieve the type of the property '{1}' in '{0}' with '{0}[\"{1}\"]'?"),The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context:t(2714,e.DiagnosticCategory.Error,"The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context_2714","The expression of an export assignment must be an identifier or qualified name in an ambient context."),Type_parameter_0_has_a_circular_default:t(2716,e.DiagnosticCategory.Error,"Type_parameter_0_has_a_circular_default_2716","Type parameter '{0}' has a circular default."),Import_declaration_0_is_using_private_name_1:t(4e3,e.DiagnosticCategory.Error,"Import_declaration_0_is_using_private_name_1_4000","Import declaration '{0}' is using private name '{1}'."),Type_parameter_0_of_exported_class_has_or_is_using_private_name_1:t(4002,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_class_has_or_is_using_private_name_1_4002","Type parameter '{0}' of exported class has or is using private name '{1}'."),Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1:t(4004,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1_4004","Type parameter '{0}' of exported interface has or is using private name '{1}'."),Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1:t(4006,e.DiagnosticCategory.Error,"Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1_4006","Type parameter '{0}' of constructor signature from exported interface has or is using private name '{1}'."),Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1:t(4008,e.DiagnosticCategory.Error,"Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1_4008","Type parameter '{0}' of call signature from exported interface has or is using private name '{1}'."),Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:t(4010,e.DiagnosticCategory.Error,"Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1_4010","Type parameter '{0}' of public static method from exported class has or is using private name '{1}'."),Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:t(4012,e.DiagnosticCategory.Error,"Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1_4012","Type parameter '{0}' of public method from exported class has or is using private name '{1}'."),Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1:t(4014,e.DiagnosticCategory.Error,"Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1_4014","Type parameter '{0}' of method from exported interface has or is using private name '{1}'."),Type_parameter_0_of_exported_function_has_or_is_using_private_name_1:t(4016,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_function_has_or_is_using_private_name_1_4016","Type parameter '{0}' of exported function has or is using private name '{1}'."),Implements_clause_of_exported_class_0_has_or_is_using_private_name_1:t(4019,e.DiagnosticCategory.Error,"Implements_clause_of_exported_class_0_has_or_is_using_private_name_1_4019","Implements clause of exported class '{0}' has or is using private name '{1}'."),extends_clause_of_exported_class_0_has_or_is_using_private_name_1:t(4020,e.DiagnosticCategory.Error,"extends_clause_of_exported_class_0_has_or_is_using_private_name_1_4020","'extends' clause of exported class '{0}' has or is using private name '{1}'."),extends_clause_of_exported_interface_0_has_or_is_using_private_name_1:t(4022,e.DiagnosticCategory.Error,"extends_clause_of_exported_interface_0_has_or_is_using_private_name_1_4022","'extends' clause of exported interface '{0}' has or is using private name '{1}'."),Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4023,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named_4023","Exported variable '{0}' has or is using name '{1}' from external module {2} but cannot be named."),Exported_variable_0_has_or_is_using_name_1_from_private_module_2:t(4024,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_name_1_from_private_module_2_4024","Exported variable '{0}' has or is using name '{1}' from private module '{2}'."),Exported_variable_0_has_or_is_using_private_name_1:t(4025,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_private_name_1_4025","Exported variable '{0}' has or is using private name '{1}'."),Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4026,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot__4026","Public static property '{0}' of exported class has or is using name '{1}' from external module {2} but cannot be named."),Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:t(4027,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2_4027","Public static property '{0}' of exported class has or is using name '{1}' from private module '{2}'."),Public_static_property_0_of_exported_class_has_or_is_using_private_name_1:t(4028,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_private_name_1_4028","Public static property '{0}' of exported class has or is using private name '{1}'."),Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4029,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_name_4029","Public property '{0}' of exported class has or is using name '{1}' from external module {2} but cannot be named."),Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:t(4030,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2_4030","Public property '{0}' of exported class has or is using name '{1}' from private module '{2}'."),Public_property_0_of_exported_class_has_or_is_using_private_name_1:t(4031,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_private_name_1_4031","Public property '{0}' of exported class has or is using private name '{1}'."),Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4032,e.DiagnosticCategory.Error,"Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2_4032","Property '{0}' of exported interface has or is using name '{1}' from private module '{2}'."),Property_0_of_exported_interface_has_or_is_using_private_name_1:t(4033,e.DiagnosticCategory.Error,"Property_0_of_exported_interface_has_or_is_using_private_name_1_4033","Property '{0}' of exported interface has or is using private name '{1}'."),Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4034,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_4034","Parameter '{0}' of public static property setter from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1:t(4035,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1_4035","Parameter '{0}' of public static property setter from exported class has or is using private name '{1}'."),Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4036,e.DiagnosticCategory.Error,"Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_4036","Parameter '{0}' of public property setter from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1:t(4037,e.DiagnosticCategory.Error,"Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1_4037","Parameter '{0}' of public property setter from exported class has or is using private name '{1}'."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4038,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_externa_4038","Return type of public static property getter from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4039,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_4039","Return type of public static property getter from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0:t(4040,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0_4040","Return type of public static property getter from exported class has or is using private name '{0}'."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4041,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_modul_4041","Return type of public property getter from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4042,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_4042","Return type of public property getter from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0:t(4043,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0_4043","Return type of public property getter from exported class has or is using private name '{0}'."),Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4044,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_mod_4044","Return type of constructor signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0:t(4045,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0_4045","Return type of constructor signature from exported interface has or is using private name '{0}'."),Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4046,e.DiagnosticCategory.Error,"Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4046","Return type of call signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0:t(4047,e.DiagnosticCategory.Error,"Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0_4047","Return type of call signature from exported interface has or is using private name '{0}'."),Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4048,e.DiagnosticCategory.Error,"Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4048","Return type of index signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0:t(4049,e.DiagnosticCategory.Error,"Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0_4049","Return type of index signature from exported interface has or is using private name '{0}'."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4050,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module__4050","Return type of public static method from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4051,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1_4051","Return type of public static method from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0:t(4052,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0_4052","Return type of public static method from exported class has or is using private name '{0}'."),Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4053,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_c_4053","Return type of public method from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4054,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1_4054","Return type of public method from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0:t(4055,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0_4055","Return type of public method from exported class has or is using private name '{0}'."),Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4056,e.DiagnosticCategory.Error,"Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4056","Return type of method from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0:t(4057,e.DiagnosticCategory.Error,"Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0_4057","Return type of method from exported interface has or is using private name '{0}'."),Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4058,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named_4058","Return type of exported function has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1:t(4059,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1_4059","Return type of exported function has or is using name '{0}' from private module '{1}'."),Return_type_of_exported_function_has_or_is_using_private_name_0:t(4060,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_private_name_0_4060","Return type of exported function has or is using private name '{0}'."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4061,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_can_4061","Parameter '{0}' of constructor from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4062,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2_4062","Parameter '{0}' of constructor from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1:t(4063,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1_4063","Parameter '{0}' of constructor from exported class has or is using private name '{1}'."),Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4064,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_mod_4064","Parameter '{0}' of constructor signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1:t(4065,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1_4065","Parameter '{0}' of constructor signature from exported interface has or is using private name '{1}'."),Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4066,e.DiagnosticCategory.Error,"Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4066","Parameter '{0}' of call signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1:t(4067,e.DiagnosticCategory.Error,"Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1_4067","Parameter '{0}' of call signature from exported interface has or is using private name '{1}'."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4068,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module__4068","Parameter '{0}' of public static method from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4069,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2_4069","Parameter '{0}' of public static method from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:t(4070,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1_4070","Parameter '{0}' of public static method from exported class has or is using private name '{1}'."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4071,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_c_4071","Parameter '{0}' of public method from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4072,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2_4072","Parameter '{0}' of public method from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:t(4073,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1_4073","Parameter '{0}' of public method from exported class has or is using private name '{1}'."),Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4074,e.DiagnosticCategory.Error,"Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4074","Parameter '{0}' of method from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1:t(4075,e.DiagnosticCategory.Error,"Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1_4075","Parameter '{0}' of method from exported interface has or is using private name '{1}'."),Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4076,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named_4076","Parameter '{0}' of exported function has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2:t(4077,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2_4077","Parameter '{0}' of exported function has or is using name '{1}' from private module '{2}'."),Parameter_0_of_exported_function_has_or_is_using_private_name_1:t(4078,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_private_name_1_4078","Parameter '{0}' of exported function has or is using private name '{1}'."),Exported_type_alias_0_has_or_is_using_private_name_1:t(4081,e.DiagnosticCategory.Error,"Exported_type_alias_0_has_or_is_using_private_name_1_4081","Exported type alias '{0}' has or is using private name '{1}'."),Default_export_of_the_module_has_or_is_using_private_name_0:t(4082,e.DiagnosticCategory.Error,"Default_export_of_the_module_has_or_is_using_private_name_0_4082","Default export of the module has or is using private name '{0}'."),Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1:t(4083,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1_4083","Type parameter '{0}' of exported type alias has or is using private name '{1}'."),Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_library_to_resolve_the_conflict:t(4090,e.DiagnosticCategory.Message,"Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_librar_4090","Conflicting definitions for '{0}' found at '{1}' and '{2}'. Consider installing a specific version of this library to resolve the conflict."),Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4091,e.DiagnosticCategory.Error,"Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4091","Parameter '{0}' of index signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1:t(4092,e.DiagnosticCategory.Error,"Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1_4092","Parameter '{0}' of index signature from exported interface has or is using private name '{1}'."),Property_0_of_exported_class_expression_may_not_be_private_or_protected:t(4094,e.DiagnosticCategory.Error,"Property_0_of_exported_class_expression_may_not_be_private_or_protected_4094","Property '{0}' of exported class expression may not be private or protected."),The_current_host_does_not_support_the_0_option:t(5001,e.DiagnosticCategory.Error,"The_current_host_does_not_support_the_0_option_5001","The current host does not support the '{0}' option."),Cannot_find_the_common_subdirectory_path_for_the_input_files:t(5009,e.DiagnosticCategory.Error,"Cannot_find_the_common_subdirectory_path_for_the_input_files_5009","Cannot find the common subdirectory path for the input files."),File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:t(5010,e.DiagnosticCategory.Error,"File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0_5010","File specification cannot end in a recursive directory wildcard ('**'): '{0}'."),File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0:t(5011,e.DiagnosticCategory.Error,"File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0_5011","File specification cannot contain multiple recursive directory wildcards ('**'): '{0}'."),Cannot_read_file_0_Colon_1:t(5012,e.DiagnosticCategory.Error,"Cannot_read_file_0_Colon_1_5012","Cannot read file '{0}': {1}."),Failed_to_parse_file_0_Colon_1:t(5014,e.DiagnosticCategory.Error,"Failed_to_parse_file_0_Colon_1_5014","Failed to parse file '{0}': {1}."),Unknown_compiler_option_0:t(5023,e.DiagnosticCategory.Error,"Unknown_compiler_option_0_5023","Unknown compiler option '{0}'."),Compiler_option_0_requires_a_value_of_type_1:t(5024,e.DiagnosticCategory.Error,"Compiler_option_0_requires_a_value_of_type_1_5024","Compiler option '{0}' requires a value of type {1}."),Could_not_write_file_0_Colon_1:t(5033,e.DiagnosticCategory.Error,"Could_not_write_file_0_Colon_1_5033","Could not write file '{0}': {1}."),Option_project_cannot_be_mixed_with_source_files_on_a_command_line:t(5042,e.DiagnosticCategory.Error,"Option_project_cannot_be_mixed_with_source_files_on_a_command_line_5042","Option 'project' cannot be mixed with source files on a command line."),Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES2015_or_higher:t(5047,e.DiagnosticCategory.Error,"Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES_5047","Option 'isolatedModules' can only be used when either option '--module' is provided or option 'target' is 'ES2015' or higher."),Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided:t(5051,e.DiagnosticCategory.Error,"Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided_5051","Option '{0} can only be used when either option '--inlineSourceMap' or option '--sourceMap' is provided."),Option_0_cannot_be_specified_without_specifying_option_1:t(5052,e.DiagnosticCategory.Error,"Option_0_cannot_be_specified_without_specifying_option_1_5052","Option '{0}' cannot be specified without specifying option '{1}'."),Option_0_cannot_be_specified_with_option_1:t(5053,e.DiagnosticCategory.Error,"Option_0_cannot_be_specified_with_option_1_5053","Option '{0}' cannot be specified with option '{1}'."),A_tsconfig_json_file_is_already_defined_at_Colon_0:t(5054,e.DiagnosticCategory.Error,"A_tsconfig_json_file_is_already_defined_at_Colon_0_5054","A 'tsconfig.json' file is already defined at: '{0}'."),Cannot_write_file_0_because_it_would_overwrite_input_file:t(5055,e.DiagnosticCategory.Error,"Cannot_write_file_0_because_it_would_overwrite_input_file_5055","Cannot write file '{0}' because it would overwrite input file."),Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files:t(5056,e.DiagnosticCategory.Error,"Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files_5056","Cannot write file '{0}' because it would be overwritten by multiple input files."),Cannot_find_a_tsconfig_json_file_at_the_specified_directory_Colon_0:t(5057,e.DiagnosticCategory.Error,"Cannot_find_a_tsconfig_json_file_at_the_specified_directory_Colon_0_5057","Cannot find a tsconfig.json file at the specified directory: '{0}'."),The_specified_path_does_not_exist_Colon_0:t(5058,e.DiagnosticCategory.Error,"The_specified_path_does_not_exist_Colon_0_5058","The specified path does not exist: '{0}'."),Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier:t(5059,e.DiagnosticCategory.Error,"Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier_5059","Invalid value for '--reactNamespace'. '{0}' is not a valid identifier."),Option_paths_cannot_be_used_without_specifying_baseUrl_option:t(5060,e.DiagnosticCategory.Error,"Option_paths_cannot_be_used_without_specifying_baseUrl_option_5060","Option 'paths' cannot be used without specifying '--baseUrl' option."),Pattern_0_can_have_at_most_one_Asterisk_character:t(5061,e.DiagnosticCategory.Error,"Pattern_0_can_have_at_most_one_Asterisk_character_5061","Pattern '{0}' can have at most one '*' character."),Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character:t(5062,e.DiagnosticCategory.Error,"Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character_5062","Substitution '{0}' in pattern '{1}' in can have at most one '*' character."),Substitutions_for_pattern_0_should_be_an_array:t(5063,e.DiagnosticCategory.Error,"Substitutions_for_pattern_0_should_be_an_array_5063","Substitutions for pattern '{0}' should be an array."),Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2:t(5064,e.DiagnosticCategory.Error,"Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2_5064","Substitution '{0}' for pattern '{1}' has incorrect type, expected 'string', got '{2}'."),File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:t(5065,e.DiagnosticCategory.Error,"File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildca_5065","File specification cannot contain a parent directory ('..') that appears after a recursive directory wildcard ('**'): '{0}'."),Substitutions_for_pattern_0_shouldn_t_be_an_empty_array:t(5066,e.DiagnosticCategory.Error,"Substitutions_for_pattern_0_shouldn_t_be_an_empty_array_5066","Substitutions for pattern '{0}' shouldn't be an empty array."),Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name:t(5067,e.DiagnosticCategory.Error,"Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name_5067","Invalid value for 'jsxFactory'. '{0}' is not a valid identifier or qualified-name."),Concatenate_and_emit_output_to_single_file:t(6001,e.DiagnosticCategory.Message,"Concatenate_and_emit_output_to_single_file_6001","Concatenate and emit output to single file."),Generates_corresponding_d_ts_file:t(6002,e.DiagnosticCategory.Message,"Generates_corresponding_d_ts_file_6002","Generates corresponding '.d.ts' file."),Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations:t(6003,e.DiagnosticCategory.Message,"Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations_6003","Specify the location where debugger should locate map files instead of generated locations."),Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations:t(6004,e.DiagnosticCategory.Message,"Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations_6004","Specify the location where debugger should locate TypeScript files instead of source locations."),Watch_input_files:t(6005,e.DiagnosticCategory.Message,"Watch_input_files_6005","Watch input files."),Redirect_output_structure_to_the_directory:t(6006,e.DiagnosticCategory.Message,"Redirect_output_structure_to_the_directory_6006","Redirect output structure to the directory."),Do_not_erase_const_enum_declarations_in_generated_code:t(6007,e.DiagnosticCategory.Message,"Do_not_erase_const_enum_declarations_in_generated_code_6007","Do not erase const enum declarations in generated code."),Do_not_emit_outputs_if_any_errors_were_reported:t(6008,e.DiagnosticCategory.Message,"Do_not_emit_outputs_if_any_errors_were_reported_6008","Do not emit outputs if any errors were reported."),Do_not_emit_comments_to_output:t(6009,e.DiagnosticCategory.Message,"Do_not_emit_comments_to_output_6009","Do not emit comments to output."),Do_not_emit_outputs:t(6010,e.DiagnosticCategory.Message,"Do_not_emit_outputs_6010","Do not emit outputs."),Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typechecking:t(6011,e.DiagnosticCategory.Message,"Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typech_6011","Allow default imports from modules with no default export. This does not affect code emit, just typechecking."),Skip_type_checking_of_declaration_files:t(6012,e.DiagnosticCategory.Message,"Skip_type_checking_of_declaration_files_6012","Skip type checking of declaration files."),Do_not_resolve_the_real_path_of_symlinks:t(6013,e.DiagnosticCategory.Message,"Do_not_resolve_the_real_path_of_symlinks_6013","Do not resolve the real path of symlinks."),Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT:t(6015,e.DiagnosticCategory.Message,"Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT_6015","Specify ECMAScript target version: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', or 'ESNEXT'."),Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext:t(6016,e.DiagnosticCategory.Message,"Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext_6016","Specify module code generation: 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', or 'ESNext'."),Print_this_message:t(6017,e.DiagnosticCategory.Message,"Print_this_message_6017","Print this message."),Print_the_compiler_s_version:t(6019,e.DiagnosticCategory.Message,"Print_the_compiler_s_version_6019","Print the compiler's version."),Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json:t(6020,e.DiagnosticCategory.Message,"Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json_6020","Compile the project given the path to its configuration file, or to a folder with a 'tsconfig.json'."),Syntax_Colon_0:t(6023,e.DiagnosticCategory.Message,"Syntax_Colon_0_6023","Syntax: {0}"),options:t(6024,e.DiagnosticCategory.Message,"options_6024","options"),file:t(6025,e.DiagnosticCategory.Message,"file_6025","file"),Examples_Colon_0:t(6026,e.DiagnosticCategory.Message,"Examples_Colon_0_6026","Examples: {0}"),Options_Colon:t(6027,e.DiagnosticCategory.Message,"Options_Colon_6027","Options:"),Version_0:t(6029,e.DiagnosticCategory.Message,"Version_0_6029","Version {0}"),Insert_command_line_options_and_files_from_a_file:t(6030,e.DiagnosticCategory.Message,"Insert_command_line_options_and_files_from_a_file_6030","Insert command line options and files from a file."),File_change_detected_Starting_incremental_compilation:t(6032,e.DiagnosticCategory.Message,"File_change_detected_Starting_incremental_compilation_6032","File change detected. Starting incremental compilation..."),KIND:t(6034,e.DiagnosticCategory.Message,"KIND_6034","KIND"),FILE:t(6035,e.DiagnosticCategory.Message,"FILE_6035","FILE"),VERSION:t(6036,e.DiagnosticCategory.Message,"VERSION_6036","VERSION"),LOCATION:t(6037,e.DiagnosticCategory.Message,"LOCATION_6037","LOCATION"),DIRECTORY:t(6038,e.DiagnosticCategory.Message,"DIRECTORY_6038","DIRECTORY"),STRATEGY:t(6039,e.DiagnosticCategory.Message,"STRATEGY_6039","STRATEGY"),FILE_OR_DIRECTORY:t(6040,e.DiagnosticCategory.Message,"FILE_OR_DIRECTORY_6040","FILE OR DIRECTORY"),Compilation_complete_Watching_for_file_changes:t(6042,e.DiagnosticCategory.Message,"Compilation_complete_Watching_for_file_changes_6042","Compilation complete. Watching for file changes."),Generates_corresponding_map_file:t(6043,e.DiagnosticCategory.Message,"Generates_corresponding_map_file_6043","Generates corresponding '.map' file."),Compiler_option_0_expects_an_argument:t(6044,e.DiagnosticCategory.Error,"Compiler_option_0_expects_an_argument_6044","Compiler option '{0}' expects an argument."),Unterminated_quoted_string_in_response_file_0:t(6045,e.DiagnosticCategory.Error,"Unterminated_quoted_string_in_response_file_0_6045","Unterminated quoted string in response file '{0}'."),Argument_for_0_option_must_be_Colon_1:t(6046,e.DiagnosticCategory.Error,"Argument_for_0_option_must_be_Colon_1_6046","Argument for '{0}' option must be: {1}."),Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1:t(6048,e.DiagnosticCategory.Error,"Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1_6048","Locale must be of the form <language> or <language>-<territory>. For example '{0}' or '{1}'."),Unsupported_locale_0:t(6049,e.DiagnosticCategory.Error,"Unsupported_locale_0_6049","Unsupported locale '{0}'."),Unable_to_open_file_0:t(6050,e.DiagnosticCategory.Error,"Unable_to_open_file_0_6050","Unable to open file '{0}'."),Corrupted_locale_file_0:t(6051,e.DiagnosticCategory.Error,"Corrupted_locale_file_0_6051","Corrupted locale file {0}."),Raise_error_on_expressions_and_declarations_with_an_implied_any_type:t(6052,e.DiagnosticCategory.Message,"Raise_error_on_expressions_and_declarations_with_an_implied_any_type_6052","Raise error on expressions and declarations with an implied 'any' type."),File_0_not_found:t(6053,e.DiagnosticCategory.Error,"File_0_not_found_6053","File '{0}' not found."),File_0_has_unsupported_extension_The_only_supported_extensions_are_1:t(6054,e.DiagnosticCategory.Error,"File_0_has_unsupported_extension_The_only_supported_extensions_are_1_6054","File '{0}' has unsupported extension. The only supported extensions are {1}."),Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures:t(6055,e.DiagnosticCategory.Message,"Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures_6055","Suppress noImplicitAny errors for indexing objects lacking index signatures."),Do_not_emit_declarations_for_code_that_has_an_internal_annotation:t(6056,e.DiagnosticCategory.Message,"Do_not_emit_declarations_for_code_that_has_an_internal_annotation_6056","Do not emit declarations for code that has an '@internal' annotation."),Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir:t(6058,e.DiagnosticCategory.Message,"Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir_6058","Specify the root directory of input files. Use to control the output directory structure with --outDir."),File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files:t(6059,e.DiagnosticCategory.Error,"File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files_6059","File '{0}' is not under 'rootDir' '{1}'. 'rootDir' is expected to contain all source files."),Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix:t(6060,e.DiagnosticCategory.Message,"Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix_6060","Specify the end of line sequence to be used when emitting files: 'CRLF' (dos) or 'LF' (unix)."),NEWLINE:t(6061,e.DiagnosticCategory.Message,"NEWLINE_6061","NEWLINE"),Option_0_can_only_be_specified_in_tsconfig_json_file:t(6064,e.DiagnosticCategory.Error,"Option_0_can_only_be_specified_in_tsconfig_json_file_6064","Option '{0}' can only be specified in 'tsconfig.json' file."),Enables_experimental_support_for_ES7_decorators:t(6065,e.DiagnosticCategory.Message,"Enables_experimental_support_for_ES7_decorators_6065","Enables experimental support for ES7 decorators."),Enables_experimental_support_for_emitting_type_metadata_for_decorators:t(6066,e.DiagnosticCategory.Message,"Enables_experimental_support_for_emitting_type_metadata_for_decorators_6066","Enables experimental support for emitting type metadata for decorators."),Enables_experimental_support_for_ES7_async_functions:t(6068,e.DiagnosticCategory.Message,"Enables_experimental_support_for_ES7_async_functions_6068","Enables experimental support for ES7 async functions."),Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6:t(6069,e.DiagnosticCategory.Message,"Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6_6069","Specify module resolution strategy: 'node' (Node.js) or 'classic' (TypeScript pre-1.6)."),Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file:t(6070,e.DiagnosticCategory.Message,"Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file_6070","Initializes a TypeScript project and creates a tsconfig.json file."),Successfully_created_a_tsconfig_json_file:t(6071,e.DiagnosticCategory.Message,"Successfully_created_a_tsconfig_json_file_6071","Successfully created a tsconfig.json file."),Suppress_excess_property_checks_for_object_literals:t(6072,e.DiagnosticCategory.Message,"Suppress_excess_property_checks_for_object_literals_6072","Suppress excess property checks for object literals."),Stylize_errors_and_messages_using_color_and_context_experimental:t(6073,e.DiagnosticCategory.Message,"Stylize_errors_and_messages_using_color_and_context_experimental_6073","Stylize errors and messages using color and context (experimental)."),Do_not_report_errors_on_unused_labels:t(6074,e.DiagnosticCategory.Message,"Do_not_report_errors_on_unused_labels_6074","Do not report errors on unused labels."),Report_error_when_not_all_code_paths_in_function_return_a_value:t(6075,e.DiagnosticCategory.Message,"Report_error_when_not_all_code_paths_in_function_return_a_value_6075","Report error when not all code paths in function return a value."),Report_errors_for_fallthrough_cases_in_switch_statement:t(6076,e.DiagnosticCategory.Message,"Report_errors_for_fallthrough_cases_in_switch_statement_6076","Report errors for fallthrough cases in switch statement."),Do_not_report_errors_on_unreachable_code:t(6077,e.DiagnosticCategory.Message,"Do_not_report_errors_on_unreachable_code_6077","Do not report errors on unreachable code."),Disallow_inconsistently_cased_references_to_the_same_file:t(6078,e.DiagnosticCategory.Message,"Disallow_inconsistently_cased_references_to_the_same_file_6078","Disallow inconsistently-cased references to the same file."),Specify_library_files_to_be_included_in_the_compilation_Colon:t(6079,e.DiagnosticCategory.Message,"Specify_library_files_to_be_included_in_the_compilation_Colon_6079","Specify library files to be included in the compilation: "),Specify_JSX_code_generation_Colon_preserve_react_native_or_react:t(6080,e.DiagnosticCategory.Message,"Specify_JSX_code_generation_Colon_preserve_react_native_or_react_6080","Specify JSX code generation: 'preserve', 'react-native', or 'react'."),File_0_has_an_unsupported_extension_so_skipping_it:t(6081,e.DiagnosticCategory.Message,"File_0_has_an_unsupported_extension_so_skipping_it_6081","File '{0}' has an unsupported extension, so skipping it."),Only_amd_and_system_modules_are_supported_alongside_0:t(6082,e.DiagnosticCategory.Error,"Only_amd_and_system_modules_are_supported_alongside_0_6082","Only 'amd' and 'system' modules are supported alongside --{0}."),Base_directory_to_resolve_non_absolute_module_names:t(6083,e.DiagnosticCategory.Message,"Base_directory_to_resolve_non_absolute_module_names_6083","Base directory to resolve non-absolute module names."),Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react_JSX_emit:t(6084,e.DiagnosticCategory.Message,"Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react__6084","[Deprecated] Use '--jsxFactory' instead. Specify the object invoked for createElement when targeting 'react' JSX emit"),Enable_tracing_of_the_name_resolution_process:t(6085,e.DiagnosticCategory.Message,"Enable_tracing_of_the_name_resolution_process_6085","Enable tracing of the name resolution process."),Resolving_module_0_from_1:t(6086,e.DiagnosticCategory.Message,"Resolving_module_0_from_1_6086","======== Resolving module '{0}' from '{1}'. ========"),Explicitly_specified_module_resolution_kind_Colon_0:t(6087,e.DiagnosticCategory.Message,"Explicitly_specified_module_resolution_kind_Colon_0_6087","Explicitly specified module resolution kind: '{0}'."),Module_resolution_kind_is_not_specified_using_0:t(6088,e.DiagnosticCategory.Message,"Module_resolution_kind_is_not_specified_using_0_6088","Module resolution kind is not specified, using '{0}'."),Module_name_0_was_successfully_resolved_to_1:t(6089,e.DiagnosticCategory.Message,"Module_name_0_was_successfully_resolved_to_1_6089","======== Module name '{0}' was successfully resolved to '{1}'. ========"),Module_name_0_was_not_resolved:t(6090,e.DiagnosticCategory.Message,"Module_name_0_was_not_resolved_6090","======== Module name '{0}' was not resolved. ========"),paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0:t(6091,e.DiagnosticCategory.Message,"paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0_6091","'paths' option is specified, looking for a pattern to match module name '{0}'."),Module_name_0_matched_pattern_1:t(6092,e.DiagnosticCategory.Message,"Module_name_0_matched_pattern_1_6092","Module name '{0}', matched pattern '{1}'."),Trying_substitution_0_candidate_module_location_Colon_1:t(6093,e.DiagnosticCategory.Message,"Trying_substitution_0_candidate_module_location_Colon_1_6093","Trying substitution '{0}', candidate module location: '{1}'."),Resolving_module_name_0_relative_to_base_url_1_2:t(6094,e.DiagnosticCategory.Message,"Resolving_module_name_0_relative_to_base_url_1_2_6094","Resolving module name '{0}' relative to base url '{1}' - '{2}'."),Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1:t(6095,e.DiagnosticCategory.Message,"Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1_6095","Loading module as file / folder, candidate module location '{0}', target file type '{1}'."),File_0_does_not_exist:t(6096,e.DiagnosticCategory.Message,"File_0_does_not_exist_6096","File '{0}' does not exist."),File_0_exist_use_it_as_a_name_resolution_result:t(6097,e.DiagnosticCategory.Message,"File_0_exist_use_it_as_a_name_resolution_result_6097","File '{0}' exist - use it as a name resolution result."),Loading_module_0_from_node_modules_folder_target_file_type_1:t(6098,e.DiagnosticCategory.Message,"Loading_module_0_from_node_modules_folder_target_file_type_1_6098","Loading module '{0}' from 'node_modules' folder, target file type '{1}'."),Found_package_json_at_0:t(6099,e.DiagnosticCategory.Message,"Found_package_json_at_0_6099","Found 'package.json' at '{0}'."),package_json_does_not_have_a_0_field:t(6100,e.DiagnosticCategory.Message,"package_json_does_not_have_a_0_field_6100","'package.json' does not have a '{0}' field."),package_json_has_0_field_1_that_references_2:t(6101,e.DiagnosticCategory.Message,"package_json_has_0_field_1_that_references_2_6101","'package.json' has '{0}' field '{1}' that references '{2}'."),Allow_javascript_files_to_be_compiled:t(6102,e.DiagnosticCategory.Message,"Allow_javascript_files_to_be_compiled_6102","Allow javascript files to be compiled."),Option_0_should_have_array_of_strings_as_a_value:t(6103,e.DiagnosticCategory.Error,"Option_0_should_have_array_of_strings_as_a_value_6103","Option '{0}' should have array of strings as a value."),Checking_if_0_is_the_longest_matching_prefix_for_1_2:t(6104,e.DiagnosticCategory.Message,"Checking_if_0_is_the_longest_matching_prefix_for_1_2_6104","Checking if '{0}' is the longest matching prefix for '{1}' - '{2}'."),Expected_type_of_0_field_in_package_json_to_be_string_got_1:t(6105,e.DiagnosticCategory.Message,"Expected_type_of_0_field_in_package_json_to_be_string_got_1_6105","Expected type of '{0}' field in 'package.json' to be 'string', got '{1}'."),baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1:t(6106,e.DiagnosticCategory.Message,"baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1_6106","'baseUrl' option is set to '{0}', using this value to resolve non-relative module name '{1}'."),rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0:t(6107,e.DiagnosticCategory.Message,"rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0_6107","'rootDirs' option is set, using it to resolve relative module name '{0}'."),Longest_matching_prefix_for_0_is_1:t(6108,e.DiagnosticCategory.Message,"Longest_matching_prefix_for_0_is_1_6108","Longest matching prefix for '{0}' is '{1}'."),Loading_0_from_the_root_dir_1_candidate_location_2:t(6109,e.DiagnosticCategory.Message,"Loading_0_from_the_root_dir_1_candidate_location_2_6109","Loading '{0}' from the root dir '{1}', candidate location '{2}'."),Trying_other_entries_in_rootDirs:t(6110,e.DiagnosticCategory.Message,"Trying_other_entries_in_rootDirs_6110","Trying other entries in 'rootDirs'."),Module_resolution_using_rootDirs_has_failed:t(6111,e.DiagnosticCategory.Message,"Module_resolution_using_rootDirs_has_failed_6111","Module resolution using 'rootDirs' has failed."),Do_not_emit_use_strict_directives_in_module_output:t(6112,e.DiagnosticCategory.Message,"Do_not_emit_use_strict_directives_in_module_output_6112","Do not emit 'use strict' directives in module output."),Enable_strict_null_checks:t(6113,e.DiagnosticCategory.Message,"Enable_strict_null_checks_6113","Enable strict null checks."),Unknown_option_excludes_Did_you_mean_exclude:t(6114,e.DiagnosticCategory.Error,"Unknown_option_excludes_Did_you_mean_exclude_6114","Unknown option 'excludes'. Did you mean 'exclude'?"),Raise_error_on_this_expressions_with_an_implied_any_type:t(6115,e.DiagnosticCategory.Message,"Raise_error_on_this_expressions_with_an_implied_any_type_6115","Raise error on 'this' expressions with an implied 'any' type."),Resolving_type_reference_directive_0_containing_file_1_root_directory_2:t(6116,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_1_root_directory_2_6116","======== Resolving type reference directive '{0}', containing file '{1}', root directory '{2}'. ========"),Resolving_using_primary_search_paths:t(6117,e.DiagnosticCategory.Message,"Resolving_using_primary_search_paths_6117","Resolving using primary search paths..."),Resolving_from_node_modules_folder:t(6118,e.DiagnosticCategory.Message,"Resolving_from_node_modules_folder_6118","Resolving from node_modules folder..."),Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2:t(6119,e.DiagnosticCategory.Message,"Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2_6119","======== Type reference directive '{0}' was successfully resolved to '{1}', primary: {2}. ========"),Type_reference_directive_0_was_not_resolved:t(6120,e.DiagnosticCategory.Message,"Type_reference_directive_0_was_not_resolved_6120","======== Type reference directive '{0}' was not resolved. ========"),Resolving_with_primary_search_path_0:t(6121,e.DiagnosticCategory.Message,"Resolving_with_primary_search_path_0_6121","Resolving with primary search path '{0}'."),Root_directory_cannot_be_determined_skipping_primary_search_paths:t(6122,e.DiagnosticCategory.Message,"Root_directory_cannot_be_determined_skipping_primary_search_paths_6122","Root directory cannot be determined, skipping primary search paths."),Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set:t(6123,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set_6123","======== Resolving type reference directive '{0}', containing file '{1}', root directory not set. ========"),Type_declaration_files_to_be_included_in_compilation:t(6124,e.DiagnosticCategory.Message,"Type_declaration_files_to_be_included_in_compilation_6124","Type declaration files to be included in compilation."),Looking_up_in_node_modules_folder_initial_location_0:t(6125,e.DiagnosticCategory.Message,"Looking_up_in_node_modules_folder_initial_location_0_6125","Looking up in 'node_modules' folder, initial location '{0}'."),Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_modules_folder:t(6126,e.DiagnosticCategory.Message,"Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_mod_6126","Containing file is not specified and root directory cannot be determined, skipping lookup in 'node_modules' folder."),Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1:t(6127,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1_6127","======== Resolving type reference directive '{0}', containing file not set, root directory '{1}'. ========"),Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set:t(6128,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set_6128","======== Resolving type reference directive '{0}', containing file not set, root directory not set. ========"),Resolving_real_path_for_0_result_1:t(6130,e.DiagnosticCategory.Message,"Resolving_real_path_for_0_result_1_6130","Resolving real path for '{0}', result '{1}'."),Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system:t(6131,e.DiagnosticCategory.Error,"Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system_6131","Cannot compile modules using option '{0}' unless the '--module' flag is 'amd' or 'system'."),File_name_0_has_a_1_extension_stripping_it:t(6132,e.DiagnosticCategory.Message,"File_name_0_has_a_1_extension_stripping_it_6132","File name '{0}' has a '{1}' extension - stripping it."),_0_is_declared_but_its_value_is_never_read:t(6133,e.DiagnosticCategory.Error,"_0_is_declared_but_its_value_is_never_read_6133","'{0}' is declared but its value is never read."),Report_errors_on_unused_locals:t(6134,e.DiagnosticCategory.Message,"Report_errors_on_unused_locals_6134","Report errors on unused locals."),Report_errors_on_unused_parameters:t(6135,e.DiagnosticCategory.Message,"Report_errors_on_unused_parameters_6135","Report errors on unused parameters."),The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files:t(6136,e.DiagnosticCategory.Message,"The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files_6136","The maximum dependency depth to search under node_modules and load JavaScript files."),Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1:t(6137,e.DiagnosticCategory.Error,"Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1_6137","Cannot import type declaration files. Consider importing '{0}' instead of '{1}'."),Property_0_is_declared_but_its_value_is_never_read:t(6138,e.DiagnosticCategory.Error,"Property_0_is_declared_but_its_value_is_never_read_6138","Property '{0}' is declared but its value is never read."),Import_emit_helpers_from_tslib:t(6139,e.DiagnosticCategory.Message,"Import_emit_helpers_from_tslib_6139","Import emit helpers from 'tslib'."),Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using_cache_location_2:t(6140,e.DiagnosticCategory.Error,"Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using__6140","Auto discovery for typings is enabled in project '{0}'. Running extra resolution pass for module '{1}' using cache location '{2}'."),Parse_in_strict_mode_and_emit_use_strict_for_each_source_file:t(6141,e.DiagnosticCategory.Message,"Parse_in_strict_mode_and_emit_use_strict_for_each_source_file_6141",'Parse in strict mode and emit "use strict" for each source file.'),Module_0_was_resolved_to_1_but_jsx_is_not_set:t(6142,e.DiagnosticCategory.Error,"Module_0_was_resolved_to_1_but_jsx_is_not_set_6142","Module '{0}' was resolved to '{1}', but '--jsx' is not set."),Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1:t(6144,e.DiagnosticCategory.Message,"Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1_6144","Module '{0}' was resolved as locally declared ambient module in file '{1}'."),Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified:t(6145,e.DiagnosticCategory.Message,"Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified_6145","Module '{0}' was resolved as ambient module declared in '{1}' since this file was not modified."),Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h:t(6146,e.DiagnosticCategory.Message,"Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h_6146","Specify the JSX factory function to use when targeting 'react' JSX emit, e.g. 'React.createElement' or 'h'."),Resolution_for_module_0_was_found_in_cache:t(6147,e.DiagnosticCategory.Message,"Resolution_for_module_0_was_found_in_cache_6147","Resolution for module '{0}' was found in cache."),Directory_0_does_not_exist_skipping_all_lookups_in_it:t(6148,e.DiagnosticCategory.Message,"Directory_0_does_not_exist_skipping_all_lookups_in_it_6148","Directory '{0}' does not exist, skipping all lookups in it."),Show_diagnostic_information:t(6149,e.DiagnosticCategory.Message,"Show_diagnostic_information_6149","Show diagnostic information."),Show_verbose_diagnostic_information:t(6150,e.DiagnosticCategory.Message,"Show_verbose_diagnostic_information_6150","Show verbose diagnostic information."),Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file:t(6151,e.DiagnosticCategory.Message,"Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file_6151","Emit a single file with source maps instead of having a separate file."),Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap_to_be_set:t(6152,e.DiagnosticCategory.Message,"Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap__6152","Emit the source alongside the sourcemaps within a single file; requires '--inlineSourceMap' or '--sourceMap' to be set."),Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule:t(6153,e.DiagnosticCategory.Message,"Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule_6153","Transpile each file as a separate module (similar to 'ts.transpileModule')."),Print_names_of_generated_files_part_of_the_compilation:t(6154,e.DiagnosticCategory.Message,"Print_names_of_generated_files_part_of_the_compilation_6154","Print names of generated files part of the compilation."),Print_names_of_files_part_of_the_compilation:t(6155,e.DiagnosticCategory.Message,"Print_names_of_files_part_of_the_compilation_6155","Print names of files part of the compilation."),The_locale_used_when_displaying_messages_to_the_user_e_g_en_us:t(6156,e.DiagnosticCategory.Message,"The_locale_used_when_displaying_messages_to_the_user_e_g_en_us_6156","The locale used when displaying messages to the user (e.g. 'en-us')"),Do_not_generate_custom_helper_functions_like_extends_in_compiled_output:t(6157,e.DiagnosticCategory.Message,"Do_not_generate_custom_helper_functions_like_extends_in_compiled_output_6157","Do not generate custom helper functions like '__extends' in compiled output."),Do_not_include_the_default_library_file_lib_d_ts:t(6158,e.DiagnosticCategory.Message,"Do_not_include_the_default_library_file_lib_d_ts_6158","Do not include the default library file (lib.d.ts)."),Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files:t(6159,e.DiagnosticCategory.Message,"Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files_6159","Do not add triple-slash references or imported modules to the list of compiled files."),Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files:t(6160,e.DiagnosticCategory.Message,"Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files_6160","[Deprecated] Use '--skipLibCheck' instead. Skip type checking of default library declaration files."),List_of_folders_to_include_type_definitions_from:t(6161,e.DiagnosticCategory.Message,"List_of_folders_to_include_type_definitions_from_6161","List of folders to include type definitions from."),Disable_size_limitations_on_JavaScript_projects:t(6162,e.DiagnosticCategory.Message,"Disable_size_limitations_on_JavaScript_projects_6162","Disable size limitations on JavaScript projects."),The_character_set_of_the_input_files:t(6163,e.DiagnosticCategory.Message,"The_character_set_of_the_input_files_6163","The character set of the input files."),Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files:t(6164,e.DiagnosticCategory.Message,"Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files_6164","Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files."),Do_not_truncate_error_messages:t(6165,e.DiagnosticCategory.Message,"Do_not_truncate_error_messages_6165","Do not truncate error messages."),Output_directory_for_generated_declaration_files:t(6166,e.DiagnosticCategory.Message,"Output_directory_for_generated_declaration_files_6166","Output directory for generated declaration files."),A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl:t(6167,e.DiagnosticCategory.Message,"A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl_6167","A series of entries which re-map imports to lookup locations relative to the 'baseUrl'."),List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime:t(6168,e.DiagnosticCategory.Message,"List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime_6168","List of root folders whose combined content represents the structure of the project at runtime."),Show_all_compiler_options:t(6169,e.DiagnosticCategory.Message,"Show_all_compiler_options_6169","Show all compiler options."),Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file:t(6170,e.DiagnosticCategory.Message,"Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file_6170","[Deprecated] Use '--outFile' instead. Concatenate and emit output to single file"),Command_line_Options:t(6171,e.DiagnosticCategory.Message,"Command_line_Options_6171","Command-line Options"),Basic_Options:t(6172,e.DiagnosticCategory.Message,"Basic_Options_6172","Basic Options"),Strict_Type_Checking_Options:t(6173,e.DiagnosticCategory.Message,"Strict_Type_Checking_Options_6173","Strict Type-Checking Options"),Module_Resolution_Options:t(6174,e.DiagnosticCategory.Message,"Module_Resolution_Options_6174","Module Resolution Options"),Source_Map_Options:t(6175,e.DiagnosticCategory.Message,"Source_Map_Options_6175","Source Map Options"),Additional_Checks:t(6176,e.DiagnosticCategory.Message,"Additional_Checks_6176","Additional Checks"),Experimental_Options:t(6177,e.DiagnosticCategory.Message,"Experimental_Options_6177","Experimental Options"),Advanced_Options:t(6178,e.DiagnosticCategory.Message,"Advanced_Options_6178","Advanced Options"),Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3:t(6179,e.DiagnosticCategory.Message,"Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3_6179","Provide full support for iterables in 'for-of', spread, and destructuring when targeting 'ES5' or 'ES3'."),Enable_all_strict_type_checking_options:t(6180,e.DiagnosticCategory.Message,"Enable_all_strict_type_checking_options_6180","Enable all strict type-checking options."),List_of_language_service_plugins:t(6181,e.DiagnosticCategory.Message,"List_of_language_service_plugins_6181","List of language service plugins."),Scoped_package_detected_looking_in_0:t(6182,e.DiagnosticCategory.Message,"Scoped_package_detected_looking_in_0_6182","Scoped package detected, looking in '{0}'"),Reusing_resolution_of_module_0_to_file_1_from_old_program:t(6183,e.DiagnosticCategory.Message,"Reusing_resolution_of_module_0_to_file_1_from_old_program_6183","Reusing resolution of module '{0}' to file '{1}' from old program."),Reusing_module_resolutions_originating_in_0_since_resolutions_are_unchanged_from_old_program:t(6184,e.DiagnosticCategory.Message,"Reusing_module_resolutions_originating_in_0_since_resolutions_are_unchanged_from_old_program_6184","Reusing module resolutions originating in '{0}' since resolutions are unchanged from old program."),Disable_strict_checking_of_generic_signatures_in_function_types:t(6185,e.DiagnosticCategory.Message,"Disable_strict_checking_of_generic_signatures_in_function_types_6185","Disable strict checking of generic signatures in function types."),Enable_strict_checking_of_function_types:t(6186,e.DiagnosticCategory.Message,"Enable_strict_checking_of_function_types_6186","Enable strict checking of function types."),Variable_0_implicitly_has_an_1_type:t(7005,e.DiagnosticCategory.Error,"Variable_0_implicitly_has_an_1_type_7005","Variable '{0}' implicitly has an '{1}' type."),Parameter_0_implicitly_has_an_1_type:t(7006,e.DiagnosticCategory.Error,"Parameter_0_implicitly_has_an_1_type_7006","Parameter '{0}' implicitly has an '{1}' type."),Member_0_implicitly_has_an_1_type:t(7008,e.DiagnosticCategory.Error,"Member_0_implicitly_has_an_1_type_7008","Member '{0}' implicitly has an '{1}' type."),new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type:t(7009,e.DiagnosticCategory.Error,"new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type_7009","'new' expression, whose target lacks a construct signature, implicitly has an 'any' type."),_0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type:t(7010,e.DiagnosticCategory.Error,"_0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type_7010","'{0}', which lacks return-type annotation, implicitly has an '{1}' return type."),Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type:t(7011,e.DiagnosticCategory.Error,"Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type_7011","Function expression, which lacks return-type annotation, implicitly has an '{0}' return type."),Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type:t(7013,e.DiagnosticCategory.Error,"Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type_7013","Construct signature, which lacks return-type annotation, implicitly has an 'any' return type."),Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number:t(7015,e.DiagnosticCategory.Error,"Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number_7015","Element implicitly has an 'any' type because index expression is not of type 'number'."),Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type:t(7016,e.DiagnosticCategory.Error,"Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type_7016","Could not find a declaration file for module '{0}'. '{1}' implicitly has an 'any' type."),Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature:t(7017,e.DiagnosticCategory.Error,"Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature_7017","Element implicitly has an 'any' type because type '{0}' has no index signature."),Object_literal_s_property_0_implicitly_has_an_1_type:t(7018,e.DiagnosticCategory.Error,"Object_literal_s_property_0_implicitly_has_an_1_type_7018","Object literal's property '{0}' implicitly has an '{1}' type."),Rest_parameter_0_implicitly_has_an_any_type:t(7019,e.DiagnosticCategory.Error,"Rest_parameter_0_implicitly_has_an_any_type_7019","Rest parameter '{0}' implicitly has an 'any[]' type."),Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type:t(7020,e.DiagnosticCategory.Error,"Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type_7020","Call signature, which lacks return-type annotation, implicitly has an 'any' return type."),_0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or_indirectly_in_its_own_initializer:t(7022,e.DiagnosticCategory.Error,"_0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or__7022","'{0}' implicitly has type 'any' because it does not have a type annotation and is referenced directly or indirectly in its own initializer."),_0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions:t(7023,e.DiagnosticCategory.Error,"_0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_reference_7023","'{0}' implicitly has return type 'any' because it does not have a return type annotation and is referenced directly or indirectly in one of its return expressions."),Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions:t(7024,e.DiagnosticCategory.Error,"Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_ref_7024","Function implicitly has return type 'any' because it does not have a return type annotation and is referenced directly or indirectly in one of its return expressions."),Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_type:t(7025,e.DiagnosticCategory.Error,"Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_typ_7025","Generator implicitly has type '{0}' because it does not yield any values. Consider supplying a return type."),JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists:t(7026,e.DiagnosticCategory.Error,"JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists_7026","JSX element implicitly has type 'any' because no interface 'JSX.{0}' exists."),Unreachable_code_detected:t(7027,e.DiagnosticCategory.Error,"Unreachable_code_detected_7027","Unreachable code detected."),Unused_label:t(7028,e.DiagnosticCategory.Error,"Unused_label_7028","Unused label."),Fallthrough_case_in_switch:t(7029,e.DiagnosticCategory.Error,"Fallthrough_case_in_switch_7029","Fallthrough case in switch."),Not_all_code_paths_return_a_value:t(7030,e.DiagnosticCategory.Error,"Not_all_code_paths_return_a_value_7030","Not all code paths return a value."),Binding_element_0_implicitly_has_an_1_type:t(7031,e.DiagnosticCategory.Error,"Binding_element_0_implicitly_has_an_1_type_7031","Binding element '{0}' implicitly has an '{1}' type."),Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation:t(7032,e.DiagnosticCategory.Error,"Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation_7032","Property '{0}' implicitly has type 'any', because its set accessor lacks a parameter type annotation."),Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation:t(7033,e.DiagnosticCategory.Error,"Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation_7033","Property '{0}' implicitly has type 'any', because its get accessor lacks a return type annotation."),Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined:t(7034,e.DiagnosticCategory.Error,"Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined_7034","Variable '{0}' implicitly has type '{1}' in some locations where its type cannot be determined."),Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_module_0:t(7035,e.DiagnosticCategory.Error,"Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_mod_7035","Try `npm install @types/{0}` if it exists or add a new declaration (.d.ts) file containing `declare module '{0}';`"),Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0:t(7036,e.DiagnosticCategory.Error,"Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0_7036","Dynamic import's specifier must be of type 'string', but here has type '{0}'."),You_cannot_rename_this_element:t(8e3,e.DiagnosticCategory.Error,"You_cannot_rename_this_element_8000","You cannot rename this element."),You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library:t(8001,e.DiagnosticCategory.Error,"You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library_8001","You cannot rename elements that are defined in the standard TypeScript library."),import_can_only_be_used_in_a_ts_file:t(8002,e.DiagnosticCategory.Error,"import_can_only_be_used_in_a_ts_file_8002","'import ... =' can only be used in a .ts file."),export_can_only_be_used_in_a_ts_file:t(8003,e.DiagnosticCategory.Error,"export_can_only_be_used_in_a_ts_file_8003","'export=' can only be used in a .ts file."),type_parameter_declarations_can_only_be_used_in_a_ts_file:t(8004,e.DiagnosticCategory.Error,"type_parameter_declarations_can_only_be_used_in_a_ts_file_8004","'type parameter declarations' can only be used in a .ts file."),implements_clauses_can_only_be_used_in_a_ts_file:t(8005,e.DiagnosticCategory.Error,"implements_clauses_can_only_be_used_in_a_ts_file_8005","'implements clauses' can only be used in a .ts file."),interface_declarations_can_only_be_used_in_a_ts_file:t(8006,e.DiagnosticCategory.Error,"interface_declarations_can_only_be_used_in_a_ts_file_8006","'interface declarations' can only be used in a .ts file."),module_declarations_can_only_be_used_in_a_ts_file:t(8007,e.DiagnosticCategory.Error,"module_declarations_can_only_be_used_in_a_ts_file_8007","'module declarations' can only be used in a .ts file."),type_aliases_can_only_be_used_in_a_ts_file:t(8008,e.DiagnosticCategory.Error,"type_aliases_can_only_be_used_in_a_ts_file_8008","'type aliases' can only be used in a .ts file."),_0_can_only_be_used_in_a_ts_file:t(8009,e.DiagnosticCategory.Error,"_0_can_only_be_used_in_a_ts_file_8009","'{0}' can only be used in a .ts file."),types_can_only_be_used_in_a_ts_file:t(8010,e.DiagnosticCategory.Error,"types_can_only_be_used_in_a_ts_file_8010","'types' can only be used in a .ts file."),type_arguments_can_only_be_used_in_a_ts_file:t(8011,e.DiagnosticCategory.Error,"type_arguments_can_only_be_used_in_a_ts_file_8011","'type arguments' can only be used in a .ts file."),parameter_modifiers_can_only_be_used_in_a_ts_file:t(8012,e.DiagnosticCategory.Error,"parameter_modifiers_can_only_be_used_in_a_ts_file_8012","'parameter modifiers' can only be used in a .ts file."),non_null_assertions_can_only_be_used_in_a_ts_file:t(8013,e.DiagnosticCategory.Error,"non_null_assertions_can_only_be_used_in_a_ts_file_8013","'non-null assertions' can only be used in a .ts file."),enum_declarations_can_only_be_used_in_a_ts_file:t(8015,e.DiagnosticCategory.Error,"enum_declarations_can_only_be_used_in_a_ts_file_8015","'enum declarations' can only be used in a .ts file."),type_assertion_expressions_can_only_be_used_in_a_ts_file:t(8016,e.DiagnosticCategory.Error,"type_assertion_expressions_can_only_be_used_in_a_ts_file_8016","'type assertion expressions' can only be used in a .ts file."),Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0:t(8017,e.DiagnosticCategory.Error,"Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0_8017","Octal literal types must use ES2015 syntax. Use the syntax '{0}'."),Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0:t(8018,e.DiagnosticCategory.Error,"Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0_8018","Octal literals are not allowed in enums members initializer. Use the syntax '{0}'."),Report_errors_in_js_files:t(8019,e.DiagnosticCategory.Message,"Report_errors_in_js_files_8019","Report errors in .js files."),JSDoc_types_can_only_be_used_inside_documentation_comments:t(8020,e.DiagnosticCategory.Error,"JSDoc_types_can_only_be_used_inside_documentation_comments_8020","JSDoc types can only be used inside documentation comments."),JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags:t(8021,e.DiagnosticCategory.Error,"JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags_8021","JSDoc '@typedef' tag should either have a type annotation or be followed by '@property' or '@member' tags."),JSDoc_0_is_not_attached_to_a_class:t(8022,e.DiagnosticCategory.Error,"JSDoc_0_is_not_attached_to_a_class_8022","JSDoc '@{0}' is not attached to a class."),JSDoc_0_1_does_not_match_the_extends_2_clause:t(8023,e.DiagnosticCategory.Error,"JSDoc_0_1_does_not_match_the_extends_2_clause_8023","JSDoc '@{0} {1}' does not match the 'extends {2}' clause."),JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name:t(8024,e.DiagnosticCategory.Error,"JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name_8024","JSDoc '@param' tag has name '{0}', but there is no parameter with that name."),Class_declarations_cannot_have_more_than_one_augments_or_extends_tag:t(8025,e.DiagnosticCategory.Error,"Class_declarations_cannot_have_more_than_one_augments_or_extends_tag_8025","Class declarations cannot have more than one `@augments` or `@extends` tag."),Only_identifiers_Slashqualified_names_with_optional_type_arguments_are_currently_supported_in_a_class_extends_clause:t(9002,e.DiagnosticCategory.Error,"Only_identifiers_Slashqualified_names_with_optional_type_arguments_are_currently_supported_in_a_clas_9002","Only identifiers/qualified-names with optional type arguments are currently supported in a class 'extends' clause."),class_expressions_are_not_currently_supported:t(9003,e.DiagnosticCategory.Error,"class_expressions_are_not_currently_supported_9003","'class' expressions are not currently supported."),Language_service_is_disabled:t(9004,e.DiagnosticCategory.Error,"Language_service_is_disabled_9004","Language service is disabled."),JSX_attributes_must_only_be_assigned_a_non_empty_expression:t(17e3,e.DiagnosticCategory.Error,"JSX_attributes_must_only_be_assigned_a_non_empty_expression_17000","JSX attributes must only be assigned a non-empty 'expression'."),JSX_elements_cannot_have_multiple_attributes_with_the_same_name:t(17001,e.DiagnosticCategory.Error,"JSX_elements_cannot_have_multiple_attributes_with_the_same_name_17001","JSX elements cannot have multiple attributes with the same name."),Expected_corresponding_JSX_closing_tag_for_0:t(17002,e.DiagnosticCategory.Error,"Expected_corresponding_JSX_closing_tag_for_0_17002","Expected corresponding JSX closing tag for '{0}'."),JSX_attribute_expected:t(17003,e.DiagnosticCategory.Error,"JSX_attribute_expected_17003","JSX attribute expected."),Cannot_use_JSX_unless_the_jsx_flag_is_provided:t(17004,e.DiagnosticCategory.Error,"Cannot_use_JSX_unless_the_jsx_flag_is_provided_17004","Cannot use JSX unless the '--jsx' flag is provided."),A_constructor_cannot_contain_a_super_call_when_its_class_extends_null:t(17005,e.DiagnosticCategory.Error,"A_constructor_cannot_contain_a_super_call_when_its_class_extends_null_17005","A constructor cannot contain a 'super' call when its class extends 'null'."),An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses:t(17006,e.DiagnosticCategory.Error,"An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_ex_17006","An unary expression with the '{0}' operator is not allowed in the left-hand side of an exponentiation expression. Consider enclosing the expression in parentheses."),A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses:t(17007,e.DiagnosticCategory.Error,"A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Con_17007","A type assertion expression is not allowed in the left-hand side of an exponentiation expression. Consider enclosing the expression in parentheses."),JSX_element_0_has_no_corresponding_closing_tag:t(17008,e.DiagnosticCategory.Error,"JSX_element_0_has_no_corresponding_closing_tag_17008","JSX element '{0}' has no corresponding closing tag."),super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class:t(17009,e.DiagnosticCategory.Error,"super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class_17009","'super' must be called before accessing 'this' in the constructor of a derived class."),Unknown_type_acquisition_option_0:t(17010,e.DiagnosticCategory.Error,"Unknown_type_acquisition_option_0_17010","Unknown type acquisition option '{0}'."),super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class:t(17011,e.DiagnosticCategory.Error,"super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class_17011","'super' must be called before accessing a property of 'super' in the constructor of a derived class."),_0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2:t(17012,e.DiagnosticCategory.Error,"_0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2_17012","'{0}' is not a valid meta-property for keyword '{1}'. Did you mean '{2}'?"),Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constructor:t(17013,e.DiagnosticCategory.Error,"Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constru_17013","Meta-property '{0}' is only allowed in the body of a function declaration, function expression, or constructor."),Circularity_detected_while_resolving_configuration_Colon_0:t(18e3,e.DiagnosticCategory.Error,"Circularity_detected_while_resolving_configuration_Colon_0_18000","Circularity detected while resolving configuration: {0}"),A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not:t(18001,e.DiagnosticCategory.Error,"A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not_18001","A path in an 'extends' option must be relative or rooted, but '{0}' is not."),The_files_list_in_config_file_0_is_empty:t(18002,e.DiagnosticCategory.Error,"The_files_list_in_config_file_0_is_empty_18002","The 'files' list in config file '{0}' is empty."),No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2:t(18003,e.DiagnosticCategory.Error,"No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2_18003","No inputs were found in config file '{0}'. Specified 'include' paths were '{1}' and 'exclude' paths were '{2}'."),Add_missing_super_call:t(90001,e.DiagnosticCategory.Message,"Add_missing_super_call_90001","Add missing 'super()' call."),Make_super_call_the_first_statement_in_the_constructor:t(90002,e.DiagnosticCategory.Message,"Make_super_call_the_first_statement_in_the_constructor_90002","Make 'super()' call the first statement in the constructor."),Change_extends_to_implements:t(90003,e.DiagnosticCategory.Message,"Change_extends_to_implements_90003","Change 'extends' to 'implements'."),Remove_declaration_for_Colon_0:t(90004,e.DiagnosticCategory.Message,"Remove_declaration_for_Colon_0_90004","Remove declaration for: '{0}'."),Implement_interface_0:t(90006,e.DiagnosticCategory.Message,"Implement_interface_0_90006","Implement interface '{0}'."),Implement_inherited_abstract_class:t(90007,e.DiagnosticCategory.Message,"Implement_inherited_abstract_class_90007","Implement inherited abstract class."),Add_this_to_unresolved_variable:t(90008,e.DiagnosticCategory.Message,"Add_this_to_unresolved_variable_90008","Add 'this.' to unresolved variable."),Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript_files_Learn_more_at_https_Colon_Slash_Slashaka_ms_Slashtsconfig:t(90009,e.DiagnosticCategory.Error,"Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript__90009","Adding a tsconfig.json file will help organize projects that contain both TypeScript and JavaScript files. Learn more at https://aka.ms/tsconfig."),Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated:t(90010,e.DiagnosticCategory.Error,"Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated_90010","Type '{0}' is not assignable to type '{1}'. Two different types with this name exist, but they are unrelated."),Import_0_from_1:t(90013,e.DiagnosticCategory.Message,"Import_0_from_1_90013","Import '{0}' from \"{1}\"."),Change_0_to_1:t(90014,e.DiagnosticCategory.Message,"Change_0_to_1_90014","Change '{0}' to '{1}'."),Add_0_to_existing_import_declaration_from_1:t(90015,e.DiagnosticCategory.Message,"Add_0_to_existing_import_declaration_from_1_90015","Add '{0}' to existing import declaration from \"{1}\"."),Declare_property_0:t(90016,e.DiagnosticCategory.Message,"Declare_property_0_90016","Declare property '{0}'."),Add_index_signature_for_property_0:t(90017,e.DiagnosticCategory.Message,"Add_index_signature_for_property_0_90017","Add index signature for property '{0}'."),Disable_checking_for_this_file:t(90018,e.DiagnosticCategory.Message,"Disable_checking_for_this_file_90018","Disable checking for this file."),Ignore_this_error_message:t(90019,e.DiagnosticCategory.Message,"Ignore_this_error_message_90019","Ignore this error message."),Initialize_property_0_in_the_constructor:t(90020,e.DiagnosticCategory.Message,"Initialize_property_0_in_the_constructor_90020","Initialize property '{0}' in the constructor."),Initialize_static_property_0:t(90021,e.DiagnosticCategory.Message,"Initialize_static_property_0_90021","Initialize static property '{0}'."),Change_spelling_to_0:t(90022,e.DiagnosticCategory.Message,"Change_spelling_to_0_90022","Change spelling to '{0}'."),Declare_method_0:t(90023,e.DiagnosticCategory.Message,"Declare_method_0_90023","Declare method '{0}'."),Declare_static_method_0:t(90024,e.DiagnosticCategory.Message,"Declare_static_method_0_90024","Declare static method '{0}'."),Prefix_0_with_an_underscore:t(90025,e.DiagnosticCategory.Message,"Prefix_0_with_an_underscore_90025","Prefix '{0}' with an underscore."),Rewrite_as_the_indexed_access_type_0:t(90026,e.DiagnosticCategory.Message,"Rewrite_as_the_indexed_access_type_0_90026","Rewrite as the indexed access type '{0}'."),Declare_static_property_0:t(90027,e.DiagnosticCategory.Message,"Declare_static_property_0_90027","Declare static property '{0}'."),Call_decorator_expression:t(90028,e.DiagnosticCategory.Message,"Call_decorator_expression_90028","Call decorator expression."),Convert_function_to_an_ES2015_class:t(95001,e.DiagnosticCategory.Message,"Convert_function_to_an_ES2015_class_95001","Convert function to an ES2015 class"),Convert_function_0_to_class:t(95002,e.DiagnosticCategory.Message,"Convert_function_0_to_class_95002","Convert function '{0}' to class"),Extract_symbol:t(95003,e.DiagnosticCategory.Message,"Extract_symbol_95003","Extract symbol"),Extract_to_0_in_1:t(95004,e.DiagnosticCategory.Message,"Extract_to_0_in_1_95004","Extract to {0} in {1}"),Extract_function:t(95005,e.DiagnosticCategory.Message,"Extract_function_95005","Extract function"),Extract_constant:t(95006,e.DiagnosticCategory.Message,"Extract_constant_95006","Extract constant"),Extract_to_0_in_enclosing_scope:t(95007,e.DiagnosticCategory.Message,"Extract_to_0_in_enclosing_scope_95007","Extract to {0} in enclosing scope"),Extract_to_0_in_1_scope:t(95008,e.DiagnosticCategory.Message,"Extract_to_0_in_1_scope_95008","Extract to {0} in {1} scope"),Annotate_with_type_from_JSDoc:t(95009,e.DiagnosticCategory.Message,"Annotate_with_type_from_JSDoc_95009","Annotate with type from JSDoc"),Annotate_with_types_from_JSDoc:t(95010,e.DiagnosticCategory.Message,"Annotate_with_types_from_JSDoc_95010","Annotate with types from JSDoc"),Infer_type_of_0_from_usage:t(95011,e.DiagnosticCategory.Message,"Infer_type_of_0_from_usage_95011","Infer type of '{0}' from usage."),Infer_parameter_types_from_usage:t(95012,e.DiagnosticCategory.Message,"Infer_parameter_types_from_usage_95012","Infer parameter types from usage.")}}(ts||(ts={})),function(e){function t(e){return e>=71}e.tokenIsIdentifierOrKeyword=t;var n=e.createMapFromTemplate({abstract:117,any:119,as:118,boolean:122,break:72,case:73,catch:74,class:75,continue:77,const:76,constructor:123,debugger:78,declare:124,default:79,delete:80,do:81,else:82,enum:83,export:84,extends:85,false:86,finally:87,for:88,from:140,function:89,get:125,if:90,implements:108,import:91,in:92,instanceof:93,interface:109,is:126,keyof:127,let:110,module:128,namespace:129,never:130,new:94,null:95,number:133,object:134,package:111,private:112,protected:113,public:114,readonly:131,require:132,global:141,return:96,set:135,static:115,string:136,super:97,switch:98,symbol:137,this:99,throw:100,true:101,try:102,type:138,typeof:103,undefined:139,var:104,void:105,while:106,with:107,yield:116,async:120,await:121,of:142,"{":17,"}":18,"(":19,")":20,"[":21,"]":22,".":23,"...":24,";":25,",":26,"<":27,">":29,"<=":30,">=":31,"==":32,"!=":33,"===":34,"!==":35,"=>":36,"+":37,"-":38,"**":40,"*":39,"/":41,"%":42,"++":43,"--":44,"<<":45,"</":28,">>":46,">>>":47,"&":48,"|":49,"^":50,"!":51,"~":52,"&&":53,"||":54,"?":55,":":56,"=":58,"+=":59,"-=":60,"*=":61,"**=":62,"/=":63,"%=":64,"<<=":65,">>=":66,">>>=":67,"&=":68,"|=":69,"^=":70,"@":57}),i=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1569,1594,1600,1610,1649,1747,1749,1749,1765,1766,1786,1788,1808,1808,1810,1836,1920,1957,2309,2361,2365,2365,2384,2384,2392,2401,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2784,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2877,2877,2908,2909,2911,2913,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3294,3294,3296,3297,3333,3340,3342,3344,3346,3368,3370,3385,3424,3425,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3946,3976,3979,4096,4129,4131,4135,4137,4138,4176,4181,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6067,6176,6263,6272,6312,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8319,8319,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12329,12337,12341,12344,12346,12353,12436,12445,12446,12449,12538,12540,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65138,65140,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],r=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,768,846,864,866,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1155,1158,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1425,1441,1443,1465,1467,1469,1471,1471,1473,1474,1476,1476,1488,1514,1520,1522,1569,1594,1600,1621,1632,1641,1648,1747,1749,1756,1759,1768,1770,1773,1776,1788,1808,1836,1840,1866,1920,1968,2305,2307,2309,2361,2364,2381,2384,2388,2392,2403,2406,2415,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2492,2494,2500,2503,2504,2507,2509,2519,2519,2524,2525,2527,2531,2534,2545,2562,2562,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2649,2652,2654,2654,2662,2676,2689,2691,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2784,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2876,2883,2887,2888,2891,2893,2902,2903,2908,2909,2911,2913,2918,2927,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3006,3010,3014,3016,3018,3021,3031,3031,3047,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3134,3140,3142,3144,3146,3149,3157,3158,3168,3169,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3262,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3297,3302,3311,3330,3331,3333,3340,3342,3344,3346,3368,3370,3385,3390,3395,3398,3400,3402,3405,3415,3415,3424,3425,3430,3439,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3805,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3946,3953,3972,3974,3979,3984,3991,3993,4028,4038,4038,4096,4129,4131,4135,4137,4138,4140,4146,4150,4153,4160,4169,4176,4185,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,4969,4977,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6099,6112,6121,6160,6169,6176,6263,6272,6313,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8255,8256,8319,8319,8400,8412,8417,8417,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12335,12337,12341,12344,12346,12353,12436,12441,12442,12445,12446,12449,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65056,65059,65075,65076,65101,65103,65136,65138,65140,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65381,65470,65474,65479,65482,65487,65490,65495,65498,65500],s=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],o=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500];function a(e,t){if(e<t[0])return!1;for(var n,i=0,r=t.length;i+1<r;){if(n=i+(r-i)/2,t[n-=n%2]<=e&&e<=t[n+1])return!0;e<t[n]?r=n:i=n+2}return!1}function l(e,t){return a(e,t>=1?s:i)}e.isUnicodeIdentifierStart=l;var c,u=(c=[],n.forEach(function(e,t){c[e]=t}),c);function d(e){for(var t=new Array,n=0,i=0;n<e.length;){var r=e.charCodeAt(n);switch(n++,r){case 13:10===e.charCodeAt(n)&&n++;case 10:t.push(i),i=n;break;default:r>127&&_(r)&&(t.push(i),i=n)}}return t.push(i),t}function p(t,n,i,r){e.Debug.assert(n>=0&&n<t.length);var s=t[n]+i;return n<t.length-1?e.Debug.assert(s<t[n+1]):void 0!==r&&e.Debug.assert(s<=r.length),s}function h(e){return e.lineMap||(e.lineMap=d(e.text))}function f(t,n){var i=e.binarySearch(t,n);return i<0&&(i=~i-1,e.Debug.assert(-1!==i,"position cannot precede the beginning of the file")),{line:i,character:n-t[i]}}function m(e){return g(e)||_(e)}function g(e){return 32===e||9===e||11===e||12===e||160===e||133===e||5760===e||e>=8192&&e<=8203||8239===e||8287===e||12288===e||65279===e}function _(e){return 10===e||13===e||8232===e||8233===e}function y(e){return e>=48&&e<=57}function b(e){return e>=48&&e<=55}e.tokenToString=function(e){return u[e]},e.stringToToken=function(e){return n.get(e)},e.computeLineStarts=d,e.getPositionOfLineAndCharacter=function(e,t,n){return p(h(e),t,n,e.text)},e.computePositionOfLineAndCharacter=p,e.getLineStarts=h,e.computeLineAndCharacterOfPosition=f,e.getLineAndCharacterOfPosition=function(e,t){return f(h(e),t)},e.isWhiteSpaceLike=m,e.isWhiteSpaceSingleLine=g,e.isLineBreak=_,e.isOctalDigit=b,e.couldStartTrivia=function(e,t){var n=e.charCodeAt(t);switch(n){case 13:case 10:case 9:case 11:case 12:case 32:case 47:case 60:case 124:case 61:case 62:return!0;case 35:return 0===t;default:return n>127}},e.skipTrivia=function(t,n,i,r){if(void 0===r&&(r=!1),e.positionIsSynthesized(n))return n;for(;;){var s=t.charCodeAt(n);switch(s){case 13:10===t.charCodeAt(n+1)&&n++;case 10:if(n++,i)return n;continue;case 9:case 11:case 12:case 32:n++;continue;case 47:if(r)break;if(47===t.charCodeAt(n+1)){for(n+=2;n<t.length&&!_(t.charCodeAt(n));)n++;continue}if(42===t.charCodeAt(n+1)){for(n+=2;n<t.length;){if(42===t.charCodeAt(n)&&47===t.charCodeAt(n+1)){n+=2;break}n++}continue}break;case 60:case 124:case 61:case 62:if(T(t,n)){n=k(t,n);continue}break;case 35:if(0===n&&E(t,n)){n=S(t,n);continue}break;default:if(s>127&&m(s)){n++;continue}}return n}};var v=7;function T(t,n){if(e.Debug.assert(n>=0),0===n||_(t.charCodeAt(n-1))){var i=t.charCodeAt(n);if(n+v<t.length){for(var r=0;r<v;r++)if(t.charCodeAt(n+r)!==i)return!1;return 61===i||32===t.charCodeAt(n+v)}}return!1}function k(t,n,i){i&&i(e.Diagnostics.Merge_conflict_marker_encountered,v);var r=t.charCodeAt(n),s=t.length;if(60===r||62===r)for(;n<s&&!_(t.charCodeAt(n));)n++;else for(e.Debug.assert(124===r||61===r);n<s;){var o=t.charCodeAt(n);if((61===o||62===o)&&o!==r&&T(t,n))break;n++}return n}var x=/^#!.*/;function E(t,n){return e.Debug.assert(0===n),x.test(t)}function S(e,t){return t+=x.exec(e)[0].length}function C(e,t,n,i,r,s,o){var a,l,c,u,d=!1,p=i||0===n,h=o;e:for(;n>=0&&n<t.length;){var f=t.charCodeAt(n);switch(f){case 13:10===t.charCodeAt(n+1)&&n++;case 10:if(n++,i)break e;p=!0,d&&(u=!0);continue;case 9:case 11:case 12:case 32:n++;continue;case 47:var g=t.charCodeAt(n+1),y=!1;if(47===g||42===g){var b=47===g?2:3,v=n;if(n+=2,47===g)for(;n<t.length;){if(_(t.charCodeAt(n))){y=!0;break}n++}else for(;n<t.length;){if(42===t.charCodeAt(n)&&47===t.charCodeAt(n+1)){n+=2;break}n++}if(p){if(d){if(h=r(a,l,c,u,s,h),!e&&h)return h;d=!1}a=v,l=n,c=b,u=y,d=!0}continue}break e;default:if(f>127&&m(f)){d&&_(f)&&(u=!0),n++;continue}break e}}return d&&(h=r(a,l,c,u,s,h)),h}function w(e,t,n,i,r){return C(!0,e,t,!1,n,i,r)}function I(e,t,n,i,r){return C(!0,e,t,!0,n,i,r)}function A(e,t,n,i,r,s){return s||(s=[]),s.push({kind:n,pos:e,end:t,hasTrailingNewLine:i}),s}function N(e,t){return e>=65&&e<=90||e>=97&&e<=122||36===e||95===e||e>127&&l(e,t)}function D(e,t){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||36===e||95===e||e>127&&function(e,t){return a(e,t>=1?o:r)}(e,t)}e.forEachLeadingCommentRange=function(e,t,n,i){return C(!1,e,t,!1,n,i)},e.forEachTrailingCommentRange=function(e,t,n,i){return C(!1,e,t,!0,n,i)},e.reduceEachLeadingCommentRange=w,e.reduceEachTrailingCommentRange=I,e.getLeadingCommentRanges=function(e,t){return w(e,t,A,void 0,void 0)},e.getTrailingCommentRanges=function(e,t){return I(e,t,A,void 0,void 0)},e.getShebang=function(e){var t=x.exec(e);if(t)return t[0]},e.isIdentifierStart=N,e.isIdentifierPart=D,e.isIdentifierText=function(e,t){if(!N(e.charCodeAt(0),t))return!1;for(var n=1;n<e.length;n++)if(!D(e.charCodeAt(n),t))return!1;return!0},e.createScanner=function(i,r,s,o,a,l,c){var u,d,p,h,f,v,x,C,w,I;return void 0===s&&(s=0),q(o,l,c),{getStartPos:function(){return p},getTextPos:function(){return u},getToken:function(){return f},getTokenPos:function(){return h},getTokenText:function(){return o.substring(h,u)},getTokenValue:function(){return v},hasExtendedUnicodeEscape:function(){return C},hasPrecedingLineBreak:function(){return x},isIdentifier:function(){return 71===f||f>107},isReservedWord:function(){return f>=72&&f<=107},isUnterminated:function(){return w},getNumericLiteralFlags:function(){return I},reScanGreaterToken:function(){if(29===f){if(62===o.charCodeAt(u))return 62===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=67):(u+=2,f=47):61===o.charCodeAt(u+1)?(u+=2,f=66):(u++,f=46);if(61===o.charCodeAt(u))return u++,f=31}return f},reScanSlashToken:function(){if(41===f||63===f){for(var t=h+1,n=!1,r=!1;;){if(t>=d){w=!0,A(e.Diagnostics.Unterminated_regular_expression_literal);break}var s=o.charCodeAt(t);if(_(s)){w=!0,A(e.Diagnostics.Unterminated_regular_expression_literal);break}if(n)n=!1;else{if(47===s&&!r){t++;break}91===s?r=!0:92===s?n=!0:93===s&&(r=!1)}t++}for(;t<d&&D(o.charCodeAt(t),i);)t++;u=t,v=o.substring(h,u),f=12}return f},reScanTemplateToken:function(){return e.Debug.assert(18===f,"'reScanTemplateToken' should only be called on a '}'"),u=h,f=B()},scanJsxIdentifier:function(){if(t(f)){for(var e=u;u<d;){var n=o.charCodeAt(u);if(45!==n&&!(e===u?N(n,i):D(n,i)))break;u++}v+=o.substr(e,u-e)}return f},scanJsxAttributeValue:function(){switch(p=u,o.charCodeAt(u)){case 34:case 39:return v=F(!1),f=9;default:return K()}},reScanJsxToken:function(){return u=h=p,f=z()},scanJsxToken:z,scanJSDocToken:function(){if(u>=d)return f=1;p=u,h=u;var e=o.charCodeAt(u);switch(e){case 9:case 11:case 12:case 32:for(;u<d&&g(o.charCodeAt(u));)u++;return f=5;case 64:return u++,f=57;case 10:case 13:return u++,f=4;case 42:return u++,f=39;case 123:return u++,f=17;case 125:return u++,f=18;case 91:return u++,f=21;case 93:return u++,f=22;case 60:return u++,f=27;case 62:return u++,f=29;case 61:return u++,f=58;case 44:return u++,f=26;case 46:return u++,f=23}if(N(e,5)){for(u++;D(o.charCodeAt(u),5)&&u<d;)u++;return f=71}return u+=1,f=0},scan:K,getText:function(){return o},setText:q,setScriptTarget:function(e){i=e},setLanguageVariant:function(e){s=e},setOnError:function(e){a=e},setTextPos:J,tryScan:function(e){return W(e,!1)},lookAhead:function(e){return W(e,!0)},scanRange:function(e,t,n){var i=d,r=u,s=p,a=h,l=f,c=x,m=v,g=C,_=w;q(o,e,t);var y=n();return d=i,u=r,p=s,h=a,f=l,x=c,v=m,C=g,w=_,y}};function A(e,t){a&&a(e,t||0)}function O(){for(var t=u;y(o.charCodeAt(u));)u++;if(46===o.charCodeAt(u))for(u++;y(o.charCodeAt(u));)u++;var n=u;if(69===o.charCodeAt(u)||101===o.charCodeAt(u))if(u++,I=2,43!==o.charCodeAt(u)&&45!==o.charCodeAt(u)||u++,y(o.charCodeAt(u))){for(u++;y(o.charCodeAt(u));)u++;n=u}else A(e.Diagnostics.Digit_expected);return""+ +o.substring(t,n)}function R(){for(var e=u;b(o.charCodeAt(u));)u++;return+o.substring(e,u)}function L(e){return M(e,!1)}function P(e){return M(e,!0)}function M(e,t){for(var n=0,i=0;n<e||t;){var r=o.charCodeAt(u);if(r>=48&&r<=57)i=16*i+r-48;else if(r>=65&&r<=70)i=16*i+r-65+10;else{if(!(r>=97&&r<=102))break;i=16*i+r-97+10}u++,n++}return n<e&&(i=-1),i}function F(t){void 0===t&&(t=!0);for(var n=o.charCodeAt(u),i="",r=++u;;){if(u>=d){i+=o.substring(r,u),w=!0,A(e.Diagnostics.Unterminated_string_literal);break}var s=o.charCodeAt(u);if(s===n){i+=o.substring(r,u),u++;break}if(92===s&&t)i+=o.substring(r,u),i+=$(),r=u;else{if(_(s)){i+=o.substring(r,u),w=!0,A(e.Diagnostics.Unterminated_string_literal);break}u++}}return i}function B(){for(var t,n=96===o.charCodeAt(u),i=++u,r="";;){if(u>=d){r+=o.substring(i,u),w=!0,A(e.Diagnostics.Unterminated_template_literal),t=n?13:16;break}var s=o.charCodeAt(u);if(96===s){r+=o.substring(i,u),u++,t=n?13:16;break}if(36===s&&u+1<d&&123===o.charCodeAt(u+1)){r+=o.substring(i,u),u+=2,t=n?14:15;break}92!==s?13!==s?u++:(r+=o.substring(i,u),++u<d&&10===o.charCodeAt(u)&&u++,r+="\n",i=u):(r+=o.substring(i,u),r+=$(),i=u)}return e.Debug.assert(void 0!==t),v=r,t}function $(){if(++u>=d)return A(e.Diagnostics.Unexpected_end_of_text),"";var t=o.charCodeAt(u);switch(u++,t){case 48:return"\0";case 98:return"\b";case 116:return"\t";case 110:return"\n";case 118:return"\v";case 102:return"\f";case 114:return"\r";case 39:return"'";case 34:return'"';case 117:return u<d&&123===o.charCodeAt(u)?(C=!0,u++,function(){var t=P(1),n=!1;t<0?(A(e.Diagnostics.Hexadecimal_digit_expected),n=!0):t>1114111&&(A(e.Diagnostics.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive),n=!0);u>=d?(A(e.Diagnostics.Unexpected_end_of_text),n=!0):125===o.charCodeAt(u)?u++:(A(e.Diagnostics.Unterminated_Unicode_escape_sequence),n=!0);if(n)return"";return function(t){if(e.Debug.assert(0<=t&&t<=1114111),t<=65535)return String.fromCharCode(t);var n=Math.floor((t-65536)/1024)+55296,i=(t-65536)%1024+56320;return String.fromCharCode(n,i)}(t)}()):U(4);case 120:return U(2);case 13:u<d&&10===o.charCodeAt(u)&&u++;case 10:case 8232:case 8233:return"";default:return String.fromCharCode(t)}}function U(t){var n=L(t);return n>=0?String.fromCharCode(n):(A(e.Diagnostics.Hexadecimal_digit_expected),"")}function V(){if(u+5<d&&117===o.charCodeAt(u+1)){var e=u;u+=2;var t=L(4);return u=e,t}return-1}function H(){for(var e="",t=u;u<d;){var n=o.charCodeAt(u);if(D(n,i))u++;else{if(92!==n)break;if(!((n=V())>=0&&D(n,i)))break;e+=o.substring(t,u),e+=String.fromCharCode(n),t=u+=6}}return e+=o.substring(t,u)}function G(){var e=v.length;if(e>=2&&e<=11){var t=v.charCodeAt(0);if(t>=97&&t<=122&&void 0!==(f=n.get(v)))return f}return f=71}function j(t){e.Debug.assert(2===t||8===t,"Expected either base 2 or base 8");for(var n=0,i=0;;){var r=o.charCodeAt(u),s=r-48;if(!y(r)||s>=t)break;n=n*t+s,u++,i++}return 0===i?-1:n}function K(){for(p=u,C=!1,x=!1,w=!1,I=0;;){if(h=u,u>=d)return f=1;var t=o.charCodeAt(u);if(35===t&&0===u&&E(o,u)){if(u=S(o,u),r)continue;return f=6}switch(t){case 10:case 13:if(x=!0,r){u++;continue}return 13===t&&u+1<d&&10===o.charCodeAt(u+1)?u+=2:u++,f=4;case 9:case 11:case 12:case 32:if(r){u++;continue}for(;u<d&&g(o.charCodeAt(u));)u++;return f=5;case 33:return 61===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=35):(u+=2,f=33):(u++,f=51);case 34:case 39:return v=F(),f=9;case 96:return f=B();case 37:return 61===o.charCodeAt(u+1)?(u+=2,f=64):(u++,f=42);case 38:return 38===o.charCodeAt(u+1)?(u+=2,f=53):61===o.charCodeAt(u+1)?(u+=2,f=68):(u++,f=48);case 40:return u++,f=19;case 41:return u++,f=20;case 42:return 61===o.charCodeAt(u+1)?(u+=2,f=61):42===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=62):(u+=2,f=40):(u++,f=39);case 43:return 43===o.charCodeAt(u+1)?(u+=2,f=43):61===o.charCodeAt(u+1)?(u+=2,f=59):(u++,f=37);case 44:return u++,f=26;case 45:return 45===o.charCodeAt(u+1)?(u+=2,f=44):61===o.charCodeAt(u+1)?(u+=2,f=60):(u++,f=38);case 46:return y(o.charCodeAt(u+1))?(v=O(),f=8):46===o.charCodeAt(u+1)&&46===o.charCodeAt(u+2)?(u+=3,f=24):(u++,f=23);case 47:if(47===o.charCodeAt(u+1)){for(u+=2;u<d&&!_(o.charCodeAt(u));)u++;if(r)continue;return f=2}if(42===o.charCodeAt(u+1)){u+=2;for(var n=!1;u<d;){var a=o.charCodeAt(u);if(42===a&&47===o.charCodeAt(u+1)){u+=2,n=!0;break}_(a)&&(x=!0),u++}if(n||A(e.Diagnostics.Asterisk_Slash_expected),r)continue;return w=!n,f=3}return 61===o.charCodeAt(u+1)?(u+=2,f=63):(u++,f=41);case 48:var l;if(u+2<d&&(88===o.charCodeAt(u+1)||120===o.charCodeAt(u+1)))return u+=2,(l=P(1))<0&&(A(e.Diagnostics.Hexadecimal_digit_expected),l=0),v=""+l,I=8,f=8;if(u+2<d&&(66===o.charCodeAt(u+1)||98===o.charCodeAt(u+1)))return u+=2,(l=j(2))<0&&(A(e.Diagnostics.Binary_digit_expected),l=0),v=""+l,I=16,f=8;if(u+2<d&&(79===o.charCodeAt(u+1)||111===o.charCodeAt(u+1)))return u+=2,(l=j(8))<0&&(A(e.Diagnostics.Octal_digit_expected),l=0),v=""+l,I=32,f=8;if(u+1<d&&b(o.charCodeAt(u+1)))return v=""+R(),I=4,f=8;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return v=O(),f=8;case 58:return u++,f=56;case 59:return u++,f=25;case 60:if(T(o,u)){if(u=k(o,u,A),r)continue;return f=7}return 60===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=65):(u+=2,f=45):61===o.charCodeAt(u+1)?(u+=2,f=30):1===s&&47===o.charCodeAt(u+1)&&42!==o.charCodeAt(u+2)?(u+=2,f=28):(u++,f=27);case 61:if(T(o,u)){if(u=k(o,u,A),r)continue;return f=7}return 61===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=34):(u+=2,f=32):62===o.charCodeAt(u+1)?(u+=2,f=36):(u++,f=58);case 62:if(T(o,u)){if(u=k(o,u,A),r)continue;return f=7}return u++,f=29;case 63:return u++,f=55;case 91:return u++,f=21;case 93:return u++,f=22;case 94:return 61===o.charCodeAt(u+1)?(u+=2,f=70):(u++,f=50);case 123:return u++,f=17;case 124:if(T(o,u)){if(u=k(o,u,A),r)continue;return f=7}return 124===o.charCodeAt(u+1)?(u+=2,f=54):61===o.charCodeAt(u+1)?(u+=2,f=69):(u++,f=49);case 125:return u++,f=18;case 126:return u++,f=52;case 64:return u++,f=57;case 92:var c=V();return c>=0&&N(c,i)?(u+=6,v=String.fromCharCode(c)+H(),f=G()):(A(e.Diagnostics.Invalid_character),u++,f=0);default:if(N(t,i)){for(u++;u<d&&D(t=o.charCodeAt(u),i);)u++;return v=o.substring(h,u),92===t&&(v+=H()),f=G()}if(g(t)){u++;continue}if(_(t)){x=!0,u++;continue}return A(e.Diagnostics.Invalid_character),u++,f=0}}}function z(){if(p=h=u,u>=d)return f=1;var e=o.charCodeAt(u);if(60===e)return 47===o.charCodeAt(u+1)?(u+=2,f=28):(u++,f=27);if(123===e)return u++,f=17;for(var t=0;u<d&&123!==(e=o.charCodeAt(u));){if(60===e){if(T(o,u))return u=k(o,u,A),f=7;break}_(e)&&0===t?t=-1:m(e)||(t=u),u++}return-1===t?11:10}function W(e,t){var n=u,i=p,r=h,s=f,o=v,a=x,l=e();return l&&!t||(u=n,p=i,h=r,f=s,v=o,x=a),l}function q(e,t,n){o=e||"",d=void 0===n?o.length:t+n,J(t||0)}function J(t){e.Debug.assert(t>=0),u=t,p=t,h=t,f=0,x=!1,v=void 0,C=!1,w=!1}}}(ts||(ts={})),function(e){e.emptyArray=[],e.emptyMap=e.createMap(),e.externalHelpersModuleNameText="tslib",e.getDeclarationOfKind=function(e,t){var n=e.declarations;if(n)for(var i=0,r=n;i<r.length;i++){var s=r[i];if(s.kind===t)return s}};var t,n,i=(t="",{string:function(){return t},writeKeyword:n=function(e){return t+=e},writeOperator:n,writePunctuation:n,writeSpace:n,writeStringLiteral:n,writeParameter:n,writeProperty:n,writeSymbol:n,writeLine:function(){return t+=" "},increaseIndent:e.noop,decreaseIndent:e.noop,clear:function(){return t=""},trackSymbol:e.noop,reportInaccessibleThisError:e.noop,reportPrivateInBaseOfClassExpression:e.noop});function r(e){return e.end-e.pos}function s(t){return function(t){if(!(262144&t.flags)){(!!(32768&t.flags)||e.forEachChild(t,s))&&(t.flags|=131072),t.flags|=262144}}(t),!!(131072&t.flags)}function o(e){for(;e&&265!==e.kind;)e=e.parent;return e}function a(t,n){e.Debug.assert(t>=0);var i=e.getLineStarts(n),r=t,s=n.text;if(r+1===i.length)return s.length-1;var o=i[r],a=i[r+1]-1;for(e.Debug.assert(e.isLineBreak(s.charCodeAt(a)));o<=a&&e.isLineBreak(s.charCodeAt(a));)a--;return a}function l(e){return void 0===e||e.pos===e.end&&e.pos>=0&&1!==e.kind}function c(e){return!l(e)}function u(e,t){return 42===e.charCodeAt(t.pos+1)&&33===e.charCodeAt(t.pos+2)}function d(t,n,i){return l(t)?t.pos:e.isJSDocNode(t)?e.skipTrivia((n||o(t)).text,t.pos,!1,!0):i&&e.hasJSDocNodes(t)?d(t.jsDoc[0]):286===t.kind&&t._children.length>0?d(t._children[0],n,i):e.skipTrivia((n||o(t)).text,t.pos)}function p(t,n,i){if(void 0===i&&(i=!1),l(n))return"";var r=t.text;return r.substring(i?n.pos:e.skipTrivia(r,n.pos),n.end)}function h(t,n){return l(n)?"":t.substring(e.skipTrivia(t,n.pos),n.end)}function f(e,t){return void 0===t&&(t=!1),p(o(e),e,t)}function m(e,t){var n=e.pos,i=t.pos;return n<i?-1:i<n?1:0}function g(e){var t=e.emitNode;return t&&t.flags}function _(e){return e.length>=2&&95===e.charCodeAt(0)&&95===e.charCodeAt(1)?"_"+e:e}function y(e){var t=le(e);return 226===t.kind&&260===t.parent.kind}function b(e){return e&&233===e.kind&&(9===e.name.kind||T(e))}function v(t){return e.isModuleDeclaration(t)&&9===t.name.kind}function T(e){return!!(512&e.flags)}function k(t,n){switch(t.kind){case 265:case 235:case 260:case 233:case 214:case 215:case 216:case 152:case 151:case 153:case 154:case 228:case 186:case 187:return!0;case 207:return n&&!e.isFunctionLike(n)}return!1}function x(e){return 0===r(e)?"(Missing)":f(e)}function E(e){switch(e.kind){case 71:return e.escapedText;case 9:case 8:return _(e.text);case 144:if(te(e.expression))return _(e.expression.text)}}function S(t,n,i,r,s,o){var a=w(t,n);return e.createFileDiagnostic(t,a.start,a.length,i,r,s,o)}function C(t,n){var i=e.createScanner(t.languageVersion,!0,t.languageVariant,t.text,void 0,n);i.scan();var r=i.getTokenPos();return e.createTextSpanFromBounds(r,i.getTextPos())}function w(t,n){var i=n;switch(n.kind){case 265:var r=e.skipTrivia(t.text,0,!1);return r===t.text.length?e.createTextSpan(0,0):C(t,r);case 226:case 176:case 229:case 199:case 230:case 233:case 232:case 264:case 228:case 186:case 151:case 153:case 154:case 231:i=n.name;break;case 187:return function(t,n){var i=e.skipTrivia(t.text,n.pos);if(n.body&&207===n.body.kind){var r=e.getLineAndCharacterOfPosition(t,n.body.pos).line;if(r<e.getLineAndCharacterOfPosition(t,n.body.end).line)return e.createTextSpan(i,a(r,t)-i+1)}return e.createTextSpanFromBounds(i,n.end)}(t,n)}if(void 0===i)return C(t,n.pos);var s=l(i)?i.pos:e.skipTrivia(t.text,i.pos);return e.createTextSpanFromBounds(s,i.end)}function I(t){return!!(2&e.getCombinedNodeFlags(t))||!!(2048&e.getCombinedModifierFlags(t))}e.usingSingleLineStringWriter=function(e){var t=i.string();try{return e(i),i.string()}finally{i.clear(),i.writeKeyword(t)}},e.getFullWidth=r,e.getResolvedModule=function(e,t){return e&&e.resolvedModules&&e.resolvedModules.get(t)},e.setResolvedModule=function(t,n,i){t.resolvedModules||(t.resolvedModules=e.createMap()),t.resolvedModules.set(n,i)},e.setResolvedTypeReferenceDirective=function(t,n,i){t.resolvedTypeReferenceDirectiveNames||(t.resolvedTypeReferenceDirectiveNames=e.createMap()),t.resolvedTypeReferenceDirectiveNames.set(n,i)},e.moduleResolutionIsEqualTo=function(e,t){return e.isExternalLibraryImport===t.isExternalLibraryImport&&e.extension===t.extension&&e.resolvedFileName===t.resolvedFileName&&(n=e.packageId,i=t.packageId,n===i||n&&i&&n.name===i.name&&n.subModuleName===i.subModuleName&&n.version===i.version);var n,i},e.typeDirectiveIsEqualTo=function(e,t){return e.resolvedFileName===t.resolvedFileName&&e.primary===t.primary},e.hasChangesInResolutions=function(t,n,i,r){e.Debug.assert(t.length===n.length);for(var s=0;s<t.length;s++){var o=n[s],a=i&&i.get(t[s]);if(a?!o||!r(a,o):o)return!0}return!1},e.containsParseError=s,e.getSourceFileOfNode=o,e.isStatementWithLocals=function(e){switch(e.kind){case 207:case 235:case 214:case 215:case 216:return!0}return!1},e.getStartPositionOfLine=function(t,n){return e.Debug.assert(t>=0),e.getLineStarts(n)[t]},e.nodePosToString=function(t){var n=o(t),i=e.getLineAndCharacterOfPosition(n,t.pos);return n.fileName+"("+(i.line+1)+","+(i.character+1)+")"},e.getEndLinePosition=a,e.nodeIsMissing=l,e.nodeIsPresent=c,e.isRecognizedTripleSlashComment=function(t,n,i){if(47===t.charCodeAt(n+1)&&n+2<i&&47===t.charCodeAt(n+2)){var r=t.substring(n,i);return!!(r.match(e.fullTripleSlashReferencePathRegEx)||r.match(e.fullTripleSlashAMDReferencePathRegEx)||r.match(A)||r.match(N))}return!1},e.isPinnedComment=u,e.getTokenPosOfNode=d,e.getNonDecoratorTokenPosOfNode=function(t,n){return l(t)||!t.decorators?d(t,n):e.skipTrivia((n||o(t)).text,t.decorators.end)},e.getSourceTextOfNodeFromSourceFile=p,e.getTextOfNodeFromSourceText=h,e.getTextOfNode=f,e.indexOfNode=function(t,n){return e.binarySearch(t,n,m)},e.getEmitFlags=g,e.getLiteralText=function(t,n){if(!ce(t)&&t.parent)return p(n,t);var i=16777216&g(t)?ye:xe;switch(t.kind){case 9:return t.singleQuote?"'"+i(t.text,39)+"'":'"'+i(t.text,34)+'"';case 13:return"`"+i(t.text,96)+"`";case 14:return"`"+i(t.text,96)+"${";case 15:return"}"+i(t.text,96)+"${";case 16:return"}"+i(t.text,96)+"`";case 8:case 12:return t.text}e.Debug.fail("Literal kind '"+t.kind+"' not accounted for.")},e.getTextOfConstantValue=function(t){return e.isString(t)?'"'+xe(t)+'"':""+t},e.escapeLeadingUnderscores=_,e.escapeIdentifier=function(e){return e},e.makeIdentifierFromModuleName=function(t){return e.getBaseFileName(t).replace(/^(\d)/,"_$1").replace(/\W/g,"_")},e.isBlockOrCatchScoped=function(t){return!!(3&e.getCombinedNodeFlags(t))||y(t)},e.isCatchClauseVariableDeclarationOrBindingElement=y,e.isAmbientModule=b,e.isModuleWithStringLiteralName=v,e.isNonGlobalAmbientModule=function(t){return e.isModuleDeclaration(t)&&e.isStringLiteral(t.name)},e.isShorthandAmbientModuleSymbol=function(e){return(t=e.valueDeclaration)&&233===t.kind&&!t.body;var t},e.isBlockScopedContainerTopLevel=function(t){return 265===t.kind||233===t.kind||e.isFunctionLike(t)},e.isGlobalScopeAugmentation=T,e.isExternalModuleAugmentation=function(t){if(!t||!b(t))return!1;switch(t.parent.kind){case 265:return e.isExternalModule(t.parent);case 234:return b(t.parent.parent)&&!e.isExternalModule(t.parent.parent.parent)}return!1},e.isEffectiveExternalModule=function(t,n){return e.isExternalModule(t)||n.isolatedModules},e.isBlockScope=k,e.isDeclarationWithTypeParameters=function(t){switch(t.kind){case 155:case 156:case 150:case 157:case 160:case 161:case 273:case 229:case 199:case 230:case 231:case 282:case 228:case 151:case 152:case 153:case 154:case 186:case 187:return!0;default:return e.assertTypeIsNever(t),!1}},e.isAnyImportSyntax=function(e){switch(e.kind){case 238:case 237:return!0;default:return!1}},e.getEnclosingBlockScopeContainer=function(e){for(var t=e.parent;t;){if(k(t,t.parent))return t;t=t.parent}},e.declarationNameToString=x,e.getNameFromIndexInfo=function(e){return e.declaration?x(e.declaration.parameters[0].name):void 0},e.getTextOfPropertyName=E,e.entityNameToString=function t(n){switch(n.kind){case 71:return 0===r(n)?e.idText(n):f(n);case 143:return t(n.left)+"."+t(n.right);case 179:return t(n.expression)+"."+t(n.name)}},e.createDiagnosticForNode=function(e,t,n,i,r){return S(o(e),e,t,n,i,r)},e.createDiagnosticForNodeInSourceFile=S,e.createDiagnosticForNodeFromMessageChain=function(e,t){var n=o(e),i=w(n,e);return{file:n,start:i.start,length:i.length,code:t.code,category:t.category,messageText:t.next?t:t.messageText}},e.getSpanOfTokenAtPosition=C,e.getErrorSpanForNode=w,e.isExternalOrCommonJsModule=function(e){return void 0!==(e.externalModuleIndicator||e.commonJsModuleIndicator)},e.isConstEnumDeclaration=function(e){return 232===e.kind&&I(e)},e.isConst=I,e.isLet=function(t){return!!(1&e.getCombinedNodeFlags(t))},e.isSuperCall=function(e){return 181===e.kind&&97===e.expression.kind},e.isImportCall=function(e){return 181===e.kind&&91===e.expression.kind},e.isPrologueDirective=function(e){return 210===e.kind&&9===e.expression.kind},e.getLeadingCommentRangesOfNode=function(t,n){return 10!==t.kind?e.getLeadingCommentRanges(n.text,t.pos):void 0},e.getJSDocCommentRanges=function(t,n,i){var r=146===t.kind||145===t.kind||186===t.kind||187===t.kind||185===t.kind?e.concatenate(e.getTrailingCommentRanges(n,t.pos),e.getLeadingCommentRanges(n,t.pos)):e.getLeadingCommentRanges(n,t.pos);const s=i?.emitBlockCommentsAsJsDocs;return e.filter(r,function(e){return(e=>42===n.charCodeAt(e.pos+1)&&42===n.charCodeAt(e.pos+2)&&47!==n.charCodeAt(e.pos+3))(e)||s&&(e=>47===n.charCodeAt(e.pos+0)&&47===n.charCodeAt(e.pos+1)&&37===n.charCodeAt(e.pos+2))(e)})},e.fullTripleSlashReferencePathRegEx=/^(\/\/\/\s*<reference\s+path\s*=\s*)('|")(.+?)\2.*?\/>/;var A=/^(\/\/\/\s*<reference\s+types\s*=\s*)('|")(.+?)\2.*?\/>/;e.fullTripleSlashAMDReferencePathRegEx=/^(\/\/\/\s*<amd-dependency\s+path\s*=\s*)('|")(.+?)\2.*?\/>/;var N=/^(\/\/\/\s*<reference\s+no-default-lib\s*=\s*)('|")(.+?)\2\s*\/>/;function D(t){if(158<=t.kind&&t.kind<=173)return!0;switch(t.kind){case 119:case 133:case 136:case 122:case 137:case 139:case 130:return!0;case 105:return 190!==t.parent.kind;case 201:return!Xe(t);case 71:(143===t.parent.kind&&t.parent.right===t||179===t.parent.kind&&t.parent.name===t)&&(t=t.parent),e.Debug.assert(71===t.kind||143===t.kind||179===t.kind,"'node' was expected to be a qualified name, identifier or property access in 'isPartOfTypeNode'.");case 143:case 179:case 99:var n=t.parent;if(162===n.kind)return!1;if(158<=n.kind&&n.kind<=173)return!0;switch(n.kind){case 201:return!Xe(n);case 145:return t===n.constraint;case 149:case 148:case 146:case 226:case 228:case 186:case 187:case 152:case 151:case 150:case 153:case 154:case 155:case 156:case 157:case 184:return t===n.type;case 181:case 182:return n.typeArguments&&e.indexOf(n.typeArguments,t)>=0;case 183:return!1}}return!1}function O(e){if(e)switch(e.kind){case 176:case 264:case 146:case 261:case 149:case 148:case 262:case 226:return!0}return!1}function R(t,n){for(;;){if(!(t=t.parent))return;switch(t.kind){case 144:if(e.isClassLike(t.parent.parent))return t;t=t.parent;break;case 147:146===t.parent.kind&&e.isClassElement(t.parent.parent)?t=t.parent.parent:e.isClassElement(t.parent)&&(t=t.parent);break;case 187:if(!n)continue;case 228:case 186:case 233:case 149:case 148:case 151:case 150:case 152:case 153:case 154:case 155:case 156:case 157:case 232:case 265:return t}}}function L(e){switch(e.kind){case 229:return!0;case 149:return 229===e.parent.kind;case 153:case 154:case 151:return void 0!==e.body&&229===e.parent.kind;case 146:return void 0!==e.parent.body&&(152===e.parent.kind||151===e.parent.kind||154===e.parent.kind)&&229===e.parent.parent.kind}return!1}function P(e){return void 0!==e.decorators&&L(e)}function M(e){return P(e)||F(e)}function F(t){switch(t.kind){case 229:return e.forEach(t.members,M);case 151:case 154:return e.forEach(t.parameters,P)}}function B(e){var t=e.parent;return(251===t.kind||250===t.kind||252===t.kind)&&t.tagName===e}function $(e){switch(e.kind){case 97:case 95:case 101:case 86:case 12:case 177:case 178:case 179:case 180:case 181:case 182:case 183:case 202:case 184:case 203:case 185:case 186:case 199:case 187:case 190:case 188:case 189:case 192:case 193:case 194:case 195:case 198:case 196:case 13:case 200:case 249:case 250:case 197:case 191:case 204:return!0;case 143:for(;143===e.parent.kind;)e=e.parent;return 162===e.parent.kind||B(e);case 71:if(162===e.parent.kind||B(e))return!0;case 8:case 9:case 99:return U(e);default:return!1}}function U(e){var t=e.parent;switch(t.kind){case 226:case 146:case 149:case 148:case 264:case 261:case 176:return t.initializer===e;case 210:case 211:case 212:case 213:case 219:case 220:case 221:case 257:case 223:return t.expression===e;case 214:var n=t;return n.initializer===e&&227!==n.initializer.kind||n.condition===e||n.incrementor===e;case 215:case 216:var i=t;return i.initializer===e&&227!==i.initializer.kind||i.expression===e;case 184:case 202:case 205:case 144:return e===t.expression;case 147:case 256:case 255:case 263:return!0;case 201:return t.expression===e&&Xe(t);default:return $(t)}}function V(e){return 237===e.kind&&248===e.moduleReference.kind}function H(e){return G(e)}function G(e){return e&&!!(65536&e.flags)}function j(e){if(!G(e))return 0;if(58!==e.operatorToken.kind||179!==e.left.kind)return 0;var t=e.left;if(71===t.expression.kind){var n=t.expression;return"exports"===n.escapedText?1:"module"===n.escapedText&&"exports"===t.name.escapedText?2:5}if(99===t.expression.kind)return 4;if(179===t.expression.kind){var i=t.expression;if(71===i.expression.kind){if("module"===i.expression.escapedText&&"exports"===i.name.escapedText)return 1;if("prototype"===i.name.escapedText)return 3}}return 0}function K(t){return e.isExpressionStatement(t)&&t.expression&&e.isBinaryExpression(t.expression)&&58===t.expression.operatorToken.kind&&t.expression.right}function z(t,n){return e.isVariableStatement(t)&&t.declarationList.declarations.length>0&&(!n||t.declarationList.declarations[0].initializer===n)&&t.declarationList.declarations[0].initializer}function W(t,n){return e.isVariableStatement(t)&&t.declarationList.declarations.length>0&&(!n||t.declarationList.declarations[0]===n)&&t.declarationList.declarations[0]}function q(e){return 233===e.kind&&e.body&&233===e.body.kind&&e.body}function J(t){var n;return function t(i){var r=i.parent;r&&(261===r.kind||q(r))&&t(r);r&&r.parent&&(W(r.parent,i)||K(r.parent))&&t(r.parent);r&&r.parent&&r.parent.parent&&z(r.parent.parent,i)&&t(r.parent.parent);146===i.kind&&(n=e.addRange(n,e.getJSDocParameterTags(i)));O(i)&&i.initializer&&e.hasJSDocNodes(i.initializer)&&(n=e.addRange(n,i.initializer.jsDoc));e.hasJSDocNodes(i)&&(n=e.addRange(n,i.jsDoc))}(t),n||e.emptyArray}function Y(t){return e.Debug.assert(275===t.parent.kind),t.parent.parent}function X(e){return void 0!==e.dotDotDotToken}function Z(e){for(var t=e.parent;;){switch(t.kind){case 194:var n=t.operatorToken.kind;return qe(n)&&t.left===e?58===n?1:2:0;case 192:case 193:var i=t.operator;return 43===i||44===i?2:0;case 215:case 216:return t.initializer===e?1:0;case 185:case 177:case 198:e=t;break;case 262:if(t.name!==e)return 0;e=t.parent;break;case 261:if(t.name===e)return 0;e=t.parent;break;default:return 0}t=e.parent}}function Q(e){return Ze(e.expression)}function ee(e,t){if(e)for(var n=0,i=e;n<i.length;n++){var r=i[n];if(r.token===t)return r}}function te(e){var t=e.kind;return 9===t||8===t}function ne(t){var n=e.getNameOfDeclaration(t);return n&&ie(n)}function ie(e){return 144===e.kind&&!te(e.expression)&&!re(e.expression)}function re(t){return e.isPropertyAccessExpression(t)&&ae(t.expression)}function se(t){if(71===t.kind)return t.escapedText;if(9===t.kind||8===t.kind)return _(t.text);if(144===t.kind){var n=t.expression;if(re(n))return oe(e.idText(n.name));if(9===n.kind||8===n.kind)return _(n.text)}}function oe(e){return"__@"+e}function ae(e){return 71===e.kind&&"Symbol"===e.escapedText}function le(e){for(;176===e.kind;)e=e.parent.parent;return e}function ce(t){return e.positionIsSynthesized(t.pos)||e.positionIsSynthesized(t.end)}function ue(e,t,n){switch(e){case 182:return n?0:1;case 192:case 189:case 190:case 188:case 191:case 195:case 197:return 1;case 194:switch(t){case 40:case 58:case 59:case 60:case 62:case 61:case 63:case 64:case 65:case 66:case 67:case 68:case 70:case 69:return 1}}return 0}function de(e){return 194===e.kind?e.operatorToken.kind:192===e.kind||193===e.kind?e.operator:e.kind}function pe(e,t,n){switch(e){case 99:case 97:case 71:case 95:case 101:case 86:case 8:case 9:case 177:case 178:case 186:case 187:case 199:case 249:case 250:case 12:case 13:case 196:case 185:case 200:return 19;case 183:case 179:case 180:return 18;case 182:return n?18:17;case 181:return 17;case 193:return 16;case 192:case 189:case 190:case 188:case 191:return 15;case 194:switch(t){case 51:case 52:return 15;case 40:case 39:case 41:case 42:return 14;case 37:case 38:return 13;case 45:case 46:case 47:return 12;case 27:case 30:case 29:case 31:case 92:case 93:return 11;case 32:case 34:case 33:case 35:return 10;case 48:return 9;case 50:return 8;case 49:return 7;case 53:return 6;case 54:return 5;case 58:case 59:case 60:case 62:case 61:case 63:case 64:case 65:case 66:case 67:case 68:case 70:case 69:return 3;case 26:return 0;default:return-1}case 195:return 4;case 197:return 2;case 198:return 1;case 289:return 0;default:return-1}}e.isPartOfTypeNode=D,e.isChildOfNodeWithKind=function(e,t){for(;e;){if(e.kind===t)return!0;e=e.parent}return!1},e.forEachReturnStatement=function(t,n){return function t(i){switch(i.kind){case 219:return n(i);case 235:case 207:case 211:case 212:case 213:case 214:case 215:case 216:case 220:case 221:case 257:case 258:case 222:case 224:case 260:return e.forEachChild(i,t)}}(t)},e.forEachYieldExpression=function(t,n){return function t(i){switch(i.kind){case 197:n(i);var r=i.expression;return void(r&&t(r));case 232:case 230:case 233:case 231:case 229:case 199:return;default:if(e.isFunctionLike(i)){var s=i.name;if(s&&144===s.kind)return void t(s.expression)}else D(i)||e.forEachChild(i,t)}}(t)},e.getRestParameterElementType=function(t){return t&&164===t.kind?t.elementType:t&&159===t.kind?e.singleOrUndefined(t.typeArguments):void 0},e.isVariableLike=O,e.introducesArgumentsExoticObject=function(e){switch(e.kind){case 151:case 150:case 152:case 153:case 154:case 228:case 186:return!0}return!1},e.unwrapInnermostStatementOfLabel=function(e,t){for(;;){if(t&&t(e),222!==e.statement.kind)return e.statement;e=e.statement}},e.isFunctionBlock=function(t){return t&&207===t.kind&&e.isFunctionLike(t.parent)},e.isObjectLiteralMethod=function(e){return e&&151===e.kind&&178===e.parent.kind},e.isObjectLiteralOrClassExpressionMethod=function(e){return 151===e.kind&&(178===e.parent.kind||199===e.parent.kind)},e.isIdentifierTypePredicate=function(e){return e&&1===e.kind},e.isThisTypePredicate=function(e){return e&&0===e.kind},e.getPropertyAssignment=function(t,n,i){return e.filter(t.properties,function(e){if(261===e.kind){var t=E(e.name);return n===t||i&&i===t}})},e.getContainingFunction=function(t){return e.findAncestor(t.parent,e.isFunctionLike)},e.getContainingClass=function(t){return e.findAncestor(t.parent,e.isClassLike)},e.getThisContainer=R,e.getNewTargetContainer=function(e){var t=R(e,!1);if(t)switch(t.kind){case 152:case 228:case 186:return t}},e.getSuperContainer=function(t,n){for(;;){if(!(t=t.parent))return t;switch(t.kind){case 144:t=t.parent;break;case 228:case 186:case 187:if(!n)continue;case 149:case 148:case 151:case 150:case 152:case 153:case 154:return t;case 147:146===t.parent.kind&&e.isClassElement(t.parent.parent)?t=t.parent.parent:e.isClassElement(t.parent)&&(t=t.parent)}}},e.getImmediatelyInvokedFunctionExpression=function(e){if(186===e.kind||187===e.kind){for(var t=e,n=e.parent;185===n.kind;)t=n,n=n.parent;if(181===n.kind&&n.expression===t)return n}},e.isSuperProperty=function(e){var t=e.kind;return(179===t||180===t)&&97===e.expression.kind},e.getEntityNameFromTypeNode=function(e){switch(e.kind){case 159:return e.typeName;case 201:return Ze(e.expression)?e.expression:void 0;case 71:case 143:return e}},e.getInvokedExpression=function(t){return 183===t.kind?t.tag:e.isJsxOpeningLikeElement(t)?t.tagName:t.expression},e.nodeCanBeDecorated=L,e.nodeIsDecorated=P,e.nodeOrChildIsDecorated=M,e.childIsDecorated=F,e.isJSXTagName=B,e.isPartOfExpression=$,e.isInExpressionContext=U,e.isExternalModuleImportEqualsDeclaration=V,e.getExternalModuleImportEqualsDeclarationExpression=function(t){return e.Debug.assert(V(t)),t.moduleReference.expression},e.isInternalModuleImportEqualsDeclaration=function(e){return 237===e.kind&&248!==e.moduleReference.kind},e.isSourceFileJavaScript=H,e.isInJavaScriptFile=G,e.isInJSDoc=function(e){return e&&!!(1048576&e.flags)},e.isJSDocIndexSignature=function(t){return e.isTypeReferenceNode(t)&&e.isIdentifier(t.typeName)&&"Object"===t.typeName.escapedText&&t.typeArguments&&2===t.typeArguments.length&&(136===t.typeArguments[0].kind||133===t.typeArguments[0].kind)},e.isRequireCall=function(e,t){if(181!==e.kind)return!1;var n=e,i=n.expression,r=n.arguments;if(71!==i.kind||"require"!==i.escapedText)return!1;if(1!==r.length)return!1;var s=r[0];return!t||9===s.kind||13===s.kind},e.isSingleOrDoubleQuote=function(e){return 39===e||34===e},e.isStringDoubleQuoted=function(e,t){return 34===p(t,e).charCodeAt(0)},e.isDeclarationOfFunctionOrClassExpression=function(e){if(e.valueDeclaration&&226===e.valueDeclaration.kind){var t=e.valueDeclaration;return t.initializer&&(186===t.initializer.kind||199===t.initializer.kind)}return!1},e.getRightMostAssignedExpression=function(e){for(;Ye(e,!0);)e=e.right;return e},e.isExportsIdentifier=function(t){return e.isIdentifier(t)&&"exports"===t.escapedText},e.isModuleExportsPropertyAccessExpression=function(t){return e.isPropertyAccessExpression(t)&&e.isIdentifier(t.expression)&&"module"===t.expression.escapedText&&"exports"===t.name.escapedText},e.getSpecialPropertyAssignmentKind=j,e.getExternalModuleName=function(e){if(238===e.kind)return e.moduleSpecifier;if(237===e.kind){var t=e.moduleReference;if(248===t.kind)return t.expression}return 244===e.kind?e.moduleSpecifier:v(e)?e.name:void 0},e.getNamespaceDeclarationNode=function(e){if(237===e.kind)return e;var t=e.importClause;return t&&t.namedBindings&&240===t.namedBindings.kind?t.namedBindings:void 0},e.isDefaultImport=function(e){return 238===e.kind&&e.importClause&&!!e.importClause.name},e.hasQuestionToken=function(e){if(e)switch(e.kind){case 146:case 151:case 150:case 262:case 261:case 149:case 148:return void 0!==e.questionToken}return!1},e.isJSDocConstructSignature=function(e){return 273===e.kind&&e.parameters.length>0&&e.parameters[0].name&&"new"===e.parameters[0].name.escapedText},e.getAllJSDocs=function(t){return e.isJSDocTypedefTag(t)?[t.parent]:J(t)},e.getSourceOfAssignment=K,e.getSingleInitializerOfVariableStatement=z,e.getSingleVariableOfVariableStatement=W,e.getNestedModuleDeclaration=q,e.getJSDocCommentsAndTags=J,e.getParameterSymbolFromJSDoc=function(t){if(t.symbol)return t.symbol;if(e.isIdentifier(t.name)){var n=t.name.escapedText,i=Y(t),r=K(i)||z(i)||W(i)||q(i)||i;if(r&&e.isFunctionLike(r)){var s=e.find(r.parameters,function(e){return 71===e.name.kind&&e.name.escapedText===n});return s&&s.symbol}}},e.getJSDocHost=Y,e.getTypeParameterFromJsDoc=function(t){var n=t.name.escapedText,i=t.parent.parent.parent.typeParameters;return e.find(i,function(e){return e.name.escapedText===n})},e.hasRestParameter=function(t){var n=e.lastOrUndefined(t.parameters);return n&&X(n)},e.isRestParameter=X,function(e){e[e.None=0]="None",e[e.Definite=1]="Definite",e[e.Compound=2]="Compound"}(e.AssignmentKind||(e.AssignmentKind={})),e.getAssignmentTargetKind=Z,e.isAssignmentTarget=function(e){return 0!==Z(e)},e.isDeleteTarget=function(e){if(179!==e.kind&&180!==e.kind)return!1;for(e=e.parent;e&&185===e.kind;)e=e.parent;return e&&188===e.kind},e.isNodeDescendantOf=function(e,t){for(;e;){if(e===t)return!0;e=e.parent}return!1},e.isInAmbientContext=function(e){for(;e;){if(Ge(e,2)||265===e.kind&&e.isDeclarationFile)return!0;e=e.parent}return!1},e.isDeclarationName=function(t){switch(t.kind){case 71:case 9:case 8:return e.isDeclaration(t.parent)&&t.parent.name===t;default:return!1}},e.isAnyDeclarationName=function(t){switch(t.kind){case 71:case 9:case 8:if(e.isDeclaration(t.parent))return t.parent.name===t;var n=t.parent.parent;return e.isBinaryExpression(n)&&0!==j(n)&&e.getNameOfDeclaration(n)===t;default:return!1}},e.isLiteralComputedPropertyDeclarationName=function(t){return(9===t.kind||8===t.kind)&&144===t.parent.kind&&e.isDeclaration(t.parent.parent)},e.isIdentifierName=function(e){var t=e.parent;switch(t.kind){case 149:case 148:case 151:case 150:case 153:case 154:case 264:case 261:case 179:return t.name===e;case 143:if(t.right===e){for(;143===t.kind;)t=t.parent;return 162===t.kind}return!1;case 176:case 242:return t.propertyName===e;case 246:case 253:return!0}return!1},e.isAliasSymbolDeclaration=function(e){return 237===e.kind||236===e.kind||239===e.kind&&!!e.name||240===e.kind||242===e.kind||246===e.kind||243===e.kind&&Q(e)},e.exportAssignmentIsAlias=Q,e.getClassExtendsHeritageClauseElement=function(e){var t=ee(e.heritageClauses,85);return t&&t.types.length>0?t.types[0]:void 0},e.getClassImplementsHeritageClauseElements=function(e){var t=ee(e.heritageClauses,108);return t?t.types:void 0},e.getInterfaceBaseTypeNodes=function(e){var t=ee(e.heritageClauses,85);return t?t.types:void 0},e.getHeritageClause=ee,e.tryResolveScriptReference=function(t,n,i){if(!t.getCompilerOptions().noResolve){var r=e.isRootedDiskPath(i.fileName)?i.fileName:e.combinePaths(e.getDirectoryPath(n.fileName),i.fileName);return t.getSourceFile(r)}},e.getAncestor=function(e,t){for(;e;){if(e.kind===t)return e;e=e.parent}},e.getFileReferenceFromReferencePath=function(t,n){var i=new RegExp(N.source,"gim");if(/^\/\/\/\s*<reference\s+/gim.test(t)){if(i.test(t))return{isNoDefaultLib:!0};var r=e.fullTripleSlashReferencePathRegEx.exec(t),s=!r&&A.exec(t),o=r||s;if(o){var a=n.pos+o[1].length+o[2].length;return{fileReference:{pos:a,end:a+o[3].length,fileName:o[3]},isNoDefaultLib:!1,isTypeReferenceDirective:!!s}}return{diagnosticMessage:e.Diagnostics.Invalid_reference_directive_syntax,isNoDefaultLib:!1}}},e.isKeyword=function(e){return 72<=e&&e<=142},e.isTrivia=function(e){return 2<=e&&e<=7},function(e){e[e.Normal=0]="Normal",e[e.Generator=1]="Generator",e[e.Async=2]="Async",e[e.Invalid=4]="Invalid",e[e.AsyncGenerator=3]="AsyncGenerator"}(e.FunctionFlags||(e.FunctionFlags={})),e.getFunctionFlags=function(e){if(!e)return 4;var t=0;switch(e.kind){case 228:case 186:case 151:e.asteriskToken&&(t|=1);case 187:Ge(e,256)&&(t|=2)}return e.body||(t|=4),t},e.isAsyncFunction=function(e){switch(e.kind){case 228:case 186:case 187:case 151:return void 0!==e.body&&void 0===e.asteriskToken&&Ge(e,256)}return!1},e.isStringOrNumericLiteral=te,e.hasDynamicName=ne,e.isDynamicName=ie,e.isWellKnownSymbolSyntactically=re,e.getPropertyNameForPropertyNameNode=se,e.getTextOfIdentifierOrLiteral=function(t){if(t){if(71===t.kind)return e.idText(t);if(9===t.kind||8===t.kind)return t.text}},e.getEscapedTextOfIdentifierOrLiteral=function(e){if(e){if(71===e.kind)return e.escapedText;if(9===e.kind||8===e.kind)return _(e.text)}},e.getPropertyNameForKnownSymbolName=oe,e.isESSymbolIdentifier=ae,e.isPushOrUnshiftIdentifier=function(e){return"push"===e.escapedText||"unshift"===e.escapedText},e.isParameterDeclaration=function(e){return 146===le(e).kind},e.getRootDeclaration=le,e.nodeStartsNewLexicalEnvironment=function(e){var t=e.kind;return 152===t||186===t||228===t||187===t||151===t||153===t||154===t||233===t||265===t},e.nodeIsSynthesized=ce,e.getOriginalSourceFile=function(t){return e.getParseTreeNode(t,e.isSourceFile)||t},function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(e.Associativity||(e.Associativity={})),e.getExpressionAssociativity=function(e){var t=de(e),n=182===e.kind&&void 0!==e.arguments;return ue(e.kind,t,n)},e.getOperatorAssociativity=ue,e.getExpressionPrecedence=function(e){var t=de(e),n=182===e.kind&&void 0!==e.arguments;return pe(e.kind,t,n)},e.getOperator=de,e.getOperatorPrecedence=pe,e.createDiagnosticCollection=function(){var t=[],n=e.createMap(),i=!1,r=0;return{add:function(e){var s;e.file?(s=n.get(e.file.fileName))||(s=[],n.set(e.file.fileName,s)):s=t;s.push(e),i=!0,r++},getGlobalDiagnostics:function(){return s(),t},getDiagnostics:function(i){if(s(),i)return n.get(i)||[];var r=[];function o(e){r.push(e)}return e.forEach(t,o),n.forEach(function(t){e.forEach(t,o)}),e.sortAndDeduplicateDiagnostics(r)},getModificationCount:function(){return r},reattachFileDiagnostics:function(t){e.forEach(n.get(t.fileName),function(e){return e.file=t})}};function s(){i&&(i=!1,t=e.sortAndDeduplicateDiagnostics(t),n.forEach(function(t,i){n.set(i,e.sortAndDeduplicateDiagnostics(t))}))}};var he=/[\\\"\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,fe=/[\\\'\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,me=/[\\\`\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,ge=e.createMapFromTemplate({"\0":"\\0","\t":"\\t","\v":"\\v","\f":"\\f","\b":"\\b","\r":"\\r","\n":"\\n","\\":"\\\\",'"':'\\"',"'":"\\'","`":"\\`","\u2028":"\\u2028","\u2029":"\\u2029","":"\\u0085"}),_e=/\\0[0-9]/g;function ye(e,t){var n=96===t?me:39===t?fe:he;return e.replace(n,ve).replace(_e,be)}function be(e){return"\\x00"+e.charAt(e.length-1)}function ve(e){return ge.get(e)||Te(e.charCodeAt(0))}function Te(e){return"\\u"+("0000"+e.toString(16).toUpperCase()).slice(-4)}e.escapeString=ye,e.isIntrinsicJsxName=function(e){var t=e.substr(0,1);return t.toLowerCase()===t};var ke=/[^\u0000-\u007F]/g;function xe(e,t){return e=ye(e,t),ke.test(e)?e.replace(ke,function(e){return Te(e.charCodeAt(0))}):e}e.escapeNonAsciiString=xe;var Ee=["","    "];function Se(e){return void 0===Ee[e]&&(Ee[e]=Se(e-1)+Ee[1]),Ee[e]}function Ce(){return Ee[1].length}function we(e,t){return t.moduleName||Ie(e,t.fileName)}function Ie(t,n){var i=function(e){return t.getCanonicalFileName(e)},r=e.toPath(t.getCommonSourceDirectory(),t.getCurrentDirectory(),i),s=e.getNormalizedAbsolutePath(n,t.getCurrentDirectory()),o=e.getRelativePathToDirectoryOrUrl(r,s,r,i,!1);return e.removeFileExtension(o)}function Ae(e,t,n){return!(t.noEmitForJsFiles&&H(e)||e.isDeclarationFile||n(e))}function Ne(t,n,i){var r=e.getNormalizedAbsolutePath(t.fileName,n.getCurrentDirectory()),s=n.getCommonSourceDirectory();return r=0===n.getCanonicalFileName(r).indexOf(n.getCanonicalFileName(s))?r.substring(s.length):r,e.combinePaths(i,r)}function De(t,n){return e.getLineAndCharacterOfPosition(t,n).line}function Oe(t,n){return e.computeLineAndCharacterOfPosition(t,n).line}function Re(e){if(e&&e.parameters.length>0){var t=2===e.parameters.length&&Le(e.parameters[0]);return e.parameters[t?1:0]}}function Le(e){return Pe(e.name)}function Pe(e){return e&&71===e.kind&&Me(e)}function Me(e){return 99===e.originalKeywordKind}function Fe(t,n){return t.type?t.type:n||G(t)?e.getJSDocType(t):void 0}function Be(e,t,n,i){$e(e,t,n.pos,i)}function $e(e,t,n,i){i&&i.length&&n!==i[0].pos&&Oe(e,n)!==Oe(e,i[0].pos)&&t.writeLine()}function Ue(e,t,n,i,r,s,o,a){if(i&&i.length>0){r&&n.write(" ");for(var l=!1,c=0,u=i;c<u.length;c++){var d=u[c];l&&(n.write(" "),l=!1),a(e,t,n,d.pos,d.end,o),d.hasTrailingNewLine?n.writeLine():l=!0}l&&s&&n.write(" ")}}function Ve(e,t,n,i,r,s){var o=Math.min(t,s-1),a=e.substring(r,o).replace(/^\s+|\s+$/g,"");a?(n.write(a),o!==t&&n.writeLine()):n.writeLiteral(i)}function He(t,n,i){for(var r=0;n<i&&e.isWhiteSpaceSingleLine(t.charCodeAt(n));n++)9===t.charCodeAt(n)?r+=Ce()-r%Ce():r++;return r}function Ge(e,t){return!!je(e,t)}function je(e,t){return Ke(e)&t}function Ke(e){if(536870912&e.modifierFlagsCache)return-536870913&e.modifierFlagsCache;var t=ze(e);return e.modifierFlagsCache=536870912|t,t}function ze(e){var t=0;if(e.modifiers)for(var n=0,i=e.modifiers;n<i.length;n++){t|=We(i[n].kind)}return(4&e.flags||71===e.kind&&e.isInJSDocNamespace)&&(t|=1),t}function We(e){switch(e){case 115:return 32;case 114:return 4;case 113:return 16;case 112:return 8;case 117:return 128;case 84:return 1;case 124:return 2;case 76:return 2048;case 79:return 512;case 120:return 256;case 131:return 64}return 0}function qe(e){return e>=58&&e<=70}function Je(t){if(201===t.kind&&85===t.parent.token&&e.isClassLike(t.parent.parent))return t.parent.parent}function Ye(t,n){return e.isBinaryExpression(t)&&(n?58===t.operatorToken.kind:qe(t.operatorToken.kind))&&e.isLeftHandSideExpression(t.left)}function Xe(e){return void 0!==Je(e)}function Ze(e){return 71===e.kind||179===e.kind&&Ze(e.expression)}e.getIndentString=Se,e.getIndentSize=Ce,e.createTextWriter=function(t){var n,i,r,s,o;function a(e){e&&e.length&&(r&&(n+=Se(i),r=!1),n+=e)}function l(){n="",i=0,r=!0,s=0,o=0}return l(),{write:a,rawWrite:function(e){void 0!==e&&(r&&(r=!1),n+=e)},writeTextOfNode:function(e,t){a(h(e,t))},writeLiteral:function(t){if(t&&t.length){a(t);var i=e.computeLineStarts(t);i.length>1&&(s=s+i.length-1,o=n.length-t.length+e.lastOrUndefined(i))}},writeLine:function(){r||(s++,o=(n+=t).length,r=!0)},increaseIndent:function(){i++},decreaseIndent:function(){i--},getIndent:function(){return i},getTextPos:function(){return n.length},getLine:function(){return s+1},getColumn:function(){return r?i*Ce()+1:n.length-o+1},getText:function(){return n},isAtStartOfLine:function(){return r},reset:l}},e.getResolvedExternalModuleName=we,e.getExternalModuleNameFromDeclaration=function(e,t,n){var i=t.getExternalModuleFileFromDeclaration(n);if(i&&!i.isDeclarationFile)return we(e,i)},e.getExternalModuleNameFromPath=Ie,e.getOwnEmitOutputFilePath=function(t,n,i){var r=n.getCompilerOptions();return(r.outDir?e.removeFileExtension(Ne(t,n,r.outDir)):e.removeFileExtension(t.fileName))+i},e.getDeclarationEmitOutputFilePath=function(t,n){var i=n.getCompilerOptions(),r=i.declarationDir||i.outDir,s=r?Ne(t,n,r):t.fileName;return e.removeFileExtension(s)+".d.ts"},e.getSourceFilesToEmit=function(t,n){var i=t.getCompilerOptions(),r=function(e){return t.isSourceFileFromExternalLibrary(e)};if(i.outFile||i.out){var s=e.getEmitModuleKind(i),o=s===e.ModuleKind.AMD||s===e.ModuleKind.System;return e.filter(t.getSourceFiles(),function(t){return(o||!e.isExternalModule(t))&&Ae(t,i,r)})}var a=void 0===n?t.getSourceFiles():[n];return e.filter(a,function(e){return Ae(e,i,r)})},e.sourceFileMayBeEmitted=Ae,e.getSourceFilePathInNewDir=Ne,e.writeFile=function(t,n,i,r,s,o){t.writeFile(i,r,s,function(t){n.add(e.createCompilerDiagnostic(e.Diagnostics.Could_not_write_file_0_Colon_1,i,t))},o)},e.getLineOfLocalPosition=De,e.getLineOfLocalPositionFromLineMap=Oe,e.getFirstConstructorWithBody=function(t){return e.forEach(t.members,function(e){if(152===e.kind&&c(e.body))return e})},e.getSetAccessorTypeAnnotationNode=function(e){var t=Re(e);return t&&t.type},e.getThisParameter=function(e){if(e.parameters.length){var t=e.parameters[0];if(Le(t))return t}},e.parameterIsThisKeyword=Le,e.isThisIdentifier=Pe,e.identifierIsThisKeyword=Me,e.getAllAccessorDeclarations=function(t,n){var i,r,s,o;return ne(n)?(i=n,153===n.kind?s=n:154===n.kind?o=n:e.Debug.fail("Accessor has wrong kind")):e.forEach(t,function(e){153!==e.kind&&154!==e.kind||Ge(e,32)!==Ge(n,32)||se(e.name)===se(n.name)&&(i?r||(r=e):i=e,153!==e.kind||s||(s=e),154!==e.kind||o||(o=e))}),{firstAccessor:i,secondAccessor:r,getAccessor:s,setAccessor:o}},e.getEffectiveTypeAnnotationNode=Fe,e.getEffectiveReturnTypeNode=function(t,n){return t.type?t.type:n||G(t)?e.getJSDocReturnType(t):void 0},e.getEffectiveTypeParameterDeclarations=function(t,n){if(t.typeParameters)return t.typeParameters;if(n||G(t)){var i=e.getJSDocTemplateTag(t);return i&&i.typeParameters}},e.getEffectiveSetAccessorTypeAnnotationNode=function(e,t){var n=Re(e);return n&&Fe(n,t)},e.emitNewLineBeforeLeadingComments=Be,e.emitNewLineBeforeLeadingCommentsOfPosition=$e,e.emitNewLineBeforeLeadingCommentOfPosition=function(e,t,n,i){n!==i&&Oe(e,n)!==Oe(e,i)&&t.writeLine()},e.emitComments=Ue,e.emitDetachedComments=function(t,n,i,r,s,o,a){var l,c;if(a?0===s.pos&&(l=e.filter(e.getLeadingCommentRanges(t,s.pos),function(e){return u(t,e)})):l=e.getLeadingCommentRanges(t,s.pos),l){for(var d=[],p=void 0,h=0,f=l;h<f.length;h++){var m=f[h];if(p){var g=Oe(n,p.end);if(Oe(n,m.pos)>=g+2)break}d.push(m),p=m}if(d.length){g=Oe(n,e.lastOrUndefined(d).end);Oe(n,e.skipTrivia(t,s.pos))>=g+2&&(Be(n,i,s,l),Ue(t,n,i,d,!1,!0,o,r),c={nodePos:s.pos,detachedCommentEndPos:e.lastOrUndefined(d).end})}}return c},e.writeCommentRange=function(t,n,i,r,s,o){if(42===t.charCodeAt(r+1))for(var a=e.computeLineAndCharacterOfPosition(n,r),l=n.length,c=void 0,u=r,d=a.line;u<s;d++){var p=d+1===l?t.length+1:n[d+1];if(u!==r){void 0===c&&(c=He(t,n[a.line],r));var h=i.getIndent()*Ce()-c+He(t,u,p);if(h>0){var f=h%Ce(),m=Se((h-f)/Ce());for(i.rawWrite(m);f;)i.rawWrite(" "),f--}else i.rawWrite("")}Ve(t,s,i,o,u,p),u=p}else i.write(t.substring(r,s))},e.hasModifiers=function(e){return 0!==Ke(e)},e.hasModifier=Ge,e.getSelectedModifierFlags=je,e.getModifierFlags=Ke,e.getModifierFlagsNoCache=ze,e.modifierToFlag=We,e.isLogicalOperator=function(e){return 54===e||53===e||51===e},e.isAssignmentOperator=qe,e.tryGetClassExtendingExpressionWithTypeArguments=Je,e.isAssignmentExpression=Ye,e.isDestructuringAssignment=function(e){if(Ye(e,!0)){var t=e.left.kind;return 178===t||177===t}return!1},e.isExpressionWithTypeArgumentsInClassExtendsClause=Xe,e.isExpressionWithTypeArgumentsInClassImplementsClause=function(t){return 201===t.kind&&Ze(t.expression)&&t.parent&&108===t.parent.token&&t.parent.parent&&e.isClassLike(t.parent.parent)},e.isEntityNameExpression=Ze,e.isRightSideOfQualifiedNameOrPropertyAccess=function(e){return 143===e.parent.kind&&e.parent.right===e||179===e.parent.kind&&e.parent.name===e},e.isEmptyObjectLiteral=function(e){return 178===e.kind&&0===e.properties.length},e.isEmptyArrayLiteral=function(e){return 177===e.kind&&0===e.elements.length},e.getLocalSymbolForExportDefault=function(t){return function(t){return t&&e.length(t.declarations)>0&&Ge(t.declarations[0],512)}(t)?t.declarations[0].localSymbol:void 0},e.tryExtractTypeScriptExtension=function(t){return e.find(e.supportedTypescriptExtensionsForExtractExtension,function(n){return e.fileExtensionIs(t,n)})};var Qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.convertToBase64=function(t){for(var n,i,r,s,o="",a=function(t){for(var n=[],i=t.length,r=0;r<i;r++){var s=t.charCodeAt(r);s<128?n.push(s):s<2048?(n.push(s>>6|192),n.push(63&s|128)):s<65536?(n.push(s>>12|224),n.push(s>>6&63|128),n.push(63&s|128)):s<131072?(n.push(s>>18|240),n.push(s>>12&63|128),n.push(s>>6&63|128),n.push(63&s|128)):e.Debug.assert(!1,"Unexpected code point")}return n}(t),l=0,c=a.length;l<c;)n=a[l]>>2,i=(3&a[l])<<4|a[l+1]>>4,r=(15&a[l+1])<<2|a[l+2]>>6,s=63&a[l+2],l+1>=c?r=s=64:l+2>=c&&(s=64),o+=Qe.charAt(n)+Qe.charAt(i)+Qe.charAt(r)+Qe.charAt(s),l+=3;return o};var et;function tt(t,n,i){void 0===t&&(t=0);var r=function(t){var n=[];for(var i in t){var r=t[i];"number"==typeof r&&n.push([r,i])}return e.stableSort(n,function(t,n){return e.compareValues(t[0],n[0])})}(n);if(0===t)return r.length>0&&0===r[0][0]?r[0][1]:"0";if(i){for(var s="",o=t,a=r.length-1;a>=0&&0!==o;a--){var l=r[a],c=l[0],u=l[1];0!==c&&(o&c)===c&&(o&=~c,s=u+(s?", ":"")+s)}if(0===o)return s}else for(var d=0,p=r;d<p.length;d++){var h=p[d];c=h[0],u=h[1];if(c===t)return u}return t.toString()}function nt(e,t){return{pos:e,end:t}}function it(e,t){return nt(t,e.end)}function rt(e){return e.decorators&&e.decorators.length>0?it(e,e.decorators.end):e}function st(e,t,n){return ot(at(e,n),t.end,n)}function ot(e,t,n){return e===t||De(n,e)===De(n,t)}function at(t,n){return e.positionIsSynthesized(t.pos)?-1:e.skipTrivia(n.text,t.pos)}function lt(e){return void 0!==e.initializer}function ct(e){return 33554432&e.flags?e.checkFlags:0}function ut(e){var t=e.parent;if(!t)return 0;switch(t.kind){case 193:case 192:var n=t.operator;return 43===n||44===n?o():0;case 194:var i=t,r=i.left,s=i.operatorToken;return r===e&&qe(s.kind)?o():0;case 179:return t.name!==e?0:ut(t);default:return 0}function o(){return t.parent&&210===t.parent.kind?1:2}}e.getNewLineCharacter=function(t,n){switch(t.newLine){case 0:return"\r\n";case 1:return"\n"}return n?n.newLine:e.sys?e.sys.newLine:"\r\n"},e.formatSyntaxKind=function(t){return tt(t,e.SyntaxKind,!1)},e.formatModifierFlags=function(t){return tt(t,e.ModifierFlags,!0)},e.formatTransformFlags=function(t){return tt(t,e.TransformFlags,!0)},e.formatEmitFlags=function(t){return tt(t,e.EmitFlags,!0)},e.formatSymbolFlags=function(t){return tt(t,e.SymbolFlags,!0)},e.formatTypeFlags=function(t){return tt(t,e.TypeFlags,!0)},e.formatObjectFlags=function(t){return tt(t,e.ObjectFlags,!0)},e.createRange=nt,e.moveRangeEnd=function(e,t){return nt(e.pos,t)},e.moveRangePos=it,e.moveRangePastDecorators=rt,e.moveRangePastModifiers=function(e){return e.modifiers&&e.modifiers.length>0?it(e,e.modifiers.end):rt(e)},e.isCollapsedRange=function(e){return e.pos===e.end},e.createTokenRange=function(t,n){return nt(t,t+e.tokenToString(n).length)},e.rangeIsOnSingleLine=function(e,t){return st(e,e,t)},e.rangeStartPositionsAreOnSameLine=function(e,t,n){return ot(at(e,n),at(t,n),n)},e.rangeEndPositionsAreOnSameLine=function(e,t,n){return ot(e.end,t.end,n)},e.rangeStartIsOnSameLineAsRangeEnd=st,e.rangeEndIsOnSameLineAsRangeStart=function(e,t,n){return ot(e.end,at(t,n),n)},e.positionsAreOnSameLine=ot,e.getStartPositionOfRange=at,e.isDeclarationNameOfEnumOrNamespace=function(t){var n=e.getParseTreeNode(t);if(n)switch(n.parent.kind){case 232:case 233:return n===n.parent.name}return!1},e.getInitializedVariables=function(t){return e.filter(t.declarations,lt)},e.isWatchSet=function(e){return e.watch&&e.hasOwnProperty("watch")},e.getCheckFlags=ct,e.getDeclarationModifierFlagsFromSymbol=function(t){if(t.valueDeclaration){var n=e.getCombinedModifierFlags(t.valueDeclaration);return t.parent&&32&t.parent.flags?n:-29&n}if(6&ct(t)){var i=t.checkFlags;return(256&i?8:64&i?4:16)|(512&i?32:0)}return 4194304&t.flags?36:0},e.levenshtein=function(e,t){for(var n=new Array(t.length+1),i=new Array(t.length+1),r=0;r<t.length+1;r++)n[r]=r,i[r]=-1;for(r=1;r<e.length+1;r++){i[0]=r;for(var s=1;s<t.length+1;s++)i[s]=Math.min(n[s]+1,i[s-1]+1,n[s-1]+(e[r-1]===t[s-1]?0:2));var o=n;n=i,i=o}return n[n.length-1]},e.skipAlias=function(e,t){return 2097152&e.flags?t.getAliasedSymbol(e):e},e.getCombinedLocalAndExportSymbolFlags=function(e){return e.exportSymbol?e.exportSymbol.flags|e.flags:e.flags},e.isWriteOnlyAccess=function(e){return 1===ut(e)},e.isWriteAccess=function(e){return 0!==ut(e)},function(e){e[e.Read=0]="Read",e[e.Write=1]="Write",e[e.ReadWrite=2]="ReadWrite"}(et||(et={})),e.compareDataObjects=function e(t,n){if(!t||!n||Object.keys(t).length!==Object.keys(n).length)return!1;for(var i in t)if("object"==typeof t[i]){if(!e(t[i],n[i]))return!1}else if("function"!=typeof t[i]&&t[i]!==n[i])return!1;return!0},e.clearMap=function(e,t){e.forEach(t),e.clear()},e.mutateMap=function(e,t,n){var i=n.createNewValue,r=n.onDeleteValue,s=n.onExistingValue;e.forEach(function(n,i){var o=t.get(i);void 0===o?(e.delete(i),r(n,i)):s&&s(n,o,i)}),t.forEach(function(t,n){e.has(n)||e.set(n,i(n,t))})},e.forEachAncestorDirectory=function(t,n){for(;;){var i=n(t);if(void 0!==i)return i;var r=e.getDirectoryPath(t);if(r===t)return;t=r}}}(ts||(ts={})),function(e){function t(e){return e.start+e.length}function n(e){return 0===e.length}function i(e,t){if(e<0)throw new Error("start < 0");if(t<0)throw new Error("length < 0");return{start:e,length:t}}function r(e,t){return i(e,t-e)}function s(e,t){if(t<0)throw new Error("newLength < 0");return{span:e,newLength:t}}function o(t){return!!e.isBindingPattern(t)&&e.every(t.elements,a)}function a(t){return!!e.isOmittedExpression(t)||o(t.name)}function l(t){for(;t&&(176===t.kind||e.isBindingPattern(t));)t=t.parent;return t}function c(e,t){if(e)for(;void 0!==e.original;)e=e.original;return!t||t(e)?e:void 0}function u(e){return!(8&e.flags)}function d(e){var t=e;return t.length>=3&&95===t.charCodeAt(0)&&95===t.charCodeAt(1)&&95===t.charCodeAt(2)?t.substr(1):t}function p(t){var n=f(t);return e.isIdentifier(n)?n:void 0}function h(t){return t.name||function(t){var n=t.parent.parent;if(n){if(e.isDeclaration(n))return p(n);switch(n.kind){case 208:return n.declarationList&&n.declarationList.declarations[0]?p(n.declarationList.declarations[0]):void 0;case 210:var i=n.expression;switch(i.kind){case 179:return i.name;case 180:var r=i.argumentExpression;if(e.isIdentifier(r))return r}return;case 1:return;case 185:return p(n.expression);case 222:return e.isDeclaration(n.statement)||e.isExpression(n.statement)?p(n.statement):void 0;default:e.Debug.assertNever(n,"Found typedef tag attached to node which it should not be!")}}}(t)}function f(t){if(t){switch(t.kind){case 284:case 279:var n=t.name;if(143===n.kind)return n.right;break;case 194:var i=t;switch(e.getSpecialPropertyAssignmentKind(i)){case 1:case 4:case 5:case 3:return i.left.name;default:return}case 283:return h(t);case 243:var r=t.expression;return e.isIdentifier(r)?r:void 0}return t.name}}function m(t){if(t.name&&e.isIdentifier(t.name)){var n=t.name.escapedText;return _(t.parent).filter(function(t){return e.isJSDocParameterTag(t)&&e.isIdentifier(t.name)&&t.name.escapedText===n})}}function g(e){return y(e,280)}function _(t){var n=t.jsDocCache;return void 0===n&&(t.jsDocCache=n=e.flatMap(e.getJSDocCommentsAndTags(t),function(t){return e.isJSDoc(t)?t.tags:t})),n}function y(t,n){var i=_(t);return e.find(i,function(e){return e.kind===n})}e.getDefaultLibFileName=function(e){switch(e.target){case 5:return"lib.esnext.full.d.ts";case 4:return"lib.es2017.full.d.ts";case 3:return"lib.es2016.full.d.ts";case 2:return"lib.es6.d.ts";default:return"lib.d.ts"}},e.textSpanEnd=t,e.textSpanIsEmpty=n,e.textSpanContainsPosition=function(e,n){return n>=e.start&&n<t(e)},e.textSpanContainsTextSpan=function(e,n){return n.start>=e.start&&t(n)<=t(e)},e.textSpanOverlapsWith=function(e,n){return Math.max(e.start,n.start)<Math.min(t(e),t(n))},e.textSpanOverlap=function(e,n){var i=Math.max(e.start,n.start),s=Math.min(t(e),t(n));if(i<s)return r(i,s)},e.textSpanIntersectsWithTextSpan=function(e,n){return n.start<=t(e)&&t(n)>=e.start},e.textSpanIntersectsWith=function(e,n,i){var r=n+i;return n<=t(e)&&r>=e.start},e.decodedTextSpanIntersectsWith=function(e,t,n,i){return n<=e+t&&n+i>=e},e.textSpanIntersectsWithPosition=function(e,n){return n<=t(e)&&n>=e.start},e.textSpanIntersection=function(e,n){var i=Math.max(e.start,n.start),s=Math.min(t(e),t(n));if(i<=s)return r(i,s)},e.createTextSpan=i,e.createTextSpanFromBounds=r,e.textChangeRangeNewSpan=function(e){return i(e.span.start,e.newLength)},e.textChangeRangeIsUnchanged=function(e){return n(e.span)&&0===e.newLength},e.createTextChangeRange=s,e.unchangedTextChangeRange=s(i(0,0),0),e.collapseTextChangeRangesAcrossMultipleVersions=function(n){if(0===n.length)return e.unchangedTextChangeRange;if(1===n.length)return n[0];for(var i=n[0],o=i.span.start,a=t(i.span),l=o+i.newLength,c=1;c<n.length;c++){var u=n[c],d=o,p=a,h=l,f=u.span.start,m=t(u.span),g=f+u.newLength;o=Math.min(d,f),a=Math.max(p,p+(m-h)),l=Math.max(g,g+(h-m))}return s(r(o,a),l-o)},e.getTypeParameterOwner=function(t){if(t&&145===t.kind)for(var n=t;n;n=n.parent)if(e.isFunctionLike(n)||e.isClassLike(n)||230===n.kind)return n},e.isParameterPropertyDeclaration=function(t){return e.hasModifier(t,92)&&152===t.parent.kind&&e.isClassLike(t.parent.parent)},e.isEmptyBindingPattern=o,e.isEmptyBindingElement=a,e.getCombinedModifierFlags=function(t){t=l(t);var n=e.getModifierFlags(t);return 226===t.kind&&(t=t.parent),t&&227===t.kind&&(n|=e.getModifierFlags(t),t=t.parent),t&&208===t.kind&&(n|=e.getModifierFlags(t)),n},e.getCombinedNodeFlags=function(e){var t=(e=l(e)).flags;return 226===e.kind&&(e=e.parent),e&&227===e.kind&&(t|=e.flags,e=e.parent),e&&208===e.kind&&(t|=e.flags),t},e.validateLocaleAndSetLanguage=function(t,n,i){var r=/^([a-z]+)([_\-]([a-z]+))?$/.exec(t.toLowerCase());if(r){var s=r[1];o(s,r[3],i)||o(s,void 0,i)}else i&&i.push(e.createCompilerDiagnostic(e.Diagnostics.Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1,"en","ja-jp"));function o(t,i,r){var s=e.normalizePath(n.getExecutingFilePath()),o=e.getDirectoryPath(s),a=e.combinePaths(o,t);if(i&&(a=a+"-"+i),a=n.resolvePath(e.combinePaths(a,"diagnosticMessages.generated.json")),!n.fileExists(a))return!1;var l="";try{l=n.readFile(a)}catch(t){return r&&r.push(e.createCompilerDiagnostic(e.Diagnostics.Unable_to_open_file_0,a)),!1}try{e.localizedDiagnosticMessages=JSON.parse(l)}catch(t){return r&&r.push(e.createCompilerDiagnostic(e.Diagnostics.Corrupted_locale_file_0,a)),!1}return!0}},e.getOriginalNode=c,e.isParseTreeNode=u,e.getParseTreeNode=function(e,t){return void 0===e||u(e)?e:!u(e=c(e))||t&&!t(e)?void 0:e},e.unescapeLeadingUnderscores=d,e.idText=function(e){return d(e.escapedText)},e.symbolName=function(e){return d(e.escapedName)},e.unescapeIdentifier=function(e){return e},e.getNameOfJSDocTypedef=h,e.getNameOfDeclaration=f,e.getJSDocParameterTags=m,e.hasJSDocParameterTags=function(e){return!!y(e,279)},e.getJSDocAugmentsTag=function(e){return y(e,277)},e.getJSDocClassTag=function(e){return y(e,278)},e.getJSDocReturnTag=g,e.getJSDocTemplateTag=function(e){return y(e,282)},e.getJSDocTypeTag=function(e){var t=y(e,281);if(t&&t.typeExpression&&t.typeExpression.type)return t},e.getJSDocType=function(t){var n=y(t,281);if(!n&&146===t.kind){var i=m(t);i&&(n=e.find(i,function(e){return!!e.typeExpression}))}return n&&n.typeExpression&&n.typeExpression.type},e.getJSDocReturnType=function(e){var t=g(e);return t&&t.typeExpression&&t.typeExpression.type},e.getJSDocTags=_,e.getAllJSDocTagsOfKind=function(t,n){var i=_(t);return e.filter(i,function(e){return e.kind===n})}}(ts||(ts={})),function(e){e.isNumericLiteral=function(e){return 8===e.kind},e.isStringLiteral=function(e){return 9===e.kind},e.isJsxText=function(e){return 10===e.kind},e.isRegularExpressionLiteral=function(e){return 12===e.kind},e.isNoSubstitutionTemplateLiteral=function(e){return 13===e.kind},e.isTemplateHead=function(e){return 14===e.kind},e.isTemplateMiddle=function(e){return 15===e.kind},e.isTemplateTail=function(e){return 16===e.kind},e.isIdentifier=function(e){return 71===e.kind},e.isQualifiedName=function(e){return 143===e.kind},e.isComputedPropertyName=function(e){return 144===e.kind},e.isTypeParameterDeclaration=function(e){return 145===e.kind},e.isParameter=function(e){return 146===e.kind},e.isDecorator=function(e){return 147===e.kind},e.isPropertySignature=function(e){return 148===e.kind},e.isPropertyDeclaration=function(e){return 149===e.kind},e.isMethodSignature=function(e){return 150===e.kind},e.isMethodDeclaration=function(e){return 151===e.kind},e.isConstructorDeclaration=function(e){return 152===e.kind},e.isGetAccessorDeclaration=function(e){return 153===e.kind},e.isSetAccessorDeclaration=function(e){return 154===e.kind},e.isCallSignatureDeclaration=function(e){return 155===e.kind},e.isConstructSignatureDeclaration=function(e){return 156===e.kind},e.isIndexSignatureDeclaration=function(e){return 157===e.kind},e.isTypePredicateNode=function(e){return 158===e.kind},e.isTypeReferenceNode=function(e){return 159===e.kind},e.isFunctionTypeNode=function(e){return 160===e.kind},e.isConstructorTypeNode=function(e){return 161===e.kind},e.isTypeQueryNode=function(e){return 162===e.kind},e.isTypeLiteralNode=function(e){return 163===e.kind},e.isArrayTypeNode=function(e){return 164===e.kind},e.isTupleTypeNode=function(e){return 165===e.kind},e.isUnionTypeNode=function(e){return 166===e.kind},e.isIntersectionTypeNode=function(e){return 167===e.kind},e.isParenthesizedTypeNode=function(e){return 168===e.kind},e.isThisTypeNode=function(e){return 169===e.kind},e.isTypeOperatorNode=function(e){return 170===e.kind},e.isIndexedAccessTypeNode=function(e){return 171===e.kind},e.isMappedTypeNode=function(e){return 172===e.kind},e.isLiteralTypeNode=function(e){return 173===e.kind},e.isObjectBindingPattern=function(e){return 174===e.kind},e.isArrayBindingPattern=function(e){return 175===e.kind},e.isBindingElement=function(e){return 176===e.kind},e.isArrayLiteralExpression=function(e){return 177===e.kind},e.isObjectLiteralExpression=function(e){return 178===e.kind},e.isPropertyAccessExpression=function(e){return 179===e.kind},e.isElementAccessExpression=function(e){return 180===e.kind},e.isCallExpression=function(e){return 181===e.kind},e.isNewExpression=function(e){return 182===e.kind},e.isTaggedTemplateExpression=function(e){return 183===e.kind},e.isTypeAssertion=function(e){return 184===e.kind},e.isParenthesizedExpression=function(e){return 185===e.kind},e.skipPartiallyEmittedExpressions=function(e){for(;288===e.kind;)e=e.expression;return e},e.isFunctionExpression=function(e){return 186===e.kind},e.isArrowFunction=function(e){return 187===e.kind},e.isDeleteExpression=function(e){return 188===e.kind},e.isTypeOfExpression=function(e){return 191===e.kind},e.isVoidExpression=function(e){return 190===e.kind},e.isAwaitExpression=function(e){return 191===e.kind},e.isPrefixUnaryExpression=function(e){return 192===e.kind},e.isPostfixUnaryExpression=function(e){return 193===e.kind},e.isBinaryExpression=function(e){return 194===e.kind},e.isConditionalExpression=function(e){return 195===e.kind},e.isTemplateExpression=function(e){return 196===e.kind},e.isYieldExpression=function(e){return 197===e.kind},e.isSpreadElement=function(e){return 198===e.kind},e.isClassExpression=function(e){return 199===e.kind},e.isOmittedExpression=function(e){return 200===e.kind},e.isExpressionWithTypeArguments=function(e){return 201===e.kind},e.isAsExpression=function(e){return 202===e.kind},e.isNonNullExpression=function(e){return 203===e.kind},e.isMetaProperty=function(e){return 204===e.kind},e.isTemplateSpan=function(e){return 205===e.kind},e.isSemicolonClassElement=function(e){return 206===e.kind},e.isBlock=function(e){return 207===e.kind},e.isVariableStatement=function(e){return 208===e.kind},e.isEmptyStatement=function(e){return 209===e.kind},e.isExpressionStatement=function(e){return 210===e.kind},e.isIfStatement=function(e){return 211===e.kind},e.isDoStatement=function(e){return 212===e.kind},e.isWhileStatement=function(e){return 213===e.kind},e.isForStatement=function(e){return 214===e.kind},e.isForInStatement=function(e){return 215===e.kind},e.isForOfStatement=function(e){return 216===e.kind},e.isContinueStatement=function(e){return 217===e.kind},e.isBreakStatement=function(e){return 218===e.kind},e.isReturnStatement=function(e){return 219===e.kind},e.isWithStatement=function(e){return 220===e.kind},e.isSwitchStatement=function(e){return 221===e.kind},e.isLabeledStatement=function(e){return 222===e.kind},e.isThrowStatement=function(e){return 223===e.kind},e.isTryStatement=function(e){return 224===e.kind},e.isDebuggerStatement=function(e){return 225===e.kind},e.isVariableDeclaration=function(e){return 226===e.kind},e.isVariableDeclarationList=function(e){return 227===e.kind},e.isFunctionDeclaration=function(e){return 228===e.kind},e.isClassDeclaration=function(e){return 229===e.kind},e.isInterfaceDeclaration=function(e){return 230===e.kind},e.isTypeAliasDeclaration=function(e){return 231===e.kind},e.isEnumDeclaration=function(e){return 232===e.kind},e.isModuleDeclaration=function(e){return 233===e.kind},e.isModuleBlock=function(e){return 234===e.kind},e.isCaseBlock=function(e){return 235===e.kind},e.isNamespaceExportDeclaration=function(e){return 236===e.kind},e.isImportEqualsDeclaration=function(e){return 237===e.kind},e.isImportDeclaration=function(e){return 238===e.kind},e.isImportClause=function(e){return 239===e.kind},e.isNamespaceImport=function(e){return 240===e.kind},e.isNamedImports=function(e){return 241===e.kind},e.isImportSpecifier=function(e){return 242===e.kind},e.isExportAssignment=function(e){return 243===e.kind},e.isExportDeclaration=function(e){return 244===e.kind},e.isNamedExports=function(e){return 245===e.kind},e.isExportSpecifier=function(e){return 246===e.kind},e.isMissingDeclaration=function(e){return 247===e.kind},e.isExternalModuleReference=function(e){return 248===e.kind},e.isJsxElement=function(e){return 249===e.kind},e.isJsxSelfClosingElement=function(e){return 250===e.kind},e.isJsxOpeningElement=function(e){return 251===e.kind},e.isJsxClosingElement=function(e){return 252===e.kind},e.isJsxAttribute=function(e){return 253===e.kind},e.isJsxAttributes=function(e){return 254===e.kind},e.isJsxSpreadAttribute=function(e){return 255===e.kind},e.isJsxExpression=function(e){return 256===e.kind},e.isCaseClause=function(e){return 257===e.kind},e.isDefaultClause=function(e){return 258===e.kind},e.isHeritageClause=function(e){return 259===e.kind},e.isCatchClause=function(e){return 260===e.kind},e.isPropertyAssignment=function(e){return 261===e.kind},e.isShorthandPropertyAssignment=function(e){return 262===e.kind},e.isSpreadAssignment=function(e){return 263===e.kind},e.isEnumMember=function(e){return 264===e.kind},e.isSourceFile=function(e){return 265===e.kind},e.isBundle=function(e){return 266===e.kind},e.isJSDocTypeExpression=function(e){return 267===e.kind},e.isJSDocAllType=function(e){return 268===e.kind},e.isJSDocUnknownType=function(e){return 269===e.kind},e.isJSDocNullableType=function(e){return 270===e.kind},e.isJSDocNonNullableType=function(e){return 271===e.kind},e.isJSDocOptionalType=function(e){return 272===e.kind},e.isJSDocFunctionType=function(e){return 273===e.kind},e.isJSDocVariadicType=function(e){return 274===e.kind},e.isJSDoc=function(e){return 275===e.kind},e.isJSDocAugmentsTag=function(e){return 277===e.kind},e.isJSDocParameterTag=function(e){return 279===e.kind},e.isJSDocReturnTag=function(e){return 280===e.kind},e.isJSDocTypeTag=function(e){return 281===e.kind},e.isJSDocTemplateTag=function(e){return 282===e.kind},e.isJSDocTypedefTag=function(e){return 283===e.kind},e.isJSDocPropertyTag=function(e){return 284===e.kind},e.isJSDocPropertyLikeTag=function(e){return 284===e.kind||279===e.kind},e.isJSDocTypeLiteral=function(e){return 285===e.kind}}(ts||(ts={})),function(e){function t(e){return e>=143}function n(e){return 8<=e&&e<=13}function i(e){switch(e){case 117:case 120:case 76:case 124:case 79:case 84:case 114:case 112:case 113:case 131:case 115:return!0}return!1}function r(e){return e&&o(e.kind)}function s(e){switch(e){case 228:case 151:case 152:case 153:case 154:case 186:case 187:return!0;default:return!1}}function o(e){switch(e){case 150:case 155:case 156:case 157:case 160:case 273:case 161:return!0;default:return s(e)}}function a(e){switch(e.kind){case 174:case 178:return!0}return!1}function l(e){switch(e.kind){case 175:case 177:return!0}return!1}function c(e){switch(e){case 179:case 180:case 182:case 181:case 249:case 250:case 183:case 177:case 185:case 178:case 199:case 186:case 71:case 12:case 8:case 9:case 13:case 196:case 86:case 95:case 99:case 101:case 97:case 203:case 204:case 91:return!0;default:return!1}}function u(e){switch(e){case 192:case 193:case 188:case 189:case 190:case 191:case 184:return!0;default:return c(e)}}function d(t){return function(e){switch(e){case 195:case 197:case 187:case 194:case 198:case 202:case 200:case 289:case 288:return!0;default:return u(e)}}(e.skipPartiallyEmittedExpressions(t).kind)}function p(e){return 288===e.kind}function h(e){return 287===e.kind}function f(e){return 228===e||247===e||229===e||230===e||231===e||232===e||233===e||238===e||237===e||244===e||243===e||236===e}function m(e){return 218===e||217===e||225===e||212===e||210===e||209===e||215===e||216===e||214===e||211===e||222===e||219===e||221===e||223===e||224===e||208===e||213===e||220===e||287===e||291===e||290===e}function g(e){return e.kind>=276&&e.kind<=285}e.isSyntaxList=function(e){return 286===e.kind},e.isNode=function(e){return t(e.kind)},e.isNodeKind=t,e.isToken=function(e){return e.kind>=0&&e.kind<=142},e.isNodeArray=function(e){return e.hasOwnProperty("pos")&&e.hasOwnProperty("end")},e.isLiteralKind=n,e.isLiteralExpression=function(e){return n(e.kind)},e.isTemplateLiteralKind=function(e){return 13<=e&&e<=16},e.isTemplateMiddleOrTemplateTail=function(e){var t=e.kind;return 15===t||16===t},e.isStringTextContainingNode=function(e){switch(e.kind){case 9:case 14:case 15:case 16:case 13:return!0;default:return!1}},e.isGeneratedIdentifier=function(t){return e.isIdentifier(t)&&t.autoGenerateKind>0},e.isModifierKind=i,e.isModifier=function(e){return i(e.kind)},e.isEntityName=function(e){var t=e.kind;return 143===t||71===t},e.isPropertyName=function(e){var t=e.kind;return 71===t||9===t||8===t||144===t},e.isBindingName=function(e){var t=e.kind;return 71===t||174===t||175===t},e.isFunctionLike=r,e.isFunctionLikeDeclaration=function(e){return e&&s(e.kind)},e.isFunctionLikeKind=o,e.isFunctionOrModuleBlock=function(t){return e.isSourceFile(t)||e.isModuleBlock(t)||e.isBlock(t)&&r(t.parent)},e.isClassElement=function(e){var t=e.kind;return 152===t||149===t||151===t||153===t||154===t||157===t||206===t||247===t},e.isClassLike=function(e){return e&&(229===e.kind||199===e.kind)},e.isAccessor=function(e){return e&&(153===e.kind||154===e.kind)},e.isTypeElement=function(e){var t=e.kind;return 156===t||155===t||148===t||150===t||157===t||247===t},e.isObjectLiteralElementLike=function(e){var t=e.kind;return 261===t||262===t||263===t||151===t||153===t||154===t||247===t},e.isTypeNode=function(e){return(t=e.kind)>=158&&t<=173||119===t||133===t||134===t||122===t||136===t||137===t||99===t||105===t||139===t||95===t||130===t||201===t||268===t||269===t||270===t||271===t||272===t||273===t||274===t;var t},e.isFunctionOrConstructorTypeNode=function(e){switch(e.kind){case 160:case 161:return!0}return!1},e.isBindingPattern=function(e){if(e){var t=e.kind;return 175===t||174===t}return!1},e.isAssignmentPattern=function(e){var t=e.kind;return 177===t||178===t},e.isArrayBindingElement=function(e){var t=e.kind;return 176===t||200===t},e.isDeclarationBindingElement=function(e){switch(e.kind){case 226:case 146:case 176:return!0}return!1},e.isBindingOrAssignmentPattern=function(e){return a(e)||l(e)},e.isObjectBindingOrAssignmentPattern=a,e.isArrayBindingOrAssignmentPattern=l,e.isPropertyAccessOrQualifiedName=function(e){var t=e.kind;return 179===t||143===t},e.isCallLikeExpression=function(e){switch(e.kind){case 251:case 250:case 181:case 182:case 183:case 147:return!0;default:return!1}},e.isCallOrNewExpression=function(e){return 181===e.kind||182===e.kind},e.isTemplateLiteral=function(e){var t=e.kind;return 196===t||13===t},e.isLeftHandSideExpression=function(t){return c(e.skipPartiallyEmittedExpressions(t).kind)},e.isUnaryExpression=function(t){return u(e.skipPartiallyEmittedExpressions(t).kind)},e.isUnaryExpressionWithWrite=function(e){switch(e.kind){case 193:return!0;case 192:return 43===e.operator||44===e.operator;default:return!1}},e.isExpression=d,e.isAssertionExpression=function(e){var t=e.kind;return 184===t||202===t},e.isPartiallyEmittedExpression=p,e.isNotEmittedStatement=h,e.isNotEmittedOrPartiallyEmittedNode=function(e){return h(e)||p(e)},e.isIterationStatement=function e(t,n){switch(t.kind){case 214:case 215:case 216:case 212:case 213:return!0;case 222:return n&&e(t.statement,n)}return!1},e.isForInOrOfStatement=function(e){return 215===e.kind||216===e.kind},e.isConciseBody=function(t){return e.isBlock(t)||d(t)},e.isFunctionBody=function(t){return e.isBlock(t)},e.isForInitializer=function(t){return e.isVariableDeclarationList(t)||d(t)},e.isModuleBody=function(e){var t=e.kind;return 234===t||233===t||71===t},e.isNamespaceBody=function(e){var t=e.kind;return 234===t||233===t},e.isJSDocNamespaceBody=function(e){var t=e.kind;return 71===t||233===t},e.isNamedImportBindings=function(e){var t=e.kind;return 241===t||240===t},e.isModuleOrEnumDeclaration=function(e){return 233===e.kind||232===e.kind},e.isDeclaration=function(t){return 145===t.kind?282!==t.parent.kind||e.isInJavaScriptFile(t):187===(n=t.kind)||176===n||229===n||199===n||152===n||232===n||264===n||246===n||228===n||186===n||153===n||239===n||237===n||242===n||230===n||253===n||151===n||150===n||233===n||236===n||240===n||146===n||261===n||149===n||148===n||154===n||262===n||231===n||145===n||226===n||283===n;var n},e.isDeclarationStatement=function(e){return f(e.kind)},e.isStatementButNotDeclaration=function(e){return m(e.kind)},e.isStatement=function(t){var n=t.kind;return m(n)||f(n)||function(t){if(207!==t.kind)return!1;if(void 0!==t.parent&&(224===t.parent.kind||260===t.parent.kind))return!1;return!e.isFunctionBlock(t)}(t)},e.isModuleReference=function(e){var t=e.kind;return 248===t||143===t||71===t},e.isJsxTagNameExpression=function(e){var t=e.kind;return 99===t||71===t||179===t},e.isJsxChild=function(e){var t=e.kind;return 249===t||256===t||250===t||10===t},e.isJsxAttributeLike=function(e){var t=e.kind;return 253===t||255===t},e.isStringLiteralOrJsxExpression=function(e){var t=e.kind;return 9===t||256===t},e.isJsxOpeningLikeElement=function(e){var t=e.kind;return 251===t||250===t},e.isCaseOrDefaultClause=function(e){var t=e.kind;return 257===t||258===t},e.isJSDocNode=function(e){return e.kind>=267&&e.kind<=285},e.isJSDocCommentContainingNode=function(e){return 275===e.kind||g(e)},e.isJSDocTag=g,e.isSetAccessor=function(e){return 154===e.kind},e.isGetAccessor=function(e){return 153===e.kind},e.hasJSDocNodes=function(e){return!!e.jsDoc&&e.jsDoc.length>0}}(ts||(ts={})),function(e){var t,n,i,r,s,o,a;function l(e,t){return t&&e(t)}function c(e,t,n){if(n){if(t)return t(n);for(var i=0,r=n;i<r.length;i++){var s=e(r[i]);if(s)return s}}}function u(e,t,n){if(e&&!(e.kind<=142))switch(e.kind){case 143:return l(t,e.left)||l(t,e.right);case 145:return l(t,e.name)||l(t,e.constraint)||l(t,e.default)||l(t,e.expression);case 262:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||l(t,e.questionToken)||l(t,e.equalsToken)||l(t,e.objectAssignmentInitializer);case 263:case 185:case 188:case 189:case 190:case 191:case 203:case 198:case 210:case 219:case 223:case 147:case 144:case 248:case 255:case 288:return l(t,e.expression);case 146:case 149:case 148:case 261:case 226:case 176:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.propertyName)||l(t,e.dotDotDotToken)||l(t,e.name)||l(t,e.questionToken)||l(t,e.type)||l(t,e.initializer);case 160:case 161:case 155:case 156:case 157:return c(t,n,e.decorators)||c(t,n,e.modifiers)||c(t,n,e.typeParameters)||c(t,n,e.parameters)||l(t,e.type);case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.asteriskToken)||l(t,e.name)||l(t,e.questionToken)||c(t,n,e.typeParameters)||c(t,n,e.parameters)||l(t,e.type)||l(t,e.equalsGreaterThanToken)||l(t,e.body);case 159:return l(t,e.typeName)||c(t,n,e.typeArguments);case 158:return l(t,e.parameterName)||l(t,e.type);case 162:return l(t,e.exprName);case 163:return c(t,n,e.members);case 164:return l(t,e.elementType);case 165:return c(t,n,e.elementTypes);case 166:case 167:case 259:return c(t,n,e.types);case 168:case 170:case 267:case 271:case 270:case 272:case 274:return l(t,e.type);case 171:return l(t,e.objectType)||l(t,e.indexType);case 172:return l(t,e.readonlyToken)||l(t,e.typeParameter)||l(t,e.questionToken)||l(t,e.type);case 173:return l(t,e.literal);case 174:case 175:case 177:case 241:case 245:case 289:return c(t,n,e.elements);case 178:case 254:return c(t,n,e.properties);case 179:return l(t,e.expression)||l(t,e.name);case 180:return l(t,e.expression)||l(t,e.argumentExpression);case 181:case 182:return l(t,e.expression)||c(t,n,e.typeArguments)||c(t,n,e.arguments);case 183:return l(t,e.tag)||l(t,e.template);case 184:return l(t,e.type)||l(t,e.expression);case 192:case 193:return l(t,e.operand);case 197:return l(t,e.asteriskToken)||l(t,e.expression);case 194:return l(t,e.left)||l(t,e.operatorToken)||l(t,e.right);case 202:return l(t,e.expression)||l(t,e.type);case 204:case 236:case 240:return l(t,e.name);case 195:return l(t,e.condition)||l(t,e.questionToken)||l(t,e.whenTrue)||l(t,e.colonToken)||l(t,e.whenFalse);case 207:case 234:case 258:return c(t,n,e.statements);case 265:return c(t,n,e.statements)||l(t,e.endOfFileToken);case 208:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.declarationList);case 227:return c(t,n,e.declarations);case 211:return l(t,e.expression)||l(t,e.thenStatement)||l(t,e.elseStatement);case 212:return l(t,e.statement)||l(t,e.expression);case 213:case 220:return l(t,e.expression)||l(t,e.statement);case 214:return l(t,e.initializer)||l(t,e.condition)||l(t,e.incrementor)||l(t,e.statement);case 215:return l(t,e.initializer)||l(t,e.expression)||l(t,e.statement);case 216:return l(t,e.awaitModifier)||l(t,e.initializer)||l(t,e.expression)||l(t,e.statement);case 217:case 218:return l(t,e.label);case 221:return l(t,e.expression)||l(t,e.caseBlock);case 235:return c(t,n,e.clauses);case 257:return l(t,e.expression)||c(t,n,e.statements);case 222:return l(t,e.label)||l(t,e.statement);case 224:return l(t,e.tryBlock)||l(t,e.catchClause)||l(t,e.finallyBlock);case 260:return l(t,e.variableDeclaration)||l(t,e.block);case 229:case 199:case 230:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||c(t,n,e.typeParameters)||c(t,n,e.heritageClauses)||c(t,n,e.members);case 231:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||c(t,n,e.typeParameters)||l(t,e.type);case 232:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||c(t,n,e.members);case 264:case 253:return l(t,e.name)||l(t,e.initializer);case 233:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||l(t,e.body);case 237:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||l(t,e.moduleReference);case 238:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.importClause)||l(t,e.moduleSpecifier);case 239:return l(t,e.name)||l(t,e.namedBindings);case 244:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.exportClause)||l(t,e.moduleSpecifier);case 242:case 246:return l(t,e.propertyName)||l(t,e.name);case 243:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.expression);case 196:return l(t,e.head)||c(t,n,e.templateSpans);case 205:return l(t,e.expression)||l(t,e.literal);case 201:return l(t,e.expression)||c(t,n,e.typeArguments);case 247:return c(t,n,e.decorators);case 249:return l(t,e.openingElement)||c(t,n,e.children)||l(t,e.closingElement);case 250:case 251:return l(t,e.tagName)||l(t,e.attributes);case 256:return l(t,e.dotDotDotToken)||l(t,e.expression);case 252:return l(t,e.tagName);case 273:return c(t,n,e.parameters)||l(t,e.type);case 275:return c(t,n,e.tags);case 279:case 284:return e.isNameFirst?l(t,e.name)||l(t,e.typeExpression):l(t,e.typeExpression)||l(t,e.name);case 280:case 281:return l(t,e.typeExpression);case 277:return l(t,e.class);case 282:return c(t,n,e.typeParameters);case 283:return e.typeExpression&&267===e.typeExpression.kind?l(t,e.typeExpression)||l(t,e.fullName):l(t,e.fullName)||l(t,e.typeExpression);case 285:if(e.jsDocPropertyTags)for(var i=0,r=e.jsDocPropertyTags;i<r.length;i++){l(t,r[i])}return}}!function(e){e[e.None=0]="None",e[e.Yield=1]="Yield",e[e.Await=2]="Await",e[e.Type=4]="Type",e[e.RequireCompleteParameterList=8]="RequireCompleteParameterList",e[e.IgnoreMissingOpenBrace=16]="IgnoreMissingOpenBrace",e[e.JSDoc=32]="JSDoc"}(t||(t={})),e.createNode=function(t,o,a){return 265===t?new(s||(s=e.objectAllocator.getSourceFileConstructor()))(t,o,a):71===t?new(r||(r=e.objectAllocator.getIdentifierConstructor()))(t,o,a):e.isNodeKind(t)?new(n||(n=e.objectAllocator.getNodeConstructor()))(t,o,a):new(i||(i=e.objectAllocator.getTokenConstructor()))(t,o,a)},e.forEachChild=u,e.createSourceFile=function(t,n,i,r,s,a){void 0===r&&(r=!1),e.performance.mark("beforeParse");var l=o.parseSourceFile(t,n,i,void 0,r,s,a);return e.performance.mark("afterParse"),e.performance.measure("Parse","beforeParse","afterParse"),l},e.parseIsolatedEntityName=function(e,t){return o.parseIsolatedEntityName(e,t)},e.parseJsonText=function(e,t){return o.parseJsonText(e,t)},e.isExternalModule=function(e){return void 0!==e.externalModuleIndicator},e.updateSourceFile=function(e,t,n,i){var r=a.updateSourceFile(e,t,n,i);return r.flags|=524288&e.flags,r},e.parseIsolatedJSDocComment=function(e,t,n){var i=o.JSDocParser.parseIsolatedJSDocComment(e,t,n);return i&&i.jsDoc&&o.fixupParentReferences(i.jsDoc),i},e.parseJSDocTypeExpressionForTests=function(e,t,n){return o.JSDocParser.parseJSDocTypeExpressionForTests(e,t,n)},function(t){var n,i,r,s,o,a,l,c,d,p,h,f,m,g,_,y,b,v=e.createScanner(5,!0),T=10240,k=!1;function x(e){return 4===e||2===e||1===e||6===e?1:0}function E(t,o,c,u,_){n=e.objectAllocator.getNodeConstructor(),i=e.objectAllocator.getTokenConstructor(),r=e.objectAllocator.getIdentifierConstructor(),s=e.objectAllocator.getSourceFileConstructor(),d=t,l=c,a=[],m=0,h=e.createMap(),f=0,p=0,g=1===u||2===u||6===u?65536:0,k=!1,v.setText(d),v.setOnError(z),v.setScriptTarget(o),v.setLanguageVariant(x(u))}function S(){v.setText(""),v.setOnError(void 0),a=void 0,o=void 0,h=void 0,l=void 0,d=void 0}function C(t){var n=e.getJSDocCommentRanges(t,o.text,o.compileOptions);if(n)for(var i=0,r=n;i<r.length;i++){var s=r[i],a=b.parseJSDocComment(t,s.pos,s.end-s.pos,o.compileOptions);a&&(t.jsDoc||(t.jsDoc=[]),t.jsDoc.push(a))}return t}function w(t){var n=t;return void u(t,function t(i){if(i.parent!==n){i.parent=n;var r=n;if(n=i,u(i,t),e.hasJSDocNodes(i))for(var s=0,o=i.jsDoc;s<o.length;s++){var a=o[s];a.parent=i,n=a,u(a,t)}n=r}})}function I(t,n,i,r){var o=new s(265,0,d.length);return p++,o.text=d,o.bindDiagnostics=[],o.languageVersion=n,o.fileName=e.normalizePath(t),o.languageVariant=x(i),o.isDeclarationFile=e.fileExtensionIs(o.fileName,".d.ts"),o.scriptKind=i,o.compileOptions=r,o}function A(e,t){e?g|=t:g&=~t}function N(e){A(e,2048)}function D(e){A(e,4096)}function O(e){A(e,8192)}function R(e){A(e,16384)}function L(e,t){var n=e&g;if(n){A(!1,n);var i=t();return A(!0,n),i}return t()}function P(e,t){var n=e&~g;if(n){A(!0,n);var i=t();return A(!1,n),i}return t()}function M(e){return L(2048,e)}function F(e){return P(8192,e)}function B(e){return P(16384,e)}function $(e){return 0!==(g&e)}function U(){return $(4096)}function V(){return $(2048)}function H(){return $(8192)}function G(){return $(16384)}function j(e,t){var n=v.getTokenPos();K(n,v.getTextPos()-n,e,t)}function K(t,n,i,r){var s=e.lastOrUndefined(a);s&&t===s.start||a.push(e.createFileDiagnostic(o,t,n,i,r)),k=!0}function z(e,t){K(v.getTextPos(),t||0,e)}function W(){return v.getStartPos()}function q(){return c}function J(){return c=v.scan()}function Y(){return c=v.reScanGreaterToken()}function X(){return c=v.scanJsxIdentifier()}function Z(){return c=v.scanJsxToken()}function Q(t,n){var i=c,r=a.length,s=k,o=g,l=n?v.lookAhead(t):v.tryScan(t);return e.Debug.assert(o===g),l&&!n||(c=i,a.length=r,k=s),l}function ee(e){return Q(e,!0)}function te(e){return Q(e,!1)}function ne(){return 71===q()||(116!==q()||!U())&&((121!==q()||!G())&&q()>107)}function ie(t,n,i){return void 0===i&&(i=!0),q()===t?(i&&J(),!0):(n?j(n):j(e.Diagnostics._0_expected,e.tokenToString(t)),!1)}function re(e){return q()===e&&(J(),!0)}function se(e){if(q()===e)return ae()}function oe(e,t,n,i){return se(e)||he(e,t,n,i)}function ae(){var e=ue(q());return J(),pe(e)}function le(){return 25===q()||(18===q()||1===q()||v.hasPrecedingLineBreak())}function ce(){return le()?(25===q()&&J(),!0):ie(25)}function ue(t,s){return p++,s>=0||(s=v.getStartPos()),e.isNodeKind(t)?new n(t,s,s):71===t?new r(t,s,s):new i(t,s,s)}function de(e,t,n){var i=e.length,r=i>=1&&i<=4?e.slice():e;return r.pos=t,r.end=void 0===n?v.getStartPos():n,r}function pe(e,t){return e.end=void 0===t?v.getStartPos():t,g&&(e.flags|=g),k&&(k=!1,e.flags|=32768),e}function he(t,n,i,r){n?K(v.getStartPos(),0,i,r):j(i,r);var s=ue(t,v.getStartPos());return 71===t?s.escapedText="":(e.isLiteralKind(t)||e.isTemplateLiteralKind(t))&&(s.text=""),pe(s)}function fe(e){var t=h.get(e);return void 0===t&&h.set(e,t=e),t}function me(t,n){if(f++,t){var i=ue(71);return 71!==q()&&(i.originalKeywordKind=q()),i.escapedText=e.escapeLeadingUnderscores(fe(v.getTokenValue())),J(),pe(i)}return he(71,1===q(),n||e.Diagnostics.Identifier_expected)}function ge(e){return me(ne(),e)}function _e(t){return me(e.tokenIsIdentifierOrKeyword(q()),t)}function ye(){return e.tokenIsIdentifierOrKeyword(q())||9===q()||8===q()}function be(e){if(9===q()||8===q()){var t=ze();return t.text=fe(t.text),t}return e&&21===q()?function(){var e=ue(144);return ie(21),e.expression=M(Ot),ie(22),pe(e)}():_e()}function ve(){return be(!0)}function Te(e){return q()===e&&te(xe)}function ke(){return J(),!v.hasPrecedingLineBreak()&&Se()}function xe(){return 76===q()?83===J():84===q()?(J(),79===q()?ee(Ce):39!==q()&&118!==q()&&17!==q()&&Se()):79===q()?Ce():115===q()?(J(),Se()):ke()}function Ee(){return e.isModifierKind(q())&&te(xe)}function Se(){return 21===q()||17===q()||39===q()||24===q()||ye()}function Ce(){return J(),75===q()||89===q()||109===q()||117===q()&&ee(xn)||120===q()&&ee(En)}function we(t,n){if(Me(t))return!0;switch(t){case 0:case 1:case 3:return!(25===q()&&n)&&In();case 2:return 73===q()||79===q();case 4:return ee(lt);case 5:return ee(qn)||25===q()&&!n;case 6:return 21===q()||ye();case 12:return 21===q()||39===q()||24===q()||ye();case 17:return ye();case 9:return 21===q()||24===q()||ye();case 7:return 17===q()?ee(Ie):n?ne()&&!De():Nt()&&!De();case 8:return Mn();case 10:return 26===q()||24===q()||Mn();case 18:return ne();case 11:case 15:return 26===q()||24===q()||Dt();case 16:return et();case 19:case 20:return 26===q()||bt();case 21:return si();case 22:return e.tokenIsIdentifierOrKeyword(q());case 13:return e.tokenIsIdentifierOrKeyword(q())||17===q();case 14:return!0}e.Debug.fail("Non-exhaustive case in 'isListElement'.")}function Ie(){if(e.Debug.assert(17===q()),18===J()){var t=J();return 26===t||17===t||85===t||108===t}return!0}function Ae(){return J(),ne()}function Ne(){return J(),e.tokenIsIdentifierOrKeyword(q())}function De(){return(108===q()||85===q())&&ee(Oe)}function Oe(){return J(),Dt()}function Re(e){if(1===q())return!0;switch(e){case 1:case 2:case 4:case 5:case 6:case 12:case 9:case 22:return 18===q();case 3:return 18===q()||73===q()||79===q();case 7:return 17===q()||85===q()||108===q();case 8:return function(){if(le())return!0;if(Gt(q()))return!0;if(36===q())return!0;return!1}();case 18:return 29===q()||19===q()||17===q()||85===q()||108===q();case 11:return 20===q()||25===q();case 15:case 20:case 10:return 22===q();case 16:case 17:return 20===q()||22===q();case 19:return 26!==q();case 21:return 17===q()||18===q();case 13:return 29===q()||41===q();case 14:return 27===q()&&ee(di)}}function Le(e,t){var n=m;m|=1<<e;for(var i=[],r=W();!Re(e);)if(we(e,!1)){var s=Pe(e,t);i.push(s)}else if(Fe(e))break;return m=n,de(i,r)}function Pe(e,t){var n=Me(e);return n?function(e){return v.setTextPos(e.end),J(),e}(n):t()}function Me(t){if(!k&&l){var n=l.currentNode(v.getStartPos());if(!e.nodeIsMissing(n))if(!n.intersectsChange)if(!e.containsParseError(n))if((96256&n.flags)===g&&function(e,t){switch(t){case 5:return function(e){if(e)switch(e.kind){case 152:case 157:case 153:case 154:case 149:case 206:return!0;case 151:var t=e;return!(71===t.name.kind&&123===t.name.originalKeywordKind)}return!1}(e);case 2:return function(e){if(e)switch(e.kind){case 257:case 258:return!0}return!1}(e);case 0:case 1:case 3:return function(e){if(e)switch(e.kind){case 228:case 208:case 207:case 211:case 210:case 223:case 219:case 221:case 218:case 217:case 215:case 216:case 214:case 213:case 220:case 209:case 224:case 222:case 212:case 225:case 238:case 237:case 244:case 243:case 233:case 229:case 230:case 232:case 231:return!0}return!1}(e);case 6:return function(e){return 264===e.kind}(e);case 4:return function(e){if(e)switch(e.kind){case 156:case 150:case 157:case 148:case 155:return!0}return!1}(e);case 8:return function(e){if(226!==e.kind)return!1;var t=e;return void 0===t.initializer}(e);case 16:return function(e){if(146!==e.kind)return!1;var t=e;return void 0===t.initializer}(e);case 17:return!1}return!1}(n,t))return n}}function Fe(t){return j(function(t){switch(t){case 0:case 1:return e.Diagnostics.Declaration_or_statement_expected;case 2:return e.Diagnostics.case_or_default_expected;case 3:return e.Diagnostics.Statement_expected;case 17:case 4:return e.Diagnostics.Property_or_signature_expected;case 5:return e.Diagnostics.Unexpected_token_A_constructor_method_accessor_or_property_was_expected;case 6:return e.Diagnostics.Enum_member_expected;case 7:return e.Diagnostics.Expression_expected;case 8:return e.Diagnostics.Variable_declaration_expected;case 9:return e.Diagnostics.Property_destructuring_pattern_expected;case 10:return e.Diagnostics.Array_element_destructuring_pattern_expected;case 11:return e.Diagnostics.Argument_expression_expected;case 12:return e.Diagnostics.Property_assignment_expected;case 15:return e.Diagnostics.Expression_or_comma_expected;case 16:return e.Diagnostics.Parameter_declaration_expected;case 18:return e.Diagnostics.Type_parameter_declaration_expected;case 19:return e.Diagnostics.Type_argument_expected;case 20:return e.Diagnostics.Type_expected;case 21:return e.Diagnostics.Unexpected_token_expected;case 22:case 13:case 14:return e.Diagnostics.Identifier_expected}}(t)),!!function(){for(var e=0;e<23;e++)if(m&1<<e&&(we(e,!0)||Re(e)))return!0;return!1}()||(J(),!1)}function Be(e,t,n){var i=m;m|=1<<e;for(var r=[],s=W(),o=-1;;)if(we(e,!1)){var a=v.getStartPos();if(r.push(Pe(e,t)),o=v.getTokenPos(),re(26))continue;if(o=-1,Re(e))break;ie(26),n&&25===q()&&!v.hasPrecedingLineBreak()&&J(),a===v.getStartPos()&&J()}else{if(Re(e))break;if(Fe(e))break}m=i;var l=de(r,s);return o>=0&&(l.hasTrailingComma=!0),l}function $e(){return de([],W())}function Ue(e,t,n,i){if(ie(n)){var r=Be(e,t);return ie(i),r}return $e()}function Ve(e,t){for(var n=e?_e(t):ge(t),i=v.getStartPos();re(23);){if(27===q()){n.jsdocDotPos=i;break}i=v.getStartPos(),n=He(n,Ge(e))}return n}function He(e,t){var n=ue(143,e.pos);return n.left=e,n.right=t,pe(n)}function Ge(t){if(v.hasPrecedingLineBreak()&&e.tokenIsIdentifierOrKeyword(q())&&ee(kn))return he(71,!0,e.Diagnostics.Identifier_expected);return t?_e():ge()}function je(){var t,n=ue(196);n.head=(t=We(q()),e.Debug.assert(14===t.kind,"Template head has wrong token kind"),t),e.Debug.assert(14===n.head.kind,"Template head has wrong token kind");var i=[],r=W();do{i.push(Ke())}while(15===e.lastOrUndefined(i).literal.kind);return n.templateSpans=de(i,r),pe(n)}function Ke(){var t,n,i=ue(205);return i.expression=M(Ot),18===q()?(c=v.reScanTemplateToken(),n=We(q()),e.Debug.assert(15===n.kind||16===n.kind,"Template fragment has wrong token kind"),t=n):t=oe(16,!1,e.Diagnostics._0_expected,e.tokenToString(18)),i.literal=t,pe(i)}function ze(){return We(q())}function We(e){var t=ue(e),n=v.getTokenValue();return t.text=n,v.hasExtendedUnicodeEscape()&&(t.hasExtendedUnicodeEscape=!0),v.isUnterminated()&&(t.isUnterminated=!0),8===t.kind&&(t.numericLiteralFlags=v.getNumericLiteralFlags()),J(),pe(t),t}function qe(){var t=ue(159);return t.typeName=Ve(!0,e.Diagnostics.Type_expected),v.hasPrecedingLineBreak()||27!==q()||(t.typeArguments=Ue(19,wt,27,29)),pe(t)}function Je(){var e=ue(146);return 99!==q()&&94!==q()||(e.name=_e(),ie(56)),e.type=wt(),pe(e)}function Ye(e){var t=ue(e);return J(),t.type=yt(),pe(t)}function Xe(){var e=ue(145);return e.name=ge(),re(85)&&(bt()||!Dt()?e.constraint=wt():e.expression=qt()),re(58)&&(e.default=wt()),pe(e)}function Ze(){if(27===q())return Ue(18,Xe,27,29)}function Qe(){if(re(56))return wt()}function et(){return 24===q()||Mn()||e.isModifierKind(q())||57===q()||bt(!0)}function tt(t){var n=ue(146);return 99===q()?(n.name=me(!0),n.type=Qe(),pe(n)):(n.decorators=Jn(),n.modifiers=Yn(),n.dotDotDotToken=se(24),n.name=Fn(),0===e.getFullWidth(n.name)&&!e.hasModifiers(n)&&e.isModifierKind(q())&&J(),n.questionToken=se(55),n.type=Qe(),n.initializer=Rt(!0,t),C(pe(n)))}function nt(t,n,i){32&n||(i.typeParameters=Ze()),i.parameters=function(e){if(ie(19)){var t=U(),n=G();D(!!(1&e)),R(!!(2&e));var i=Be(16,32&e?Je:function(){return tt(!!(8&e))});if(D(t),R(n),!ie(20)&&8&e)return;return i}return 8&e?void 0:$e()}(n),i.type=function(t,n){return function(t,n){if(36===t)return ie(t),!0;if(re(56))return!0;if(n&&36===q())return j(e.Diagnostics._0_expected,e.tokenToString(56)),J(),!0;return!1}(t,n)?function(){var e=ne()&&te(Ct),t=wt();if(e){var n=ue(158,e.pos);return n.parameterName=e,n.type=t,pe(n)}return t}():void 0}(t,!!(4&n))}function it(){re(26)||ce()}function rt(e){var t=ue(e);return 156===e&&ie(94),nt(56,4,t),it(),C(pe(t))}function st(){return 21===q()&&ee(ot)}function ot(){if(J(),24===q()||22===q())return!0;if(e.isModifierKind(q())){if(J(),ne())return!0}else{if(!ne())return!1;J()}return 56===q()||26===q()||55===q()&&(J(),56===q()||26===q()||22===q())}function at(e,t,n){var i=ue(157,e);return i.decorators=t,i.modifiers=n,i.parameters=Ue(16,tt,21,22),i.type=At(),it(),C(pe(i))}function lt(){if(19===q()||27===q())return!0;for(var t;e.isModifierKind(q());)t=!0,J();return 21===q()||(ye()&&(t=!0,J()),!!t&&(19===q()||27===q()||55===q()||56===q()||26===q()||le()))}function ct(){if(19===q()||27===q())return rt(155);if(94===q()&&ee(ut))return rt(156);var e=W(),t=Yn();return st()?at(e,void 0,t):function(e,t){var n=ve(),i=se(55);if(19===q()||27===q()){var r=ue(150,e);return r.modifiers=t,r.name=n,r.questionToken=i,nt(56,4,r),it(),C(pe(r))}var s=ue(148,e);return s.modifiers=t,s.name=n,s.questionToken=i,s.type=At(),58===q()&&(s.initializer=Kn()),it(),C(pe(s))}(e,t)}function ut(){return J(),19===q()||27===q()}function dt(){var e;return ie(17)?(e=Le(4,ct),ie(18)):e=$e(),e}function pt(){return J(),131===q()&&J(),21===q()&&Ae()&&92===J()}function ht(){var e=ue(172);return ie(17),e.readonlyToken=se(131),ie(21),e.typeParameter=function(){var e=ue(145);return e.name=ge(),ie(92),e.constraint=wt(),pe(e)}(),ie(22),e.questionToken=se(55),e.type=At(),ce(),ie(18),pe(e)}function ft(e){var t=ue(e);return 161===e&&ie(94),nt(36,4,t),C(pe(t))}function mt(){var e=ae();return 23===q()?void 0:e}function gt(e){var t,n=ue(173);e&&((t=ue(192)).operator=38,J());var i=101===q()||86===q()?ae():We(q());return e&&(t.operand=i,pe(t),i=t),n.literal=i,pe(n)}function _t(){return 8===J()}function yt(){switch(q()){case 119:case 136:case 133:case 122:case 137:case 139:case 130:case 134:return te(mt)||qe();case 39:return n=ue(268),J(),pe(n);case 55:return function(){var e,t=v.getStartPos();return J(),26===q()||18===q()||20===q()||29===q()||58===q()||49===q()?pe(e=ue(269,t)):((e=ue(270,t)).type=wt(),pe(e))}();case 89:return function(){if(ee(ui)){var e=ue(273);return J(),nt(56,36,e),C(pe(e))}var t=ue(159);return t.typeName=_e(),pe(t)}();case 24:return Ye(274);case 51:return Ye(271);case 13:case 9:case 8:case 101:case 86:return gt();case 38:return ee(_t)?gt(!0):qe();case 105:case 95:return ae();case 99:var e=(t=ue(169),J(),pe(t));return 126!==q()||v.hasPrecedingLineBreak()?e:function(e){J();var t=ue(158,e.pos);return t.parameterName=e,t.type=wt(),pe(t)}(e);case 103:return function(){var e=ue(162);return ie(103),e.exprName=Ve(!0),pe(e)}();case 17:return ee(pt)?ht():function(){var e=ue(163);return e.members=dt(),pe(e)}();case 21:return function(){var e=ue(165);return e.elementTypes=Ue(20,wt,21,22),pe(e)}();case 19:return function(){var e=ue(168);return ie(19),e.type=wt(),ie(20),pe(e)}();default:return qe()}var t,n}function bt(e){switch(q()){case 119:case 136:case 133:case 122:case 137:case 105:case 139:case 95:case 99:case 103:case 130:case 17:case 21:case 27:case 49:case 48:case 94:case 9:case 8:case 101:case 86:case 134:case 39:case 55:case 51:case 24:return!0;case 38:return!e&&ee(_t);case 19:return!e&&ee(vt);default:return ne()}}function vt(){return J(),20===q()||et()||bt()}function Tt(e,t){J();var n=ue(e,t.pos);return n.type=t,pe(n)}function kt(){return 127===q()?(e=127,t=ue(170),ie(e),t.operator=e,t.type=kt(),pe(t)):function(){for(var e=yt();!v.hasPrecedingLineBreak();)switch(q()){case 58:if(!(1048576&g))return e;e=Tt(272,e);break;case 51:e=Tt(271,e);break;case 55:e=Tt(270,e);break;case 21:var t;ie(21),bt()?((t=ue(171,e.pos)).objectType=e,t.indexType=wt(),ie(22),e=pe(t)):((t=ue(164,e.pos)).elementType=e,ie(22),e=pe(t));break;default:return e}return e}();var e,t}function xt(e,t,n){re(n);var i=t();if(q()===n){for(var r=[i];re(n);)r.push(t());var s=ue(e,i.pos);s.types=de(r,i.pos),i=pe(s)}return i}function Et(){return xt(167,kt,48)}function St(){if(J(),20===q()||24===q())return!0;if(function(){if(e.isModifierKind(q())&&Yn(),ne()||99===q())return J(),!0;if(21===q()||17===q()){var t=a.length;return Fn(),t===a.length}return!1}()){if(56===q()||26===q()||55===q()||58===q())return!0;if(20===q()&&(J(),36===q()))return!0}return!1}function Ct(){var e=ge();if(126===q()&&!v.hasPrecedingLineBreak())return J(),e}function wt(){return L(20480,It)}function It(){return 27===q()||19===q()&&ee(St)?ft(160):94===q()?ft(161):xt(166,Et,49)}function At(){return re(56)?wt():void 0}function Nt(){switch(q()){case 99:case 97:case 95:case 101:case 86:case 8:case 9:case 13:case 14:case 19:case 21:case 17:case 89:case 75:case 94:case 41:case 63:case 71:return!0;case 91:return ee(ut);default:return ne()}}function Dt(){if(Nt())return!0;switch(q()){case 37:case 38:case 52:case 51:case 80:case 103:case 105:case 43:case 44:case 27:case 121:case 116:return!0;default:return!!function(){if(V()&&92===q())return!1;return Kt()>0}()||ne()}}function Ot(){var e=H();e&&O(!1);for(var t,n=Lt();t=se(26);)n=zt(n,t,Lt());return e&&O(!0),n}function Rt(t,n){if(58!==q()){if(v.hasPrecedingLineBreak()||t&&17===q()||!Dt())return;if(t&&n){var i=he(71,!0,e.Diagnostics._0_expected,"=");return i.escapedText="= not found",i}}return ie(58),Lt()}function Lt(){if(function(){if(116===q())return!!U()||ee(Sn);return!1}())return t=ue(197),J(),v.hasPrecedingLineBreak()||39!==q()&&!Dt()||(t.asteriskToken=se(39),t.expression=Lt()),pe(t);var t,n=function(){var t=function(){if(19===q()||27===q()||120===q())return ee(Ft);if(36===q())return 1;return 0}();if(0===t)return;var n=1===t?Ut(!0):te(Bt);if(!n)return;var i=e.hasModifier(n,256),r=q();return n.equalsGreaterThanToken=oe(36,!1,e.Diagnostics._0_expected,"=>"),n.body=36===r||17===r?Vt(i):ge(),C(pe(n))}()||function(){if(120===q()&&1===ee($t)){var e=Xn();return Mt(Ht(0),e)}return}();if(n)return n;var i=Ht(0);return 71===i.kind&&36===q()?Mt(i):e.isLeftHandSideExpression(i)&&e.isAssignmentOperator(Y())?zt(i,ae(),Lt()):function(t){var n=se(55);if(!n)return t;var i=ue(195,t.pos);return i.condition=t,i.questionToken=n,i.whenTrue=L(T,Lt),i.colonToken=oe(56,!1,e.Diagnostics._0_expected,e.tokenToString(56)),i.whenFalse=Lt(),pe(i)}(i)}function Pt(){return J(),!v.hasPrecedingLineBreak()&&ne()}function Mt(t,n){var i;e.Debug.assert(36===q(),"parseSimpleArrowFunctionExpression should only have been called if we had a =>"),n?(i=ue(187,n.pos)).modifiers=n:i=ue(187,t.pos);var r=ue(146,t.pos);return r.name=t,pe(r),i.parameters=de([r],r.pos,r.end),i.equalsGreaterThanToken=oe(36,!1,e.Diagnostics._0_expected,"=>"),i.body=Vt(!!n),C(pe(i))}function Ft(){if(120===q()){if(J(),v.hasPrecedingLineBreak())return 0;if(19!==q()&&27!==q())return 0}var t=q(),n=J();if(19===t){if(20===n)switch(J()){case 36:case 56:case 17:return 1;default:return 0}return 21===n||17===n?2:24===n?1:ne()?56===J()?1:2:0}if(e.Debug.assert(27===t),!ne())return 0;if(1===o.languageVariant){var i=ee(function(){var e=J();if(85===e)switch(J()){case 58:case 29:return!1;default:return!0}else if(26===e)return!0;return!1});return i?1:0}return 2}function Bt(){return Ut(!1)}function $t(){if(120===q()){if(J(),v.hasPrecedingLineBreak()||36===q())return 0;var e=Ht(0);if(!v.hasPrecedingLineBreak()&&71===e.kind&&36===q())return 1}return 0}function Ut(t){var n=ue(187);if(n.modifiers=Xn(),nt(56,(e.hasModifier(n,256)?2:0)|(t?0:8),n),n.parameters&&(t||!(36!==q()&&17!==q()||e.find(n.parameters,function(t){return t.initializer&&e.isIdentifier(t.initializer)&&"= not found"===t.initializer.escapedText}))))return n}function Vt(e){return 17===q()?_n(e?2:0):25===q()||89===q()||75===q()||!In()||17!==q()&&89!==q()&&75!==q()&&57!==q()&&Dt()?e?B(Lt):L(16384,Lt):_n(16|(e?2:0))}function Ht(e){return jt(e,qt())}function Gt(e){return 92===e||142===e}function jt(e,t){for(;;){Y();var n=Kt();if(!(40===q()?n>=e:n>e))break;if(92===q()&&V())break;if(118===q()){if(v.hasPrecedingLineBreak())break;J(),t=Wt(t,wt())}else t=zt(t,ae(),Ht(n))}return t}function Kt(){switch(q()){case 54:return 1;case 53:return 2;case 49:return 3;case 50:return 4;case 48:return 5;case 32:case 33:case 34:case 35:return 6;case 27:case 29:case 30:case 31:case 93:case 92:case 118:return 7;case 45:case 46:case 47:return 8;case 37:case 38:return 9;case 39:case 41:case 42:return 10;case 40:return 11}return-1}function zt(e,t,n){var i=ue(194,e.pos);return i.left=e,i.operatorToken=t,i.right=n,pe(i)}function Wt(e,t){var n=ue(202,e.pos);return n.expression=e,n.type=t,pe(n)}function qt(){if(function(){switch(q()){case 37:case 38:case 52:case 51:case 80:case 103:case 105:case 121:return!1;case 27:if(1!==o.languageVariant)return!1;default:return!0}}()){var t=Yt();return 40===q()?jt(Kt(),t):t}var n=q(),i=Jt();if(40===q()){var r=e.skipTrivia(d,i.pos);184===i.kind?K(r,i.end-r,e.Diagnostics.A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses):K(r,i.end-r,e.Diagnostics.An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses,e.tokenToString(n))}return i}function Jt(){switch(q()){case 37:case 38:case 52:case 51:return(e=ue(192)).operator=q(),J(),e.operand=Jt(),pe(e);case 80:return function(){var e=ue(188);return J(),e.expression=Jt(),pe(e)}();case 103:return function(){var e=ue(189);return J(),e.expression=Jt(),pe(e)}();case 105:return function(){var e=ue(190);return J(),e.expression=Jt(),pe(e)}();case 27:return function(){var e=ue(184);return ie(27),e.type=wt(),ie(29),e.expression=Jt(),pe(e)}();case 121:if(121===q()&&(G()||ee(Sn)))return function(){var e=ue(191);return J(),e.expression=Jt(),pe(e)}();default:return Yt()}var e}function Yt(){if(43===q()||44===q())return(t=ue(192)).operator=q(),J(),t.operand=Xt(),pe(t);if(1===o.languageVariant&&27===q()&&ee(Ne))return en(!0);var t,n=Xt();return e.Debug.assert(e.isLeftHandSideExpression(n)),43!==q()&&44!==q()||v.hasPrecedingLineBreak()?n:((t=ue(193,n.pos)).operand=n,t.operator=q(),J(),pe(t))}function Xt(){var t;return 91===q()&&ee(ut)?(o.flags|=524288,t=ae()):t=97===q()?function(){var t=ae();if(19===q()||23===q()||21===q())return t;var n=ue(179,t.pos);return n.expression=t,oe(23,!1,e.Diagnostics.super_must_be_followed_by_an_argument_list_or_member_access),n.name=Ge(!0),pe(n)}():Zt(),function(e){for(;;)if(e=on(e),27!==q()){if(19!==q())return e;(t=ue(181,e.pos)).expression=e,t.arguments=an(),e=pe(t)}else{var t,n=te(ln);if(!n)return e;(t=ue(181,e.pos)).expression=e,t.typeArguments=n,t.arguments=an(),e=pe(t)}}(t)}function Zt(){return on(function(){switch(q()){case 8:case 9:case 13:return ze();case 99:case 97:case 95:case 101:case 86:return ae();case 19:return t=ue(185),ie(19),t.expression=M(Ot),ie(20),C(pe(t));case 21:return function(){var e=ue(177);ie(21),v.hasPrecedingLineBreak()&&(e.multiLine=!0);return e.elements=Be(15,cn),ie(22),pe(e)}();case 17:return hn();case 120:if(!ee(En))break;return fn();case 75:return ei(v.getStartPos(),void 0,void 0,199);case 89:return fn();case 94:return function(){var e=v.getStartPos();if(ie(94),re(23)){var t=ue(204,e);return t.keywordToken=94,t.name=_e(),pe(t)}var n=ue(182,e);n.expression=Zt(),n.typeArguments=te(ln),(n.typeArguments||19===q())&&(n.arguments=an());return pe(n)}();case 41:case 63:if(12===(c=v.reScanSlashToken()))return ze();break;case 14:return je()}var t;return ge(e.Diagnostics.Expression_expected)}())}function Qt(e,t){return e.kind===t.kind&&(71===e.kind?e.escapedText===t.escapedText:99===e.kind||e.name.escapedText===t.name.escapedText&&Qt(e.expression,t.expression))}function en(t){var n,i=function(e){var t=v.getStartPos();ie(27);var n,i=nn(),r=(s=ue(254),s.properties=Le(13,sn),pe(s));var s;29===q()?(n=ue(251,t),Z()):(ie(41),e?ie(29):(ie(29,void 0,!1),Z()),n=ue(250,t));return n.tagName=i,n.attributes=r,pe(n)}(t);if(251===i.kind){var r=ue(249,i.pos);r.openingElement=i,r.children=function(t){var n=[],i=W(),r=m;m|=16384;for(;c=v.reScanJsxToken(),28!==q();){if(1===q()){K(t.pos,t.end-t.pos,e.Diagnostics.JSX_element_0_has_no_corresponding_closing_tag,e.getTextOfNodeFromSourceText(d,t));break}if(7===q())break;var s=tn();s&&n.push(s)}return m=r,de(n,i)}(r.openingElement.tagName),r.closingElement=function(e){var t=ue(252);ie(28),t.tagName=nn(),e?ie(29):(ie(29,void 0,!1),Z());return pe(t)}(t),Qt(r.openingElement.tagName,r.closingElement.tagName)||K(r.closingElement.pos,r.closingElement.end-r.closingElement.pos,e.Diagnostics.Expected_corresponding_JSX_closing_tag_for_0,e.getTextOfNodeFromSourceText(d,r.openingElement.tagName)),n=pe(r)}else e.Debug.assert(250===i.kind),n=i;if(t&&27===q()){var s=te(function(){return en(!0)});if(s){j(e.Diagnostics.JSX_expressions_must_have_one_parent_element);var o=ue(194,n.pos);return o.end=s.end,o.left=n,o.right=s,o.operatorToken=he(26,!1,void 0),o.operatorToken.pos=o.operatorToken.end=o.right.pos,o}}return n}function tn(){switch(q()){case 10:case 11:return(t=ue(10,v.getStartPos())).containsOnlyWhiteSpaces=11===c,c=v.scanJsxToken(),pe(t);case 17:return rn(!1);case 27:return en(!1)}var t;e.Debug.fail("Unknown JSX child kind "+q())}function nn(){X();for(var e=99===q()?ae():_e();re(23);){var t=ue(179,e.pos);t.expression=e,t.name=Ge(!0),e=pe(t)}return e}function rn(e){var t=ue(256);return ie(17),18!==q()&&(t.dotDotDotToken=se(24),t.expression=Lt()),e?ie(18):(ie(18,void 0,!1),Z()),pe(t)}function sn(){if(17===q())return function(){var e=ue(255);return ie(17),ie(24),e.expression=Ot(),ie(18),pe(e)}();X();var e=ue(253);if(e.name=_e(),58===q())if(9===(c=v.scanJsxAttributeValue()))e.initializer=ze();else e.initializer=rn(!0);return pe(e)}function on(e){for(;;){if(se(23)){var t=ue(179,e.pos);t.expression=e,t.name=Ge(!0),e=pe(t)}else if(51!==q()||v.hasPrecedingLineBreak())if(H()||!re(21)){if(13!==q()&&14!==q())return e;var n=ue(183,e.pos);n.tag=e,n.template=13===q()?ze():je(),e=pe(n)}else{var i=ue(180,e.pos);if(i.expression=e,22!==q()&&(i.argumentExpression=M(Ot),9===i.argumentExpression.kind||8===i.argumentExpression.kind)){var r=i.argumentExpression;r.text=fe(r.text)}ie(22),e=pe(i)}else{J();var s=ue(203,e.pos);s.expression=e,e=pe(s)}}}function an(){ie(19);var e=Be(11,un);return ie(20),e}function ln(){if(re(27)){var e=Be(19,wt);if(ie(29))return e&&function(){switch(q()){case 19:case 23:case 20:case 22:case 56:case 25:case 55:case 32:case 34:case 33:case 35:case 53:case 54:case 50:case 48:case 49:case 18:case 1:return!0;default:return!1}}()?e:void 0}}function cn(){return 24===q()?(e=ue(198),ie(24),e.expression=Lt(),pe(e)):26===q()?ue(200):Lt();var e}function un(){return L(T,cn)}function dn(e,t,n){return Te(125)?zn(153,e,t,n):Te(135)?zn(154,e,t,n):void 0}function pn(){var e=v.getStartPos();if(se(24)){var t=ue(263,e);return t.expression=Lt(),C(pe(t))}var n=Jn(),i=Yn(),r=dn(e,n,i);if(r)return r;var s=se(39),o=ne(),a=ve(),l=se(55);if(s||19===q()||27===q())return Gn(e,n,i,s,a,l);if(o&&(26===q()||18===q()||58===q())){var c=ue(262,e);c.name=a,c.questionToken=l;var u=se(58);return u&&(c.equalsToken=u,c.objectAssignmentInitializer=M(Lt)),C(pe(c))}var d=ue(261,e);return d.modifiers=i,d.name=a,d.questionToken=l,ie(56),d.initializer=M(Lt),C(pe(d))}function hn(){var e=ue(178);return ie(17),v.hasPrecedingLineBreak()&&(e.multiLine=!0),e.properties=Be(12,pn,!0),ie(18),pe(e)}function fn(){var t=H();t&&O(!1);var n=ue(186);n.modifiers=Yn(),ie(89),n.asteriskToken=se(39);var i=n.asteriskToken?1:0,r=e.hasModifier(n,256)?2:0;return n.name=i&&r?P(20480,mn):i?function(e){return P(4096,e)}(mn):r?B(mn):mn(),nt(56,i|r,n),n.body=_n(i|r),t&&O(!0),C(pe(n))}function mn(){return ne()?ge():void 0}function gn(e,t){var n=ue(207);return ie(17,t)||e?(v.hasPrecedingLineBreak()&&(n.multiLine=!0),n.statements=Le(1,Nn),ie(18)):n.statements=$e(),pe(n)}function _n(e,t){var n=U();D(!!(1&e));var i=G();R(!!(2&e));var r=H();r&&O(!1);var s=gn(!!(16&e),t);return r&&O(!0),D(n),R(i),s}function yn(){var e=W();ie(88);var t=se(121);ie(19);var n,i=void 0;if(25!==q()&&(i=104===q()||110===q()||76===q()?$n(!0):P(2048,Ot)),t?ie(142):re(142)){var r=ue(216,e);r.awaitModifier=t,r.initializer=i,r.expression=M(Lt),ie(20),n=r}else if(re(92)){var s=ue(215,e);s.initializer=i,s.expression=M(Ot),ie(20),n=s}else{var o=ue(214,e);o.initializer=i,ie(25),25!==q()&&20!==q()&&(o.condition=M(Ot)),ie(25),20!==q()&&(o.incrementor=M(Ot)),ie(20),n=o}return n.statement=Nn(),pe(n)}function bn(e){var t=ue(e);return ie(218===e?72:77),le()||(t.label=ge()),ce(),pe(t)}function vn(){return 73===q()?(e=ue(257),ie(73),e.expression=M(Ot),ie(56),e.statements=Le(3,Nn),pe(e)):function(){var e=ue(258);return ie(79),ie(56),e.statements=Le(3,Nn),pe(e)}();var e}function Tn(){var e=ue(224);return ie(102),e.tryBlock=gn(!1),e.catchClause=74===q()?function(){var e=ue(260);ie(74),re(19)?(e.variableDeclaration=Bn(),ie(20)):e.variableDeclaration=void 0;return e.block=gn(!1),pe(e)}():void 0,e.catchClause&&87!==q()||(ie(87),e.finallyBlock=gn(!1)),pe(e)}function kn(){return J(),e.tokenIsIdentifierOrKeyword(q())&&!v.hasPrecedingLineBreak()}function xn(){return J(),75===q()&&!v.hasPrecedingLineBreak()}function En(){return J(),89===q()&&!v.hasPrecedingLineBreak()}function Sn(){return J(),(e.tokenIsIdentifierOrKeyword(q())||8===q()||9===q())&&!v.hasPrecedingLineBreak()}function Cn(){for(;;)switch(q()){case 104:case 110:case 76:case 89:case 75:case 83:return!0;case 109:case 138:return Pt();case 128:case 129:return On();case 117:case 120:case 124:case 112:case 113:case 114:case 131:if(J(),v.hasPrecedingLineBreak())return!1;continue;case 141:return J(),17===q()||71===q()||84===q();case 91:return J(),9===q()||39===q()||17===q()||e.tokenIsIdentifierOrKeyword(q());case 84:if(J(),58===q()||39===q()||17===q()||79===q()||118===q())return!0;continue;case 115:J();continue;default:return!1}}function wn(){return ee(Cn)}function In(){switch(q()){case 57:case 25:case 17:case 104:case 110:case 89:case 75:case 83:case 90:case 81:case 106:case 88:case 77:case 72:case 96:case 107:case 98:case 100:case 102:case 78:case 74:case 87:case 120:case 124:case 109:case 128:case 129:case 138:case 141:return!0;case 91:return wn()||ee(ut);case 76:case 84:return wn();case 114:case 112:case 113:case 115:case 131:return wn()||!ee(kn);default:return Dt()}}function An(){return J(),ne()||17===q()||21===q()}function Nn(){switch(q()){case 25:return e=ue(209),ie(25),pe(e);case 17:return gn(!1);case 104:return Vn(v.getStartPos(),void 0,void 0);case 110:if(ee(An))return Vn(v.getStartPos(),void 0,void 0);break;case 89:return Hn(v.getStartPos(),void 0,void 0);case 75:return Qn(v.getStartPos(),void 0,void 0);case 90:return function(){var e=ue(211);return ie(90),ie(19),e.expression=M(Ot),ie(20),e.thenStatement=Nn(),e.elseStatement=re(82)?Nn():void 0,pe(e)}();case 81:return function(){var e=ue(212);return ie(81),e.statement=Nn(),ie(106),ie(19),e.expression=M(Ot),ie(20),re(25),pe(e)}();case 106:return function(){var e=ue(213);return ie(106),ie(19),e.expression=M(Ot),ie(20),e.statement=Nn(),pe(e)}();case 88:return yn();case 77:return bn(217);case 72:return bn(218);case 96:return function(){var e=ue(219);return ie(96),le()||(e.expression=M(Ot)),ce(),pe(e)}();case 107:return function(){var e=ue(220);return ie(107),ie(19),e.expression=M(Ot),ie(20),e.statement=Nn(),pe(e)}();case 98:return function(){var e=ue(221);ie(98),ie(19),e.expression=M(Ot),ie(20);var t=ue(235,v.getStartPos());return ie(17),t.clauses=Le(2,vn),ie(18),e.caseBlock=pe(t),pe(e)}();case 100:return function(){var e=ue(223);return ie(100),e.expression=v.hasPrecedingLineBreak()?void 0:M(Ot),ce(),pe(e)}();case 102:case 74:case 87:return Tn();case 78:return function(){var e=ue(225);return ie(78),ce(),pe(e)}();case 57:return Dn();case 120:case 109:case 138:case 128:case 129:case 124:case 76:case 83:case 84:case 91:case 112:case 113:case 114:case 117:case 115:case 131:case 141:if(wn())return Dn()}var e;return function(){var e=v.getStartPos(),t=M(Ot);if(71===t.kind&&re(56)){var n=ue(222,e);return n.label=t,n.statement=Nn(),C(pe(n))}var i=ue(210,e);return i.expression=t,ce(),C(pe(i))}()}function Dn(){var t=W(),n=Jn(),i=Yn();switch(q()){case 104:case 110:case 76:return Vn(t,n,i);case 89:return Hn(t,n,i);case 75:return Qn(t,n,i);case 109:return function(e,t,n){var i=ue(230,e);return i.decorators=t,i.modifiers=n,ie(109),i.name=ge(),i.typeParameters=Ze(),i.heritageClauses=ti(),i.members=dt(),C(pe(i))}(t,n,i);case 138:return function(e,t,n){var i=ue(231,e);return i.decorators=t,i.modifiers=n,ie(138),i.name=ge(),i.typeParameters=Ze(),ie(58),i.type=wt(),ce(),C(pe(i))}(t,n,i);case 83:return function(e,t,n){var i=ue(232,e);i.decorators=t,i.modifiers=n,ie(83),i.name=ge(),ie(17)?(i.members=Be(6,oi),ie(18)):i.members=$e();return C(pe(i))}(t,n,i);case 141:case 128:case 129:return function(e,t,n){var i=0;if(141===q())return ci(e,t,n);if(re(129))i|=16;else if(ie(128),9===q())return ci(e,t,n);return li(e,t,n,i)}(t,n,i);case 91:return function(e,t,n){ie(91);var i,r=v.getStartPos();if(ne()&&(i=ge(),26!==q()&&140!==q()))return function(e,t,n,i){var r=ue(237,e);return r.decorators=t,r.modifiers=n,r.name=i,ie(58),r.moduleReference=function(){return 132===q()&&ee(ui)?function(){var e=ue(248);return ie(132),ie(19),e.expression=pi(),ie(20),pe(e)}():Ve(!1)}(),ce(),C(pe(r))}(e,t,n,i);var s=ue(238,e);s.decorators=t,s.modifiers=n,(i||39===q()||17===q())&&(s.importClause=function(e,t){var n=ue(239,t);e&&(n.name=e);n.name&&!re(26)||(n.namedBindings=39===q()?(i=ue(240),ie(39),ie(118),i.name=ge(),pe(i)):hi(241));var i;return pe(n)}(i,r),ie(140));return s.moduleSpecifier=pi(),ce(),pe(s)}(t,n,i);case 84:switch(J(),q()){case 79:case 58:return function(e,t,n){var i=ue(243,e);i.decorators=t,i.modifiers=n,re(58)?i.isExportEquals=!0:ie(79);return i.expression=Lt(),ce(),pe(i)}(t,n,i);case 118:return function(e,t,n){var i=ue(236,e);return i.decorators=t,i.modifiers=n,ie(118),ie(129),i.name=ge(),ce(),pe(i)}(t,n,i);default:return function(e,t,n){var i=ue(244,e);i.decorators=t,i.modifiers=n,re(39)?(ie(140),i.moduleSpecifier=pi()):(i.exportClause=hi(245),(140===q()||9===q()&&!v.hasPrecedingLineBreak())&&(ie(140),i.moduleSpecifier=pi()));return ce(),pe(i)}(t,n,i)}default:if(n||i){var r=he(247,!0,e.Diagnostics.Declaration_expected);return r.pos=t,r.decorators=n,r.modifiers=i,pe(r)}}}function On(){return J(),!v.hasPrecedingLineBreak()&&(ne()||9===q())}function Rn(e,t){if(17===q()||!le())return _n(e,t);ce()}function Ln(){if(26===q())return ue(200);var e=ue(176);return e.dotDotDotToken=se(24),e.name=Fn(),e.initializer=Rt(!1),pe(e)}function Pn(){var e=ue(176);e.dotDotDotToken=se(24);var t=ne(),n=ve();return t&&56!==q()?e.name=n:(ie(56),e.propertyName=n,e.name=Fn()),e.initializer=Rt(!1),pe(e)}function Mn(){return 17===q()||21===q()||ne()}function Fn(){return 21===q()?(e=ue(175),ie(21),e.elements=Be(10,Ln),ie(22),pe(e)):17===q()?function(){var e=ue(174);return ie(17),e.elements=Be(9,Pn),ie(18),pe(e)}():ge();var e}function Bn(){var e=ue(226);return e.name=Fn(),e.type=At(),Gt(q())||(e.initializer=Kn()),pe(e)}function $n(t){var n=ue(227);switch(q()){case 104:break;case 110:n.flags|=1;break;case 76:n.flags|=2;break;default:e.Debug.fail()}if(J(),142===q()&&ee(Un))n.declarations=$e();else{var i=V();N(t),n.declarations=Be(8,Bn),N(i)}return pe(n)}function Un(){return Ae()&&20===J()}function Vn(e,t,n){var i=ue(208,e);return i.decorators=t,i.modifiers=n,i.declarationList=$n(!1),ce(),C(pe(i))}function Hn(t,n,i){var r=ue(228,t);r.decorators=n,r.modifiers=i,ie(89),r.asteriskToken=se(39),r.name=e.hasModifier(r,512)?mn():ge();var s=r.asteriskToken?1:0,o=e.hasModifier(r,256)?2:0;return nt(56,s|o,r),r.body=Rn(s|o,e.Diagnostics.or_expected),C(pe(r))}function Gn(t,n,i,r,s,o,a){var l=ue(151,t);l.decorators=n,l.modifiers=i,l.asteriskToken=r,l.name=s,l.questionToken=o;var c=r?1:0,u=e.hasModifier(l,256)?2:0;return nt(56,c|u,l),l.body=Rn(c|u,a),C(pe(l))}function jn(t,n,i,r,s){var o=ue(149,t);return o.decorators=n,o.modifiers=i,o.name=r,o.questionToken=s,o.type=At(),o.initializer=e.hasModifier(o,32)?M(Kn):L(6144,Kn),ce(),C(pe(o))}function Kn(){return Rt(!1)}function zn(e,t,n,i){var r=ue(e,t);return r.decorators=n,r.modifiers=i,r.name=ve(),nt(56,0,r),r.body=Rn(0),C(pe(r))}function Wn(e){switch(e){case 114:case 112:case 113:case 115:case 131:return!0;default:return!1}}function qn(){var t;if(57===q())return!0;for(;e.isModifierKind(q());){if(Wn(t=q()))return!0;J()}if(39===q())return!0;if(ye()&&(t=q(),J()),21===q())return!0;if(void 0!==t){if(!e.isKeyword(t)||135===t||125===t)return!0;switch(q()){case 19:case 27:case 56:case 58:case 55:return!0;default:return le()}}return!1}function Jn(){for(var e,t=W();;){var n=W();if(!re(57))break;var i=ue(147,n);i.expression=F(Xt),pe(i),(e||(e=[])).push(i)}return e&&de(e,t)}function Yn(e){for(var t,n=W();;){var i=v.getStartPos(),r=q();if(76===q()&&e){if(!te(ke))break}else if(!Ee())break;var s=pe(ue(r,i));(t||(t=[])).push(s)}return t&&de(t,n)}function Xn(){var e;if(120===q()){var t=v.getStartPos(),n=q();J(),e=de([pe(ue(n,t))],t)}return e}function Zn(){if(25===q()){var t=ue(206);return J(),pe(t)}var n=W(),i=Jn(),r=Yn(!0),s=dn(n,i,r);return s||(123===q()?function(t,n,i){var r=ue(152,t);return r.decorators=n,r.modifiers=i,ie(123),nt(56,0,r),r.body=Rn(0,e.Diagnostics.or_expected),C(pe(r))}(n,i,r):st()?at(n,i,r):e.tokenIsIdentifierOrKeyword(q())||9===q()||8===q()||39===q()||21===q()?function(t,n,i){var r=se(39),s=ve(),o=se(55);return r||19===q()||27===q()?Gn(t,n,i,r,s,o,e.Diagnostics.or_expected):jn(t,n,i,s,o)}(n,i,r):i||r?jn(n,i,r,he(71,!0,e.Diagnostics.Declaration_expected),void 0):void e.Debug.fail("Should not have attempted to parse class member declaration."))}function Qn(e,t,n){return ei(e,t,n,229)}function ei(e,t,n,i){var r=ue(i,e);return r.decorators=t,r.modifiers=n,ie(75),r.name=!ne()||108===q()&&ee(Ne)?void 0:ge(),r.typeParameters=Ze(),r.heritageClauses=ti(),ie(17)?(r.members=Le(5,Zn),ie(18)):r.members=$e(),C(pe(r))}function ti(){if(si())return Le(21,ni)}function ni(){var e=q();if(85===e||108===e){var t=ue(259);return t.token=e,J(),t.types=Be(7,ii),pe(t)}}function ii(){var e=ue(201);return e.expression=Xt(),e.typeArguments=ri(),pe(e)}function ri(){return 27===q()?Ue(19,wt,27,29):void 0}function si(){return 85===q()||108===q()}function oi(){var e=ue(264,v.getStartPos());return e.name=ve(),e.initializer=M(Kn),C(pe(e))}function ai(){var e=ue(234,v.getStartPos());return ie(17)?(e.statements=Le(1,Nn),ie(18)):e.statements=$e(),pe(e)}function li(e,t,n,i){var r=ue(233,e),s=16&i;return r.decorators=t,r.modifiers=n,r.flags|=i,r.name=ge(),r.body=re(23)?li(W(),void 0,void 0,4|s):ai(),C(pe(r))}function ci(e,t,n){var i=ue(233,e);return i.decorators=t,i.modifiers=n,141===q()?(i.name=ge(),i.flags|=512):(i.name=ze(),i.name.text=fe(i.name.text)),17===q()?i.body=ai():ce(),pe(i)}function ui(){return 19===J()}function di(){return 41===J()}function pi(){if(9===q()){var e=ze();return e.text=fe(e.text),e}return Ot()}function hi(e){var t=ue(e);return t.elements=Ue(22,241===e?mi:fi,17,18),pe(t)}function fi(){return gi(246)}function mi(){return gi(242)}function gi(t){var n=ue(t),i=e.isKeyword(q())&&!ne(),r=v.getTokenPos(),s=v.getTextPos(),o=_e();return 118===q()?(n.propertyName=o,ie(118),i=e.isKeyword(q())&&!ne(),r=v.getTokenPos(),s=v.getTextPos(),n.name=_e()):n.name=o,242===t&&i&&K(r,s-r,e.Diagnostics.Identifier_expected),pe(n)}function _i(t){for(var n,i=e.createScanner(t.languageVersion,!1,0,d),r=[],s=[],o=[],l=void 0;;){var c=i.scan();if(2!==c){if(e.isTrivia(c))continue;break}var u={kind:i.getToken(),pos:i.getTokenPos(),end:i.getTextPos()},p=d.substring(u.pos,u.end),h=e.getFileReferenceFromReferencePath(p,u);if(h){var f=h.fileReference;t.hasNoDefaultLib=h.isNoDefaultLib;var m=h.diagnosticMessage;f&&(h.isTypeReferenceDirective?s.push(f):r.push(f)),m&&a.push(e.createFileDiagnostic(t,u.pos,u.end-u.pos,m))}else{var g=/^\/\/\/\s*<amd-module\s+name\s*=\s*('|")(.+?)\1/gim.exec(p);g&&(n&&a.push(e.createFileDiagnostic(t,u.pos,u.end-u.pos,e.Diagnostics.An_AMD_module_cannot_have_multiple_name_assignments)),n=g[2]);if(/^\/\/\/\s*<amd-dependency\s/gim.exec(p)){var _=/\spath\s*=\s*('|")(.+?)\1/gim.exec(p),y=/\sname\s*=\s*('|")(.+?)\1/gim.exec(p);if(_){var b={path:_[2],name:y?y[2]:void 0};o.push(b)}}var v=/^\/\/\/?\s*(@ts-check|@ts-nocheck)\s*$/gim.exec(p);v&&(l={enabled:0===e.compareStrings(v[1],"@ts-check",!0),end:u.end,pos:u.pos})}}t.referencedFiles=r,t.typeReferenceDirectives=s,t.amdDependencies=o,t.moduleName=n,t.checkJsDirective=l}t.parseSourceFile=function(t,n,i,r,s,l,c){E(n,i,r,l=e.ensureScriptKind(t,l));var u=function(t,n,i,r,s){o=I(t,n,r,s),o.flags=g,J(),_i(o),o.statements=Le(0,Nn),e.Debug.assert(1===q()),o.endOfFileToken=C(ae()),function(t){t.externalModuleIndicator=e.forEach(t.statements,function(t){return e.hasModifier(t,1)||237===t.kind&&248===t.moduleReference.kind||238===t.kind||243===t.kind||244===t.kind?t:void 0})}(o),o.nodeCount=p,o.identifierCount=f,o.identifiers=h,o.parseDiagnostics=a,i&&w(o);return o}(t,i,s,l,c);return S(),u},t.parseIsolatedEntityName=function(e,t){E(e,t,void 0,1),J();var n=Ve(!0),i=1===q()&&!a.length;return S(),i?n:void 0},t.parseJsonText=function(t,n){E(n,2,void 0,6);var i=o=I(t,2,6);return J(),1===q()?o.endOfFileToken=ae():17===q()||ee(function(){return 9===q()})?(i.jsonObject=hn(),o.endOfFileToken=oe(1,!1,e.Diagnostics.Unexpected_token)):ie(17),o.parseDiagnostics=a,S(),i},t.fixupParentReferences=w,function(e){e[e.SourceElements=0]="SourceElements",e[e.BlockStatements=1]="BlockStatements",e[e.SwitchClauses=2]="SwitchClauses",e[e.SwitchClauseStatements=3]="SwitchClauseStatements",e[e.TypeMembers=4]="TypeMembers",e[e.ClassMembers=5]="ClassMembers",e[e.EnumMembers=6]="EnumMembers",e[e.HeritageClauseElement=7]="HeritageClauseElement",e[e.VariableDeclarations=8]="VariableDeclarations",e[e.ObjectBindingElements=9]="ObjectBindingElements",e[e.ArrayBindingElements=10]="ArrayBindingElements",e[e.ArgumentExpressions=11]="ArgumentExpressions",e[e.ObjectLiteralMembers=12]="ObjectLiteralMembers",e[e.JsxAttributes=13]="JsxAttributes",e[e.JsxChildren=14]="JsxChildren",e[e.ArrayLiteralMembers=15]="ArrayLiteralMembers",e[e.Parameters=16]="Parameters",e[e.RestProperties=17]="RestProperties",e[e.TypeParameters=18]="TypeParameters",e[e.TypeArguments=19]="TypeArguments",e[e.TupleElementTypes=20]="TupleElementTypes",e[e.HeritageClauses=21]="HeritageClauses",e[e.ImportOrExportSpecifiers=22]="ImportOrExportSpecifiers",e[e.Count=23]="Count"}(_||(_={})),function(e){e[e.False=0]="False",e[e.True=1]="True",e[e.Unknown=2]="Unknown"}(y||(y={})),function(t){function n(e){var t=ue(267,v.getTokenPos());if(ie(17)||!e)return t.type=P(1048576,wt),ie(18),w(t),pe(t)}var i,r;function s(t,i,r){var s=d;t=t||0;var o,a,l,u=void 0===i?s.length:t+i;i=u-t,e.Debug.assert(t>=0),e.Debug.assert(t<=u),e.Debug.assert(u<=s.length);var p,h=[];return r?.emitBlockCommentsAsJsDocs&&function(e,t){return 47==e.charCodeAt(t)&&47==e.charCodeAt(t+1)&&37==e.charCodeAt(t+2)}(s,t)?(v.scanRange(t,i,function(){for(;1!==q()&&4!==q();)h.push(v.getTokenText()),I();f(h),m(h),p=function(){var e=ue(275,t);return e.tags=o&&de(o,a,l),e.comment=h.length?h.join(""):void 0,pe(e,u)}()}),p):function(e,t){return 47===e.charCodeAt(t)&&42===e.charCodeAt(t+1)&&42===e.charCodeAt(t+2)&&42!==e.charCodeAt(t+3)}(s,t)?(v.scanRange(t+3,i-5,function(){var e=!0,n=1,i=void 0,r=t-Math.max(s.lastIndexOf("\n",t),0)+4;function c(e){i||(i=r),h.push(e),r+=e.length}for(I();5===q();)I();for(4===q()&&(n=0,r=0,I());1!==q();){switch(q()){case 57:0===n||1===n?(m(h),_(r),n=0,e=!1,i=void 0,r++):c(v.getTokenText());break;case 4:h.push(v.getTokenText()),n=0,r=0;break;case 39:var d=v.getTokenText();1===n||2===n?(n=2,c(d)):(n=1,r+=d.length);break;case 71:c(v.getTokenText()),n=2;break;case 5:var g=v.getTokenText();2===n?h.push(g):void 0!==i&&r+g.length>i&&h.push(g.slice(i-r-1)),r+=g.length;break;case 1:break;default:n=2,c(v.getTokenText())}e?I():e=!0}f(h),m(h),p=function(){var e=ue(275,t);return e.tags=o&&de(o,a,l),e.comment=h.length?h.join(""):void 0,pe(e,u)}()}),p):p;function f(e){for(;e.length&&("\n"===e[0]||"\r"===e[0]);)e.shift()}function m(e){for(;e.length&&("\n"===e[e.length-1]||"\r"===e[e.length-1]);)e.pop()}function g(){for(;5===q()||4===q();)I()}function _(t){e.Debug.assert(57===q());var n=ue(57,v.getTokenPos());n.end=v.getTextPos(),I();var i=A();if(g(),i){var r;if(i)switch(i.escapedText){case"augments":case"extends":r=function(e,t){var n=ue(277,e.pos);return n.atToken=e,n.tagName=t,n.class=function(){var e=re(17),t=ue(201);t.expression=function(){var e=A(!0);for(;re(23);){var t=ue(179,e.pos);t.expression=e,t.name=A(),e=pe(t)}return e}(),t.typeArguments=ri();var n=pe(t);e&&ie(18);return n}(),pe(n)}(n,i);break;case"class":case"constructor":r=function(e,t){var n=ue(278,e.pos);return n.atToken=e,n.tagName=t,pe(n)}(n,i);break;case"arg":case"argument":case"param":r=x(n,i,1);break;case"return":case"returns":r=function(t,n){e.forEach(o,function(e){return 280===e.kind})&&K(n.pos,v.getTokenPos()-n.pos,e.Diagnostics._0_tag_already_specified,n.escapedText);var i=ue(280,t.pos);return i.atToken=t,i.tagName=n,i.typeExpression=b(),pe(i)}(n,i);break;case"template":r=function(t,n){e.forEach(o,function(e){return 282===e.kind})&&K(n.pos,v.getTokenPos()-n.pos,e.Diagnostics._0_tag_already_specified,n.escapedText);var i=[],r=W();for(;;){var s=A();if(g(),!s)return void K(v.getStartPos(),0,e.Diagnostics.Identifier_expected);var a=ue(145,s.pos);if(a.name=s,pe(a),i.push(a),26!==q())break;I(),g()}var l=ue(282,t.pos);return l.atToken=t,l.tagName=n,l.typeParameters=de(i,r),pe(l),l}(n,i);break;case"type":r=E(n,i);break;case"typedef":r=function(e,t){var n=b();g();var i=ue(283,e.pos);if(i.atToken=e,i.tagName=t,i.fullName=c(0),i.fullName)for(var r=i.fullName;;){if(71===r.kind||!r.body){i.name=71===r.kind?r:r.name;break}r=r.body}if(g(),i.typeExpression=n,!n||k(n.type)){for(var s=void 0,o=void 0,a=void 0,l=v.getStartPos();s=te(function(){return C(0)});)if(o||(o=ue(285,l)),281===s.kind){if(a)break;a=s}else o.jsDocPropertyTags||(o.jsDocPropertyTags=[]),o.jsDocPropertyTags.push(s);o&&(n&&164===n.type.kind&&(o.isArrayType=!0),i.typeExpression=a&&a.typeExpression&&!k(a.typeExpression.type)?a.typeExpression:pe(o))}return pe(i);function c(e){var t=v.getTokenPos(),n=A();if(n&&re(23)){var i=ue(233,t);return i.flags|=e,i.name=n,i.body=c(4),pe(i)}return n&&4&e&&(n.isInJSDocNamespace=!0),n}}(n,i);break;default:r=y(n,i)}else r=y(n,i);r&&function(e,t){e.comment=t.join(""),o?o.push(e):(o=[e],a=e.pos);l=e.end}(r,function(e){var t,n=[],i=0;function r(i){t||(t=e),n.push(i),e+=i.length}for(;57!==q()&&1!==q();){switch(q()){case 4:i>=1&&(i=0,n.push(v.getTokenText())),e=0;break;case 57:break;case 5:if(2===i)r(v.getTokenText());else{var s=v.getTokenText();void 0!==t&&e+s.length>t&&n.push(s.slice(t-e-1)),e+=s.length}break;case 39:if(0===i){i=1,e+=v.getTokenText().length;break}default:i=2,r(v.getTokenText())}if(57===q())break;I()}return f(n),m(n),n}(t+r.end-r.pos))}}function y(e,t){var n=ue(276,e.pos);return n.atToken=e,n.tagName=t,pe(n)}function b(){return g(),17===q()?n():void 0}function T(){var e=re(21),t=function(){var e=A(!0);re(21)&&ie(22);for(;re(23);){var t=A(!0);re(21)&&ie(22),e=He(e,t)}return e}();return e&&(g(),se(58)&&Ot(),ie(22)),{name:t,isBracketed:e}}function k(t){switch(t.kind){case 134:return!0;case 164:return k(t.elementType);default:return e.isTypeReferenceNode(t)&&e.isIdentifier(t.typeName)&&"Object"===t.typeName.escapedText}}function x(e,t,n){var i=b(),r=!i;g();var s=T(),o=s.name,a=s.isBracketed;g(),r&&(i=b());var l=ue(1===n?279:284,e.pos),c=function(e,t){if(e&&k(e.type)){for(var n=ue(267,v.getTokenPos()),i=void 0,r=void 0,s=v.getStartPos(),o=void 0;i=te(function(){return C(1,t)});)o||(o=[]),o.push(i);if(o)return(r=ue(285,s)).jsDocPropertyTags=o,164===e.type.kind&&(r.isArrayType=!0),n.type=pe(r),pe(n)}}(i,o);return c&&(i=c,r=!0),l.atToken=e,l.tagName=t,l.typeExpression=i,l.name=o,l.isNameFirst=r,l.isBracketed=a,pe(l)}function E(t,i){e.forEach(o,function(e){return 281===e.kind})&&K(i.pos,v.getTokenPos()-i.pos,e.Diagnostics._0_tag_already_specified,i.escapedText);var r=ue(281,t.pos);return r.atToken=t,r.tagName=i,r.typeExpression=n(!0),pe(r)}function S(t,n){for(;!e.isIdentifier(t)||!e.isIdentifier(n);){if(e.isIdentifier(t)||e.isIdentifier(n)||t.right.escapedText!==n.right.escapedText)return!1;t=t.left,n=n.left}return t.escapedText===n.escapedText}function C(t,n){for(var i=!0,r=!1;;)switch(I(),q()){case 57:if(i){var s=w(t);return!(s&&279===s.kind&&(e.isIdentifier(s.name)||!S(n,s.name.left)))&&s}r=!1;break;case 4:i=!0,r=!1;break;case 39:r&&(i=!1),r=!0;break;case 71:i=!1;break;case 1:return!1}}function w(t){e.Debug.assert(57===q());var n=ue(57,v.getStartPos());n.end=v.getTextPos(),I();var i=A();if(g(),!i)return!1;switch(i.escapedText){case"type":return 0===t&&E(n,i);case"prop":case"property":return 0===t&&x(n,i,t);case"arg":case"argument":case"param":return 1===t&&x(n,i,t)}return!1}function I(){return c=v.scanJSDocToken()}function A(t){if(void 0===t&&(t=!1),!e.tokenIsIdentifierOrKeyword(q()))return t?he(71,!0,e.Diagnostics.Identifier_expected):void j(e.Diagnostics.Identifier_expected);var n=v.getTokenPos(),i=v.getTextPos(),r=ue(71,n);return r.escapedText=e.escapeLeadingUnderscores(s.substring(n,i)),pe(r,i),I(),r}}t.parseJSDocTypeExpressionForTests=function(e,t,i){E(e,5,void 0,1),o=I("file.js",5,1),v.setText(e,t,i),c=v.scan();var r=n(),s=a;return S(),r?{jsDocTypeExpression:r,diagnostics:s}:void 0},t.parseJSDocTypeExpression=n,t.parseIsolatedJSDocComment=function(e,t,n){E(e,5,void 0,1),o={languageVariant:0,text:e};var i=s(t,n),r=a;return S(),i?{jsDoc:i,diagnostics:r}:void 0},t.parseJSDocComment=function(t,n,i,r){var l,u=c,d=a.length,p=k,h=s(n,i,r);return h&&(h.parent=t),e.isInJavaScriptFile(t)&&(o.jsDocDiagnostics||(o.jsDocDiagnostics=[]),(l=o.jsDocDiagnostics).push.apply(l,a)),c=u,a.length=d,k=p,h},function(e){e[e.BeginningOfLine=0]="BeginningOfLine",e[e.SawAsterisk=1]="SawAsterisk",e[e.SavingComments=2]="SavingComments"}(i||(i={})),function(e){e[e.Property=0]="Property",e[e.Parameter=1]="Parameter"}(r||(r={})),t.parseJSDocCommentWorker=s}(b=t.JSDocParser||(t.JSDocParser={}))}(o||(o={})),function(t){function n(t,n,r,o,a,l){return void(n?d(t):c(t));function c(t){var n="";if(l&&i(t)&&(n=o.substring(t.pos,t.end)),t._children&&(t._children=void 0),t.pos+=r,t.end+=r,l&&i(t)&&e.Debug.assert(n===a.substring(t.pos,t.end)),u(t,c,d),e.hasJSDocNodes(t))for(var p=0,h=t.jsDoc;p<h.length;p++){u(h[p],c,d)}s(t,l)}function d(e){e._children=void 0,e.pos+=r,e.end+=r;for(var t=0,n=e;t<n.length;t++){c(n[t])}}}function i(e){switch(e.kind){case 9:case 8:case 71:return!0}return!1}function r(t,n,i,r,s){e.Debug.assert(t.end>=n,"Adjusting an element that was entirely before the change range"),e.Debug.assert(t.pos<=i,"Adjusting an element that was entirely after the change range"),e.Debug.assert(t.pos<=t.end),t.pos=Math.min(t.pos,r),t.end>=i?t.end+=s:t.end=Math.min(t.end,r),e.Debug.assert(t.pos<=t.end),t.parent&&(e.Debug.assert(t.pos>=t.parent.pos),e.Debug.assert(t.end<=t.parent.end))}function s(t,n){if(n){var i=t.pos;u(t,function(t){e.Debug.assert(t.pos>=i),i=t.end}),e.Debug.assert(i<=t.end)}}function a(t,n){var i,r=t;if(u(t,function t(s){if(e.nodeIsMissing(s))return;if(!(s.pos<=n))return e.Debug.assert(s.pos>n),!0;if(s.pos>=r.pos&&(r=s),n<s.end)return u(s,t),!0;e.Debug.assert(s.end<=n),i=s}),i){var s=function(e){for(;;){var t=o(e);if(!t)return e;e=t}}(i);s.pos>r.pos&&(r=s)}return r;function o(t){var n=void 0;return u(t,function(t){e.nodeIsPresent(t)&&(n=t)}),n}}function l(t,n,i,r){var s=t.text;if(i&&(e.Debug.assert(s.length-i.span.length+i.newLength===n.length),r||e.Debug.shouldAssert(3))){var o=s.substr(0,i.span.start),a=n.substr(0,i.span.start);e.Debug.assert(o===a);var l=s.substring(e.textSpanEnd(i.span),s.length),c=n.substring(e.textSpanEnd(e.textChangeRangeNewSpan(i)),n.length);e.Debug.assert(l===c)}}var c;t.updateSourceFile=function(t,i,c,d){if(l(t,i,c,d=d||e.Debug.shouldAssert(2)),e.textChangeRangeIsUnchanged(c))return t;if(0===t.statements.length)return o.parseSourceFile(t.fileName,i,t.languageVersion,void 0,!0,t.scriptKind);var p=t;e.Debug.assert(!p.hasBeenIncrementallyParsed),p.hasBeenIncrementallyParsed=!0;var h=t.text,f=function(t){var n=t.statements,i=0;e.Debug.assert(i<n.length);var r=n[i],s=-1;return{currentNode:function(t){return t!==s&&(r&&r.end===t&&i<n.length-1&&(i++,r=n[i]),r&&r.pos===t||o(t)),s=t,e.Debug.assert(!r||r.pos===t),r}};function o(e){return n=void 0,i=-1,r=void 0,void u(t,s,o);function s(t){return e>=t.pos&&e<t.end&&(u(t,s,o),!0)}function o(t){if(e>=t.pos&&e<t.end)for(var a=0;a<t.length;a++){var l=t[a];if(l){if(l.pos===e)return n=t,i=a,r=l,!0;if(l.pos<e&&e<l.end)return u(l,s,o),!0}}return!1}}}(t),m=function(t,n){for(var i=1,r=n.span.start,s=0;r>0&&s<=i;s++){var o=a(t,r);e.Debug.assert(o.pos<=r);var l=o.pos;r=Math.max(0,l-1)}var c=e.createTextSpanFromBounds(r,e.textSpanEnd(n.span)),u=n.newLength+(n.span.start-r);return e.createTextChangeRange(c,u)}(t,c);l(t,i,m,d),e.Debug.assert(m.span.start<=c.span.start),e.Debug.assert(e.textSpanEnd(m.span)===e.textSpanEnd(c.span)),e.Debug.assert(e.textSpanEnd(e.textChangeRangeNewSpan(m))===e.textSpanEnd(e.textChangeRangeNewSpan(c)));var g=e.textChangeRangeNewSpan(m).length-m.span.length;return function(t,i,o,a,l,c,d,p){return void h(t);function h(t){if(e.Debug.assert(t.pos<=t.end),t.pos>o)n(t,!1,l,c,d,p);else{var m=t.end;if(m>=i)return t.intersectsChange=!0,t._children=void 0,r(t,i,o,a,l),u(t,h,f),void s(t,p);e.Debug.assert(m<i)}}function f(t){if(e.Debug.assert(t.pos<=t.end),t.pos>o)n(t,!0,l,c,d,p);else{var s=t.end;if(s>=i){t.intersectsChange=!0,t._children=void 0,r(t,i,o,a,l);for(var u=0,f=t;u<f.length;u++){h(f[u])}}else e.Debug.assert(s<i)}}}(p,m.span.start,e.textSpanEnd(m.span),e.textSpanEnd(e.textChangeRangeNewSpan(m)),g,h,i,d),o.parseSourceFile(t.fileName,i,t.languageVersion,f,!0,t.scriptKind)},function(e){e[e.Value=-1]="Value"}(c||(c={}))}(a||(a={}))}(ts||(ts={})),function(e){var t;function n(t){if(230===t.kind||231===t.kind)return 0;if(e.isConstEnumDeclaration(t))return 2;if(238!==t.kind&&237!==t.kind||e.hasModifier(t,1)){if(234===t.kind){var i=0;return e.forEachChild(t,function(e){switch(n(e)){case 0:return!1;case 2:return i=2,!1;case 1:return i=1,!0}}),i}if(233===t.kind){var r=t.body;return r?n(r):1}return 71===t.kind&&t.isInJSDocNamespace?0:1}return 0}!function(e){e[e.NonInstantiated=0]="NonInstantiated",e[e.Instantiated=1]="Instantiated",e[e.ConstEnumOnly=2]="ConstEnumOnly"}(e.ModuleInstanceState||(e.ModuleInstanceState={})),e.getModuleInstanceState=n,function(e){e[e.None=0]="None",e[e.IsContainer=1]="IsContainer",e[e.IsBlockScopedContainer=2]="IsBlockScopedContainer",e[e.IsControlFlowContainer=4]="IsControlFlowContainer",e[e.IsFunctionLike=8]="IsFunctionLike",e[e.IsFunctionExpression=16]="IsFunctionExpression",e[e.HasLocals=32]="HasLocals",e[e.IsInterface=64]="IsInterface",e[e.IsObjectLiteralOrClassExpressionMethod=128]="IsObjectLiteralOrClassExpressionMethod"}(t||(t={}));var i=function(){var t,i,a,l,c,u,d,p,h,f,m,g,_,y,b,v,T,k,x,E,S,C,w=0,I={flags:1},A={flags:1},N=0;function D(n,i,r,s,o){return e.createDiagnosticForNodeInSourceFile(e.getSourceFileOfNode(n)||t,n,i,r,s,o)}return function(n,r){t=n,i=r,a=e.getEmitScriptTarget(i),x=function(e,t){return!(!(void 0===t.alwaysStrict?t.strict:t.alwaysStrict)||e.isDeclarationFile)||!!e.externalModuleIndicator}(t,r),S=e.createUnderscoreEscapedMap(),w=0,C=t.isDeclarationFile,E=e.objectAllocator.getSymbolConstructor(),t.locals||(ve(t),t.symbolCount=w,t.classifiableNames=S),t=void 0,i=void 0,a=void 0,l=void 0,c=void 0,u=void 0,d=void 0,p=!1,h=void 0,f=void 0,m=void 0,g=void 0,_=void 0,y=void 0,v=void 0,T=!1,k=0,N=0};function O(e,t){return w++,new E(e,t)}function R(t,n,i){if(t.flags|=i,n.symbol=t,t.declarations?t.declarations.push(n):t.declarations=[n],1952&i&&!t.exports&&(t.exports=e.createSymbolTable()),6240&i&&!t.members&&(t.members=e.createSymbolTable()),107455&i){var r=t.valueDeclaration;(!r||r.kind!==n.kind&&233===r.kind)&&(t.valueDeclaration=n)}}function L(t){if(243===t.kind)return t.isExportEquals?"export=":"default";var n=e.getNameOfDeclaration(t);if(n){if(e.isAmbientModule(t)){var i=e.getTextOfIdentifierOrLiteral(n);return e.isGlobalScopeAugmentation(t)?"__global":'"'+i+'"'}if(144===n.kind){var r=n.expression;return e.isStringOrNumericLiteral(r)?e.escapeLeadingUnderscores(r.text):(e.Debug.assert(e.isWellKnownSymbolSyntactically(r)),e.getPropertyNameForKnownSymbolName(e.idText(r.name)))}return e.getEscapedTextOfIdentifierOrLiteral(n)}switch(t.kind){case 152:return"__constructor";case 160:case 155:return"__call";case 161:case 156:return"__new";case 157:return"__index";case 244:return"__export";case 194:if(2===e.getSpecialPropertyAssignmentKind(t))return"export=";e.Debug.fail("Unknown binary declaration kind");break;case 228:case 229:return e.hasModifier(t,512)?"default":void 0;case 273:return e.isJSDocConstructSignature(t)?"__new":"__call";case 146:e.Debug.assert(273===t.parent.kind);var s=t.parent;return"arg"+e.indexOf(s.parameters,t);case 283:var o=e.getNameOfJSDocTypedef(t);return void 0!==o?o.escapedText:void 0}}function P(t){return t.name?e.declarationNameToString(t.name):e.unescapeLeadingUnderscores(L(t))}function M(n,i,r,s,o,a){e.Debug.assert(!e.hasDynamicName(r));var l,c=e.hasModifier(r,512),u=c&&i?"default":L(r);if(void 0===u)l=O(0,"__missing");else if(l=n.get(u),788448&s&&S.set(u,!0),l){if(a&&!l.isReplaceableByMethod)return l;if(l.flags&o)if(l.isReplaceableByMethod)n.set(u,l=O(0,u));else{r.name&&(r.name.parent=r);var d=2&l.flags?e.Diagnostics.Cannot_redeclare_block_scoped_variable_0:e.Diagnostics.Duplicate_identifier_0;l.declarations&&l.declarations.length&&(c||l.declarations&&l.declarations.length&&(c||243===r.kind&&!r.isExportEquals))&&(d=e.Diagnostics.A_module_cannot_have_multiple_default_exports),e.forEach(l.declarations,function(n){t.bindDiagnostics.push(D(e.getNameOfDeclaration(n)||n,d,P(n)))}),t.bindDiagnostics.push(D(e.getNameOfDeclaration(r)||r,d,P(r))),l=O(0,u)}}else n.set(u,l=O(0,u)),a&&(l.isReplaceableByMethod=!0);return R(l,r,s),l.parent=i,l}function F(t,n,i){var r=1&e.getCombinedModifierFlags(t);if(2097152&n)return 246===t.kind||237===t.kind&&r?M(c.symbol.exports,c.symbol,t,n,i):M(c.locals,void 0,t,n,i);283===t.kind&&e.Debug.assert(e.isInJavaScriptFile(t));var s=283===t.kind&&t.name&&71===t.name.kind&&t.name.isInJSDocNamespace;if(!e.isAmbientModule(t)&&(r||32&c.flags)||s){var o=107455&n?1048576:0,a=M(c.locals,void 0,t,o,i);return a.exportSymbol=M(c.symbol.exports,c.symbol,t,n,i),t.localSymbol=a,a}return M(c.locals,void 0,t,n,i)}function B(e){if(C)V(e);else if(536870912&e.transformFlags)C=!0,V(e),C=!1,N|=e.transformFlags&~s(e.kind);else{var t=N;N=0,V(e),N=t|r(e,N)}}function $(t){if(void 0!==t)if(C)e.forEach(t,ve);else{var n=N;N=0;for(var i=0,r=0,s=t;r<s.length;r++){var o=s[r];ve(o),i|=-536870913&o.transformFlags}t.transformFlags=536870912|i,N|=n}}function U(t){e.forEachChild(t,ve,$)}function V(r){if(e.hasJSDocNodes(r))if(e.isInJavaScriptFile(r))for(var s=0,a=r.jsDoc;s<a.length;s++){ve(a[s])}else for(var l=0,c=r.jsDoc;l<c.length;l++){o(r,c[l])}if(function(t){if(!(1&h.flags))return!1;if(h===I){if(e.isStatementButNotDeclaration(t)&&209!==t.kind||229===t.kind||233===t.kind&&function(e){var t=n(e);return 1===t||2===t&&i.preserveConstEnums}(t)||232===t.kind&&(!e.isConstEnumDeclaration(t)||i.preserveConstEnums))h=A,!i.allowUnreachableCode&&!e.isInAmbientContext(t)&&(208!==t.kind||3&e.getCombinedNodeFlags(t.declarationList)||e.forEach(t.declarationList.declarations,function(e){return e.initializer}))&&be(t,e.Diagnostics.Unreachable_code_detected)}return!0}(r))U(r);else switch(r.kind){case 213:!function(e){var t=W(),n=z(),i=z();J(t,h),h=t,ne(e.expression,n,i),h=ee(n),ie(e.statement,i,t),J(t,h),h=ee(i)}(r);break;case 212:!function(t){var n=W(),i=222===t.parent.kind?e.lastOrUndefined(v):void 0,r=i?i.continueTarget:z(),s=i?i.breakTarget:z();J(n,h),h=n,ie(t.statement,s,r),J(r,h),h=ee(r),ne(t.expression,n,s),h=ee(s)}(r);break;case 214:!function(e){var t=W(),n=z(),i=z();ve(e.initializer),J(t,h),h=t,ne(e.condition,n,i),h=ee(n),ie(e.statement,i,t),ve(e.incrementor),J(t,h),h=ee(i)}(r);break;case 215:case 216:!function(e){var t=W(),n=z();J(t,h),h=t,216===e.kind&&ve(e.awaitModifier);ve(e.expression),J(n,h),ve(e.initializer),227!==e.initializer.kind&&oe(e.initializer);ie(e.statement,n,t),J(t,h),h=ee(n)}(r);break;case 211:!function(e){var t=z(),n=z(),i=z();ne(e.expression,t,n),h=ee(t),ve(e.thenStatement),J(i,h),h=ee(n),ve(e.elseStatement),J(i,h),h=ee(i)}(r);break;case 219:case 223:!function(e){ve(e.expression),219===e.kind&&(T=!0,g&&J(g,h));h=I}(r);break;case 218:case 217:!function(e){if(ve(e.label),e.label){var t=function(e){if(v)for(var t=0,n=v;t<n.length;t++){var i=n[t];if(i.name===e)return i}return}(e.label.escapedText);t&&(t.referenced=!0,re(e,t.breakTarget,t.continueTarget))}else re(e,f,m)}(r);break;case 224:!function(e){var t=z(),n=h;ve(e.tryBlock),J(t,h);var i=h,r=I;e.catchClause&&(h=n,ve(e.catchClause),J(t,h),r=h);if(e.finallyBlock){var s={flags:2048,antecedent:n,lock:{}};if(J(t,s),h=ee(t),ve(e.finallyBlock),1&h.flags||1&i.flags&&1&r.flags&&(h=i===A||r===A?A:I),!(1&h.flags)){var o={flags:4096,antecedent:h};s.lock=o,h=o}}else h=ee(t)}(r);break;case 221:!function(t){var n=z();ve(t.expression);var i=f,r=b;f=n,b=h,ve(t.caseBlock),J(n,h);var s=e.forEach(t.caseBlock.clauses,function(e){return 258===e.kind});t.possiblyExhaustive=!s&&!n.antecedents,s||J(n,X(b,t,0,0));f=i,b=r,h=ee(n)}(r);break;case 235:!function(t){var n=N;N=0;for(var r=t.clauses,s=I,o=0;o<r.length;o++){for(var a=o;!r[o].statements.length&&o+1<r.length;)ve(r[o]),o++;var l=z();J(l,X(b,t.parent,a,o+1)),J(l,s),h=ee(l);var c=r[o];ve(c),s=h,1&h.flags||o===r.length-1||!i.noFallthroughCasesInSwitch||be(c,e.Diagnostics.Fallthrough_case_in_switch)}r.transformFlags=536870912|N,N|=n}(r);break;case 257:!function(e){var t=h;h=b,ve(e.expression),h=t,$(e.statements)}(r);break;case 222:!function(n){var r=W(),s=z();ve(n.label),J(r,h);var o=function(e,t,n){var i={name:e,breakTarget:t,continueTarget:n,referenced:!1};return(v||(v=[])).push(i),i}(n.label.escapedText,s,r);ve(n.statement),v.pop(),o.referenced||i.allowUnusedLabels||t.bindDiagnostics.push(D(n.label,e.Diagnostics.Unused_label));n.statement&&212===n.statement.kind||(J(s,h),h=ee(s))}(r);break;case 192:!function(e){if(51===e.operator){var t=_;_=y,y=t,U(e),y=_,_=t}else U(e),43!==e.operator&&44!==e.operator||oe(e.operand)}(r);break;case 193:!function(e){U(e),(43===e.operator||44===e.operator)&&oe(e.operand)}(r);break;case 194:!function(t){var n=t.operatorToken.kind;if(53===n||54===n)if(function(e){for(;185===e.parent.kind||192===e.parent.kind&&51===e.parent.operator;)e=e.parent;return!function(e){var t=e.parent;switch(t.kind){case 211:case 213:case 212:return t.expression===e;case 214:case 195:return t.condition===e}return!1}(e)&&!te(e.parent)}(t)){var i=z();ae(t,i,i),h=ee(i)}else ae(t,_,y);else{if(U(t),e.isAssignmentOperator(n)&&!e.isAssignmentTarget(t))if(oe(t.left),58===n&&180===t.left.kind)K(t.left.expression)&&(h=Q(h,t))}}(r);break;case 188:!function(e){U(e),179===e.expression.kind&&oe(e.expression)}(r);break;case 195:!function(e){var t=z(),n=z(),i=z();ne(e.condition,t,n),h=ee(t),ve(e.questionToken),ve(e.whenTrue),J(i,h),h=ee(n),ve(e.colonToken),ve(e.whenFalse),J(i,h),h=ee(i)}(r);break;case 226:!function(t){U(t),(t.initializer||e.isForInOrOfStatement(t.parent.parent))&&le(t)}(r);break;case 181:!function(t){var n=t.expression;for(;185===n.kind;)n=n.expression;186===n.kind||187===n.kind?($(t.typeArguments),$(t.arguments),ve(t.expression)):U(t);if(179===t.expression.kind){var i=t.expression;K(i.expression)&&e.isPushOrUnshiftIdentifier(i.name)&&(h=Q(h,t))}}(r);break;case 275:!function(t){e.forEachChild(t,function(e){283!==e.kind&&ve(e)})}(r);break;case 283:!function(t){e.forEachChild(t,function(e){t.fullName&&e===t.name&&71!==t.fullName.kind||ve(e)})}(r);break;default:U(r)}}function H(e){switch(e.kind){case 71:case 99:case 179:return G(e);case 181:return function(e){if(e.arguments)for(var t=0,n=e.arguments;t<n.length;t++){if(G(n[t]))return!0}if(179===e.expression.kind&&G(e.expression.expression))return!0;return!1}(e);case 185:return H(e.expression);case 194:return function(e){switch(e.operatorToken.kind){case 58:return G(e.left);case 32:case 33:case 34:case 35:return K(e.left)||K(e.right)||j(e.right,e.left)||j(e.left,e.right);case 93:return K(e.left);case 26:return H(e.right)}return!1}(e);case 192:return 51===e.operator&&H(e.operand)}return!1}function G(e){return 71===e.kind||99===e.kind||97===e.kind||179===e.kind&&G(e.expression)}function j(e,t){return 189===e.kind&&K(e.expression)&&9===t.kind}function K(e){switch(e.kind){case 185:return K(e.expression);case 194:switch(e.operatorToken.kind){case 58:return K(e.left);case 26:return K(e.right)}}return G(e)}function z(){return{flags:4,antecedents:void 0}}function W(){return{flags:8,antecedents:void 0}}function q(e){e.flags|=512&e.flags?1024:512}function J(t,n){1&n.flags||e.contains(t.antecedents,n)||((t.antecedents||(t.antecedents=[])).push(n),q(n))}function Y(e,t,n){return 1&t.flags?t:n?101===n.kind&&64&e||86===n.kind&&32&e?I:H(n)?(q(t),{flags:e,expression:n,antecedent:t}):t:32&e?t:I}function X(e,t,n,i){return H(t.expression)?(q(e),{flags:128,switchStatement:t,clauseStart:n,clauseEnd:i,antecedent:e}):e}function Z(e,t){return q(e),{flags:16,antecedent:e,node:t}}function Q(e,t){return q(e),{flags:256,antecedent:e,node:t}}function ee(e){var t=e.antecedents;return t?1===t.length?t[0]:e:I}function te(e){for(;;)if(185===e.kind)e=e.expression;else{if(192!==e.kind||51!==e.operator)return 194===e.kind&&(53===e.operatorToken.kind||54===e.operatorToken.kind);e=e.operand}}function ne(e,t,n){var i=_,r=y;_=t,y=n,ve(e),_=i,y=r,e&&te(e)||(J(t,Y(32,h,e)),J(n,Y(64,h,e)))}function ie(e,t,n){var i=f,r=m;f=t,m=n,ve(e),f=i,m=r}function re(e,t,n){var i=218===e.kind?t:n;i&&(J(i,h),h=I)}function se(e){194===e.kind&&58===e.operatorToken.kind?oe(e.left):oe(e)}function oe(e){if(G(e))h=Z(h,e);else if(177===e.kind)for(var t=0,n=e.elements;t<n.length;t++){var i=n[t];198===i.kind?oe(i.expression):se(i)}else if(178===e.kind)for(var r=0,s=e.properties;r<s.length;r++){var o=s[r];261===o.kind?se(o.initializer):262===o.kind?oe(o.name):263===o.kind&&oe(o.expression)}}function ae(e,t,n){var i={flags:4,antecedents:void 0};53===e.operatorToken.kind?ne(e.left,i,n):ne(e.left,t,i),h=ee(i),ve(e.operatorToken),ne(e.right,t,n)}function le(t){var n=e.isOmittedExpression(t)?void 0:t.name;if(e.isBindingPattern(n))for(var i=0,r=n.elements;i<r.length;i++){le(r[i])}else h=Z(h,t)}function ce(e){d&&(d.nextContainer=e),d=e}function ue(n,i,r){switch(c.kind){case 233:return F(n,i,r);case 265:return function(n,i,r){return e.isExternalModule(t)?F(n,i,r):M(t.locals,void 0,n,i,r)}(n,i,r);case 199:case 229:return function(t,n,i){return e.hasModifier(t,32)?M(c.symbol.exports,c.symbol,t,n,i):M(c.symbol.members,c.symbol,t,n,i)}(n,i,r);case 232:return M(c.symbol.exports,c.symbol,n,i,r);case 163:case 285:case 178:case 230:case 254:return M(c.symbol.members,c.symbol,n,i,r);case 160:case 161:case 155:case 156:case 157:case 151:case 150:case 152:case 153:case 154:case 228:case 186:case 187:case 273:case 231:case 172:return M(c.locals,void 0,n,i,r)}}function de(t){e.isInAmbientContext(t)&&!function(e){var t=265===e.kind?e:e.body;if(t&&(265===t.kind||234===t.kind))for(var n=0,i=t.statements;n<i.length;n++){var r=i[n];if(244===r.kind||243===r.kind)return!0}return!1}(t)?t.flags|=32:t.flags&=-33}function pe(e){var t=n(e),i=0!==t;return ue(e,i?512:1024,i?106639:0),t}function he(e,t,n){var i=O(t,n);8&t&&(i.parent=c.symbol),R(i,e,t)}function fe(t,n,i){switch(u.kind){case 233:F(t,n,i);break;case 265:if(e.isExternalModule(c)){F(t,n,i);break}default:u.locals||(u.locals=e.createSymbolTable(),ce(u)),M(u.locals,void 0,t,n,i)}}function me(n){x&&n.originalKeywordKind>=108&&n.originalKeywordKind<=116&&!e.isIdentifierName(n)&&!e.isInAmbientContext(n)&&(t.parseDiagnostics.length||t.bindDiagnostics.push(D(n,function(n){if(e.getContainingClass(n))return e.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_strict_mode;if(t.externalModuleIndicator)return e.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode;return e.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode}(n),e.declarationNameToString(n))))}function ge(n,i){if(i&&71===i.kind){var r=i;if(o=r,e.isIdentifier(o)&&("eval"===o.escapedText||"arguments"===o.escapedText)){var s=e.getErrorSpanForNode(t,i);t.bindDiagnostics.push(e.createFileDiagnostic(t,s.start,s.length,function(n){if(e.getContainingClass(n))return e.Diagnostics.Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode;if(t.externalModuleIndicator)return e.Diagnostics.Invalid_use_of_0_Modules_are_automatically_in_strict_mode;return e.Diagnostics.Invalid_use_of_0_in_strict_mode}(n),e.idText(r)))}}var o}function _e(e){x&&ge(e,e.name)}function ye(n){if(a<2&&265!==u.kind&&233!==u.kind&&!e.isFunctionLike(u)){var i=e.getErrorSpanForNode(t,n);t.bindDiagnostics.push(e.createFileDiagnostic(t,i.start,i.length,function(n){return e.getContainingClass(n)?e.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_definitions_are_automatically_in_strict_mode:t.externalModuleIndicator?e.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_are_automatically_in_strict_mode:e.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5}(n)))}}function be(n,i,r,s,o){var a=e.getSpanOfTokenAtPosition(t,n.pos);t.bindDiagnostics.push(e.createFileDiagnostic(t,a.start,a.length,i,r,s,o))}function ve(n){if(n){n.parent=l;var i=x;if(e.isInJavaScriptFile(n)&&function(t){if(!e.hasJSDocNodes(t))return;for(var n=0,i=t.jsDoc;n<i.length;n++){var r=i[n];if(r.tags)for(var s=0,o=r.tags;s<o.length;s++){var a=o[s];if(283===a.kind){var c=l;l=r,ve(a),l=c}}}}(n),function(n){switch(n.kind){case 71:if(n.isInJSDocNamespace){for(var i=n.parent;i&&283!==i.kind;)i=i.parent;fe(i,524288,793064);break}case 99:return h&&(e.isExpression(n)||262===l.kind)&&(n.flowNode=h),me(n);case 179:h&&G(n)&&(n.flowNode=h);break;case 194:switch(e.getSpecialPropertyAssignmentKind(n)){case 1:Se(n);break;case 2:!function(n){var i=e.getRightMostAssignedExpression(n.right);if(e.isEmptyObjectLiteral(i)||Ce(i))return void Ee(n);Ee(n),M(t.symbol.exports,t.symbol,n,1049092,0)}(n);break;case 3:!function(e){var t=e.left,n=t.expression,i=n.expression;t.parent=e,i.parent=n,n.parent=t,Ne(i.escapedText,t,!0)}(n);break;case 4:!function(t){e.Debug.assert(e.isInJavaScriptFile(t));var n=e.getThisContainer(t,!1);switch(n.kind){case 228:case 186:n.symbol.members=n.symbol.members||e.createSymbolTable(),M(n.symbol.members,n.symbol,t,4,0);break;case 152:case 149:case 151:case 153:case 154:var i=n.parent;M(e.hasModifier(n,32)?i.symbol.exports:i.symbol.members,i.symbol,t,4,0,!0)}}(n);break;case 5:!function(t){var n=t.left,i=n.expression;e.isIdentifier(i)&&(n.parent=t,i.parent=n,we(i)?Se(t):Ne(i.escapedText,n,!1))}(n);break;case 0:break;default:e.Debug.fail("Unknown special property assignment kind")}return function(t){x&&e.isLeftHandSideExpression(t.left)&&e.isAssignmentOperator(t.operatorToken.kind)&&ge(t,t.left)}(n);case 260:return function(e){x&&e.variableDeclaration&&ge(e,e.variableDeclaration.name)}(n);case 188:return function(n){if(x&&71===n.expression.kind){var i=e.getErrorSpanForNode(t,n.expression);t.bindDiagnostics.push(e.createFileDiagnostic(t,i.start,i.length,e.Diagnostics.delete_cannot_be_called_on_an_identifier_in_strict_mode))}}(n);case 8:return function(n){x&&4&n.numericLiteralFlags&&t.bindDiagnostics.push(D(n,e.Diagnostics.Octal_literals_are_not_allowed_in_strict_mode))}(n);case 193:return function(e){x&&ge(e,e.operand)}(n);case 192:return function(e){x&&(43!==e.operator&&44!==e.operator||ge(e,e.operand))}(n);case 220:return function(t){x&&be(t,e.Diagnostics.with_statements_are_not_allowed_in_strict_mode)}(n);case 169:return void(p=!0);case 158:return function(e){var t=e.parameterName,n=e.type;t&&71===t.kind&&me(t);t&&169===t.kind&&(p=!0);ve(n)}(n);case 145:return ue(n,262144,530920);case 146:return function(t){x&&!e.isInAmbientContext(t)&&ge(t,t.name);e.isBindingPattern(t.name)?he(t,1,"__"+e.indexOf(t.parent.parameters,t)):ue(t,1,107455);if(e.isParameterPropertyDeclaration(t)){var n=t.parent.parent;M(n.symbol.members,n.symbol,t,4|(t.questionToken?16777216:0),0)}}(n);case 226:return De(n);case 176:return n.flowNode=h,De(n);case 149:case 148:return function(e){return Oe(e,4|(e.questionToken?16777216:0),0)}(n);case 261:case 262:return Oe(n,4,0);case 264:return Oe(n,8,900095);case 155:case 156:case 157:return ue(n,131072,0);case 151:case 150:return Oe(n,8192|(n.questionToken?16777216:0),e.isObjectLiteralMethod(n)?0:99263);case 228:return function(n){t.isDeclarationFile||e.isInAmbientContext(n)||e.isAsyncFunction(n)&&(k|=1024);_e(n),x?(ye(n),fe(n,16,106927)):ue(n,16,106927)}(n);case 152:return ue(n,16384,0);case 153:return Oe(n,32768,41919);case 154:return Oe(n,65536,74687);case 160:case 273:case 161:return function(t){var n=O(131072,L(t));R(n,t,131072);var i=O(2048,"__type");R(i,t,2048),i.members=e.createSymbolTable(),i.members.set(n.escapedName,n)}(n);case 163:case 285:case 172:return function(e){return he(e,2048,"__type")}(n);case 178:return function(n){var i;if(function(e){e[e.Property=1]="Property",e[e.Accessor=2]="Accessor"}(i||(i={})),x)for(var r=e.createUnderscoreEscapedMap(),s=0,o=n.properties;s<o.length;s++){var a=o[s];if(263!==a.kind&&71===a.name.kind){var l=a.name,c=261===a.kind||262===a.kind||151===a.kind?1:2,u=r.get(l.escapedText);if(u){if(1===c&&1===u){var d=e.getErrorSpanForNode(t,l);t.bindDiagnostics.push(e.createFileDiagnostic(t,d.start,d.length,e.Diagnostics.An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode))}}else r.set(l.escapedText,c)}}return he(n,4096,"__object")}(n);case 186:case 187:return function(n){t.isDeclarationFile||e.isInAmbientContext(n)||e.isAsyncFunction(n)&&(k|=1024);h&&(n.flowNode=h);_e(n);var i=n.name?n.name.escapedText:"__function";return he(n,16,i)}(n);case 181:e.isInJavaScriptFile(n)&&function(n){!t.commonJsModuleIndicator&&e.isRequireCall(n,!1)&&Ee(n)}(n);break;case 199:case 229:return x=!0,function(n){if(229===n.kind)fe(n,32,899519);else{he(n,32,n.name?n.name.escapedText:"__class"),n.name&&S.set(n.name.escapedText,!0)}var i=n.symbol,r=O(4194308,"prototype"),s=i.exports.get(r.escapedName);s&&(n.name&&(n.name.parent=n),t.bindDiagnostics.push(D(s.declarations[0],e.Diagnostics.Duplicate_identifier_0,e.symbolName(r))));i.exports.set(r.escapedName,r),r.parent=i}(n);case 230:return fe(n,64,792968);case 231:return fe(n,524288,793064);case 232:return function(t){return e.isConst(t)?fe(t,128,899967):fe(t,256,899327)}(n);case 233:return function(n){if(de(n),e.isAmbientModule(n))if(e.hasModifier(n,1)&&be(n,e.Diagnostics.export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always_visible),e.isExternalModuleAugmentation(n))pe(n);else{var i=void 0;if(9===n.name.kind){var r=n.name.text;e.hasZeroOrOneAsteriskCharacter(r)?i=e.tryParsePattern(r):be(n.name,e.Diagnostics.Pattern_0_can_have_at_most_one_Asterisk_character,r)}var s=ue(n,512,106639);i&&(t.patternAmbientModules||(t.patternAmbientModules=[])).push({pattern:i,symbol:s})}else{var o=pe(n);if(0!==o)if(304&n.symbol.flags)n.symbol.constEnumOnlyModule=!1;else{var a=2===o;void 0===n.symbol.constEnumOnlyModule?n.symbol.constEnumOnlyModule=a:n.symbol.constEnumOnlyModule=n.symbol.constEnumOnlyModule&&a}}}(n);case 254:return function(e){return he(e,4096,"__jsxAttributes")}(n);case 253:return function(e,t,n){return ue(e,t,n)}(n,4,0);case 237:case 240:case 242:case 246:return ue(n,2097152,2097152);case 236:return function(n){n.modifiers&&n.modifiers.length&&t.bindDiagnostics.push(D(n,e.Diagnostics.Modifiers_cannot_appear_here));if(265!==n.parent.kind)return void t.bindDiagnostics.push(D(n,e.Diagnostics.Global_module_exports_may_only_appear_at_top_level));var i=n.parent;if(!e.isExternalModule(i))return void t.bindDiagnostics.push(D(n,e.Diagnostics.Global_module_exports_may_only_appear_in_module_files));if(!i.isDeclarationFile)return void t.bindDiagnostics.push(D(n,e.Diagnostics.Global_module_exports_may_only_appear_in_declaration_files));t.symbol.globalExports=t.symbol.globalExports||e.createSymbolTable(),M(t.symbol.globalExports,t.symbol,n,2097152,2097152)}(n);case 239:return function(e){e.name&&ue(e,2097152,2097152)}(n);case 244:return function(e){c.symbol&&c.symbol.exports?e.exportClause||M(c.symbol.exports,c.symbol,e,8388608,0):he(e,8388608,L(e))}(n);case 243:return function(t){if(c.symbol&&c.symbol.exports){var n=243===t.kind&&e.exportAssignmentIsAlias(t)?2097152:4;M(c.symbol.exports,c.symbol,t,n,2097204)}else he(t,2097152,L(t))}(n);case 265:return Te(n.statements),de(t),void(e.isExternalModule(t)&&xe());case 207:if(!e.isFunctionLike(n.parent))return;case 234:return Te(n.statements);case 279:if(285!==n.parent.kind)break;case 284:var r=n;return ue(r,r.isBracketed||r.typeExpression&&272===r.typeExpression.type.kind?16777220:4,0);case 283:var s=n.fullName;if(!s||71===s.kind)fe(n,524288,793064)}}(n),n.kind>142){var s=l;l=n;var o=function(t){switch(t.kind){case 199:case 229:case 232:case 178:case 163:case 285:case 254:return 1;case 230:return 65;case 233:case 231:case 172:return 33;case 265:return 37;case 151:if(e.isObjectLiteralOrClassExpressionMethod(t))return 173;case 152:case 228:case 150:case 153:case 154:case 155:case 273:case 160:case 156:case 157:case 161:return 45;case 186:case 187:return 61;case 234:return 4;case 149:return t.initializer?4:0;case 260:case 214:case 215:case 216:case 235:return 2;case 207:return e.isFunctionLike(t.parent)?0:2}return 0}(n);0===o?B(n):function(t,n){var i=c,r=u;if(1&n?(c=u=t,32&n&&(c.locals=e.createSymbolTable()),ce(c)):2&n&&((u=t).locals=void 0),4&n){var s=h,o=f,a=m,l=g,d=v,_=T,y=16&n&&!e.hasModifier(t,256)&&!!e.getImmediatelyInvokedFunctionExpression(t);y?g={flags:4,antecedents:void 0}:(h={flags:2},144&n&&(h.container=t),g=void 0),f=void 0,m=void 0,v=void 0,T=!1,B(t),t.flags&=-1409,!(1&h.flags)&&8&n&&e.nodeIsPresent(t.body)&&(t.flags|=128,T&&(t.flags|=256)),265===t.kind&&(t.flags|=k),y?(J(g,h),h=ee(g)):h=s,f=o,m=a,g=l,v=d,T=_}else 64&n?(p=!1,B(t),t.flags=p?64|t.flags:-65&t.flags):B(t);c=i,u=r}(n,o),l=s}else C||536870912&n.transformFlags||(N|=r(n,0));x=i}}function Te(t){if(!x)for(var n=0,i=t;n<i.length;n++){var r=i[n];if(!e.isPrologueDirective(r))return;if(ke(r))return void(x=!0)}}function ke(n){var i=e.getTextOfNodeFromSourceText(t.text,n.expression);return'"use strict"'===i||"'use strict'"===i}function xe(){he(t,512,'"'+e.removeFileExtension(t.fileName)+'"')}function Ee(e){t.commonJsModuleIndicator||(t.commonJsModuleIndicator=e,t.externalModuleIndicator||xe())}function Se(e){Ee(e),M(t.symbol.exports,t.symbol,e.left,1048580,0)}function Ce(t){return e.isExportsIdentifier(t)||e.isModuleExportsPropertyAccessExpression(t)||e.isIdentifier(t)&&we(t)}function we(t){var n=Ae(t.escapedText);return n&&n.valueDeclaration&&e.isVariableDeclaration(n.valueDeclaration)&&n.valueDeclaration.initializer&&Ie(n.valueDeclaration.initializer)}function Ie(t){return Ce(t)||e.isAssignmentExpression(t,!0)&&(Ie(t.left)||Ie(t.right))}function Ae(e){return c.symbol&&c.symbol.exports&&c.symbol.exports.get(e)||c.locals&&c.locals.get(e)}function Ne(t,n,i){var r=Ae(t);(r&&e.isDeclarationOfFunctionOrClassExpression(r)&&(r=r.valueDeclaration.initializer.symbol),r&&48&r.flags)&&M(i?r.members||(r.members=e.createSymbolTable()):r.exports||(r.exports=e.createSymbolTable()),r,n,4,0)}function De(t){x&&ge(t,t.name),e.isBindingPattern(t.name)||(e.isBlockOrCatchScoped(t)?function(e){fe(e,2,107455)}(t):e.isParameterDeclaration(t)?ue(t,1,107455):ue(t,1,107454))}function Oe(n,i,r){return t.isDeclarationFile||e.isInAmbientContext(n)||!e.isAsyncFunction(n)||(k|=1024),h&&e.isObjectLiteralOrClassExpressionMethod(n)&&(n.flowNode=h),e.hasDynamicName(n)?he(n,i,"__computed"):ue(n,i,r)}}();function r(t,n){var i=t.kind;switch(i){case 181:return function(e,t){var n=t,i=e.expression,r=i.kind;e.typeArguments&&(n|=3);(524288&t||function(e,t){switch(t){case 97:return!0;case 179:case 180:return 97===e.expression.kind}return!1}(i,r))&&(n|=192);91===i.kind&&(n|=67108864,16384&t&&(n|=32768));return e.transformFlags=536870912|n,-537396546&n}(t,n);case 182:return function(e,t){var n=t;e.typeArguments&&(n|=3);524288&t&&(n|=192);return e.transformFlags=536870912|n,-537396546&n}(t,n);case 233:return function(t,n){var i=3,r=e.getModifierFlags(t);2&r||(i|=n);return t.transformFlags=536870912|i,-574674242&i}(t,n);case 185:return function(e,t){var n=t,i=e.expression,r=i.kind,s=i.transformFlags;202!==r&&184!==r||(n|=3);1024&s&&(n|=1024);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 194:return function(e,t){var n=t,i=e.operatorToken.kind,r=e.left.kind;58===i&&178===r?n|=3272:58===i&&177===r?n|=3264:40!==i&&62!==i||(n|=32);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 210:return function(e,t){var n=t;1024&e.expression.transformFlags&&(n|=192);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 146:return function(t,n){var i=n,r=t.name,s=t.initializer,o=t.dotDotDotToken;(t.questionToken||t.type||4096&n||e.isThisIdentifier(r))&&(i|=3);e.hasModifier(t,92)&&(i|=262147);1048576&n&&(i|=8);(8388608&n||s||o)&&(i|=131264);return t.transformFlags=536870912|i,-536872258&i}(t,n);case 187:return function(t,n){var i=192|n;(e.hasModifier(t,2270)||t.typeParameters||t.type)&&(i|=3);e.hasModifier(t,256)&&(i|=16);1048576&n&&(i|=8);16384&n&&(i|=32768);return t.transformFlags=536870912|i,-601249090&i}(t,n);case 186:return function(t,n){var i=n;(e.hasModifier(t,2270)||t.typeParameters||t.type)&&(i|=3);e.hasModifier(t,256)&&(i|=t.asteriskToken?8:16);1048576&n&&(i|=8);163840&n&&(i|=192);t.asteriskToken&&(i|=768);return t.transformFlags=536870912|i,-601281858&i}(t,n);case 228:return function(t,n){var i,r=e.getModifierFlags(t),s=t.body;!s||2&r?i=3:(i=33554432|n,(2270&r||t.typeParameters||t.type)&&(i|=3),256&r&&(i|=t.asteriskToken?8:16),1048576&n&&(i|=8),163840&n&&(i|=192),t.asteriskToken&&(i|=768));return t.transformFlags=536870912|i,-601281858&i}(t,n);case 226:return function(e,t){var n=t;n|=8388800,1048576&t&&(n|=8);e.type&&(n|=3);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 227:return function(e,t){var n=33554432|t;8388608&t&&(n|=192);3&e.flags&&(n|=4194496);return e.transformFlags=536870912|n,-546309442&n}(t,n);case 208:return function(t,n){var i,r=t.declarationList.transformFlags;e.hasModifier(t,2)?i=3:(i=n,8388608&r&&(i|=192));return t.transformFlags=536870912|i,-536872258&i}(t,n);case 222:return function(t,n){var i=n;4194304&n&&e.isIterationStatement(t,!0)&&(i|=192);return t.transformFlags=536870912|i,-536872258&i}(t,n);case 229:return function(t,n){var i;e.hasModifier(t,2)?i=3:(i=192|n,(274432&n||t.typeParameters)&&(i|=3),65536&n&&(i|=16384));return t.transformFlags=536870912|i,-539358530&i}(t,n);case 199:return function(e,t){var n=192|t;(274432&t||e.typeParameters)&&(n|=3);65536&t&&(n|=16384);return e.transformFlags=536870912|n,-539358530&n}(t,n);case 259:return function(t,n){var i=n;switch(t.token){case 85:i|=192;break;case 108:i|=3;break;default:e.Debug.fail("Unexpected token for heritage clause")}return t.transformFlags=536870912|i,-536872258&i}(t,n);case 260:return function(t,n){var i=n;t.variableDeclaration?e.isBindingPattern(t.variableDeclaration.name)&&(i|=192):i|=8;return t.transformFlags=536870912|i,-537920834&i}(t,n);case 201:return function(e,t){var n=192|t;e.typeArguments&&(n|=3);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 152:return function(t,n){var i=n;!e.hasModifier(t,2270)&&t.body||(i|=3);1048576&n&&(i|=8);return t.transformFlags=536870912|i,-601015618&i}(t,n);case 149:return function(e,t){var n=3|t;e.initializer&&(n|=8192);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 151:return function(t,n){var i=192|n;(t.decorators||e.hasModifier(t,2270)||t.typeParameters||t.type||!t.body)&&(i|=3);1048576&n&&(i|=8);e.hasModifier(t,256)&&(i|=t.asteriskToken?8:16);t.asteriskToken&&(i|=768);return t.transformFlags=536870912|i,-601015618&i}(t,n);case 153:case 154:return function(t,n){var i=n;(t.decorators||e.hasModifier(t,2270)||t.type||!t.body)&&(i|=3);1048576&n&&(i|=8);return t.transformFlags=536870912|i,-601015618&i}(t,n);case 237:return function(t,n){var i=n;e.isExternalModuleImportEqualsDeclaration(t)||(i|=3);return t.transformFlags=536870912|i,-536872258&i}(t,n);case 179:return function(e,t){var n=t,i=e.expression;97===i.kind&&(n|=16384);return e.transformFlags=536870912|n,-536872258&n}(t,n);default:return function(e,t,n){var i=n,r=536872257;switch(t){case 120:case 191:i|=24;break;case 114:case 112:case 113:case 117:case 124:case 76:case 232:case 264:case 184:case 202:case 203:case 131:i|=3;break;case 249:case 250:case 251:case 10:case 252:case 253:case 254:case 255:case 256:i|=4;break;case 13:case 14:case 15:case 16:case 196:case 183:case 262:case 115:case 204:case 97:i|=192;break;case 9:e.hasExtendedUnicodeEscape&&(i|=192);break;case 8:48&e.numericLiteralFlags&&(i|=192);break;case 216:e.awaitModifier&&(i|=8),i|=192;break;case 197:i|=16777416;break;case 119:case 133:case 130:case 134:case 136:case 122:case 137:case 105:case 145:case 148:case 150:case 155:case 156:case 157:case 158:case 159:case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 230:case 231:case 169:case 170:case 171:case 172:case 173:case 236:i=3,r=-3;break;case 144:i|=2097152,16384&n&&(i|=65536);break;case 198:i|=524480;break;case 263:i|=1048584;break;case 99:i|=16384;break;case 174:i|=8388800,524288&n&&(i|=1048584),r=537396545;break;case 175:i|=8388800,r=537396545;break;case 176:i|=192,e.dotDotDotToken&&(i|=524288);break;case 147:i|=4099;break;case 178:r=540087617,2097152&n&&(i|=192),65536&n&&(i|=16384),1048576&n&&(i|=8);break;case 177:case 182:r=537396545,524288&n&&(i|=192);break;case 212:case 213:case 214:case 215:4194304&n&&(i|=192);break;case 265:32768&n&&(i|=192);break;case 219:case 217:case 218:i|=33554432}return e.transformFlags=536870912|i,i&~r}(t,i,n)}}function s(e){if(e>=158&&e<=173)return-3;switch(e){case 181:case 182:case 177:case 174:case 175:return 537396545;case 233:return 574674241;case 146:default:return 536872257;case 187:return 601249089;case 186:case 228:return 601281857;case 227:return 546309441;case 229:case 199:return 539358529;case 152:case 151:case 153:case 154:return 601015617;case 119:case 133:case 130:case 136:case 134:case 122:case 137:case 105:case 145:case 148:case 150:case 155:case 156:case 157:case 230:case 231:return-3;case 178:return 540087617;case 260:return 537920833}}function o(t,n){n.parent=t,e.forEachChild(n,function(e){return o(n,e)})}e.bindSourceFile=function(t,n){e.performance.mark("beforeBind"),i(t,n),e.performance.mark("afterBind"),e.performance.measure("Bind","beforeBind","afterBind")},e.computeTransformFlagsForNode=r,e.getTransformFlagsSubtreeExclusions=s}(ts||(ts={})),function(e){e.createGetSymbolWalker=function(t,n,i,r,s,o,a,l,c){return function(u){void 0===u&&(u=function(){return!0});var d=[],p=[];return{walkType:function(t){try{return h(t),{visitedTypes:e.getOwnValues(d),visitedSymbols:e.getOwnValues(p)}}finally{e.clear(d),e.clear(p)}},walkSymbol:function(t){try{return g(t),{visitedTypes:e.getOwnValues(d),visitedSymbols:e.getOwnValues(p)}}finally{e.clear(d),e.clear(p)}}};function h(t){if(t&&(!d[t.id]&&(d[t.id]=t,!g(t.symbol)))){if(32768&t.flags){var n=t,r=n.objectFlags;4&r&&function(t){h(t.target),e.forEach(t.typeArguments,h)}(t),32&r&&function(e){h(e.typeParameter),h(e.constraintType),h(e.templateType),h(e.modifiersType)}(t),3&r&&(m(s=t),e.forEach(s.typeParameters,h),e.forEach(i(s),h),h(s.thisType)),24&r&&m(n)}var s;16384&t.flags&&function(e){h(l(e))}(t),196608&t.flags&&function(t){e.forEach(t.types,h)}(t),262144&t.flags&&function(e){h(e.type)}(t),524288&t.flags&&function(e){h(e.objectType),h(e.indexType),h(e.constraint)}(t)}}function f(i){i.typePredicate&&h(i.typePredicate.type),e.forEach(i.typeParameters,h);for(var r=0,s=i.parameters;r<s.length;r++){g(s[r])}h(t(i)),h(n(i))}function m(e){h(a(e,0)),h(a(e,1));for(var t=r(e),n=0,i=t.callSignatures;n<i.length;n++){f(i[n])}for(var s=0,o=t.constructSignatures;s<o.length;s++){f(o[s])}for(var l=0,c=t.properties;l<c.length;l++){g(c[l])}}function g(t){if(t){var n=e.getSymbolId(t);if(!p[n]){if(p[n]=t,!u(t))return!0;h(s(t)),1952&t.flags&&t.exports.forEach(g),e.forEach(t.declarations,function(e){if(e.type&&162===e.type.kind){var t=e.type;g(o(c(t.exprName)))}})}}}}}}(ts||(ts={})),function(e){function t(t){t.trace(e.formatMessage.apply(void 0,arguments))}function n(e,t){return e.traceResolution&&void 0!==t.trace}function i(e,t){return t&&{path:t.path,extension:t.ext,packageId:e}}function r(e){return i(void 0,e)}var s;function o(t){if(t)return e.Debug.assert(e.extensionIsTypeScript(t.extension)),{fileName:t.path,packageId:t.packageId}}function a(e,t,n){return{resolvedModule:e&&{resolvedFileName:e.path,extension:e.extension,isExternalLibraryImport:t,packageId:e.packageId},failedLookupLocations:n}}function l(e,t){try{var n=t.readFile(e);return n?JSON.parse(n):{}}catch(e){return{}}}function c(t,n){return t.typeRoots?t.typeRoots:(t.configFilePath?i=e.getDirectoryPath(t.configFilePath):n.getCurrentDirectory&&(i=n.getCurrentDirectory()),void 0!==i?function(t,n){if(!n.directoryExists)return[e.combinePaths(t,u)];var i;return e.forEachAncestorDirectory(e.normalizePath(t),function(t){var r=e.combinePaths(t,u);n.directoryExists(r)&&(i||(i=[])).push(r)}),i}(i,n):void 0);var i}e.trace=t,e.isTraceEnabled=n,function(e){e[e.TypeScript=0]="TypeScript",e[e.JavaScript=1]="JavaScript",e[e.DtsOnly=2]="DtsOnly"}(s||(s={})),e.getEffectiveTypeRoots=c;var u=e.combinePaths("node_modules","@types");function d(n,i,s,o,a,l){return e.isExternalModuleNameRelative(i)?function(n,i,r,s,o,a){if(!a.compilerOptions.rootDirs)return;a.traceEnabled&&t(a.host,e.Diagnostics.rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0,i);for(var l,c,u=e.normalizePath(e.combinePaths(r,i)),d=0,p=a.compilerOptions.rootDirs;d<p.length;d++){var h=p[d],f=e.normalizePath(h);e.endsWith(f,e.directorySeparator)||(f+=e.directorySeparator);var m=e.startsWith(u,f)&&(void 0===c||c.length<f.length);a.traceEnabled&&t(a.host,e.Diagnostics.Checking_if_0_is_the_longest_matching_prefix_for_1_2,f,u,m),m&&(c=f,l=h)}if(c){a.traceEnabled&&t(a.host,e.Diagnostics.Longest_matching_prefix_for_0_is_1,u,c);var _=u.substr(c.length);a.traceEnabled&&t(a.host,e.Diagnostics.Loading_0_from_the_root_dir_1_candidate_location_2,_,c,u);var y=s(n,u,o,!g(r,a.host),a);if(y)return y;a.traceEnabled&&t(a.host,e.Diagnostics.Trying_other_entries_in_rootDirs);for(var b=0,v=a.compilerOptions.rootDirs;b<v.length;b++){if((h=v[b])!==l){var T=e.combinePaths(e.normalizePath(h),_);a.traceEnabled&&t(a.host,e.Diagnostics.Loading_0_from_the_root_dir_1_candidate_location_2,_,h,T);var k=s(n,T,o,!g(e.getDirectoryPath(T),a.host),a);if(k)return k}}a.traceEnabled&&t(a.host,e.Diagnostics.Module_resolution_using_rootDirs_has_failed)}return}(n,i,s,o,a,l):function(n,i,s,o,a){if(!a.compilerOptions.baseUrl)return;a.traceEnabled&&t(a.host,e.Diagnostics.baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1,a.compilerOptions.baseUrl,i);var l=void 0;a.compilerOptions.paths&&(a.traceEnabled&&t(a.host,e.Diagnostics.paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0,i),l=e.matchPatternOrExact(e.getOwnKeys(a.compilerOptions.paths),i));if(l){var c=e.isString(l)?void 0:e.matchedText(l,i),u=e.isString(l)?l:e.patternText(l);return a.traceEnabled&&t(a.host,e.Diagnostics.Module_name_0_matched_pattern_1,i,u),e.forEach(a.compilerOptions.paths[u],function(i){var l=c?i.replace("*",c):i,u=e.normalizePath(e.combinePaths(a.compilerOptions.baseUrl,l));a.traceEnabled&&t(a.host,e.Diagnostics.Trying_substitution_0_candidate_module_location_Colon_1,i,l);var d=e.tryGetExtensionFromPath(u);if(void 0!==d){var p=v(u,o,!1,a);if(void 0!==p)return r({path:p,ext:d})}return s(n,u,o,!g(e.getDirectoryPath(u),a.host),a)})}var d=e.normalizePath(e.combinePaths(a.compilerOptions.baseUrl,i));return a.traceEnabled&&t(a.host,e.Diagnostics.Resolving_module_name_0_relative_to_base_url_1_2,i,a.compilerOptions.baseUrl,d),s(n,d,o,!g(e.getDirectoryPath(d),a.host),a)}(n,i,o,a,l)}function p(t,n,i,r,s){return h(t,e.getDirectoryPath(n),i,r,s,!1)}function h(i,r,o,l,c,u){var p=n(o,l),h=[],g={compilerOptions:o,host:l,traceEnabled:p},_=u?b(s.JavaScript):b(s.TypeScript)||b(s.JavaScript);if(_&&_.value){var y=_.value;return a(y.resolved,y.isExternalLibraryImport,h)}return{resolvedModule:void 0,failedLookupLocations:h};function b(n){var a=d(n,i,r,function(e,t,n,i,r){return m(e,t,n,i,r,!0)},h,g);if(a)return L({resolved:a,isExternalLibraryImport:!1});if(e.isExternalModuleNameRelative(i)){var u=e.normalizePathAndParts(e.combinePaths(r,i)),_=u.path,y=u.parts,b=m(n,_,h,!1,g,!0);return b&&L({resolved:b,isExternalLibraryImport:e.contains(y,"node_modules")})}p&&t(l,e.Diagnostics.Loading_module_0_from_node_modules_folder_target_file_type_1,i,s[n]);var v=w(n,i,r,h,g,c);if(v){var T=v.value;return o.preserveSymlinks||(T=T&&__assign({},v.value,{path:f(v.value.path,l,p),extension:v.value.extension})),{value:T&&{resolved:T,isExternalLibraryImport:!0}}}}}function f(n,i,r){if(!i.realpath)return n;var s=e.normalizePath(i.realpath(n));return r&&t(i,e.Diagnostics.Resolving_real_path_for_0_result_1,n,s),s}function m(n,i,o,a,l,c){if(l.traceEnabled&&t(l.host,e.Diagnostics.Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1,i,s[n]),!e.pathEndsWithDirectorySeparator(i)){if(!a){var u=e.getDirectoryPath(i);g(u,l.host)||(l.traceEnabled&&t(l.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,u),a=!0)}var d=y(n,i,o,a,l);if(d)return r(d)}a||(g(i,l.host)||(l.traceEnabled&&t(l.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,i),a=!0));return T(n,i,o,a,l,c)}function g(e,t){return!t.directoryExists||t.directoryExists(e)}function _(e,t,n,i,s){return r(y(e,t,n,i,s))}function y(n,i,r,s,o){var a=b(i,n,r,s,o);if(a)return a;if(e.hasJavaScriptFileExtension(i)){var l=e.removeFileExtension(i);if(o.traceEnabled){var c=i.substring(l.length);t(o.host,e.Diagnostics.File_name_0_has_a_1_extension_stripping_it,i,c)}return b(l,n,r,s,o)}}function b(t,n,i,r,o){if(!r){var a=e.getDirectoryPath(t);a&&(r=!g(a,o.host))}switch(n){case s.DtsOnly:return l(".d.ts");case s.TypeScript:return l(".ts")||l(".tsx")||l(".d.ts");case s.JavaScript:return l(".js")||l(".jsx")}function l(e){var n=v(t+e,i,r,o);return n&&{path:n,ext:e}}}function v(n,i,r,s){if(!r){if(s.host.fileExists(n))return s.traceEnabled&&t(s.host,e.Diagnostics.File_0_exist_use_it_as_a_name_resolution_result,n),n;s.traceEnabled&&t(s.host,e.Diagnostics.File_0_does_not_exist,n)}i.push(n)}function T(e,t,n,r,s,o){void 0===o&&(o=!0);var a=o?x(t,"",n,r,s):{packageJsonContent:void 0,packageId:void 0},l=a.packageJsonContent;return i(a.packageId,k(e,t,n,r,s,l))}function k(n,i,r,o,a,l){var c=l&&function(n,i,r,o,a){var l=function(n,i,r,s){return n?o("typings")||o("types"):o("main");function o(n){if(e.hasProperty(i,n)){var o=i[n];if(e.isString(o)){var a=e.normalizePath(e.combinePaths(r,o));return s.traceEnabled&&t(s.host,e.Diagnostics.package_json_has_0_field_1_that_references_2,n,o,a),a}s.traceEnabled&&t(s.host,e.Diagnostics.Expected_type_of_0_field_in_package_json_to_be_string_got_1,n,typeof o)}else s.traceEnabled&&t(s.host,e.Diagnostics.package_json_does_not_have_a_0_field,n)}}(i!==s.JavaScript,n,r,a);if(!l)return;var c=!g(e.getDirectoryPath(l),a.host),u=v(l,o,c,a);if(u){var d=u&&function(t,n){var i=e.tryGetExtensionFromPath(n);return void 0!==i&&function(e,t){switch(e){case s.JavaScript:return".js"===t||".jsx"===t;case s.TypeScript:return".ts"===t||".tsx"===t||".d.ts"===t;case s.DtsOnly:return".d.ts"===t}}(t,i)?{path:n,ext:i}:void 0}(i,u);if(d)return d;a.traceEnabled&&t(a.host,e.Diagnostics.File_0_has_an_unsupported_extension_so_skipping_it,u)}var p=i===s.DtsOnly?s.TypeScript:i,h=m(p,l,o,c,a,!1);if(h)return e.Debug.assert(void 0===h.packageId),{path:h.path,ext:h.extension}}(l,n,i,r,a);if(c)return c;var u=!o&&g(i,a.host);return y(n,e.combinePaths(i,"index"),r,!u,a)}function x(n,i,r,s,o){var a=o.host,c=o.traceEnabled,u=!s&&g(n,a),d=E(n);if(u&&a.fileExists(d)){c&&t(a,e.Diagnostics.Found_package_json_at_0,d);var p=l(d,a);return{found:!0,packageJsonContent:p,packageId:"string"==typeof p.name&&"string"==typeof p.version?{name:p.name,subModuleName:i,version:p.version}:void 0}}return u&&c&&t(a,e.Diagnostics.File_0_does_not_exist,d),r.push(d),{found:!1,packageJsonContent:void 0,packageId:void 0}}function E(t){return e.combinePaths(t,"package.json")}function S(t,n,r,s,o,a){var l,c,u=e.normalizePath(e.combinePaths(r,n)),d=x(u,"",o,!s,a);if(d.found)l=d.packageJsonContent,c=d.packageId;else{var p=C(n),h=p.packageName,f=p.rest;if(""!==f)c=x(e.combinePaths(r,h),f,o,!s,a).packageId}return i(c,y(t,u,o,!s,a)||k(t,u,o,!s,a,l))}function C(t){var n=t.indexOf(e.directorySeparator);return"@"===t[0]&&(n=t.indexOf(e.directorySeparator,n+1)),-1===n?{packageName:t,rest:""}:{packageName:t.slice(0,n),rest:t.slice(n+1)}}function w(e,t,n,i,r,s){return I(e,t,n,i,r,!1,s)}function I(t,n,i,r,s,o,a){var l=a&&a.getOrCreateCacheForModuleName(n);return e.forEachAncestorDirectory(e.normalizeSlashes(i),function(i){if("node_modules"!==e.getBaseFileName(i)){var a=O(l,n,i,s.traceEnabled,s.host);return a||L(A(t,n,i,r,s,o))}})}function A(n,i,r,o,a,l){void 0===l&&(l=!1);var c=e.combinePaths(r,"node_modules"),u=g(c,a.host);!u&&a.traceEnabled&&t(a.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,c);var d=l?void 0:S(n,i,c,u,o,a);if(d)return d;if(n!==s.JavaScript){var p=e.combinePaths(c,"@types"),h=u;return u&&!g(p,a.host)&&(a.traceEnabled&&t(a.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,p),h=!1),S(s.DtsOnly,function(n,i){var r=D(n);i.traceEnabled&&r!==n&&t(i.host,e.Diagnostics.Scoped_package_detected_looking_in_0,r);return r}(i,a),p,h,o,a)}}e.resolveTypeReferenceDirective=function(i,r,a,l){var u=n(a,l),d={compilerOptions:a,host:l,traceEnabled:u},p=c(a,l);u&&(void 0===r?void 0===p?t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set,i):t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1,i,p):void 0===p?t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set,i,r):t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_1_root_directory_2,i,r,p));var h,m=[],_=function(){if(p&&p.length)return u&&t(l,e.Diagnostics.Resolving_with_primary_search_path_0,p.join(", ")),e.forEach(p,function(n){var r=e.combinePaths(n,i),a=e.getDirectoryPath(r),c=g(a,l);return!c&&u&&t(l,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,a),o(T(s.DtsOnly,r,m,!c,d))});u&&t(l,e.Diagnostics.Root_directory_cannot_be_determined_skipping_primary_search_paths)}(),y=!0;return _||(_=function(){var n,a=r&&e.getDirectoryPath(r);if(void 0!==a){u&&t(l,e.Diagnostics.Looking_up_in_node_modules_folder_initial_location_0,a);var c=w(s.DtsOnly,i,a,m,d,void 0);return!(n=o(c&&c.value))&&u&&t(l,e.Diagnostics.Type_reference_directive_0_was_not_resolved,i),n}u&&t(l,e.Diagnostics.Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_modules_folder)}(),y=!1),_&&(a.preserveSymlinks||(_=__assign({},_,{fileName:f(_.fileName,l,u)})),u&&t(l,e.Diagnostics.Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2,i,_.fileName,y),h={primary:y,resolvedFileName:_.fileName,packageId:_.packageId}),{resolvedTypeReferenceDirective:h,failedLookupLocations:m}},e.getAutomaticTypeDirectiveNames=function(t,n){if(t.types)return t.types;var i=[];if(n.directoryExists&&n.getDirectories){var r=c(t,n);if(r)for(var s=0,o=r;s<o.length;s++){var a=o[s];if(n.directoryExists(a))for(var u=0,d=n.getDirectories(a);u<d.length;u++){var p=d[u],h=e.normalizePath(p),f=E(e.combinePaths(a,h));n.fileExists(f)&&null===l(f,n).typings||i.push(e.getBaseFileName(h))}}}return i},e.createModuleResolutionCache=function(t,n){var i=e.createMap(),r=e.createMap();return{getOrCreateCacheForDirectory:function(r){var s=e.toPath(r,t,n),o=i.get(s);o||(o=e.createMap(),i.set(s,o));return o},getOrCreateCacheForModuleName:function(i){if(e.isExternalModuleNameRelative(i))return;var s=r.get(i);s||(s=function(){var i=e.createMap();return{get:r,set:s};function r(r){return i.get(e.toPath(r,t,n))}function s(r,s){var a=e.toPath(r,t,n);if(!i.has(a)){i.set(a,s);for(var l=o(a,s.resolvedModule&&s.resolvedModule.resolvedFileName),c=a;;){var u=e.getDirectoryPath(c);if(u===c||i.has(u))break;if(i.set(u,s),(c=u)===l)break}}}function o(i,r){if(void 0!==r){for(var s=e.toPath(e.getDirectoryPath(r),t,n),o=0;o<Math.min(i.length,s.length)&&i.charCodeAt(o)===s.charCodeAt(o);)o++;var a=i.lastIndexOf(e.directorySeparator,o);if(!(a<0))return i.substr(0,a)}}}(),r.set(i,s));return s}}},e.resolveModuleName=function(i,r,s,o,a){var l=n(s,o);l&&t(o,e.Diagnostics.Resolving_module_0_from_1,i,r);var c=e.getDirectoryPath(r),u=a&&a.getOrCreateCacheForDirectory(c),d=u&&u.get(i);if(d)l&&t(o,e.Diagnostics.Resolution_for_module_0_was_found_in_cache,i);else{var h=s.moduleResolution;switch(void 0===h?(h=e.getEmitModuleKind(s)===e.ModuleKind.CommonJS?e.ModuleResolutionKind.NodeJs:e.ModuleResolutionKind.Classic,l&&t(o,e.Diagnostics.Module_resolution_kind_is_not_specified_using_0,e.ModuleResolutionKind[h])):l&&t(o,e.Diagnostics.Explicitly_specified_module_resolution_kind_Colon_0,e.ModuleResolutionKind[h]),h){case e.ModuleResolutionKind.NodeJs:d=p(i,r,s,o,a);break;case e.ModuleResolutionKind.Classic:d=R(i,r,s,o,a);break;default:e.Debug.fail("Unexpected moduleResolution: "+h)}if(u){u.set(i,d);var f=a.getOrCreateCacheForModuleName(i);f&&f.set(c,d)}}return l&&(d.resolvedModule?t(o,e.Diagnostics.Module_name_0_was_successfully_resolved_to_1,i,d.resolvedModule.resolvedFileName):t(o,e.Diagnostics.Module_name_0_was_not_resolved,i)),d},e.nodeModuleNameResolver=p,e.resolveJavaScriptModule=function(t,n,i){var r=h(t,n,{moduleResolution:e.ModuleResolutionKind.NodeJs,allowJs:!0},i,void 0,!0),s=r.resolvedModule,o=r.failedLookupLocations;if(!s)throw new Error("Could not resolve JS module '"+t+"' starting at '"+n+"'. Looked in: "+o.join(", "));return s.resolvedFileName},e.directoryProbablyExists=g,e.getPackageName=C;var N="__";function D(t){if(e.startsWith(t,"@")){var n=t.replace(e.directorySeparator,N);if(n!==t)return n.slice(1)}return t}function O(n,i,r,s,o){var a=n&&n.get(r);if(a)return s&&t(o,e.Diagnostics.Resolution_for_module_0_was_found_in_cache,i),{value:a.resolvedModule&&{path:a.resolvedModule.resolvedFileName,extension:a.resolvedModule.extension,packageId:a.resolvedModule.packageId}}}function R(t,i,r,o,l){var c=n(r,o),u={compilerOptions:r,host:o,traceEnabled:c},p=[],h=e.getDirectoryPath(i),f=m(s.TypeScript)||m(s.JavaScript);return a(f&&f.value,!1,p);function m(n){var i=d(n,t,h,_,p,u);if(i)return{value:i};var r=l&&l.getOrCreateCacheForModuleName(t);if(e.isExternalModuleNameRelative(t)){var a=e.normalizePath(e.combinePaths(h,t));return L(_(n,a,p,!1,u))}var f=e.forEachAncestorDirectory(h,function(i){var s=O(r,t,i,c,o);if(s)return s;var a=e.normalizePath(e.combinePaths(i,t));return L(_(n,a,p,!1,u))});return f||(n===s.TypeScript?function(e,t,n,i){return I(s.DtsOnly,e,t,n,i,!0,void 0)}(t,h,p,u):void 0)}}function L(e){return void 0!==e?{value:e}:void 0}e.getTypesPackageName=function(e){return"@types/"+D(e)},e.getPackageNameFromAtTypesDirectory=function(t){var n=e.removePrefix(t,"@types/");return n!==t?e.stringContains(n,N)?"@"+n.replace(N,e.directorySeparator):n:t},e.classicNameResolver=R,e.loadModuleFromGlobalCache=function(i,r,o,l,c){var u=n(o,l);u&&t(l,e.Diagnostics.Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using_cache_location_2,r,i,c);var d={compilerOptions:o,host:l,traceEnabled:u},p=[];return a(A(s.DtsOnly,i,c,p,d),!0,p)}}(ts||(ts={})),function(e){var t=/^".+"$/,n=1,i=1,r=1,s=1;function o(e){return e.id||(e.id=i,i++),e.id}function a(e){return e.id||(e.id=n,n++),e.id}function l(t,n){var i=e.getModuleInstanceState(t);return 1===i||n&&2===i}function c(t){switch(t.parent.kind){case 242:case 246:return!0;default:return e.isDeclarationName(t)}}function u(e){switch(e.kind){case 239:case 237:case 240:case 242:return!0;case 71:return 242===e.parent.kind;default:return!1}}e.getNodeId=o,e.getSymbolId=a,e.isInstantiatedModule=l,e.createTypeChecker=function(n,i){var d,p,h,f=e.objectAllocator.getSymbolConstructor(),m=e.objectAllocator.getTypeConstructor(),g=e.objectAllocator.getSignatureConstructor(),_=0,y=0,b=0,v=0,T=e.createSymbolTable(),k=e.identity,x=n.getCompilerOptions(),E=e.getEmitScriptTarget(x),S=e.getEmitModuleKind(x),C=!!x.noUnusedLocals||!!x.noUnusedParameters,w=void 0!==x.allowSyntheticDefaultImports?x.allowSyntheticDefaultImports:S===e.ModuleKind.System,I=void 0===x.strictNullChecks?x.strict:x.strictNullChecks,A=void 0===x.strictFunctionTypes?x.strict:x.strictFunctionTypes,N=void 0===x.noImplicitAny?x.strict:x.noImplicitAny,D=void 0===x.noImplicitThis?x.strict:x.noImplicitThis,O=function(){var t,i=n.getResolvedTypeReferenceDirectives();i&&(t=e.createMap(),i.forEach(function(e,i){if(e){var r=n.getSourceFile(e.resolvedFileName);t.set(r.path,i)}}));return{getReferencedExportContainer:kf,getReferencedImportDeclaration:xf,getReferencedDeclarationWithCollidingName:Sf,isDeclarationWithCollidingName:Cf,isValueAliasDeclaration:function(t){return!(t=e.getParseTreeNode(t))||wf(t)},hasGlobalName:Gf,isReferencedAliasDeclaration:function(t,n){return!(t=e.getParseTreeNode(t))||Df(t,n)},getNodeCheckFlags:function(t){return(t=e.getParseTreeNode(t))?Pf(t):void 0},isTopLevelValueImportEqualsWithEntityName:If,isDeclarationVisible:Ai,isImplementationOfOverload:Of,isRequiredInitializedParameter:Rf,isOptionalUninitializedParameterProperty:Lf,writeTypeOfDeclaration:Uf,writeReturnTypeOfSignatureDeclaration:Vf,writeTypeOfExpression:Hf,isSymbolAccessible:di,isEntityNameVisible:fi,getConstantValue:function(t){return(t=e.getParseTreeNode(t,Ff))?Bf(t):void 0},collectLinkedAliases:Ni,getReferencedValueDeclaration:Kf,getTypeReferenceSerializationKind:$f,isOptionalParameter:Ss,moduleExportsSomeValue:Tf,isArgumentsLocalBinding:vf,getExternalModuleFileFromDeclaration:qf,getTypeReferenceDirectivesForEntityName:function(e){if(!t)return;var n=179===e.kind||71===e.kind&&Vl(e)?1156031:794600,i=Pn(e,n,!0);return i&&i!==K?r(i,n):void 0},getTypeReferenceDirectivesForSymbol:r,isLiteralConstDeclaration:zf,writeLiteralConstValue:Wf,getJsxFactoryEntity:function(){return Ot}};function r(n,i){if(t&&function(n){if(!n.declarations)return!1;var i=n;for(;;){var r=Jn(i);if(!r)break;i=r}if(i.valueDeclaration&&265===i.valueDeclaration.kind&&512&i.flags)return!1;for(var s=0,o=n.declarations;s<o.length;s++){var a=o[s],l=e.getSourceFileOfNode(a);if(t.has(l.path))return!0}return!1}(n)){for(var r,s=0,o=n.declarations;s<o.length;s++){var a=o[s];if(a.symbol&&a.symbol.flags&i){var l=e.getSourceFileOfNode(a),c=t.get(l.path);if(!c)return;(r||(r=[])).push(c)}}return r}}}(),R=function(){return{typeToTypeNode:function(e,i,r){var s=t(i,r),o=n(e,s);return s.encounteredError?void 0:o},indexInfoToIndexSignatureDeclaration:function(e,n,i,s){var o=t(i,s),a=r(e,n,o);return o.encounteredError?void 0:a},signatureToSignatureDeclaration:function(e,n,i,r){var o=t(i,r),a=s(e,n,o);return o.encounteredError?void 0:a}};function t(e,t){return{enclosingDeclaration:e,flags:t,encounteredError:!1,symbolStack:void 0}}function n(t,a){var c=a.flags&e.NodeBuilderFlags.InTypeAlias;if(a.flags&=~e.NodeBuilderFlags.InTypeAlias,t){if(1&t.flags)return e.createKeywordTypeNode(119);if(2&t.flags)return e.createKeywordTypeNode(136);if(4&t.flags)return e.createKeywordTypeNode(133);if(8&t.flags)return e.createKeywordTypeNode(122);if(256&t.flags&&!(65536&t.flags)){var u=Jn(t.symbol),d=l(u,a,793064,!1),p=Cr(u)===t?d:e.createQualifiedName(d,wi(t.symbol,a));return e.createTypeReferenceNode(p,void 0)}if(272&t.flags){var h=l(t.symbol,a,793064,!1);return e.createTypeReferenceNode(h,void 0)}if(32&t.flags)return e.createLiteralTypeNode(e.setEmitFlags(e.createLiteral(t.value),16777216));if(64&t.flags)return e.createLiteralTypeNode(e.createLiteral(t.value));if(128&t.flags)return"true"===t.intrinsicName?e.createTrue():e.createFalse();if(1024&t.flags)return e.createKeywordTypeNode(105);if(2048&t.flags)return e.createKeywordTypeNode(139);if(4096&t.flags)return e.createKeywordTypeNode(95);if(8192&t.flags)return e.createKeywordTypeNode(130);if(512&t.flags)return e.createKeywordTypeNode(137);if(16777216&t.flags)return e.createKeywordTypeNode(134);if(16384&t.flags&&t.isThisType)return a.flags&e.NodeBuilderFlags.InObjectTypeLiteral&&(a.encounteredError||a.flags&e.NodeBuilderFlags.AllowThisInObjectLiteral||(a.encounteredError=!0)),e.createThis();var f=pn(t);if(4&f)return e.Debug.assert(!!(32768&t.flags)),function(t){var r=t.typeArguments||e.emptyArray;if(t.target===Ee){if(a.flags&e.NodeBuilderFlags.WriteArrayAsGenericType){var s=n(r[0],a);return e.createTypeReferenceNode("Array",[s])}var o=n(r[0],a);return e.createArrayTypeNode(o)}if(8&t.target.objectFlags){if(r.length>0){var l=i(r.slice(0,qs(t)),a);if(l&&l.length>0)return e.createTupleTypeNode(l)}return a.encounteredError||a.flags&e.NodeBuilderFlags.AllowEmptyTuple?e.createTupleTypeNode([]):void(a.encounteredError=!0)}var c=t.target.outerTypeParameters,u=0,d=void 0;if(c)for(var p=c.length;u<p;){var h=u,f=Gs(c[u]);do{u++}while(u<p&&Gs(c[u])===f);if(!e.rangeEquals(c,r,h,u)){var m=i(r.slice(h,u),a),g=m&&e.createNodeArray(m),_=v(f);(71===_.kind?_:_.right).typeArguments=g,d?(e.Debug.assert(!d.right),d=T(d,_),d=e.createQualifiedName(d,void 0)):d=e.createQualifiedName(_,void 0)}}var y=void 0,b=v(t.symbol);d?(e.Debug.assert(!d.right),y=d=T(d,b)):y=b;var k=void 0;if(r.length>0){var x=(t.target.typeParameters||e.emptyArray).length;k=i(r.slice(u,x),a)}return k&&((71===y.kind?y:y.right).typeArguments=void 0),e.createTypeReferenceNode(y,k)}(t);if(16384&t.flags||3&f){h=t.symbol?l(t.symbol,a,793064,!1):e.createIdentifier("?");return e.createTypeReferenceNode(h,void 0)}if(!c&&t.aliasSymbol&&ui(t.aliasSymbol,a.enclosingDeclaration)){h=v(t.aliasSymbol);var m=i(t.aliasTypeArguments,a);return e.createTypeReferenceNode(h,m)}if(196608&t.flags){var g=i(65536&t.flags?ki(t.types):t.types,a);return g&&g.length>0?e.createUnionOrIntersectionTypeNode(65536&t.flags?166:167,g):void(a.encounteredError||a.flags&e.NodeBuilderFlags.AllowEmptyUnionOrIntersection||(a.encounteredError=!0))}if(48&f)return e.Debug.assert(!!(32768&t.flags)),function(t){var n=t.symbol;if(n){if(32&n.flags&&!er(n)||896&n.flags||o())return function(t,n){var i=l(t,a,n,!1);return e.createTypeQueryNode(i)}(n,107455);if(e.contains(a.symbolStack,n)){var i=Ei(t);if(i){var r=l(i,a,793064,!1);return e.createTypeReferenceNode(r,void 0)}return e.createKeywordTypeNode(119)}a.symbolStack||(a.symbolStack=[]),a.symbolStack.push(n);var s=b(t);return a.symbolStack.pop(),s}return b(t);function o(){var t=!!(8192&n.flags)&&e.some(n.declarations,function(t){return e.hasModifier(t,32)}),i=!!(16&n.flags)&&(n.parent||e.forEach(n.declarations,function(e){return 265===e.parent.kind||234===e.parent.kind}));if(t||i)return e.contains(a.symbolStack,n)}}(t);if(262144&t.flags){var _=n(t.type,a);return e.createTypeOperatorNode(_)}if(524288&t.flags){var y=n(t.objectType,a);_=n(t.indexType,a);return e.createIndexedAccessTypeNode(y,_)}e.Debug.fail("Should be unreachable.")}else a.encounteredError=!0;function b(t){if(Xr(t))return function(t){e.Debug.assert(!!(32768&t.flags));var i=t.declaration&&t.declaration.readonlyToken?e.createToken(131):void 0,r=t.declaration&&t.declaration.questionToken?e.createToken(55):void 0,s=o(qr(t),a),l=n(Yr(t),a),c=e.createMappedTypeNode(i,s,r,l);return e.setEmitFlags(c,1)}(t);var i=Zr(t);if(!i.properties.length&&!i.stringIndexInfo&&!i.numberIndexInfo){if(!i.callSignatures.length&&!i.constructSignatures.length)return e.setEmitFlags(e.createTypeLiteralNode(void 0),1);if(1===i.callSignatures.length&&!i.constructSignatures.length)return s(i.callSignatures[0],160,a);if(1===i.constructSignatures.length&&!i.callSignatures.length)return s(i.constructSignatures[0],161,a)}var c=a.flags;a.flags|=e.NodeBuilderFlags.InObjectTypeLiteral;var u=function(t){for(var i=[],o=0,c=t.callSignatures;o<c.length;o++){var u=c[o];i.push(s(u,155,a))}for(var d=0,p=t.constructSignatures;d<p.length;d++){u=p[d];i.push(s(u,156,a))}t.stringIndexInfo&&i.push(r(t.stringIndexInfo,0,a));t.numberIndexInfo&&i.push(r(t.numberIndexInfo,1,a));var h=t.properties;if(!h)return i;for(var f=0,m=h;f<m.length;f++){var g=m[f],_=nr(g),y=a.enclosingDeclaration;a.enclosingDeclaration=void 0;var b=l(g,a,107455,!0);a.enclosingDeclaration=y;var v=16777216&g.flags?e.createToken(55):void 0;if(8208&g.flags&&!Qr(_).length)for(var T=0,k=gs(_,0);T<k.length;T++){var x=s(u=k[T],150,a);x.name=b,x.questionToken=v,i.push(x)}else{var E=_?n(_,a):e.createKeywordTypeNode(119),S=Yd(g)?[e.createToken(131)]:void 0,C=e.createPropertySignature(S,b,v,E,void 0);i.push(C)}}return i.length?i:void 0}(i);a.flags=c;var d=e.createTypeLiteralNode(u);return e.setEmitFlags(d,1)}function v(t){return 32&t.flags||!ni(t.escapedName)?l(t,a,793064,!1):e.createIdentifier("")}function T(t,n){if(e.Debug.assert(void 0===t.right),71===n.kind)return t.right=n,t;for(var i=n;71!==i.left.kind;)i=i.left;return t.right=i.left,i.left=t,n}}function i(t,i){if(e.some(t)){for(var r=[],s=0;s<t.length;++s){var o=n(t[s],i);o&&r.push(o)}return r}}function r(t,i,r){var s=e.getNameFromIndexInfo(t)||"x",o=e.createKeywordTypeNode(0===i?136:133),a=e.createParameter(void 0,void 0,void 0,s,void 0,o,void 0),l=n(t.type,r);return e.createIndexSignature(void 0,t.isReadonly?[e.createToken(131)]:void 0,[a],l)}function s(t,i,r){var s,l=t.typeParameters&&t.typeParameters.map(function(e){return o(e,r)}),c=t.parameters.map(function(e){return a(e,r)});if(t.thisParameter){var u=a(t.thisParameter,r);c.unshift(u)}if(t.typePredicate){var d=t.typePredicate,p=1===d.kind?e.setEmitFlags(e.createIdentifier(d.parameterName),16777216):e.createThisTypeNode(),h=n(d.type,r);s=e.createTypePredicateNode(p,h)}else{var f=Ds(t);s=f&&n(f,r)}return r.flags&e.NodeBuilderFlags.SuppressAnyReturnType?s&&119===s.kind&&(s=void 0):s||(s=e.createKeywordTypeNode(119)),e.createSignatureDeclaration(i,l,c,s)}function o(t,i){var r=l(t.symbol,i,793064,!0),s=Hs(t),o=s&&n(s,i),a=ls(t),c=a&&n(a,i);return e.createTypeParameterDeclaration(r,o,c)}function a(t,i){var r=e.getDeclarationOfKind(t,146);if(rn(t)&&t.isRestParameter)return e.createParameter(void 0,void 0,t.isRestParameter?e.createToken(24):void 0,"args",void 0,n(De,i),void 0);var s=r.modifiers&&r.modifiers.map(e.getSynthesizedClone),o=e.isRestParameter(r)?e.createToken(24):void 0,a=r.name?71===r.name.kind?e.setEmitFlags(e.getSynthesizedClone(r.name),16777216):function t(n){var i=e.visitEachChild(n,t,e.nullTransformationContext,void 0,t),r=e.nodeIsSynthesized(i)?i:e.getSynthesizedClone(i);return 176===r.kind&&(r.initializer=void 0),e.setEmitFlags(r,16777217)}(r.name):e.symbolName(t),l=Ss(r)?e.createToken(55):void 0,c=nr(t);Rf(r)&&(c=gl(c,2048));var u=n(c,i);return e.createParameter(void 0,s,o,a,l,u,void 0)}function l(t,n,r,s){var o;return!(262144&t.flags)&&(n.enclosingDeclaration||n.flags&e.NodeBuilderFlags.UseFullyQualifiedType)?(o=function t(i,r,s){var o,a=li(i,n.enclosingDeclaration,r,!1);if(!a||ci(a[0],n.enclosingDeclaration,1===a.length?r:ai(r))){var l=Jn(a?a[0]:i);if(l){var c=t(l,ai(r),!1);c&&(o=l,a=c.concat(a||[i]))}}if(a)return a;if(s||(o||!e.forEach(i.declarations,pi))&&!(6144&i.flags))return[i]}(t,r,!0),e.Debug.assert(o&&o.length>0)):o=[t],!s||1===o.length||n.encounteredError||n.flags&e.NodeBuilderFlags.AllowQualifedNameInPlaceOfIdentifier||(n.encounteredError=!0),function t(r,s){e.Debug.assert(r&&0<=s&&s<r.length);var o,a=r[s];if(n.flags&e.NodeBuilderFlags.WriteTypeParametersInQualifiedName&&s>0){var l=r[s-1],c=void 0;if(1&e.getCheckFlags(a))c=ur(l);else 524384&Vh(l).flags&&(c=cr(a));o=i(c,n)}var u=wi(a,n),d=e.setEmitFlags(e.createIdentifier(u,o),16777216);return s>0?e.createQualifiedName(t(r,s-1),d):d}(o,o.length-1)}}(),L=nn(4,"undefined");L.declarations=[];var P,M,F=nn(4,"arguments"),B={getNodeCount:function(){return e.sum(n.getSourceFiles(),"nodeCount")},getIdentifierCount:function(){return e.sum(n.getSourceFiles(),"identifierCount")},getSymbolCount:function(){return e.sum(n.getSourceFiles(),"symbolCount")+y},getTypeCount:function(){return _},isUndefinedSymbol:function(e){return e===L},isArgumentsSymbol:function(e){return e===F},isUnknownSymbol:function(e){return e===K},getMergedSymbol:Wn,getDiagnostics:af,getGlobalDiagnostics:function(){return lf(),Nt.getGlobalDiagnostics()},getTypeOfSymbolAtLocation:function(t,n){return(n=e.getParseTreeNode(n))?function(t,n){if(t=t.exportSymbol||t,71===n.kind&&(e.isRightSideOfQualifiedNameOrPropertyAccess(n)&&(n=n.parent),e.isPartOfExpression(n)&&!e.isAssignmentTarget(n))){var i=kp(n);if(Yn(dn(n).resolvedSymbol)===t)return i}return nr(t)}(t,n):J},getSymbolsOfParameterPropertyDeclaration:function(t,n){return t=e.getParseTreeNode(t,e.isParameter),e.Debug.assert(void 0!==t,"Cannot get symbols of a synthetic parameter that cannot be resolved to a parse-tree node."),function(t,n){var i=t.parent,r=t.parent.parent,s=fn(i.locals,n,107455),o=fn(r.symbol.members,n,107455);if(s&&o)return[s,o];e.Debug.fail("There should exist two symbols, one as property declaration and one as parameter declaration")}(t,e.escapeLeadingUnderscores(n))},getDeclaredTypeOfSymbol:Cr,getPropertiesOfType:ts,getPropertyOfType:function(t,n){return fs(t,e.escapeLeadingUnderscores(n))},getIndexInfoOfType:bs,getSignaturesOfType:gs,getIndexTypeOfType:vs,getBaseTypes:_r,getBaseTypeOfLiteralType:ll,getWidenedType:xl,getTypeFromTypeNode:function(t){return(t=e.getParseTreeNode(t,e.isTypeNode))?aa(t):J},getParameterType:Md,getReturnTypeOfSignature:Ds,getNullableType:gl,getNonNullableType:_l,typeToTypeNode:R.typeToTypeNode,indexInfoToIndexSignatureDeclaration:R.indexInfoToIndexSignatureDeclaration,signatureToSignatureDeclaration:R.signatureToSignatureDeclaration,getSymbolsInScope:function(t,n){return(t=e.getParseTreeNode(t))?function(t,n){if(cf(t))return[];var i=e.createSymbolTable(),r=!1;return s(),ks(i);function s(){for(;t;){switch(t.locals&&!hn(t)&&a(t.locals,n),t.kind){case 233:a(qn(t).exports,2623475&n);break;case 232:a(qn(t).exports,8&n);break;case 199:t.name&&o(t.symbol,n);case 229:case 230:r||a(qn(t).members,793064&n);break;case 186:t.name&&o(t.symbol,n)}e.introducesArgumentsExoticObject(t)&&o(F,n),r=e.hasModifier(t,32),t=t.parent}a(ot,n)}function o(t,n){if(e.getCombinedLocalAndExportSymbolFlags(t)&n){var r=t.escapedName;i.has(r)||i.set(r,t)}}function a(e,t){t&&e.forEach(function(e){o(e,t)})}}(t,n):[]},getSymbolAtLocation:function(t){return(t=e.getParseTreeNode(t))?gf(t):void 0},getShorthandAssignmentValueSymbol:function(t){return(t=e.getParseTreeNode(t))?function(e){if(e&&262===e.kind)return Pn(e.name,2204607);return}(t):void 0},getExportSpecifierLocalTargetSymbol:function(t){return(t=e.getParseTreeNode(t,e.isExportSpecifier))?function(e){return e.parent.parent.moduleSpecifier?Sn(e.parent.parent,e):Pn(e.propertyName||e.name,2998271)}(t):void 0},getExportSymbolOfSymbol:function(e){return Wn(e.exportSymbol||e)},getTypeAtLocation:function(t){return(t=e.getParseTreeNode(t))?_f(t):J},getPropertySymbolOfDestructuringAssignment:function(t){return(t=e.getParseTreeNode(t,e.isIdentifier))?function(e){var t=yf(e.parent.parent);return t&&fs(t,e.escapedText)}(t):void 0},signatureToString:function(t,n,i,r){return bi(t,e.getParseTreeNode(n),i,r)},typeToString:function(t,n,i){return vi(t,e.getParseTreeNode(n),i)},getSymbolDisplayBuilder:Ii,symbolToString:function(t,n,i){return yi(t,e.getParseTreeNode(n),i)},getAugmentedPropertiesOfType:function(t){t=us(t);var n=e.createSymbolTable(ts(t));(gs(t,0).length||gs(t,1).length)&&e.forEach(ts(xe),function(e){n.has(e.escapedName)||n.set(e.escapedName,e)});return ii(n)},getRootSymbols:function t(n){if(6&e.getCheckFlags(n)){var i=[],r=n.escapedName;return e.forEach(un(n).containingType.types,function(e){var t=fs(e,r);t&&i.push(t)}),i}if(33554432&n.flags){var s=n;if(s.leftSpread)return t(s.leftSpread).concat(t(s.rightSpread));if(s.syntheticOrigin)return t(s.syntheticOrigin);for(var o=void 0,a=n;a=un(a).target;)o=a;if(o)return[o]}return[n]},getContextualType:function(t){return(t=e.getParseTreeNode(t,e.isExpression))?su(t):void 0},getFullyQualifiedName:Ln,getResolvedSignature:function(t,n,i){t=e.getParseTreeNode(t,e.isCallLikeExpression),P=i;var r=t?wd(t,n):void 0;return P=void 0,r},getConstantValue:function(t){return(t=e.getParseTreeNode(t,Ff))?Bf(t):void 0},isValidPropertyAccess:function(t,n){return!!(t=e.getParseTreeNode(t,e.isPropertyAccessOrQualifiedName))&&function(e,t){var n=179===e.kind?e.expression:e.left;return Yu(e,n,t,xl(xp(n)))}(t,e.escapeLeadingUnderscores(n))},getSignatureFromDeclaration:function(t){return(t=e.getParseTreeNode(t,e.isFunctionLike))?Is(t):void 0},isImplementationOfOverload:function(t){var n=e.getParseTreeNode(t,e.isFunctionLike);return n?Of(n):void 0},getImmediateAliasedSymbol:function(t){e.Debug.assert(!!(2097152&t.flags),"Should only get Alias here.");var n=un(t);if(!n.immediateTarget){var i=En(t);e.Debug.assert(!!i),n.immediateTarget=wn(i,!0)}return n.immediateTarget},getAliasedSymbol:Nn,getEmitResolver:function(e,t){return af(e,t),O},getExportsOfModule:Hn,getExportsAndPropertiesOfModule:function(t){var n=Hn(t),i=$n(t);i!==t&&e.addRange(n,ts(nr(i)));return n},getSymbolWalker:e.createGetSymbolWalker(Os,Ds,_r,Zr,nr,Ul,ys,Hs,Jh),getAmbientModules:function(){ve||(ve=[],ot.forEach(function(e,n){t.test(n)&&ve.push(e)}));return ve},getAllAttributesTypeFromJsxOpeningLikeElement:function(t){return(t=e.getParseTreeNode(t,e.isJsxOpeningLikeElement))?function(e){return Tu(e.tagName)?Nu(e):Du(e,!0)}(t):void 0},getJsxIntrinsicTagNames:function(){var t=xu(zt.IntrinsicElements);return t?ts(t):e.emptyArray},isOptionalParameter:function(t){return!!(t=e.getParseTreeNode(t,e.isParameter))&&Ss(t)},tryGetMemberInModuleExports:function(t,n){return Gn(e.escapeLeadingUnderscores(t),n)},tryGetMemberInModuleExportsAndProperties:function(t,n){return function(e,t){var n=Gn(e,t);if(!n){var i=$n(t);if(i!==t)return fs(nr(i),e)}return n}(e.escapeLeadingUnderscores(t),n)},tryFindAmbientModuleWithoutAugmentations:function(e){return Es(e,!1)},getApparentType:us,getUnionType:Po,createAnonymousType:si,createSignature:Mr,createSymbol:nn,createIndexInfo:Us,getAnyType:function(){return W},getStringType:function(){return ee},getNumberType:function(){return te},createPromiseType:Ud,createArrayType:So,getBooleanType:function(){return re},getVoidType:function(){return oe},getUndefinedType:function(){return Y},getNullType:function(){return Z},getESSymbolType:function(){return se},getNeverType:function(){return ae},isSymbolAccessible:di,isArrayLikeType:rl,getAllPossiblePropertiesOfTypes:function(t){var n=Po(t);if(!(65536&n.flags))return ts(n);for(var i=e.createSymbolTable(),r=0,s=t;r<s.length;r++)for(var o=0,a=ts(s[r]);o<a.length;o++){var l=a[o].escapedName;i.has(l)||i.set(l,ds(n,l))}return e.arrayFrom(i.values())},getSuggestionForNonexistentProperty:function(e,t){return zu(e,t)},getSuggestionForNonexistentSymbol:function(t,n,i){return Wu(t,e.escapeLeadingUnderscores(n),i)},getBaseConstraintOfType:rs,resolveName:function(t,n,i){return gn(n,e.escapeLeadingUnderscores(t),i,void 0,void 0,!1)},getJsxNamespace:function(){return e.unescapeLeadingUnderscores(en())}},$=[],U=e.createMap(),V=e.createMap(),H=e.createMap(),G=e.createMap(),j=[],K=nn(4,"unknown"),z=nn(0,"__resolving__"),W=ei(1,"any"),q=ei(1,"any"),J=ei(1,"unknown"),Y=ei(2048,"undefined"),X=I?Y:ei(2099200,"undefined"),Z=ei(4096,"null"),Q=I?Z:ei(2101248,"null"),ee=ei(2,"string"),te=ei(4,"number"),ne=ei(128,"true"),ie=ei(128,"false"),re=((M=Po([ne,ie])).flags|=8,M.intrinsicName="boolean",M),se=ei(512,"symbol"),oe=ei(1024,"void"),ae=ei(8192,"never"),le=ei(8192,"never"),ce=ei(16777216,"object"),ue=si(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),de=nn(2048,"__type");de.members=e.createSymbolTable();var pe=si(de,T,e.emptyArray,e.emptyArray,void 0,void 0),he=si(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0);he.instantiations=e.createMap();var fe=si(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0);fe.flags|=8388608;var me=si(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),ge=si(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),_e=si(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),ye=Qn(16384),be=Qn(16384);be.constraint=ye;var ve,Te,ke,xe,Ee,Se,Ce,we,Ie,Ae,Ne,De,Oe,Re,Le,Pe,Me,Fe,Be,$e,Ue,Ve,He,Ge,je,Ke,ze,We,qe,Je,Ye,Xe,Ze,Qe=Qn(16384),et=Mr(void 0,void 0,void 0,e.emptyArray,W,void 0,0,!1,!1),tt=Mr(void 0,void 0,void 0,e.emptyArray,J,void 0,0,!1,!1),nt=Mr(void 0,void 0,void 0,e.emptyArray,W,void 0,0,!1,!1),it=Mr(void 0,void 0,void 0,e.emptyArray,le,void 0,0,!1,!1),rt=Us(ee,!0),st=Us(W,!1),ot=e.createSymbolTable(),at=0,lt=0,ct=0,ut=!1,dt=sa(""),pt=sa(0),ht=[],ft=[],mt=[],gt=0,_t=10,yt=[],bt=[],vt=[],Tt=[],kt=[],xt=[],Et=[],St=[],Ct=[],wt=[],It=[],At=[],Nt=e.createDiagnosticCollection();!function(e){e[e.None=0]="None",e[e.TypeofEQString=1]="TypeofEQString",e[e.TypeofEQNumber=2]="TypeofEQNumber",e[e.TypeofEQBoolean=4]="TypeofEQBoolean",e[e.TypeofEQSymbol=8]="TypeofEQSymbol",e[e.TypeofEQObject=16]="TypeofEQObject",e[e.TypeofEQFunction=32]="TypeofEQFunction",e[e.TypeofEQHostObject=64]="TypeofEQHostObject",e[e.TypeofNEString=128]="TypeofNEString",e[e.TypeofNENumber=256]="TypeofNENumber",e[e.TypeofNEBoolean=512]="TypeofNEBoolean",e[e.TypeofNESymbol=1024]="TypeofNESymbol",e[e.TypeofNEObject=2048]="TypeofNEObject",e[e.TypeofNEFunction=4096]="TypeofNEFunction",e[e.TypeofNEHostObject=8192]="TypeofNEHostObject",e[e.EQUndefined=16384]="EQUndefined",e[e.EQNull=32768]="EQNull",e[e.EQUndefinedOrNull=65536]="EQUndefinedOrNull",e[e.NEUndefined=131072]="NEUndefined",e[e.NENull=262144]="NENull",e[e.NEUndefinedOrNull=524288]="NEUndefinedOrNull",e[e.Truthy=1048576]="Truthy",e[e.Falsy=2097152]="Falsy",e[e.Discriminatable=4194304]="Discriminatable",e[e.All=8388607]="All",e[e.BaseStringStrictFacts=933633]="BaseStringStrictFacts",e[e.BaseStringFacts=3145473]="BaseStringFacts",e[e.StringStrictFacts=4079361]="StringStrictFacts",e[e.StringFacts=4194049]="StringFacts",e[e.EmptyStringStrictFacts=3030785]="EmptyStringStrictFacts",e[e.EmptyStringFacts=3145473]="EmptyStringFacts",e[e.NonEmptyStringStrictFacts=1982209]="NonEmptyStringStrictFacts",e[e.NonEmptyStringFacts=4194049]="NonEmptyStringFacts",e[e.BaseNumberStrictFacts=933506]="BaseNumberStrictFacts",e[e.BaseNumberFacts=3145346]="BaseNumberFacts",e[e.NumberStrictFacts=4079234]="NumberStrictFacts",e[e.NumberFacts=4193922]="NumberFacts",e[e.ZeroStrictFacts=3030658]="ZeroStrictFacts",e[e.ZeroFacts=3145346]="ZeroFacts",e[e.NonZeroStrictFacts=1982082]="NonZeroStrictFacts",e[e.NonZeroFacts=4193922]="NonZeroFacts",e[e.BaseBooleanStrictFacts=933252]="BaseBooleanStrictFacts",e[e.BaseBooleanFacts=3145092]="BaseBooleanFacts",e[e.BooleanStrictFacts=4078980]="BooleanStrictFacts",e[e.BooleanFacts=4193668]="BooleanFacts",e[e.FalseStrictFacts=3030404]="FalseStrictFacts",e[e.FalseFacts=3145092]="FalseFacts",e[e.TrueStrictFacts=1981828]="TrueStrictFacts",e[e.TrueFacts=4193668]="TrueFacts",e[e.SymbolStrictFacts=1981320]="SymbolStrictFacts",e[e.SymbolFacts=4193160]="SymbolFacts",e[e.ObjectStrictFacts=6166480]="ObjectStrictFacts",e[e.ObjectFacts=8378320]="ObjectFacts",e[e.FunctionStrictFacts=6164448]="FunctionStrictFacts",e[e.FunctionFacts=8376288]="FunctionFacts",e[e.UndefinedFacts=2457472]="UndefinedFacts",e[e.NullFacts=2340752]="NullFacts"}(Ze||(Ze={}));var Dt,Ot,Rt,Lt,Pt,Mt,Ft,Bt,$t=e.createMapFromTemplate({string:1,number:2,boolean:4,symbol:8,undefined:16384,object:16,function:32}),Ut=e.createMapFromTemplate({string:128,number:256,boolean:512,symbol:1024,undefined:131072,object:2048,function:4096}),Vt=e.createMapFromTemplate({string:ee,number:te,boolean:re,symbol:se,undefined:Y}),Ht=Po(e.arrayFrom($t.keys(),sa)),Gt=!1,jt=!1,Kt=e.createUnderscoreEscapedMap(),zt={JSX:"JSX",IntrinsicElements:"IntrinsicElements",ElementClass:"ElementClass",ElementAttributesPropertyNameContainer:"ElementAttributesProperty",ElementChildrenAttributeNameContainer:"ElementChildrenAttribute",Element:"Element",IntrinsicAttributes:"IntrinsicAttributes",IntrinsicClassAttributes:"IntrinsicClassAttributes"},Wt=e.createMap(),qt=e.createMap(),Jt=e.createMap(),Yt=e.createMap(),Xt=e.createMap();!function(e){e[e.Type=0]="Type",e[e.ResolvedBaseConstructorType=1]="ResolvedBaseConstructorType",e[e.DeclaredType=2]="DeclaredType",e[e.ResolvedReturnType=3]="ResolvedReturnType"}(Mt||(Mt={})),function(e){e[e.Normal=0]="Normal",e[e.SkipContextSensitive=1]="SkipContextSensitive",e[e.Inferential=2]="Inferential"}(Ft||(Ft={})),function(e){e[e.None=0]="None",e[e.Bivariant=1]="Bivariant",e[e.Strict=2]="Strict"}(Bt||(Bt={}));var Zt=e.createSymbolTable();Zt.set(L.escapedName,L);var Qt=e.and(nf,function(t){return!e.isAccessor(t)});return function(){for(var t=0,i=n.getSourceFiles();t<i.length;t++){var r=i[t];e.bindSourceFile(r,x)}for(var s,o=0,a=n.getSourceFiles();o<a.length;o++){r=a[o];if(e.isExternalOrCommonJsModule(r)||ln(ot,r.locals),r.patternAmbientModules&&r.patternAmbientModules.length&&(Te=e.concatenate(Te,r.patternAmbientModules)),r.moduleAugmentations.length&&(s||(s=[])).push(r.moduleAugmentations),r.symbol&&r.symbol.globalExports)r.symbol.globalExports.forEach(function(e,t){ot.has(t)||ot.set(t,e)})}if(s)for(var l=0,c=s;l<c.length;l++)for(var u=0,d=c[l];u<d.length;u++){cn(d[u])}(function(t,n,i){function r(t,n){return function(i){return Nt.add(e.createDiagnosticForNode(i,n,t))}}n.forEach(function(n,s){var o=t.get(s);o?e.forEach(o.declarations,r(e.unescapeLeadingUnderscores(s),i)):t.set(s,n)})})(ot,Zt,e.Diagnostics.Declaration_name_conflicts_with_built_in_global_identifier_0),un(L).type=X,un(F).type=ao("IArguments",0,!0),un(K).type=J,Ee=ao("Array",1,!0),ke=ao("Object",0,!0),xe=ao("Function",0,!0),Ce=ao("String",0,!0),we=ao("Number",0,!0),Ie=ao("Boolean",0,!0),Ae=ao("RegExp",0,!0),De=So(W),Oe=So(q),Se=yo("ReadonlyArray",1),Re=Se?vo(Se,[W]):De,Ne=yo("ThisType",1)}(),B;function en(){return Dt||(Dt="React",x.jsxFactory?(Ot=e.parseIsolatedEntityName(x.jsxFactory,E))&&(Dt=Jh(Ot).escapedText):x.reactNamespace&&(Dt=e.escapeLeadingUnderscores(x.reactNamespace))),Dt}function tn(t,n,i,r,s){var o=t?e.createDiagnosticForNode(t,n,i,r,s):e.createCompilerDiagnostic(n,i,r,s);Nt.add(o)}function nn(e,t){y++;var n=new f(33554432|e,t);return n.checkFlags=0,n}function rn(e){return!!(33554432&e.flags)}function sn(e,t){t.mergeId||(t.mergeId=r,r++),yt[t.mergeId]=e}function on(t){var n=nn(t.flags,t.escapedName);return n.declarations=t.declarations?t.declarations.slice():[],n.parent=t.parent,t.valueDeclaration&&(n.valueDeclaration=t.valueDeclaration),t.constEnumOnlyModule&&(n.constEnumOnlyModule=!0),t.members&&(n.members=e.cloneMap(t.members)),t.exports&&(n.exports=e.cloneMap(t.exports)),sn(n,t),n}function an(t,n){if(t.flags&(r=n.flags,s=0,2&r&&(s|=107455),1&r&&(s|=107454),4&r&&(s|=0),8&r&&(s|=900095),16&r&&(s|=106927),32&r&&(s|=899519),64&r&&(s|=792968),256&r&&(s|=899327),128&r&&(s|=899967),512&r&&(s|=106639),8192&r&&(s|=99263),32768&r&&(s|=41919),65536&r&&(s|=74687),262144&r&&(s|=530920),524288&r&&(s|=793064),2097152&r&&(s|=2097152),s))if(1024&t.flags)tn(e.getNameOfDeclaration(n.declarations[0]),e.Diagnostics.Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity,yi(t));else{var i=2&t.flags||2&n.flags?e.Diagnostics.Cannot_redeclare_block_scoped_variable_0:e.Diagnostics.Duplicate_identifier_0;e.forEach(n.declarations,function(t){tn(e.getNameOfDeclaration(t)||t,i,yi(n))}),e.forEach(t.declarations,function(t){tn(e.getNameOfDeclaration(t)||t,i,yi(n))})}else 512&n.flags&&512&t.flags&&t.constEnumOnlyModule&&!n.constEnumOnlyModule&&(t.constEnumOnlyModule=!1),t.flags|=n.flags,n.valueDeclaration&&(!t.valueDeclaration||233===t.valueDeclaration.kind&&233!==n.valueDeclaration.kind)&&(t.valueDeclaration=n.valueDeclaration),e.addRange(t.declarations,n.declarations),n.members&&(t.members||(t.members=e.createSymbolTable()),ln(t.members,n.members)),n.exports&&(t.exports||(t.exports=e.createSymbolTable()),ln(t.exports,n.exports)),sn(t,n);var r,s}function ln(e,t){t.forEach(function(t,n){var i=e.get(n);i?(33554432&i.flags||(i=on(i),e.set(n,i)),an(i,t)):e.set(n,t)})}function cn(t){var n=t.parent;if(n.symbol.declarations[0]===n)if(e.isGlobalScopeAugmentation(n))ln(ot,n.symbol.exports);else{var i=Fn(t,t,e.isInAmbientContext(t.parent.parent)?void 0:e.Diagnostics.Invalid_module_name_in_augmentation_module_0_cannot_be_found,!0);if(!i)return;1920&(i=$n(i)).flags?an(i=33554432&i.flags?i:on(i),n.symbol):tn(t,e.Diagnostics.Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity,t.text)}else e.Debug.assert(n.symbol.declarations.length>1)}function un(e){if(33554432&e.flags)return e;var t=a(e);return bt[t]||(bt[t]={})}function dn(e){var t=o(e);return vt[t]||(vt[t]={flags:0})}function pn(e){return 32768&e.flags?e.objectFlags:0}function hn(t){return 265===t.kind&&!e.isExternalOrCommonJsModule(t)}function fn(t,n,i){if(i){var r=t.get(n);if(r){if(e.Debug.assert(!(1&e.getCheckFlags(r)),"Should never get an instantiated symbol here."),r.flags&i)return r;if(2097152&r.flags){var s=Nn(r);if(s===K||s.flags&i)return r}}}}function mn(t,i){var r=e.getSourceFileOfNode(t),s=e.getSourceFileOfNode(i);if(r!==s){if(S&&(r.externalModuleIndicator||s.externalModuleIndicator)||!x.outFile&&!x.out||Vl(i)||e.isInAmbientContext(t))return!0;if(c(i,t))return!0;var o=n.getSourceFiles();return e.indexOf(o,r)<=e.indexOf(o,s)}if(t.pos<=i.pos){if(176===t.kind){var a=e.getAncestor(i,176);return a?e.findAncestor(a,e.isBindingElement)!==e.findAncestor(t,e.isBindingElement)||t.pos<a.pos:mn(e.getAncestor(t,226),i)}return 226!==t.kind||!function(t,n){var i=e.getEnclosingBlockScopeContainer(t);switch(t.parent.parent.kind){case 208:case 214:case 216:if(kn(n,t,i))return!0}return e.isForInOrOfStatement(t.parent.parent)&&kn(n,t.parent.parent.expression,i)}(t,i)}if(246===i.parent.kind||243===i.parent.kind&&i.parent.isExportEquals)return!0;if(243===i.kind&&i.isExportEquals)return!0;var l=e.getEnclosingBlockScopeContainer(t);return Vl(i)||c(i,t,l);function c(t,n,i){return!!e.findAncestor(t,function(r){if(r===i)return"quit";if(e.isFunctionLike(r))return!0;if(r.parent&&149===r.parent.kind&&r.parent.initializer===r)if(e.hasModifier(r.parent,32)){if(151===n.kind)return!0}else if(!(149===n.kind&&!e.hasModifier(n,32))||e.getContainingClass(t)!==e.getContainingClass(n))return!0})}}function gn(e,t,n,i,r,s,o){return _n(e,t,n,i,r,s,fn,o)}function _n(t,n,i,r,s,o,a,l){var c,u,d,p,h,f=t,m=t,g=!1;e:for(;t;){if(t.locals&&!hn(t)&&(c=a(t.locals,n,i))){var _=!0;if(e.isFunctionLike(t)&&u&&u!==t.body&&(i&c.flags&793064&&275!==u.kind&&(_=!!(262144&c.flags)&&(u===t.type||146===u.kind||145===u.kind)),107455&i&&1&c.flags&&(_=146===u.kind||u===t.type&&146===c.valueDeclaration.kind)),_)break e;c=void 0}switch(t.kind){case 265:if(!e.isExternalOrCommonJsModule(t))break;g=!0;case 233:var y=qn(t).exports;if(265===t.kind||e.isAmbientModule(t)){if(c=y.get("default")){var b=e.getLocalSymbolForExportDefault(c);if(b&&c.flags&i&&b.escapedName===n)break e;c=void 0}var v=y.get(n);if(v&&2097152===v.flags&&e.getDeclarationOfKind(v,246))break}if(c=a(y,n,2623475&i))break e;break;case 232:if(c=a(qn(t).exports,n,8&i))break e;break;case 149:case 148:if(e.isClassLike(t.parent)&&!e.hasModifier(t,32)){var T=Zn(t.parent);T&&T.locals&&a(T.locals,n,107455&i)&&(p=t)}break;case 229:case 199:case 230:if(c=a(qn(t).members,n,793064&i)){if(!bn(c,t)){c=void 0;break}if(u&&e.hasModifier(u,32))return void tn(m,e.Diagnostics.Static_members_cannot_reference_class_type_parameters);break e}if(199===t.kind&&32&i){var k=t.name;if(k&&n===k.escapedText){c=t.symbol;break e}}break;case 201:if(u===t.expression&&85===t.parent.token){var x=t.parent.parent;if(e.isClassLike(x)&&(c=a(qn(x).members,n,793064&i)))return void(r&&tn(m,e.Diagnostics.Base_class_expressions_cannot_reference_class_type_parameters))}break;case 144:if(h=t.parent.parent,(e.isClassLike(h)||230===h.kind)&&(c=a(qn(h).members,n,793064&i)))return void tn(m,e.Diagnostics.A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type);break;case 151:case 150:case 152:case 153:case 154:case 228:case 187:if(3&i&&"arguments"===n){c=F;break e}break;case 186:if(3&i&&"arguments"===n){c=F;break e}if(16&i){var E=t.name;if(E&&n===E.escapedText){c=t.symbol;break e}}break;case 147:t.parent&&146===t.parent.kind&&(t=t.parent),t.parent&&e.isClassElement(t.parent)&&(t=t.parent)}207!==t.kind&&(d=t),u=t,t=t.parent}if(o&&c&&r&&C&&c!==d.symbol&&(c.isReferenced=!0),!c){if(u&&(e.Debug.assert(265===u.kind),u.commonJsModuleIndicator&&"exports"===n))return u.symbol;c=a(ot,n,i)}if(c){if(r){if(p){var S=p.name;return void tn(m,e.Diagnostics.Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor,e.declarationNameToString(S),yn(s))}if(m&&(2&i||(32&i||384&i)&&!(107455&~i))){var w=Yn(c);(2&w.flags||32&w.flags||384&w.flags)&&function(t,n){e.Debug.assert(!!(2&t.flags||32&t.flags||384&t.flags));var i=e.forEach(t.declarations,function(t){return e.isBlockOrCatchScoped(t)||e.isClassLike(t)||232===t.kind?t:void 0});e.Debug.assert(void 0!==i,"Declaration to checkResolvedBlockScopedVariable is undefined"),e.isInAmbientContext(i)||mn(i,n)||(2&t.flags?tn(n,e.Diagnostics.Block_scoped_variable_0_used_before_its_declaration,e.declarationNameToString(e.getNameOfDeclaration(i))):32&t.flags?tn(n,e.Diagnostics.Class_0_used_before_its_declaration,e.declarationNameToString(e.getNameOfDeclaration(i))):256&t.flags&&tn(n,e.Diagnostics.Enum_0_used_before_its_declaration,e.declarationNameToString(e.getNameOfDeclaration(i))))}(w,m)}if(c&&g&&!(107455&~i)){var I=c.declarations;I&&1===I.length&&236===I[0].kind&&tn(m,e.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead,e.unescapeLeadingUnderscores(n))}}return c}if(r&&!(m&&(function(t,n,i){if(71===t.kind&&df(t)||Vl(t))return!1;var r=e.getThisContainer(t,!0),s=r;for(;s;){if(e.isClassLike(s.parent)){var o=qn(s.parent);if(!o)break;if(fs(nr(o),n))return tn(t,e.Diagnostics.Cannot_find_name_0_Did_you_mean_the_static_member_1_0,yn(i),yi(o)),!0;if(s===r&&!e.hasModifier(s,32))if(fs(Cr(o).thisType,n))return tn(t,e.Diagnostics.Cannot_find_name_0_Did_you_mean_the_instance_member_this_0,yn(i)),!0}s=s.parent}return!1}(m,n,s)||vn(m)||function(t,n,i){if(1920===i){var r=An(gn(t,n,792640,void 0,void 0,!1)),s=t.parent;if(r){if(e.isQualifiedName(s)){e.Debug.assert(s.left===t,"Should only be resolving left side of qualified name as a namespace");var o=s.right.escapedText;if(fs(Cr(r),o))return tn(s,e.Diagnostics.Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1,e.unescapeLeadingUnderscores(n),e.unescapeLeadingUnderscores(o)),!0}return tn(t,e.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here,e.unescapeLeadingUnderscores(n)),!0}}return!1}(m,n,i)||function(t,n,i){if(107455&i){if("any"===n||"string"===n||"number"===n||"boolean"===n||"never"===n)return tn(t,e.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_value_here,e.unescapeLeadingUnderscores(n)),!0;var r=An(gn(t,n,792640,void 0,void 0,!1));if(r&&!(1024&r.flags))return tn(t,e.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_value_here,e.unescapeLeadingUnderscores(n)),!0}return!1}(m,n,i)||function(t,n,i){if(107031&i){if(An(gn(t,n,1024,void 0,void 0,!1)))return tn(t,e.Diagnostics.Cannot_use_namespace_0_as_a_value,e.unescapeLeadingUnderscores(n)),!0}else if(792640&i){if(An(gn(t,n,1024,void 0,void 0,!1)))return tn(t,e.Diagnostics.Cannot_use_namespace_0_as_a_type,e.unescapeLeadingUnderscores(n)),!0}return!1}(m,n,i)))){var A=void 0;l&&gt<_t&&(A=Wu(f,n,i))&&tn(m,l,yn(s),A),A||tn(m,r,yn(s)),gt++}}function yn(t){return e.isString(t)?e.unescapeLeadingUnderscores(t):e.declarationNameToString(t)}function bn(e,t){for(var n=0,i=e.declarations;n<i.length;n++){var r=i[n];if(145===r.kind&&r.parent===t)return!0}return!1}function vn(t){var n=Tn(t),i=!(!n||!Pn(n,64,!0));return i&&tn(t,e.Diagnostics.Cannot_extend_an_interface_0_Did_you_mean_implements,e.getTextOfNode(n)),i}function Tn(t){switch(t.kind){case 71:case 179:return t.parent?Tn(t.parent):void 0;case 201:if(e.isEntityNameExpression(t.expression))return t.expression;default:return}}function kn(t,n,i){return n&&!!e.findAncestor(t,function(t){return t===i||e.isFunctionLike(t)?"quit":t===n})}function xn(e){switch(e.kind){case 237:return e;case 239:return e.parent;case 240:return e.parent.parent;case 242:return e.parent.parent.parent;default:return}}function En(t){return e.find(t.declarations,e.isAliasSymbolDeclaration)}function Sn(t,n,i){var r=Mn(t,t.moduleSpecifier),s=Un(r,t.moduleSpecifier,i);if(s){var o=n.propertyName||n.name;if(o.escapedText){if(e.isShorthandAmbientModuleSymbol(r))return r;var a=void 0;a=r&&r.exports&&r.exports.get("export=")?fs(nr(s),o.escapedText):function(e,t){if(3&e.flags){var n=e.valueDeclaration.type;if(n)return An(fs(aa(n),t))}}(s,o.escapedText),a=An(a,i);var l=function(e,t,n){if(1536&e.flags)return An(jn(e).get(t),n)}(s,o.escapedText,i);!l&&w&&"default"===o.escapedText&&(l=$n(r,i)||An(r,i));var c=l&&a?function(t,n){if(t===K&&n===K)return K;if(794600&t.flags)return t;var i=nn(t.flags|n.flags,t.escapedName);return i.declarations=e.concatenate(t.declarations,n.declarations),i.parent=t.parent||n.parent,t.valueDeclaration&&(i.valueDeclaration=t.valueDeclaration),n.members&&(i.members=n.members),t.exports&&(i.exports=t.exports),i}(a,l):l||a;return c||tn(o,e.Diagnostics.Module_0_has_no_exported_member_1,Ln(r),e.declarationNameToString(o)),c}}}function Cn(e,t,n){return e.parent.parent.moduleSpecifier?Sn(e.parent.parent,e,n):Pn(e.propertyName||e.name,t,!1,n)}function wn(t,n){switch(t.kind){case 237:return function(t,n){return 248===t.moduleReference.kind?$n(Mn(t,e.getExternalModuleImportEqualsDeclarationExpression(t))):Rn(t.moduleReference,n)}(t,n);case 239:return function(t,n){var i=Mn(t,t.parent.moduleSpecifier);if(i){var r=void 0;if(e.isShorthandAmbientModuleSymbol(i))r=i;else{var s=i.exports.get("export=");r=s?fs(nr(s),"default"):An(i.exports.get("default"),n)}if(r||w){if(!r&&w)return $n(i,n)||An(i,n)}else tn(t.name,e.Diagnostics.Module_0_has_no_default_export,yi(i));return r}}(t,n);case 240:return function(e,t){var n=e.parent.parent.moduleSpecifier;return Un(Mn(e,n),n,t)}(t,n);case 242:return function(e,t){return Sn(e.parent.parent.parent,e,t)}(t,n);case 246:return Cn(t,901119,n);case 243:return function(e,t){return Pn(e.expression,901119,!1,t)}(t,n);case 236:return function(e,t){return $n(e.parent.symbol,t)}(t,n)}}function In(e,t){return void 0===t&&(t=901119),e&&2097152==(e.flags&(2097152|t))}function An(e,t){return!t&&In(e)?Nn(e):e}function Nn(t){e.Debug.assert(!!(2097152&t.flags),"Should only get Alias here.");var n=un(t);if(n.target)n.target===z&&(n.target=K);else{n.target=z;var i=En(t);e.Debug.assert(!!i);var r=wn(i);n.target===z?n.target=r||K:tn(i,e.Diagnostics.Circular_definition_of_import_alias_0,yi(t))}return n.target}function Dn(e){var t=qn(e),n=Nn(t);n&&((n===K||107455&n.flags&&!Nf(n))&&On(t))}function On(t){var n=un(t);if(!n.referenced){n.referenced=!0;var i=En(t);e.Debug.assert(!!i),243===i.kind?fp(i.expression):246===i.kind?fp(i.propertyName||i.name):e.isInternalModuleImportEqualsDeclaration(i)&&fp(i.moduleReference)}}function Rn(t,n){return 71===t.kind&&e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent),71===t.kind||143===t.parent.kind?Pn(t,1920,!1,n):(e.Debug.assert(237===t.parent.kind),Pn(t,901119,!1,n))}function Ln(e){return e.parent?Ln(e.parent)+"."+yi(e):yi(e)}function Pn(t,n,i,r,s){if(!e.nodeIsMissing(t)){var o;if(71===t.kind){var a=1920===n?e.Diagnostics.Cannot_find_namespace_0:e.Diagnostics.Cannot_find_name_0;if(!(o=gn(s||t,t.escapedText,n,i?void 0:a,t,!0)))return}else if(143===t.kind||179===t.kind){var l=void 0;if(143===t.kind)l=t.left;else{if(179!==t.kind||185!==t.expression.kind&&!e.isEntityNameExpression(t.expression))return;l=t.expression}var c=143===t.kind?t.right:t.name,u=Pn(l,1920,i,!1,s);if(!u||e.nodeIsMissing(c))return;if(u===K)return u;if(!(o=fn(jn(u),c.escapedText,n)))return void(i||tn(c,e.Diagnostics.Namespace_0_has_no_exported_member_1,Ln(u),e.declarationNameToString(c)))}else{if(185===t.kind)return e.isEntityNameExpression(t.expression)?Pn(t.expression,n,i,r,s):void 0;e.Debug.assertNever(t,"Unknown entity name kind.")}return e.Debug.assert(!(1&e.getCheckFlags(o)),"Should never get an instantiated symbol here."),o.flags&n||r?o:Nn(o)}}function Mn(t,n){return Fn(t,n,e.Diagnostics.Cannot_find_module_0)}function Fn(e,t,n,i){if(void 0===i&&(i=!1),9===t.kind||13===t.kind){var r=t;return Bn(e,r.text,n,r,i)}}function Bn(t,i,r,s,o){if(void 0===o&&(o=!1),void 0!==i){if(e.startsWith(i,"@types/"))tn(s,e.Diagnostics.Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1,e.removePrefix(i,"@types/"),i);var a=Es(i,!0);if(a)return a;var l=e.getResolvedModule(e.getSourceFileOfNode(t),i),c=l&&e.getResolutionDiagnostic(x,l),u=l&&!c&&n.getSourceFile(l.resolvedFileName);if(u)return u.symbol?Wn(u.symbol):void(r&&tn(s,e.Diagnostics.File_0_is_not_a_module,u.fileName));if(Te){var d=e.findBestPatternMatch(Te,function(e){return e.pattern},i);if(d)return Wn(d.symbol)}if(l&&!e.extensionIsTypeScript(l.extension)&&void 0===c||c===e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type){if(o)tn(s,e.Diagnostics.Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augmented,i,l.resolvedFileName);else if(N&&r){var p=l.isExternalLibraryImport?e.chainDiagnosticMessages(void 0,e.Diagnostics.Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_module_0,i):void 0;p=e.chainDiagnosticMessages(p,e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type,i,l.resolvedFileName),Nt.add(e.createDiagnosticForNodeFromMessageChain(s,p))}}else if(r)if(c)tn(s,c,i,l.resolvedFileName);else{var h=e.tryExtractTypeScriptExtension(i);if(h)tn(s,e.Diagnostics.An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead,h,e.removeExtension(i,h));else tn(s,r,i)}}}function $n(e,t){return e&&Wn(An(e.exports.get("export="),t))||e}function Un(t,n,i){var r=$n(t,i);return i||!r||1539&r.flags||tn(n,e.Diagnostics.Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct,yi(t)),r}function Vn(e){return void 0!==e.exports.get("export=")}function Hn(e){return ks(Kn(e))}function Gn(e,t){var n=Kn(t);if(n)return n.get(e)}function jn(e){return 1536&e.flags?Kn(e):e.exports||T}function Kn(t){var n=un(t);return n.resolvedExports||(n.resolvedExports=function(t){var n=[];return t=$n(t),i(t)||T;function i(t){if(t&&1952&t.flags&&e.pushIfUnique(n,t)){var r=e.cloneMap(t.exports),s=t.exports.get("__export");if(s){for(var o=e.createSymbolTable(),a=e.createMap(),l=0,c=s.declarations;l<c.length;l++){var u=c[l];zn(o,i(Mn(u,u.moduleSpecifier)),a,u)}a.forEach(function(t,n){var i=t.exportsWithDuplicate;if("export="!==n&&i&&i.length&&!r.has(n))for(var s=0,o=i;s<o.length;s++){var l=o[s];Nt.add(e.createDiagnosticForNode(l,e.Diagnostics.Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambiguity,a.get(n).specifierText,e.unescapeLeadingUnderscores(n)))}}),zn(r,o)}return r}}}(t))}function zn(t,n,i,r){n&&n.forEach(function(n,s){if("default"!==s){var o=t.get(s);if(o){if(i&&r&&o&&An(o)!==An(n)){var a=i.get(s);a.exportsWithDuplicate?a.exportsWithDuplicate.push(r):a.exportsWithDuplicate=[r]}}else t.set(s,n),i&&r&&i.set(s,{specifierText:e.getTextOfNode(r.moduleSpecifier)})}})}function Wn(e){var t;return e&&e.mergeId&&(t=yt[e.mergeId])?t:e}function qn(e){return Wn(e.symbol)}function Jn(e){return Wn(e.parent)}function Yn(e){return e&&1048576&e.flags?Wn(e.exportSymbol):e}function Xn(e){return!!(107455&e.flags||2097152&e.flags&&107455&Nn(e).flags)}function Zn(t){for(var n=0,i=t.members;n<i.length;n++){var r=i[n];if(152===r.kind&&e.nodeIsPresent(r.body))return r}}function Qn(e){var t=new m(B,e);return _++,t.id=_,t}function ei(e,t){var n=Qn(e);return n.intrinsicName=t,n}function ti(e,t){var n=Qn(32768);return n.objectFlags=e,n.symbol=t,n}function ni(e){return 95===e.charCodeAt(0)&&95===e.charCodeAt(1)&&95!==e.charCodeAt(2)&&64!==e.charCodeAt(2)}function ii(t){var n;return t.forEach(function(e,t){ni(t)||(n||(n=[]),Xn(e)&&n.push(e))}),n||e.emptyArray}function ri(e,t,n,i,r,s){return e.members=t,e.properties=ii(t),e.callSignatures=n,e.constructSignatures=i,r&&(e.stringIndexInfo=r),s&&(e.numberIndexInfo=s),e}function si(e,t,n,i,r,s){return ri(ti(16,e),t,n,i,r,s)}function oi(t,n){for(var i,r=t;r;r=r.parent){if(r.locals&&!hn(r)&&(i=n(r.locals)))return i;switch(r.kind){case 265:if(!e.isExternalOrCommonJsModule(r))break;case 233:if(i=n(qn(r).exports))return i}}return n(ot)}function ai(e){return 107455===e?107455:1920}function li(t,n,i,r){if(t&&!function(e){if(e.declarations&&e.declarations.length){for(var t=0,n=e.declarations;t<n.length;t++){switch(n[t].kind){case 149:case 151:case 153:case 154:continue;default:return!1}}return!0}return!1}(t)){var s=[];return oi(n,o)}function o(c){if(e.pushIfUnique(s,c)){var u=function(s){if(l(s.get(t.escapedName)))return[t];return e.forEachEntry(s,function(t){if(2097152&t.flags&&"export="!==t.escapedName&&!e.getDeclarationOfKind(t,246)&&!(function(t){return t&&t.declarations&&t.declarations[0]&&e.isNamespaceExportDeclaration(t.declarations[0])}(t)&&n&&e.isExternalModule(e.getSourceFileOfNode(n)))&&(!r||e.some(t.declarations,e.isExternalModuleImportEqualsDeclaration))){var s=Nn(t);if(l(t,s))return[t];var c=s.exports?o(s.exports):void 0;if(c&&a(t,ai(i)))return[t].concat(c)}})}(c);return s.pop(),u}}function a(e,t){return!ci(e,n,t)||!!li(e.parent,n,ai(t),r)}function l(n,r){return t===(r||n)&&!e.some(n.declarations,pi)&&a(n,i)}}function ci(t,n,i){var r=!1;return oi(n,function(n){var s=n.get(t.escapedName);return!!s&&(s===t||!!((s=2097152&s.flags&&!e.getDeclarationOfKind(s,246)?Nn(s):s).flags&i)&&(r=!0,!0))}),r}function ui(e,t){return 0===di(e,t,793064,!1).accessibility}function di(t,n,i,r){if(t&&n&&!(262144&t.flags)){for(var s=t,o=i;t;){var a=li(t,n,o,!1);if(a){var l=hi(a[0],r);return l||{accessibility:1,errorSymbolName:yi(s,n,i),errorModuleName:t!==s?yi(t,n,1920):void 0}}o=ai(i),t=Jn(t)}var c=e.forEach(s.declarations,u);if(c)if(c!==u(n))return{accessibility:2,errorSymbolName:yi(s,n,i),errorModuleName:yi(c)};return{accessibility:1,errorSymbolName:yi(s,n,i)}}return{accessibility:0};function u(t){var n=e.findAncestor(t,pi);return n&&qn(n)}}function pi(t){return e.isAmbientModule(t)||265===t.kind&&e.isExternalOrCommonJsModule(t)}function hi(t,n){var i;if(!e.forEach(t.declarations,function(t){return!function(t){if(!Ai(t)){var r=xn(t);return!(!r||e.hasModifier(r,1)||!Ai(r.parent))&&(n&&(dn(t).isVisible=!0,i=e.appendIfUnique(i,r)),!0)}return!0}(t)}))return{accessibility:0,aliasesToMakeVisible:i}}function fi(t,n){var i;i=162===t.parent.kind||e.isExpressionWithTypeArgumentsInClassExtendsClause(t.parent)?1156031:143===t.kind||179===t.kind||237===t.parent.kind?1920:793064;var r=Jh(t),s=gn(n,r.escapedText,i,void 0,void 0,!1);return s&&hi(s,!0)||{accessibility:1,errorSymbolName:e.getTextOfNode(r),errorNode:r}}function mi(t,n){t.writeKeyword(e.tokenToString(n))}function gi(t,n){t.writePunctuation(e.tokenToString(n))}function _i(e){e.writeSpace(" ")}function yi(t,n,i){return e.usingSingleLineStringWriter(function(e){Ii().buildSymbolDisplay(t,e,n,i)})}function bi(t,n,i,r){return e.usingSingleLineStringWriter(function(e){Ii().buildSignatureDisplay(t,e,n,i,r)})}function vi(t,n,i){var r=R.typeToTypeNode(t,n,function(t){var n=e.NodeBuilderFlags.None;if(!t)return n;8&t&&(n|=e.NodeBuilderFlags.NoTruncation);256&t&&(n|=e.NodeBuilderFlags.UseFullyQualifiedType);4096&t&&(n|=e.NodeBuilderFlags.SuppressAnyReturnType);1&t&&(n|=e.NodeBuilderFlags.WriteArrayAsGenericType);64&t&&(n|=e.NodeBuilderFlags.WriteTypeArgumentsOfSignature);return n}(i)|e.NodeBuilderFlags.IgnoreErrors|e.NodeBuilderFlags.WriteTypeParametersInQualifiedName);e.Debug.assert(void 0!==r,"should always get typenode");var s=e.createTextWriter(""),o=e.createPrinter({removeComments:!0}),a=n&&e.getSourceFileOfNode(n);o.writeNode(4,r,a,s);var l=s.getText(),c=x.noErrorTruncation||8&i?void 0:100;return c&&l.length>=c?l.substr(0,c-3)+"...":l}function Ti(t,n,i){return e.usingSingleLineStringWriter(function(e){Ii().buildTypePredicateDisplay(t,e,n,i)})}function ki(e){for(var t=[],n=0,i=0;i<e.length;i++){var r=e[i];if(n|=r.flags,!(6144&r.flags)){if(384&r.flags){var s=128&r.flags?re:kr(r);if(65536&s.flags){var o=s.types.length;if(i+o<=e.length&&e[i+o-1]===s.types[o-1]){t.push(s),i+=o-1;continue}}}t.push(r)}}return 4096&n&&t.push(Z),2048&n&&t.push(Y),t||e}function xi(e){return 8===e?"private":16===e?"protected":"public"}function Ei(t){if(t.symbol&&2048&t.symbol.flags){var n=e.findAncestor(t.symbol.declarations[0].parent,function(e){return 168!==e.kind});if(231===n.kind)return qn(n)}}function Si(t){return t&&t.parent&&234===t.parent.kind&&e.isExternalModuleAugmentation(t.parent.parent)}function Ci(t){return 32&t.flags?'"'+e.escapeString(t.value)+'"':""+t.value}function wi(t,n){if(t.declarations&&t.declarations.length){var i=t.declarations[0],r=e.getNameOfDeclaration(i);if(r)return e.declarationNameToString(r);if(i.parent&&226===i.parent.kind)return e.declarationNameToString(i.parent.name);switch(!n||n.encounteredError||n.flags&e.NodeBuilderFlags.AllowAnonymousIdentifier||(n.encounteredError=!0),i.kind){case 199:return"(Anonymous class)";case 186:case 187:return"(Anonymous function)"}}if(t.syntheticLiteralTypeOrigin){var s=t.syntheticLiteralTypeOrigin.value;if(!e.isIdentifierText(s,x.target))return'"'+e.escapeString(s,34)+'"'}return e.symbolName(t)}function Ii(){function t(e,t){t.writeSymbol(wi(e),e)}function n(n,i,s,o,a,l){var c;function u(n){if(c){if(1&a)if(1&e.getCheckFlags(n))d(ur(2097152&c.flags?Nn(c):c),n.mapper,i,s);else r(c,i,s);!function(t,n){var i=wi(t),r=i.charCodeAt(0);e.isIdentifierStart(r,E)?(gi(n,23),n.writeSymbol(i,t)):(gi(n,21),e.isSingleOrDoubleQuote(r)?n.writeStringLiteral(i):n.writeSymbol(i,t),gi(n,22))}(n,i)}else t(n,i);c=n}i.trackSymbol(n,s,o),262144&n.flags||!s&&!(256&l)?u(n):function t(n,i,r){var o=li(n,s,i,!!(2&a));if(!o||ci(o[0],s,1===o.length?i:ai(i))){var l=Jn(o?o[0]:n);l&&t(l,ai(i),!1)}if(o)for(var d=0,p=o;d<p.length;d++)u(p[d]);else!r&&(!c&&e.forEach(n.declarations,pi)||6144&n.flags)||u(n)}(n,o,!0)}function i(i,r,s,o,a){var l=16416&o,c=!1;return u(i,o);function u(i,a){var l=-1025&a;if(16793231&i.flags)r.writeKeyword(32&o||!Fi(i)?i.intrinsicName:"any");else if(16384&i.flags&&i.isThisType)c&&r.reportInaccessibleThisError(),r.writeKeyword("this");else if(4&pn(i))!function(t,n){var i=t.typeArguments||e.emptyArray;if(t.target!==Ee||1&n)if(8&t.target.objectFlags)gi(r,21),d(t.typeArguments.slice(0,qs(t)),26),gi(r,22);else if(16384&n&&t.symbol.valueDeclaration&&199===t.symbol.valueDeclaration.kind)h(t,n);else{var s=t.target.outerTypeParameters,o=0;if(s)for(var a=s.length;o<a;){var l=o,c=Gs(s[o]);do{o++}while(o<a&&Gs(s[o])===c);e.rangeEquals(s,i,l,o)||(p(c,i,l,o,n),gi(r,23))}var f=(t.target.typeParameters||e.emptyArray).length;p(t.symbol,i,o,f,n)}else u(i[0],32896),gi(r,21),gi(r,22)}(i,l);else if(256&i.flags&&!(65536&i.flags)){var f=Jn(i.symbol);n(f,r,s,793064,0,l),Cr(f)!==i&&(gi(r,23),t(i.symbol,r))}else if(3&pn(i)||16656&i.flags)n(i.symbol,r,s,793064,0,l);else if(1024&a||!i.aliasSymbol||!(65536&a||ui(i.aliasSymbol,s)))196608&i.flags?function(e,t){128&t&&gi(r,19);65536&e.flags?d(ki(e.types),49):d(e.types,48);128&t&&gi(r,20)}(i,l):48&pn(i)?h(i,l):96&i.flags?r.writeStringLiteral(Ci(i)):262144&i.flags?(128&a&&gi(r,19),r.writeKeyword("keyof"),_i(r),u(i.type,128),128&a&&gi(r,20)):524288&i.flags?(u(i.objectType,128),gi(r,21),u(i.indexType,0),gi(r,22)):(gi(r,17),_i(r),gi(r,24),_i(r),gi(r,18));else{var m=i.aliasTypeArguments;p(i.aliasSymbol,m,0,e.length(m),l)}}function d(e,t){for(var n=0;n<e.length;n++)n>0&&(26!==t&&_i(r),gi(r,t),_i(r)),u(e[n],26===t?0:128)}function p(e,t,i,o,a){if((32&e.flags||!ni(e.escapedName))&&n(e,r,s,793064,0,a),i<o){for(gi(r,27),u(t[i],512),i++;i<o;)gi(r,26),_i(r),u(t[i],0),i++;gi(r,29)}}function h(t,i){var o=t.symbol;if(o)if(32&o.flags&&!er(o)&&!(199===o.valueDeclaration.kind&&16384&i)||896&o.flags)f(t,i);else if(function(){var t=!!(8192&o.flags)&&e.some(o.declarations,function(t){return e.hasModifier(t,32)}),n=!!(16&o.flags)&&(o.parent||e.some(o.declarations,function(e){return 265===e.parent.kind||234===e.parent.kind}));if(t||n)return!!(4&i)||e.contains(a,o)}())f(t,i);else if(e.contains(a,o)){var l=Ei(t);l?n(l,r,s,793064,0,i):mi(r,119)}else{a||(a=[]),16&t.objectFlags&&t.symbol&&32&t.symbol.flags?y(t,i):(a.push(o),y(t,i),a.pop())}else y(t,i)}function f(e,t){32768&t&&gi(r,19),mi(r,103),_i(r),n(e.symbol,r,s,107455,0,t),32768&t&&gi(r,20)}function _(e){Yd(e)&&(mi(r,131),_i(r)),n(e,r),16777216&e.flags&&gi(r,55)}function y(n,i){if(Xr(n))!function(e){gi(r,17),r.writeLine(),r.increaseIndent(),e.declaration.readonlyToken&&(mi(r,131),_i(r));gi(r,21),t(qr(e).symbol,r),_i(r),mi(r,92),_i(r),u(Jr(e),0),gi(r,22),e.declaration.questionToken&&gi(r,55);gi(r,56),_i(r),u(Yr(e),0),gi(r,25),r.writeLine(),r.decreaseIndent(),gi(r,18)}(n);else{var d=Zr(n);if(!d.properties.length&&!d.stringIndexInfo&&!d.numberIndexInfo){if(!d.callSignatures.length&&!d.constructSignatures.length)return gi(r,17),void gi(r,18);if(1===d.callSignatures.length&&!d.constructSignatures.length){var p=function(e,t){if(128&t)return!0;if(512&t){var n=e.target&&64&t?e.target.typeParameters:e.typeParameters;return n&&0!==n.length}return!1}(d.callSignatures[0],i);return p&&gi(r,19),m(d.callSignatures[0],r,s,16|l,void 0,a),void(p&&gi(r,20))}if(1===d.constructSignatures.length&&!d.callSignatures.length)return 128&i&&gi(r,19),mi(r,94),_i(r),m(d.constructSignatures[0],r,s,16|l,void 0,a),void(128&i&&gi(r,20))}var h=c;c=!0,gi(r,17),r.writeLine(),r.increaseIndent(),function(t){for(var n=0,i=t.callSignatures;n<i.length;n++){m(T=i[n],r,s,l,void 0,a),gi(r,25),r.writeLine()}for(var c=0,d=t.constructSignatures;c<d.length;c++){m(T=d[c],r,s,l,1,a),gi(r,25),r.writeLine()}g(t.stringIndexInfo,r,0,s,o,a),g(t.numberIndexInfo,r,1,s,o,a);for(var p=0,h=t.properties;p<h.length;p++){var f=h[p];if(16384&o){if(4194304&f.flags)continue;24&e.getDeclarationModifierFlagsFromSymbol(f)&&r.reportPrivateInBaseOfClassExpression(e.symbolName(f))}var y=nr(f);if(8208&f.flags&&!Qr(y).length)for(var b=0,v=gs(y,0);b<v.length;b++){var T=v[b];_(f),m(T,r,s,l,void 0,a),gi(r,25),r.writeLine()}else _(f),gi(r,56),_i(r),u(y,16384&o),gi(r,25),r.writeLine()}}(d),r.decreaseIndent(),gi(r,18),c=h}}}function r(e,t,n,i){var r=Vh(e);(32&r.flags||64&r.flags||524288&r.flags)&&c(cr(e),t,n,i)}function s(e,n,r,s,o){t(e.symbol,n);var a=ns(e);a&&(_i(n),mi(n,85),_i(n),i(a,n,r,s,o));var l=ls(e);l&&(_i(n),gi(n,58),_i(n),i(l,n,r,s,o))}function o(n,r,s,o,l){var c=n.valueDeclaration;(c?e.isRestParameter(c):rn(n)&&n.isRestParameter)&&gi(r,24),c&&e.isBindingPattern(c.name)?a(c.name,r,s,o,l):t(n,r),c&&Ss(c)&&gi(r,55),gi(r,56),_i(r);var u=nr(n);c&&Rf(c)&&(u=gl(u,2048)),i(u,r,s,o,l)}function a(e,t,n,i,r){if(174===e.kind)gi(t,17),u(e.elements,t,function(e){return l(e,t,n,i,r)}),gi(t,18);else if(175===e.kind){gi(t,21);var s=e.elements;u(s,t,function(e){return l(e,t,n,i,r)}),s&&s.hasTrailingComma&&gi(t,26),gi(t,22)}}function l(n,i,r,s,o){e.isOmittedExpression(n)||(e.Debug.assert(176===n.kind),n.propertyName&&(i.writeProperty(e.getTextOfNode(n.propertyName)),gi(i,56),_i(i)),e.isBindingPattern(n.name)?a(n.name,i,r,s,o):(n.dotDotDotToken&&gi(i,24),t(n.symbol,i)))}function c(e,t,n,i,r){e&&e.length&&(gi(t,27),u(e,t,function(e){return s(e,t,n,i,r)}),gi(t,29))}function u(e,t,n){for(var i=0;i<e.length;i++)i>0&&(gi(t,26),_i(t)),n(e[i])}function d(e,t,n,r){if(e&&e.length){gi(n,27);for(var s=512,o=0;o<e.length;o++)o>0&&(gi(n,26),_i(n),s=0),i(t(e[o]),n,r,s);gi(n,29)}}function p(e,t,n,i,r,s){gi(n,19),e&&o(e,n,i,r,s);for(var a=0;a<t.length;a++)(a>0||e)&&(gi(n,26),_i(n)),o(t[a],n,i,r,s);gi(n,20)}function h(t,n,r,s,o){e.isIdentifierTypePredicate(t)?n.writeParameter(t.parameterName):mi(n,99),_i(n),mi(n,126),_i(n),i(t.type,n,r,s,o)}function f(e,t,n,r,s){var o=Ds(e);4096&r&&Fi(o)||(16&r?(_i(t),gi(t,36)):gi(t,56),_i(t),e.typePredicate?h(e.typePredicate,t,n,r,s):i(o,t,n,r,s))}function m(e,t,n,i,r,s){1===r&&(mi(t,94),_i(t)),e.target&&64&i?d(e.target.typeParameters,e.mapper,t,n):c(e.typeParameters,t,n,i,s),p(e.thisParameter,e.parameters,t,n,i,s),f(e,t,n,i,s)}function g(t,n,r,s,o,a){if(t){switch(t.isReadonly&&(mi(n,131),_i(n)),gi(n,21),n.writeParameter(t.declaration?e.declarationNameToString(t.declaration.parameters[0].name):"x"),gi(n,56),_i(n),r){case 1:mi(n,133);break;case 0:mi(n,136)}gi(n,22),gi(n,56),_i(n),i(t.type,n,s,o,a),gi(n,25),n.writeLine()}}return Pt||(Pt={buildSymbolDisplay:n,buildTypeDisplay:i,buildTypeParameterDisplay:s,buildTypePredicateDisplay:h,buildParameterDisplay:o,buildDisplayForParametersAndDelimiters:p,buildDisplayForTypeParametersAndDelimiters:c,buildTypeParameterDisplayFromSymbol:r,buildSignatureDisplay:m,buildIndexSignatureDisplay:g,buildReturnTypeDisplay:f})}function Ai(t){if(t){var n=dn(t);return void 0===n.isVisible&&(n.isVisible=!!function(){switch(t.kind){case 176:return Ai(t.parent.parent);case 226:if(e.isBindingPattern(t.name)&&!t.name.elements.length)return!1;case 233:case 229:case 230:case 231:case 228:case 232:case 237:if(e.isExternalModuleAugmentation(t))return!0;var n=Pi(t);return 1&e.getCombinedModifierFlags(t)||237!==t.kind&&265!==n.kind&&e.isInAmbientContext(n)?Ai(n):hn(n);case 149:case 148:case 153:case 154:case 151:case 150:if(e.hasModifier(t,24))return!1;case 152:case 156:case 155:case 157:case 146:case 234:case 160:case 161:case 163:case 159:case 164:case 165:case 166:case 167:case 168:return Ai(t.parent);case 239:case 240:case 242:return!1;case 145:case 265:case 236:return!0;default:return!1}}()),n.isVisible}return!1}function Ni(t){var n;t.parent&&243===t.parent.kind?n=gn(t.parent,t.escapedText,2998271,e.Diagnostics.Cannot_find_name_0,t,!1):246===t.parent.kind&&(n=Cn(t.parent,2998271));var i=[];return n&&function t(n){e.forEach(n,function(n){dn(n).isVisible=!0;var r=xn(n)||n;if(e.pushIfUnique(i,r),e.isInternalModuleImportEqualsDeclaration(n)){var s=gn(n,Jh(n.moduleReference).escapedText,901119,void 0,void 0,!1);s&&t(s.declarations)}})}(n.declarations),i}function Di(e,t){var n=Oi(e,t);if(n>=0){for(var i=ht.length,r=n;r<i;r++)ft[r]=!1;return!1}return ht.push(e),ft.push(!0),mt.push(t),!0}function Oi(e,t){for(var n=ht.length-1;n>=0;n--){if(Ri(ht[n],mt[n]))return-1;if(ht[n]===e&&mt[n]===t)return n}return-1}function Ri(t,n){return 0===n?un(t).type:2===n?un(t).declaredType:1===n?t.resolvedBaseConstructorType:3===n?t.resolvedReturnType:void e.Debug.fail("Unhandled TypeSystemPropertyName "+n)}function Li(){return ht.pop(),mt.pop(),ft.pop()}function Pi(t){return(t=e.findAncestor(e.getRootDeclaration(t),function(e){switch(e.kind){case 226:case 227:case 242:case 241:case 240:case 239:return!1;default:return!0}}))&&t.parent}function Mi(e,t){var n=fs(e,t);return n?nr(n):void 0}function Fi(e){return e&&!!(1&e.flags)}function Bi(e){var t=qn(e);return t&&un(t).type||Ki(e,!1)}function $i(t){return 144===t.kind&&!e.isStringOrNumericLiteral(t.expression)}function Ui(t,n,i){if(8192&(t=mc(t,function(e){return!(6144&e.flags)})).flags)return ue;if(65536&t.flags)return gc(t,function(e){return Ui(e,n,i)});for(var r=e.createSymbolTable(),s=e.createUnderscoreEscapedMap(),o=0,a=n;o<a.length;o++){var l=a[o];s.set(e.getTextOfPropertyName(l),!0)}for(var c=0,u=ts(t);c<u.length;c++){var d=u[c],p=s.has(d.escapedName),h=24&e.getDeclarationModifierFlagsFromSymbol(d),f=65536&d.flags&&!(32768&d.flags);p||h||ta(d)||f||r.set(d.escapedName,d)}var m=bs(t,0),g=bs(t,1);return si(i,r,e.emptyArray,e.emptyArray,m,g)}function Vi(t){var n,i=t.parent,r=Bi(i.parent);if(r===J)return J;if(!r)return t.initializer?gp(t):r;if(Fi(r))return r;if(174===i.kind)if(t.dotDotDotToken){if(!bu(r))return tn(t,e.Diagnostics.Rest_types_may_only_be_created_from_object_types),J;for(var s=[],o=0,a=i.elements;o<a.length;o++){var l=a[o];l.dotDotDotToken||s.push(l.propertyName||l.name)}n=Ui(r,s,t.symbol)}else{var c=t.propertyName||t.name;if($i(c))return W;var u=e.getTextOfPropertyName(c),d=Mi(r,u);if(!(n=d&&Nc(t,d)||mu(u)&&vs(r,1)||vs(r,0)))return tn(c,e.Diagnostics.Type_0_has_no_property_1_and_no_string_index_signature,vi(r),e.declarationNameToString(c)),J}else{var p=Ch(r,i,!1,!1);if(t.dotDotDotToken)n=So(p);else{var h=""+e.indexOf(i.elements,t);if(!(n=sl(r)?Mi(r,h):p))return ul(r)?tn(t,e.Diagnostics.Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2,vi(r),qs(r),i.elements.length):tn(t,e.Diagnostics.Type_0_has_no_property_1,vi(r),h),J}}return!I||!t.initializer||2048&pl(fp(t.initializer))||(n=Zl(n,131072)),t.initializer?Po([n,fp(t.initializer)],!0):n}function Hi(t){var n=e.getJSDocType(t);if(n)return aa(n)}function Gi(t){var n=e.skipParentheses(t);return 177===n.kind&&0===n.elements.length}function ji(e,t){return I&&t?gl(e,2048):e}function Ki(t,n){if(215===t.parent.parent.kind){var i=Vo(Uu(t.parent.parent.expression));return 278528&i.flags?i:ee}if(216===t.parent.parent.kind){var r=t.parent.parent;return Sh(r.expression,r.awaitModifier)||W}if(e.isBindingPattern(t.parent))return Vi(t);var s,o,a=e.getEffectiveTypeAnnotationNode(t);if(a)return ji(aa(a),t.questionToken&&n);if((N||e.isInJavaScriptFile(t))&&226===t.kind&&!e.isBindingPattern(t.name)&&!(1&e.getCombinedModifierFlags(t))&&!e.isInAmbientContext(t)){if(!(2&e.getCombinedNodeFlags(t)||t.initializer&&(s=t.initializer,o=e.skipParentheses(s),95!==o.kind&&(71!==o.kind||Ul(o)!==L))))return q;if(t.initializer&&Gi(t.initializer))return Oe}if(146===t.kind){var l=t.parent;if(154===l.kind&&!e.hasDynamicName(l)){var c=e.getDeclarationOfKind(t.parent.symbol,153);if(c){var u=Is(c),d=dm(l);return d&&t===d?(e.Debug.assert(!d.type),nr(u.thisParameter)):Ds(u)}}var p=void 0;if(p="this"===t.symbol.escapedName?Jc(l):Yc(t))return ji(p,t.questionToken&&n)}return t.initializer?ji(p=gp(t),t.questionToken&&n):e.isJsxAttribute(t)?ne:262===t.kind?Bc(t.name):e.isBindingPattern(t.name)?Wi(t.name,!1,!0):void 0}function zi(t,n,i){return t.initializer?gp(t):e.isBindingPattern(t.name)?Wi(t.name,n,i):(i&&N&&!Ji(t)&&Sl(t,W),W)}function Wi(t,n,i){return 174===t.kind?function(t,n,i){var r,s=e.createSymbolTable(),o=!1;e.forEach(t.elements,function(t){var a=t.propertyName||t.name;if($i(a))o=!0;else if(t.dotDotDotToken)r=Us(W,!1);else{var l=e.getTextOfPropertyName(a),c=nn(4|(t.initializer?16777216:0),l);c.type=zi(t,n,i),c.bindingElement=t,s.set(c.escapedName,c)}});var a=si(void 0,s,e.emptyArray,e.emptyArray,r,void 0);return n&&(a.pattern=t),o&&(a.objectFlags|=512),a}(t,n,i):function(t,n,i){var r=t.elements,s=e.lastOrUndefined(r);if(0===r.length||!e.isOmittedExpression(s)&&s.dotDotDotToken)return E>=2?xo(W):De;var o=e.map(r,function(t){return e.isOmittedExpression(t)?W:zi(t,n,i)}),a=wo(o);return n&&((a=Ws(a)).pattern=t),a}(t,n,i)}function qi(e,t){var n=Ki(e,!0);return n?(t&&Cl(e,n),261===e.kind?n:xl(n)):(n=e.dotDotDotToken?De:W,t&&N&&(Ji(e)||Sl(e,n)),n)}function Ji(t){var n=e.getRootDeclaration(t);return Bp(146===n.kind?n.parent:n)}function Yi(t){var n,i=un(t);if(!i.type){if(4194304&t.flags)return i.type=(n=Cr(Jn(t))).typeParameters?zs(n,e.map(n.typeParameters,function(e){return W})):n;var r=t.valueDeclaration;if(e.isCatchClauseVariableDeclarationOrBindingElement(r))return i.type=W;if(243===r.kind)return i.type=xp(r.expression);if(e.isInJavaScriptFile(r)&&e.isJSDocPropertyLikeTag(r)&&r.typeExpression)return i.type=aa(r.typeExpression.type);if(!Di(t,0))return J;var s=void 0;s=194===r.kind||179===r.kind&&194===r.parent.kind?function(t){for(var n,i=[],r=!1,s=!1,o=0,a=t.declarations;o<a.length;o++){var l=a[o],c=194===l.kind?l:179===l.kind?e.getAncestor(l,194):void 0;if(!c)return J;e.isPropertyAccessExpression(c.left)&&99===c.left.expression.kind&&(152===e.getThisContainer(c,!1).kind?r=!0:s=!0);var u=Hi(c.parent);if(u){var d=xl(u);if(n){if(n!==J&&d!==J&&!Ea(n,d)){var p=e.getNameOfDeclaration(l);tn(p,e.Diagnostics.Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2,e.declarationNameToString(p),vi(n),vi(d))}}else n=d}else n||i.push(cl(fp(c.right)))}return xl(ji(n||Po(i,!0),s&&!r))}(t):qi(r,!0),Li()||(s=tr(t)),i.type=s}return i.type}function Xi(t){if(t){if(153===t.kind){var n=e.getEffectiveReturnTypeNode(t);return n&&aa(n)}var i=e.getEffectiveSetAccessorTypeAnnotationNode(t);return i&&aa(i)}}function Zi(e){return Ns(Is(e))}function Qi(t){var n=un(t);if(!n.type){var i=e.getDeclarationOfKind(t,153),r=e.getDeclarationOfKind(t,154);if(i&&e.isInJavaScriptFile(i)){var s=Hi(i);if(s)return n.type=s}if(!Di(t,0))return J;var o=void 0,a=Xi(i);if(a)o=a;else{var l=Xi(r);l?o=l:i&&i.body?o=Hd(i):(N&&(r?tn(r,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation,yi(t)):(e.Debug.assert(!!i,"there must existed getter as we are current checking either setter or getter in this function"),tn(i,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation,yi(t)))),o=W)}if(!Li())if(o=W,N)tn(e.getDeclarationOfKind(t,153),e.Diagnostics._0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions,yi(t));n.type=o}return n.type}function er(e){var t=gr(br(e));return 540672&t.flags?t:void 0}function tr(t){return e.getEffectiveTypeAnnotationNode(t.valueDeclaration)?(tn(t.valueDeclaration,e.Diagnostics._0_is_referenced_directly_or_indirectly_in_its_own_type_annotation,yi(t)),J):(N&&tn(t.valueDeclaration,e.Diagnostics._0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or_indirectly_in_its_own_initializer,yi(t)),W)}function nr(t){return 1&e.getCheckFlags(t)?function(t){var n=un(t);if(!n.type)if(100===v)tn(t.valueDeclaration,e.Diagnostics.Generic_type_instantiation_is_excessively_deep_and_possibly_infinite),n.type=J;else{if(!Di(t,0))return J;v++;var i=ya(nr(n.target),n.mapper);v--,Li()||(i=tr(t)),n.type=i}return n.type}(t):7&t.flags?Yi(t):9136&t.flags?function(t){var n=un(t);if(!n.type)if(1536&t.flags&&e.isShorthandAmbientModuleSymbol(t))n.type=W;else{var i=ti(16,t);if(32&t.flags){var r=er(t);n.type=r?$o([i,r]):i}else n.type=I&&16777216&t.flags?gl(i,2048):i}return n.type}(t):8&t.flags?function(e){var t=un(e);return t.type||(t.type=Er(e)),t.type}(t):98304&t.flags?Qi(t):2097152&t.flags?function(e){var t=un(e);if(!t.type){var n=Nn(e);t.type=107455&n.flags?nr(n):J}return t.type}(t):J}function ir(e,t){return void 0!==e&&void 0!==t&&!!(4&pn(e))&&e.target===t}function rr(e){return 4&pn(e)?e.target:e}function sr(t,n){return function t(i){if(7&pn(i)){var r=rr(i);return r===n||e.forEach(_r(r),t)}if(131072&i.flags)return e.forEach(i.types,t)}(t)}function or(t,n){for(var i=0,r=n;i<r.length;i++){var s=Sr(qn(r[i]));t=e.appendIfUnique(t,s)}return t}function ar(t,n){for(;;){if(!(t=t.parent))return;switch(t.kind){case 229:case 199:case 230:case 155:case 156:case 150:case 160:case 161:case 273:case 228:case 151:case 186:case 187:case 231:case 282:case 172:var i=ar(t,n);if(172===t.kind)return e.append(i,Sr(qn(t.typeParameter)));var r=or(i,e.getEffectiveTypeParameterDeclarations(t)||e.emptyArray),s=n&&(229===t.kind||199===t.kind||230===t.kind)&&br(qn(t)).thisType;return s?e.append(r,s):r}}}function lr(t){return ar(32&t.flags?t.valueDeclaration:e.getDeclarationOfKind(t,230))}function cr(e){for(var t,n=0,i=e.declarations;n<i.length;n++){var r=i[n];if(230===r.kind||229===r.kind||199===r.kind||231===r.kind){var s=r;s.typeParameters&&(t=or(t,s.typeParameters))}}return t}function ur(t){return e.concatenate(lr(t),cr(t))}function dr(e){var t=gs(e,1);if(1===t.length){var n=t[0];return!n.typeParameters&&1===n.parameters.length&&n.hasRestParameter&&Pd(n.parameters[0])===De}return!1}function pr(e){if(yr(e)&&gs(e,1).length>0)return!0;if(540672&e.flags){var t=rs(e);return t&&yr(t)&&dr(t)}return!1}function hr(t){var n=t.symbol.valueDeclaration;if(e.isInJavaScriptFile(n)){var i=e.getJSDocAugmentsTag(n);if(i)return i.class}return e.getClassExtendsHeritageClauseElement(n)}function fr(t,n,i){var r=e.length(n),s=e.isInJavaScriptFile(i);return e.filter(gs(t,1),function(t){return(s||r>=Cs(t.typeParameters))&&r<=e.length(t.typeParameters)})}function mr(t,n,i){var r=fr(t,n,i),s=e.map(n,aa);return e.sameMap(r,function(t){return e.some(t.typeParameters)?Rs(t,s,e.isInJavaScriptFile(i)):t})}function gr(t){if(!t.resolvedBaseConstructorType){var n=t.symbol.valueDeclaration,i=e.getClassExtendsHeritageClauseElement(n),r=hr(t);if(!r)return t.resolvedBaseConstructorType=Y;if(!Di(t,1))return J;var s=xp(r.expression);if(i&&r!==i&&(e.Debug.assert(!i.typeArguments),xp(i.expression)),163840&s.flags&&Zr(s),!Li())return tn(t.symbol.valueDeclaration,e.Diagnostics._0_is_referenced_directly_or_indirectly_in_its_own_base_expression,yi(t.symbol)),t.resolvedBaseConstructorType=J;if(!(1&s.flags||s===Q||pr(s)))return tn(r.expression,e.Diagnostics.Type_0_is_not_a_constructor_function_type,vi(s)),t.resolvedBaseConstructorType=J;t.resolvedBaseConstructorType=s}return t.resolvedBaseConstructorType}function _r(t){return t.resolvedBaseTypes||(8&t.objectFlags?t.resolvedBaseTypes=[So(Po(t.typeParameters))]:96&t.symbol.flags?(32&t.symbol.flags&&function(t){t.resolvedBaseTypes=e.emptyArray;var n=us(gr(t));if(!(163841&n.flags))return;var i,r=hr(t),s=no(r),o=n&&n.symbol?Cr(n.symbol):void 0;if(n.symbol&&32&n.symbol.flags&&function(e){var t=e.outerTypeParameters;if(t){var n=t.length-1,i=e.typeArguments;return t[n].symbol!==i[n].symbol}return!0}(o))i=Js(r,n.symbol,s);else if(1&n.flags)i=n;else{var a=mr(n,r.typeArguments,r);if(!a.length)return void tn(r.expression,e.Diagnostics.No_base_constructor_has_the_specified_number_of_type_arguments);i=Ds(a[0])}if(i===J)return;if(!yr(i))return void tn(r.expression,e.Diagnostics.Base_constructor_return_type_0_is_not_a_class_or_interface_type,vi(i));if(t===i||sr(i,t))return void tn(t.symbol.valueDeclaration,e.Diagnostics.Type_0_recursively_references_itself_as_a_base_type,vi(t,void 0,1));t.resolvedBaseTypes=[i]}(t),64&t.symbol.flags&&function(t){t.resolvedBaseTypes=t.resolvedBaseTypes||e.emptyArray;for(var n=0,i=t.symbol.declarations;n<i.length;n++){var r=i[n];if(230===r.kind&&e.getInterfaceBaseTypeNodes(r))for(var s=0,o=e.getInterfaceBaseTypeNodes(r);s<o.length;s++){var a=o[s],l=aa(a);l!==J&&(yr(l)?t===l||sr(l,t)?tn(r,e.Diagnostics.Type_0_recursively_references_itself_as_a_base_type,vi(t,void 0,1)):t.resolvedBaseTypes===e.emptyArray?t.resolvedBaseTypes=[l]:t.resolvedBaseTypes.push(l):tn(a,e.Diagnostics.An_interface_may_only_extend_a_class_or_another_interface))}}}(t)):e.Debug.fail("type must be class or interface")),t.resolvedBaseTypes}function yr(t){return 16809985&t.flags&&!Xr(t)||131072&t.flags&&!e.forEach(t.types,function(e){return!yr(e)})}function br(t){var n=un(t);if(!n.declaredType){var i=32&t.flags?1:2,r=n.declaredType=ti(i,t),s=lr(t),o=cr(t);(s||o||1===i||!function(t){for(var n=0,i=t.declarations;n<i.length;n++){var r=i[n];if(230===r.kind){if(64&r.flags)return!1;var s=e.getInterfaceBaseTypeNodes(r);if(s)for(var o=0,a=s;o<a.length;o++){var l=a[o];if(e.isEntityNameExpression(l.expression)){var c=Pn(l.expression,793064,!0);if(!c||!(64&c.flags)||br(c).thisType)return!1}}}}return!0}(t))&&(r.objectFlags|=4,r.typeParameters=e.concatenate(s,o),r.outerTypeParameters=s,r.localTypeParameters=o,r.instantiations=e.createMap(),r.instantiations.set(js(r.typeParameters),r),r.target=r,r.typeArguments=r.typeParameters,r.thisType=Qn(16384),r.thisType.isThisType=!0,r.thisType.symbol=t,r.thisType.constraint=r)}return n.declaredType}function vr(t){var n=t.initializer;if(!n)return!e.isInAmbientContext(t);switch(n.kind){case 9:case 8:return!0;case 192:return 38===n.operator&&8===n.operand.kind;case 71:return e.nodeIsMissing(n)||!!qn(t.parent).exports.get(n.escapedText);default:return!1}}function Tr(e){var t=un(e);if(void 0!==t.enumKind)return t.enumKind;for(var n=!1,i=0,r=e.declarations;i<r.length;i++){var s=r[i];if(232===s.kind)for(var o=0,a=s.members;o<a.length;o++){var l=a[o];if(l.initializer&&9===l.initializer.kind)return t.enumKind=1;vr(l)||(n=!0)}}return t.enumKind=n?0:1}function kr(e){return 256&e.flags&&!(65536&e.flags)?Cr(Jn(e.symbol)):e}function xr(e){var t=un(e);if(t.declaredType)return t.declaredType;if(1===Tr(e)){b++;for(var n=[],i=0,r=e.declarations;i<r.length;i++){var s=r[i];if(232===s.kind)for(var o=0,a=s.members;o<a.length;o++){var l=a[o],c=sa(Mf(l),b,qn(l));un(qn(l)).declaredType=c,n.push(c)}}if(n.length){var u=Po(n,!1,e,void 0);return 65536&u.flags&&(u.flags|=256,u.symbol=e),t.declaredType=u}}var d=Qn(16);return d.symbol=e,t.declaredType=d}function Er(e){var t=un(e);if(!t.declaredType){var n=xr(Jn(e));t.declaredType||(t.declaredType=n)}return t.declaredType}function Sr(e){var t=un(e);if(!t.declaredType){var n=Qn(16384);n.symbol=e,t.declaredType=n}return t.declaredType}function Cr(e){return wr(e)||J}function wr(t){return 96&t.flags?br(t):524288&t.flags?function(t){var n=un(t);if(!n.declaredType){if(!Di(t,2))return J;var i=e.find(t.declarations,function(e){return 283===e.kind||231===e.kind}),r=283===i.kind?i.typeExpression:i.type,s=r?aa(r):J;if(Li()){var o=cr(t);o&&(n.typeParameters=o,n.instantiations=e.createMap(),n.instantiations.set(js(o),s))}else s=J,tn(i.name,e.Diagnostics.Type_alias_0_circularly_references_itself,yi(t));n.declaredType=s}return n.declaredType}(t):262144&t.flags?Sr(t):384&t.flags?xr(t):8&t.flags?Er(t):2097152&t.flags?function(e){var t=un(e);return t.declaredType||(t.declaredType=Cr(Nn(e))),t.declaredType}(t):void 0}function Ir(e){switch(e.kind){case 119:case 136:case 133:case 122:case 137:case 134:case 105:case 139:case 95:case 130:case 173:return!0;case 164:return Ir(e.elementType);case 159:return function(e){if(e.typeArguments)for(var t=0,n=e.typeArguments;t<n.length;t++)if(!Ir(n[t]))return!1;return!0}(e)}return!1}function Ar(t){var n=e.getEffectiveTypeAnnotationNode(t);return n?Ir(n):!t.initializer}function Nr(t){if(t.declarations&&1===t.declarations.length){var n=t.declarations[0];if(n)switch(n.kind){case 149:case 148:return Ar(n);case 151:case 150:case 152:return function(t){if(152!==t.kind){var n=e.getEffectiveReturnTypeNode(t);if(!n||!Ir(n))return!1}for(var i=0,r=t.parameters;i<r.length;i++)if(!Ar(r[i]))return!1;return!0}(n)}}return!1}function Dr(t,n,i){for(var r=e.createSymbolTable(),s=0,o=t;s<o.length;s++){var a=o[s];r.set(a.escapedName,i&&Nr(a)?a:ma(a,n))}return r}function Or(e,t){for(var n=0,i=t;n<i.length;n++){var r=i[n];e.has(r.escapedName)||e.set(r.escapedName,r)}}function Rr(e){if(!e.declaredProperties){var t=e.symbol;e.declaredProperties=ii(t.members),e.declaredCallSignatures=As(t.members.get("__call")),e.declaredConstructSignatures=As(t.members.get("__new")),e.declaredStringIndexInfo=Vs(t,0),e.declaredNumberIndexInfo=Vs(t,1)}return e}function Lr(t,n){if(4&pn(t)){var i=t.target,r=t.typeArguments;if(e.length(i.typeParameters)===e.length(r))return zs(i,e.concatenate(r,[n||i.thisType]))}else if(131072&t.flags)return $o(e.map(t.types,function(e){return Lr(e,n)}));return t}function Pr(t,n,i,r){var s,o,a,l,c,u;e.rangeEquals(i,r,0,i.length)?(s=k,o=n.symbol?n.symbol.members:e.createSymbolTable(n.declaredProperties),a=n.declaredCallSignatures,l=n.declaredConstructSignatures,c=n.declaredStringIndexInfo,u=n.declaredNumberIndexInfo):(s=da(i,r),o=Dr(n.declaredProperties,s,1===i.length),a=ua(n.declaredCallSignatures,s),l=ua(n.declaredConstructSignatures,s),c=ba(n.declaredStringIndexInfo,s),u=ba(n.declaredNumberIndexInfo,s));var d=_r(n);if(d.length){n.symbol&&o===n.symbol.members&&(o=e.createSymbolTable(n.declaredProperties));for(var p=e.lastOrUndefined(r),h=0,f=d;h<f.length;h++){var m=f[h],g=p?Lr(ya(m,s),p):m;Or(o,ts(g)),a=e.concatenate(a,gs(g,0)),l=e.concatenate(l,gs(g,1)),c||(c=g===W?Us(W,!1):bs(g,0)),u=u||bs(g,1)}}ri(t,o,a,l,c,u)}function Mr(e,t,n,i,r,s,o,a,l){var c=new g(B);return c.declaration=e,c.typeParameters=t,c.parameters=i,c.thisParameter=n,c.resolvedReturnType=r,c.typePredicate=s,c.minArgumentCount=o,c.hasRestParameter=a,c.hasLiteralTypes=l,c}function Fr(e){return Mr(e.declaration,e.typeParameters,e.thisParameter,e.parameters,e.resolvedReturnType,e.typePredicate,e.minArgumentCount,e.hasRestParameter,e.hasLiteralTypes)}function Br(e,t,n,i,r){for(var s=0,o=e;s<o.length;s++){var a=o[s];if(el(a,t,n,i,r,Sa))return a}}function $r(t,n,i){if(n.typeParameters){if(i>0)return;for(var r=1;r<t.length;r++)if(!Br(t[r],n,!1,!1,!1))return;return[n]}var s=void 0;for(r=0;r<t.length;r++){var o=r===i?n:Br(t[r],n,!0,!0,!0);if(!o)return;s=e.appendIfUnique(s,o)}return s}function Ur(t,n){for(var i=e.map(t,function(e){return gs(e,n)}),r=void 0,s=0;s<i.length;s++)for(var o=0,a=i[s];o<a.length;o++){var l=a[o];if(!r||!Br(r,l,!1,!0,!0)){var c=$r(i,l,s);if(c){var u=l;if(c.length>1){if(u=Fr(l),e.forEach(c,function(e){return e.thisParameter})){var d=Po(e.map(c,function(e){return nr(e.thisParameter)||W}),!0);u.thisParameter=bl(l.thisParameter,d)}u.resolvedReturnType=void 0,u.unionSignatures=c}(r||(r=[])).push(u)}}}return r||e.emptyArray}function Vr(e,t){for(var n=[],i=!1,r=0,s=e;r<s.length;r++){var o=bs(s[r],t);if(!o)return;n.push(o.type),i=i||o.isReadonly}return Us(Po(n,!0),i)}function Hr(e,t){return e?t?$o([e,t]):e:t}function Gr(e,t){return e?t?Us($o([e.type,t.type]),e.isReadonly&&t.isReadonly):e:t}function jr(e,t){return e&&t&&Us(Po([e.type,t.type]),e.isReadonly||t.isReadonly)}function Kr(t){for(var n,i,r=e.emptyArray,s=e.emptyArray,o=t.types,a=e.countWhere(o,dr),l=function(l){var c=t.types[l];if(0===a||a===o.length&&0===l||!dr(c)){var u=gs(c,1);u.length&&a>0&&(u=e.map(u,function(e){var t=Fr(e);return t.resolvedReturnType=function(e,t,n){for(var i=[],r=0;r<t.length;r++)r===n?i.push(e):dr(t[r])&&i.push(Ds(gs(t[r],1)[0]));return $o(i)}(Ds(e),o,l),t})),s=e.concatenate(s,u)}r=e.concatenate(r,gs(c,0)),n=Gr(n,bs(c,0)),i=Gr(i,bs(c,1))},c=0;c<o.length;c++)l(c);ri(t,T,r,s,n,i)}function zr(t){var n=t.symbol;if(t.target)ri(t,s=Dr(Qr(t.target),t.mapper,!1),i=ua(gs(t.target,0),t.mapper),r=ua(gs(t.target,1),t.mapper),o=ba(bs(t.target,0),t.mapper),l=ba(bs(t.target,1),t.mapper));else if(2048&n.flags){var i=As((s=n.members).get("__call")),r=As(s.get("__new"));ri(t,s,i,r,o=Vs(n,0),l=Vs(n,1))}else{var s=T,o=void 0;if(n.exports&&(s=jn(n)),32&n.flags){var a=gr(c=br(n));704512&a.flags?Or(s=e.createSymbolTable(ii(s)),ts(a)):a===W&&(o=Us(W,!1))}var l=384&n.flags?rt:void 0;if(ri(t,s,e.emptyArray,e.emptyArray,o,l),8208&n.flags&&(t.callSignatures=As(n)),32&n.flags){var c=br(n);(r=As(n.members.get("__constructor"))).length||(r=function(t){var n=gs(gr(t),1);if(0===n.length)return[Mr(void 0,t.localTypeParameters,void 0,e.emptyArray,t,void 0,0,!1,!1)];for(var i=hr(t),r=e.isInJavaScriptFile(i),s=no(i),o=e.length(s),a=[],l=0,c=n;l<c.length;l++){var u=c[l],d=Cs(u.typeParameters),p=e.length(u.typeParameters);if((r||o>=d)&&o<=p){var h=p?Ls(u,ws(s,u.typeParameters,d,r)):Fr(u);h.typeParameters=t.localTypeParameters,h.resolvedReturnType=t,a.push(h)}}return a}(c)),t.constructSignatures=r}}}function Wr(t){var n,i=e.createSymbolTable();ri(t,T,e.emptyArray,e.emptyArray,void 0,void 0);var r=qr(t),s=Jr(t),o=Yr(t),a=us(function(e){if(!e.modifiersType){var t=e.declaration.typeParameter.constraint;if(170===t.kind)e.modifiersType=ya(aa(t.type),e.mapper||k);else{var n=Jr(Jo(e.declaration)),i=n&&16384&n.flags?ns(n):n;e.modifiersType=i&&262144&i.flags?ya(i.type,e.mapper||k):ue}}return e.modifiersType}(t)),l=!!t.declaration.readonlyToken,c=!!t.declaration.questionToken;if(170===t.declaration.typeParameter.constraint.kind){for(var u=0,d=ts(a);u<d.length;u++){var p=d[u];f(Uo(p),p)}(1&a.flags||bs(a,0))&&f(ee)}else{var h=540672&s.flags?us(s):s;fc(262144&h.flags?Vo(us(h.type)):h,f)}function f(s,u){var d;"object"==typeof u&&(d=u);var p=da([r],[s]),h=t.mapper?pa(t.mapper,p):p,f=ya(o,h);if(32&s.flags){var m=e.escapeLeadingUnderscores(s.value),g=fs(a,m),_=nn(4|(c||!!(g&&16777216&g.flags)?16777216:0),m);_.checkFlags=l||g&&Yd(g)?8:0,_.type=f,d&&(_.syntheticOrigin=d,_.declarations=d.declarations),_.syntheticLiteralTypeOrigin=s,i.set(m,_)}else 3&s.flags&&(n=Us(f,l))}ri(t,i,e.emptyArray,e.emptyArray,n,void 0)}function qr(e){return e.typeParameter||(e.typeParameter=Sr(qn(e.declaration.typeParameter)))}function Jr(e){return e.constraintType||(e.constraintType=ya(ns(qr(e)),e.mapper||k)||J)}function Yr(e){return e.templateType||(e.templateType=e.declaration.type?ya(ji(aa(e.declaration.type),!!e.declaration.questionToken),e.mapper||k):J)}function Xr(e){return 32&pn(e)&&jo(Jr(e))}function Zr(t){return t.members||(32768&t.flags?4&t.objectFlags?function(t){var n=Rr(t.target),i=e.concatenate(n.typeParameters,[n.thisType]);Pr(t,n,i,t.typeArguments&&t.typeArguments.length===i.length?t.typeArguments:e.concatenate(t.typeArguments,[t]))}(t):3&t.objectFlags?function(t){Pr(t,Rr(t),e.emptyArray,e.emptyArray)}(t):16&t.objectFlags?zr(t):32&t.objectFlags&&Wr(t):65536&t.flags?function(e){var t=Ur(e.types,0),n=Ur(e.types,1),i=Vr(e.types,0),r=Vr(e.types,1);ri(e,T,t,n,i,r)}(t):131072&t.flags&&Kr(t)),t}function Qr(t){return 32768&t.flags?Zr(t).properties:e.emptyArray}function es(e,t){if(32768&e.flags){var n=Zr(e).members.get(t);if(n&&Xn(n))return n}}function ts(t){return 196608&(t=us(t)).flags?function(t){if(!t.resolvedProperties){for(var n=e.createSymbolTable(),i=0,r=t.types;i<r.length;i++){for(var s=0,o=ts(r[i]);s<o.length;s++){var a=o[s];if(!n.has(a.escapedName)){var l=hs(t,a.escapedName);l&&n.set(a.escapedName,l)}}if(65536&t.flags)break}t.resolvedProperties=ii(n)}return t.resolvedProperties}(t):Qr(t)}function ns(e){return ss(e)?Hs(e):void 0}function is(e){var t=zo(e);if(t)return t;var n=rs(e.objectType),i=rs(e.indexType);return n||i?Wo(n||e.objectType,i||e.indexType):void 0}function rs(e){if(737280&e.flags){var t=os(e);if(t!==me&&t!==ge)return t}else if(262144&e.flags)return ee}function ss(e){return os(e)!==ge}function os(t){var n,i;if(!t.resolvedBaseConstraint){n=[];var r=s(t);t.resolvedBaseConstraint=i?ge:Lr(r||me,t)}return t.resolvedBaseConstraint;function s(t){if(!e.contains(n,t)){n.push(t);var r=function(e){if(16384&e.flags){var t=Hs(e);return e.isThisType?t:t?s(t):void 0}if(196608&e.flags){for(var n=e.types,i=[],r=0,o=n;r<o.length;r++){var a=s(o[r]);a&&i.push(a)}return 65536&e.flags&&i.length===n.length?Po(i):131072&e.flags&&i.length?$o(i):void 0}if(262144&e.flags)return ee;if(524288&e.flags){var l=zo(e);if(l)return s(l);var c=s(e.objectType),u=s(e.indexType),d=c&&u?Wo(c,u):void 0;return d&&d!==J?s(d):void 0}if(Xr(e))return ue;return e}(t);return n.pop(),r}i=!0}}function as(t){if(t.default)t.default===_e&&(t.default=ge);else if(t.target){var n=as(t.target);t.default=n?ya(n,t.mapper):me}else{t.default=_e;var i=t.symbol&&e.forEach(t.symbol.declarations,function(t){return e.isTypeParameterDeclaration(t)&&t.default}),r=i?aa(i):me;t.default===_e&&(t.default=r)}return t.default}function ls(e){var t=as(e);return t!==me&&t!==ge?t:void 0}function cs(t){return!(!t.symbol||!e.forEach(t.symbol.declarations,function(t){return e.isTypeParameterDeclaration(t)&&t.default}))}function us(e){var t=540672&e.flags?rs(e)||ue:e;return 131072&t.flags?function(e){return e.resolvedApparentType||(e.resolvedApparentType=Lr(e,e))}(t):262178&t.flags?Ce:84&t.flags?we:136&t.flags?Ie:512&t.flags?lo(E>=2):16777216&t.flags?ue:t}function ds(t,n){for(var i,r=t.types,s=65536&t.flags,o=s?24:0,a=s?0:16777216,l=4,c=0,u=0,d=r;u<d.length;u++){if((b=us(d[u]))!==J){var p=(y=fs(b,n))?e.getDeclarationModifierFlagsFromSymbol(y):0;!y||p&o?s&&(c|=16):(a&=y.flags,i=e.appendIfUnique(i,y),c|=(Yd(y)?8:0)|(24&p?0:64)|(16&p?128:0)|(8&p?256:0)|(32&p?512:0),Bu(y)||(l=2))}}if(i){if(1===i.length&&!(16&c))return i[0];for(var h=[],f=[],m=void 0,g=0,_=i;g<_.length;g++){var y;(y=_[g]).declarations&&e.addRange(f,y.declarations);var b=nr(y);m?b!==m&&(c|=32):m=b,h.push(b)}var v=nn(4|a,n);return v.checkFlags=l|c,v.containingType=t,v.declarations=f,v.type=s?Po(h):$o(h),v}}function ps(t,n){var i=t.propertyCache||(t.propertyCache=e.createSymbolTable()),r=i.get(n);return r||(r=ds(t,n))&&i.set(n,r),r}function hs(t,n){var i=ps(t,n);return!i||16&e.getCheckFlags(i)?void 0:i}function fs(e,t){if(32768&(e=us(e)).flags){var n=Zr(e),i=n.members.get(t);if(i&&Xn(i))return i;if(n===fe||n.callSignatures.length||n.constructSignatures.length){var r=es(xe,t);if(r)return r}return es(ke,t)}if(196608&e.flags)return hs(e,t)}function ms(t,n){if(229376&t.flags){var i=Zr(t);return 0===n?i.callSignatures:i.constructSignatures}return e.emptyArray}function gs(e,t){return ms(us(e),t)}function _s(e,t){if(229376&e.flags){var n=Zr(e);return 0===t?n.stringIndexInfo:n.numberIndexInfo}}function ys(e,t){var n=_s(e,t);return n&&n.type}function bs(e,t){return _s(us(e),t)}function vs(e,t){return ys(us(e),t)}function Ts(e,t){if(yl(e)){for(var n=[],i=0,r=ts(e);i<r.length;i++){var s=r[i];(0===t||mu(s.escapedName))&&n.push(nr(s))}if(n.length)return Po(n,!0)}}function ks(e){var t=[];return e.forEach(function(e,n){ni(n)||t.push(e)}),t}function xs(t){if(e.isInJavaScriptFile(t)){if(t.type&&272===t.type.kind)return!0;var n=e.getJSDocParameterTags(t);if(n)for(var i=0,r=n;i<r.length;i++){var s=r[i];if(s.isBracketed)return!0;if(s.typeExpression)return 272===s.typeExpression.type.kind}}}function Es(t,n){if(!e.isExternalModuleNameRelative(t)){var i=fn(ot,'"'+t+'"',512);return i&&n?Wn(i):i}}function Ss(t){if(e.hasQuestionToken(t)||xs(t))return!0;if(t.initializer){var n=t.parent,i=Is(n),r=e.indexOf(n.parameters,t);return e.Debug.assert(r>=0),r>=i.minArgumentCount}var s=e.getImmediatelyInvokedFunctionExpression(t.parent);return!!s&&(!t.type&&!t.dotDotDotToken&&e.indexOf(t.parent.parameters,t)>=s.arguments.length)}function Cs(e){var t=0;if(e)for(var n=0;n<e.length;n++)cs(e[n])||(t=n+1);return t}function ws(t,n,i,r){var s=e.length(n);if(s){var o=e.length(t);if((r||o>=i)&&o<=s){t||(t=[]);for(var a=o;a<s;a++)t[a]=Bl(r);for(a=o;a<s;a++){var l=da(n,t),c=ls(n[a]);t[a]=c?ya(c,l):Bl(r)}}}return t}function Is(t){var n,i,r,s=dn(t);if(!s.resolvedSignature){for(var o=[],a=!1,l=0,c=void 0,u=void 0,d=e.getImmediatelyInvokedFunctionExpression(t),p=e.isJSDocConstructSignature(t),h=!d&&!p&&e.isInJavaScriptFile(t)&&!e.hasJSDocParameterTags(t),f=p?1:0;f<t.parameters.length;f++){var m=t.parameters[f],g=m.symbol;if(g&&4&g.flags&&!e.isBindingPattern(m.name))g=gn(m,g.escapedName,107455,void 0,void 0,!1);0===f&&"this"===g.escapedName?(u=!0,c=m.symbol):o.push(g),m.type&&173===m.type.kind&&(a=!0),m.initializer||m.questionToken||m.dotDotDotToken||d&&o.length>d.arguments.length&&!m.type||xs(m)||h||(l=o.length)}if(!(153!==t.kind&&154!==t.kind||e.hasDynamicName(t)||u&&c)){var _=153===t.kind?154:153,y=e.getDeclarationOfKind(t.symbol,_);y&&(c=(r=dm(y))&&r.symbol)}var b=152===t.kind?br(Wn(t.parent.symbol)):void 0,v=b?b.localTypeParameters:function(t){var n;return e.forEach(e.getEffectiveTypeParameterDeclarations(t),function(t){var i=Sr(t.symbol);n=e.appendIfUnique(n,i)}),n}(t),T=function(t,n,i){if(n)return aa(t.parameters[0].type);if(i)return i;var r=e.getEffectiveReturnTypeNode(t);if(r)return aa(r);if(153===t.kind&&!e.hasDynamicName(t)){return Xi(e.getDeclarationOfKind(t.symbol,154))}if(e.nodeIsMissing(t.body))return W}(t,p,b),k=t.type&&158===t.type.kind?(n=t.type,71===(i=n.parameterName).kind?{kind:1,parameterName:i?i.escapedText:void 0,parameterIndex:i?Cp(n.parent.parameters,i):void 0,type:aa(n.type)}:{kind:0,type:aa(n.type)}):void 0,x=e.hasRestParameter(t);if(!x&&e.isInJavaScriptFile(t)&&function(t){var n=dn(t);void 0===n.containsArgumentsReference&&(8192&n.flags?n.containsArgumentsReference=!0:n.containsArgumentsReference=i(t.body));return n.containsArgumentsReference;function i(t){if(!t)return!1;switch(t.kind){case 71:return"arguments"===t.escapedText&&e.isPartOfExpression(t);case 149:case 151:case 153:case 154:return 144===t.name.kind&&i(t.name);default:return!e.nodeStartsNewLexicalEnvironment(t)&&!e.isPartOfTypeNode(t)&&e.forEachChild(t,i)}}}(t)){x=!0;var E=nn(3,"args");E.type=De,E.isRestParameter=!0,o.push(E)}s.resolvedSignature=Mr(t,v,c,o,T,k,l,x,a)}return s.resolvedSignature}function As(t){if(!t)return e.emptyArray;for(var n=[],i=0;i<t.declarations.length;i++){var r=t.declarations[i];switch(r.kind){case 160:case 161:case 228:case 151:case 150:case 152:case 155:case 156:case 157:case 153:case 154:case 186:case 187:case 273:if(i>0&&r.body){var s=t.declarations[i-1];if(r.parent===s.parent&&r.kind===s.kind&&r.pos===s.end)break}n.push(Is(r))}}return n}function Ns(e){if(e.thisParameter)return nr(e.thisParameter)}function Ds(t){if(!t.resolvedReturnType){if(!Di(t,3))return J;var n=void 0;if(n=t.target?ya(Ds(t.target),t.mapper):t.unionSignatures?Po(e.map(t.unionSignatures,Ds),!0):Hd(t.declaration),!Li()&&(n=W,N)){var i=t.declaration,r=e.getNameOfDeclaration(i);r?tn(r,e.Diagnostics._0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions,e.declarationNameToString(r)):tn(i,e.Diagnostics.Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions)}t.resolvedReturnType=n}return t.resolvedReturnType}function Os(t){if(t.hasRestParameter){var n=nr(e.lastOrUndefined(t.parameters));if(4&pn(n)&&n.target===Ee)return n.typeArguments[0]}return W}function Rs(t,n,i){n=ws(n,t.typeParameters,Cs(t.typeParameters),i);var r=t.instantiations||(t.instantiations=e.createMap()),s=js(n),o=r.get(s);return o||r.set(s,o=Ls(t,n)),o}function Ls(e,t){return fa(e,da(e.typeParameters,t),!0)}function Ps(e){return e.typeParameters?e.erasedSignatureCache||(e.erasedSignatureCache=function(e){return fa(e,(t=e.typeParameters,da(t,void 0)),!0);var t}(e)):e}function Ms(t){return t.typeParameters?t.canonicalSignatureCache||(t.canonicalSignatureCache=function(t){return Rs(t,e.map(t.typeParameters,function(e){return e.target&&!ns(e.target)?e.target:e}),e.isInJavaScriptFile(t.declaration))}(t)):t}function Fs(t){if(!t.isolatedSignatureType){var n=152===t.declaration.kind||156===t.declaration.kind,i=ti(16);i.members=T,i.properties=e.emptyArray,i.callSignatures=n?e.emptyArray:[t],i.constructSignatures=n?[t]:e.emptyArray,t.isolatedSignatureType=i}return t.isolatedSignatureType}function Bs(e){return e.members.get("__index")}function $s(e,t){var n=1===t?133:136,i=Bs(e);if(i)for(var r=0,s=i.declarations;r<s.length;r++){var o=s[r];if(1===o.parameters.length){var a=o.parameters[0];if(a&&a.type&&a.type.kind===n)return o}}}function Us(e,t,n){return{type:e,isReadonly:t,declaration:n}}function Vs(t,n){var i=$s(t,n);if(i)return Us(i.type?aa(i.type):W,e.hasModifier(i,64),i)}function Hs(t){if(!t.constraint)if(t.target){var n=ns(t.target);t.constraint=n?ya(n,t.mapper):me}else{var i=function(t){return t.symbol&&e.getDeclarationOfKind(t.symbol,145).constraint}(t);t.constraint=i?aa(i):me}return t.constraint===me?void 0:t.constraint}function Gs(t){return qn(e.getDeclarationOfKind(t.symbol,145).parent)}function js(e){var t="";if(e)for(var n=e.length,i=0;i<n;){for(var r=e[i].id,s=1;i+s<n&&e[i+s].id===r+s;)s++;t.length&&(t+=","),t+=r,s>1&&(t+=":"+s),i+=s}return t}function Ks(e,t){for(var n=0,i=0,r=e;i<r.length;i++){var s=r[i];s.flags&t||(n|=s.flags)}return 14680064&n}function zs(e,t){var n=js(t),i=e.instantiations.get(n);return i||(i=ti(4,e.symbol),e.instantiations.set(n,i),i.flags|=t?Ks(t,0):0,i.target=e,i.typeArguments=t),i}function Ws(e){var t=Qn(e.flags);return t.symbol=e.symbol,t.objectFlags=e.objectFlags,t.target=e.target,t.typeArguments=e.typeArguments,t}function qs(t){return e.length(t.target.typeParameters)}function Js(t,n,i){var r=Cr(Wn(n)),s=r.localTypeParameters;if(s){var o=e.length(t.typeArguments),a=Cs(s),l=e.isInJavaScriptFile(t);return!l&&(o<a||o>s.length)?(tn(t,a===s.length?e.Diagnostics.Generic_type_0_requires_1_type_argument_s:e.Diagnostics.Generic_type_0_requires_between_1_and_2_type_arguments,vi(r,void 0,1),a,s.length),J):zs(r,e.concatenate(r.outerTypeParameters,ws(i,s,a,l)))}return t.typeArguments?(tn(t,e.Diagnostics.Type_0_is_not_generic,vi(r)),J):r}function Ys(t,n,i){var r=Cr(n),s=un(n).typeParameters;if(s){var o=e.length(t.typeArguments),a=Cs(s);return o<a||o>s.length?(tn(t,a===s.length?e.Diagnostics.Generic_type_0_requires_1_type_argument_s:e.Diagnostics.Generic_type_0_requires_between_1_and_2_type_arguments,yi(n),a,s.length),J):function(t,n){var i=Cr(t),r=un(t),s=r.typeParameters,o=js(n),a=r.instantiations.get(o);return a||r.instantiations.set(o,a=ya(i,da(s,ws(n,s,Cs(s),e.isInJavaScriptFile(t.valueDeclaration))))),a}(n,i)}return t.typeArguments?(tn(t,e.Diagnostics.Type_0_is_not_generic,yi(n)),J):r}function Xs(t){switch(t.kind){case 159:return t.typeName;case 201:var n=t.expression;if(e.isEntityNameExpression(n))return n}}function Zs(e,t){return e&&Pn(e,t)||K}function Qs(t,n,i){return 96&n.flags?Js(t,n,i):524288&n.flags?Ys(t,n,i):16&n.flags&&eo(t)&&(n.members||e.getJSDocClassTag(n.valueDeclaration))?Ad(n):void 0}function eo(e){return 1048576&e.flags&&159===e.kind}function to(t){var n=dn(t);if(!n.resolvedType){var i=void 0,r=void 0,s=793064;eo(t)&&(r=function(t){if(e.isIdentifier(t.typeName)){if("Object"===t.typeName.escapedText){if(e.isJSDocIndexSignature(t)){var n=aa(t.typeArguments[0]),i=Us(aa(t.typeArguments[1]),!1);return si(void 0,T,e.emptyArray,e.emptyArray,n===ee&&i,n===te&&i)}return W}switch(t.typeName.escapedText){case"String":return ee;case"Number":return te;case"Boolean":return re;case"Void":return oe;case"Undefined":return Y;case"Null":return Z;case"Function":case"function":return xe;case"Array":case"array":return t.typeArguments&&t.typeArguments.length?void 0:De;case"Promise":case"promise":return t.typeArguments&&t.typeArguments.length?void 0:Ud(W)}}}(t),s|=107455),r||(r=function(t,n){var i=no(t);if(n===K)return J;var r=Qs(t,n,i);if(r)return r;var s=wr(n);if(void 0!==s)return i?(tn(t,e.Diagnostics.Type_0_is_not_generic,yi(n)),J):s;if(!(107455&n.flags&&eo(t)))return J;var o=nr(n);if(o.symbol&&!Nd(o)){var a=Qs(t,o.symbol,i);if(a)return a}return Zs(Xs(t),793064),o}(t,i=Zs(Xs(t),s))),n.resolvedSymbol=i,n.resolvedType=r}return n.resolvedType}function no(t){return e.map(t.typeArguments,aa)}function io(e){var t=dn(e);return t.resolvedType||(t.resolvedType=xl(xp(e.exprName))),t.resolvedType}function ro(t,n){function i(e){for(var t=0,n=e.declarations;t<n.length;t++){var i=n[t];switch(i.kind){case 229:case 230:case 232:return i}}}if(!t)return n?he:ue;var r=Cr(t);return 32768&r.flags?e.length(r.typeParameters)!==n?(tn(i(t),e.Diagnostics.Global_type_0_must_have_1_type_parameter_s,e.symbolName(t),n),n?he:ue):r:(tn(i(t),e.Diagnostics.Global_type_0_must_be_a_class_or_interface_type,e.symbolName(t)),n?he:ue)}function so(t,n){return oo(t,107455,n?e.Diagnostics.Cannot_find_global_value_0:void 0)}function oo(e,t,n){return gn(void 0,e,t,n,e,!1)}function ao(t,n,i){var r=function(t,n){return oo(t,793064,n?e.Diagnostics.Cannot_find_global_type_0:void 0)}(t,i);return r||i?ro(r,n):void 0}function lo(e){return Pe||(Pe=ao("Symbol",0,e))||ue}function co(e){return Fe||(Fe=ao("Promise",1,e))||he}function uo(e){return Be||(Be=so("Promise",e))}function po(e){return Ge||(Ge=ao("AsyncIterable",1,e))||he}function ho(e){return je||(je=ao("AsyncIterator",1,e))||he}function fo(e){return Ke||(Ke=ao("AsyncIterableIterator",1,e))||he}function mo(e){return Ue||(Ue=ao("Iterable",1,e))||he}function go(e){return Ve||(Ve=ao("Iterator",1,e))||he}function _o(e){return He||(He=ao("IterableIterator",1,e))||he}function yo(e,t){void 0===t&&(t=0);var n=oo(e,793064,void 0);return n&&ro(n,t)}function bo(e,t){var n=oo(e,1920,void 0),i=n&&fn(n.exports,t,793064);return i&&Cr(i)}function vo(e,t){return e!==he?zs(e,t):ue}function To(e){return vo(Me||(Me=ao("TypedPropertyDescriptor",1,!0))||he,[e])}function ko(e){return vo(fo(!0),[e])}function xo(e){return vo(mo(!0),[e])}function Eo(e){return vo(_o(!0),[e])}function So(e){return vo(Ee,[e])}function Co(t){return $[t]||($[t]=function(t){for(var n=[],i=[],r=0;r<t;r++){var s=Qn(16384);n.push(s);var o=nn(4,""+r);o.type=s,i.push(o)}var a=ti(12);return a.typeParameters=n,a.outerTypeParameters=void 0,a.localTypeParameters=n,a.instantiations=e.createMap(),a.instantiations.set(js(a.typeParameters),a),a.target=a,a.typeArguments=a.typeParameters,a.thisType=Qn(16384),a.thisType.isThisType=!0,a.thisType.constraint=a,a.declaredProperties=i,a.declaredCallSignatures=e.emptyArray,a.declaredConstructSignatures=e.emptyArray,a.declaredStringIndexInfo=void 0,a.declaredNumberIndexInfo=void 0,a}(t))}function wo(e){return zs(Co(e.length),e)}function Io(e,t){for(var n=0,i=e.length-1,r=t.id;n<=i;){var s=n+(i-n>>1),o=e[s].id;if(o===r)return s;o>r?i=s-1:n=s+1}return~n}function Ao(e,t){return Io(e,t)>=0}function No(e,t){var n=t.flags;if(65536&n)Do(e,t.types);else if(1&n)e.containsAny=!0;else if(!I&&6144&n)2048&n&&(e.containsUndefined=!0),4096&n&&(e.containsNull=!0),2097152&n||(e.containsNonWideningType=!0);else if(!(8192&n||131072&n&&function(e){for(var t=0,n=0,i=e.types;n<i.length;n++){var r=i[n];if(6368&r.flags&&6368&t)return!0;if(6144&(t|=r.flags)&&16809984&t)return!0}return!1}(t))){2&n&&(e.containsString=!0),4&n&&(e.containsNumber=!0),96&n&&(e.containsStringOrNumberLiteral=!0);var i=e.length,r=i&&t.id>e[i-1].id?~i:Io(e,t);r<0&&(32768&n&&16&t.objectFlags&&t.symbol&&8208&t.symbol.flags&&Oo(e,t)||e.splice(~r,0,t))}}function Do(e,t){for(var n=0,i=t;n<i.length;n++){No(e,i[n])}}function Oo(e,t){for(var n=0,i=e;n<i.length;n++){if(Ea(i[n],t))return!0}return!1}function Ro(e,t){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e!==r&&wa(e,r))return!0}return!1}function Lo(t){if(0!==t.length&&!function(e){var t=e[0];if(256&t.flags){for(var n=Jn(t.symbol),i=1;i<e.length;i++){var r=e[i];if(!(256&r.flags)||n!==Jn(r.symbol))return!1}return!0}return!1}(t))for(var n=t.length;n>0;)Ro(t[--n],t)&&e.orderedRemoveItemAt(t,n)}function Po(t,n,i,r){if(0===t.length)return ae;if(1===t.length)return t[0];var s=[];return Do(s,t),s.containsAny?W:(n?Lo(s):s.containsStringOrNumberLiteral&&function(t){for(var n=t.length;n>0;){var i=t[--n];(32&i.flags&&t.containsString||64&i.flags&&t.containsNumber||96&i.flags&&1048576&i.flags&&Ao(t,i.regularType))&&e.orderedRemoveItemAt(t,n)}}(s),0===s.length?s.containsNull?s.containsNonWideningType?Z:Q:s.containsUndefined?s.containsNonWideningType?Y:X:ae:Mo(s,i,r))}function Mo(e,t,n){if(0===e.length)return ae;if(1===e.length)return e[0];var i=js(e),r=U.get(i);r||(r=Qn(65536|Ks(e,6144)),U.set(i,r),r.types=e,r.aliasSymbol=t,r.aliasTypeArguments=n);return r}function Fo(t,n){131072&n.flags?Bo(t,n.types):1&n.flags?t.containsAny=!0:8192&n.flags?t.containsNever=!0:16&pn(n)&&Ma(n)?t.containsEmptyObject=!0:!I&&6144&n.flags||e.contains(t,n)||(32768&n.flags&&(t.containsObjectType=!0),65536&n.flags&&void 0===t.unionIndex&&(t.unionIndex=t.length),32768&n.flags&&16&n.objectFlags&&n.symbol&&8208&n.symbol.flags&&Oo(t,n)||t.push(n))}function Bo(e,t){for(var n=0,i=t;n<i.length;n++){Fo(e,i[n])}}function $o(t,n,i){if(0===t.length)return ue;var r=[];if(Bo(r,t),r.containsNever)return ae;if(r.containsAny)return W;if(r.containsEmptyObject&&!r.containsObjectType&&r.push(ue),1===r.length)return r[0];var s=r.unionIndex;if(void 0!==s){var o=r[s];return Po(e.map(o.types,function(t){return $o(e.replaceElement(r,s,t))}),!1,n,i)}var a=js(r),l=V.get(a);l||(l=Qn(131072|Ks(r,6144)),V.set(a,l),l.types=r,l.aliasSymbol=n,l.aliasTypeArguments=i);return l}function Uo(t){return 24&e.getDeclarationModifierFlagsFromSymbol(t)||e.startsWith(t.escapedName,"__@")?ae:sa(e.symbolName(t))}function Vo(t){return ep(t,540672)?function(e){return e.resolvedIndexType||(e.resolvedIndexType=Qn(262144),e.resolvedIndexType.type=e),e.resolvedIndexType}(t):32&pn(t)?Jr(t):1&t.flags||bs(t,0)?ee:function(t){return Po(e.map(ts(t),Uo))}(t)}function Ho(t,n,i,r){var s=i&&180===i.kind?i:void 0,o=96&n.flags?e.escapeLeadingUnderscores(""+n.value):s&&ed(s.argumentExpression,n,!1)?e.getPropertyNameForKnownSymbolName(e.idText(s.argumentExpression.name)):void 0;if(void 0!==o){var a=fs(t,o);if(a){if(s){if(e.isAssignmentTarget(s)&&(Xd(s,a)||Zd(s)))return tn(s.argumentExpression,e.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,yi(a)),J;r&&(dn(i).resolvedSymbol=a)}return nr(a)}}if(!(6144&n.flags)&&tp(n,262774)){if(Fi(t))return W;var l=tp(n,84)&&bs(t,1)||bs(t,0)||void 0;if(l)return s&&l.isReadonly&&(e.isAssignmentTarget(s)||e.isDeleteTarget(s))&&tn(s,e.Diagnostics.Index_signature_in_type_0_only_permits_reading,vi(t)),l.type;if(s&&!np(t))return N&&!x.suppressImplicitAnyIndexErrors&&(vs(t,1)?tn(s.argumentExpression,e.Diagnostics.Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number):tn(s,e.Diagnostics.Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature,vi(t))),W}if(i){var c=180===i.kind?i.argumentExpression:i.indexType;return 96&n.flags?tn(c,e.Diagnostics.Property_0_does_not_exist_on_type_1,""+n.value,vi(t)):6&n.flags?tn(c,e.Diagnostics.Type_0_has_no_matching_index_signature_for_type_1,vi(t),vi(n)):tn(c,e.Diagnostics.Type_0_cannot_be_used_as_an_index_type,vi(n)),J}return W}function Go(t){return!!(540672&t.flags)||(32&pn(t)?jo(Jr(t)):!!(196608&t.flags)&&e.forEach(t.types,Go))}function jo(t){return!!(802816&t.flags)||!!(196608&t.flags)&&e.forEach(t.types,jo)}function Ko(e){if(32768&e.flags&&!Xr(e)){var t=Zr(e);return 0===t.properties.length&&0===t.callSignatures.length&&0===t.constructSignatures.length&&t.stringIndexInfo&&!t.numberIndexInfo}return!1}function zo(t){var n=t.objectType;if(131072&n.flags&&Go(n)&&e.some(n.types,Ko)){for(var i=[],r=[],s=0,o=n.types;s<o.length;s++){var a=o[s];Ko(a)?r.push(vs(a,0)):i.push(a)}return Po([Wo($o(i),t.indexType),$o(r)])}if(Xr(n)){var l=da([qr(n)],[t.indexType]),c=n.mapper,u=c?pa(c,l):l;return ya(Yr(n),u)}}function Wo(e,t,n){if(jo(t)||(!n||180!==n.kind)&&Go(e)){if(1&e.flags)return e;var i=e.id+","+t.id,r=G.get(i);return r||G.set(i,r=function(e,t){var n=Qn(524288);return n.objectType=e,n.indexType=t,n}(e,t)),r}var s=us(e);if(65536&t.flags&&!(8&t.flags)){for(var o=[],a=0,l=t.types;a<l.length;a++){var c=Ho(s,l[a],n,!1);if(c===J)return J;o.push(c)}return Po(o)}return Ho(s,t,n,!0)}function qo(e){var t=dn(e);return t.resolvedType||(t.resolvedType=Wo(aa(e.objectType),aa(e.indexType),e)),t.resolvedType}function Jo(e){var t=dn(e);if(!t.resolvedType){var n=ti(32,e.symbol);n.declaration=e,n.aliasSymbol=Xo(e),n.aliasTypeArguments=Zo(e),t.resolvedType=n,Jr(n)}return t.resolvedType}function Yo(t){var n=dn(t);if(!n.resolvedType){var i=Xo(t);if(0!==t.symbol.members.size||i){var r=ti(16,t.symbol);r.aliasSymbol=i,r.aliasTypeArguments=Zo(t),e.isJSDocTypeLiteral(t)&&t.isArrayType&&(r=So(r)),n.resolvedType=r}else n.resolvedType=pe}return n.resolvedType}function Xo(e){return 231===e.parent.kind?qn(e.parent):void 0}function Zo(e){var t=Xo(e);return t?cr(t):void 0}function Qo(t,n,i,r){if(1&t.flags||1&n.flags)return W;if(8192&t.flags)return n;if(8192&n.flags)return t;if(65536&t.flags)return gc(t,function(e){return Qo(e,n,i,r)});if(65536&n.flags)return gc(n,function(e){return Qo(t,e,i,r)});if(16777216&n.flags)return ce;if(262654&n.flags)return t;var s,o,a=e.createSymbolTable(),l=e.createUnderscoreEscapedMap();t===ue?(s=bs(n,0),o=bs(n,1)):(s=jr(bs(t,0),bs(n,0)),o=jr(bs(t,1),bs(n,1)));for(var c=0,u=ts(n);c<u.length;c++){var d=65536&(m=u[c]).flags&&!(32768&m.flags);24&e.getDeclarationModifierFlagsFromSymbol(m)?l.set(m.escapedName,!0):ta(m)||d||a.set(m.escapedName,ea(m))}for(var p=0,h=ts(t);p<h.length;p++){var f=h[p];if(!(65536&f.flags&&!(32768&f.flags)||l.has(f.escapedName)||ta(f)))if(a.has(f.escapedName)){var m,g=nr(m=a.get(f.escapedName));if(16777216&m.flags){var _=e.concatenate(f.declarations,m.declarations),y=nn(4|16777216&f.flags,f.escapedName);y.type=Po([nr(f),Zl(g,131072)]),y.leftSpread=f,y.rightSpread=m,y.declarations=_,a.set(f.escapedName,y)}}else a.set(f.escapedName,ea(f))}var b=si(void 0,a,e.emptyArray,e.emptyArray,s,o);return b.flags|=r,b.flags|=5242880,b.objectFlags|=128,b.symbol=i,b}function ea(e){if(!Yd(e))return e;var t=nn(4|16777216&e.flags,e.escapedName);return t.type=nr(e),t.declarations=e.declarations,t.syntheticOrigin=e,t}function ta(t){return 8192&t.flags&&e.find(t.declarations,function(t){return e.isClassLike(t.parent)})}function na(e,t,n){var i=Qn(e);return i.symbol=n,i.value=t,i}function ia(e){if(96&e.flags&&!(1048576&e.flags)){if(!e.freshType){var t=na(1048576|e.flags,e.value,e.symbol);t.regularType=e,e.freshType=t}return e.freshType}return e}function ra(e){return 96&e.flags&&1048576&e.flags?e.regularType:e}function sa(e,t,n){var i="number"==typeof e?"#":"@",r=t?t+i+e:i+e,s=H.get(r);if(!s){var o=("number"==typeof e?64:32)|(t?256:0);H.set(r,s=na(o,e,n))}return s}function oa(t){var n=dn(t);return n.resolvedType||(n.resolvedType=function(t){var n=e.getThisContainer(t,!1),i=n&&n.parent;return!i||!e.isClassLike(i)&&230!==i.kind||e.hasModifier(n,32)||152===n.kind&&!e.isNodeDescendantOf(t,n.body)?(tn(t,e.Diagnostics.A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface),J):br(qn(i)).thisType}(t)),n.resolvedType}function aa(t){switch(t.kind){case 119:case 268:case 269:return W;case 136:return ee;case 133:return te;case 122:case 158:return re;case 137:return se;case 105:return oe;case 139:return Y;case 95:return Z;case 130:return ae;case 134:return 65536&t.flags?W:ce;case 169:case 99:return oa(t);case 173:return function(e){var t=dn(e);return t.resolvedType||(t.resolvedType=ra(xp(e.literal))),t.resolvedType}(t);case 159:case 201:return to(t);case 162:return io(t);case 164:return function(e){var t=dn(e);return t.resolvedType||(t.resolvedType=So(aa(e.elementType))),t.resolvedType}(t);case 165:return function(t){var n=dn(t);return n.resolvedType||(n.resolvedType=wo(e.map(t.elementTypes,aa))),n.resolvedType}(t);case 166:return function(t){var n=dn(t);return n.resolvedType||(n.resolvedType=Po(e.map(t.types,aa),!1,Xo(t),Zo(t))),n.resolvedType}(t);case 167:return function(t){var n=dn(t);return n.resolvedType||(n.resolvedType=$o(e.map(t.types,aa),Xo(t),Zo(t))),n.resolvedType}(t);case 270:return function(e){var t=aa(e.type);return I?Po([t,Z]):t}(t);case 168:case 271:case 272:case 267:return aa(t.type);case 160:case 161:case 163:case 285:case 273:return Yo(t);case 170:return function(e){var t=dn(e);return t.resolvedType||(t.resolvedType=Vo(aa(e.type))),t.resolvedType}(t);case 171:return qo(t);case 172:return Jo(t);case 71:case 143:var n=gf(t);return n&&Cr(n);case 274:return function(e){var t=dn(e);if(!t.resolvedType){var n=aa(e.type);t.resolvedType=n?So(n):J}return t.resolvedType}(t);default:return J}}function la(e,t,n){if(e&&e.length){for(var i=[],r=0,s=e;r<s.length;r++){var o=s[r];i.push(n(o,t))}return i}return e}function ca(e,t){return la(e,t,ya)}function ua(e,t){return la(e,t,fa)}function da(t,n){return e.Debug.assert(void 0===n||t.length===n.length),1===t.length?(a=t[0],l=n?n[0]:W,function(e){return e===a?l:e}):2===t.length?(i=t[0],r=n?n[0]:W,s=t[1],o=n?n[1]:W,function(e){return e===i?r:e===s?o:e}):function(e,t){return function(n){for(var i=0;i<e.length;i++)if(n===e[i])return t?t[i]:W;return n}}(t,n);var i,r,s,o,a,l}function pa(e,t){return function(n){return ya(e(n),t)}}function ha(e){var t=Qn(16384);return t.symbol=e.symbol,t.target=e,t}function fa(t,n,i){var r,s;if(t.typeParameters&&!i){r=e.map(t.typeParameters,ha),n=pa(da(t.typeParameters,r),n);for(var o=0,a=r;o<a.length;o++){a[o].mapper=n}}t.typePredicate&&(s=function(t,n){return e.isIdentifierTypePredicate(t)?{kind:1,parameterName:t.parameterName,parameterIndex:t.parameterIndex,type:ya(t.type,n)}:{kind:0,type:ya(t.type,n)}}(t.typePredicate,n));var l=Mr(t.declaration,r,t.thisParameter&&ma(t.thisParameter,n),la(t.parameters,n,ma),void 0,s,t.minArgumentCount,t.hasRestParameter,t.hasLiteralTypes);return l.target=t,l.mapper=n,l}function ma(t,n){if(1&e.getCheckFlags(t)){var i=un(t);t=i.target,n=pa(i.mapper,n)}var r=nn(t.flags,t.escapedName);return r.checkFlags=1,r.declarations=t.declarations,r.parent=t.parent,r.target=t,r.mapper=n,t.valueDeclaration&&(r.valueDeclaration=t.valueDeclaration),t.isRestParameter&&(r.isRestParameter=t.isRestParameter),r}function ga(t,n){var i=64&t.objectFlags?t.target:t,r=i.symbol,s=un(r),o=s.typeParameters;if(!o){var a=r.declarations[0],l=ar(a,!0)||e.emptyArray;o=2048&r.flags&&!i.aliasTypeArguments?e.filter(l,function(t){return function(t,n){if(t.symbol&&t.symbol.declarations&&1===t.symbol.declarations.length){var i=t.symbol.declarations[0].parent;if(e.findAncestor(n,function(e){return 207===e.kind?"quit":e===i}))return e.forEachChild(n,r)}return!0;function r(n){switch(n.kind){case 169:return t.isThisType;case 71:return!t.isThisType&&e.isPartOfTypeNode(n)&&aa(n)===t;case 162:return!0}return e.forEachChild(n,r)}}(t,a)}):l,s.typeParameters=o,o.length&&(s.instantiations=e.createMap(),s.instantiations.set(js(o),i))}if(o.length){var c=64&t.objectFlags?pa(t.mapper,n):n,u=e.map(o,c),d=js(u),p=s.instantiations.get(d);if(!p){var h=da(o,u);p=32&i.objectFlags?function(e,t){var n=Jr(e);if(262144&n.flags){var i=n.type;if(16384&i.flags){var r=ya(i,t);if(i!==r)return gc(r,function(n){return function(e){return 704513&e.flags}(n)?_a(e,function(e,t,n){return function(i){return i===e?t:n(i)}}(i,n,t)):n})}}return _a(e,t)}(i,h):_a(i,h),s.instantiations.set(d,p)}return p}return t}function _a(e,t){var n=ti(64|e.objectFlags,e.symbol);return 32&e.objectFlags&&(n.declaration=e.declaration),n.target=e,n.mapper=t,n.aliasSymbol=e.aliasSymbol,n.aliasTypeArguments=ca(e.aliasTypeArguments,t),n}function ya(e,t){if(e&&t!==k){if(16384&e.flags)return t(e);if(32768&e.flags){if(16&e.objectFlags)return e.symbol&&14384&e.symbol.flags&&e.symbol.declarations?ga(e,t):e;if(32&e.objectFlags)return ga(e,t);if(4&e.objectFlags)return zs(e.target,ca(e.typeArguments,t))}if(65536&e.flags&&!(8190&e.flags))return Po(ca(e.types,t),!1,e.aliasSymbol,ca(e.aliasTypeArguments,t));if(131072&e.flags)return $o(ca(e.types,t),e.aliasSymbol,ca(e.aliasTypeArguments,t));if(262144&e.flags)return Vo(ya(e.type,t));if(524288&e.flags)return Wo(ya(e.objectType,t),ya(e.indexType,t))}return e}function ba(e,t){return e&&Us(ya(e.type,t),e.isReadonly,e.declaration)}function va(t){switch(e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t)),t.kind){case 186:case 187:case 151:return Ta(t);case 178:case 254:return e.forEach(t.properties,va);case 177:return e.forEach(t.elements,va);case 195:return va(t.whenTrue)||va(t.whenFalse);case 194:return 54===t.operatorToken.kind&&(va(t.left)||va(t.right));case 261:return va(t.initializer);case 185:return va(t.expression);case 253:return t.initializer&&va(t.initializer);case 256:return t.expression&&va(t.expression)}return!1}function Ta(t){if(t.typeParameters)return!1;if(e.forEach(t.parameters,function(t){return!e.getEffectiveTypeAnnotationNode(t)}))return!0;if(187!==t.kind){var n=e.firstOrUndefined(t.parameters);if(!n||!e.parameterIsThisKeyword(n))return!0}return 207!==t.body.kind&&va(t.body)}function ka(t){return(lu(t)||e.isObjectLiteralMethod(t))&&Ta(t)}function xa(t){if(32768&t.flags){var n=Zr(t);if(n.constructSignatures.length){var i=ti(16,t.symbol);return i.members=n.members,i.properties=n.properties,i.callSignatures=e.emptyArray,i.constructSignatures=e.emptyArray,i}}else if(131072&t.flags)return $o(e.map(t.types,xa));return t}function Ea(e,t){return $a(e,t,Yt)}function Sa(e,t){return $a(e,t,Yt)?-1:0}function Ca(e,t){return $a(e,t,qt)?-1:0}function wa(e,t){return $a(e,t,Wt)}function Ia(e,t){return $a(e,t,qt)}function Aa(e,t){return rr(e)===rr(t)||wa(e,t)&&!Ea(e,t)}function Na(e,t){return $a(e,t,Jt)}function Da(e,t,n,i,r){return Ua(e,t,qt,n,i,r)}function Oa(e,t,n,i,r){return Ua(e,t,Jt,n,i,r)}function Ra(t,n,i,r,s,o,a){if(t===n)return-1;if(!n.hasRestParameter&&t.minArgumentCount>n.parameters.length)return 0;t.typeParameters&&t.typeParameters!==n.typeParameters&&(t=ad(t,n=Ms(n),void 0,a));var l=n.declaration?n.declaration.kind:0,c=!i&&A&&151!==l&&150!==l&&152!==l,u=-1,d=Ns(t);if(d&&d!==oe){var p=Ns(n);if(p){if(!(b=!c&&a(d,p,!1)||a(p,d,s)))return s&&o(e.Diagnostics.The_this_types_of_each_signature_are_incompatible),0;u&=b}}for(var h=Pa(t),f=Pa(n),m=function(e,t,n,i){return e.hasRestParameter===n.hasRestParameter?e.hasRestParameter?Math.max(t,i)+1:Math.min(t,i):e.hasRestParameter?i:t}(t,h,n,f),g=t.parameters,_=n.parameters,y=0;y<m;y++){var b,v=y<h?Pd(g[y]):Os(t),T=y<f?Pd(_[y]):Os(n),k=i?void 0:od(_l(v)),x=i?void 0:od(_l(T));if(!(b=k&&x&&!k.typePredicate&&!x.typePredicate&&(6144&pl(v))==(6144&pl(T))?Ra(x,k,c?2:1,!1,s,o,a):!i&&!c&&a(v,T,!1)||a(T,v,s)))return s&&o(e.Diagnostics.Types_of_parameters_0_and_1_are_incompatible,e.symbolName(g[y<h?y:h]),e.symbolName(_[y<f?y:f])),0;u&=b}if(!r){var E=Ds(n);if(E===oe)return u;var S=Ds(t);if(n.typePredicate){if(t.typePredicate)u&=function(t,n,i,r,s,o,a){if(t.kind!==n.kind)return s&&(o(e.Diagnostics.A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard),o(e.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Ti(t),Ti(n))),0;if(1===t.kind){var l=t,c=n;if(l.parameterIndex-(e.getThisParameter(i)?1:0)!==c.parameterIndex-(e.getThisParameter(r)?1:0))return s&&(o(e.Diagnostics.Parameter_0_is_not_in_the_same_position_as_parameter_1,l.parameterName,c.parameterName),o(e.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Ti(t),Ti(n))),0}var u=a(t.type,n.type,s);0===u&&s&&o(e.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Ti(t),Ti(n));return u}(t.typePredicate,n.typePredicate,t.declaration,n.declaration,s,o,a);else if(e.isIdentifierTypePredicate(n.typePredicate))return s&&o(e.Diagnostics.Signature_0_must_be_a_type_predicate,bi(t)),0}else u&=1===i&&a(E,S,!1)||a(S,E,s)}return u}function La(e,t){var n=Ps(e),i=Ps(t),r=Ds(n),s=Ds(i);return!(s!==oe&&!$a(s,r,qt)&&!$a(r,s,qt))&&0!==Ra(n,i,0,!0,!1,void 0,Ca)}function Pa(e){var t=e.parameters.length;return e.hasRestParameter?t-1:t}function Ma(t){return 32768&t.flags?0===(n=Zr(t)).properties.length&&0===n.callSignatures.length&&0===n.constructSignatures.length&&!n.stringIndexInfo&&!n.numberIndexInfo:!!(16777216&t.flags)||(65536&t.flags?e.forEach(t.types,Ma):!!(131072&t.flags)&&!e.forEach(t.types,function(e){return!Ma(e)}));var n}function Fa(t,n,i){if(t===n)return!0;var r=a(t)+","+a(n),s=Xt.get(r);if(void 0!==s)return s;if(!(t.escapedName===n.escapedName&&256&t.flags&&256&n.flags))return Xt.set(r,!1),!1;for(var o=nr(n),l=0,c=ts(nr(t));l<c.length;l++){var u=c[l];if(8&u.flags){var d=fs(o,u.escapedName);if(!(d&&8&d.flags))return i&&i(e.Diagnostics.Property_0_is_missing_in_type_1,e.symbolName(u),vi(Cr(n),void 0,256)),Xt.set(r,!1),!1}}return Xt.set(r,!0),!0}function Ba(e,t,n,i){var r=e.flags,s=t.flags;if(8192&s)return!1;if(1&s||8192&r)return!0;if(262178&r&&2&s)return!0;if(32&r&&256&r&&32&s&&!(256&s)&&e.value===t.value)return!0;if(84&r&&4&s)return!0;if(64&r&&256&r&&64&s&&!(256&s)&&e.value===t.value)return!0;if(136&r&&8&s)return!0;if(16&r&&16&s&&Fa(e.symbol,t.symbol,i))return!0;if(256&r&&256&s){if(65536&r&&65536&s&&Fa(e.symbol,t.symbol,i))return!0;if(224&r&&224&s&&e.value===t.value&&Fa(Jn(e.symbol),Jn(t.symbol),i))return!0}if(2048&r&&(!I||3072&s))return!0;if(4096&r&&(!I||4096&s))return!0;if(32768&r&&16777216&s)return!0;if(n===qt||n===Jt){if(1&r)return!0;if(68&r&&!(256&r)&&(16&s||64&s&&256&s))return!0}return!1}function $a(e,t,n){if(96&e.flags&&1048576&e.flags&&(e=e.regularType),96&t.flags&&1048576&t.flags&&(t=t.regularType),e===t||n!==Yt&&Ba(e,t,n))return!0;if(32768&e.flags&&32768&t.flags){var i=n.get(za(e,t,n));if(void 0!==i)return 1===i}return!!(1032192&e.flags||1032192&t.flags)&&Ua(e,t,n,void 0)}function Ua(t,n,i,r,s,o){var a,l,c,u,d,p=0,h=0;!function(e){e[e.None=0]="None",e[e.Source=1]="Source",e[e.Target=2]="Target",e[e.Both=3]="Both"}(d||(d={}));var f=0,m=!1,g=!1;e.Debug.assert(i!==Yt||!r,"no error reporting in identity checking");var _=v(t,n,!!r,s);return m?tn(r,e.Diagnostics.Excessive_stack_depth_comparing_types_0_and_1,vi(t),vi(n)):a&&(o&&(a=e.concatenateDiagnosticMessageChains(o,a)),Nt.add(e.createDiagnosticForNodeFromMessageChain(r,a))),0!==_;function y(t,n,i,s){e.Debug.assert(!!r),a=e.chainDiagnosticMessages(a,t,n,i,s)}function b(t,n,r){var s=vi(n),o=vi(r);s===o&&(s=vi(n,void 0,256),o=vi(r,void 0,256)),t||(t=i===Jt?e.Diagnostics.Type_0_is_not_comparable_to_type_1:s===o?e.Diagnostics.Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated:e.Diagnostics.Type_0_is_not_assignable_to_type_1),y(t,s,o)}function v(t,n,r,s){if(96&t.flags&&1048576&t.flags&&(t=t.regularType),96&n.flags&&1048576&n.flags&&(n=n.regularType),t===n)return-1;if(i===Yt)return function(e,t){var n;if(32768&e.flags&&32768&t.flags)return w(e,t,!1);if((65536&e.flags&&65536&t.flags||131072&e.flags&&131072&t.flags)&&(n=k(e,t))&&(n&=k(t,e)))return n;return 0}(t,n);if(Ba(t,n,i,r?y:void 0))return-1;if(128&pn(t)&&1048576&t.flags){if(T(t,n,r))return r&&b(s,t,n),0;(function(e){if(!(196608&e.flags))return!1;for(var t=!1,n=0,i=e.types;n<i.length;n++)if(!(6144&i[n].flags)){if(t)return!0;t=!0}return!1})(n)&&(t=vl(t))}if(i!==Jt&&!(196608&t.flags)&&!(65536&n.flags)&&!g&&t!==ke&&(ts(t).length>0||gs(t,0).length>0||gs(t,1).length>0)&&I(n)&&!function(e,t){for(var n=!!(33554432&e.flags),i=0,r=ts(e);i<r.length;i++){if(Mu(t,r[i].escapedName,n))return!0}return!1}(t,n)){if(r){var o=gs(t,0),l=gs(t,1);o.length>0&&v(Ds(o[0]),n,!1)||l.length>0&&v(Ds(l[0]),n,!1)?y(e.Diagnostics.Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it,vi(t),vi(n)):y(e.Diagnostics.Type_0_has_no_properties_in_common_with_type_1,vi(t),vi(n))}return 0}var c=0,u=a,d=g;return g=!1,65536&t.flags?c=i===Jt?C(t,n,r&&!(8190&t.flags)):function(e,t,n){for(var i=-1,r=e.types,s=0,o=r;s<o.length;s++){var a=v(o[s],t,n);if(!a)return 0;i&=a}return i}(t,n,r&&!(8190&t.flags)):(65536&n.flags?c=E(t,n,r&&!(8190&t.flags)&&!(8190&n.flags)):131072&n.flags?(g=!0,c=function(e,t,n){for(var i=-1,r=t.types,s=0,o=r;s<o.length;s++){var a=v(e,o[s],n);if(!a)return 0;i&=a}return i}(t,n,r)):131072&t.flags&&(c=C(t,n,!1)),!c&&(1032192&t.flags||1032192&n.flags)&&(c=w(t,n,r))&&(a=u)),g=d,!c&&r&&(32768&t.flags&&8190&n.flags?function(t,n){var i=vi(t),r=vi(n);(Ce===t&&ee===n||we===t&&te===n||Ie===t&&re===n||lo(!1)===t&&se===n)&&y(e.Diagnostics._0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible,r,i)}(t,n):t.symbol&&32768&t.flags&&ke===t&&y(e.Diagnostics.The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead),b(s,t,n)),c}function T(t,n,s){if(ep(n,32768)&&!(512&pn(n))){var o=!!(33554432&t.flags);if((i===qt||i===Jt)&&(hc(ke,n)||!o&&Ma(n)))return!1;if(65536&n.flags){var a=S(t,n);if(a)return T(t,a,s)}for(var l=function(i){if(!Mu(n,i.escapedName,o)){if(s)if(e.Debug.assert(!!r),e.isJsxAttributes(r)||e.isJsxOpeningLikeElement(r))y(e.Diagnostics.Property_0_does_not_exist_on_type_1,yi(i),vi(n));else{var a=t.symbol&&e.firstOrUndefined(t.symbol.declarations),l=void 0;if(i.valueDeclaration&&e.findAncestor(i.valueDeclaration,function(e){return e===a})){var c=i.valueDeclaration;e.Debug.assertNode(c,e.isObjectLiteralElementLike),r=c,e.isIdentifier(c.name)&&(l=zu(c.name,n))}void 0!==l?y(e.Diagnostics.Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_write_2,yi(i),vi(n),l):y(e.Diagnostics.Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1,yi(i),vi(n))}return{value:!0}}},c=0,u=Qr(t);c<u.length;c++){var d=l(u[c]);if("object"==typeof d)return d.value}}return!1}function k(e,t){for(var n=-1,i=0,r=e.types;i<r.length;i++){var s=E(r[i],t,!1);if(!s)return 0;n&=s}return n}function E(e,t,n){var i=t.types;if(65536&t.flags&&Ao(i,e))return-1;for(var r=0,s=i;r<s.length;r++){var o=v(e,s[r],!1);if(o)return o}n&&v(e,S(e,t)||i[i.length-1],!0);return 0}function S(e,t){var n,i=Qr(e);if(i){var r=function(e,t){for(var n,i=0,r=e;i<r.length;i++){var s=r[i];if(ql(t,s.escapedName)){if(n)return;n=s}}return n}(i,t);if(r)for(var s=nr(r),o=0,a=t.types;o<a.length;o++){var l=a[o],c=Mi(l,r.escapedName);if(c&&v(s,c)){if(n)return;n=l}}}return n}function C(e,t,n){var i=e.types;if(65536&e.flags&&Ao(i,t))return-1;for(var r=i.length,s=0;s<r;s++){var o=v(i[s],t,n&&s===r-1);if(o)return o}return 0}function w(t,n,r){if(m)return 0;var s=za(t,n,i),o=i.get(s);if(void 0!==o){if(!r||2!==o)return 1===o?-1:0;i.set(s,3)}if(l){for(var d=0;d<p;d++)if(s===l[d])return 1;if(100===h)return m=!0,0}else l=[],c=[],u=[];var g=p;l[p]=s,p++,c[h]=t,u[h]=n,h++;var _=f;1&f||!Xa(t,c,h)||(f|=1),2&f||!Xa(n,u,h)||(f|=2);var b=3!==f?function(t,n,r){var s,o=a;if(16384&n.flags){if(32&pn(t)&&Jr(t)===Vo(n))if(!t.declaration.questionToken)if(s=v(Yr(t),Wo(n,qr(t)),r))return s}else if(262144&n.flags){if(262144&t.flags&&(s=v(n.type,t.type,!1)))return s;var l=function(e){return 16384&e.flags?ns(e):524288&e.flags?is(e):rs(e)}(n.type);if(l&&(s=v(t,Vo(l),r)))return s}else if(524288&n.flags){if((l=is(n))&&(s=v(t,l,r)))return a=o,s}if(16384&t.flags){if(32&pn(n)&&Jr(n)===Vo(t)){if(s=v(Wo(t,qr(n)),Yr(n),r))return a=o,s}else if((l=ns(t))||!(16777216&n.flags))if((!l||1&l.flags)&&(l=ue),s=v(l,n,r&&l!==ue))return a=o,s}else if(524288&t.flags){if(l=is(t)){if(s=v(l,n,r))return a=o,s}else if(524288&n.flags&&t.indexType===n.indexType&&(s=v(t.objectType,n.objectType,r)))return s}else{if(4&pn(t)&&4&pn(n)&&t.target===n.target&&!(67108864&t.flags||67108864&n.flags)){var c=Ha(t.target);if(s=function(t,n,r,s){var o=t.typeArguments||e.emptyArray,a=n.typeArguments||e.emptyArray;if(o.length!==a.length&&i===Yt)return 0;for(var l=o.length<=a.length?o.length:a.length,c=-1,u=0;u<l;u++){var d=u<r.length?r[u]:1;if(4!==d){var p=o[u],h=a[u],f=-1;if(1===d?f=v(p,h,s):2===d?f=v(h,p,s):3===d?(f=v(h,p,!1))||(f=v(p,h,s)):(f=v(p,h,s))&&(f&=v(h,p,s)),!f)return 0;c&=f}}return c}(t,n,c,r))return s;if(c!==e.emptyArray&&!function(e,t){for(var n=0;n<t.length;n++)if(1===t[n]&&1024&e.typeArguments[n].flags)return!0;return!1}(n,c)){if(!r||!e.some(c,function(e){return 0===e}))return 0;a=o}}var u=!!(8190&t.flags);if(i!==Yt&&(t=us(t)),163840&t.flags&&32768&n.flags){var d=r&&a===o&&!u;if(!function(e){return 32&pn(e)&&!!e.declaration.questionToken}(n)||Xr(t)||!Ma(t)?Xr(n)?s=Xr(t)?function(e,t,n){var r,s=!!e.declaration.readonlyToken,o=!!e.declaration.questionToken,a=!!t.declaration.readonlyToken,l=!!t.declaration.questionToken;if((i===Yt?s===a&&o===l:i===Jt||!o||l)&&(r=v(Jr(t),Jr(e),n))){var c=da([qr(e)],[qr(t)]);return r&v(ya(Yr(e),c),Yr(t),n)}return 0}(t,n,d):0:(s=function(t,n,r){if(i===Yt)return function(e,t){if(!(32768&e.flags&&32768&t.flags))return 0;var n=Qr(e),i=Qr(t);if(n.length!==i.length)return 0;for(var r=-1,s=0,o=n;s<o.length;s++){var a=o[s],l=es(t,a.escapedName);if(!l)return 0;var c=Qa(a,l,v);if(!c)return 0;r&=c}return r}(t,n);var s=i===Wt&&!(128&pn(t)),o=Rl(t,n,s);if(o)return r&&y(e.Diagnostics.Property_0_is_missing_in_type_1,yi(o),vi(t)),0;for(var a=-1,l=Qr(n),c=0,u=l;c<u.length;c++){var d=u[c];if(!(4194304&d.flags)){var p=fs(t,d.escapedName);if(p&&p!==d){var h=e.getDeclarationModifierFlagsFromSymbol(p),f=e.getDeclarationModifierFlagsFromSymbol(d);if(8&h||8&f){if(256&e.getCheckFlags(p))return r&&y(e.Diagnostics.Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1,yi(p),vi(t)),0;if(p.valueDeclaration!==d.valueDeclaration)return r&&(8&h&&8&f?y(e.Diagnostics.Types_have_separate_declarations_of_a_private_property_0,yi(d)):y(e.Diagnostics.Property_0_is_private_in_type_1_but_not_in_type_2,yi(d),vi(8&h?t:n),vi(8&h?n:t))),0}else if(16&f){if(!Ja(p,d))return r&&y(e.Diagnostics.Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2,yi(d),vi(qa(p)||t),vi(qa(d)||n)),0}else if(16&h)return r&&y(e.Diagnostics.Property_0_is_protected_in_type_1_but_public_in_type_2,yi(d),vi(t),vi(n)),0;var m=v(nr(p),nr(d),r);if(!m)return r&&y(e.Diagnostics.Types_of_property_0_are_incompatible,yi(d)),0;if(a&=m,i!==Jt&&16777216&p.flags&&!(16777216&d.flags))return r&&y(e.Diagnostics.Property_0_is_optional_in_type_1_but_required_in_type_2,yi(d),vi(t),vi(n)),0}}}return a}(t,n,d),s&&(s&=A(t,n,0,d))&&(s&=A(t,n,1,d))&&(s&=O(t,n,0,u,d))&&(s&=O(t,n,1,u,d))):s=-1,s)return a=o,s}}return 0}(t,n,r):1;if(f=_,h--,b){if(-1===b||0===h){for(d=g;d<p;d++)i.set(l[d],1);p=g}}else i.set(s,r?3:2),p=g;return b}function I(t){if(32768&t.flags){var n=Zr(t);return 0===n.callSignatures.length&&0===n.constructSignatures.length&&!n.stringIndexInfo&&!n.numberIndexInfo&&n.properties.length>0&&e.every(n.properties,function(e){return!!(16777216&e.flags)})}return!!(131072&t.flags)&&e.every(t.types,I)}function A(t,n,r,s){if(i===Yt)return function(e,t,n){var i=gs(e,n),r=gs(t,n);if(i.length!==r.length)return 0;for(var s=-1,o=0;o<i.length;o++){var a=el(i[o],r[o],!1,!1,!1,v);if(!a)return 0;s&=a}return s}(t,n,r);if(n===fe||t===fe)return-1;var o=gs(t,r),l=gs(n,r);if(1===r&&o.length&&l.length){if(Ya(t)&&!Ya(n))return s&&y(e.Diagnostics.Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type),0;if(!function(t,n,i){if(!t.declaration||!n.declaration)return!0;var r=e.getSelectedModifierFlags(t.declaration,24),s=e.getSelectedModifierFlags(n.declaration,24);if(8===s)return!0;if(16===s&&8!==r)return!0;if(16!==s&&!r)return!0;i&&y(e.Diagnostics.Cannot_assign_a_0_constructor_type_to_a_1_constructor_type,xi(r),xi(s));return!1}(o[0],l[0],s))return 0}var c=-1,u=a;if(64&pn(t)&&64&pn(n)&&t.symbol===n.symbol)for(var d=0;d<l.length;d++){if(!(T=N(o[d],l[d],!0,s)))return 0;c&=T}else if(1===o.length&&1===l.length){var p=i===Jt||x.noStrictGenericChecks;c=N(o[0],l[0],p,s)}else e:for(var h=0,f=l;h<f.length;h++){for(var m=f[h],g=s,_=0,b=o;_<b.length;_++){var T;if(T=N(b[_],m,!0,g)){c&=T,a=u;continue e}g=!1}return g&&y(e.Diagnostics.Type_0_provides_no_match_for_the_signature_1,vi(t),bi(m,void 0,void 0,r)),0}return c}function N(e,t,n,i){return Ra(n?Ps(e):e,n?Ps(t):t,0,!1,i,y,v)}function D(t,n,i){var r=v(t.type,n.type,i);return!r&&i&&y(e.Diagnostics.Index_signatures_are_incompatible),r}function O(t,n,r,s,o){if(i===Yt)return function(e,t,n){var i=bs(t,n),r=bs(e,n);if(!r&&!i)return-1;if(r&&i&&r.isReadonly===i.isReadonly)return v(r.type,i.type);return 0}(t,n,r);var a=bs(n,r);if(!a||1&a.type.flags&&!s)return-1;var l=bs(t,r)||1===r&&bs(t,0);if(l)return D(l,a,o);if(Xr(t))return 0===r&&v(Yr(t),a.type,o);if(yl(t)){var c=-1;if(0===r){var u=bs(t,1);u&&(c=D(u,a,o))}return c&&(c&=function(t,n,i,r){for(var s=-1,o=0,a=Qr(t);o<a.length;o++){var l=a[o];if(0===i||mu(l.escapedName)){var c=v(nr(l),n,r);if(!c)return r&&y(e.Diagnostics.Property_0_is_incompatible_with_index_signature,yi(l)),0;s&=c}}return s}(t,a.type,r,o)),c}return o&&y(e.Diagnostics.Index_signature_is_missing_in_type_0,vi(t)),0}}function Va(t,n,i){var r=zs(t,e.map(t.typeParameters,function(e){return e===n?i:e}));return r.flags|=67108864,r}function Ha(t){if(!A)return e.emptyArray;var n=t.typeParameters||e.emptyArray,i=t.variances;if(!i){if(t===Ee||t===Se)i=[1];else{t.variances=e.emptyArray,i=[];for(var r=0,s=n;r<s.length;r++){var o=s[r],a=Va(t,o,ye),l=Va(t,o,be),c=(Ia(l,a)?1:0)|(Ia(a,l)?2:0);3===c&&Ia(Va(t,o,Qe),a)&&(c=4),i.push(c)}}t.variances=i}return i}function Ga(e){return 16384&e.flags&&!Hs(e)}function ja(t){return 4&pn(t)&&e.some(t.typeArguments,function(e){return Ga(e)||ja(e)})}function Ka(t,n,i){void 0===i&&(i=0);for(var r=""+t.target.id,s=0,o=t.typeArguments;s<o.length;s++){var a=o[s];if(Ga(a)){var l=e.indexOf(n,a);l<0&&(l=n.length,n.push(a)),r+="="+l}else i<4&&ja(a)?r+="<"+Ka(a,n,i+1)+">":r+="-"+a.id}return r}function za(e,t,n){if(n===Yt&&e.id>t.id){var i=e;e=t,t=i}if(ja(e)&&ja(t)){var r=[];return Ka(e,r)+","+Ka(t,r)}return e.id+","+t.id}function Wa(t,n){if(!(6&e.getCheckFlags(t)))return n(t);for(var i=0,r=t.containingType.types;i<r.length;i++){var s=fs(r[i],t.escapedName),o=s&&Wa(s,n);if(o)return o}}function qa(e){return e.parent&&32&e.parent.flags?Cr(Jn(e)):void 0}function Ja(t,n){return!Wa(n,function(n){return!!(16&e.getDeclarationModifierFlagsFromSymbol(n))&&(i=t,r=qa(n),!Wa(i,function(e){var t=qa(e);return!!t&&sr(t,r)}));var i,r})}function Ya(t){if(16&pn(t)){var n=t.symbol;if(n&&32&n.flags){var i=Hh(n);if(i&&e.hasModifier(i,128))return!0}}return!1}function Xa(e,t,n){if(n>=5&&32768&e.flags){var i=e.symbol;if(i)for(var r=0,s=0;s<n;s++){var o=t[s];if(32768&o.flags&&o.symbol===i&&++r>=5)return!0}}return!1}function Za(e,t){return 0!==Qa(e,t,Sa)}function Qa(t,n,i){if(t===n)return-1;var r=24&e.getDeclarationModifierFlagsFromSymbol(t);if(r!==(24&e.getDeclarationModifierFlagsFromSymbol(n)))return 0;if(r){if(Vh(t)!==Vh(n))return 0}else if((16777216&t.flags)!=(16777216&n.flags))return 0;return Yd(t)!==Yd(n)?0:i(nr(t),nr(n))}function el(t,n,i,r,s,o){if(t===n)return-1;if(!function(e,t,n){if(e.parameters.length===t.parameters.length&&e.minArgumentCount===t.minArgumentCount&&e.hasRestParameter===t.hasRestParameter)return!0;var i=e.hasRestParameter?1:0,r=t.hasRestParameter?1:0;return!!(n&&e.minArgumentCount<=t.minArgumentCount&&(i>r||i===r&&e.parameters.length>=t.parameters.length))}(t,n,i))return 0;if(e.length(t.typeParameters)!==e.length(n.typeParameters))return 0;t=Ps(t),n=Ps(n);var a=-1;if(!r){var l=Ns(t);if(l){var c=Ns(n);if(c){if(!(p=o(l,c)))return 0;a&=p}}}for(var u=n.parameters.length,d=0;d<u;d++){var p;if(!(p=o(tl(t,d)?Os(t):Pd(t.parameters[d]),tl(n,d)?Os(n):Pd(n.parameters[d]))))return 0;a&=p}return s||(a&=o(Ds(t),Ds(n))),a}function tl(e,t){return e.hasRestParameter&&t>=e.parameters.length-1}function nl(t){return function(e){for(var t,n=0,i=e;n<i.length;n++){var r=i[n],s=ll(r);if(t||(t=s),s===r||s!==t)return!1}return!0}(t)?Po(t):e.reduceLeft(t,function(e,t){return wa(e,t)?t:e})}function il(e){return 4&pn(e)&&e.target===Ee}function rl(e){return 4&pn(e)&&(e.target===Ee||e.target===Se)||!(6144&e.flags)&&Ia(e,Re)}function sl(e){return!!fs(e,"0")}function ol(e){return!!(6368&e.flags)}function al(t){return!!(8&t.flags)||(65536&t.flags?!!(256&t.flags)||!e.forEach(t.types,function(e){return!ol(e)}):ol(t))}function ll(t){return 256&t.flags?kr(t):32&t.flags?ee:64&t.flags?te:128&t.flags?re:65536&t.flags?Po(e.sameMap(t.types,ll)):t}function cl(t){return 256&t.flags?kr(t):32&t.flags&&1048576&t.flags?ee:64&t.flags&&1048576&t.flags?te:128&t.flags?re:65536&t.flags?Po(e.sameMap(t.types,cl)):t}function ul(e){return!!(4&pn(e)&&8&e.target.objectFlags)}function dl(e){for(var t=0,n=0,i=e;n<i.length;n++){t|=pl(i[n])}return t}function pl(e){return 65536&e.flags?dl(e.types):32&e.flags?""===e.value?32:0:64&e.flags?0===e.value?64:0:128&e.flags?e===ie?128:0:7406&e.flags}function hl(e){return 7392&pl(e)?mc(e,function(e){return!(7392&pl(e))}):e}function fl(e){return gc(e,ml)}function ml(e){return 2&e.flags?dt:4&e.flags?pt:8&e.flags||e===ie?ie:7168&e.flags||32&e.flags&&""===e.value||64&e.flags&&0===e.value?e:ae}function gl(e,t){var n=t&~e.flags&6144;return 0===n?e:Po(2048===n?[e,Y]:4096===n?[e,Z]:[e,Y,Z])}function _l(e){return I?Zl(e,524288):e}function yl(e){return e.symbol&&!!(6656&e.symbol.flags)&&0===gs(e,0).length&&0===gs(e,1).length}function bl(e,t){var n=nn(e.flags,e.escapedName);return n.declarations=e.declarations,n.parent=e.parent,n.type=t,n.target=e,e.valueDeclaration&&(n.valueDeclaration=e.valueDeclaration),n}function vl(t){if(!(128&pn(t)&&1048576&t.flags))return t;var n=t.regularType;if(n)return n;var i=t,r=function(t,n){for(var i=e.createSymbolTable(),r=0,s=Qr(t);r<s.length;r++){var o=s[r],a=nr(o),l=n(a);i.set(o.escapedName,l===a?o:bl(o,l))}return i}(t,vl),s=si(i.symbol,r,i.callSignatures,i.constructSignatures,i.stringIndexInfo,i.numberIndexInfo);return s.flags=-1048577&i.flags,s.objectFlags|=128,t.regularType=s,s}function Tl(e){var t=nr(e),n=xl(t);return n===t?e:bl(e,n)}function kl(e){return 6144&e.flags?e:xl(e)}function xl(t){if(6291456&t.flags){if(6144&t.flags)return W;if(128&pn(t))return function(t){for(var n=e.createSymbolTable(),i=0,r=Qr(t);i<r.length;i++){var s=r[i];n.set(s.escapedName,4&s.flags?Tl(s):s)}var o=bs(t,0),a=bs(t,1);return si(t.symbol,n,e.emptyArray,e.emptyArray,o&&Us(xl(o.type),o.isReadonly),a&&Us(xl(a.type),a.isReadonly))}(t);if(65536&t.flags)return Po(e.sameMap(t.types,kl));if(il(t)||ul(t))return zs(t.target,e.sameMap(t.typeArguments,xl))}return t}function El(t){var n=!1;if(65536&t.flags)for(var i=0,r=t.types;i<r.length;i++){El(c=r[i])&&(n=!0)}if(il(t)||ul(t))for(var s=0,o=t.typeArguments;s<o.length;s++){El(c=o[s])&&(n=!0)}if(128&pn(t))for(var a=0,l=Qr(t);a<l.length;a++){var c,u=l[a];2097152&(c=nr(u)).flags&&(El(c)||tn(u.valueDeclaration,e.Diagnostics.Object_literal_s_property_0_implicitly_has_an_1_type,e.symbolName(u),vi(xl(c))),n=!0)}return n}function Sl(t,n){var i,r=vi(xl(n));switch(t.kind){case 149:case 148:i=e.Diagnostics.Member_0_implicitly_has_an_1_type;break;case 146:i=t.dotDotDotToken?e.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type:e.Diagnostics.Parameter_0_implicitly_has_an_1_type;break;case 176:i=e.Diagnostics.Binding_element_0_implicitly_has_an_1_type;break;case 228:case 151:case 150:case 153:case 154:case 186:case 187:if(!t.name)return void tn(t,e.Diagnostics.Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type,r);i=e.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type;break;default:i=e.Diagnostics.Variable_0_implicitly_has_an_1_type}tn(t,i,e.declarationNameToString(e.getNameOfDeclaration(t)),r)}function Cl(e,t){i&&N&&2097152&t.flags&&(El(t)||Sl(e,t))}function wl(e,t,n){var i,r=e.parameters.length,s=t.parameters.length;i=e.hasRestParameter&&t.hasRestParameter?Math.max(r,s):e.hasRestParameter?s:t.hasRestParameter?r:Math.min(r,s);for(var o=0;o<i;o++)n(Md(e,o),Md(t,o))}function Il(t,n,i,r){var s=r?e.map(r,Nl):e.map(t.typeParameters,Al),o=function(e){for(var t=0;t<s.length;t++)if(e===s[t].typeParameter)return s[t].isFixed=!0,Fl(o,t);return e};return o.signature=t,o.inferences=s,o.flags=n,o.compareTypes=i||Ca,o}function Al(e){return{typeParameter:e,candidates:void 0,inferredType:void 0,priority:void 0,topLevel:!0,isFixed:!1}}function Nl(e){return{typeParameter:e.typeParameter,candidates:e.candidates&&e.candidates.slice(),inferredType:e.inferredType,priority:e.priority,topLevel:e.topLevel,isFixed:e.isFixed}}function Dl(t){var n=pn(t);return!!(802816&t.flags||4&n&&e.forEach(t.typeArguments,Dl)||16&n&&t.symbol&&10288&t.symbol.flags||32&n||196608&t.flags&&function(t){void 0===t.couldContainTypeVariables&&(t.couldContainTypeVariables=e.forEach(t.types,Dl));return t.couldContainTypeVariables}(t))}function Ol(t,n){return t===n||196608&t.flags&&e.forEach(t.types,function(e){return Ol(e,n)})}function Rl(e,t,n){for(var i=0,r=Qr(t);i<r.length;i++){var s=r[i];if(n||!(16777216&s.flags))if(!fs(e,s.escapedName))return s}}function Ll(t,n,i,r){var s,o;function a(t,n){if(Dl(n))if(t.aliasSymbol&&t.aliasTypeArguments&&t.aliasSymbol===n.aliasSymbol)for(var d=t.aliasTypeArguments,p=n.aliasTypeArguments,h=0;h<d.length;h++)a(d[h],p[h]);else{if(65536&t.flags&&65536&n.flags&&!(256&t.flags&&256&n.flags)||131072&t.flags&&131072&n.flags){if(t===n){for(var f=0,m=t.types;f<m.length;f++){a(w=m[f],w)}return}for(var g=void 0,_=0,y=t.types;_<y.length;_++){if(Pl(w=y[_],n.types))(g||(g=[])).push(w),a(w,w);else if(96&w.flags){var b=ll(w);Pl(b,n.types)&&(g||(g=[])).push(w,b)}}g&&(t=Ml(t,g),n=Ml(n,g))}if(540672&n.flags){if(8388608&t.flags||t===le)return;var v=c(n);if(v)return void(v.isFixed||(!v.candidates||r<v.priority?(v.candidates=[t],v.priority=r):r===v.priority&&v.candidates.push(t),8&r||!(16384&n.flags)||Ol(i,n)||(v.topLevel=!1)))}else if(4&pn(t)&&4&pn(n)&&t.target===n.target){d=t.typeArguments||e.emptyArray,p=n.typeArguments||e.emptyArray;var T=d.length<p.length?d.length:p.length,k=Ha(t.target);for(h=0;h<T;h++)h<k.length&&2===k[h]?l(d[h],p[h]):a(d[h],p[h])}else if(262144&t.flags&&262144&n.flags)a(t.type,n.type);else if(524288&t.flags&&524288&n.flags)a(t.objectType,n.objectType),a(t.indexType,n.indexType);else if(196608&n.flags){for(var x=0,E=void 0,S=0,C=p=n.types;S<C.length;S++){var w;c(w=C[S])?(E=w,x++):a(t,w)}if(1===x){var I=r;r|=2,a(t,E),r=I}}else if(65536&t.flags)for(var A=0,N=d=t.types;A<N.length;A++){a(N[A],n)}else if(163840&(t=us(t)).flags){var D=t.id+","+n.id;if(o&&o.get(D))return;(o||(o=e.createMap())).set(D,!0);var O=32768&n.flags&&!(16&pn(n)&&n.symbol&&32&n.symbol.flags)?n.symbol:void 0;if(O){if(e.contains(s,O))return;(s||(s=[])).push(O),u(t,n),s.pop()}else u(t,n)}}}function l(e,t){A?(r^=1,a(e,t),r^=1):a(e,t)}function c(e){if(540672&e.flags)for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e===r.typeParameter)return r}}function u(t,n){if(Xr(t)&&Xr(n)&&(a(Jr(t),Jr(n)),a(Yr(t),Yr(n))),32&pn(n)){var i=Jr(n);if(262144&i.flags){var s=c(i.type);if(s&&!s.isFixed){var o=function(t,n){var i=ts(t),r=bs(t,0);if(0!==i.length||r){for(var s=Al(Wo(Jr(n).type,qr(n))),o=[s],a=Yr(n),l=!n.declaration.readonlyToken,c=n.declaration.questionToken?0:16777216,u=e.createSymbolTable(),d=0,p=i;d<p.length;d++){var h=p[d],f=_(nr(h));if(!f)return;var m=nn(4|h.flags&c,h.escapedName);m.checkFlags=l&&Yd(h)?8:0,m.declarations=h.declarations,m.type=f,u.set(h.escapedName,m)}if(r){var g=_(r.type);if(!g)return;r=Us(g,l&&r.isReadonly)}return si(void 0,u,e.emptyArray,e.emptyArray,r,void 0)}function _(e){return s.candidates=void 0,Ll(o,e,a),s.candidates&&Po(s.candidates,!0)}}(t,n);if(o){var l=r;r|=4,a(o,s.typeParameter),r=l}}return}if(16384&i.flags)return a(Vo(t),i),void a(Po(e.map(ts(t),nr)),Yr(n))}Rl(t,n,!1)&&Rl(n,t,!1)||(function(e,t){for(var n=Qr(t),i=0,r=n;i<r.length;i++){var s=r[i],o=fs(e,s.escapedName);o&&a(nr(o),nr(s))}}(t,n),d(t,n,0),d(t,n,1),function(e,t){var n=vs(t,0);if(n){(r=vs(e,0)||Ts(e,0))&&a(r,n)}var i=vs(t,1);if(i){var r;(r=vs(e,1)||vs(e,0)||Ts(e,1))&&a(r,i)}}(t,n))}function d(e,t,n){for(var i=gs(e,n),r=gs(t,n),s=i.length,o=r.length,a=s<o?s:o,l=0;l<a;l++)p(Ps(i[s-a+l]),Ps(r[o-a+l]))}function p(e,t){wl(e,t,l),e.typePredicate&&t.typePredicate&&e.typePredicate.kind===t.typePredicate.kind?a(e.typePredicate.type,t.typePredicate.type):a(Ds(e),Ds(t))}void 0===r&&(r=0),a(n,i)}function Pl(e,t){for(var n=0,i=t;n<i.length;n++){if(Ea(i[n],e))return!0}return!1}function Ml(e,t){for(var n=[],i=0,r=e.types;i<r.length;i++){var s=r[i];Pl(s,t)||n.push(s)}return 65536&e.flags?Po(n):$o(n)}function Fl(t,n){var i,r=t.inferences[n],s=r.inferredType;if(!s){if(r.candidates){var o=t.signature,a=r.topLevel&&!function(e){var t=ns(e);return t&&ep(t,270334)}(r.typeParameter)&&(r.isFixed||!Ol(Ds(o),r.typeParameter)),l=a?e.sameMap(r.candidates,cl):r.candidates;s=xl(1&r.priority?(i=l,e.reduceLeft(i,function(e,t){return wa(t,e)?t:e})):1&t.flags||8&r.priority?Po(l,!0):function(t){if(!I)return nl(t);var n=e.filter(t,function(e){return!(6144&e.flags)});return n.length?gl(nl(n),6144&dl(t)):Po(t,!0)}(l))}else if(2&t.flags)s=le;else{var c=ls(r.typeParameter);s=c?ya(c,pa(function(t,n){return function(i){return e.indexOf(t,i)>=n?ue:i}}(t.signature.typeParameters,n),t)):Bl(!!(4&t.flags))}r.inferredType=s;var u=ns(t.signature.typeParameters[n]);if(u){var d=ya(u,t);t.compareTypes(s,Lr(d,s))||(r.inferredType=s=d)}}return s}function Bl(e){return e?W:ue}function $l(e){for(var t=[],n=0;n<e.inferences.length;n++)t.push(Fl(e,n));return t}function Ul(t){var n=dn(t);return n.resolvedSymbol||(n.resolvedSymbol=!e.nodeIsMissing(t)&&gn(t,t.escapedText,1156031,e.Diagnostics.Cannot_find_name_0,t,!e.isWriteOnlyAccess(t),e.Diagnostics.Cannot_find_name_0_Did_you_mean_1)||K),n.resolvedSymbol}function Vl(t){return!!e.findAncestor(t,function(e){return 162===e.kind||71!==e.kind&&143!==e.kind&&"quit"})}function Hl(t){if(71===t.kind){var n=Ul(t);return n!==K?(Pc(t)?"@":"")+a(n):void 0}if(99===t.kind)return"0";if(179===t.kind)return(r=Hl(t.expression))&&r+"."+e.idText(t.name);if(176===t.kind){var i=t.parent.parent,r=176===i.kind?Hl(i):i.initializer&&Hl(i.initializer),s=Gl(t);return r&&s&&r+"."+s}}function Gl(t){if(174!==t.parent.kind)return""+t.parent.elements.indexOf(t);var n=t.propertyName||t.name;switch(n.kind){case 71:return e.idText(n);case 144:return e.isStringOrNumericLiteral(n.expression)?n.expression.text:void 0;case 9:case 8:return n.text;default:e.Debug.fail("Unexpected name kind for binding element name")}}function jl(e,t){switch(e.kind){case 71:return 71===t.kind&&Ul(e)===Ul(t)||(226===t.kind||176===t.kind)&&Yn(Ul(e))===qn(t);case 99:return 99===t.kind;case 97:return 97===t.kind;case 179:return 179===t.kind&&e.name.escapedText===t.name.escapedText&&jl(e.expression,t.expression);case 176:if(179!==t.kind)return!1;var n=t;if(n.name.escapedText!==Gl(e))return!1;if(176===e.parent.parent.kind&&jl(e.parent.parent,n.expression))return!0;if(226===e.parent.parent.kind){var i=e.parent.parent.initializer;return i&&jl(i,n.expression)}}return!1}function Kl(e,t){for(;179===e.kind;)if(jl(e=e.expression,t))return!0;return!1}function zl(e,t){return 179===t.kind&&Kl(e,t.expression)&&ql(Wl(t.expression),t.name.escapedText)}function Wl(e){if(71===e.kind)return nr(Ul(e));if(179===e.kind){var t=Wl(e.expression);return t&&Mi(t,e.name.escapedText)}}function ql(t,n){if(t&&65536&t.flags){var i=ps(t,n);if(i&&2&e.getCheckFlags(i))return void 0===i.isDiscriminantProperty&&(i.isDiscriminantProperty=32&i.checkFlags&&al(nr(i))),i.isDiscriminantProperty}return!1}function Jl(e,t){return jl(e,t)||Kl(e,t)}function Yl(e,t){if(e!==t){if(8192&t.flags)return t;var n=mc(e,function(e){return function(e,t){if(!(65536&e.flags))return Ia(e,t);for(var n=0,i=e.types;n<i.length;n++)if(Ia(i[n],t))return!0;return!1}(t,e)});if(!(8192&n.flags))return n}return e}function Xl(e){var t=e.flags;if(2&t)return I?4079361:4194049;if(32&t){var n=""===e.value;return I?n?3030785:1982209:n?3145473:4194049}if(20&t)return I?4079234:4193922;if(64&t){var i=0===e.value;return I?i?3030658:1982082:i?3145346:4193922}return 8&t?I?4078980:4193668:136&t?I?e===ie?3030404:1981828:e===ie?3145092:4193668:32768&t?function(e){var t=Zr(e);return!!(t.callSignatures.length||t.constructSignatures.length||t.members.get("bind")&&wa(e,xe))}(e)?I?6164448:8376288:I?6166480:8378320:3072&t?2457472:4096&t?2340752:512&t?I?1981320:4193160:16777216&t?I?6166480:8378320:540672&t?Xl(rs(e)||ue):196608&t?function(e){for(var t=0,n=0,i=e;n<i.length;n++)t|=Xl(i[n]);return t}(e.types):8388607}function Zl(e,t){if(524288&e.flags){var n=rs(e)||ue,i=mc(n,function(e){return 0!==(Xl(e)&t)});return i!==n?i:e}return mc(e,function(e){return 0!==(Xl(e)&t)})}function Ql(e,t){if(t){var n=kp(t);return Po([Zl(e,131072),n])}return e}function ec(t,n){var i=e.getTextOfPropertyName(n);return Mi(t,i)||mu(i)&&vs(t,1)||vs(t,0)||J}function tc(e,t){return sl(e)&&Mi(e,""+t)||Ch(e,void 0,!1,!1)||J}function nc(e){return So(Ch(e,void 0,!1,!1)||J)}function ic(e){return 194===e.parent.kind&&e.parent.left===e||216===e.parent.kind&&e.parent.initializer===e}function rc(e){return ec(sc(e.parent),e.name)}function sc(t){var n=t.parent;switch(n.kind){case 215:return ee;case 216:return Sh(n.expression,n.awaitModifier)||J;case 194:return function(e){return 177===e.parent.kind&&ic(e.parent)||261===e.parent.kind&&ic(e.parent.parent)?Ql(sc(e),e.right):kp(e.right)}(n);case 188:return Y;case 177:return function(t,n){return tc(sc(t),e.indexOf(t.elements,n))}(n,t);case 198:return function(e){return nc(sc(e.parent))}(n);case 261:return rc(n);case 262:return function(e){return Ql(rc(e),e.objectAssignmentInitializer)}(n)}return J}function oc(e){return e.initializer?function(e){return dn(e).resolvedType||kp(e)}(e.initializer):215===e.parent.parent.kind?ee:216===e.parent.parent.kind&&Sh(e.parent.parent.expression,e.parent.parent.awaitModifier)||J}function ac(t){return 226===t.kind?oc(t):function(t){var n=t.parent,i=ac(n.parent);return Ql(174===n.kind?ec(i,t.propertyName||t.name):t.dotDotDotToken?nc(i):tc(i,e.indexOf(n.elements,t)),t.initializer)}(t)}function lc(e){return 226===e.kind||176===e.kind?ac(e):sc(e)}function cc(e){switch(e.kind){case 185:return cc(e.expression);case 194:switch(e.operatorToken.kind){case 58:return cc(e.left);case 26:return cc(e.right)}}return e}function uc(e){var t=e.parent;return 185===t.kind||194===t.kind&&58===t.operatorToken.kind&&t.left===e||194===t.kind&&26===t.operatorToken.kind&&t.right===e?uc(t):e}function dc(e){if(257===e.kind){var t=ra(kp(e.expression));return ol(t)?t:void 0}return ae}function pc(t){var n=dn(t);if(!n.switchTypes){n.switchTypes=[];for(var i=0,r=t.caseBlock.clauses;i<r.length;i++){var s=dc(r[i]);if(void 0===s)return n.switchTypes=e.emptyArray;n.switchTypes.push(s)}}return n.switchTypes}function hc(e,t){return e===t||65536&t.flags&&function(e,t){if(65536&e.flags){for(var n=0,i=e.types;n<i.length;n++){var r=i[n];if(!Ao(t.types,r))return!1}return!0}if(256&e.flags&&kr(e)===t)return!0;return Ao(t.types,e)}(e,t)}function fc(t,n){return 65536&t.flags?e.forEach(t.types,n):n(t)}function mc(t,n){if(65536&t.flags){var i=t.types,r=e.filter(i,n);return r===i?t:Mo(r)}return n(t)?t:ae}function gc(e,t){if(!(65536&e.flags))return t(e);for(var n,i,r=0,s=e.types;r<s.length;r++){var o=t(s[r]);o&&(n?i?i.push(o):i=[n,o]:n=o)}return i?Po(i):n}function _c(e,t){return mc(e,function(e){return 0!==(e.flags&t)})}function yc(e,t){return hc(ee,e)&&ep(t,32)||hc(te,e)&&ep(t,64)?gc(e,function(e){return 2&e.flags?_c(t,34):4&e.flags?_c(t,68):e}):e}function bc(e){return 0===e.flags}function vc(e){return 0===e.flags?e.type:e}function Tc(e,t){return t?{flags:0,type:e}:e}function kc(e){return j[e.id]||(j[e.id]=function(e){var t=ti(256);return t.elementType=e,t}(e))}function xc(e,t){var n=ll(function(e){var t=e.contextualType;e.contextualType=W;var n=kp(e);return e.contextualType=t,n}(t));return hc(n,e.elementType)?e:kc(Po([e.elementType,n]))}function Ec(e){return e.finalArrayType||(e.finalArrayType=8192&(t=e.elementType).flags?Oe:So(65536&t.flags?Po(t.types,!0):t));var t}function Sc(e){return 256&pn(e)?Ec(e):e}function Cc(e){return 256&pn(e)?e.elementType:ae}function wc(t,n){return function(e){for(var t=!1,n=0,i=e;n<i.length;n++){var r=i[n];if(!(8192&r.flags)){if(!(256&pn(r)))return!1;t=!0}}return t}(t)?kc(Po(e.map(t,Cc))):Po(e.sameMap(t,Sc),n)}function Ic(t){var n=uc(t),i=n.parent,r=179===i.kind&&("length"===i.name.escapedText||181===i.parent.kind&&e.isPushOrUnshiftIdentifier(i.name)),s=180===i.kind&&i.expression===n&&194===i.parent.kind&&58===i.parent.operatorToken.kind&&i.parent.left===i&&!e.isAssignmentTarget(i.parent)&&tp(kp(i.argumentExpression),84);return r||s}function Ac(t){var n=dn(t);return void 0===n.maybeTypePredicate&&(n.maybeTypePredicate=function(t){if(97!==t.expression.kind){var n=Uu(t.expression);if(n!==le){var i=us(n);if(i!==J){var r=gs(i,0);return!!e.forEach(r,function(e){return e.typePredicate})}}}return!1}(t)),n.maybeTypePredicate}function Nc(t,n,i,r,o){var a;void 0===i&&(i=n);var l=0;if(ut)return J;if(!t.flowNode||!o&&!(17810175&n.flags))return n;var c=ct,u=vc(p(t.flowNode));ct=c;var d=256&pn(u)&&Ic(t)?De:Sc(u);return 203===t.parent.kind&&8192&Zl(d,524288).flags?n:d;function p(s){if(2500===l)return ut=!0,o=t,a=e.findAncestor(o,e.isFunctionOrModuleBlock),u=e.getSourceFileOfNode(o),d=e.getSpanOfTokenAtPosition(u,a.statements.pos),Nt.add(e.createFileDiagnostic(u,d.start,d.length,e.Diagnostics.The_containing_function_or_module_body_is_too_large_for_control_flow_analysis)),J;var o,a,u,d;for(l++;;){var b=s.flags;if(1024&b)for(var v=c;v<ct;v++)if(St[v]===s)return l--,Ct[v];var T=void 0;if(4096&b)s.locked=!0,T=p(s.antecedent),s.locked=!1;else{if(2048&b){s=s.antecedent;continue}if(16&b){if(!(T=h(s))){s=s.antecedent;continue}}else if(96&b)T=m(s);else if(128&b)T=g(s);else if(12&b){if(1===s.antecedents.length){s=s.antecedents[0];continue}T=4&b?_(s):y(s)}else if(256&b){if(!(T=f(s))){s=s.antecedent;continue}}else if(2&b){var k=s.container;if(k&&k!==r&&179!==t.kind&&99!==t.kind){s=k.flowNode;continue}T=i}else T=yh(n)}return 1024&b&&(St[ct]=s,Ct[ct]=T,ct++),l--,T}}function h(i){var r=i.node;if(jl(t,r)){if(2===e.getAssignmentTargetKind(r)){var s=p(i.antecedent);return Tc(ll(vc(s)),bc(s))}if(n===q||n===Oe){if(function(e){return 226===e.kind&&e.initializer&&Gi(e.initializer)||176!==e.kind&&194===e.parent.kind&&Gi(e.parent.right)}(r))return kc(ae);var o=ll(lc(r));return Ia(o,n)?o:De}return 65536&n.flags?Yl(n,lc(r)):n}if(Kl(t,r))return n}function f(e){if(n===q||n===Oe){var i=e.node,r=181===i.kind?i.expression.expression:i.left.expression;if(jl(t,cc(r))){var s=p(e.antecedent),o=vc(s);if(256&pn(o)){var a=o;if(181===i.kind)for(var l=0,c=i.arguments;l<c.length;l++){a=xc(a,c[l])}else tp(kp(i.left.argumentExpression),84)&&(a=xc(a,i.right));return a===o?s:Tc(a,bc(s))}return s}}}function m(e){var t=p(e.antecedent),n=vc(t);if(8192&n.flags)return t;var i=!!(32&e.flags),r=Sc(n),s=A(r,e.expression,i);if(s===r)return t;var o=bc(t);return Tc(o&&8192&s.flags?le:s,o)}function g(e){var n=p(e.antecedent),i=vc(n),r=e.switchStatement.expression;return jl(t,r)?i=S(i,e.switchStatement,e.clauseStart,e.clauseEnd):b(r,i)&&(i=v(i,r,function(t){return S(t,e.switchStatement,e.clauseStart,e.clauseEnd)})),Tc(i,bc(n))}function _(t){for(var r=[],s=!1,o=!1,a=0,l=t.antecedents;a<l.length;a++){var c=l[a];if(!(2048&c.flags&&c.lock.locked)){var u=p(c),d=vc(u);if(d===n&&n===i)return d;e.pushIfUnique(r,d),hc(d,n)||(s=!0),bc(u)&&(o=!0)}}return Tc(wc(r,s),o)}function y(i){var r=function(e){return e.id||(e.id=s,s++),e.id}(i),o=Tt[r]||(Tt[r]=e.createMap());if(!a&&!(a=Hl(t)))return n;var l=o.get(a);if(l)return l;for(var c=at;c<lt;c++)if(kt[c]===i&&xt[c]===a&&Et[c].length)return Tc(wc(Et[c],!1),!0);var u,d=[],h=!1;kt[lt]=i,xt[lt]=a,Et[lt]=d;for(var f=0,m=i.antecedents;f<m.length;f++){var g=m[f];lt++;var _=p(g);lt--,u||(u=_);var y=vc(_),b=o.get(a);if(b)return b;if(e.pushIfUnique(d,y),hc(y,n)||(h=!0),y===n)break}var v=wc(d,h);return bc(u)?Tc(v,!0):(o.set(a,v),v)}function b(e,n){return 179===e.kind&&65536&n.flags&&jl(t,e.expression)&&ql(n,e.name.escapedText)}function v(e,t,n){var i=t.name.escapedText,r=Mi(e,i),s=r&&n(r);return r===s?e:mc(e,function(e){return Na(Mi(e,i),s)})}function T(e,i,r){return jl(t,i)?Zl(e,r?1048576:2097152):b(i,n)?v(e,i,function(e){return Zl(e,r?1048576:2097152)}):zl(t,i)?n:e}function k(i,r,s){switch(r.operatorToken.kind){case 58:return T(i,r.left,s);case 32:case 33:case 34:case 35:var o=r.operatorToken.kind,a=cc(r.left),l=cc(r.right);if(189===a.kind&&9===l.kind)return E(i,a,o,l,s);if(189===l.kind&&9===a.kind)return E(i,l,o,a,s);if(jl(t,a))return x(i,o,l,s);if(jl(t,l))return x(i,o,a,s);if(b(a,n))return v(i,a,function(e){return x(e,o,l,s)});if(b(l,n))return v(i,l,function(e){return x(e,o,a,s)});if(zl(t,a)||zl(t,l))return n;break;case 93:return function(i,r,s){var o=cc(r.left);if(!jl(t,o))return Kl(t,o)?n:i;var a,l=kp(r.right);if(!wa(l,xe))return i;var c=fs(l,"prototype");if(c){var u=nr(c);Fi(u)||(a=u)}if(Fi(i)&&(a===ke||a===xe))return i;if(!a){var d=void 0;2&pn(l)?d=Rr(l).declaredConstructSignatures:16&pn(l)&&(d=gs(l,1)),d&&d.length&&(a=Po(e.map(d,function(e){return Ds(Ps(e))})))}if(a)return C(i,a,s,Aa);return i}(i,r,s);case 26:return A(i,r.right,s)}return i}function x(e,t,n,i){if(1&e.flags)return e;33!==t&&35!==t||(i=!i);var r=kp(n);if(6144&r.flags)return I?Zl(e,32===t||33===t?i?65536:524288:95===n.kind?i?32768:262144:i?16384:131072):e;if(16810497&e.flags)return e;if(i){var s=mc(e,function(e){return Na(t=e,n=r)||Na(n,t);var t,n});return 8192&s.flags?e:yc(s,r)}if(ol(r)){var o=ra(r);return mc(e,function(e){return ra(e)!==o})}return e}function E(e,i,r,s,o){var a=cc(i.expression);if(!jl(t,a))return Kl(t,a)?n:e;if(33!==r&&35!==r||(o=!o),o&&!(65536&e.flags)){var l=Vt.get(s.text);if(l){if(wa(l,e))return l;if(540672&e.flags)if(wa(l,rs(e)||W))return $o([e,l])}}return Zl(e,o?$t.get(s.text)||64:Ut.get(s.text)||8192)}function S(t,n,i,r){var s=pc(n);if(!s.length)return t;var o=s.slice(i,r),a=i===r||e.contains(o,ae),l=Po(o),c=8192&l.flags?ae:yc(mc(t,function(e){return Na(l,e)}),l);if(!a)return c;var u=mc(t,function(t){return!(ol(t)&&e.contains(s,ra(t)))});return 8192&c.flags?u:Po([c,u])}function C(e,t,n,i){if(!n)return mc(e,function(e){return!i(e,t)});if(65536&e.flags){var r=mc(e,function(e){return i(e,t)});if(!(8192&r.flags))return r}return wa(t,e)?t:Ia(e,t)?e:Ia(t,e)?t:$o([e,t])}function w(i,r,s){if(!function(e,t){if(e.arguments)for(var n=0,i=e.arguments;n<i.length;n++)if(Jl(t,i[n]))return!0;return!(179!==e.expression.kind||!Jl(t,e.expression.expression))}(r,t)||!Ac(r))return i;var o=wd(r),a=o.typePredicate;if(!a)return i;if(Fi(i)&&(a.type===ke||a.type===xe))return i;if(e.isIdentifierTypePredicate(a)){var l=r.arguments[a.parameterIndex-(o.thisParameter?1:0)];if(l){if(jl(t,l))return C(i,a.type,s,wa);if(Kl(t,l))return n}}else{var c=e.skipParentheses(r.expression);if(180===c.kind||179===c.kind){var u=c,d=e.skipParentheses(u.expression);if(jl(t,d))return C(i,a.type,s,wa);if(Kl(t,d))return n}}return i}function A(e,t,n){switch(t.kind){case 71:case 99:case 97:case 179:return T(e,t,n);case 181:return w(e,t,n);case 185:return A(e,t.expression,n);case 194:return k(e,t,n);case 192:if(51===t.operator)return A(e,t.operand,!n)}return e}}function Dc(t){return e.findAncestor(t.parent,function(t){return e.isFunctionLike(t)&&!e.getImmediatelyInvokedFunctionExpression(t)||234===t.kind||265===t.kind||149===t.kind})}function Oc(t){var n,i=e.getRootDeclaration(t.valueDeclaration).parent,r=dn(i);return 4194304&r.flags||(r.flags|=4194304,n=i,e.findAncestor(n.parent,function(t){return e.isFunctionLike(t)&&!!(4194304&dn(t).flags)})||Rc(i)),t.isAssigned||!1}function Rc(t){if(71===t.kind){if(e.isAssignmentTarget(t)){var n=Ul(t);n.valueDeclaration&&146===e.getRootDeclaration(n.valueDeclaration).kind&&(n.isAssigned=!0)}}else e.forEachChild(t,Rc)}function Lc(e){return 3&e.flags&&!!(2&Fu(e))&&nr(e)!==Oe}function Pc(e){var t=e.parent;return 179===t.kind||181===t.kind&&t.expression===e||180===t.kind&&t.expression===e}function Mc(e){return 540672&e.flags&&ep(rs(e)||ue,6144)}function Fc(e,t){var n=nr(e);return Pc(t)&&fc(n,Mc)?gc(xl(n),us):n}function Bc(t){var n=Ul(t);if(n===K)return J;if(n===F){var i=e.getContainingFunction(t);return E<2&&(187===i.kind?tn(t,e.Diagnostics.The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_standard_function_expression):e.hasModifier(i,256)&&tn(t,e.Diagnostics.The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_using_a_standard_function_or_method)),dn(i).flags|=8192,nr(n)}!In(n,107455)||Vl(t)||Nf(Nn(n))||On(n);var r=Yn(n),s=r.valueDeclaration;if(32&r.flags)if(229===s.kind&&e.nodeIsDecorated(s))for(i=e.getContainingClass(t);void 0!==i;){if(i===s&&i.name!==t){dn(s).flags|=8388608,dn(t).flags|=16777216;break}i=e.getContainingClass(i)}else if(199===s.kind)for(i=e.getThisContainer(t,!1);void 0!==i;){if(i.parent===s){149===i.kind&&e.hasModifier(i,32)&&(dn(s).flags|=8388608,dn(t).flags|=16777216);break}i=e.getThisContainer(i,!1)}fh(t,t),uh(t,t),dh(t,t),function(t,n){if(E>=2||!(34&n.flags)||260===n.valueDeclaration.parent.kind)return;var i=e.getEnclosingBlockScopeContainer(n.valueDeclaration),r=function(t,n){return!!e.findAncestor(t,function(t){return t===n?"quit":e.isFunctionLike(t)})}(t.parent,i),s=i,o=!1;for(;s&&!e.nodeStartsNewLexicalEnvironment(s);){if(e.isIterationStatement(s,!1)){o=!0;break}s=s.parent}o&&(r&&(dn(s).flags|=65536),214===i.kind&&e.getAncestor(n.valueDeclaration,227).parent===i&&function(t,n){var i=t;for(;185===i.parent.kind;)i=i.parent;var r=!1;if(e.isAssignmentTarget(i))r=!0;else if(192===i.parent.kind||193===i.parent.kind){var s=i.parent;r=43===s.operator||44===s.operator}if(!r)return!1;return!!e.findAncestor(i,function(e){return e===n?"quit":e===n.statement})}(t,i)&&(dn(n.valueDeclaration).flags|=2097152),dn(n.valueDeclaration).flags|=262144);r&&(dn(n.valueDeclaration).flags|=131072)}(t,n);var o=Fc(r,t),a=e.getAssignmentTargetKind(t);if(a){if(!(3&r.flags))return tn(t,e.Diagnostics.Cannot_assign_to_0_because_it_is_not_a_variable,yi(n)),J;if(Yd(r))return tn(t,e.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,yi(n)),J}var l=2097152&r.flags;if(3&r.flags){if(1===a)return o}else{if(!l)return o;s=e.find(n.declarations,u)}if(!s)return o;for(var c=146===e.getRootDeclaration(s).kind,d=Dc(s),p=Dc(t),h=p!==d;p!==d&&(186===p.kind||187===p.kind||e.isObjectLiteralOrClassExpressionMethod(p))&&(Lc(r)||c&&!Oc(r));)p=Dc(p);var f=c||l||h||o!==q&&o!==Oe&&(!I||!!(1&o.flags)||Vl(t)||246===t.parent.kind)||203===t.parent.kind||e.isInAmbientContext(s),m=f?c?function(e,t){return I&&146===t.kind&&t.initializer&&2048&pl(e)&&!(2048&pl(xp(t.initializer)))?Zl(e,131072):e}(o,e.getRootDeclaration(s)):o:o===q||o===Oe?Y:gl(o,2048),g=Nc(t,o,m,p,!f);if(o===q||o===Oe){if(g===q||g===Oe)return N&&(tn(e.getNameOfDeclaration(s),e.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined,yi(n),vi(g)),tn(t,e.Diagnostics.Variable_0_implicitly_has_an_1_type,yi(n),vi(g))),yh(g)}else if(!f&&!(2048&pl(o))&&2048&pl(g))return tn(t,e.Diagnostics.Variable_0_is_used_before_being_assigned,yi(n)),o;return a?ll(g):g}function $c(e,t){(dn(e).flags|=2,149===t.kind||152===t.kind)?dn(t.parent).flags|=4:dn(t).flags|=4}function Uc(t){return e.isSuperCall(t)?t:e.isFunctionLike(t)?void 0:e.forEachChild(t,Uc)}function Vc(e){var t=dn(e);return void 0===t.hasSuperCall&&(t.superCall=Uc(e.body),t.hasSuperCall=!!t.superCall),t.superCall}function Hc(e){return gr(Cr(qn(e)))===Q}function Gc(t,n,i){var r=n.parent;if(e.getClassExtendsHeritageClauseElement(r)&&!Hc(r)){var s=Vc(n);(!s||s.end>t.pos)&&tn(t,i)}}function jc(t){var n=e.getThisContainer(t,!0),i=!1;switch(152===n.kind&&Gc(t,n,e.Diagnostics.super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class),187===n.kind&&(n=e.getThisContainer(n,!1),i=E<2),n.kind){case 233:tn(t,e.Diagnostics.this_cannot_be_referenced_in_a_module_or_namespace_body);break;case 232:tn(t,e.Diagnostics.this_cannot_be_referenced_in_current_location);break;case 152:Kc(t,n)&&tn(t,e.Diagnostics.this_cannot_be_referenced_in_constructor_arguments);break;case 149:case 148:e.hasModifier(n,32)&&tn(t,e.Diagnostics.this_cannot_be_referenced_in_a_static_property_initializer);break;case 144:tn(t,e.Diagnostics.this_cannot_be_referenced_in_a_computed_property_name)}if(i&&$c(t,n),e.isFunctionLike(n)&&(!Xc(t)||e.getThisParameter(n))){if(186===n.kind&&194===n.parent.kind&&3===e.getSpecialPropertyAssignmentKind(n.parent)){var r=xp(n.parent.left.expression.expression).symbol;if(r&&r.members&&16&r.flags)return Ad(r)}var s=Zi(n)||Jc(n);if(s)return s}if(e.isClassLike(n.parent)){var o=qn(n.parent);return Nc(t,a=e.hasModifier(n,32)?nr(o):Cr(o).thisType)}if(e.isInJavaScriptFile(t)){var a=function(t){var n=e.getJSDocType(t);if(n&&273===n.kind){var i=n;if(i.parameters.length>0&&i.parameters[0].name&&"this"===i.parameters[0].name.escapedText)return aa(i.parameters[0].type)}}(n);if(a&&a!==J)return a}return D&&tn(t,e.Diagnostics.this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation),W}function Kc(t,n){return!!e.findAncestor(t,function(e){return e===n?"quit":146===e.kind})}function zc(t){var n=181===t.parent.kind&&t.parent.expression===t,i=e.getSuperContainer(t,!0),r=!1;if(!n)for(;i&&187===i.kind;)i=e.getSuperContainer(i,!0),r=E<2;var s=function(t){if(!t)return!1;if(n)return 152===t.kind;if(e.isClassLike(t.parent)||178===t.parent.kind)return e.hasModifier(t,32)?151===t.kind||150===t.kind||153===t.kind||154===t.kind:151===t.kind||150===t.kind||153===t.kind||154===t.kind||149===t.kind||148===t.kind||152===t.kind;return!1}(i),o=0;if(!s){var a=e.findAncestor(t,function(e){return e===i?"quit":144===e.kind});return a&&144===a.kind?tn(t,e.Diagnostics.super_cannot_be_referenced_in_a_computed_property_name):n?tn(t,e.Diagnostics.Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors):i&&i.parent&&(e.isClassLike(i.parent)||178===i.parent.kind)?tn(t,e.Diagnostics.super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_derived_class):tn(t,e.Diagnostics.super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions),J}if(n||152!==i.kind||Gc(t,i,e.Diagnostics.super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class),o=e.hasModifier(i,32)||n?512:256,dn(t).flags|=o,151===i.kind&&e.hasModifier(i,256)&&(e.isSuperProperty(t.parent)&&e.isAssignmentTarget(t.parent)?dn(i).flags|=4096:dn(i).flags|=2048),r&&$c(t.parent,i),178===i.parent.kind)return E<2?(tn(t,e.Diagnostics.super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_higher),J):W;var l=i.parent,c=Cr(qn(l)),u=c&&_r(c)[0];return u?152===i.kind&&Kc(t,i)?(tn(t,e.Diagnostics.super_cannot_be_referenced_in_constructor_arguments),J):512===o?gr(c):Lr(u,c.thisType):(e.getClassExtendsHeritageClauseElement(l)||tn(t,e.Diagnostics.super_can_only_be_referenced_in_a_derived_class),J)}function Wc(e){return 4&pn(e)&&e.target===Ne?e.typeArguments[0]:void 0}function qc(t){return gc(t,function(t){return 131072&t.flags?e.forEach(t.types,Wc):Wc(t)})}function Jc(t){if(187!==t.kind){if(ka(t)){var n=du(t);if(n){var i=n.thisParameter;if(i)return nr(i)}}var r=e.isInJavaScriptFile(t);if(D||r){var s=function(e){return 151!==e.kind&&153!==e.kind&&154!==e.kind||178!==e.parent.kind?186===e.kind&&261===e.parent.kind?e.parent.parent:void 0:e.parent}(t);if(s){for(var o=ru(s),a=s,l=o;l;){var c=qc(l);if(c)return ya(c,ou(s));if(261!==a.parent.kind)break;l=ru(a=a.parent.parent)}return o?_l(o):fp(s)}var u=t.parent;if(194===u.kind&&58===u.operatorToken.kind){var d=u.left;if(179===d.kind||180===d.kind){var p=d.expression;if(r&&e.isIdentifier(p)){var h=e.getSourceFileOfNode(u);if(h.commonJsModuleIndicator&&Ul(p)===h.symbol)return}return fp(p)}}}}}function Yc(t){var n=t.parent;if(ka(n)){var i=e.getImmediatelyInvokedFunctionExpression(n);if(i&&i.arguments){var r=e.indexOf(n.parameters,t);if(t.dotDotDotToken){for(var s=[],o=r;o<i.arguments.length;o++)s.push(cl(xp(i.arguments[o])));return s.length?So(Po(s)):void 0}var a=dn(i),l=a.resolvedSignature;a.resolvedSignature=et;var c=r<i.arguments.length?cl(xp(i.arguments[r])):t.initializer?void 0:X;return a.resolvedSignature=l,c}var u=du(n);if(u){var d=e.hasRestParameter(n),p=n.parameters.length-(d?1:0);r=e.indexOf(n.parameters,t);if(void 0===e.getThisParameter(n)||u.thisParameter||(e.Debug.assert(0!==r),r-=1),r<p)return Md(u,r);if(d&&r===n.parameters.length-1&&tl(u,n.parameters.length-1))return nr(e.lastOrUndefined(u.parameters))}}}function Xc(t){for(;t.parent&&!e.isFunctionLike(t.parent);){if(146===t.parent.kind&&t.parent.initializer===t)return!0;t=t.parent}return!1}function Zc(t){if(152===t.kind||e.getEffectiveReturnTypeNode(t)||Oh(t))return Ds(Is(t));var n=cu(t);return n&&!function(e){return!e.resolvedReturnType&&Oi(e,3)>=0}(n)?Ds(n):void 0}function Qc(t,n){var i=pd(t),r=e.indexOf(i,n);if(r>=0)return Md(dn(t).resolvedSignature===nt?nt:wd(t),r)}function eu(e,t){return gc(e,function(e){var n=229376&e.flags?fs(e,t):void 0;return n?nr(n):void 0})}function tu(e,t){return gc(e,function(e){return ys(e,t)})}function nu(t){var n=ru(t.parent);if(n){if(!e.hasDynamicName(t)){var i=eu(n,qn(t).escapedName);if(i)return i}return fu(t.name)&&tu(n,1)||tu(n,0)}}function iu(e,t){return e&&(eu(e,""+t)||tu(e,1)||wh(e,void 0,!1,!1,!1))}function ru(e){var t=su(e);return t&&us(t)}function su(t){if(!cf(t)){if(t.contextualType)return t.contextualType;var n=t.parent;switch(n.kind){case 226:case 146:case 149:case 148:case 176:return function(t){var n=t.parent;if(t===n.initializer){var i=e.getEffectiveTypeAnnotationNode(n);if(i)return aa(i);if(146===n.kind){var r=Yc(n);if(r)return r}if(e.isBindingPattern(n.name))return Wi(n.name,!0,!1);if(e.isBindingPattern(n.parent)){var s=n.parent.parent,o=n.propertyName||n.name;if(176!==s.kind){var a=e.getEffectiveTypeAnnotationNode(s);if(a&&!e.isBindingPattern(o)){var l=e.getTextOfPropertyName(o);if(l)return Mi(aa(a),l)}}}}}(t);case 187:case 219:return function(t){var n=e.getContainingFunction(t);if(n){var i=e.getFunctionFlags(n);if(1&i)return;var r=Zc(n);return 2&i?r&&Hp(r):r}}(t);case 197:return function(t){var n=e.getContainingFunction(t);if(n){var i=e.getFunctionFlags(n),r=Zc(n);if(r)return t.asteriskToken?r:Nh(r,!!(2&i))}}(n);case 181:case 182:return Qc(n,t);case 184:case 202:return aa(n.type);case 194:return function(t){var n=t.parent,i=n.operatorToken.kind;if(e.isAssignmentOperator(i)){if(t===n.right){switch(e.getSpecialPropertyAssignmentKind(n)){case 0:break;case 5:if(!n.left.symbol)break;case 1:case 2:case 3:case 4:return}return kp(n.left)}}else{if(54===i){var r=su(n);return r||t!==n.right||(r=kp(n.left,!0)),r}if((53===i||26===i)&&t===n.right)return su(n)}}(t);case 261:case 262:return nu(n);case 263:return ru(n.parent);case 177:var i=n;return iu(ru(i),e.indexOfNode(i.elements,t));case 195:return function(e){var t=e.parent;return e===t.whenTrue||e===t.whenFalse?su(t):void 0}(t);case 205:return e.Debug.assert(196===n.parent.kind),function(e,t){if(183===e.parent.kind)return Qc(e.parent,t)}(n.parent,t);case 185:var r=e.isInJavaScriptFile(n)?e.getJSDocTypeTag(n):void 0;return r?aa(r.typeExpression.type):su(n);case 256:return function(t){var n=su(e.isJsxAttributeLike(t.parent)?t.parent.parent:t.parent.openingElement.attributes);if(n&&!Fi(n)){if(e.isJsxAttribute(t.parent))return eu(n,t.parent.name.escapedText);if(249===t.parent.kind){var i=wu();return i&&""!==i?eu(n,i):W}return n}}(n);case 253:case 255:return function(t){var n=su(t.parent);if(e.isJsxAttribute(t)){if(!n||Fi(n))return;return eu(n,t.name.escapedText)}return n}(n);case 251:case 250:return Ou(n)}}}function ou(t){return(t=e.findAncestor(t,function(e){return!!e.contextualMapper}))?t.contextualMapper:k}function au(t,n){var i=ms(t,0);if(1===i.length){var r=i[0];if(!function(t,n){for(var i=0;i<n.parameters.length;i++){var r=n.parameters[i];if(r.initializer||r.questionToken||r.dotDotDotToken||xs(r))break}n.parameters.length&&e.parameterIsThisKeyword(n.parameters[0])&&i--;var s=t.hasRestParameter?Number.MAX_VALUE:t.parameters.length;return s<i}(r,n))return r}}function lu(e){return 186===e.kind||187===e.kind}function cu(t){return lu(t)||e.isObjectLiteralMethod(t)?du(t):void 0}function uu(t){return e.isObjectLiteralMethod(t)?function(t){if(e.Debug.assert(e.isObjectLiteralMethod(t)),!cf(t))return nu(t)}(t):ru(t)}function du(t){e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t));var n=uu(t);if(n){if(!(65536&n.flags))return au(n,t);for(var i,r,s=0,o=n.types;s<o.length;s++){var a=au(o[s],t);if(a)if(i){if(!el(i[0],a,!1,!0,!0,Sa))return;i.push(a)}else i=[a]}return i&&((r=Fr(i[0])).resolvedReturnType=void 0,r.unionSignatures=i),r}}function pu(e){return 176===e.kind&&!!e.initializer||194===e.kind&&58===e.operatorToken.kind}function hu(t,n){for(var i=t.elements,r=!1,s=[],o=e.isAssignmentTarget(t),a=ru(t),l=0;l<i.length;l++){var c=i[l];if(o&&198===c.kind){var u=xp(c.expression,n),d=vs(u,1)||wh(u,void 0,!1,!1,!1);d&&s.push(d)}else{var p=yp(c,n,iu(a,l));s.push(p)}r=r||198===c.kind}if(!r){if(o&&s.length)return(p=Ws(wo(s))).pattern=t,p;var h=ru(t);if(h&&function(t){return!!(65536&t.flags?e.forEach(t.types,sl):sl(t))}(h)){var f=h.pattern;if(f&&(175===f.kind||177===f.kind))for(var m=f.elements,g=s.length;g<m.length;g++){var _=m[g];pu(_)?s.push(h.typeArguments[g]):(200!==_.kind&&tn(_,e.Diagnostics.Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value),s.push(J))}if(s.length)return wo(s)}}return So(s.length?Po(s,!0):I?ae:X)}function fu(e){switch(e.kind){case 144:return function(e){return tp(gu(e),84)}(e);case 71:return mu(e.escapedText);case 8:case 9:return mu(e.text);default:return!1}}function mu(e){return(+e).toString()===e}function gu(t){var n=dn(t.expression);return n.resolvedType||(n.resolvedType=xp(t.expression),6144&n.resolvedType.flags||!tp(n.resolvedType,262774)&&!Ia(n.resolvedType,Po([ee,te,se]))?tn(t,e.Diagnostics.A_computed_property_name_must_be_of_type_string_number_symbol_or_any):ed(t.expression,n.resolvedType,!0)),n.resolvedType}function _u(e,t,n,i){for(var r=[],s=0;s<n.length;s++)(0===i||fu(e[s+t].name))&&r.push(nr(n[s]));return Us(r.length?Po(r,!0):Y,!1)}function yu(t,n){var i=e.isAssignmentTarget(t);!function(t,n){for(var i=e.createUnderscoreEscapedMap(),r=1,s=2,o=4,a=s|o,l=0,c=t.properties;l<c.length;l++){var u=c[l];if(263!==u.kind){var d=u.name;if(144===d.kind&&am(d),262===u.kind&&!n&&u.objectAssignmentInitializer)return km(u.equalsToken,e.Diagnostics.can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment);if(u.modifiers)for(var p=0,h=u.modifiers;p<h.length;p++){var f=h[p];120===f.kind&&151===u.kind||km(f,e.Diagnostics._0_modifier_cannot_be_used_here,e.getTextOfNode(f))}var m=void 0;261===u.kind||262===u.kind?(cm(u.questionToken,e.Diagnostics.An_object_member_cannot_be_declared_optional),8===d.kind&&Sm(d),m=r):151===u.kind?m=r:153===u.kind?m=s:154===u.kind?m=o:e.Debug.assertNever(u,"Unexpected syntax kind:"+u.kind);var g=e.getPropertyNameForPropertyNameNode(d);if(void 0!==g){var _=i.get(g);if(_)if(m===r&&_===r)km(d,e.Diagnostics.Duplicate_identifier_0,e.getTextOfNode(d));else{if(!(m&a&&_&a))return km(d,e.Diagnostics.An_object_literal_cannot_have_property_and_accessor_with_the_same_name);if(_===a||m===_)return km(d,e.Diagnostics.An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name);i.set(g,m|_)}else i.set(g,m)}}}}(t,i);for(var r=e.createSymbolTable(),s=[],o=ue,a=0,l=ru(t),c=l&&l.pattern&&(174===l.pattern.kind||178===l.pattern.kind),u=!l&&e.isInJavaScriptFile(t),d=0,p=!1,h=!1,f=!1,m=e.isInJavaScriptFile(t),g=0,_=0;_<t.properties.length;_++){var y=t.properties[_],b=y.symbol,v=void 0;if(261===y.kind||262===y.kind||e.isObjectLiteralMethod(y)){var T=void 0;m&&(T=Hi(y));var k=void 0;if(261===y.kind){if(144===y.name.kind){var S=gu(y.name);224&S.flags&&(v=e.escapeLeadingUnderscores(""+S.value))}k=bp(y,n)}else 151===y.kind?k=vp(y,n):(e.Debug.assert(262===y.kind),k=yp(y.name,n));T&&(Da(k,T,y),k=T),d|=k.flags;var C=nn(4|b.flags,v||b.escapedName);if(i)(261===y.kind&&pu(y.initializer)||262===y.kind&&y.objectAssignmentInitializer)&&(C.flags|=16777216),!v&&e.hasDynamicName(y)&&(p=!0);else if(c&&!(512&pn(l))){var w=fs(l,b.escapedName);w?C.flags|=16777216&w.flags:x.suppressExcessPropertyErrors||bs(l,0)||tn(y.name,e.Diagnostics.Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1,yi(b),vi(l))}C.declarations=b.declarations,C.parent=b.parent,b.valueDeclaration&&(C.valueDeclaration=b.valueDeclaration),C.type=k,C.target=b,b=C}else{if(263===y.kind){if(E<2&&Jf(y,2),s.length>0&&(o=Qo(o,N(),t.symbol,a),s=[],r=e.createSymbolTable(),h=!1,f=!1,d=0),!bu(k=xp(y.expression)))return tn(y,e.Diagnostics.Spread_types_may_only_be_created_from_object_types),J;o=Qo(o,k,t.symbol,a),g=_+1;continue}e.Debug.assert(153===y.kind||154===y.kind),sf(y)}!v&&e.hasDynamicName(y)?fu(y.name)?f=!0:h=!0:r.set(b.escapedName,b),s.push(b)}if(c)for(var I=0,A=ts(l);I<A.length;I++){C=A[I];r.get(C.escapedName)||(16777216&C.flags||tn(C.valueDeclaration||C.bindingElement,e.Diagnostics.Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value),r.set(C.escapedName,C),s.push(C))}return o!==ue?(s.length>0&&(o=Qo(o,N(),t.symbol,a)),o):N();function N(){var n=u?st:h?_u(t.properties,g,s,0):void 0,o=f&&!u?_u(t.properties,g,s,1):void 0,l=si(t.symbol,r,e.emptyArray,e.emptyArray,n,o),c=x.suppressExcessPropertyErrors?0:1048576;return l.flags|=4194304|c|14680064&d,l.objectFlags|=128,p&&(l.objectFlags|=512),i&&(l.pattern=t),6144&l.flags||(a|=14680064&l.flags),l}}function bu(t){return!!(16777217&t.flags||7392&pl(t)&&bu(hl(t))||32768&t.flags&&!Xr(t)||196608&t.flags&&!e.forEach(t.types,function(e){return!bu(e)}))}function vu(t){return!e.stringContains(t,"-")}function Tu(t){switch(t.kind){case 179:case 99:return!1;case 71:return e.isIntrinsicJsxName(t.escapedText);default:e.Debug.fail()}}function ku(t,n,i){for(var r,s=t.attributes,o=e.createSymbolTable(),a=ue,l=[],c=!1,u=!1,d=wu(),p=0,h=s.properties;p<h.length;p++){var f=h[p],m=f.symbol;if(e.isJsxAttribute(f)){var g=f.initializer?xp(f.initializer,i):ne,_=nn(33554436|m.flags,m.escapedName);_.declarations=m.declarations,_.parent=m.parent,m.valueDeclaration&&(_.valueDeclaration=m.valueDeclaration),_.type=g,_.target=m,o.set(_.escapedName,_),l.push(_),f.name.escapedText===d&&(u=!0)}else{e.Debug.assert(255===f.kind),l.length>0&&(a=Qo(a,I(s.symbol,o),t.symbol,0),l=[],o=e.createSymbolTable()),Fi(g=xp(f.expression))&&(c=!0),bu(g)?a=Qo(a,g,t.symbol,0):r=r?$o([r,g]):g}}if(!c){a!==ue&&(l.length>0&&(a=Qo(a,I(s.symbol,o),t.symbol,0)),l=ts(a)),o=e.createSymbolTable();for(var y=0,b=l;y<b.length;y++){var v=b[y];n&&!n(v)||o.set(v.escapedName,v)}}var T=249===t.parent.kind?t.parent:void 0;if(T&&T.openingElement===t&&T.children.length>0){for(var k=[],x=0,E=T.children;x<E.length;x++){var S=E[x];10===S.kind?S.containsOnlyWhiteSpaces||k.push(ee):k.push(xp(S,i))}if(!c&&d&&""!==d){u&&tn(s,e.Diagnostics._0_are_specified_twice_The_attribute_named_0_will_be_overwritten,e.unescapeLeadingUnderscores(d));var C=nn(33554436,d);C.type=1===k.length?k[0]:So(Po(k,!1)),o.set(d,C)}}if(c)return W;var w=I(s.symbol,o);return r&&o.size?$o([r,w]):r||w;function I(t,n){var i=si(t,n,e.emptyArray,e.emptyArray,void 0,void 0);return i.flags|=37748736,i.objectFlags|=128,i}}function xu(e){var t=Kt.get(e);return void 0===t&&Kt.set(e,t=bo(zt.JSX,e)||J),t}function Eu(t){var n=dn(t);if(!n.resolvedSymbol){var i=xu(zt.IntrinsicElements);if(i!==J){if(!e.isIdentifier(t.tagName))throw e.Debug.fail();var r=fs(i,t.tagName.escapedText);return r?(n.jsxFlags|=1,n.resolvedSymbol=r):vs(i,0)?(n.jsxFlags|=2,n.resolvedSymbol=i.symbol):(tn(t,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.idText(t.tagName),"JSX."+zt.IntrinsicElements),n.resolvedSymbol=K)}return N&&tn(t,e.Diagnostics.JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists,e.unescapeLeadingUnderscores(zt.IntrinsicElements)),n.resolvedSymbol=K}return n.resolvedSymbol}function Su(t){var n=oo(zt.JSX,1920,void 0),i=n&&fn(n.exports,t,793064),r=i&&Cr(i),s=r&&ts(r);if(s){if(0===s.length)return"";if(1===s.length)return s[0].escapedName;s.length>1&&tn(i.declarations[0],e.Diagnostics.The_global_type_JSX_0_may_not_have_more_than_one_property,e.unescapeLeadingUnderscores(t))}}function Cu(){return Gt||(Gt=!0,Rt=Su(zt.ElementAttributesPropertyNameContainer)),Rt}function wu(){return jt||(jt=!0,Lt=Su(zt.ElementChildrenAttributeNameContainer)),Lt}function Iu(e){if(e){if(131072&e.flags){for(var t=[],n=0,i=e.types;n<i.length;n++){var r=i[n];t.push(us(r))}return $o(t)}return us(e)}}function Au(t,n,i,r){if(void 0===i&&(i=xp(t.tagName)),65536&i.flags)return Po(i.types.map(function(e){return Au(t,n,e,r)}),!0);if(2&i.flags)return W;if(32&i.flags){var s=xu(zt.IntrinsicElements);if(s!==J){var o=i.value,a=fs(s,e.escapeLeadingUnderscores(o));if(a)return nr(a);var l=vs(s,0);if(l)return l;tn(t,e.Diagnostics.Property_0_does_not_exist_on_type_1,o,"JSX."+zt.IntrinsicElements)}return W}var c=function(t,n){if(e.Debug.assert(!(65536&n.flags)),Fi(n))return W;var i=gs(n,1);if(0===i.length&&0===(i=gs(n,0)).length)return tn(t.tagName,e.Diagnostics.JSX_element_type_0_does_not_have_any_construct_or_call_signatures,e.getTextOfNode(t.tagName)),J;for(var r=[],s=0,o=i;s<o.length;s++){var a=o[s];if(a.typeParameters){var l=e.isInJavaScriptFile(t),c=ws(void 0,a.typeParameters,0,l);r.push(Rs(a,c,l))}else r.push(a)}return Po(e.map(r,Ds),!0)}(t,i),u=n?function(t,n,i,r){if(e.Debug.assert(!(65536&n.flags)),!r||!Ia(i,r)){var s=Lu();if(s){var o=[];Ed(t,n,o);for(var a=void 0,l=void 0,c=0,u=o;c<u.length;c++){var d=u[c],p=Ds(d),h=p&&(0===d.parameters.length?ue:nr(d.parameters[0]));if(h=Iu(h),p&&Ia(p,s)){for(var f=!0,m=0,g=t.attributes.properties;m<g.length;m++){var _=g[m];if(e.isJsxAttribute(_)&&vu(_.name.escapedText)&&!fs(h,_.name.escapedText)){f=!1;break}}f&&(a=Hr(a,h)),l=Hr(l,h)}}a||(a=l);var y=xu(zt.IntrinsicAttributes);return y!==J&&(a=Hr(y,a)),a}}}(t,i,c,r):function(t,n,i,r){if(e.Debug.assert(!(65536&n.flags)),!r||!Ia(i,r)){var s=Lu();if(s){var o=Ed(t,n,void 0);if(o!==tt){var a=o&&Ds(o),l=a&&(0===o.parameters.length?ue:nr(o.parameters[0]));if(l=Iu(l),a&&Ia(a,s)){var c=xu(zt.IntrinsicAttributes);return c!==J&&(l=Hr(c,l)),l}}}}}(t,i,c,r);if(u)return u;if(r&&Ua(c,r,qt,t,e.Diagnostics.JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements),Fi(c))return c;var d=Cu();if(void 0===d)return W;if(""===d)return c;var p=Mi(c,d);if(p){if(Fi(p)||p===J)return p;var h=p,f=xu(zt.IntrinsicClassAttributes);if(f!==J){var m=cr(f.symbol);m?1===m.length&&(h=Hr(zs(f,[c]),h)):h=Hr(p,f)}var g=xu(zt.IntrinsicAttributes);return g!==J&&(h=Hr(g,h)),h}return ue}function Nu(t){e.Debug.assert(Tu(t.tagName));var n=dn(t);if(!n.resolvedJsxElementAttributesType){var i=Eu(t);return 1&n.jsxFlags?n.resolvedJsxElementAttributesType=nr(i):2&n.jsxFlags?n.resolvedJsxElementAttributesType=Vs(i,0).type:n.resolvedJsxElementAttributesType=J}return n.resolvedJsxElementAttributesType}function Du(e,t){var n=dn(e),i=t?"resolvedJsxElementAllAttributesType":"resolvedJsxElementAttributesType";if(!n[i]){var r=function(){We||(We=bo(zt.JSX,zt.ElementClass));return We}();return n[i]=Au(e,t,void 0,r)}return n[i]}function Ou(e){return Tu(e.tagName)?Nu(e):Du(e,!1)}function Ru(){return qe||(qe=bo(zt.JSX,zt.Element)),qe}function Lu(){if(!Je){var e=Ru();e&&(Je=Po([e,Z]))}return Je}function Pu(t){var n;!function(t){for(var n=e.createUnderscoreEscapedMap(),i=0,r=t.attributes.properties;i<r.length;i++){var s=r[i];if(255!==s.kind){var o=s,a=o.name;if(n.get(a.escapedText))return km(a,e.Diagnostics.JSX_elements_cannot_have_multiple_attributes_with_the_same_name);n.set(a.escapedText,!0);var l=o.initializer;if(l&&256===l.kind&&!l.expression)return km(o.initializer,e.Diagnostics.JSX_attributes_must_only_be_assigned_a_non_empty_expression)}}}(t),n=t,0===(x.jsx||0)&&tn(n,e.Diagnostics.Cannot_use_JSX_unless_the_jsx_flag_is_provided),void 0===Ru()&&N&&tn(n,e.Diagnostics.JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist);var i=Nt&&2===x.jsx?e.Diagnostics.Cannot_find_name_0:void 0,r=en(),s=gn(t.tagName,r,107455,i,r,!0);s&&(s.isReferenced=!0,2097152&s.flags&&!Nf(Nn(s))&&On(s)),function(t){var n=Tu(t.tagName)?Nu(t):Du(t,!1),i=ku(t,function(e){return vu(e.escapedName)||!!fs(n,e.escapedName)});if(n===ue&&(Fi(i)||i.properties.length>0))tn(t,e.Diagnostics.JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property,e.unescapeLeadingUnderscores(Cu()));else{if(Da(i,n,t.attributes.properties.length>0?t.attributes:t)&&!Fi(i)&&!Fi(n))for(var r=0,s=t.attributes.properties;r<s.length;r++){var o=s[r];if(e.isJsxAttribute(o)&&!Mu(n,o.name.escapedText,!0)){tn(o,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.idText(o.name),vi(n));break}}}}(t)}function Mu(e,t,n){if(32768&e.flags){var i=Zr(e);if(i.stringIndexInfo||i.numberIndexInfo&&mu(t)||es(e,t)||n&&!vu(t))return!0}else if(196608&e.flags)for(var r=0,s=e.types;r<s.length;r++){if(Mu(s[r],t,n))return!0}return!1}function Fu(t){return t.valueDeclaration?e.getCombinedNodeFlags(t.valueDeclaration):0}function Bu(t){return!!(8192&t.flags||4&e.getCheckFlags(t))}function $u(t,n,i,r){var s=e.getDeclarationModifierFlagsFromSymbol(r),o=179===t.kind||226===t.kind?t.name:t.right;if(256&e.getCheckFlags(r))return tn(o,e.Diagnostics.Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1,yi(r),vi(i)),!1;if(97===n.kind){if(E<2)if(Wa(r,function(e){var t,n=(t=e).valueDeclaration?t.valueDeclaration.kind:149;return 151!==n&&150!==n}))return tn(o,e.Diagnostics.Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword),!1;if(128&s)return tn(o,e.Diagnostics.Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression,yi(r),vi(qa(r))),!1}if(!(24&s))return!0;if(8&s)return!!hf(t,Hh(Jn(r)))||(tn(o,e.Diagnostics.Property_0_is_private_and_only_accessible_within_class_1,yi(r),vi(qa(r))),!1);if(97===n.kind)return!0;var a=pf(t,function(t){var n=Cr(qn(t));return function(t,n){return Wa(n,function(n){return!!(16&e.getDeclarationModifierFlagsFromSymbol(n))&&!sr(t,qa(n))})?void 0:t}(n,r)?n:void 0});return a?!!(32&s)||(16384&i.flags&&i.isThisType&&(i=ns(i)),!!(3&pn(rr(i))&&sr(i,a))||(tn(o,e.Diagnostics.Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1,yi(r),vi(a)),!1)):(tn(o,e.Diagnostics.Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses,yi(r),vi(qa(r)||i)),!1)}function Uu(e){return Vu(xp(e),e)}function Vu(t,n){var i=6144&(I?pl(t):t.flags);if(i){tn(n,2048&i?4096&i?e.Diagnostics.Object_is_possibly_null_or_undefined:e.Diagnostics.Object_is_possibly_undefined:e.Diagnostics.Object_is_possibly_null);var r=_l(t);return 14336&r.flags?J:r}return t}function Hu(e){return ju(e,e.expression,e.name)}function Gu(e){return ju(e,e.left,e.right)}function ju(t,n,i){var r=Uu(n);if(Fi(r)||r===le)return r;var s=us(xl(r));if(s===J||16384&r.flags&&Fi(s))return s;var o=fs(s,i.escapedText);if(!o){var a=bs(s,0);return a&&a.type?(a.isReadonly&&(e.isAssignmentTarget(t)||e.isDeleteTarget(t))&&tn(t,e.Diagnostics.Index_signature_in_type_0_only_permits_reading,vi(s)),a.type):(i.escapedText&&!vn(t)&&function(t,n){var i;if(65536&n.flags&&!(8190&n.flags))for(var r=0,s=n.types;r<s.length;r++){var o=s[r];if(!fs(o,t.escapedText)){i=e.chainDiagnosticMessages(i,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.declarationNameToString(t),vi(o));break}}var a=zu(t,n);i=void 0!==a?e.chainDiagnosticMessages(i,e.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2,e.declarationNameToString(t),vi(n),a):e.chainDiagnosticMessages(i,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.declarationNameToString(t),vi(n));Nt.add(e.createDiagnosticForNodeFromMessageChain(t,i))}(i,16384&r.flags&&r.isThisType?s:r),J)}!function(t,n,i){var r=t.valueDeclaration;if(!r)return;!function(t){return!!e.findAncestor(t,function(t){switch(t.kind){case 149:return!0;case 261:return!1;default:return!e.isPartOfExpression(t)&&"quit"}})}(n)||mn(r,i)||function(e){var t=nr(e.parent);for(;;){if(!(t=Ku(t)))return!1;var n=es(t,e.escapedName);if(n&&n.valueDeclaration)return!0}}(t)?229!==r.kind||159===n.parent.kind||e.isInAmbientContext(r)||mn(r,i)||tn(i,e.Diagnostics.Class_0_used_before_its_declaration,e.idText(i)):tn(i,e.Diagnostics.Block_scoped_variable_0_used_before_its_declaration,e.idText(i))}(o,t,i),Ju(o,t,99===n.kind),dn(t).resolvedSymbol=o,$u(t,n,s,o);var l=Fc(o,t),c=e.getAssignmentTargetKind(t);if(c&&(Xd(t,o)||Zd(t)))return tn(i,e.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.idText(i)),J;if(!(179===t.kind&&1!==c&&(98311&o.flags||8192&o.flags&&65536&l.flags)))return l;var u=Nc(t,l);return c?ll(u):u}function Ku(t){var n=_r(t);if(0!==n.length)return e.Debug.assert(1===n.length),n[0]}function zu(t,n){var i=qu(e.idText(t),ts(n),107455);return i&&e.symbolName(i)}function Wu(t,n,i){var r=_n(t,n,i,void 0,n,!1,function(t,n,i){return fn(t,n,i)||qu(e.unescapeLeadingUnderscores(n),e.arrayFrom(t.values()),i)});return r&&e.symbolName(r)}function qu(t,n,i){var r=.4*t.length,s=Math.min(3,.34*t.length),o=Number.MAX_VALUE,a=void 0,l=!1;if(!(t.length>30)){t=t.toLowerCase();for(var c=0,u=n;c<u.length;c++){var d=u[c],p=e.symbolName(d);if(d.flags&i&&p&&Math.abs(p.length-t.length)<s){if((p=p.toLowerCase())===t)return d;if(l)continue;if(p.length<3||t.length<3||"eval"===p||"intl"===p||"undefined"===p||"map"===p||"nan"===p||"set"===p)continue;var h=e.levenshtein(t,p);if(h>r)continue;h<3?(l=!0,a=d):h<o&&(o=h,a=d)}}return a}}function Ju(t,n,i){if(t&&C&&106500&t.flags&&t.valueDeclaration&&e.hasModifier(t.valueDeclaration,8)&&(!n||!e.isWriteOnlyAccess(n))){if(i){var r=e.findAncestor(n,e.isFunctionLikeDeclaration);if(r&&r.symbol===t)return}1&e.getCheckFlags(t)?un(t).target.isReferenced=!0:t.isReferenced=!0}}function Yu(t,n,i,r){if(r!==J&&!Fi(r)){var s=fs(r,i);if(s)return $u(t,n,r,s);if(e.isInJavaScriptFile(n)&&65536&r.flags)for(var o=0,a=r.types;o<a.length;o++){if(Yu(t,n,i,a[o]))return!0}return!1}return!0}function Xu(t){var n=t.initializer;if(227===n.kind){var i=n.declarations[0];if(i&&!e.isBindingPattern(i.name))return qn(i)}else if(71===n.kind)return Ul(n)}function Zu(e){return vs(e,1)&&!vs(e,0)}function Qu(t){var n=Uu(t.expression),i=t.argumentExpression;if(!i){var r,s=e.getSourceFileOfNode(t);if(182===t.parent.kind&&t.parent.expression===t)Tm(s,r=e.skipTrivia(s.text,t.expression.end),t.end-r,e.Diagnostics.new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead);else Tm(s,r=t.end-1,t.end-r,e.Diagnostics.Expression_expected);return J}var o=function(t){var n=e.skipParentheses(t);if(71===n.kind){var i=Ul(n);if(3&i.flags)for(var r=t,s=t.parent;s;){if(215===s.kind&&r===s.statement&&Xu(s)===i&&Zu(kp(s.expression)))return!0;r=s,s=s.parent}}return!1}(i)?te:xp(i);return n===J||n===le?n:np(n)&&9!==i.kind?(tn(i,e.Diagnostics.A_const_enum_member_can_only_be_accessed_using_a_string_literal),J):Fp(Wo(n,o,t),t)}function ed(t,n,i){if(n===J)return!1;if(!e.isWellKnownSymbolSyntactically(t))return!1;if(!(512&n.flags))return i&&tn(t,e.Diagnostics.A_computed_property_name_of_the_form_0_must_be_of_type_symbol,e.getTextOfNode(t)),!1;var r=t.expression,s=Ul(r);if(!s)return!1;var o,a=(o=!0,Le||(Le=so("Symbol",o)));return!!a&&(s===a||(i&&tn(r,e.Diagnostics.Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object),!1))}function td(t){return e.isCallOrNewExpression(t)}function nd(t){return td(t)&&e.forEach(t.typeArguments,rf),183===t.kind?xp(t.template):147!==t.kind&&e.forEach(t.arguments,function(e){xp(e)}),et}function id(e){return nd(e),tt}function rd(e){for(var t=0;t<e.length;t++){var n=e[t];if(n&&198===n.kind)return t}return-1}function sd(t,n,i,r){var s,o,a;void 0===r&&(r=!1);var l=-1;if(e.isJsxOpeningLikeElement(t))return!0;if(183===t.kind){var c=t;if(s=n.length,o=void 0,196===c.template.kind){var u=c.template,d=e.lastOrUndefined(u.templateSpans);e.Debug.assert(void 0!==d),a=e.nodeIsMissing(d.literal)||!!d.literal.isUnterminated}else{var p=c.template;e.Debug.assert(13===p.kind),a=!!p.isUnterminated}}else if(147===t.kind)o=void 0,s=hd(t,void 0,i);else{var h=t;if(!h.arguments)return e.Debug.assert(182===h.kind),0===i.minArgumentCount;s=r?n.length+1:n.length,a=h.arguments.end===h.end,o=h.typeArguments,l=rd(n)}var f=e.length(i.typeParameters),m=Cs(i.typeParameters);if(!(!o||o.length>=m&&o.length<=f))return!1;if(l>=0)return tl(i,l)||l>=i.minArgumentCount;if(!i.hasRestParameter&&s>i.parameters.length)return!1;var g=s>=i.minArgumentCount;return a||g}function od(e){if(32768&e.flags){var t=Zr(e);if(1===t.callSignatures.length&&0===t.constructSignatures.length&&0===t.properties.length&&!t.stringIndexInfo&&!t.numberIndexInfo)return t.callSignatures[0]}}function ad(t,n,i,r){var s=Il(t,1,r);return wl(n,t,function(e,t){Ll(s.inferences,ya(e,i||k),t)}),i||Ll(s.inferences,Ds(n),Ds(t),8),Rs(t,$l(s),e.isInJavaScriptFile(n.declaration))}function ld(t,n,i,r,s){for(var o=0,a=s.inferences;o<a.length;o++){var l=a[o];l.isFixed||(l.inferredType=void 0)}if(147!==t.kind){var c=su(t);if(c){var u=ya(c,function(e){return e&&function(e){return!!e.signature}(e)?Il(e.signature,2|e.flags,e.compareTypes,e.inferences):e}(ou(t))),d=od(u),p=d&&d.typeParameters?Fs(Rs(d,d.typeParameters,e.isInJavaScriptFile(t))):u,h=Ds(n);Ll(s.inferences,p,h,8)}}var f=Ns(n);if(f){var m=dd(t),g=m?xp(m):oe;Ll(s.inferences,g,f)}for(var _=hd(t,i,n),y=0;y<_;y++){if(void 0===(T=_d(t,i,y))||200!==T.kind){var b=Md(n,y),v=gd(t,y);if(void 0===v)v=hp(T,b,r&&void 0!==r[y]?k:s);Ll(s.inferences,v,b)}}if(r)for(y=0;y<_;y++)if(!1===r[y]){var T=i[y];b=Md(n,y);Ll(s.inferences,hp(T,b,s),b)}return $l(s)}function cd(t,n,i,r){for(var s,o=e.isInJavaScriptFile(t.declaration),a=t.typeParameters,l=ws(e.map(n,aa),a,Cs(a),o),c=0;c<n.length;c++){e.Debug.assert(void 0!==a[c],"Should not call checkTypeArguments with too many type arguments");var u=ns(a[c]);if(u){var d=i&&r&&e.chainDiagnosticMessages(void 0,e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1),p=r||e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1;s||(s=da(a,l));var h=l[c];if(!Da(h,Lr(ya(u,s),h),i?n[c]:void 0,p,d))return!1}}return l}function ud(t,n,i,r,s,o){if(e.isJsxOpeningLikeElement(t))return function(t,n,i){if(t.attributes.end===t.end)return!0;for(var r=e.Diagnostics.Argument_of_type_0_is_not_assignable_to_parameter_of_type_1,s=Md(n,0),o=hp(t.attributes,s,void 0),a=0,l=ts(o);a<l.length;a++){var c=l[a];if(!fs(s,c.escapedName)&&vu(c.escapedName))return!1}return Ua(o,s,i,void 0,r)}(t,i,r);var a=Ns(i);if(a&&a!==oe&&182!==t.kind){var l=dd(t),c=l?xp(l):oe,u=o?l||t:void 0,d=e.Diagnostics.The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1;if(!Ua(c,Ns(i),r,u,d))return!1}for(var p=e.Diagnostics.Argument_of_type_0_is_not_assignable_to_parameter_of_type_1,h=hd(t,n,i),f=0;f<h;f++){var m=_d(t,n,f);if(void 0===m||200!==m.kind){var g=Md(i,f),_=gd(t,f)||hp(m,g,s&&s[f]?k:void 0);if(!Ua(s?vl(_):_,g,r,u=o?yd(t,f,m):void 0,p))return!1}}return!0}function dd(e){if(181===e.kind){var t=e.expression;if(179===t.kind)return t.expression;if(180===t.kind)return t.expression}}function pd(t){if(183===t.kind){var n=t.template,i=[void 0];return 196===n.kind&&e.forEach(n.templateSpans,function(e){i.push(e.expression)}),i}return 147===t.kind?void 0:e.isJsxOpeningLikeElement(t)?t.attributes.properties.length>0?[t.attributes]:e.emptyArray:t.arguments||e.emptyArray}function hd(e,t,n){if(147!==e.kind)return t.length;switch(e.parent.kind){case 229:case 199:return 1;case 149:return 2;case 151:case 153:case 154:return 0===E?2:n.parameters.length>=3?3:2;case 146:return 3}}function fd(t){if(229===t.kind)return nr(qn(t));if(146===t.kind&&152===(t=t.parent).kind)return nr(qn(t));return 149===t.kind||151===t.kind||153===t.kind||154===t.kind?function(t){var n=qn(t.parent);return e.hasModifier(t,32)?nr(n):Cr(n)}(t):(e.Debug.fail("Unsupported decorator target."),J)}function md(t,n){return 0===n?fd(t.parent):1===n?function(t){if(229===t.kind)return e.Debug.fail("Class decorators should not have a second synthetic argument."),J;if(146===t.kind&&152===(t=t.parent).kind)return W;if(149===t.kind||151===t.kind||153===t.kind||154===t.kind){var n=t;switch(n.name.kind){case 71:return sa(e.idText(n.name));case 8:case 9:return sa(n.name.text);case 144:var i=gu(n.name);return tp(i,512)?i:ee;default:return e.Debug.fail("Unsupported property name."),J}}return e.Debug.fail("Unsupported decorator target."),J}(t.parent):2===n?function(t){return 229===t.kind?(e.Debug.fail("Class decorators should not have a third synthetic argument."),J):146===t.kind?te:149===t.kind?(e.Debug.fail("Property decorators should not have a third synthetic argument."),J):151===t.kind||153===t.kind||154===t.kind?To(_f(t)):(e.Debug.fail("Unsupported decorator target."),J)}(t.parent):(e.Debug.fail("Decorators should not have a fourth synthetic argument."),J)}function gd(e,t){return 147===e.kind?md(e,t):0===t&&183===e.kind?ze||(ze=ao("TemplateStringsArray",0,!0))||ue:void 0}function _d(e,t,n){if(147!==e.kind&&(0!==n||183!==e.kind))return t[n]}function yd(e,t,n){return 147===e.kind?e.expression:0===t&&183===e.kind?e.template:n}function bd(t,n,r,s){var o,a=183===t.kind,l=147===t.kind,c=e.isJsxOpeningLikeElement(t);a||l||c||(o=t.typeArguments,97!==t.expression.kind&&e.forEach(o,rf));var u=r||[];if(function(t,n){var i,r,s,o,a=0,l=-1;e.Debug.assert(!n.length);for(var c=0,u=t;c<u.length;c++){var d=u[c],p=d.declaration&&qn(d.declaration),h=d.declaration&&d.declaration.parent;r&&p!==r?(s=a=n.length,i=h):i&&h===i?s++:(i=h,s=a),r=p,d.hasLiteralTypes?(o=++l,a++):o=s,n.splice(o,0,d)}}(n,u),!u.length)return Nt.add(e.createDiagnosticForNode(t,e.Diagnostics.Call_target_does_not_contain_any_signatures)),id(t);var d,p,h,f,m=pd(t),g=1===u.length&&!u[0].typeParameters,_=0;if(!l&&!g)for(var y=a?1:0;y<m.length;y++)va(m[y])&&(d||(d=new Array(m.length)),d[y]=!0,_++);var b=r&&181===t.kind&&t.arguments.hasTrailingComma;if(u.length>1&&(f=B(u,Wt,b)),f||(f=B(u,qt,b)),f)return f;if(p){if(c)return p;ud(t,m,p,qt,void 0,!0)}else if(h)cd(h,t.typeArguments,!0,s);else if(o&&e.every(n,function(t){return e.length(t.typeParameters)!==o.length})){for(var v=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,k=0,x=n;k<x.length;k++){var E=x[k];v=Math.min(v,Cs(E.typeParameters)),T=Math.max(T,e.length(E.typeParameters))}var S=v<T?v+"-"+T:v;Nt.add(e.createDiagnosticForNode(t,e.Diagnostics.Expected_0_type_arguments_but_got_1,S,o.length))}else if(m){v=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY;for(var C=0,w=n;C<w.length;C++){E=w[C];v=Math.min(v,E.minArgumentCount),T=Math.max(T,E.parameters.length)}var I=e.some(n,function(e){return e.hasRestParameter}),A=rd(m)>-1,N=(S=I?v:v<T?v+"-"+T:v,m.length-(A?1:0)),D=I&&A?e.Diagnostics.Expected_at_least_0_arguments_but_got_a_minimum_of_1:I?e.Diagnostics.Expected_at_least_0_arguments_but_got_1:A?e.Diagnostics.Expected_0_arguments_but_got_a_minimum_of_1:e.Diagnostics.Expected_0_arguments_but_got_1;Nt.add(e.createDiagnosticForNode(t,D,S,N))}else s&&Nt.add(e.createDiagnosticForNode(t,s));if(!i){e.Debug.assert(u.length>0);var O=function(e,t){for(var n=-1,i=-1,r=0;r<e.length;r++){var s=e[r];if(s.hasRestParameter||s.parameters.length>=t)return r;s.parameters.length>i&&(i=s.parameters.length,n=r)}return n}(u,void 0===P?m.length:P),R=u[O],L=R.typeParameters;if(L&&td(t)&&t.typeArguments){for(var M=t.typeArguments.map(_f);M.length>L.length;)M.pop();for(;M.length<L.length;)M.push(Bl(e.isInJavaScriptFile(t)));var F=Ls(R,M);return u[O]=F,F}return R}return id(t);function B(n,i,r){if(void 0===r&&(r=!1),p=void 0,h=void 0,g){var s=n[0];if(!sd(t,m,s,r))return;return ud(t,m,s,i,d,!1)?s:void(p=s)}for(var a=0;a<n.length;a++){var l=n[a];if(sd(t,m,l,r)){s=void 0;for(var c=l.typeParameters?Il(l,e.isInJavaScriptFile(t)?4:0):void 0;;){if((s=l).typeParameters){var u=void 0;if(o){var f=cd(s,o,!1);if(!f){h=l;break}u=f}else u=ld(t,s,m,d,c);s=Rs(s,u,e.isInJavaScriptFile(s.declaration))}if(!ud(t,m,s,i,d,!1)){p=s;break}if(0===_)return n[a]=s,s;--_>0?d[e.indexOf(d,!0)]=!1:d=void 0}}}}}function vd(e,t,n,i){return!!Fi(e)||(!!(Fi(t)&&16384&e.flags)||!n&&!i&&(!(65536&e.flags)&&Ia(e,xe)))}function Td(t,n){if(t.arguments&&E<1){var i=rd(t.arguments);i>=0&&tn(t.arguments[i],e.Diagnostics.Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher)}var r=Uu(t.expression);if(r===le)return it;if((r=us(r))===J)return id(t);if(Fi(r))return t.typeArguments&&tn(t,e.Diagnostics.Untyped_function_calls_may_not_accept_type_arguments),nd(t);var s=gs(r,1);if(s.length){if(!function(t,n){if(!n||!n.declaration)return!0;var i=n.declaration,r=e.getSelectedModifierFlags(i,24);if(!r)return!0;var s=Hh(i.parent.symbol),o=Cr(i.parent.symbol);if(!hf(t,s)){var a=e.getContainingClass(t);if(a)for(var l=_r(_f(a));l.length;){var c=l[0];if(16&r&&c.symbol===i.parent.symbol)return!0;l=_r(c)}return 8&r&&tn(t,e.Diagnostics.Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration,vi(o)),16&r&&tn(t,e.Diagnostics.Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration,vi(o)),!1}return!0}(t,s[0]))return id(t);var o=r.symbol&&Hh(r.symbol);return o&&e.hasModifier(o,128)?(tn(t,e.Diagnostics.Cannot_create_an_instance_of_the_abstract_class_0,e.declarationNameToString(e.getNameOfDeclaration(o))),id(t)):bd(t,s,n)}var a=gs(r,0);if(a.length){var l=bd(t,a,n);return Id(l.declaration)||Ds(l)===oe||tn(t,e.Diagnostics.Only_a_void_function_can_be_called_with_the_new_keyword),Ns(l)===oe&&tn(t,e.Diagnostics.A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void),l}return tn(t,e.Diagnostics.Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature),id(t)}function kd(t){switch(t.parent.kind){case 229:case 199:return e.Diagnostics.Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression;case 146:return e.Diagnostics.Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression;case 149:return e.Diagnostics.Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression;case 151:case 153:case 154:return e.Diagnostics.Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression}}function xd(t,n){var i=xp(t.expression),r=us(i);if(r===J)return id(t);var s,o,a=gs(r,0),l=gs(r,1);if(vd(i,r,a.length,l.length))return nd(t);if(s=t,(o=a).length&&e.every(o,function(e){return 0===e.minArgumentCount&&!e.hasRestParameter&&e.parameters.length<hd(s,void 0,e)})){var c=e.getTextOfNode(t.expression,!1);return tn(t,e.Diagnostics._0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0,c),id(t)}var u=kd(t);if(!a.length){var d=void 0;return d=e.chainDiagnosticMessages(d,e.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,vi(r)),d=e.chainDiagnosticMessages(d,u),Nt.add(e.createDiagnosticForNodeFromMessageChain(t,d)),id(t)}return bd(t,a,n,u)}function Ed(t,n,i){return e.Debug.assert(!(65536&n.flags)),Sd(t,n,i)}function Sd(e,t,n){if(65536&t.flags){for(var i=void 0,r=0,s=t.types;r<s.length;r++){var o=s[r];i=i||Sd(e,o,n)}return i}var a=t&&gs(t,0);if(a&&a.length>0)return bd(e,a,n)}function Cd(t,n){switch(t.kind){case 181:return function(t,n){if(97===t.expression.kind){var i=zc(t.expression);if(i!==J){var r=e.getClassExtendsHeritageClauseElement(e.getContainingClass(t));if(r)return bd(t,mr(i,r.typeArguments,r),n)}return nd(t)}var s=Uu(t.expression);if(s===le)return it;var o=us(s);if(o===J)return id(t);var a=gs(o,0),l=gs(o,1);return vd(s,o,a.length,l.length)?(s!==J&&t.typeArguments&&tn(t,e.Diagnostics.Untyped_function_calls_may_not_accept_type_arguments),nd(t)):a.length?bd(t,a,n):(l.length?tn(t,e.Diagnostics.Value_of_type_0_is_not_callable_Did_you_mean_to_include_new,vi(s)):tn(t,e.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,vi(o)),id(t))}(t,n);case 182:return Td(t,n);case 183:return function(t,n){var i=xp(t.tag),r=us(i);if(r===J)return id(t);var s=gs(r,0),o=gs(r,1);return vd(i,r,s.length,o.length)?nd(t):s.length?bd(t,s,n):(tn(t,e.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,vi(r)),id(t))}(t,n);case 147:return xd(t,n);case 251:case 250:return Sd(t,xp(t.tagName),n)||tt}e.Debug.assertNever(t,"Branch in 'resolveSignature' should be unreachable.")}function wd(e,t){var n=dn(e),i=n.resolvedSignature;if(i&&i!==nt&&!t)return i;n.resolvedSignature=nt;var r=Cd(e,t);return n.resolvedSignature=at===lt?r:i,r}function Id(t){if(t&&e.isInJavaScriptFile(t)){if(e.getJSDocClassTag(t))return!0;var n=e.isFunctionDeclaration(t)||e.isFunctionExpression(t)?qn(t):e.isVariableDeclaration(t)&&t.initializer&&e.isFunctionExpression(t.initializer)?qn(t.initializer):void 0;return n&&void 0!==n.members}return!1}function Ad(t){var n=un(t);return n.inferredClassType||(n.inferredClassType=si(t,t.members||T,e.emptyArray,e.emptyArray,void 0,void 0)),n.inferredClassType}function Nd(e){return e.symbol&&16&pn(e)&&un(e.symbol).inferredClassType===e}function Dd(t){im(t,t.typeArguments)||rm(t.arguments);var n=wd(t);if(97===t.expression.kind)return oe;if(182===t.kind){var i=n.declaration;if(i&&152!==i.kind&&156!==i.kind&&161!==i.kind&&!e.isJSDocConstructSignature(i)){var r=xp(t.expression).symbol;r||71!==t.expression.kind||(r=Ul(t.expression));var s=r&&function(t){if(e.isDeclarationOfFunctionOrClassExpression(t)&&(t=qn(t.valueDeclaration.initializer)),Id(t.valueDeclaration))return Ad(t);if(3&t.flags){var n=nr(t);if(n.symbol&&!Nd(n)&&Id(n.symbol.valueDeclaration))return Ad(n.symbol)}}(r);return s||(N&&tn(t,e.Diagnostics.new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type),W)}}return e.isInJavaScriptFile(t)&&function(t){if(!e.isRequireCall(t,!0))return!1;if(!e.isIdentifier(t.expression))throw e.Debug.fail();var n=gn(t.expression,t.expression.escapedText,107455,void 0,void 0,!0);if(!n)return!0;if(2097152&n.flags)return!1;var i=16&n.flags?228:3&n.flags?226:0;if(0!==i){var r=e.getDeclarationOfKind(n,i);return e.isInAmbientContext(r)}return!1}(t)?function(e){var t=Mn(e,e);if(t){var n=$n(t);if(n)return nr(n)}return W}(t.arguments[0]):Ds(n)}function Od(t){if(rm(t.arguments)||function(t){if(S===e.ModuleKind.ES2015)return km(t,e.Diagnostics.Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules);if(t.typeArguments)return km(t,e.Diagnostics.Dynamic_import_cannot_have_type_arguments);var n=t.arguments;if(1!==n.length)return km(t,e.Diagnostics.Dynamic_import_must_have_one_specifier_as_an_argument);if(e.isSpreadElement(n[0]))km(n[0],e.Diagnostics.Specifier_of_dynamic_import_cannot_be_spread_element)}(t),0===t.arguments.length)return Vd(t,W);for(var n=t.arguments[0],i=fp(n),r=1;r<t.arguments.length;++r)fp(t.arguments[r]);(2048&i.flags||4096&i.flags||!Ia(i,ee))&&tn(n,e.Diagnostics.Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0,vi(i));var s=Mn(t,n);if(s){var o=Un(s,n,!0);if(o)return Vd(t,function(t,n){if(w&&t&&t!==J){var i=t;if(!i.syntheticType)if(fs(t,"default"))i.syntheticType=t;else{var r=e.createSymbolTable(),s=nn(2097152,"default");s.target=An(n),r.set("default",s);var o=nn(2048,"__type"),a=si(o,r,e.emptyArray,e.emptyArray,void 0,void 0);o.type=a,i.syntheticType=$o([t,a])}return i.syntheticType}return t}(nr(o),o))}return Vd(t,W)}function Rd(t,n,r,s){var o=vl(ll(xp(r,s)));rf(n);var a=aa(n);i&&a!==J&&(Na(a,xl(o))||Oa(o,a,t,e.Diagnostics.Type_0_cannot_be_converted_to_type_1));return a}function Ld(t){!function(t){if(94===t.keywordToken&&"target"!==t.name.escapedText)km(t.name,e.Diagnostics._0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2,t.name.escapedText,e.tokenToString(t.keywordToken),"target")}(t);var n=e.getNewTargetContainer(t);return n?152===n.kind?nr(qn(n.parent)):nr(qn(n)):(tn(t,e.Diagnostics.Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constructor,"new.target"),J)}function Pd(e){var t=nr(e);if(I){var n=e.valueDeclaration;if(n&&n.initializer)return gl(t,2048)}return t}function Md(e,t){return e.hasRestParameter?t<e.parameters.length-1?Pd(e.parameters[t]):Os(e):t<e.parameters.length?Pd(e.parameters[t]):W}function Fd(e){return e.parameters.length>0?Md(e,0):ae}function Bd(t){for(var n=0,i=t.elements;n<i.length;n++){var r=i[n];e.isOmittedExpression(r)||(71===r.name.kind?un(qn(r)).type=Vi(r):Bd(r.name))}}function $d(e,t){var n=un(e);if(!n.type){n.type=t;var i=e.valueDeclaration;71!==i.name.kind&&(n.type===ue&&(n.type=Wi(i.name)),Bd(i.name))}}function Ud(e){var t=co(!0);return t!==he?zs(t,[e=Kp(e)||ue]):ue}function Vd(t,n){var i=Ud(n);return i===ue?(tn(t,e.isImportCall(t)?e.Diagnostics.A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:e.Diagnostics.An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option),J):(uo(!0)||tn(t,e.isImportCall(t)?e.Diagnostics.A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:e.Diagnostics.An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option),i)}function Hd(t,n){var i=cu(t);if(!t.body)return J;var r,s=e.getFunctionFlags(t);if(207!==t.body.kind)r=fp(t.body,n),2&s&&(r=jp(r,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member));else{var o=void 0;if(1&s){if(o=e.concatenate(function(t,n){var i=[],r=e.getFunctionFlags(t);return e.forEachYieldExpression(t.body,function(t){var s=t.expression;if(s){var o=fp(s,n);t.asteriskToken&&(o=Ch(o,t.expression,!1,!!(2&r))),2&r&&(o=jp(o,s,t.asteriskToken?e.Diagnostics.Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:e.Diagnostics.Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)),e.pushIfUnique(i,o)}}),i}(t,n),Kd(t,n)),!o||0===o.length){var a=2&s?ko(W):Eo(W);return N&&tn(t.asteriskToken,e.Diagnostics.Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_type,vi(a)),a}}else{if(!(o=Kd(t,n)))return 2&s?Vd(t,ae):ae;if(0===o.length)return 2&s?Vd(t,oe):oe}r=Po(o,!0),1&s&&(r=2&s?ko(r):Eo(r))}i||Cl(t,r),!ol(r)||i&&_p(i===Is(t)?r:Ds(i))||(r=cl(r));var l=xl(r);return 2==(3&s)?Vd(t,l):l}function Gd(t){if(!t.possiblyExhaustive)return!1;var n=kp(t.expression);if(!al(n))return!1;var i,r,s=pc(t);return!!s.length&&(i=gc(n,ra),r=s,65536&i.flags?!e.forEach(i.types,function(t){return!e.contains(r,t)}):e.contains(r,i))}function jd(t){if(!(128&t.flags))return!1;var n=e.lastOrUndefined(t.body.statements);return!n||221!==n.kind||!Gd(n)}function Kd(t,n){var i=e.getFunctionFlags(t),r=[],s=jd(t),o=!1;if(e.forEachReturnStatement(t.body,function(a){var l=a.expression;if(l){var c=fp(l,n);2&i&&(c=jp(c,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)),8192&c.flags&&(o=!0),e.pushIfUnique(r,c)}else s=!0}),0!==r.length||s||!o&&186!==t.kind&&187!==t.kind)return I&&r.length&&s&&e.pushIfUnique(r,Y),r}function zd(t,n){if(i&&(!n||!ep(n,1025))&&!e.nodeIsMissing(t.body)&&207===t.body.kind&&jd(t)){var r=256&t.flags;if(n&&8192&n.flags)tn(e.getEffectiveReturnTypeNode(t),e.Diagnostics.A_function_returning_never_cannot_have_a_reachable_end_point);else if(n&&!r)tn(e.getEffectiveReturnTypeNode(t),e.Diagnostics.A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value);else if(n&&I&&!Ia(Y,n))tn(e.getEffectiveReturnTypeNode(t),e.Diagnostics.Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined);else if(x.noImplicitReturns){if(!n){if(!r)return;if(Rh(t,Ds(Is(t))))return}tn(e.getEffectiveReturnTypeNode(t)||t,e.Diagnostics.Not_all_code_paths_return_a_value)}}}function Wd(t,n){if(e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t)),1===n&&va(t))return sf(t),fe;nm(t)||186!==t.kind||lm(t);var r=dn(t),s=nr(t.symbol);if(!(1024&r.flags)){var o=du(t);if(!(1024&r.flags)){if(r.flags|=1024,o){var a=gs(s,0)[0];if(va(t)){var l=ou(t);2===n&&function(t,n,i){for(var r=t.parameters.length-(t.hasRestParameter?1:0),s=0;s<r;s++){var o=t.parameters[s].valueDeclaration;if(o.type){var a=e.getEffectiveTypeAnnotationNode(o);a&&Ll(i.inferences,aa(a),Md(n,s))}}}(a,o,l),function(t,n){t.typeParameters=n.typeParameters,n.thisParameter&&(!(s=t.thisParameter)||s.valueDeclaration&&!s.valueDeclaration.type)&&(s||(t.thisParameter=bl(n.thisParameter,void 0)),$d(t.thisParameter,nr(n.thisParameter)));for(var i=t.parameters.length-(t.hasRestParameter?1:0),r=0;r<i;r++){var s=t.parameters[r];e.getEffectiveTypeAnnotationNode(s.valueDeclaration)||$d(s,Md(n,r))}t.hasRestParameter&&tl(n,t.parameters.length-1)&&(!rn(s=e.lastOrUndefined(t.parameters))&&e.getEffectiveTypeAnnotationNode(s.valueDeclaration)||$d(s,nr(e.lastOrUndefined(n.parameters))))}(a,l===k?o:fa(o,l))}if(!e.getEffectiveReturnTypeNode(t)&&!a.resolvedReturnType){var c=Hd(t,n);a.resolvedReturnType||(a.resolvedReturnType=c)}}Ip(t),sf(t)}}return i&&151!==t.kind&&(fh(t,t.name),uh(t,t.name),dh(t,t.name)),s}function qd(t){e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t));var n=e.getFunctionFlags(t),i=e.getEffectiveReturnTypeNode(t),r=i&&(2==(3&n)?zp(t):aa(i));if(1&n||zd(t,r),t.body){if(i||Ds(Is(t)),207===t.body.kind)rf(t.body);else{var s=xp(t.body);if(r)if(2==(3&n))Da(jp(s,t.body,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member),r,t.body);else Da(s,r,t.body)}th(t)}}function Jd(e,t,n){return!!tp(t,84)||(tn(e,n),!1)}function Yd(t){return!!(8&e.getCheckFlags(t)||4&t.flags&&64&e.getDeclarationModifierFlagsFromSymbol(t)||3&t.flags&&2&Fu(t)||98304&t.flags&&!(65536&t.flags)||8&t.flags)}function Xd(t,n){if(Yd(n)){if(4&n.flags&&(179===t.kind||180===t.kind)&&99===t.expression.kind){var i=e.getContainingFunction(t);return!i||152!==i.kind||!(i.parent===n.valueDeclaration.parent||i===n.valueDeclaration.parent)}return!0}return!1}function Zd(t){if(179===t.kind||180===t.kind){var n=e.skipParentheses(t.expression);if(71===n.kind){var i=dn(n).resolvedSymbol;if(2097152&i.flags){var r=En(i);return r&&240===r.kind}}}return!1}function Qd(t,n){var i=e.skipOuterExpressions(t,3);return 71===i.kind||179===i.kind||180===i.kind||(tn(t,n),!1)}function ep(e,t){if(e.flags&t)return!0;if(196608&e.flags)for(var n=0,i=e.types;n<i.length;n++){if(ep(i[n],t))return!0}return!1}function tp(e,t,n){return!!(e.flags&t)||!(n&&7169&e.flags)&&(84&t&&Ia(e,te)||262178&t&&Ia(e,ee)||136&t&&Ia(e,re)||1024&t&&Ia(e,oe)||8192&t&&Ia(e,ae)||4096&t&&Ia(e,Z)||2048&t&&Ia(e,Y)||512&t&&Ia(e,se)||16777216&t&&Ia(e,ce))}function np(e){return 16&pn(e)&&e.symbol&&ip(e.symbol)}function ip(e){return!!(128&e.flags)}function rp(t,n,i){if(261===n.kind||262===n.kind){var r=n.name;if(144===r.kind&&gu(r),$i(r))return;var s=e.getTextOfPropertyName(r);if(l=Fi(t)?t:Mi(t,s)||mu(s)&&vs(t,1)||vs(t,0))return 262===n.kind?op(n,l):op(n.initializer,l);tn(r,e.Diagnostics.Type_0_has_no_property_1_and_no_string_index_signature,vi(t),e.declarationNameToString(r))}else{if(263===n.kind){E<5&&Jf(n,4);var o=[];if(i)for(var a=0;a<i.length-1;a++)o.push(i[a].name);var l=Ui(t,o,t.symbol);return op(n.expression,l)}tn(n,e.Diagnostics.Property_assignment_expected)}}function sp(t,n,i,r,s){var o=t.elements,a=o[i];if(200!==a.kind)if(198!==a.kind){var l=""+i,c=Fi(n)?n:sl(n)?Mi(n,l):r;if(c)return op(a,c,s);xp(a),ul(n)?tn(a,e.Diagnostics.Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2,vi(n),qs(n),o.length):tn(a,e.Diagnostics.Type_0_has_no_property_1,vi(n),l)}else if(i<o.length-1)tn(a,e.Diagnostics.A_rest_element_must_be_last_in_a_destructuring_pattern);else{var u=a.expression;if(194!==u.kind||58!==u.operatorToken.kind)return op(u,So(r),s);tn(u.operatorToken,e.Diagnostics.A_rest_element_cannot_have_an_initializer)}}function op(t,n,i){var r;if(262===t.kind){var s=t;s.objectAssignmentInitializer&&(!I||2048&pl(xp(s.objectAssignmentInitializer))||(n=Zl(n,131072)),dp(s.name,s.equalsToken,s.objectAssignmentInitializer,i)),r=t.name}else r=t;return 194===r.kind&&58===r.operatorToken.kind&&(up(r,i),r=r.left),178===r.kind?function(e,t){for(var n=e.properties,i=0,r=n;i<r.length;i++)rp(t,r[i],n);return t}(r,n):177===r.kind?function(e,t,n){E<2&&x.downlevelIteration&&Jf(e,512);for(var i=Ch(t,e,!1,!1)||J,r=e.elements,s=0;s<r.length;s++)sp(e,t,s,i,n);return t}(r,n,i):function(t,n,i){var r=xp(t,i),s=263===t.parent.kind?e.Diagnostics.The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access:e.Diagnostics.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access;Qd(t,s)&&Da(n,r,t,void 0);return n}(r,n,i)}function ap(t){switch((t=e.skipParentheses(t)).kind){case 71:case 9:case 12:case 183:case 196:case 13:case 8:case 101:case 86:case 95:case 139:case 186:case 199:case 187:case 177:case 178:case 189:case 203:case 250:case 249:return!0;case 195:return ap(t.whenTrue)&&ap(t.whenFalse);case 194:return!e.isAssignmentOperator(t.operatorToken.kind)&&(ap(t.left)&&ap(t.right));case 192:case 193:switch(t.operator){case 51:case 37:case 38:case 52:return!0}return!1;default:return!1}}function lp(e,t){return!!(6144&t.flags)||Na(e,t)}function cp(e,t){var n=Ia(e,t),i=Ia(t,e);return i&&!n?e:n&&!i?t:Po([e,t],!0)}function up(e,t){return dp(e.left,e.operatorToken,e.right,t,e)}function dp(t,n,r,s,o){var a=n.kind;if(58===a&&(178===t.kind||177===t.kind))return op(t,xp(r,s),s);var l,c=xp(t,s),u=xp(r,s);switch(a){case 39:case 40:case 61:case 62:case 41:case 63:case 42:case 64:case 38:case 60:case 45:case 65:case 46:case 66:case 47:case 67:case 49:case 69:case 50:case 70:case 48:case 68:if(c===le||u===le)return le;c=Vu(c,t),u=Vu(u,r);var d=void 0;if(136&c.flags&&136&u.flags&&void 0!==(d=function(e){switch(e){case 49:case 69:return 54;case 50:case 70:return 35;case 48:case 68:return 53;default:return}}(n.kind)))tn(o||n,e.Diagnostics.The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead,e.tokenToString(n.kind),e.tokenToString(d));else{var p=Jd(t,c,e.Diagnostics.The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type),h=Jd(r,u,e.Diagnostics.The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type);p&&h&&y(te)}return te;case 37:case 59:if(c===le||u===le)return le;tp(c,262178)||tp(u,262178)||(c=Vu(c,t),u=Vu(u,r));var f=void 0;return tp(c,84,!0)&&tp(u,84,!0)?f=te:tp(c,262178,!0)||tp(u,262178,!0)?f=ee:(Fi(c)||Fi(u))&&(f=c===J||u===J?J:W),f&&!_(a)?f:f?(59===a&&y(f),f):(b(),W);case 27:case 29:case 30:case 31:return _(a)&&(c=ll(Vu(c,t)),u=ll(Vu(u,r)),Na(c,u)||Na(u,c)||b()),re;case 32:case 33:case 34:case 35:var m=al(c),g=al(u);return m&&g||(c=m?ll(c):c,u=g?ll(u):u),lp(c,u)||lp(u,c)||b(),re;case 93:return function(t,n,i,r){return i===le||r===le?le:(!Fi(i)&&tp(i,8190)&&tn(t,e.Diagnostics.The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_parameter),Fi(r)||gs(r,0).length||gs(r,1).length||wa(r,xe)||tn(n,e.Diagnostics.The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_Function_interface_type),re)}(t,r,c,u);case 92:return function(t,n,i,r){return i===le||r===le?le:(i=Vu(i,t),r=Vu(r,n),Na(i,ee)||tp(i,596)||tn(t,e.Diagnostics.The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol),tp(r,17317888)||tn(n,e.Diagnostics.The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter),re)}(t,r,c,u);case 53:return 1048576&Xl(c)?Po([fl(I?c:ll(u)),u]):c;case 54:return 2097152&Xl(c)?cp(hl(c),u):c;case 58:return y(u),vl(u);case 26:return!x.allowUnreachableCode&&ap(t)&&(71!==(l=r).kind||"eval"!==l.escapedText)&&tn(t,e.Diagnostics.Left_side_of_comma_operator_is_unused_and_has_no_side_effects),u}function _(n){var i=ep(c,512)?t:ep(u,512)?r:void 0;return!i||(tn(i,e.Diagnostics.The_0_operator_cannot_be_applied_to_type_symbol,e.tokenToString(n)),!1)}function y(n){i&&e.isAssignmentOperator(a)&&Qd(t,e.Diagnostics.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access)&&Da(n,c,t,void 0)}function b(){tn(o||n,e.Diagnostics.Operator_0_cannot_be_applied_to_types_1_and_2,e.tokenToString(n.kind),vi(c),vi(u))}}function pp(t){if(i&&(4096&t.flags&&!function(t){for(var n=t,i=t.parent;i;){if(e.isFunctionLike(i)&&n===i.body)return!1;if(e.isClassLike(n))return!0;n=i,i=i.parent}return!1}(t)||vm(t,e.Diagnostics.A_yield_expression_is_only_allowed_in_a_generator_body),Xc(t)&&tn(t,e.Diagnostics.yield_expressions_cannot_be_used_in_a_parameter_initializer)),t.expression){var n=e.getContainingFunction(t),r=n&&e.getFunctionFlags(n);if(t.asteriskToken&&(!(3&~r)&&E<5&&Jf(t,26624),1==(3&r)&&E<2&&x.downlevelIteration&&Jf(t,256)),1&r){var s=fp(t.expression),o=void 0,a=!!t.asteriskToken;a&&(o=Ch(s,t.expression,!1,!!(2&r)));var l=e.getEffectiveReturnTypeNode(n);if(l){var c=Nh(aa(l),!!(2&r))||W;Da(a?2&r?Kp(o,t.expression,e.Diagnostics.Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):o:2&r?Kp(s,t.expression,e.Diagnostics.Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):s,c,t.expression,void 0)}}}return W}function hp(e,t,n){var i=e.contextualType,r=e.contextualMapper;e.contextualType=t,e.contextualMapper=n;var s=xp(e,n===k?1:n?2:0);return e.contextualType=i,e.contextualMapper=r,s}function fp(e,t){var n=dn(e);if(!n.resolvedType){var i=at;at=lt,n.resolvedType=xp(e,t),at=i}return n.resolvedType}function mp(t){return 184===(t=e.skipParentheses(t)).kind||202===t.kind}function gp(t){var n=kp(t.initializer,!0);return 2&e.getCombinedNodeFlags(t)||64&e.getCombinedModifierFlags(t)&&!e.isParameterPropertyDeclaration(t)||mp(t.initializer)?n:cl(n)}function _p(e){if(e){if(540672&e.flags){var t=rs(e)||ue;if(30&t.flags)return!0;e=t}return ep(e,262368)}return!1}function yp(e,t,n){2===arguments.length&&(n=su(e));var i=xp(e,t);return mp(e)||_p(n)?i:cl(i)}function bp(e,t){return 144===e.name.kind&&gu(e.name),yp(e.initializer,t)}function vp(e,t){return hm(e),144===e.name.kind&&gu(e.name),Tp(e,Wd(e,t),t)}function Tp(e,t,n){if(2===n){var i=od(t);if(i&&i.typeParameters){var r=ru(e);if(r){var s=od(_l(r));if(s&&!s.typeParameters)return Fs(ad(i,s,ou(e)))}}}return t}function kp(t,n){if(181===t.kind&&97!==t.expression.kind&&!e.isRequireCall(t,!0)){var i=od(Uu(t.expression));if(i&&!i.typeParameters)return Ds(i)}return n?fp(t):xp(t)}function xp(t,n){var r;if(143===t.kind)r=Gu(t);else{var s=function(t,n){switch(t.kind){case 71:return Bc(t);case 99:return jc(t);case 97:return zc(t);case 95:return Q;case 13:case 9:return ia(sa(t.text));case 8:return Sm(t),ia(sa(+t.text));case 101:return ne;case 86:return ie;case 196:return function(t){return e.forEach(t.templateSpans,function(e){xp(e.expression)}),ee}(t);case 12:return Ae;case 177:return hu(t,n);case 178:return yu(t,n);case 179:return Hu(t);case 180:return Qu(t);case 181:if(91===t.expression.kind)return Od(t);case 182:return Dd(t);case 183:return function(e){return E<2&&Jf(e,65536),Ds(wd(e))}(t);case 185:return function(t,n){var i=e.isInJavaScriptFile(t)?e.getJSDocTypeTag(t):void 0;if(i)return Rd(i,i.typeExpression.type,t.expression,n);return xp(t.expression,n)}(t,n);case 199:return function(e){return Uh(e),sf(e),nr(qn(e))}(t);case 186:case 187:return Wd(t,n);case 189:return function(e){return xp(e.expression),Ht}(t);case 184:case 202:return function(e){return Rd(e,e.type,e.expression)}(t);case 203:return function(e){return _l(xp(e.expression))}(t);case 204:return Ld(t);case 188:return function(t){xp(t.expression);var n=e.skipParentheses(t.expression);if(179!==n.kind&&180!==n.kind)return tn(n,e.Diagnostics.The_operand_of_a_delete_operator_must_be_a_property_reference),re;var i=Yn(dn(n).resolvedSymbol);return i&&Yd(i)&&tn(n,e.Diagnostics.The_operand_of_a_delete_operator_cannot_be_a_read_only_property),re}(t);case 190:return function(e){return xp(e.expression),X}(t);case 191:return function(t){return i&&(16384&t.flags||vm(t,e.Diagnostics.await_expression_is_only_allowed_within_an_async_function),Xc(t)&&tn(t,e.Diagnostics.await_expressions_cannot_be_used_in_a_parameter_initializer)),jp(xp(t.expression),t,e.Diagnostics.Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)}(t);case 192:return function(t){var n=xp(t.operand);if(n===le)return le;if(8===t.operand.kind){if(38===t.operator)return ia(sa(-t.operand.text));if(37===t.operator)return ia(sa(+t.operand.text))}switch(t.operator){case 37:case 38:case 52:return Vu(n,t.operand),ep(n,512)&&tn(t.operand,e.Diagnostics.The_0_operator_cannot_be_applied_to_type_symbol,e.tokenToString(t.operator)),te;case 51:var i=3145728&Xl(n);return 1048576===i?ie:2097152===i?ne:re;case 43:case 44:return Jd(t.operand,Vu(n,t.operand),e.Diagnostics.An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type)&&Qd(t.operand,e.Diagnostics.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access),te}return J}(t);case 193:return function(t){var n=xp(t.operand);return n===le?le:(Jd(t.operand,Vu(n,t.operand),e.Diagnostics.An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type)&&Qd(t.operand,e.Diagnostics.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access),te)}(t);case 194:return up(t,n);case 195:return function(e,t){return xp(e.condition),cp(xp(e.whenTrue,t),xp(e.whenFalse,t))}(t,n);case 198:return function(e,t){return E<2&&x.downlevelIteration&&Jf(e,1536),Ch(xp(e.expression,t),e.expression,!1,!1)}(t,n);case 200:return X;case 197:return pp(t);case 256:return function(t,n){if(t.expression){var i=xp(t.expression,n);return t.dotDotDotToken&&i!==W&&!il(i)&&tn(t,e.Diagnostics.JSX_spread_child_must_be_an_array_type),i}return J}(t,n);case 249:return function(e){return Pu(e.openingElement),Tu(e.closingElement.tagName)?Eu(e.closingElement):xp(e.closingElement.tagName),Ru()||W}(t);case 250:return function(e){return Pu(e),Ru()||W}(t);case 254:return function(e,t){return ku(e.parent,void 0,t)}(t,n);case 251:e.Debug.fail("Shouldn't ever directly check a JsxOpeningElement")}return J}(t,n);r=Tp(t,s,n)}np(r)&&(179===t.parent.kind&&t.parent.expression===t||180===t.parent.kind&&t.parent.expression===t||(71===t.kind||143===t.kind)&&ff(t)||tn(t,e.Diagnostics.const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_import_declaration_or_export_assignment));return r}function Ep(t){t.expression&&vm(t.expression,e.Diagnostics.Type_expected),rf(t.constraint),rf(t.default);var n=Sr(qn(t));ss(n)||tn(t.constraint,e.Diagnostics.Type_parameter_0_has_a_circular_constraint,vi(n)),function(e){return as(e)!==ge}(n)||tn(t.default,e.Diagnostics.Type_parameter_0_has_a_circular_default,vi(n));var r=ns(n),s=ls(n);r&&s&&Da(s,Lr(r,s),t.default,e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1),i&&Mh(t.name,e.Diagnostics.Type_parameter_name_cannot_be_0)}function Sp(t){Xf(t)||Zf(t),bh(t);var n=e.getContainingFunction(t);e.hasModifier(t,92)&&(152===n.kind&&e.nodeIsPresent(n.body)||tn(t,e.Diagnostics.A_parameter_property_is_only_allowed_in_a_constructor_implementation)),t.questionToken&&e.isBindingPattern(t.name)&&n.body&&tn(t,e.Diagnostics.A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature),t.name&&e.isIdentifier(t.name)&&("this"===t.name.escapedText||"new"===t.name.escapedText)&&(0!==e.indexOf(n.parameters,t)&&tn(t,e.Diagnostics.A_0_parameter_must_be_the_first_parameter,t.name.escapedText),152!==n.kind&&156!==n.kind&&161!==n.kind||tn(t,e.Diagnostics.A_constructor_cannot_have_a_this_parameter)),!t.dotDotDotToken||e.isBindingPattern(t.name)||il(nr(t.symbol))||tn(t,e.Diagnostics.A_rest_parameter_must_be_of_an_array_type)}function Cp(e,t){if(e)for(var n=0;n<e.length;n++){var i=e[n];if(71===i.name.kind&&i.name.escapedText===t.escapedText)return n}return-1}function wp(t,n,i){for(var r=0,s=t.elements;r<s.length;r++){var o=s[r];if(!e.isOmittedExpression(o)){var a=o.name;if(71===a.kind&&a.escapedText===i)return tn(n,e.Diagnostics.A_type_predicate_cannot_reference_element_0_in_a_binding_pattern,i),!0;if((175===a.kind||174===a.kind)&&wp(a,n,i))return!0}}}function Ip(t){157===t.kind?function(t){Xf(t)||Zf(t)||function(t){var n=t.parameters[0];if(1!==t.parameters.length)return km(n?n.name:t,e.Diagnostics.An_index_signature_must_have_exactly_one_parameter);if(n.dotDotDotToken)return km(n.dotDotDotToken,e.Diagnostics.An_index_signature_cannot_have_a_rest_parameter);if(e.hasModifiers(n))return km(n.name,e.Diagnostics.An_index_signature_parameter_cannot_have_an_accessibility_modifier);if(n.questionToken)return km(n.questionToken,e.Diagnostics.An_index_signature_parameter_cannot_have_a_question_mark);if(n.initializer)return km(n.name,e.Diagnostics.An_index_signature_parameter_cannot_have_an_initializer);if(!n.type)return km(n.name,e.Diagnostics.An_index_signature_parameter_must_have_a_type_annotation);if(136!==n.type.kind&&133!==n.type.kind)return km(n.name,e.Diagnostics.An_index_signature_parameter_type_must_be_string_or_number);if(!t.type)km(t,e.Diagnostics.An_index_signature_must_have_a_type_annotation)}(t)}(t):160!==t.kind&&228!==t.kind&&161!==t.kind&&155!==t.kind&&152!==t.kind&&156!==t.kind||nm(t);var n=e.getFunctionFlags(t);if(4&n||(!(3&~n)&&E<5&&Jf(t,6144),2==(3&n)&&E<4&&Jf(t,64),3&n&&E<2&&Jf(t,128)),Fh(t.typeParameters),e.forEach(t.parameters,Sp),t.type&&rf(t.type),i){!function(t){if(!e.hasRestParameter(t)||e.isInAmbientContext(t)||e.nodeIsMissing(t.body))return;e.forEach(t.parameters,function(t){t.name&&!e.isBindingPattern(t.name)&&t.name.escapedText===F.escapedName&&tn(t,e.Diagnostics.Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters)})}(t);var r=e.getEffectiveReturnTypeNode(t);if(N&&!r)switch(t.kind){case 156:tn(t,e.Diagnostics.Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type);break;case 155:tn(t,e.Diagnostics.Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type)}if(r){var s=e.getFunctionFlags(t);if(1==(5&s)){var o=aa(r);if(o===oe)tn(r,e.Diagnostics.A_generator_cannot_have_a_void_type_annotation);else{var a=Nh(o,!!(2&s))||W;Da(2&s?ko(a):Eo(a),o,r)}}else 2==(3&s)&&zp(t)}C&&!t.body&&oh(t)}}function Ap(t){for(var n=e.createMap(),i=0,r=t.members;i<r.length;i++){var s=r[i];if(148===s.kind){var o=void 0;switch(s.name.kind){case 9:case 8:o=s.name.text;break;case 71:o=e.idText(s.name);break;default:continue}n.get(o)?(tn(e.getNameOfDeclaration(s.symbol.valueDeclaration),e.Diagnostics.Duplicate_identifier_0,o),tn(s.name,e.Diagnostics.Duplicate_identifier_0,o)):n.set(o,!0)}}}function Np(t){if(230===t.kind){var n=qn(t);if(n.declarations.length>0&&n.declarations[0]!==t)return}var i=Bs(qn(t));if(i)for(var r=!1,s=!1,o=0,a=i.declarations;o<a.length;o++){var l=a[o];if(1===l.parameters.length&&l.parameters[0].type)switch(l.parameters[0].type.kind){case 136:s?tn(l,e.Diagnostics.Duplicate_string_index_signature):s=!0;break;case 133:r?tn(l,e.Diagnostics.Duplicate_number_index_signature):r=!0}}}function Dp(t){Xf(t)||Zf(t)||function(t){if(e.isClassLike(t.parent)){if(pm(t.name,e.Diagnostics.A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol))return!0}else if(230===t.parent.kind){if(pm(t.name,e.Diagnostics.A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol))return!0;if(t.initializer)return km(t.initializer,e.Diagnostics.An_interface_property_cannot_have_an_initializer)}else if(163===t.parent.kind){if(pm(t.name,e.Diagnostics.A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol))return!0;if(t.initializer)return km(t.initializer,e.Diagnostics.A_type_literal_property_cannot_have_an_initializer)}if(e.isInAmbientContext(t)&&t.initializer)return vm(t.initializer,e.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)}(t)||am(t.name),bh(t)}function Op(t){Ip(t),function(t){if(t.typeParameters)return Tm(t,t.typeParameters.pos,t.typeParameters.end-t.typeParameters.pos,e.Diagnostics.Type_parameters_cannot_appear_on_a_constructor_declaration)}(t)||function(t){if(t.type)km(t.type,e.Diagnostics.Type_annotation_cannot_appear_on_a_constructor_declaration)}(t),rf(t.body),th(t);var n=qn(t);if(t===e.getDeclarationOfKind(n,t.kind)&&Up(n),!e.nodeIsMissing(t.body)&&i){var r=t.parent;if(e.getClassExtendsHeritageClauseElement(r)){$c(t.parent,r);var s=Hc(r),o=Vc(t);if(o){if(s&&tn(o,e.Diagnostics.A_constructor_cannot_contain_a_super_call_when_its_class_extends_null),e.some(t.parent.members,function(t){return 149===t.kind&&!e.hasModifier(t,32)&&!!t.initializer})||e.some(t.parameters,function(t){return e.hasModifier(t,92)})){for(var a=void 0,l=0,c=t.body.statements;l<c.length;l++){var u=c[l];if(210===u.kind&&e.isSuperCall(u.expression)){a=u;break}if(!e.isPrologueDirective(u))break}a||tn(t,e.Diagnostics.A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_properties_or_has_parameter_properties)}}else s||tn(t,e.Diagnostics.Constructors_for_derived_classes_must_contain_a_super_call)}}}function Rp(t){if(i){if(nm(t)||function(t){var n=t.kind;if(E<1)return km(t.name,e.Diagnostics.Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher);if(e.isInAmbientContext(t))return km(t.name,e.Diagnostics.An_accessor_cannot_be_declared_in_an_ambient_context);if(void 0===t.body&&!e.hasModifier(t,128))return Tm(t,t.end-1,1,e.Diagnostics._0_expected,"{");if(t.body&&e.hasModifier(t,128))return km(t,e.Diagnostics.An_abstract_accessor_cannot_have_an_implementation);if(t.typeParameters)return km(t.name,e.Diagnostics.An_accessor_cannot_have_type_parameters);if(!function(e){return dm(e)||e.parameters.length===(153===e.kind?0:1)}(t))return km(t.name,153===n?e.Diagnostics.A_get_accessor_cannot_have_parameters:e.Diagnostics.A_set_accessor_must_have_exactly_one_parameter);if(154===n){if(t.type)return km(t.name,e.Diagnostics.A_set_accessor_cannot_have_a_return_type_annotation);var i=t.parameters[0];if(i.dotDotDotToken)return km(i.dotDotDotToken,e.Diagnostics.A_set_accessor_cannot_have_rest_parameter);if(i.questionToken)return km(i.questionToken,e.Diagnostics.A_set_accessor_cannot_have_an_optional_parameter);if(i.initializer)return km(t.name,e.Diagnostics.A_set_accessor_parameter_cannot_have_an_initializer)}}(t)||am(t.name),Zp(t),Ip(t),153===t.kind&&!e.isInAmbientContext(t)&&e.nodeIsPresent(t.body)&&128&t.flags&&(256&t.flags||tn(t.name,e.Diagnostics.A_get_accessor_must_return_a_value)),144===t.name.kind&&gu(t.name),!e.hasDynamicName(t)){var n=153===t.kind?154:153,r=e.getDeclarationOfKind(t.symbol,n);if(r){var s=e.getModifierFlags(t),o=e.getModifierFlags(r);(28&s)!=(28&o)&&tn(t.name,e.Diagnostics.Getter_and_setter_accessors_do_not_agree_in_visibility),(128&s)!=(128&o)&&tn(t.name,e.Diagnostics.Accessors_must_both_be_abstract_or_non_abstract),Lp(t,r,Xi,e.Diagnostics.get_and_set_accessor_must_have_the_same_type),Lp(t,r,Zi,e.Diagnostics.get_and_set_accessor_must_have_the_same_this_type)}}var a=Qi(qn(t));153===t.kind&&zd(t,a)}rf(t.body),th(t)}function Lp(e,t,n,i){var r=n(e),s=n(t);r&&s&&!Ea(r,s)&&tn(e,i)}function Pp(t,n){for(var i,r,s=Cs(t),o=!0,a=0;a<t.length;a++){var l=ns(t[a]);if(l){i||(r=da(t,i=ws(e.map(n,aa),t,s,e.isInJavaScriptFile(n[a]))));var c=i[a];o=o&&Da(c,ya(l,r),n[a],e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1)}}return o}function Mp(t){im(t,t.typeArguments),159!==t.kind||void 0===t.typeName.jsdocDotPos||e.isInJavaScriptFile(t)||e.isInJSDoc(t)||Tm(t,t.typeName.jsdocDotPos,1,e.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments);var n=to(t);if(n!==J){if(t.typeArguments&&(e.forEach(t.typeArguments,rf),i)){var r=dn(t).resolvedSymbol;if(!r)return void(e.isJSDocIndexSignature(t)||tn(t,e.Diagnostics.Type_0_is_not_generic,vi(n)));var s=524288&r.flags&&un(r).typeParameters;!s&&4&pn(n)&&(s=n.target.localTypeParameters),Pp(s,t.typeArguments)}16&n.flags&&8&dn(t).resolvedSymbol.flags&&tn(t,e.Diagnostics.Enum_type_0_has_members_with_initializers_that_are_not_literals,vi(n))}}function Fp(t,n){if(!(524288&t.flags))return t;var i=t.objectType,r=t.indexType;return Ia(r,Vo(i))?(180===n.kind&&e.isAssignmentTarget(n)&&32&pn(i)&&i.declaration.readonlyToken&&tn(n,e.Diagnostics.Index_signature_in_type_0_only_permits_reading,vi(i)),t):(bs(us(i),1)&&tp(r,84)||tn(n,e.Diagnostics.Type_0_cannot_be_used_to_index_type_1,vi(r),vi(i)),t)}function Bp(t){return e.hasModifier(t,8)&&e.isInAmbientContext(t)}function $p(t,n){var i=e.getCombinedModifierFlags(t);return 230!==t.parent.kind&&229!==t.parent.kind&&199!==t.parent.kind&&e.isInAmbientContext(t)&&(2&i||(i|=1),i|=2),i&n}function Up(t){if(i){for(var n,r,s,o=0,a=155,l=!1,c=!0,u=!1,d=t.declarations,p=!!(16384&t.flags),h=!1,f=!1,m=0,g=d;m<g.length;m++){var _=g[m],y=e.isInAmbientContext(_),b=230===_.parent.kind||163===_.parent.kind||y;if(b&&(s=void 0),228===_.kind||151===_.kind||150===_.kind||152===_.kind){var v=$p(_,155);o|=v,a&=v,l=l||e.hasQuestionToken(_),c=c&&e.hasQuestionToken(_),e.nodeIsPresent(_.body)&&n?p?f=!0:h=!0:s&&s.parent===_.parent&&s.end!==_.pos&&w(s),e.nodeIsPresent(_.body)?n||(n=_):u=!0,s=_,b||(r=_)}}if(f&&e.forEach(d,function(t){tn(t,e.Diagnostics.Multiple_constructor_implementations_are_not_allowed)}),h&&e.forEach(d,function(t){tn(e.getNameOfDeclaration(t),e.Diagnostics.Duplicate_function_implementation)}),!r||r.body||e.hasModifier(r,128)||r.questionToken||w(r),u&&(function(t,n,i,r,s){if(0!==(r^s)){var o=$p(C(t,n),i);e.forEach(t,function(t){var n=$p(t,i)^o;1&n?tn(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_exported_or_non_exported):2&n?tn(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_ambient_or_non_ambient):24&n?tn(e.getNameOfDeclaration(t)||t,e.Diagnostics.Overload_signatures_must_all_be_public_private_or_protected):128&n&&tn(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_abstract_or_non_abstract)})}}(d,n,155,o,a),function(t,n,i,r){if(i!==r){var s=e.hasQuestionToken(C(t,n));e.forEach(t,function(t){e.hasQuestionToken(t)!==s&&tn(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_optional_or_required)})}}(d,n,l,c),n))for(var T=As(t),k=Is(n),x=0,E=T;x<E.length;x++){var S=E[x];if(!La(k,S)){tn(S.declaration,e.Diagnostics.Overload_signature_is_not_compatible_with_function_implementation);break}}}function C(e,t){return void 0!==t&&t.parent===e[0].parent?t:e[0]}function w(t){if(!t.name||!e.nodeIsMissing(t.name)){var n=!1,i=e.forEachChild(t.parent,function(e){if(n)return e;n=e===t});if(i&&i.pos===t.end&&i.kind===t.kind){var r=i.name||i,s=i.name;if(t.name&&s&&(e.isComputedPropertyName(t.name)&&e.isComputedPropertyName(s)||!e.isComputedPropertyName(t.name)&&!e.isComputedPropertyName(s)&&e.getEscapedTextOfIdentifierOrLiteral(t.name)===e.getEscapedTextOfIdentifierOrLiteral(s))){if((151===t.kind||150===t.kind)&&e.hasModifier(t,32)!==e.hasModifier(i,32))tn(r,e.hasModifier(t,32)?e.Diagnostics.Function_overload_must_be_static:e.Diagnostics.Function_overload_must_not_be_static);return}if(e.nodeIsPresent(i.body))return void tn(r,e.Diagnostics.Function_implementation_name_must_be_0,e.declarationNameToString(t.name))}var o=t.name||t;p?tn(o,e.Diagnostics.Constructor_implementation_is_missing):e.hasModifier(t,128)?tn(o,e.Diagnostics.All_declarations_of_an_abstract_method_must_be_consecutive):tn(o,e.Diagnostics.Function_implementation_is_missing_or_not_immediately_following_the_declaration)}}}function Vp(t){if(i){var n=t.localSymbol;if((n||(n=qn(t)).exportSymbol)&&e.getDeclarationOfKind(n,t.kind)===t){for(var r=0,s=0,o=0,a=0,l=n.declarations;a<l.length;a++){var c=y(g=l[a]),u=$p(g,513);1&u?512&u?o|=c:r|=c:s|=c}var d,p=r&s,h=o&(r|s);if(p||h)for(var f=0,m=n.declarations;f<m.length;f++){c=y(g=m[f]);var g,_=e.getNameOfDeclaration(g);c&h?tn(_,e.Diagnostics.Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_default_0_declaration_instead,e.declarationNameToString(_)):c&p&&tn(_,e.Diagnostics.Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local,e.declarationNameToString(_))}!function(e){e[e.None=0]="None",e[e.ExportValue=1]="ExportValue",e[e.ExportType=2]="ExportType",e[e.ExportNamespace=4]="ExportNamespace"}(d||(d={}))}}function y(t){switch(t.kind){case 230:case 231:case 283:return 2;case 233:return e.isAmbientModule(t)||0!==e.getModuleInstanceState(t)?5:4;case 229:case 232:return 3;case 237:case 240:case 239:var n=0,i=Nn(qn(t));return e.forEach(i.declarations,function(e){n|=y(e)}),n;case 226:case 176:case 228:case 242:return 1;default:e.Debug.fail(e.SyntaxKind[t.kind])}}}function Hp(e,t,n){var i=Gp(e,t);return i&&Kp(i,t,n)}function Gp(t,n){if(!Fi(t)){var i=t;if(i.promisedTypeOfPromise)return i.promisedTypeOfPromise;if(ir(t,co(!1)))return i.promisedTypeOfPromise=t.typeArguments[0];var r=Mi(t,"then");if(!Fi(r)){var s=r?gs(r,0):e.emptyArray;if(0!==s.length){var o=Zl(Po(e.map(s,Fd)),524288);if(!Fi(o)){var a=gs(o,0);if(0!==a.length)return i.promisedTypeOfPromise=Po(e.map(a,Fd),!0);n&&tn(n,e.Diagnostics.The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback)}}else n&&tn(n,e.Diagnostics.A_promise_must_have_a_then_method)}}}function jp(e,t,n){return Kp(e,t,n)||J}function Kp(t,n,i){var r=t;if(r.awaitedTypeOfType)return r.awaitedTypeOfType;if(Fi(t))return r.awaitedTypeOfType=t;if(65536&t.flags){for(var s=void 0,o=0,a=t.types;o<a.length;o++){var l=a[o];s=e.append(s,Kp(l,n,i))}if(!s)return;return r.awaitedTypeOfType=Po(s)}var c=Gp(t);if(c){if(t.id===c.id||e.indexOf(At,c.id)>=0)return void(n&&tn(n,e.Diagnostics.Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method));At.push(t.id);var u=Kp(c,n,i);if(At.pop(),!u)return;return r.awaitedTypeOfType=u}var d=Mi(t,"then");if(!(d&&gs(d,0).length>0))return r.awaitedTypeOfType=t;n&&(e.Debug.assert(!!i),tn(n,i))}function zp(t){var n,i=e.getEffectiveReturnTypeNode(t),r=aa(i);if(E>=2){if(r===J)return J;var s=co(!0);if(s!==he&&!ir(r,s))return tn(i,e.Diagnostics.The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type),J}else{if(function(t){qp(t&&e.getEntityNameFromTypeNode(t))}(i),r===J)return J;var o=e.getEntityNameFromTypeNode(i);if(void 0===o)return tn(i,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,vi(r)),J;var a=Pn(o,107455,!0),l=a?nr(a):J;if(l===J)return 71===o.kind&&"Promise"===o.escapedText&&rr(r)===co(!1)?tn(i,e.Diagnostics.An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option):tn(i,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,e.entityNameToString(o)),J;var c=(n=!0,$e||($e=ao("PromiseConstructorLike",0,n))||ue);if(c===ue)return tn(i,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,e.entityNameToString(o)),J;if(!Da(l,c,i,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value))return J;var u=o&&Jh(o),d=fn(t.locals,u.escapedText,107455);if(d)return tn(d.valueDeclaration,e.Diagnostics.Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions,e.idText(u),e.entityNameToString(o)),J}return jp(r,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)}function Wp(t){var n=Ds(wd(t));if(!(1&n.flags)){var i,r,s=kd(t);switch(t.parent.kind){case 229:i=Po([nr(qn(t.parent)),oe]);break;case 146:i=oe,r=e.chainDiagnosticMessages(r,e.Diagnostics.The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any);break;case 149:i=oe,r=e.chainDiagnosticMessages(r,e.Diagnostics.The_return_type_of_a_property_decorator_function_must_be_either_void_or_any);break;case 151:case 153:case 154:i=Po([To(_f(t.parent)),oe])}Da(n,i,t,s,r)}}function qp(e){if(e){var t=Jh(e),n=2097152|(71===e.kind?793064:1920),i=gn(t,t.escapedText,n,void 0,void 0,!0);i&&2097152&i.flags&&Xn(i)&&!Nf(Nn(i))&&On(i)}}function Jp(t){var n=Yp(t);n&&e.isEntityName(n)&&qp(n)}function Yp(t){if(t)switch(t.kind){case 167:case 166:for(var n=void 0,i=0,r=t.types;i<r.length;i++){var s=Yp(r[i]);if(!s)return;if(n){if(!e.isIdentifier(n)||!e.isIdentifier(s)||n.escapedText!==s.escapedText)return}else n=s}return n;case 168:return Yp(t.type);case 159:return t.typeName}}function Xp(t){var n=e.getEffectiveTypeAnnotationNode(t);return e.isRestParameter(t)?e.getRestParameterElementType(n):n}function Zp(t){if(t.decorators&&e.nodeCanBeDecorated(t)){x.experimentalDecorators||tn(t,e.Diagnostics.Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning);var n=t.decorators[0];if(Jf(n,8),146===t.kind&&Jf(n,32),x.emitDecoratorMetadata)switch(Jf(n,16),t.kind){case 229:var i=e.getFirstConstructorWithBody(t);if(i)for(var r=0,s=i.parameters;r<s.length;r++){Jp(Xp(s[r]))}break;case 151:case 153:case 154:for(var o=0,a=t.parameters;o<a.length;o++){Jp(Xp(a[o]))}Jp(e.getEffectiveReturnTypeNode(t));break;case 149:Jp(e.getEffectiveTypeAnnotationNode(t));break;case 146:Jp(Xp(t))}e.forEach(t.decorators,Wp)}}function Qp(e){switch(e.kind){case 71:return e;case 179:return e.name;default:return}}function eh(t){Zp(t),Ip(t);var n=e.getFunctionFlags(t);if(t.name&&144===t.name.kind&&gu(t.name),!e.hasDynamicName(t)){var r=qn(t),s=t.localSymbol||r,o=e.find(s.declarations,function(e){return e.kind===t.kind&&!(65536&e.flags)});t===o&&Up(s),r.parent&&e.getDeclarationOfKind(r,t.kind)===t&&Up(r)}rf(t.body);var a=e.getEffectiveReturnTypeNode(t);if(!(1&n)){var l=a&&(2&n?zp(t):aa(a));zd(t,l)}i&&!a&&(N&&e.nodeIsMissing(t.body)&&!Bp(t)&&Sl(t,W),1&n&&e.nodeIsPresent(t.body)&&Ds(Is(t))),th(t)}function th(e){Xe&&Xe.push(e)}function nh(t){230!==t.parent.kind&&C&&!e.isInAmbientContext(t)&&t.locals.forEach(function(t){if(!t.isReferenced)if(t.valueDeclaration&&146===e.getRootDeclaration(t.valueDeclaration).kind){var n=e.getRootDeclaration(t.valueDeclaration),i=e.getNameOfDeclaration(t.valueDeclaration);!x.noUnusedParameters||e.isParameterPropertyDeclaration(n)||e.parameterIsThisKeyword(n)||(r=i)&&rh(r)||tn(i,e.Diagnostics._0_is_declared_but_its_value_is_never_read,e.symbolName(t))}else x.noUnusedLocals&&e.forEach(t.declarations,function(n){return ih(n,e.symbolName(t))});var r})}function ih(t,n){var i=e.getNameOfDeclaration(t)||t;if(rh(i)){var r=e.getRootDeclaration(i.parent);if(226===r.kind&&e.isForInOrOfStatement(r.parent.parent)||145===r.kind)return}(function(t){if(e.isBindingElement(t)&&e.isObjectBindingPattern(t.parent)){var n=e.lastOrUndefined(t.parent.elements);return n!==t&&!!n.dotDotDotToken}return!1})(71===i.kind?i.parent:i)||tn(i,e.Diagnostics._0_is_declared_but_its_value_is_never_read,n)}function rh(t){return 71===t.kind&&95===e.idText(t).charCodeAt(0)}function sh(t){if(x.noUnusedLocals&&!e.isInAmbientContext(t)&&t.members)for(var n=0,i=t.members;n<i.length;n++){var r=i[n];if(151===r.kind||149===r.kind)!r.symbol.isReferenced&&e.hasModifier(r,8)&&tn(r.name,e.Diagnostics._0_is_declared_but_its_value_is_never_read,e.symbolName(r.symbol));else if(152===r.kind)for(var s=0,o=r.parameters;s<o.length;s++){var a=o[s];!a.symbol.isReferenced&&e.hasModifier(a,8)&&tn(a.name,e.Diagnostics.Property_0_is_declared_but_its_value_is_never_read,e.symbolName(a.symbol))}}}function oh(t){if(x.noUnusedLocals&&!e.isInAmbientContext(t)&&t.typeParameters){var n=qn(t);if((n&&n.declarations&&e.lastOrUndefined(n.declarations))!==t)return;for(var i=0,r=t.typeParameters;i<r.length;i++){var s=r[i];Wn(s.symbol).isReferenced||rh(s.name)||tn(s.name,e.Diagnostics._0_is_declared_but_its_value_is_never_read,e.symbolName(s.symbol))}}}function ah(t){x.noUnusedLocals&&!e.isInAmbientContext(t)&&t.locals.forEach(function(t){if(!t.isReferenced&&!t.exportSymbol)for(var n=0,i=t.declarations;n<i.length;n++){var r=i[n];e.isAmbientModule(r)||ih(r,e.symbolName(t))}})}function lh(t){if(207===t.kind&&Em(t),e.isFunctionOrModuleBlock(t)){var n=ut;e.forEach(t.statements,rf),ut=n}else e.forEach(t.statements,rf);t.locals&&th(t)}function ch(t,n,i){if(!n||n.escapedText!==i)return!1;if(149===t.kind||148===t.kind||151===t.kind||150===t.kind||153===t.kind||154===t.kind)return!1;if(e.isInAmbientContext(t))return!1;var r=e.getRootDeclaration(t);return 146!==r.kind||!e.nodeIsMissing(r.parent.body)}function uh(e,t){ch(e,t,"_this")&&wt.push(e)}function dh(e,t){ch(e,t,"_newTarget")&&It.push(e)}function ph(t){e.findAncestor(t,function(n){if(4&Pf(n))return 71!==t.kind?tn(e.getNameOfDeclaration(t),e.Diagnostics.Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference):tn(t,e.Diagnostics.Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference),!0})}function hh(t){e.findAncestor(t,function(n){if(8&Pf(n))return 71!==t.kind?tn(e.getNameOfDeclaration(t),e.Diagnostics.Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_meta_property_reference):tn(t,e.Diagnostics.Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta_property_reference),!0})}function fh(t,n){if(ch(t,n,"_super")){var i=e.getContainingClass(t);if(i&&!e.isInAmbientContext(i))if(e.getClassExtendsHeritageClauseElement(i))tn(t,71!==t.kind?e.Diagnostics.Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference:e.Diagnostics.Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference)}}function mh(t,n){if(!(S>=e.ModuleKind.ES2015)&&(ch(t,n,"require")||ch(t,n,"exports"))&&(233!==t.kind||1===e.getModuleInstanceState(t))){var i=Pi(t);265===i.kind&&e.isExternalOrCommonJsModule(i)&&tn(n,e.Diagnostics.Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module,e.declarationNameToString(n),e.declarationNameToString(n))}}function gh(t,n){if(!(E>=4)&&ch(t,n,"Promise")&&(233!==t.kind||1===e.getModuleInstanceState(t))){var i=Pi(t);265===i.kind&&e.isExternalOrCommonJsModule(i)&&1024&i.flags&&tn(n,e.Diagnostics.Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_functions,e.declarationNameToString(n),e.declarationNameToString(n))}}function _h(t){if(146===e.getRootDeclaration(t).kind){var n=e.getContainingFunction(t);!function i(r){if(e.isTypeNode(r)||e.isDeclarationName(r))return;if(179===r.kind)return i(r.expression);if(71!==r.kind)return e.forEachChild(r,i);var s=gn(r,r.escapedText,2204607,void 0,void 0,!1);if(!s||s===K||!s.valueDeclaration)return;if(s.valueDeclaration===t)return void tn(r,e.Diagnostics.Parameter_0_cannot_be_referenced_in_its_initializer,e.declarationNameToString(t.name));if(e.getEnclosingBlockScopeContainer(s.valueDeclaration)===n){if(146===s.valueDeclaration.kind||176===s.valueDeclaration.kind){if(s.valueDeclaration.pos<t.pos)return;if(e.findAncestor(r,function(n){return n===t.initializer?"quit":e.isFunctionLike(n.parent)||149===n.parent.kind&&!e.hasModifier(n.parent,32)&&e.isClassLike(n.parent.parent)}))return}tn(r,e.Diagnostics.Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it,e.declarationNameToString(t.name),e.declarationNameToString(r))}}(t.initializer)}}function yh(e){return e===q?W:e===Oe?De:e}function bh(t){if(Zp(t),rf(t.type),t.name){if(144===t.name.kind&&(gu(t.name),t.initializer&&fp(t.initializer)),176===t.kind){174===t.parent.kind&&E<5&&Jf(t,4),t.propertyName&&144===t.propertyName.kind&&gu(t.propertyName);var n=t.parent.parent,i=Bi(n),r=t.propertyName||t.name,s=fs(i,e.getTextOfPropertyName(r));Ju(s,void 0,!1),n.initializer&&s&&$u(n,n.initializer,i,s)}if(e.isBindingPattern(t.name)&&(175===t.name.kind&&E<2&&x.downlevelIteration&&Jf(t,512),e.forEach(t.name.elements,rf)),t.initializer&&146===e.getRootDeclaration(t).kind&&e.nodeIsMissing(e.getContainingFunction(t).body))tn(t,e.Diagnostics.A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation);else if(e.isBindingPattern(t.name))t.initializer&&215!==t.parent.parent.kind&&(Da(fp(t.initializer),qi(t),t,void 0),_h(t));else{var o=qn(t),a=yh(Yi(o));if(t===o.valueDeclaration)t.initializer&&215!==t.parent.parent.kind&&(Da(fp(t.initializer),a,t,void 0),_h(t));else{var l=yh(qi(t));a===J||l===J||Ea(a,l)||tn(t.name,e.Diagnostics.Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2,e.declarationNameToString(t.name),vi(a),vi(l)),t.initializer&&Da(fp(t.initializer),l,t,void 0),function(t,n){if(146===t.kind&&226===n.kind||226===t.kind&&146===n.kind)return!0;if(e.hasQuestionToken(t)!==e.hasQuestionToken(n))return!1;var i=504;return e.getSelectedModifierFlags(t,i)===e.getSelectedModifierFlags(n,i)}(t,o.valueDeclaration)||(tn(e.getNameOfDeclaration(o.valueDeclaration),e.Diagnostics.All_declarations_of_0_must_have_identical_modifiers,e.declarationNameToString(t.name)),tn(t.name,e.Diagnostics.All_declarations_of_0_must_have_identical_modifiers,e.declarationNameToString(t.name)))}149!==t.kind&&148!==t.kind&&(Vp(t),226!==t.kind&&176!==t.kind||function(t){if(!(3&e.getCombinedNodeFlags(t)||e.isParameterDeclaration(t))&&(226!==t.kind||t.initializer)){var n=qn(t);if(1&n.flags){if(!e.isIdentifier(t.name))throw e.Debug.fail();var i=gn(t,t.name.escapedText,3,void 0,void 0,!1);if(i&&i!==n&&2&i.flags&&3&Fu(i)){var r=e.getAncestor(i.valueDeclaration,227),s=208===r.parent.kind&&r.parent.parent?r.parent.parent:void 0;if(!s||!(207===s.kind&&e.isFunctionLike(s.parent)||234===s.kind||233===s.kind||265===s.kind)){var o=yi(i);tn(t,e.Diagnostics.Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1,o,o)}}}}}(t),fh(t,t.name),uh(t,t.name),dh(t,t.name),mh(t,t.name),gh(t,t.name))}}}function vh(t){return function(t){if(215!==t.parent.parent.kind&&216!==t.parent.parent.kind)if(e.isInAmbientContext(t)){if(t.initializer){if(!e.isConst(t)||t.type){var n=1;return Tm(t,t.initializer.pos-n,n,e.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)}if(!fm(t.initializer))return km(t.initializer,e.Diagnostics.A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal)}if(t.initializer&&(!e.isConst(t)||!fm(t.initializer))){n=1;return Tm(t,t.initializer.pos-n,n,e.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)}}else if(!t.initializer){if(e.isBindingPattern(t.name)&&!e.isBindingPattern(t.parent))return km(t,e.Diagnostics.A_destructuring_declaration_must_have_an_initializer);if(e.isConst(t))return km(t,e.Diagnostics.const_declarations_must_be_initialized)}x.module===e.ModuleKind.ES2015||x.module===e.ModuleKind.ESNext||x.module===e.ModuleKind.System||x.noEmit||e.isInAmbientContext(t.parent.parent)||!e.hasModifier(t.parent.parent,1)||mm(t.name);var i=e.isLet(t)||e.isConst(t);i&&gm(t.name)}(t),bh(t)}function Th(t){return function(t){if(t.dotDotDotToken){var n=t.parent.elements;if(t!==e.lastOrUndefined(n))return km(t,e.Diagnostics.A_rest_element_must_be_last_in_a_destructuring_pattern);if(175===t.name.kind||174===t.name.kind)return km(t.name,e.Diagnostics.A_rest_element_cannot_contain_a_binding_pattern);if(t.initializer)Tm(t,t.initializer.pos-1,1,e.Diagnostics.A_rest_element_cannot_have_an_initializer)}}(t),bh(t)}function kh(t){Xf(t)||Zf(t)||_m(t.declarationList)||function(t){if(!ym(t.parent)){if(e.isLet(t.declarationList))return km(t,e.Diagnostics.let_declarations_can_only_be_declared_inside_a_block);if(e.isConst(t.declarationList))km(t,e.Diagnostics.const_declarations_can_only_be_declared_inside_a_block)}}(t),e.forEach(t.declarationList.declarations,rf)}function xh(t){um(t);var n=Uu(t.expression);if(227===t.initializer.kind){var i=t.initializer.declarations[0];i&&e.isBindingPattern(i.name)&&tn(i.name,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern),Eh(t)}else{var r=t.initializer,s=xp(r);177===r.kind||178===r.kind?tn(r,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern):Ia(function(e){var t=Vo(e);return t!==ae?t:ee}(n),s)?Qd(r,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access):tn(r,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any)}tp(n,17317888)||tn(t.expression,e.Diagnostics.The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter),rf(t.statement),t.locals&&th(t)}function Eh(e){var t=e.initializer;t.declarations.length>=1&&vh(t.declarations[0])}function Sh(e,t){return Ch(Uu(e),e,!0,void 0!==t)}function Ch(e,t,n,i){return Fi(e)?e:wh(e,t,n,i,!0)||W}function wh(t,n,i,r,s){var o=E>=2,a=!o&&x.downlevelIteration;if(o||a||r){var l=Ih(t,o?n:void 0,r,!0,s);if(l||o)return l}var c=t,u=!1,d=!1;if(i){if(65536&c.flags){var p=t.types,h=e.filter(p,function(e){return!(262178&e.flags)});h!==p&&(c=Po(h,!0))}else 262178&c.flags&&(c=ae);if((d=c!==t)&&(E<1&&n&&(tn(n,e.Diagnostics.Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher),u=!0),8192&c.flags))return ee}if(!rl(c)){if(n&&!u)tn(n,!i||d?a?e.Diagnostics.Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:e.Diagnostics.Type_0_is_not_an_array_type:a?e.Diagnostics.Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:e.Diagnostics.Type_0_is_not_an_array_type_or_a_string_type,vi(c));return d?ee:void 0}var f=vs(c,1);return d&&f?262178&f.flags?ee:Po([f,ee],!0):f}function Ih(t,n,i,r,s){if(!Fi(t))return gc(t,function(t){var o=t;if(i){if(o.iteratedTypeOfAsyncIterable)return o.iteratedTypeOfAsyncIterable;if(ir(t,po(!1))||ir(t,fo(!1)))return o.iteratedTypeOfAsyncIterable=t.typeArguments[0]}if(r){if(o.iteratedTypeOfIterable)return o.iteratedTypeOfIterable;if(ir(t,mo(!1))||ir(t,_o(!1)))return o.iteratedTypeOfIterable=t.typeArguments[0]}var a=i&&Mi(t,e.getPropertyNameForKnownSymbolName("asyncIterator")),l=a||r&&Mi(t,e.getPropertyNameForKnownSymbolName("iterator"));if(Fi(l))return;var c=l&&gs(l,0);if(!e.some(c))return void(n&&(tn(n,i?e.Diagnostics.Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator:e.Diagnostics.Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator),n=void 0));var u=Ah(Po(e.map(c,Ds),!0),n,!!a);s&&n&&u&&Da(t,a?function(e){return vo(po(!0),[e])}(u):xo(u),n);return a?o.iteratedTypeOfAsyncIterable=u:o.iteratedTypeOfIterable=u})}function Ah(t,n,i){if(!Fi(t)){var r=t;if(i?r.iteratedTypeOfAsyncIterator:r.iteratedTypeOfIterator)return i?r.iteratedTypeOfAsyncIterator:r.iteratedTypeOfIterator;if(ir(t,(i?ho:go)(!1)))return i?r.iteratedTypeOfAsyncIterator=t.typeArguments[0]:r.iteratedTypeOfIterator=t.typeArguments[0];var s=Mi(t,"next");if(!Fi(s)){var o=s?gs(s,0):e.emptyArray;if(0!==o.length){var a=Po(e.map(o,Ds),!0);if(!(Fi(a)||i&&Fi(a=Hp(a,n,e.Diagnostics.The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property)))){var l=a&&Mi(a,"value");if(l)return i?r.iteratedTypeOfAsyncIterator=l:r.iteratedTypeOfIterator=l;n&&tn(n,i?e.Diagnostics.The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property:e.Diagnostics.The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property)}}else n&&tn(n,i?e.Diagnostics.An_async_iterator_must_have_a_next_method:e.Diagnostics.An_iterator_must_have_a_next_method)}}}function Nh(e,t){if(!Fi(e))return Ih(e,void 0,t,!t,!1)||Ah(e,void 0,t)}function Dh(t){Em(t)||function(t){var n=t;for(;n;){if(e.isFunctionLike(n))return km(t,e.Diagnostics.Jump_target_cannot_cross_function_boundary);switch(n.kind){case 222:if(t.label&&n.label.escapedText===t.label.escapedText)return!!(217===t.kind&&!e.isIterationStatement(n.statement,!0))&&km(t,e.Diagnostics.A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement);break;case 221:if(218===t.kind&&!t.label)return!1;break;default:if(e.isIterationStatement(n,!1)&&!t.label)return!1}n=n.parent}t.label?km(t,218===t.kind?e.Diagnostics.A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement:e.Diagnostics.A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement):km(t,218===t.kind?e.Diagnostics.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement:e.Diagnostics.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement)}(t)}function Oh(t){return 153===t.kind&&void 0!==e.getEffectiveSetAccessorTypeAnnotationNode(e.getDeclarationOfKind(t.symbol,154))}function Rh(t,n){var i=2==(3&e.getFunctionFlags(t))?Gp(n):n;return i&&ep(i,1025)}function Lh(t){Em(t)||void 0===t.expression&&function(t,n,i,r,s){var o=e.getSourceFileOfNode(t);if(!bm(o)){var a=e.getSpanOfTokenAtPosition(o,t.pos);Nt.add(e.createFileDiagnostic(o,e.textSpanEnd(a),0,n,i,r,s))}}(t,e.Diagnostics.Line_break_not_permitted_here),t.expression&&xp(t.expression)}function Ph(t){var n,i=$s(t.symbol,1),r=$s(t.symbol,0),s=vs(t,0),o=vs(t,1);if((s||o)&&(e.forEach(Qr(t),function(e){var n=nr(e);d(e,n,t,r,s,0),d(e,n,t,i,o,1)}),1&pn(t)&&e.isClassLike(t.symbol.valueDeclaration)))for(var a=0,l=t.symbol.valueDeclaration.members;a<l.length;a++){var c=l[a];if(!e.hasModifier(c,32)&&e.hasDynamicName(c)){var u=nr(c.symbol);d(c.symbol,u,t,r,s,0),d(c.symbol,u,t,i,o,1)}}s&&o&&(!(n=i||r)&&2&pn(t)&&(n=e.forEach(_r(t),function(e){return vs(e,0)&&vs(e,1)})?void 0:t.symbol.declarations[0]));function d(t,n,i,r,s,o){if(s){var a=t.valueDeclaration;if(1!==o||(a?fu(e.getNameOfDeclaration(a)):mu(t.escapedName))){var l;if(!a||194!==a.kind&&144!==e.getNameOfDeclaration(a).kind&&t.parent!==i.symbol){if(r)l=r;else if(2&pn(i)){l=e.forEach(_r(i),function(e){return es(e,t.escapedName)&&vs(e,o)})?void 0:i.symbol.declarations[0]}}else l=a;if(l&&!Ia(n,s))tn(l,0===o?e.Diagnostics.Property_0_of_type_1_is_not_assignable_to_string_index_type_2:e.Diagnostics.Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2,yi(t),vi(n),vi(s))}}}n&&!Ia(o,s)&&tn(n,e.Diagnostics.Numeric_index_type_0_is_not_assignable_to_string_index_type_1,vi(o),vi(s))}function Mh(e,t){switch(e.escapedText){case"any":case"number":case"boolean":case"string":case"symbol":case"void":case"object":tn(e,t,e.escapedText)}}function Fh(t){if(t)for(var n=!1,r=0;r<t.length;r++){var s=t[r];if(Ep(s),i){s.default?n=!0:n&&tn(s,e.Diagnostics.Required_type_parameters_may_not_follow_optional_type_parameters);for(var o=0;o<r;o++)t[o].symbol===s.symbol&&tn(s.name,e.Diagnostics.Duplicate_identifier_0,e.declarationNameToString(s.name))}}}function Bh(t){if(1!==t.declarations.length){var n=un(t);if(!n.typeParametersChecked){n.typeParametersChecked=!0;var i=function(t){return e.filter(t.declarations,function(e){return 229===e.kind||230===e.kind})}(t);if(i.length<=1)return;if(!function(t,n){for(var i=e.length(n),r=Cs(n),s=0,o=t;s<o.length;s++){var a=o[s],l=e.length(a.typeParameters);if(l<r||l>i)return!1;for(var c=0;c<l;c++){var u=a.typeParameters[c],d=n[c];if(u.name.escapedText!==d.symbol.escapedName)return!1;var p=u.constraint&&aa(u.constraint),h=Hs(d);if((p||h)&&(!p||!h||!Ea(p,h)))return!1;var f=u.default&&aa(u.default),m=ls(d);if(f&&m&&!Ea(f,m))return!1}}return!0}(i,Cr(t).localTypeParameters))for(var r=yi(t),s=0,o=i;s<o.length;s++){tn(o[s].name,e.Diagnostics.All_declarations_of_0_must_have_identical_type_parameters,r)}}}}function $h(t){e.forEach(t.members,rf),th(t)}function Uh(t){!function(t){var n=e.getSourceFileOfNode(t);(function(t){var n=!1,i=!1;if(!Xf(t)&&!Zf(t)&&t.heritageClauses)for(var r=0,s=t.heritageClauses;r<s.length;r++){var o=s[r];if(85===o.token){if(n)return vm(o,e.Diagnostics.extends_clause_already_seen);if(i)return vm(o,e.Diagnostics.extends_clause_must_precede_implements_clause);if(o.types.length>1)return vm(o.types[1],e.Diagnostics.Classes_can_only_extend_a_single_class);n=!0}else{if(e.Debug.assert(108===o.token),i)return vm(o,e.Diagnostics.implements_clause_already_seen);i=!0}sm(o)}})(t)||tm(t.typeParameters,n)}(t),Zp(t),t.name&&(Mh(t.name,e.Diagnostics.Class_name_cannot_be_0),uh(t,t.name),dh(t,t.name),mh(t,t.name),gh(t,t.name)),Fh(t.typeParameters),Vp(t);var n=qn(t),r=Cr(n),s=Lr(r),o=nr(n);Bh(n),function(t){var n;!function(e){e[e.Getter=1]="Getter",e[e.Setter=2]="Setter",e[e.Method=4]="Method",e[e.Property=3]="Property"}(n||(n={}));for(var i=e.createUnderscoreEscapedMap(),r=e.createUnderscoreEscapedMap(),s=0,o=t.members;s<o.length;s++){var a=o[s];if(152===a.kind)for(var l=0,c=a.parameters;l<c.length;l++){var u=c[l];e.isParameterPropertyDeclaration(u)&&!e.isBindingPattern(u.name)&&h(i,u.name,u.name.escapedText,3)}else{var d=e.hasModifier(a,32)?r:i,p=a.name&&e.getPropertyNameForPropertyNameNode(a.name);if(p)switch(a.kind){case 153:h(d,a.name,p,1);break;case 154:h(d,a.name,p,2);break;case 149:h(d,a.name,p,3);break;case 151:h(d,a.name,p,4)}}}function h(t,n,i,r){var s=t.get(i);s?4&s?4!==r&&tn(n,e.Diagnostics.Duplicate_identifier_0,e.getTextOfNode(n)):s&r?tn(n,e.Diagnostics.Duplicate_identifier_0,e.getTextOfNode(n)):t.set(i,s|r):t.set(i,r)}}(t),e.isInAmbientContext(t)||function(t){for(var n=0,i=t.members;n<i.length;n++){var r=i[n],s=r.name;if(e.hasModifier(r,32)&&s){var o=e.getPropertyNameForPropertyNameNode(s);switch(o){case"name":case"length":case"caller":case"arguments":case"prototype":tn(s,e.Diagnostics.Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1,o,wi(qn(t)))}}}}(t);var a=e.getClassExtendsHeritageClauseElement(t);if(a){E<2&&Jf(a.parent,1);var l=_r(r);if(l.length&&i){var c=l[0],u=gr(r),d=us(u);if(function(t,n){var i=gs(t,1);if(i.length){var r=i[0].declaration;if(r&&e.hasModifier(r,8))hf(n,Hh(t.symbol))||tn(n,e.Diagnostics.Cannot_extend_a_class_0_Class_constructor_is_marked_as_private,Ln(t.symbol))}}(d,a),rf(a.expression),e.some(a.typeArguments)){e.forEach(a.typeArguments,rf);for(var p=0,h=fr(d,a.typeArguments,a);p<h.length;p++){if(!Pp(h[p].typeParameters,a.typeArguments))break}}if(Da(s,Lr(c,r.thisType),t.name||t,e.Diagnostics.Class_0_incorrectly_extends_base_class_1),Da(o,xa(d),t.name||t,e.Diagnostics.Class_static_side_0_incorrectly_extends_base_class_static_side_1),540672&u.flags&&!dr(o)&&tn(t.name||t,e.Diagnostics.A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any),!(d.symbol&&32&d.symbol.flags||540672&u.flags)){var f=mr(d,a.typeArguments,a);e.forEach(f,function(e){return Ds(e)!==c})&&tn(a.expression,e.Diagnostics.Base_constructors_must_all_have_the_same_return_type)}!function(t,n){for(var i=ts(n),r=0,s=i;r<s.length;r++){var o=s[r],a=Vh(o);if(!(4194304&a.flags)){var l=Vh(es(t,a.escapedName)),c=e.getDeclarationModifierFlagsFromSymbol(a);if(e.Debug.assert(!!l,"derived should point to something, even if it is the base class' declaration."),l)if(l===a){var u=Hh(t.symbol);!(128&c)||u&&e.hasModifier(u,128)||(199===u.kind?tn(u,e.Diagnostics.Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1,yi(o),vi(n)):tn(u,e.Diagnostics.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2,vi(t),yi(o),vi(n)))}else{var d=e.getDeclarationModifierFlagsFromSymbol(l);if(8&c||8&d)continue;if(Bu(a)&&Bu(l)||98308&a.flags&&98308&l.flags)continue;var p=void 0;p=Bu(a)?98304&l.flags?e.Diagnostics.Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_accessor:e.Diagnostics.Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_property:4&a.flags?e.Diagnostics.Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_function:e.Diagnostics.Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_function,tn(e.getNameOfDeclaration(l.valueDeclaration)||l.valueDeclaration,p,vi(n),yi(a),vi(t))}}}}(r,c)}}var m=e.getClassImplementsHeritageClauseElements(t);if(m)for(var g=0,_=m;g<_.length;g++){var y=_[g];if(e.isEntityNameExpression(y.expression)||tn(y.expression,e.Diagnostics.A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments),Mp(y),i){var b=aa(y);b!==J&&(yr(b)?Da(s,Lr(b,r.thisType),t.name||t,e.Diagnostics.Class_0_incorrectly_implements_interface_1):tn(y,e.Diagnostics.A_class_may_only_implement_another_class_or_interface))}}i&&(Ph(r),Np(t))}function Vh(t){return 1&e.getCheckFlags(t)?t.target:t}function Hh(t){return e.forEach(t.declarations,function(t){return e.isClassLike(t)?t:void 0})}function Gh(t){if(Xf(t)||Zf(t)||function(t){var n=!1;if(t.heritageClauses)for(var i=0,r=t.heritageClauses;i<r.length;i++){var s=r[i];if(85!==s.token)return e.Debug.assert(108===s.token),vm(s,e.Diagnostics.Interface_declaration_cannot_have_implements_clause);if(n)return vm(s,e.Diagnostics.extends_clause_already_seen);n=!0,sm(s)}}(t),Fh(t.typeParameters),i){Mh(t.name,e.Diagnostics.Interface_name_cannot_be_0),Vp(t);var n=qn(t);if(Bh(n),t===e.getDeclarationOfKind(n,230)){var r=Cr(n),s=Lr(r);if(function(t,n){var i=_r(t);if(i.length<2)return!0;var r=e.createUnderscoreEscapedMap();e.forEach(Rr(t).declaredProperties,function(e){r.set(e.escapedName,{prop:e,containingType:t})});for(var s=!0,o=0,a=i;o<a.length;o++)for(var l=a[o],c=0,u=ts(Lr(l,t.thisType));c<u.length;c++){var d=u[c],p=r.get(d.escapedName);if(p){if(p.containingType!==t&&!Za(p.prop,d)){s=!1;var h=vi(p.containingType),f=vi(l),m=e.chainDiagnosticMessages(void 0,e.Diagnostics.Named_property_0_of_types_1_and_2_are_not_identical,yi(d),h,f);m=e.chainDiagnosticMessages(m,e.Diagnostics.Interface_0_cannot_simultaneously_extend_types_1_and_2,vi(t),h,f),Nt.add(e.createDiagnosticForNodeFromMessageChain(n,m))}}else r.set(d.escapedName,{prop:d,containingType:l})}return s}(r,t.name)){for(var o=0,a=_r(r);o<a.length;o++){Da(s,Lr(a[o],r.thisType),t.name,e.Diagnostics.Interface_0_incorrectly_extends_interface_1)}Ph(r)}}Ap(t)}e.forEach(e.getInterfaceBaseTypeNodes(t),function(t){e.isEntityNameExpression(t.expression)||tn(t.expression,e.Diagnostics.An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments),Mp(t)}),e.forEach(t.members,rf),i&&(Np(t),th(t))}function jh(e){var t=dn(e);if(!(16384&t.flags)){t.flags|=16384;for(var n=0,i=0,r=e.members;i<r.length;i++){var s=r[i],o=Kh(s,n);dn(s).enumMemberValue=o,n="number"==typeof o?o+1:void 0}}}function Kh(t,n){if($i(t.name))tn(t.name,e.Diagnostics.Computed_property_names_are_not_allowed_in_enums);else{var i=e.getTextOfPropertyName(t.name);mu(i)&&!function(e){return"Infinity"===e||"-Infinity"===e||"NaN"===e}(i)&&tn(t.name,e.Diagnostics.An_enum_member_cannot_have_a_numeric_name)}return t.initializer?function(t){var n=Tr(qn(t.parent)),i=e.isConst(t.parent),r=t.initializer,s=1!==n||vr(t)?o(r):void 0;if(void 0!==s)i&&"number"==typeof s&&!isFinite(s)&&tn(r,isNaN(s)?e.Diagnostics.const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN:e.Diagnostics.const_enum_member_initializer_was_evaluated_to_a_non_finite_value);else{if(1===n)return tn(r,e.Diagnostics.Computed_values_are_not_permitted_in_an_enum_with_string_valued_members),0;i?tn(r,e.Diagnostics.In_const_enum_declarations_member_initializer_must_be_constant_expression):e.isInAmbientContext(t.parent)?tn(r,e.Diagnostics.In_ambient_enum_declarations_member_initializer_must_be_constant_expression):Da(xp(r),Cr(qn(t.parent)),r,void 0)}return s;function o(n){switch(n.kind){case 192:var i=o(n.operand);if("number"==typeof i)switch(n.operator){case 37:return i;case 38:return-i;case 52:return~i}break;case 194:var r=o(n.left),s=o(n.right);if("number"==typeof r&&"number"==typeof s)switch(n.operatorToken.kind){case 49:return r|s;case 48:return r&s;case 46:return r>>s;case 47:return r>>>s;case 45:return r<<s;case 50:return r^s;case 39:return r*s;case 41:return r/s;case 37:return r+s;case 38:return r-s;case 42:return r%s}break;case 9:return n.text;case 8:return Sm(n),+n.text;case 185:return o(n.expression);case 71:return e.nodeIsMissing(n)?0:a(n,qn(t.parent),n.escapedText);case 180:case 179:var l=n;if(zh(l)){var c=kp(l.expression);if(c.symbol&&384&c.symbol.flags){var u=void 0;if(179===l.kind)u=l.name.escapedText;else{var d=l.argumentExpression;e.Debug.assert(e.isLiteralExpression(d)),u=e.escapeLeadingUnderscores(d.text)}return a(n,c.symbol,u)}}}}function a(n,i,r){var s=i.exports.get(r);if(s){var o=s.valueDeclaration;if(o!==t)return mn(o,t)?dn(o).enumMemberValue:(tn(n,e.Diagnostics.A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums),0)}}}(t):!e.isInAmbientContext(t.parent)||e.isConst(t.parent)?void 0!==n?n:void tn(t.name,e.Diagnostics.Enum_member_must_have_initializer):void 0}function zh(e){return 71===e.kind||179===e.kind&&zh(e.expression)||180===e.kind&&zh(e.expression)&&9===e.argumentExpression.kind}function Wh(t){if(i){var n=e.isGlobalScopeAugmentation(t),r=e.isInAmbientContext(t);n&&!r&&tn(t.name,e.Diagnostics.Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambient_context);var s=e.isAmbientModule(t);if(Qh(t,s?e.Diagnostics.An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file:e.Diagnostics.A_namespace_declaration_is_only_allowed_in_a_namespace_or_module))return;Xf(t)||Zf(t)||r||9!==t.name.kind||km(t.name,e.Diagnostics.Only_ambient_modules_can_use_quoted_names),e.isIdentifier(t.name)&&(uh(t,t.name),mh(t,t.name),gh(t,t.name)),Vp(t);var o=qn(t);if(512&o.flags&&o.declarations.length>1&&!r&&l(t,x.preserveConstEnums||x.isolatedModules)){var a=function(t){for(var n=0,i=t.declarations;n<i.length;n++){var r=i[n];if((229===r.kind||228===r.kind&&e.nodeIsPresent(r.body))&&!e.isInAmbientContext(r))return r}}(o);a&&(e.getSourceFileOfNode(t)!==e.getSourceFileOfNode(a)?tn(t.name,e.Diagnostics.A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merged):t.pos<a.pos&&tn(t.name,e.Diagnostics.A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged));var c=e.getDeclarationOfKind(o,229);c&&(p=t,h=c,f=e.getEnclosingBlockScopeContainer(p),m=e.getEnclosingBlockScopeContainer(h),hn(f)?hn(m):!hn(m)&&f===m)&&(dn(t).flags|=32768)}if(s)if(e.isExternalModuleAugmentation(t)){if((n||33554432&qn(t).flags)&&t.body)for(var u=0,d=t.body.statements;u<d.length;u++){qh(d[u],n)}}else hn(t.parent)?n?tn(t.name,e.Diagnostics.Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations):e.isExternalModuleNameRelative(e.getTextOfIdentifierOrLiteral(t.name))&&tn(t.name,e.Diagnostics.Ambient_module_declaration_cannot_specify_relative_module_name):tn(t.name,n?e.Diagnostics.Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations:e.Diagnostics.Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces)}var p,h,f,m;t.body&&(rf(t.body),e.isGlobalScopeAugmentation(t)||th(t))}function qh(t,n){switch(t.kind){case 208:for(var i=0,r=t.declarationList.declarations;i<r.length;i++){qh(r[i],n)}break;case 243:case 244:vm(t,e.Diagnostics.Exports_and_export_assignments_are_not_permitted_in_module_augmentations);break;case 237:case 238:vm(t,e.Diagnostics.Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_module);break;case 176:case 226:var s=t.name;if(e.isBindingPattern(s)){for(var o=0,a=s.elements;o<a.length;o++){qh(a[o],n)}break}case 229:case 232:case 228:case 230:case 233:case 231:if(n)return;var l=qn(t);if(l){var c=!(33554432&l.flags);c||(c=e.isExternalModuleAugmentation(l.parent.declarations[0]))}}}function Jh(e){switch(e.kind){case 71:return e;case 143:do{e=e.left}while(71!==e.kind);return e;case 179:do{e=e.expression}while(71!==e.kind);return e}}function Yh(t){var n=e.getExternalModuleName(t);if(!e.nodeIsMissing(n)&&9!==n.kind)return tn(n,e.Diagnostics.String_literal_expected),!1;var i=234===t.parent.kind&&e.isAmbientModule(t.parent.parent);return 265===t.parent.kind||i?!(i&&e.isExternalModuleNameRelative(e.getTextOfIdentifierOrLiteral(n))&&!Si(t))||(tn(t,e.Diagnostics.Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relative_module_name),!1):(tn(n,244===t.kind?e.Diagnostics.Export_declarations_are_not_permitted_in_a_namespace:e.Diagnostics.Import_declarations_in_a_namespace_cannot_reference_a_module),!1)}function Xh(t){var n=qn(t),i=Nn(n);if(i!==K){var r=(1156031&n.flags?107455:0)|(793064&n.flags?793064:0)|(1920&n.flags?1920:0);if(i.flags&r)tn(t,246===t.kind?e.Diagnostics.Export_declaration_conflicts_with_exported_declaration_of_0:e.Diagnostics.Import_declaration_conflicts_with_local_declaration_of_0,yi(n));!x.isolatedModules||246!==t.kind||107455&i.flags||e.isInAmbientContext(t)||tn(t,e.Diagnostics.Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided)}}function Zh(e){uh(e,e.name),mh(e,e.name),gh(e,e.name),Xh(e)}function Qh(e,t){var n=265===e.parent.kind||234===e.parent.kind||233===e.parent.kind;return n||vm(e,t),!n}function ef(t){if(Xh(t),!t.parent.parent.moduleSpecifier){var n=t.propertyName||t.name,i=gn(n,n.escapedText,2998271,void 0,void 0,!0);i&&(i===L||hn(Pi(i.declarations[0])))?tn(n,e.Diagnostics.Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module,e.idText(n)):Dn(t)}}function tf(t){var n=qn(t),i=un(n);if(!i.exportsChecked){var r=n.exports.get("export=");if(r&&function(t){return e.forEachEntry(t.exports,function(e,t){return"export="!==t})}(n)){var s=En(r)||r.valueDeclaration;Si(s)||tn(s,e.Diagnostics.An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements)}var o=Kn(n);o&&o.forEach(function(t,n){var i=t.declarations,r=t.flags;if("__export"!==n&&!(1984&r)){var s=e.countWhere(i,Qt);if(!(524288&r&&s<=2)&&s>1)for(var o=0,a=i;o<a.length;o++){var l=a[o];nf(l)&&Nt.add(e.createDiagnosticForNode(l,e.Diagnostics.Cannot_redeclare_exported_variable_0,e.unescapeLeadingUnderscores(n)))}}}),i.exportsChecked=!0}}function nf(e){return 228!==e.kind&&151!==e.kind||!!e.body}function rf(t){if(t){if(e.isInJavaScriptFile(t)&&t.jsDoc)for(var n=0,r=t.jsDoc;n<r.length;n++){var s=r[n].tags;e.forEach(s,rf)}var o=t.kind;if(d)switch(o){case 233:case 229:case 230:case 228:d.throwIfCancellationRequested()}switch(o){case 145:return Ep(t);case 146:return Sp(t);case 149:case 148:return Dp(t);case 160:case 161:case 155:case 156:case 157:return Ip(t);case 151:case 150:return function(t){hm(t)||am(t.name),eh(t),e.hasModifier(t,128)&&t.body&&tn(t,e.Diagnostics.Method_0_cannot_have_an_implementation_because_it_is_marked_abstract,e.declarationNameToString(t.name))}(t);case 152:return Op(t);case 153:case 154:return Rp(t);case 159:return Mp(t);case 158:return function(t){var n=function(e){switch(e.parent.kind){case 187:case 155:case 228:case 186:case 160:case 151:case 150:var t=e.parent;if(e===t.type)return t}}(t);if(n){var i=Is(n).typePredicate;if(i){rf(t.type);var r=t.parameterName;if(e.isThisTypePredicate(i))oa(r);else if(i.parameterIndex>=0)if(n.parameters[i.parameterIndex].dotDotDotToken)tn(r,e.Diagnostics.A_type_predicate_cannot_reference_a_rest_parameter);else{var s=e.chainDiagnosticMessages(void 0,e.Diagnostics.A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type);Da(i.type,_f(n.parameters[i.parameterIndex]),t.type,void 0,s)}else if(r){for(var o=!1,a=0,l=n.parameters;a<l.length;a++){var c=l[a].name;if(e.isBindingPattern(c)&&wp(c,r,i.parameterName)){o=!0;break}}o||tn(t.parameterName,e.Diagnostics.Cannot_find_parameter_0,i.parameterName)}}}else tn(t,e.Diagnostics.A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods)}(t);case 162:return function(e){io(e)}(t);case 163:return function(t){e.forEach(t.members,rf),i&&(Ph(Yo(t)),Np(t),Ap(t))}(t);case 164:return function(e){rf(e.elementType)}(t);case 165:return function(t){em(t.elementTypes)||0!==t.elementTypes.length||km(t,e.Diagnostics.A_tuple_type_element_list_cannot_be_empty),e.forEach(t.elementTypes,rf)}(t);case 166:case 167:return function(t){e.forEach(t.types,rf)}(t);case 168:case 170:return rf(t.type);case 277:return function(t){var n=e.getJSDocHost(t);if(e.isClassDeclaration(n)||e.isClassExpression(n)){var i=e.getAllJSDocTagsOfKind(n,277);e.Debug.assert(i.length>0),i.length>1&&tn(i[1],e.Diagnostics.Class_declarations_cannot_have_more_than_one_augments_or_extends_tag);var r=Qp(t.class.expression),s=e.getClassExtendsHeritageClauseElement(n);if(s){var o=Qp(s.expression);o&&r.escapedText!==o.escapedText&&tn(r,e.Diagnostics.JSDoc_0_1_does_not_match_the_extends_2_clause,e.idText(t.tagName),e.idText(r),e.idText(o))}}else tn(n,e.Diagnostics.JSDoc_0_is_not_attached_to_a_class,e.idText(t.tagName))}(t);case 283:return function(t){t.typeExpression||tn(t.name,e.Diagnostics.JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags)}(t);case 279:return function(t){rf(t.typeExpression),e.getParameterSymbolFromJSDoc(t)||tn(t.name,e.Diagnostics.JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name,e.idText(143===t.name.kind?t.name.right:t.name))}(t);case 273:Ip(t);case 274:case 271:case 270:case 268:case 269:return void(e.isInJavaScriptFile(t)||e.isInJSDoc(t)||km(t,e.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments));case 267:return rf(t.type);case 171:return function(e){rf(e.objectType),rf(e.indexType),Fp(qo(e),e)}(t);case 172:return function(e){rf(e.typeParameter),rf(e.type),Da(Jr(Jo(e)),ee,e.typeParameter.constraint)}(t);case 228:return function(e){i&&(eh(e),lm(e),fh(e,e.name),uh(e,e.name),dh(e,e.name),mh(e,e.name),gh(e,e.name))}(t);case 207:case 234:return lh(t);case 208:return kh(t);case 210:return function(e){Em(e),xp(e.expression)}(t);case 211:return function(t){Em(t),xp(t.expression),rf(t.thenStatement),209===t.thenStatement.kind&&tn(t.thenStatement,e.Diagnostics.The_body_of_an_if_statement_cannot_be_the_empty_statement),rf(t.elseStatement)}(t);case 212:return function(e){Em(e),rf(e.statement),xp(e.expression)}(t);case 213:return function(e){Em(e),xp(e.expression),rf(e.statement)}(t);case 214:return function(t){Em(t)||t.initializer&&227===t.initializer.kind&&_m(t.initializer),t.initializer&&(227===t.initializer.kind?e.forEach(t.initializer.declarations,vh):xp(t.initializer)),t.condition&&xp(t.condition),t.incrementor&&xp(t.incrementor),rf(t.statement),t.locals&&th(t)}(t);case 215:return xh(t);case 216:return function(t){if(um(t),216===t.kind&&(t.awaitModifier?2==(6&e.getFunctionFlags(e.getContainingFunction(t)))&&E<5&&Jf(t,16384):x.downlevelIteration&&E<2&&Jf(t,256)),227===t.initializer.kind)Eh(t);else{var n=t.initializer,i=Sh(t.expression,t.awaitModifier);if(177===n.kind||178===n.kind)op(n,i||J);else{var r=xp(n);Qd(n,e.Diagnostics.The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access),i&&Da(i,r,n,void 0)}}rf(t.statement),t.locals&&th(t)}(t);case 217:case 218:return Dh(t);case 219:return function(t){Em(t)||e.getContainingFunction(t)||vm(t,e.Diagnostics.A_return_statement_can_only_be_used_within_a_function_body);var n=e.getContainingFunction(t);if(n){var i=Ds(Is(n));if(I||t.expression||8192&i.flags){var r=t.expression?fp(t.expression):Y,s=e.getFunctionFlags(n);if(1&s)return;if(154===n.kind)t.expression&&tn(t,e.Diagnostics.Setters_cannot_return_a_value);else if(152===n.kind)t.expression&&!Da(r,i,t)&&tn(t,e.Diagnostics.Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class);else if(e.getEffectiveReturnTypeNode(n)||Oh(n))if(2&s){var o=Gp(i),a=jp(r,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member);o&&Da(a,o,t)}else Da(r,i,t)}else 152!==n.kind&&x.noImplicitReturns&&!Rh(n,i)&&tn(t,e.Diagnostics.Not_all_code_paths_return_a_value)}}(t);case 220:return function(t){Em(t)||16384&t.flags&&vm(t,e.Diagnostics.with_statements_are_not_allowed_in_an_async_function_block),xp(t.expression);var n=e.getSourceFileOfNode(t);if(!bm(n)){var i=e.getSpanOfTokenAtPosition(n,t.pos).start;Tm(n,i,t.statement.pos-i,e.Diagnostics.The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any)}}(t);case 221:return function(t){var n;Em(t);var r=!1,s=xp(t.expression),o=al(s);e.forEach(t.caseBlock.clauses,function(a){if(258===a.kind&&!r)if(void 0===n)n=a;else{var l=e.getSourceFileOfNode(t),c=e.skipTrivia(l.text,a.pos);Tm(l,c,(a.statements.length>0?a.statements[0].pos:a.end)-c,e.Diagnostics.A_default_clause_cannot_appear_more_than_once_in_a_switch_statement),r=!0}if(i&&257===a.kind){var u=a,d=xp(u.expression),p=al(d),h=s;p&&o||(d=p?ll(d):d,h=ll(s)),lp(h,d)||Oa(d,h,u.expression,void 0)}e.forEach(a.statements,rf)}),t.caseBlock.locals&&th(t.caseBlock)}(t);case 222:return function(t){Em(t)||e.findAncestor(t.parent,function(n){if(e.isFunctionLike(n))return"quit";if(222===n.kind&&n.label.escapedText===t.label.escapedText){var i=e.getSourceFileOfNode(t);return km(t.label,e.Diagnostics.Duplicate_label_0,e.getTextOfNodeFromSourceText(i.text,t.label)),!0}}),rf(t.statement)}(t);case 223:return Lh(t);case 224:return function(t){Em(t),lh(t.tryBlock);var n=t.catchClause;if(n){if(n.variableDeclaration)if(n.variableDeclaration.type)vm(n.variableDeclaration.type,e.Diagnostics.Catch_clause_variable_cannot_have_a_type_annotation);else if(n.variableDeclaration.initializer)vm(n.variableDeclaration.initializer,e.Diagnostics.Catch_clause_variable_cannot_have_an_initializer);else{var i=n.block.locals;i&&e.forEachKey(n.locals,function(t){var n=i.get(t);n&&2&n.flags&&km(n.valueDeclaration,e.Diagnostics.Cannot_redeclare_identifier_0_in_catch_clause,t)})}lh(n.block)}t.finallyBlock&&lh(t.finallyBlock)}(t);case 226:return vh(t);case 176:return Th(t);case 229:return function(t){t.name||e.hasModifier(t,512)||vm(t,e.Diagnostics.A_class_declaration_without_the_default_modifier_must_have_a_name),Uh(t),e.forEach(t.members,rf),th(t)}(t);case 230:return Gh(t);case 231:return function(t){Xf(t)||Zf(t),Mh(t.name,e.Diagnostics.Type_alias_name_cannot_be_0),Fh(t.typeParameters),rf(t.type),th(t)}(t);case 232:return function(t){if(i){Xf(t)||Zf(t),Mh(t.name,e.Diagnostics.Enum_name_cannot_be_0),uh(t,t.name),dh(t,t.name),mh(t,t.name),gh(t,t.name),Vp(t),jh(t);var n=e.isConst(t);x.isolatedModules&&n&&e.isInAmbientContext(t)&&tn(t.name,e.Diagnostics.Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided);var r=qn(t);if(t===e.getDeclarationOfKind(r,t.kind)){r.declarations.length>1&&e.forEach(r.declarations,function(t){e.isConstEnumDeclaration(t)!==n&&tn(e.getNameOfDeclaration(t),e.Diagnostics.Enum_declarations_must_all_be_const_or_non_const)});var s=!1;e.forEach(r.declarations,function(t){if(232!==t.kind)return!1;var n=t;if(!n.members.length)return!1;var i=n.members[0];i.initializer||(s?tn(i.name,e.Diagnostics.In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enum_element):s=!0)})}}}(t);case 233:return Wh(t);case 238:return function(t){if(!Qh(t,e.Diagnostics.An_import_declaration_can_only_be_used_in_a_namespace_or_module)&&(Xf(t)||Zf(t)||!e.hasModifiers(t)||vm(t,e.Diagnostics.An_import_declaration_cannot_have_modifiers),Yh(t))){var n=t.importClause;n&&(n.name&&Zh(n),n.namedBindings&&(240===n.namedBindings.kind?Zh(n.namedBindings):e.forEach(n.namedBindings.elements,Zh)))}}(t);case 237:return function(t){if(!Qh(t,e.Diagnostics.An_import_declaration_can_only_be_used_in_a_namespace_or_module)&&(Xf(t)||Zf(t),e.isInternalModuleImportEqualsDeclaration(t)||Yh(t)))if(Zh(t),e.hasModifier(t,1)&&Dn(t),e.isInternalModuleImportEqualsDeclaration(t)){var n=Nn(qn(t));if(n!==K){if(107455&n.flags){var i=Jh(t.moduleReference);1920&Pn(i,108479).flags||tn(i,e.Diagnostics.Module_0_is_hidden_by_a_local_declaration_with_the_same_name,e.declarationNameToString(i))}793064&n.flags&&Mh(t.name,e.Diagnostics.Import_name_cannot_be_0)}}else S>=e.ModuleKind.ES2015&&!e.isInAmbientContext(t)&&km(t,e.Diagnostics.Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_ns_from_mod_import_a_from_mod_import_d_from_mod_or_another_module_format_instead)}(t);case 244:return function(t){if(!Qh(t,e.Diagnostics.An_export_declaration_can_only_be_used_in_a_module)&&(Xf(t)||Zf(t)||!e.hasModifiers(t)||vm(t,e.Diagnostics.An_export_declaration_cannot_have_modifiers),!t.moduleSpecifier||Yh(t)))if(t.exportClause){e.forEach(t.exportClause.elements,ef);var n=234===t.parent.kind&&e.isAmbientModule(t.parent.parent),i=!n&&234===t.parent.kind&&!t.moduleSpecifier&&e.isInAmbientContext(t);265===t.parent.kind||n||i||tn(t,e.Diagnostics.Export_declarations_are_not_permitted_in_a_namespace)}else{var r=Mn(t,t.moduleSpecifier);r&&Vn(r)&&tn(t.moduleSpecifier,e.Diagnostics.Module_0_uses_export_and_cannot_be_used_with_export_Asterisk,yi(r)),S!==e.ModuleKind.System&&S!==e.ModuleKind.ES2015&&S!==e.ModuleKind.ESNext&&Jf(t,32768)}}(t);case 243:return function(t){if(!Qh(t,e.Diagnostics.An_export_assignment_can_only_be_used_in_a_module)){var n=265===t.parent.kind?t.parent:t.parent.parent;233!==n.kind||e.isAmbientModule(n)?(Xf(t)||Zf(t)||!e.hasModifiers(t)||vm(t,e.Diagnostics.An_export_assignment_cannot_have_modifiers),71===t.expression.kind?Dn(t):fp(t.expression),tf(n),e.isInAmbientContext(t)&&!e.isEntityNameExpression(t.expression)&&km(t.expression,e.Diagnostics.The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context),t.isExportEquals&&!e.isInAmbientContext(t)&&(S>=e.ModuleKind.ES2015?km(t,e.Diagnostics.Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or_another_module_format_instead):S===e.ModuleKind.System&&km(t,e.Diagnostics.Export_assignment_is_not_supported_when_module_flag_is_system))):t.isExportEquals?tn(t,e.Diagnostics.An_export_assignment_cannot_be_used_in_a_namespace):tn(t,e.Diagnostics.A_default_export_can_only_be_used_in_an_ECMAScript_style_module)}}(t);case 209:case 225:return void Em(t);case 247:return function(e){Zp(e)}(t)}}}function sf(e){Ye&&Ye.push(e)}function of(t){e.performance.mark("beforeCheck"),function(t){var n=dn(t);if(!(1&n.flags)){if(x.skipLibCheck&&t.isDeclarationFile||x.skipDefaultLibCheck&&t.hasNoDefaultLib)return;!function(t){e.isInAmbientContext(t)&&function(t){for(var n=0,i=t.statements;n<i.length;n++){var r=i[n];if((e.isDeclaration(r)||208===r.kind)&&xm(r))return!0}}(t)}(t),e.clear(wt),e.clear(It),Ye=[],Xe=i&&C?[]:void 0,ut=!1,e.forEach(t.statements,rf),function(){for(var e=0,t=Ye;e<t.length;e++){var n=t[e];switch(n.kind){case 186:case 187:case 151:case 150:qd(n);break;case 153:case 154:Rp(n);break;case 199:$h(n)}}}(),e.isExternalModule(t)&&th(t),t.isDeclarationFile||function(){if(Xe)for(var e=0,t=Xe;e<t.length;e++){var n=t[e];switch(n.kind){case 265:case 233:ah(n);break;case 229:case 199:sh(n),oh(n);break;case 230:case 150:case 155:case 156:case 157:case 160:case 161:case 231:oh(n);break;case 207:case 235:case 214:case 215:case 216:nh(n);break;case 152:case 186:case 228:case 187:case 151:case 153:case 154:n.body&&nh(n),oh(n)}}}(),Ye=void 0,Xe=void 0,e.isExternalOrCommonJsModule(t)&&tf(t),wt.length&&(e.forEach(wt,ph),e.clear(wt)),It.length&&(e.forEach(It,hh),e.clear(It)),n.flags|=1}}(t),e.performance.mark("afterCheck"),e.performance.measure("Check","beforeCheck","afterCheck")}function af(t,i){try{return d=i,function(t){if(lf(),t){var i=Nt.getGlobalDiagnostics(),r=i.length;of(t);var s=Nt.getDiagnostics(t.fileName),o=Nt.getGlobalDiagnostics();if(o!==i){var a=e.relativeComplement(i,o,e.compareDiagnostics);return e.concatenate(a,s)}return 0===r&&o.length>0?e.concatenate(o,s):s}return e.forEach(n.getSourceFiles(),of),Nt.getDiagnostics()}(t)}finally{d=void 0}}function lf(){if(!i)throw new Error("Trying to get diagnostics from a type checker that does not produce them.")}function cf(e){if(e)for(;e.parent;){if(220===e.parent.kind&&e.parent.statement===e)return!0;e=e.parent}return!1}function uf(e){switch(e.kind){case 145:case 229:case 230:case 231:case 232:return!0}}function df(e){for(var t=e;t.parent&&143===t.parent.kind;)t=t.parent;return t.parent&&159===t.parent.kind}function pf(t,n){for(var i;(t=e.getContainingClass(t))&&!(i=n(t)););return i}function hf(e,t){return!!pf(e,function(e){return e===t})}function ff(e){return void 0!==function(e){for(;143===e.parent.kind;)e=e.parent;return 237===e.parent.kind?e.parent.moduleReference===e&&e.parent:243===e.parent.kind?e.parent.expression===e&&e.parent:void 0}(e)}function mf(t){if(e.isDeclarationName(t))return qn(t.parent);if(e.isInJavaScriptFile(t)&&179===t.parent.kind&&t.parent===t.parent.parent.left){var n=function(t){switch(e.getSpecialPropertyAssignmentKind(t.parent.parent)){case 1:case 3:return qn(t.parent);case 4:case 2:case 5:return qn(t.parent.parent)}}(t);if(n)return n}if(243===t.parent.kind&&e.isEntityNameExpression(t))return Pn(t,2998271);if(179!==t.kind&&ff(t)){var i=e.getAncestor(t,237);return e.Debug.assert(void 0!==i),Rn(t,!0)}if(e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent),function(e){for(var t=e;t.parent&&179===t.parent.kind;)t=t.parent;return t.parent&&201===t.parent.kind}(t)){var r=0;201===t.parent.kind?(r=793064,e.isExpressionWithTypeArgumentsInClassExtendsClause(t.parent)&&(r|=107455)):r=1920;var s=Pn(t,r|=2097152);if(s)return s}if(279===t.parent.kind)return e.getParameterSymbolFromJSDoc(t.parent);if(145===t.parent.kind&&282===t.parent.parent.kind){e.Debug.assert(!e.isInJavaScriptFile(t));var o=e.getTypeParameterFromJsDoc(t.parent);return o&&o.symbol}if(e.isPartOfExpression(t)){if(e.nodeIsMissing(t))return;if(71===t.kind)return e.isJSXTagName(t)&&Tu(t)?Eu(t.parent):Pn(t,107455,!1,!0);if(179===t.kind||143===t.kind){var a=dn(t);return a.resolvedSymbol||(179===t.kind?Hu(t):Gu(t)),a.resolvedSymbol}}else{if(df(t))return Pn(t,r=159===t.parent.kind?793064:1920,!1,!0);if(253===t.parent.kind)return fs(Ou((l=t.parent).parent.parent),l.name.escapedText)||K}var l;return 158===t.parent.kind?Pn(t,1):void 0}function gf(t){if(265===t.kind)return e.isExternalModule(t)?Wn(t.symbol):void 0;if(!cf(t)){if(c(t))return qn(t.parent);if(e.isLiteralComputedPropertyDeclarationName(t))return qn(t.parent.parent);if(71===t.kind){if(ff(t))return mf(t);if(176===t.parent.kind&&174===t.parent.parent.kind&&t===t.parent.propertyName){var n=_f(t.parent.parent),i=n&&fs(n,t.escapedText);if(i)return i}}switch(t.kind){case 71:case 179:case 143:return mf(t);case 99:var r=e.getThisContainer(t,!1);if(e.isFunctionLike(r)){var s=Is(r);if(s.thisParameter)return s.thisParameter}if(e.isInExpressionContext(t))return xp(t).symbol;case 169:return oa(t).symbol;case 97:return xp(t).symbol;case 123:var o=t.parent;return o&&152===o.kind?o.parent.symbol:void 0;case 9:if(e.isExternalModuleImportEqualsDeclaration(t.parent.parent)&&e.getExternalModuleImportEqualsDeclarationExpression(t.parent.parent)===t||(238===t.parent.kind||244===t.parent.kind)&&t.parent.moduleSpecifier===t||e.isInJavaScriptFile(t)&&e.isRequireCall(t.parent,!1)||e.isImportCall(t.parent))return Mn(t,t);case 8:var a=e.isElementAccessExpression(t.parent)?t.parent.argumentExpression===t?kp(t.parent.expression):void 0:e.isLiteralTypeNode(t.parent)&&e.isIndexedAccessTypeNode(t.parent.parent)?aa(t.parent.parent.objectType):void 0;return a&&fs(a,e.escapeLeadingUnderscores(t.text));case 79:return qn(t.parent);default:return}}}function _f(t){if(cf(t))return J;if(e.isPartOfTypeNode(t)){var n=aa(t);if(n&&e.isExpressionWithTypeArgumentsInClassImplementsClause(t))n=Lr(n,(i=_f(e.getContainingClass(t))).thisType);return n}if(e.isPartOfExpression(t))return bf(t);if(e.isExpressionWithTypeArgumentsInClassExtendsClause(t)){var i,r=_r(i=Cr(qn(e.getContainingClass(t))))[0];return r&&Lr(r,i.thisType)}if(uf(t))return Cr(s=qn(t));if(function(e){return 71===e.kind&&uf(e.parent)&&e.parent.name===e}(t))return(s=gf(t))&&Cr(s);if(e.isDeclaration(t))return nr(s=qn(t));if(c(t))return(s=gf(t))&&nr(s);if(e.isBindingPattern(t))return Ki(t.parent,!0);if(ff(t)){var s,o=(s=gf(t))&&Cr(s);return o!==J?o:nr(s)}return J}function yf(t){if(e.Debug.assert(178===t.kind||177===t.kind),216===t.parent.kind)return op(t,Sh(t.parent.expression,t.parent.awaitModifier)||J);if(194===t.parent.kind)return op(t,kp(t.parent.right)||J);if(261===t.parent.kind)return rp(yf(t.parent.parent)||J,t.parent);e.Debug.assert(177===t.parent.kind);var n=yf(t.parent),i=Ch(n||J,t.parent,!1,!1)||J;return sp(t.parent,n,e.indexOf(t.parent.elements,t),i||J)}function bf(t){return e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent),ra(kp(t))}function vf(t){if(!e.isGeneratedIdentifier(t)&&(t=e.getParseTreeNode(t,e.isIdentifier)))return!(179===t.parent.kind&&t.parent.name===t)&&jf(t)===F;return!1}function Tf(t){var n=Mn(t.parent,t);if(!n||e.isShorthandAmbientModuleSymbol(n))return!0;var i=Vn(n),r=un(n=$n(n));return void 0===r.exportsSomeValue&&(r.exportsSomeValue=i?!!(107455&n.flags):e.forEachEntry(Kn(n),function(e){return(e=An(e))&&!!(107455&e.flags)})),r.exportsSomeValue}function kf(t,n){if(t=e.getParseTreeNode(t,e.isIdentifier)){var i=jf(t,function(t){var n=t.parent;return n&&e.isModuleOrEnumDeclaration(n)&&t===n.name}(t));if(i){if(1048576&i.flags){var r=Wn(i.exportSymbol);if(!n&&944&r.flags)return;i=r}var s=Jn(i);if(s){if(512&s.flags&&265===s.valueDeclaration.kind){var o=s.valueDeclaration;return o!==e.getSourceFileOfNode(t)?void 0:o}return e.findAncestor(t.parent,function(t){return e.isModuleOrEnumDeclaration(t)&&qn(t)===s})}}}}function xf(t){if(t=e.getParseTreeNode(t,e.isIdentifier)){var n=jf(t);if(In(n,107455))return En(n)}}function Ef(t){if(418&t.flags){var n=un(t);if(void 0===n.isDeclarationWithCollidingName){var i=e.getEnclosingBlockScopeContainer(t.valueDeclaration);if(e.isStatementWithLocals(i)){var r=dn(t.valueDeclaration);if(gn(i.parent,t.escapedName,107455,void 0,void 0,!1))n.isDeclarationWithCollidingName=!0;else if(131072&r.flags){var s=262144&r.flags,o=e.isIterationStatement(i,!1),a=207===i.kind&&e.isIterationStatement(i.parent,!1);n.isDeclarationWithCollidingName=!(e.isBlockScopedContainerTopLevel(i)||s&&(o||a))}else n.isDeclarationWithCollidingName=!1}}return n.isDeclarationWithCollidingName}return!1}function Sf(t){if(!e.isGeneratedIdentifier(t)&&(t=e.getParseTreeNode(t,e.isIdentifier))){var n=jf(t);if(n&&Ef(n))return n.valueDeclaration}}function Cf(t){if(t=e.getParseTreeNode(t,e.isDeclaration)){var n=qn(t);if(n)return Ef(n)}return!1}function wf(t){switch(t.kind){case 237:case 239:case 240:case 242:case 246:return Af(qn(t)||K);case 244:var n=t.exportClause;return n&&e.forEach(n.elements,wf);case 243:return!t.expression||71!==t.expression.kind||Af(qn(t)||K)}return!1}function If(t){return!(void 0===(t=e.getParseTreeNode(t,e.isImportEqualsDeclaration))||265!==t.parent.kind||!e.isInternalModuleImportEqualsDeclaration(t))&&(Af(qn(t))&&t.moduleReference&&!e.nodeIsMissing(t.moduleReference))}function Af(e){var t=Nn(e);return t===K||107455&t.flags&&(x.preserveConstEnums||!Nf(t))}function Nf(e){return ip(e)||e.constEnumOnlyModule}function Df(t,n){if(e.isAliasSymbolDeclaration(t)){var i=qn(t);if(i&&un(i).referenced)return!0}return!!n&&e.forEachChild(t,function(e){return Df(e,n)})}function Of(t){if(e.nodeIsPresent(t.body)){var n=As(qn(t));return n.length>1||1===n.length&&n[0].declaration!==t}return!1}function Rf(t){return I&&!Ss(t)&&t.initializer&&!e.hasModifier(t,92)}function Lf(t){return I&&Ss(t)&&!t.initializer&&e.hasModifier(t,92)}function Pf(e){return dn(e).flags}function Mf(e){return jh(e.parent),dn(e).enumMemberValue}function Ff(e){switch(e.kind){case 264:case 179:case 180:return!0}return!1}function Bf(t){if(264===t.kind)return Mf(t);var n=dn(t).resolvedSymbol;return n&&8&n.flags&&e.isConstEnumDeclaration(n.valueDeclaration.parent)?Mf(n.valueDeclaration):void 0}function $f(t,n){if(!(t=e.getParseTreeNode(t,e.isEntityName)))return e.TypeReferenceSerializationKind.Unknown;if(n&&!(n=e.getParseTreeNode(n)))return e.TypeReferenceSerializationKind.Unknown;var i=Pn(t,107455,!0,!1,n),r=Pn(t,793064,!0,!1,n);if(i&&i===r){var s=uo(!1);if(s&&i===s)return e.TypeReferenceSerializationKind.Promise;var o=nr(i);if(o&&pr(o))return e.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue}if(!r)return e.TypeReferenceSerializationKind.ObjectType;var a=Cr(r);return a===J?e.TypeReferenceSerializationKind.Unknown:1&a.flags?e.TypeReferenceSerializationKind.ObjectType:tp(a,15360)?e.TypeReferenceSerializationKind.VoidNullableOrNeverType:tp(a,136)?e.TypeReferenceSerializationKind.BooleanType:tp(a,84)?e.TypeReferenceSerializationKind.NumberLikeType:tp(a,262178)?e.TypeReferenceSerializationKind.StringLikeType:ul(a)?e.TypeReferenceSerializationKind.ArrayLikeType:tp(a,512)?e.TypeReferenceSerializationKind.ESSymbolType:function(e){return 32768&e.flags&&gs(e,0).length>0}(a)?e.TypeReferenceSerializationKind.TypeWithCallSignature:il(a)?e.TypeReferenceSerializationKind.ArrayLikeType:e.TypeReferenceSerializationKind.ObjectType}function Uf(e,t,n,i){var r=qn(e),s=!r||133120&r.flags?J:cl(nr(r));8192&n&&(s=gl(s,2048)),Ii().buildTypeDisplay(s,i,t,n)}function Vf(e,t,n,i){var r=Is(e);Ii().buildTypeDisplay(Ds(r),i,t,n)}function Hf(e,t,n,i){var r=xl(bf(e));Ii().buildTypeDisplay(r,i,t,n)}function Gf(t){return ot.has(e.escapeLeadingUnderscores(t))}function jf(t,n){var i=dn(t).resolvedSymbol;if(i)return i;var r=t;if(n){var s=t.parent;e.isDeclaration(s)&&t===s.name&&(r=Pi(s))}return gn(r,t.escapedText,3253183,void 0,void 0,!0)}function Kf(t){if(!e.isGeneratedIdentifier(t)&&(t=e.getParseTreeNode(t,e.isIdentifier))){var n=jf(t);if(n)return Yn(n).valueDeclaration}}function zf(t){if(e.isConst(t)){var n=nr(qn(t));return!!(96&n.flags&&1048576&n.flags)}return!1}function Wf(e,t){var n=nr(qn(e));t.writeStringLiteral(Ci(n))}function qf(t){var n=e.getExternalModuleName(t),i=Fn(n,n,void 0);if(i)return e.getDeclarationOfKind(i,265)}function Jf(t,n){if((p&n)!==n&&x.importHelpers){var i=e.getSourceFileOfNode(t);if(e.isEffectiveExternalModule(i,x)&&!e.isInAmbientContext(t)){var r=function(t,n){h||(h=Bn(t,e.externalHelpersModuleNameText,e.Diagnostics.This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found,n)||K);return h}(i,t);if(r!==K)for(var s=n&~p,o=1;o<=65536;o<<=1)if(s&o){var a=Yf(o);fn(r.exports,e.escapeLeadingUnderscores(a),107455)||tn(t,e.Diagnostics.This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1,e.externalHelpersModuleNameText,a)}p|=n}}}function Yf(t){switch(t){case 1:return"__extends";case 2:return"__assign";case 4:return"__rest";case 8:return"__decorate";case 16:return"__metadata";case 32:return"__param";case 64:return"__awaiter";case 128:return"__generator";case 256:return"__values";case 512:return"__read";case 1024:return"__spread";case 2048:return"__await";case 4096:return"__asyncGenerator";case 8192:return"__asyncDelegator";case 16384:return"__asyncValues";case 32768:return"__exportStar";case 65536:return"__makeTemplateObject";default:e.Debug.fail("Unrecognized helper")}}function Xf(t){if(!t.decorators)return!1;if(!e.nodeCanBeDecorated(t))return 151!==t.kind||e.nodeIsPresent(t.body)?vm(t,e.Diagnostics.Decorators_are_not_valid_here):vm(t,e.Diagnostics.A_decorator_can_only_decorate_a_method_implementation_not_an_overload);if(153===t.kind||154===t.kind){var n=e.getAllAccessorDeclarations(t.parent.members,t);if(n.firstAccessor.decorators&&t===n.secondAccessor)return vm(t,e.Diagnostics.Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name)}return!1}function Zf(t){var n,i,r,s,o=function(t){return!!t.modifiers&&(function(t){switch(t.kind){case 153:case 154:case 152:case 149:case 148:case 151:case 150:case 157:case 233:case 238:case 237:case 244:case 243:case 186:case 187:case 146:return!1;default:if(234===t.parent.kind||265===t.parent.kind)return!1;switch(t.kind){case 228:return Qf(t,120);case 229:return Qf(t,117);case 230:case 208:case 231:return!0;case 232:return Qf(t,76);default:return e.Debug.fail(),!1}}}(t)?vm(t,e.Diagnostics.Modifiers_cannot_appear_here):void 0)}(t);if(void 0!==o)return o;for(var a=0,l=0,c=t.modifiers;l<c.length;l++){var u=c[l];if(131!==u.kind){if(148===t.kind||150===t.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_type_member,e.tokenToString(u.kind));if(157===t.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_an_index_signature,e.tokenToString(u.kind))}switch(u.kind){case 76:if(232!==t.kind&&229===t.parent.kind)return km(t,e.Diagnostics.A_class_member_cannot_have_the_0_keyword,e.tokenToString(76));break;case 114:case 113:case 112:var d=xi(e.modifierToFlag(u.kind));if(28&a)return km(u,e.Diagnostics.Accessibility_modifier_already_seen);if(32&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"static");if(64&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"readonly");if(256&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"async");if(234===t.parent.kind||265===t.parent.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_module_or_namespace_element,d);if(128&a)return 112===u.kind?km(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,d,"abstract"):km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"abstract");a|=e.modifierToFlag(u.kind);break;case 115:if(32&a)return km(u,e.Diagnostics._0_modifier_already_seen,"static");if(64&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"static","readonly");if(256&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"static","async");if(234===t.parent.kind||265===t.parent.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_module_or_namespace_element,"static");if(146===t.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"static");if(128&a)return km(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"static","abstract");a|=32,n=u;break;case 131:if(64&a)return km(u,e.Diagnostics._0_modifier_already_seen,"readonly");if(149!==t.kind&&148!==t.kind&&157!==t.kind&&146!==t.kind)return km(u,e.Diagnostics.readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature);a|=64,s=u;break;case 84:if(1&a)return km(u,e.Diagnostics._0_modifier_already_seen,"export");if(2&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"export","declare");if(128&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"export","abstract");if(256&a)return km(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"export","async");if(229===t.parent.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_class_element,"export");if(146===t.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"export");a|=1;break;case 79:var p=265===t.parent.kind?t.parent:t.parent.parent;if(233===p.kind&&!e.isAmbientModule(p))return km(u,e.Diagnostics.A_default_export_can_only_be_used_in_an_ECMAScript_style_module);a|=512;break;case 124:if(2&a)return km(u,e.Diagnostics._0_modifier_already_seen,"declare");if(256&a)return km(u,e.Diagnostics._0_modifier_cannot_be_used_in_an_ambient_context,"async");if(229===t.parent.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_class_element,"declare");if(146===t.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"declare");if(e.isInAmbientContext(t.parent)&&234===t.parent.kind)return km(u,e.Diagnostics.A_declare_modifier_cannot_be_used_in_an_already_ambient_context);a|=2,i=u;break;case 117:if(128&a)return km(u,e.Diagnostics._0_modifier_already_seen,"abstract");if(229!==t.kind){if(151!==t.kind&&149!==t.kind&&153!==t.kind&&154!==t.kind)return km(u,e.Diagnostics.abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration);if(229!==t.parent.kind||!e.hasModifier(t.parent,128))return km(u,e.Diagnostics.Abstract_methods_can_only_appear_within_an_abstract_class);if(32&a)return km(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"static","abstract");if(8&a)return km(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"private","abstract")}a|=128;break;case 120:if(256&a)return km(u,e.Diagnostics._0_modifier_already_seen,"async");if(2&a||e.isInAmbientContext(t.parent))return km(u,e.Diagnostics._0_modifier_cannot_be_used_in_an_ambient_context,"async");if(146===t.kind)return km(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"async");a|=256,r=u}}return 152===t.kind?32&a?km(n,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"static"):128&a?km(n,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"abstract"):256&a?km(r,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"async"):64&a?km(s,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"readonly"):void 0:(238===t.kind||237===t.kind)&&2&a?km(i,e.Diagnostics.A_0_modifier_cannot_be_used_with_an_import_declaration,"declare"):146===t.kind&&92&a&&e.isBindingPattern(t.name)?km(t,e.Diagnostics.A_parameter_property_may_not_be_declared_using_a_binding_pattern):146===t.kind&&92&a&&t.dotDotDotToken?km(t,e.Diagnostics.A_parameter_property_cannot_be_declared_using_a_rest_parameter):256&a?function(t,n){switch(t.kind){case 151:case 228:case 186:case 187:return!1}return km(n,e.Diagnostics._0_modifier_cannot_be_used_here,"async")}(t,r):void 0}function Qf(e,t){return e.modifiers.length>1||e.modifiers[0].kind!==t}function em(t){if(t&&t.hasTrailingComma){var n=t.end-1,i=t.end;return Tm(t[0],n,i-n,e.Diagnostics.Trailing_comma_not_allowed)}}function tm(t,n){if(em(t))return!0;if(t&&0===t.length){var i=t.pos-1;return Tm(n,i,e.skipTrivia(n.text,t.end)+1-i,e.Diagnostics.Type_parameter_list_cannot_be_empty)}}function nm(t){var n=e.getSourceFileOfNode(t);return Xf(t)||Zf(t)||tm(t.typeParameters,n)||function(t){for(var n=!1,i=t.length,r=0;r<i;r++){var s=t[r];if(s.dotDotDotToken){if(r!==i-1)return km(s.dotDotDotToken,e.Diagnostics.A_rest_parameter_must_be_last_in_a_parameter_list);if(e.isBindingPattern(s.name))return km(s.name,e.Diagnostics.A_rest_element_cannot_contain_a_binding_pattern);if(s.questionToken)return km(s.questionToken,e.Diagnostics.A_rest_parameter_cannot_be_optional);if(s.initializer)return km(s.name,e.Diagnostics.A_rest_parameter_cannot_have_an_initializer)}else if(s.questionToken){if(n=!0,s.initializer)return km(s.name,e.Diagnostics.Parameter_cannot_have_question_mark_and_initializer)}else if(n&&!s.initializer)return km(s.name,e.Diagnostics.A_required_parameter_cannot_follow_an_optional_parameter)}}(t.parameters)||function(t,n){if(187===t.kind){var i=t;if(e.getLineAndCharacterOfPosition(n,i.equalsGreaterThanToken.pos).line!==e.getLineAndCharacterOfPosition(n,i.equalsGreaterThanToken.end).line)return km(i.equalsGreaterThanToken,e.Diagnostics.Line_terminator_not_permitted_before_arrow)}return!1}(t,n)}function im(t,n){return em(n)||function(t,n){if(n&&0===n.length){var i=e.getSourceFileOfNode(t),r=n.pos-1;return Tm(i,r,e.skipTrivia(i.text,n.end)+1-r,e.Diagnostics.Type_argument_list_cannot_be_empty)}}(t,n)}function rm(t){return function(t){if(t)for(var n=0,i=t;n<i.length;n++){var r=i[n];if(200===r.kind)return Tm(r,r.pos,0,e.Diagnostics.Argument_expression_expected)}}(t)}function sm(t){var n=t.types;if(em(n))return!0;if(n&&0===n.length){var i=e.tokenToString(t.token);return Tm(t,n.pos,0,e.Diagnostics._0_list_cannot_be_empty,i)}return e.forEach(n,om)}function om(e){return im(e,e.typeArguments)}function am(t){if(144!==t.kind)return!1;var n=t;return 194===n.expression.kind&&26===n.expression.operatorToken.kind?km(n.expression,e.Diagnostics.A_comma_expression_is_not_allowed_in_a_computed_property_name):void 0}function lm(t){if(t.asteriskToken){if(e.Debug.assert(228===t.kind||186===t.kind||151===t.kind),e.isInAmbientContext(t))return km(t.asteriskToken,e.Diagnostics.Generators_are_not_allowed_in_an_ambient_context);if(!t.body)return km(t.asteriskToken,e.Diagnostics.An_overload_signature_cannot_be_declared_as_a_generator)}}function cm(e,t){if(e)return km(e,t)}function um(t){if(Em(t))return!0;if(216===t.kind&&t.awaitModifier&&!(16384&t.flags))return km(t.awaitModifier,e.Diagnostics.A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator);if(227===t.initializer.kind){var n=t.initializer;if(!_m(n)){var i=n.declarations;if(!i.length)return!1;if(i.length>1){var r=215===t.kind?e.Diagnostics.Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement:e.Diagnostics.Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement;return vm(n.declarations[1],r)}var s=i[0];if(s.initializer){var r=215===t.kind?e.Diagnostics.The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer:e.Diagnostics.The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer;return km(s.name,r)}if(s.type)return km(s,r=215===t.kind?e.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation:e.Diagnostics.The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation)}}return!1}function dm(t){if(t.parameters.length===(153===t.kind?1:2))return e.getThisParameter(t)}function pm(t,n){if(e.isDynamicName(t))return km(t,n)}function hm(t){if(function(t){if(t.modifiers&&178===t.parent.kind){if(!(2&e.getFunctionFlags(t)))return vm(t,e.Diagnostics.Modifiers_cannot_appear_here);if(t.modifiers.length>1)return vm(t,e.Diagnostics.Modifiers_cannot_appear_here)}}(t)||nm(t)||lm(t))return!0;if(178===t.parent.kind){if(cm(t.questionToken,e.Diagnostics.An_object_member_cannot_be_declared_optional))return!0;if(void 0===t.body)return Tm(t,t.end-1,1,e.Diagnostics._0_expected,"{")}if(e.isClassLike(t.parent)){if(e.isInAmbientContext(t))return pm(t.name,e.Diagnostics.A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol);if(!t.body)return pm(t.name,e.Diagnostics.A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol)}else{if(230===t.parent.kind)return pm(t.name,e.Diagnostics.A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol);if(163===t.parent.kind)return pm(t.name,e.Diagnostics.A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol)}}function fm(e){return 9===e.kind||8===e.kind||192===e.kind&&38===e.operator&&8===e.operand.kind}function mm(t){if(71===t.kind){if("__esModule"===e.idText(t))return km(t,e.Diagnostics.Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules)}else for(var n=0,i=t.elements;n<i.length;n++){var r=i[n];if(!e.isOmittedExpression(r))return mm(r.name)}}function gm(t){if(71===t.kind){if(110===t.originalKeywordKind)return km(t,e.Diagnostics.let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations)}else for(var n=0,i=t.elements;n<i.length;n++){var r=i[n];e.isOmittedExpression(r)||gm(r.name)}}function _m(t){var n=t.declarations;return!!em(t.declarations)||(t.declarations.length?void 0:Tm(t,n.pos,n.end-n.pos,e.Diagnostics.Variable_declaration_list_cannot_be_empty))}function ym(e){switch(e.kind){case 211:case 212:case 213:case 220:case 214:case 215:case 216:return!1;case 222:return ym(e.parent)}return!0}function bm(e){return e.parseDiagnostics.length>0}function vm(t,n,i,r,s){var o=e.getSourceFileOfNode(t);if(!bm(o)){var a=e.getSpanOfTokenAtPosition(o,t.pos);return Nt.add(e.createFileDiagnostic(o,a.start,a.length,n,i,r,s)),!0}}function Tm(t,n,i,r,s,o,a){var l=e.getSourceFileOfNode(t);if(!bm(l))return Nt.add(e.createFileDiagnostic(l,n,i,r,s,o,a)),!0}function km(t,n,i,r,s){if(!bm(e.getSourceFileOfNode(t)))return Nt.add(e.createDiagnosticForNode(t,n,i,r,s)),!0}function xm(t){return 230!==t.kind&&231!==t.kind&&238!==t.kind&&237!==t.kind&&244!==t.kind&&243!==t.kind&&236!==t.kind&&!e.hasModifier(t,515)&&vm(t,e.Diagnostics.A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file)}function Em(t){if(e.isInAmbientContext(t)){if(e.isAccessor(t.parent))return dn(t).hasReportedStatementInAmbientContext=!0;if(!dn(t).hasReportedStatementInAmbientContext&&e.isFunctionLike(t.parent))return dn(t).hasReportedStatementInAmbientContext=vm(t,e.Diagnostics.An_implementation_cannot_be_declared_in_ambient_contexts);if(207===t.parent.kind||234===t.parent.kind||265===t.parent.kind){var n=dn(t.parent);if(!n.hasReportedStatementInAmbientContext)return n.hasReportedStatementInAmbientContext=vm(t,e.Diagnostics.Statements_are_not_allowed_in_ambient_contexts)}}}function Sm(t){if(4&t.numericLiteralFlags){var n=void 0;if(E>=1?n=e.Diagnostics.Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0:e.isChildOfNodeWithKind(t,173)?n=e.Diagnostics.Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0:e.isChildOfNodeWithKind(t,264)&&(n=e.Diagnostics.Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0),n){var i=e.isPrefixUnaryExpression(t.parent)&&38===t.parent.operator,r=(i?"-":"")+"0o"+t.text;return km(i?t.parent:t,n,r)}}}}}(ts||(ts={})),function(e){function t(t){var n=e.createNode(t,-1,-1);return n.flags|=8,n}function n(t,n){return t!==n&&(Rt(t,n),wt(t,n),n.startsOnNewLine&&(t.startsOnNewLine=!0),e.aggregateTransformFlags(t)),t}function i(t,n){if(t){if(e.isNodeArray(t))return t}else t=[];var i=t;return i.pos=-1,i.end=-1,i.hasTrailingComma=n,i}function r(e){if(void 0!==e){var n=t(e.kind);for(var i in n.flags|=e.flags,Rt(n,e),e)!n.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(n[i]=e[i]);return n}}function s(t){return"number"==typeof t?o(t+""):"boolean"==typeof t?t?p():h():e.isString(t)?a(t):(n=t,(i=a(e.getTextOfIdentifierOrLiteral(n))).textSourceNode=n,i);var n,i}function o(e){var n=t(8);return n.text=e,n.numericLiteralFlags=0,n}function a(e){var n=t(9);return n.text=e,n}function l(n,r){var s=t(71);return s.escapedText=e.escapeLeadingUnderscores(n),s.originalKeywordKind=n?e.stringToToken(n):0,s.autoGenerateKind=0,s.autoGenerateId=0,r&&(s.typeArguments=i(r)),s}e.updateNode=n,e.createNodeArray=i,e.getSynthesizedClone=r,e.createLiteral=s,e.createNumericLiteral=o,e.createIdentifier=l,e.updateIdentifier=function(t,i){return t.typeArguments!==i?n(l(e.idText(t),i),t):t};var c,u=0;function d(e){return t(e)}function p(){return t(101)}function h(){return t(86)}function f(e,n){var i=t(143);return i.left=e,i.right=Et(n),i}function m(e){var n=t(144);return n.expression=e,n}function g(e,n,i){var r=t(145);return r.name=Et(e),r.constraint=n,r.default=i,r}function _(n,i,r,s,o,a,l){var c=t(146);return c.decorators=St(n),c.modifiers=St(i),c.dotDotDotToken=r,c.name=Et(s),c.questionToken=o,c.type=a,c.initializer=l?e.parenthesizeExpressionForList(l):void 0,c}function y(n){var i=t(147);return i.expression=e.parenthesizeForAccess(n),i}function b(e,n,i,r,s){var o=t(148);return o.modifiers=St(e),o.name=Et(n),o.questionToken=i,o.type=r,o.initializer=s,o}function v(e,n,i,r,s,o){var a=t(149);return a.decorators=St(e),a.modifiers=St(n),a.name=Et(i),a.questionToken=r,a.type=s,a.initializer=o,a}function T(e,t,n,i,r){var s=w(150,e,t,n);return s.name=Et(i),s.questionToken=r,s}function k(e,n,r,s,o,a,l,c,u){var d=t(151);return d.decorators=St(e),d.modifiers=St(n),d.asteriskToken=r,d.name=Et(s),d.questionToken=o,d.typeParameters=St(a),d.parameters=i(l),d.type=c,d.body=u,d}function x(e,n,r,s){var o=t(152);return o.decorators=St(e),o.modifiers=St(n),o.typeParameters=void 0,o.parameters=i(r),o.type=void 0,o.body=s,o}function E(e,n,r,s,o,a){var l=t(153);return l.decorators=St(e),l.modifiers=St(n),l.name=Et(r),l.typeParameters=void 0,l.parameters=i(s),l.type=o,l.body=a,l}function S(e,n,r,s,o){var a=t(154);return a.decorators=St(e),a.modifiers=St(n),a.name=Et(r),a.typeParameters=void 0,a.parameters=i(s),a.body=o,a}function C(e,n,r,s){var o=t(157);return o.decorators=St(e),o.modifiers=St(n),o.parameters=i(r),o.type=s,o}function w(e,n,i,r){var s=t(e);return s.typeParameters=St(n),s.parameters=St(i),s.type=r,s}function I(e,t,i,r){return e.typeParameters!==t||e.parameters!==i||e.type!==r?n(w(e.kind,t,i,r),e):e}function A(e,n){var i=t(158);return i.parameterName=Et(e),i.type=n,i}function N(n,i){var r=t(159);return r.typeName=Et(n),r.typeArguments=i&&e.parenthesizeTypeParameters(i),r}function D(e){var n=t(162);return n.exprName=e,n}function O(e){var n=t(163);return n.members=i(e),n}function R(n){var i=t(164);return i.elementType=e.parenthesizeArrayTypeMember(n),i}function L(e){var n=t(165);return n.elementTypes=i(e),n}function P(n,i){var r=t(n);return r.types=e.parenthesizeElementTypeMembers(i),r}function M(e,t){return e.types!==t?n(P(e.kind,t),e):e}function F(e){var n=t(168);return n.type=e,n}function B(n){var i=t(170);return i.operator=127,i.type=e.parenthesizeElementTypeMember(n),i}function $(n,i){var r=t(171);return r.objectType=e.parenthesizeElementTypeMember(n),r.indexType=i,r}function U(e,n,i,r){var s=t(172);return s.readonlyToken=e,s.typeParameter=n,s.questionToken=i,s.type=r,s}function V(e){var n=t(173);return n.literal=e,n}function H(e){var n=t(174);return n.elements=i(e),n}function G(e){var n=t(175);return n.elements=i(e),n}function j(e,n,i,r){var s=t(176);return s.dotDotDotToken=e,s.propertyName=Et(n),s.name=Et(i),s.initializer=r,s}function K(n,r){var s=t(177);return s.elements=e.parenthesizeListElements(i(n)),r&&(s.multiLine=!0),s}function z(e,n){var r=t(178);return r.properties=i(e),n&&(r.multiLine=!0),r}function W(n,i){var r=t(179);return r.expression=e.parenthesizeForAccess(n),r.name=Et(i),It(r,131072),r}function q(n,i){var r,o=t(180);return o.expression=e.parenthesizeForAccess(n),o.argumentExpression=(r=i,e.isString(r)||"number"==typeof r?s(r):r),o}function J(n,r,s){var o=t(181);return o.expression=e.parenthesizeForAccess(n),o.typeArguments=St(r),o.arguments=e.parenthesizeListElements(i(s)),o}function Y(n,r,s){var o=t(182);return o.expression=e.parenthesizeForNew(n),o.typeArguments=St(r),o.arguments=s?e.parenthesizeListElements(i(s)):void 0,o}function X(n,i){var r=t(183);return r.tag=e.parenthesizeForAccess(n),r.template=i,r}function Z(n,i){var r=t(184);return r.type=n,r.expression=e.parenthesizePrefixOperand(i),r}function Q(e){var n=t(185);return n.expression=e,n}function ee(e,n,r,s,o,a,l){var c=t(186);return c.modifiers=St(e),c.asteriskToken=n,c.name=Et(r),c.typeParameters=St(s),c.parameters=i(o),c.type=a,c.body=l,c}function te(n,r,s,o,a,l){var c=t(187);return c.modifiers=St(n),c.typeParameters=St(r),c.parameters=i(s),c.type=o,c.equalsGreaterThanToken=a||d(36),c.body=e.parenthesizeConciseBody(l),c}function ne(n){var i=t(188);return i.expression=e.parenthesizePrefixOperand(n),i}function ie(n){var i=t(189);return i.expression=e.parenthesizePrefixOperand(n),i}function re(n){var i=t(190);return i.expression=e.parenthesizePrefixOperand(n),i}function se(n){var i=t(191);return i.expression=e.parenthesizePrefixOperand(n),i}function oe(n,i){var r=t(192);return r.operator=n,r.operand=e.parenthesizePrefixOperand(i),r}function ae(n,i){var r=t(193);return r.operand=e.parenthesizePostfixOperand(n),r.operator=i,r}function le(n,i,r){var s,o=t(194),a="number"==typeof(s=i)?d(s):s,l=a.kind;return o.left=e.parenthesizeBinaryOperand(l,n,!0,void 0),o.operatorToken=a,o.right=e.parenthesizeBinaryOperand(l,r,!1,o.left),o}function ce(n,i,r,s,o){var a=t(195);return a.condition=e.parenthesizeForConditionalHead(n),a.questionToken=o?i:d(55),a.whenTrue=e.parenthesizeSubexpressionOfConditionalExpression(o?r:i),a.colonToken=o?s:d(56),a.whenFalse=e.parenthesizeSubexpressionOfConditionalExpression(o||r),a}function ue(e,n){var r=t(196);return r.head=e,r.templateSpans=i(n),r}function de(e,n){var i=t(197);return i.asteriskToken=e&&39===e.kind?e:void 0,i.expression=e&&39!==e.kind?e:n,i}function pe(n){var i=t(198);return i.expression=e.parenthesizeExpressionForList(n),i}function he(e,n,r,s,o){var a=t(199);return a.decorators=void 0,a.modifiers=St(e),a.name=Et(n),a.typeParameters=St(r),a.heritageClauses=St(s),a.members=i(o),a}function fe(n,i){var r=t(201);return r.expression=e.parenthesizeForAccess(i),r.typeArguments=St(n),r}function me(e,n){var i=t(202);return i.expression=e,i.type=n,i}function ge(n){var i=t(203);return i.expression=e.parenthesizeForAccess(n),i}function _e(e,n){var i=t(204);return i.keywordToken=e,i.name=n,i}function ye(e,n){var i=t(205);return i.expression=e,i.literal=n,i}function be(e,n){var r=t(207);return r.statements=i(e),n&&(r.multiLine=n),r}function ve(n,i){var r=t(208);return r.decorators=void 0,r.modifiers=St(n),r.declarationList=e.isArray(i)?Fe(i):i,r}function Te(n){var i=t(210);return i.expression=e.parenthesizeExpressionForExpressionStatement(n),i}function ke(e,n,i){var r=t(211);return r.expression=e,r.thenStatement=n,r.elseStatement=i,r}function xe(e,n){var i=t(212);return i.statement=e,i.expression=n,i}function Ee(e,n){var i=t(213);return i.expression=e,i.statement=n,i}function Se(e,n,i,r){var s=t(214);return s.initializer=e,s.condition=n,s.incrementor=i,s.statement=r,s}function Ce(e,n,i){var r=t(215);return r.initializer=e,r.expression=n,r.statement=i,r}function we(e,n,i,r){var s=t(216);return s.awaitModifier=e,s.initializer=n,s.expression=i,s.statement=r,s}function Ie(e){var n=t(217);return n.label=Et(e),n}function Ae(e){var n=t(218);return n.label=Et(e),n}function Ne(e){var n=t(219);return n.expression=e,n}function De(e,n){var i=t(220);return i.expression=e,i.statement=n,i}function Oe(n,i){var r=t(221);return r.expression=e.parenthesizeExpressionForList(n),r.caseBlock=i,r}function Re(e,n){var i=t(222);return i.label=Et(e),i.statement=n,i}function Le(e){var n=t(223);return n.expression=e,n}function Pe(e,n,i){var r=t(224);return r.tryBlock=e,r.catchClause=n,r.finallyBlock=i,r}function Me(n,i,r){var s=t(226);return s.name=Et(n),s.type=i,s.initializer=void 0!==r?e.parenthesizeExpressionForList(r):void 0,s}function Fe(e,n){var r=t(227);return r.flags|=3&n,r.declarations=i(e),r}function Be(e,n,r,s,o,a,l,c){var u=t(228);return u.decorators=St(e),u.modifiers=St(n),u.asteriskToken=r,u.name=Et(s),u.typeParameters=St(o),u.parameters=i(a),u.type=l,u.body=c,u}function $e(e,n,r,s,o,a){var l=t(229);return l.decorators=St(e),l.modifiers=St(n),l.name=Et(r),l.typeParameters=St(s),l.heritageClauses=St(o),l.members=i(a),l}function Ue(e,n,r,s,o,a){var l=t(230);return l.decorators=St(e),l.modifiers=St(n),l.name=Et(r),l.typeParameters=St(s),l.heritageClauses=St(o),l.members=i(a),l}function Ve(e,n,i,r,s){var o=t(231);return o.decorators=St(e),o.modifiers=St(n),o.name=Et(i),o.typeParameters=St(r),o.type=s,o}function He(e,n,r,s){var o=t(232);return o.decorators=St(e),o.modifiers=St(n),o.name=Et(r),o.members=i(s),o}function Ge(e,n,i,r,s){var o=t(233);return o.flags|=532&s,o.decorators=St(e),o.modifiers=St(n),o.name=i,o.body=r,o}function je(e){var n=t(234);return n.statements=i(e),n}function Ke(e){var n=t(235);return n.clauses=i(e),n}function ze(e){var n=t(236);return n.name=Et(e),n}function We(e,n,i,r){var s=t(237);return s.decorators=St(e),s.modifiers=St(n),s.name=Et(i),s.moduleReference=r,s}function qe(e,n,i,r){var s=t(238);return s.decorators=St(e),s.modifiers=St(n),s.importClause=i,s.moduleSpecifier=r,s}function Je(e,n){var i=t(239);return i.name=e,i.namedBindings=n,i}function Ye(e){var n=t(240);return n.name=e,n}function Xe(e){var n=t(241);return n.elements=i(e),n}function Ze(e,n){var i=t(242);return i.propertyName=e,i.name=n,i}function Qe(e,n,i,r){var s=t(243);return s.decorators=St(e),s.modifiers=St(n),s.isExportEquals=i,s.expression=r,s}function et(e,n,i,r){var s=t(244);return s.decorators=St(e),s.modifiers=St(n),s.exportClause=i,s.moduleSpecifier=r,s}function tt(e){var n=t(245);return n.elements=i(e),n}function nt(e,n){var i=t(246);return i.propertyName=Et(e),i.name=Et(n),i}function it(e){var n=t(248);return n.expression=e,n}function rt(e,n,r){var s=t(249);return s.openingElement=e,s.children=i(n),s.closingElement=r,s}function st(e,n){var i=t(250);return i.tagName=e,i.attributes=n,i}function ot(e,n){var i=t(251);return i.tagName=e,i.attributes=n,i}function at(e){var n=t(252);return n.tagName=e,n}function lt(e,n){var i=t(253);return i.name=e,i.initializer=n,i}function ct(e){var n=t(254);return n.properties=i(e),n}function ut(e){var n=t(255);return n.expression=e,n}function dt(e,n){var i=t(256);return i.dotDotDotToken=e,i.expression=n,i}function pt(n,r){var s=t(257);return s.expression=e.parenthesizeExpressionForList(n),s.statements=i(r),s}function ht(e){var n=t(258);return n.statements=i(e),n}function ft(e,n){var r=t(259);return r.token=e,r.types=i(n),r}function mt(n,i){var r=t(260);return r.variableDeclaration=e.isString(n)?Me(n):n,r.block=i,r}function gt(n,i){var r=t(261);return r.name=Et(n),r.questionToken=void 0,r.initializer=void 0!==i?e.parenthesizeExpressionForList(i):void 0,r}function _t(n,i){var r=t(262);return r.name=Et(n),r.objectAssignmentInitializer=void 0!==i?e.parenthesizeExpressionForList(i):void 0,r}function yt(n){var i=t(263);return i.expression=void 0!==n?e.parenthesizeExpressionForList(n):void 0,i}function bt(n,i){var r=t(264);return r.name=Et(n),r.initializer=i&&e.parenthesizeExpressionForList(i),r}function vt(e,n){var i=t(288);return i.expression=e,i.original=n,wt(i,n),i}function Tt(t){if(e.nodeIsSynthesized(t)&&!e.isParseTreeNode(t)&&!t.original&&!t.emitNode&&!t.id){if(289===t.kind)return t.elements;if(e.isBinaryExpression(t)&&26===t.operatorToken.kind)return[t.left,t.right]}return t}function kt(n){var r=t(289);return r.elements=i(e.sameFlatMap(n,Tt)),r}function xt(t){var n=e.createNode(266);return n.sourceFiles=t,n}function Et(t){return e.isString(t)?l(t):t}function St(e){return e?i(e):void 0}function Ct(t){if(!t.emitNode){if(e.isParseTreeNode(t)){if(265===t.kind)return t.emitNode={annotatedNodes:[t]};Ct(e.getSourceFileOfNode(t)).annotatedNodes.push(t)}t.emitNode={}}return t.emitNode}function wt(e,t){return t&&(e.pos=t.pos,e.end=t.end),e}function It(e,t){return Ct(e).flags=t,e}function At(e){var t=e.emitNode;return t&&t.leadingComments}function Nt(e,t){return Ct(e).leadingComments=t,e}function Dt(e){var t=e.emitNode;return t&&t.trailingComments}function Ot(e,t){return Ct(e).trailingComments=t,e}function Rt(t,n){if(t.original=n,n){var i=n.emitNode;i&&(t.emitNode=function(t,n){var i=t.flags,r=t.leadingComments,s=t.trailingComments,o=t.commentRange,a=t.sourceMapRange,l=t.tokenSourceMapRanges,c=t.constantValue,u=t.helpers;n||(n={});r&&(n.leadingComments=e.addRange(r.slice(),n.leadingComments));s&&(n.trailingComments=e.addRange(s.slice(),n.trailingComments));i&&(n.flags=i);o&&(n.commentRange=o);a&&(n.sourceMapRange=a);l&&(n.tokenSourceMapRanges=function(e,t){t||(t=[]);for(var n in e)t[n]=e[n];return t}(l,n.tokenSourceMapRanges));void 0!==c&&(n.constantValue=c);u&&(n.helpers=e.addRange(n.helpers,u));return n}(i,t.emitNode))}return t}e.createTempVariable=function(e){var t=l("");return t.autoGenerateKind=1,t.autoGenerateId=u,u++,e&&e(t),t},e.createLoopVariable=function(){var e=l("");return e.autoGenerateKind=2,e.autoGenerateId=u,u++,e},e.createUniqueName=function(e){var t=l(e);return t.autoGenerateKind=3,t.autoGenerateId=u,u++,t},e.getGeneratedNameForNode=function(e){var t=l("");return t.autoGenerateKind=4,t.autoGenerateId=u,t.original=e,u++,t},e.createToken=d,e.createSuper=function(){return t(97)},e.createThis=function(){return t(99)},e.createNull=function(){return t(95)},e.createTrue=p,e.createFalse=h,e.createQualifiedName=f,e.updateQualifiedName=function(e,t,i){return e.left!==t||e.right!==i?n(f(t,i),e):e},e.createComputedPropertyName=m,e.updateComputedPropertyName=function(e,t){return e.expression!==t?n(m(t),e):e},e.createTypeParameterDeclaration=g,e.updateTypeParameterDeclaration=function(e,t,i,r){return e.name!==t||e.constraint!==i||e.default!==r?n(g(t,i,r),e):e},e.createParameter=_,e.updateParameter=function(e,t,i,r,s,o,a,l){return e.decorators!==t||e.modifiers!==i||e.dotDotDotToken!==r||e.name!==s||e.questionToken!==o||e.type!==a||e.initializer!==l?n(_(t,i,r,s,o,a,l),e):e},e.createDecorator=y,e.updateDecorator=function(e,t){return e.expression!==t?n(y(t),e):e},e.createPropertySignature=b,e.updatePropertySignature=function(e,t,i,r,s,o){return e.modifiers!==t||e.name!==i||e.questionToken!==r||e.type!==s||e.initializer!==o?n(b(t,i,r,s,o),e):e},e.createProperty=v,e.updateProperty=function(e,t,i,r,s,o,a){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.questionToken!==s||e.type!==o||e.initializer!==a?n(v(t,i,r,s,o,a),e):e},e.createMethodSignature=T,e.updateMethodSignature=function(e,t,i,r,s,o){return e.typeParameters!==t||e.parameters!==i||e.type!==r||e.name!==s||e.questionToken!==o?n(T(t,i,r,s,o),e):e},e.createMethod=k,e.updateMethod=function(e,t,i,r,s,o,a,l,c,u){return e.decorators!==t||e.modifiers!==i||e.asteriskToken!==r||e.name!==s||e.questionToken!==o||e.typeParameters!==a||e.parameters!==l||e.type!==c||e.body!==u?n(k(t,i,r,s,o,a,l,c,u),e):e},e.createConstructor=x,e.updateConstructor=function(e,t,i,r,s){return e.decorators!==t||e.modifiers!==i||e.parameters!==r||e.body!==s?n(x(t,i,r,s),e):e},e.createGetAccessor=E,e.updateGetAccessor=function(e,t,i,r,s,o,a){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.parameters!==s||e.type!==o||e.body!==a?n(E(t,i,r,s,o,a),e):e},e.createSetAccessor=S,e.updateSetAccessor=function(e,t,i,r,s,o){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.parameters!==s||e.body!==o?n(S(t,i,r,s,o),e):e},e.createCallSignature=function(e,t,n){return w(155,e,t,n)},e.updateCallSignature=function(e,t,n,i){return I(e,t,n,i)},e.createConstructSignature=function(e,t,n){return w(156,e,t,n)},e.updateConstructSignature=function(e,t,n,i){return I(e,t,n,i)},e.createIndexSignature=C,e.updateIndexSignature=function(e,t,i,r,s){return e.parameters!==r||e.type!==s||e.decorators!==t||e.modifiers!==i?n(C(t,i,r,s),e):e},e.createSignatureDeclaration=w,e.createKeywordTypeNode=function(e){return t(e)},e.createTypePredicateNode=A,e.updateTypePredicateNode=function(e,t,i){return e.parameterName!==t||e.type!==i?n(A(t,i),e):e},e.createTypeReferenceNode=N,e.updateTypeReferenceNode=function(e,t,i){return e.typeName!==t||e.typeArguments!==i?n(N(t,i),e):e},e.createFunctionTypeNode=function(e,t,n){return w(160,e,t,n)},e.updateFunctionTypeNode=function(e,t,n,i){return I(e,t,n,i)},e.createConstructorTypeNode=function(e,t,n){return w(161,e,t,n)},e.updateConstructorTypeNode=function(e,t,n,i){return I(e,t,n,i)},e.createTypeQueryNode=D,e.updateTypeQueryNode=function(e,t){return e.exprName!==t?n(D(t),e):e},e.createTypeLiteralNode=O,e.updateTypeLiteralNode=function(e,t){return e.members!==t?n(O(t),e):e},e.createArrayTypeNode=R,e.updateArrayTypeNode=function(e,t){return e.elementType!==t?n(R(t),e):e},e.createTupleTypeNode=L,e.updateTypleTypeNode=function(e,t){return e.elementTypes!==t?n(L(t),e):e},e.createUnionTypeNode=function(e){return P(166,e)},e.updateUnionTypeNode=function(e,t){return M(e,t)},e.createIntersectionTypeNode=function(e){return P(167,e)},e.updateIntersectionTypeNode=function(e,t){return M(e,t)},e.createUnionOrIntersectionTypeNode=P,e.createParenthesizedType=F,e.updateParenthesizedType=function(e,t){return e.type!==t?n(F(t),e):e},e.createThisTypeNode=function(){return t(169)},e.createTypeOperatorNode=B,e.updateTypeOperatorNode=function(e,t){return e.type!==t?n(B(t),e):e},e.createIndexedAccessTypeNode=$,e.updateIndexedAccessTypeNode=function(e,t,i){return e.objectType!==t||e.indexType!==i?n($(t,i),e):e},e.createMappedTypeNode=U,e.updateMappedTypeNode=function(e,t,i,r,s){return e.readonlyToken!==t||e.typeParameter!==i||e.questionToken!==r||e.type!==s?n(U(t,i,r,s),e):e},e.createLiteralTypeNode=V,e.updateLiteralTypeNode=function(e,t){return e.literal!==t?n(V(t),e):e},e.createObjectBindingPattern=H,e.updateObjectBindingPattern=function(e,t){return e.elements!==t?n(H(t),e):e},e.createArrayBindingPattern=G,e.updateArrayBindingPattern=function(e,t){return e.elements!==t?n(G(t),e):e},e.createBindingElement=j,e.updateBindingElement=function(e,t,i,r,s){return e.propertyName!==i||e.dotDotDotToken!==t||e.name!==r||e.initializer!==s?n(j(t,i,r,s),e):e},e.createArrayLiteral=K,e.updateArrayLiteral=function(e,t){return e.elements!==t?n(K(t,e.multiLine),e):e},e.createObjectLiteral=z,e.updateObjectLiteral=function(e,t){return e.properties!==t?n(z(t,e.multiLine),e):e},e.createPropertyAccess=W,e.updatePropertyAccess=function(t,i,r){return t.expression!==i||t.name!==r?n(It(W(i,r),e.getEmitFlags(t)),t):t},e.createElementAccess=q,e.updateElementAccess=function(e,t,i){return e.expression!==t||e.argumentExpression!==i?n(q(t,i),e):e},e.createCall=J,e.updateCall=function(e,t,i,r){return e.expression!==t||e.typeArguments!==i||e.arguments!==r?n(J(t,i,r),e):e},e.createNew=Y,e.updateNew=function(e,t,i,r){return e.expression!==t||e.typeArguments!==i||e.arguments!==r?n(Y(t,i,r),e):e},e.createTaggedTemplate=X,e.updateTaggedTemplate=function(e,t,i){return e.tag!==t||e.template!==i?n(X(t,i),e):e},e.createTypeAssertion=Z,e.updateTypeAssertion=function(e,t,i){return e.type!==t||e.expression!==i?n(Z(t,i),e):e},e.createParen=Q,e.updateParen=function(e,t){return e.expression!==t?n(Q(t),e):e},e.createFunctionExpression=ee,e.updateFunctionExpression=function(e,t,i,r,s,o,a,l){return e.name!==r||e.modifiers!==t||e.asteriskToken!==i||e.typeParameters!==s||e.parameters!==o||e.type!==a||e.body!==l?n(ee(t,i,r,s,o,a,l),e):e},e.createArrowFunction=te,e.updateArrowFunction=function(t,i,r,s,o,a,l){var c,u;return void 0===l?(c=t.equalsGreaterThanToken,u=e.cast(a,e.isConciseBody)):(c=e.cast(a,function(e){return 36===e.kind}),u=l),t.modifiers!==i||t.typeParameters!==r||t.parameters!==s||t.type!==o||t.equalsGreaterThanToken!==c||t.body!==u?n(te(i,r,s,o,c,u),t):t},e.createDelete=ne,e.updateDelete=function(e,t){return e.expression!==t?n(ne(t),e):e},e.createTypeOf=ie,e.updateTypeOf=function(e,t){return e.expression!==t?n(ie(t),e):e},e.createVoid=re,e.updateVoid=function(e,t){return e.expression!==t?n(re(t),e):e},e.createAwait=se,e.updateAwait=function(e,t){return e.expression!==t?n(se(t),e):e},e.createPrefix=oe,e.updatePrefix=function(e,t){return e.operand!==t?n(oe(e.operator,t),e):e},e.createPostfix=ae,e.updatePostfix=function(e,t){return e.operand!==t?n(ae(t,e.operator),e):e},e.createBinary=le,e.updateBinary=function(e,t,i,r){return e.left!==t||e.right!==i?n(le(t,r||e.operatorToken,i),e):e},e.createConditional=ce,e.updateConditional=function t(i,r){for(var s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];if(2===s.length){var a=s[0],l=s[1];return t(i,r,i.questionToken,a,i.colonToken,l)}e.Debug.assert(4===s.length);var c=s[0],u=s[1],d=s[2],p=s[3];return i.condition!==r||i.questionToken!==c||i.whenTrue!==u||i.colonToken!==d||i.whenFalse!==p?n(ce(r,c,u,d,p),i):i},e.createTemplateExpression=ue,e.updateTemplateExpression=function(e,t,i){return e.head!==t||e.templateSpans!==i?n(ue(t,i),e):e},e.createTemplateHead=function(e){var n=t(14);return n.text=e,n},e.createTemplateMiddle=function(e){var n=t(15);return n.text=e,n},e.createTemplateTail=function(e){var n=t(16);return n.text=e,n},e.createNoSubstitutionTemplateLiteral=function(e){var n=t(13);return n.text=e,n},e.createYield=de,e.updateYield=function(e,t,i){return e.expression!==i||e.asteriskToken!==t?n(de(t,i),e):e},e.createSpread=pe,e.updateSpread=function(e,t){return e.expression!==t?n(pe(t),e):e},e.createClassExpression=he,e.updateClassExpression=function(e,t,i,r,s,o){return e.modifiers!==t||e.name!==i||e.typeParameters!==r||e.heritageClauses!==s||e.members!==o?n(he(t,i,r,s,o),e):e},e.createOmittedExpression=function(){return t(200)},e.createExpressionWithTypeArguments=fe,e.updateExpressionWithTypeArguments=function(e,t,i){return e.typeArguments!==t||e.expression!==i?n(fe(t,i),e):e},e.createAsExpression=me,e.updateAsExpression=function(e,t,i){return e.expression!==t||e.type!==i?n(me(t,i),e):e},e.createNonNullExpression=ge,e.updateNonNullExpression=function(e,t){return e.expression!==t?n(ge(t),e):e},e.createMetaProperty=_e,e.updateMetaProperty=function(e,t){return e.name!==t?n(_e(e.keywordToken,t),e):e},e.createTemplateSpan=ye,e.updateTemplateSpan=function(e,t,i){return e.expression!==t||e.literal!==i?n(ye(t,i),e):e},e.createSemicolonClassElement=function(){return t(206)},e.createBlock=be,e.updateBlock=function(e,t){return e.statements!==t?n(be(t,e.multiLine),e):e},e.createVariableStatement=ve,e.updateVariableStatement=function(e,t,i){return e.modifiers!==t||e.declarationList!==i?n(ve(t,i),e):e},e.createEmptyStatement=function(){return t(209)},e.createStatement=Te,e.updateStatement=function(e,t){return e.expression!==t?n(Te(t),e):e},e.createIf=ke,e.updateIf=function(e,t,i,r){return e.expression!==t||e.thenStatement!==i||e.elseStatement!==r?n(ke(t,i,r),e):e},e.createDo=xe,e.updateDo=function(e,t,i){return e.statement!==t||e.expression!==i?n(xe(t,i),e):e},e.createWhile=Ee,e.updateWhile=function(e,t,i){return e.expression!==t||e.statement!==i?n(Ee(t,i),e):e},e.createFor=Se,e.updateFor=function(e,t,i,r,s){return e.initializer!==t||e.condition!==i||e.incrementor!==r||e.statement!==s?n(Se(t,i,r,s),e):e},e.createForIn=Ce,e.updateForIn=function(e,t,i,r){return e.initializer!==t||e.expression!==i||e.statement!==r?n(Ce(t,i,r),e):e},e.createForOf=we,e.updateForOf=function(e,t,i,r,s){return e.awaitModifier!==t||e.initializer!==i||e.expression!==r||e.statement!==s?n(we(t,i,r,s),e):e},e.createContinue=Ie,e.updateContinue=function(e,t){return e.label!==t?n(Ie(t),e):e},e.createBreak=Ae,e.updateBreak=function(e,t){return e.label!==t?n(Ae(t),e):e},e.createReturn=Ne,e.updateReturn=function(e,t){return e.expression!==t?n(Ne(t),e):e},e.createWith=De,e.updateWith=function(e,t,i){return e.expression!==t||e.statement!==i?n(De(t,i),e):e},e.createSwitch=Oe,e.updateSwitch=function(e,t,i){return e.expression!==t||e.caseBlock!==i?n(Oe(t,i),e):e},e.createLabel=Re,e.updateLabel=function(e,t,i){return e.label!==t||e.statement!==i?n(Re(t,i),e):e},e.createThrow=Le,e.updateThrow=function(e,t){return e.expression!==t?n(Le(t),e):e},e.createTry=Pe,e.updateTry=function(e,t,i,r){return e.tryBlock!==t||e.catchClause!==i||e.finallyBlock!==r?n(Pe(t,i,r),e):e},e.createDebuggerStatement=function(){return t(225)},e.createVariableDeclaration=Me,e.updateVariableDeclaration=function(e,t,i,r){return e.name!==t||e.type!==i||e.initializer!==r?n(Me(t,i,r),e):e},e.createVariableDeclarationList=Fe,e.updateVariableDeclarationList=function(e,t){return e.declarations!==t?n(Fe(t,e.flags),e):e},e.createFunctionDeclaration=Be,e.updateFunctionDeclaration=function(e,t,i,r,s,o,a,l,c){return e.decorators!==t||e.modifiers!==i||e.asteriskToken!==r||e.name!==s||e.typeParameters!==o||e.parameters!==a||e.type!==l||e.body!==c?n(Be(t,i,r,s,o,a,l,c),e):e},e.createClassDeclaration=$e,e.updateClassDeclaration=function(e,t,i,r,s,o,a){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.typeParameters!==s||e.heritageClauses!==o||e.members!==a?n($e(t,i,r,s,o,a),e):e},e.createInterfaceDeclaration=Ue,e.updateInterfaceDeclaration=function(e,t,i,r,s,o,a){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.typeParameters!==s||e.heritageClauses!==o||e.members!==a?n(Ue(t,i,r,s,o,a),e):e},e.createTypeAliasDeclaration=Ve,e.updateTypeAliasDeclaration=function(e,t,i,r,s,o){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.typeParameters!==s||e.type!==o?n(Ve(t,i,r,s,o),e):e},e.createEnumDeclaration=He,e.updateEnumDeclaration=function(e,t,i,r,s){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.members!==s?n(He(t,i,r,s),e):e},e.createModuleDeclaration=Ge,e.updateModuleDeclaration=function(e,t,i,r,s){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.body!==s?n(Ge(t,i,r,s,e.flags),e):e},e.createModuleBlock=je,e.updateModuleBlock=function(e,t){return e.statements!==t?n(je(t),e):e},e.createCaseBlock=Ke,e.updateCaseBlock=function(e,t){return e.clauses!==t?n(Ke(t),e):e},e.createNamespaceExportDeclaration=ze,e.updateNamespaceExportDeclaration=function(e,t){return e.name!==t?n(ze(t),e):e},e.createImportEqualsDeclaration=We,e.updateImportEqualsDeclaration=function(e,t,i,r,s){return e.decorators!==t||e.modifiers!==i||e.name!==r||e.moduleReference!==s?n(We(t,i,r,s),e):e},e.createImportDeclaration=qe,e.updateImportDeclaration=function(e,t,i,r,s){return e.decorators!==t||e.modifiers!==i||e.importClause!==r||e.moduleSpecifier!==s?n(qe(t,i,r,s),e):e},e.createImportClause=Je,e.updateImportClause=function(e,t,i){return e.name!==t||e.namedBindings!==i?n(Je(t,i),e):e},e.createNamespaceImport=Ye,e.updateNamespaceImport=function(e,t){return e.name!==t?n(Ye(t),e):e},e.createNamedImports=Xe,e.updateNamedImports=function(e,t){return e.elements!==t?n(Xe(t),e):e},e.createImportSpecifier=Ze,e.updateImportSpecifier=function(e,t,i){return e.propertyName!==t||e.name!==i?n(Ze(t,i),e):e},e.createExportAssignment=Qe,e.updateExportAssignment=function(e,t,i,r){return e.decorators!==t||e.modifiers!==i||e.expression!==r?n(Qe(t,i,e.isExportEquals,r),e):e},e.createExportDeclaration=et,e.updateExportDeclaration=function(e,t,i,r,s){return e.decorators!==t||e.modifiers!==i||e.exportClause!==r||e.moduleSpecifier!==s?n(et(t,i,r,s),e):e},e.createNamedExports=tt,e.updateNamedExports=function(e,t){return e.elements!==t?n(tt(t),e):e},e.createExportSpecifier=nt,e.updateExportSpecifier=function(e,t,i){return e.propertyName!==t||e.name!==i?n(nt(t,i),e):e},e.createExternalModuleReference=it,e.updateExternalModuleReference=function(e,t){return e.expression!==t?n(it(t),e):e},e.createJsxElement=rt,e.updateJsxElement=function(e,t,i,r){return e.openingElement!==t||e.children!==i||e.closingElement!==r?n(rt(t,i,r),e):e},e.createJsxSelfClosingElement=st,e.updateJsxSelfClosingElement=function(e,t,i){return e.tagName!==t||e.attributes!==i?n(st(t,i),e):e},e.createJsxOpeningElement=ot,e.updateJsxOpeningElement=function(e,t,i){return e.tagName!==t||e.attributes!==i?n(ot(t,i),e):e},e.createJsxClosingElement=at,e.updateJsxClosingElement=function(e,t){return e.tagName!==t?n(at(t),e):e},e.createJsxAttribute=lt,e.updateJsxAttribute=function(e,t,i){return e.name!==t||e.initializer!==i?n(lt(t,i),e):e},e.createJsxAttributes=ct,e.updateJsxAttributes=function(e,t){return e.properties!==t?n(ct(t),e):e},e.createJsxSpreadAttribute=ut,e.updateJsxSpreadAttribute=function(e,t){return e.expression!==t?n(ut(t),e):e},e.createJsxExpression=dt,e.updateJsxExpression=function(e,t){return e.expression!==t?n(dt(e.dotDotDotToken,t),e):e},e.createCaseClause=pt,e.updateCaseClause=function(e,t,i){return e.expression!==t||e.statements!==i?n(pt(t,i),e):e},e.createDefaultClause=ht,e.updateDefaultClause=function(e,t){return e.statements!==t?n(ht(t),e):e},e.createHeritageClause=ft,e.updateHeritageClause=function(e,t){return e.types!==t?n(ft(e.token,t),e):e},e.createCatchClause=mt,e.updateCatchClause=function(e,t,i){return e.variableDeclaration!==t||e.block!==i?n(mt(t,i),e):e},e.createPropertyAssignment=gt,e.updatePropertyAssignment=function(e,t,i){return e.name!==t||e.initializer!==i?n(gt(t,i),e):e},e.createShorthandPropertyAssignment=_t,e.updateShorthandPropertyAssignment=function(e,t,i){return e.name!==t||e.objectAssignmentInitializer!==i?n(_t(t,i),e):e},e.createSpreadAssignment=yt,e.updateSpreadAssignment=function(e,t){return e.expression!==t?n(yt(t),e):e},e.createEnumMember=bt,e.updateEnumMember=function(e,t,i){return e.name!==t||e.initializer!==i?n(bt(t,i),e):e},e.updateSourceFileNode=function(e,r){if(e.statements!==r){var s=t(265);return s.flags|=e.flags,s.statements=i(r),s.endOfFileToken=e.endOfFileToken,s.fileName=e.fileName,s.path=e.path,s.text=e.text,void 0!==e.amdDependencies&&(s.amdDependencies=e.amdDependencies),void 0!==e.moduleName&&(s.moduleName=e.moduleName),void 0!==e.referencedFiles&&(s.referencedFiles=e.referencedFiles),void 0!==e.typeReferenceDirectives&&(s.typeReferenceDirectives=e.typeReferenceDirectives),void 0!==e.languageVariant&&(s.languageVariant=e.languageVariant),void 0!==e.isDeclarationFile&&(s.isDeclarationFile=e.isDeclarationFile),void 0!==e.renamedDependencies&&(s.renamedDependencies=e.renamedDependencies),void 0!==e.hasNoDefaultLib&&(s.hasNoDefaultLib=e.hasNoDefaultLib),void 0!==e.languageVersion&&(s.languageVersion=e.languageVersion),void 0!==e.scriptKind&&(s.scriptKind=e.scriptKind),void 0!==e.externalModuleIndicator&&(s.externalModuleIndicator=e.externalModuleIndicator),void 0!==e.commonJsModuleIndicator&&(s.commonJsModuleIndicator=e.commonJsModuleIndicator),void 0!==e.identifiers&&(s.identifiers=e.identifiers),void 0!==e.nodeCount&&(s.nodeCount=e.nodeCount),void 0!==e.identifierCount&&(s.identifierCount=e.identifierCount),void 0!==e.symbolCount&&(s.symbolCount=e.symbolCount),void 0!==e.parseDiagnostics&&(s.parseDiagnostics=e.parseDiagnostics),void 0!==e.bindDiagnostics&&(s.bindDiagnostics=e.bindDiagnostics),void 0!==e.lineMap&&(s.lineMap=e.lineMap),void 0!==e.classifiableNames&&(s.classifiableNames=e.classifiableNames),void 0!==e.resolvedModules&&(s.resolvedModules=e.resolvedModules),void 0!==e.resolvedTypeReferenceDirectiveNames&&(s.resolvedTypeReferenceDirectiveNames=e.resolvedTypeReferenceDirectiveNames),void 0!==e.imports&&(s.imports=e.imports),void 0!==e.moduleAugmentations&&(s.moduleAugmentations=e.moduleAugmentations),n(s,e)}return e},e.getMutableClone=function(e){var t=r(e);return t.pos=e.pos,t.end=e.end,t.parent=e.parent,t},e.createNotEmittedStatement=function(e){var n=t(287);return n.original=e,wt(n,e),n},e.createEndOfDeclarationMarker=function(e){var n=t(291);return n.emitNode={},n.original=e,n},e.createMergeDeclarationMarker=function(e){var n=t(290);return n.emitNode={},n.original=e,n},e.createPartiallyEmittedExpression=vt,e.updatePartiallyEmittedExpression=function(e,t){return e.expression!==t?n(vt(t,e.original),e):e},e.createCommaList=kt,e.updateCommaList=function(e,t){return e.elements!==t?n(kt(t),e):e},e.createBundle=xt,e.updateBundle=function(e,t){return e.sourceFiles!==t?xt(t):e},e.createImmediatelyInvokedFunctionExpression=function(e,t,n){return J(ee(void 0,void 0,void 0,void 0,t?[t]:[],void 0,be(e,!0)),void 0,n?[n]:[])},e.createImmediatelyInvokedArrowFunction=function(e,t,n){return J(te(void 0,void 0,t?[t]:[],void 0,void 0,be(e,!0)),void 0,n?[n]:[])},e.createComma=function(e,t){return le(e,26,t)},e.createLessThan=function(e,t){return le(e,27,t)},e.createAssignment=function(e,t){return le(e,58,t)},e.createStrictEquality=function(e,t){return le(e,34,t)},e.createStrictInequality=function(e,t){return le(e,35,t)},e.createAdd=function(e,t){return le(e,37,t)},e.createSubtract=function(e,t){return le(e,38,t)},e.createPostfixIncrement=function(e){return ae(e,43)},e.createLogicalAnd=function(e,t){return le(e,53,t)},e.createLogicalOr=function(e,t){return le(e,54,t)},e.createLogicalNot=function(e){return oe(51,e)},e.createVoidZero=function(){return re(s(0))},e.createExportDefault=function(e){return Qe(void 0,void 0,!1,e)},e.createExternalModuleExport=function(e){return et(void 0,void 0,tt([nt(void 0,e)]))},e.disposeEmitNodes=function(t){var n=(t=e.getSourceFileOfNode(e.getParseTreeNode(t)))&&t.emitNode,i=n&&n.annotatedNodes;if(i)for(var r=0,s=i;r<s.length;r++){s[r].emitNode=void 0}},e.getOrCreateEmitNode=Ct,e.setTextRange=wt,e.setEmitFlags=It,e.addEmitFlags=function(e,t){var n=Ct(e);return n.flags=n.flags|t,e},e.getSourceMapRange=function(e){var t=e.emitNode;return t&&t.sourceMapRange||e},e.setSourceMapRange=function(e,t){return Ct(e).sourceMapRange=t,e},e.createSourceMapSource=function(t,n,i){return new(c||(c=e.objectAllocator.getSourceMapSourceConstructor()))(t,n,i)},e.getTokenSourceMapRange=function(e,t){var n=e.emitNode,i=n&&n.tokenSourceMapRanges;return i&&i[t]},e.setTokenSourceMapRange=function(e,t,n){var i=Ct(e);return(i.tokenSourceMapRanges||(i.tokenSourceMapRanges=[]))[t]=n,e},e.getCommentRange=function(e){var t=e.emitNode;return t&&t.commentRange||e},e.setCommentRange=function(e,t){return Ct(e).commentRange=t,e},e.getSyntheticLeadingComments=At,e.setSyntheticLeadingComments=Nt,e.addSyntheticLeadingComment=function(t,n,i,r){return Nt(t,e.append(At(t),{kind:n,pos:-1,end:-1,hasTrailingNewLine:r,text:i}))},e.getSyntheticTrailingComments=Dt,e.setSyntheticTrailingComments=Ot,e.addSyntheticTrailingComment=function(t,n,i,r){return Ot(t,e.append(Dt(t),{kind:n,pos:-1,end:-1,hasTrailingNewLine:r,text:i}))},e.getConstantValue=function(e){var t=e.emitNode;return t&&t.constantValue},e.setConstantValue=function(e,t){return Ct(e).constantValue=t,e},e.addEmitHelper=function(t,n){var i=Ct(t);return i.helpers=e.append(i.helpers,n),t},e.addEmitHelpers=function(t,n){if(e.some(n))for(var i=Ct(t),r=0,s=n;r<s.length;r++){var o=s[r];i.helpers=e.appendIfUnique(i.helpers,o)}return t},e.removeEmitHelper=function(t,n){var i=t.emitNode;if(i){var r=i.helpers;if(r)return e.orderedRemoveItem(r,n)}return!1},e.getEmitHelpers=function(e){var t=e.emitNode;return t&&t.helpers},e.moveEmitHelpers=function(t,n,i){var r=t.emitNode,s=r&&r.helpers;if(e.some(s)){for(var o=Ct(n),a=0,l=0;l<s.length;l++){var c=s[l];i(c)?(a++,o.helpers=e.appendIfUnique(o.helpers,c)):a>0&&(s[l-a]=c)}a>0&&(s.length-=a)}},e.compareEmitHelpers=function(t,n){return t===n||t.priority===n.priority?0:void 0===t.priority?1:void 0===n.priority?-1:e.compareValues(t.priority,n.priority)},e.setOriginalNode=Rt}(ts||(ts={})),function(e){function t(t,n,i){if(e.isComputedPropertyName(n))return e.setTextRange(e.createElementAccess(t,n.expression),i);var r=e.setTextRange(e.isIdentifier(n)?e.createPropertyAccess(t,n):e.createElementAccess(t,n),n);return e.getOrCreateEmitNode(r).flags|=64,r}function n(t,n){var i=e.createIdentifier(t||"React");return i.flags&=-9,i.parent=e.getParseTreeNode(n),i}function i(t,r){if(e.isQualifiedName(t)){var s=i(t.left,r),o=e.createIdentifier(e.idText(t.right));return o.escapedText=t.right.escapedText,e.createPropertyAccess(s,o)}return n(e.idText(t),r)}function r(t,r,s){return t?i(t,s):e.createPropertyAccess(n(r,s),"createElement")}function s(t){return e.setEmitFlags(e.createIdentifier(t),4098)}e.nullTransformationContext={enableEmitNotification:e.noop,enableSubstitution:e.noop,endLexicalEnvironment:function(){},getCompilerOptions:e.notImplemented,getEmitHost:e.notImplemented,getEmitResolver:e.notImplemented,hoistFunctionDeclaration:e.noop,hoistVariableDeclaration:e.noop,isEmitNotificationEnabled:e.notImplemented,isSubstitutionEnabled:e.notImplemented,onEmitNode:e.noop,onSubstituteNode:e.notImplemented,readEmitHelpers:e.notImplemented,requestEmitHelper:e.noop,resumeLexicalEnvironment:e.noop,startLexicalEnvironment:e.noop,suspendLexicalEnvironment:e.noop},e.createTypeCheck=function(t,n){return"undefined"===n?e.createStrictEquality(t,e.createVoidZero()):e.createStrictEquality(e.createTypeOf(t),e.createLiteral(n))},e.createMemberAccessForPropertyName=t,e.createFunctionCall=function(t,n,i,r){return e.setTextRange(e.createCall(e.createPropertyAccess(t,"call"),void 0,[n].concat(i)),r)},e.createFunctionApply=function(t,n,i,r){return e.setTextRange(e.createCall(e.createPropertyAccess(t,"apply"),void 0,[n,i]),r)},e.createArraySlice=function(t,n){var i=[];return void 0!==n&&i.push("number"==typeof n?e.createLiteral(n):n),e.createCall(e.createPropertyAccess(t,"slice"),void 0,i)},e.createArrayConcat=function(t,n){return e.createCall(e.createPropertyAccess(t,"concat"),void 0,n)},e.createMathPow=function(t,n,i){return e.setTextRange(e.createCall(e.createPropertyAccess(e.createIdentifier("Math"),"pow"),void 0,[t,n]),i)},e.createExpressionForJsxElement=function(t,n,i,s,o,a,l){var c=[i];if(s&&c.push(s),o&&o.length>0)if(s||c.push(e.createNull()),o.length>1)for(var u=0,d=o;u<d.length;u++){var p=d[u];p.startsOnNewLine=!0,c.push(p)}else c.push(o[0]);return e.setTextRange(e.createCall(r(t,n,a),void 0,c),l)},e.getHelperName=s;var o={name:"typescript:values",scoped:!1,text:'\n            var __values = (this && this.__values) || function (o) {\n                var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;\n                if (m) return m.call(o);\n                return {\n                    next: function () {\n                        if (o && i >= o.length) o = void 0;\n                        return { value: o && o[i++], done: !o };\n                    }\n                };\n            };\n        '};e.createValuesHelper=function(t,n,i){return t.requestEmitHelper(o),e.setTextRange(e.createCall(s("__values"),void 0,[n]),i)};var a={name:"typescript:read",scoped:!1,text:'\n            var __read = (this && this.__read) || function (o, n) {\n                var m = typeof Symbol === "function" && o[Symbol.iterator];\n                if (!m) return o;\n                var i = m.call(o), r, ar = [], e;\n                try {\n                    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n                }\n                catch (error) { e = { error: error }; }\n                finally {\n                    try {\n                        if (r && !r.done && (m = i["return"])) m.call(i);\n                    }\n                    finally { if (e) throw e.error; }\n                }\n                return ar;\n            };\n        '};e.createReadHelper=function(t,n,i,r){return t.requestEmitHelper(a),e.setTextRange(e.createCall(s("__read"),void 0,void 0!==i?[n,e.createLiteral(i)]:[n]),r)};var l={name:"typescript:spread",scoped:!1,text:"\n            var __spread = (this && this.__spread) || function () {\n                for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n                return ar;\n            };"};function c(e,t){var n=E(e);switch(n.kind){case 71:return t;case 99:case 8:case 9:return!1;case 177:return 0!==n.elements.length;case 178:return n.properties.length>0;default:return!0}}function u(t){return e.isIdentifier(t)?e.createLiteral(t):e.isComputedPropertyName(t)?e.getMutableClone(t.expression):e.getMutableClone(t)}function d(e,t,n){return p(e,t,n,8192)}function p(t,n,i,r){var s=e.getNameOfDeclaration(t);if(s&&e.isIdentifier(s)&&!e.isGeneratedIdentifier(s)){var o=e.getMutableClone(s);return r|=e.getEmitFlags(s),i||(r|=48),n||(r|=1536),r&&e.setEmitFlags(o,r),o}return e.getGeneratedNameForNode(t)}function h(t,n,i,r){var s,o=e.createPropertyAccess(t,e.nodeIsSynthesized(n)?n:e.getSynthesizedClone(n));return e.setTextRange(o,n),r||(s|=48),i||(s|=1536),s&&e.setEmitFlags(o,s),o}function f(t){return e.isStringLiteral(t.expression)&&"use strict"===t.expression.text}function m(t,n,i){e.Debug.assert(0===t.length,"Prologue directives should be at the first statement in the target statements array");for(var r=!1,s=0,o=n.length;s<o;){var a=n[s];if(!e.isPrologueDirective(a))break;f(a)&&(r=!0),t.push(a),s++}return i&&!r&&t.push(w(e.createStatement(e.createLiteral("use strict")))),s}function g(t,n,i,r){for(var s=n.length;i<s;){var o=n[i];if(!(1048576&e.getEmitFlags(o)))break;t.push(r?e.visitNode(o,r,e.isStatement):o),i++}return i}function _(t){if(t=e.skipPartiallyEmittedExpressions(t),e.isLiteralKind(t.kind))return t.kind;if(194===t.kind&&37===t.operatorToken.kind){if(void 0!==t.cachedLiteralKind)return t.cachedLiteralKind;var n=_(t.left),i=e.isLiteralKind(n)&&n===_(t.right)?n:0;return t.cachedLiteralKind=i,i}return 0}function y(t){var n=e.skipPartiallyEmittedExpressions(t);return e.isLeftHandSideExpression(n)&&(182!==n.kind||n.arguments)?t:e.setTextRange(e.createParen(t),t)}function b(t){var n=e.skipPartiallyEmittedExpressions(t);return e.getExpressionPrecedence(n)>e.getOperatorPrecedence(194,26)?t:e.setTextRange(e.createParen(t),t)}function v(t){switch(t.kind){case 166:case 167:case 160:case 161:return e.createParenthesizedType(t)}return t}function T(e,t){for(;;){switch(e.kind){case 193:e=e.operand;continue;case 194:e=e.left;continue;case 195:e=e.condition;continue;case 181:if(t)return e;case 180:case 179:case 288:e=e.expression;continue}return e}}function k(e,t){switch(void 0===t&&(t=7),e.kind){case 185:return!!(1&t);case 184:case 202:case 203:return!!(2&t);case 288:return!!(4&t)}return!1}function x(t,n){var i;void 0===n&&(n=7);do{i=t,1&n&&(t=E(t)),2&n&&(t=S(t)),4&n&&(t=e.skipPartiallyEmittedExpressions(t))}while(i!==t);return t}function E(e){for(;185===e.kind;)e=e.expression;return e}function S(t){for(;e.isAssertionExpression(t)||203===t.kind;)t=t.expression;return t}function C(t,n,i){return void 0===i&&(i=7),t&&k(t,i)&&(!(185===(r=t).kind&&e.nodeIsSynthesized(r)&&e.nodeIsSynthesized(e.getSourceMapRange(r))&&e.nodeIsSynthesized(e.getCommentRange(r)))||e.some(e.getSyntheticLeadingComments(r))||e.some(e.getSyntheticTrailingComments(r)))?function(t,n){switch(t.kind){case 185:return e.updateParen(t,n);case 184:return e.updateTypeAssertion(t,t.type,n);case 202:return e.updateAsExpression(t,n,t.type);case 203:return e.updateNonNullExpression(t,n);case 288:return e.updatePartiallyEmittedExpression(t,n)}}(t,C(t.expression,n)):n;var r}function w(e){return e.startsOnNewLine=!0,e}function I(t){var n=e.getOriginalNode(t,e.isSourceFile),i=n&&n.emitNode;return i&&i.externalHelpersModuleName}function A(t,n,i){if(t)return t.moduleName?e.createLiteral(t.moduleName):t.isDeclarationFile||!i.out&&!i.outFile?void 0:e.createLiteral(e.getExternalModuleNameFromPath(n,t.fileName))}function N(t){if(e.isDeclarationBindingElement(t))return t.name;if(!e.isObjectLiteralElementLike(t))return e.isAssignmentExpression(t,!0)?N(t.left):e.isSpreadElement(t)?N(t.expression):t;switch(t.kind){case 261:return N(t.initializer);case 262:return t.name;case 263:return N(t.expression)}}function D(t){if(e.isBindingElement(t)){if(t.dotDotDotToken)return e.Debug.assertNode(t.name,e.isIdentifier),e.setOriginalNode(e.setTextRange(e.createSpread(t.name),t),t);var n=M(t.name);return t.initializer?e.setOriginalNode(e.setTextRange(e.createAssignment(n,t.initializer),t),t):n}return e.Debug.assertNode(t,e.isExpression),t}function O(t){if(e.isBindingElement(t)){if(t.dotDotDotToken)return e.Debug.assertNode(t.name,e.isIdentifier),e.setOriginalNode(e.setTextRange(e.createSpreadAssignment(t.name),t),t);if(t.propertyName){var n=M(t.name);return e.setOriginalNode(e.setTextRange(e.createPropertyAssignment(t.propertyName,t.initializer?e.createAssignment(n,t.initializer):n),t),t)}return e.Debug.assertNode(t.name,e.isIdentifier),e.setOriginalNode(e.setTextRange(e.createShorthandPropertyAssignment(t.name,t.initializer),t),t)}return e.Debug.assertNode(t,e.isObjectLiteralElementLike),t}function R(e){switch(e.kind){case 175:case 177:return P(e);case 174:case 178:return L(e)}}function L(t){return e.isObjectBindingPattern(t)?e.setOriginalNode(e.setTextRange(e.createObjectLiteral(e.map(t.elements,O)),t),t):(e.Debug.assertNode(t,e.isObjectLiteralExpression),t)}function P(t){return e.isArrayBindingPattern(t)?e.setOriginalNode(e.setTextRange(e.createArrayLiteral(e.map(t.elements,D)),t),t):(e.Debug.assertNode(t,e.isArrayLiteralExpression),t)}function M(t){return e.isBindingPattern(t)?R(t):(e.Debug.assertNode(t,e.isExpression),t)}e.createSpreadHelper=function(t,n,i){return t.requestEmitHelper(a),t.requestEmitHelper(l),e.setTextRange(e.createCall(s("__spread"),void 0,n),i)},e.createForOfBindingStatement=function(t,n){if(e.isVariableDeclarationList(t)){var i=e.firstOrUndefined(t.declarations),r=e.updateVariableDeclaration(i,i.name,void 0,n);return e.setTextRange(e.createVariableStatement(void 0,e.updateVariableDeclarationList(t,[r])),t)}var s=e.setTextRange(e.createAssignment(t,n),t);return e.setTextRange(e.createStatement(s),t)},e.insertLeadingStatement=function(t,n){return e.isBlock(t)?e.updateBlock(t,e.setTextRange(e.createNodeArray([n].concat(t.statements)),t.statements)):e.createBlock(e.createNodeArray([t,n]),!0)},e.restoreEnclosingLabel=function t(n,i,r){if(!i)return n;var s=e.updateLabel(i,i.label,222===i.statement.kind?t(n,i.statement):n);return r&&r(i),s},e.createCallBinding=function(t,n,i,r){var s,o,a=x(t,7);if(e.isSuperProperty(a))s=e.createThis(),o=a;else if(97===a.kind)s=e.createThis(),o=i<2?e.setTextRange(e.createIdentifier("_super"),a):a;else if(4096&e.getEmitFlags(a))s=e.createVoidZero(),o=y(a);else switch(a.kind){case 179:c(a.expression,r)?(s=e.createTempVariable(n),o=e.createPropertyAccess(e.setTextRange(e.createAssignment(s,a.expression),a.expression),a.name),e.setTextRange(o,a)):(s=a.expression,o=a);break;case 180:c(a.expression,r)?(s=e.createTempVariable(n),o=e.createElementAccess(e.setTextRange(e.createAssignment(s,a.expression),a.expression),a.argumentExpression),e.setTextRange(o,a)):(s=a.expression,o=a);break;default:s=e.createVoidZero(),o=y(t)}return{target:o,thisArg:s}},e.inlineExpressions=function(t){return t.length>10?e.createCommaList(t):e.reduceLeft(t,e.createComma)},e.createExpressionFromEntityName=function t(n){if(e.isQualifiedName(n)){var i=t(n.left),r=e.getMutableClone(n.right);return e.setTextRange(e.createPropertyAccess(i,r),n)}return e.getMutableClone(n)},e.createExpressionForPropertyName=u,e.createExpressionForObjectLiteralElementLike=function(n,i,r){switch(i.kind){case 153:case 154:return function(t,n,i,r){var s=e.getAllAccessorDeclarations(t,n),o=s.firstAccessor,a=s.getAccessor,l=s.setAccessor;if(n===o){var c=[];if(a){var d=e.createFunctionExpression(a.modifiers,void 0,void 0,void 0,a.parameters,void 0,a.body);e.setTextRange(d,a),e.setOriginalNode(d,a);var p=e.createPropertyAssignment("get",d);c.push(p)}if(l){var h=e.createFunctionExpression(l.modifiers,void 0,void 0,void 0,l.parameters,void 0,l.body);e.setTextRange(h,l),e.setOriginalNode(h,l);var f=e.createPropertyAssignment("set",h);c.push(f)}c.push(e.createPropertyAssignment("enumerable",e.createTrue())),c.push(e.createPropertyAssignment("configurable",e.createTrue()));var m=e.setTextRange(e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"defineProperty"),void 0,[i,u(n.name),e.createObjectLiteral(c,r)]),o);return e.aggregateTransformFlags(m)}return}(n.properties,i,r,n.multiLine);case 261:return function(n,i){return e.aggregateTransformFlags(e.setOriginalNode(e.setTextRange(e.createAssignment(t(i,n.name,n.name),n.initializer),n),n))}(i,r);case 262:return function(n,i){return e.aggregateTransformFlags(e.setOriginalNode(e.setTextRange(e.createAssignment(t(i,n.name,n.name),e.getSynthesizedClone(n.name)),n),n))}(i,r);case 151:return function(n,i){return e.aggregateTransformFlags(e.setOriginalNode(e.setTextRange(e.createAssignment(t(i,n.name,n.name),e.setOriginalNode(e.setTextRange(e.createFunctionExpression(n.modifiers,n.asteriskToken,void 0,void 0,n.parameters,void 0,n.body),n),n)),n),n))}(i,r)}},e.getInternalName=function(e,t,n){return p(e,t,n,49152)},e.isInternalName=function(t){return!!(32768&e.getEmitFlags(t))},e.getLocalName=function(e,t,n){return p(e,t,n,16384)},e.isLocalName=function(t){return!!(16384&e.getEmitFlags(t))},e.getExportName=d,e.isExportName=function(t){return!!(8192&e.getEmitFlags(t))},e.getDeclarationName=function(e,t,n){return p(e,t,n)},e.getExternalModuleOrNamespaceExportName=function(t,n,i,r){return t&&e.hasModifier(n,1)?h(t,p(n),i,r):d(n,i,r)},e.getNamespaceMemberName=h,e.convertToFunctionBody=function(t,n){return e.isBlock(t)?t:e.setTextRange(e.createBlock([e.setTextRange(e.createReturn(t),t)],n),t)},e.convertFunctionDeclarationToExpression=function(t){e.Debug.assert(!!t.body);var n=e.createFunctionExpression(t.modifiers,t.asteriskToken,t.name,t.typeParameters,t.parameters,t.type,t.body);return e.setOriginalNode(n,t),e.setTextRange(n,t),t.startsOnNewLine&&(n.startsOnNewLine=!0),e.aggregateTransformFlags(n),n},e.addPrologue=function(e,t,n,i){return g(e,t,m(e,t,n),i)},e.addStandardPrologue=m,e.addCustomPrologue=g,e.startsWithUseStrict=function(t){var n=e.firstOrUndefined(t);return void 0!==n&&e.isPrologueDirective(n)&&f(n)},e.ensureUseStrict=function(t){for(var n=!1,i=0,r=t;i<r.length;i++){var s=r[i];if(!e.isPrologueDirective(s))break;if(f(s)){n=!0;break}}return n?t:e.setTextRange(e.createNodeArray([w(e.createStatement(e.createLiteral("use strict")))].concat(t)),t)},e.parenthesizeBinaryOperand=function(t,n,i,r){return 185===e.skipPartiallyEmittedExpressions(n).kind?n:function(t,n,i,r){var s=e.getOperatorPrecedence(194,t),o=e.getOperatorAssociativity(194,t),a=e.skipPartiallyEmittedExpressions(n),l=e.getExpressionPrecedence(a);switch(e.compareValues(l,s)){case-1:return!(!i&&1===o&&197===n.kind);case 1:return!1;case 0:if(i)return 1===o;if(e.isBinaryExpression(a)&&a.operatorToken.kind===t){if(function(e){return 39===e||49===e||48===e||50===e}(t))return!1;if(37===t){var c=r?_(r):0;if(e.isLiteralKind(c)&&c===_(a))return!1}}return 0===e.getExpressionAssociativity(a)}}(t,n,i,r)?e.createParen(n):n},e.parenthesizeForConditionalHead=function(t){var n=e.getOperatorPrecedence(195,55),i=e.skipPartiallyEmittedExpressions(t),r=e.getExpressionPrecedence(i);return-1===e.compareValues(r,n)?e.createParen(t):t},e.parenthesizeSubexpressionOfConditionalExpression=function(t){return 194===t.kind&&26===t.operatorToken.kind?e.createParen(t):t},e.parenthesizeForNew=function(t){var n=T(t,!0);switch(n.kind){case 181:return e.createParen(t);case 182:return n.arguments?t:e.createParen(t)}return y(t)},e.parenthesizeForAccess=y,e.parenthesizePostfixOperand=function(t){return e.isLeftHandSideExpression(t)?t:e.setTextRange(e.createParen(t),t)},e.parenthesizePrefixOperand=function(t){return e.isUnaryExpression(t)?t:e.setTextRange(e.createParen(t),t)},e.parenthesizeListElements=function(t){for(var n,i=0;i<t.length;i++){var r=b(t[i]);void 0===n&&r===t[i]||(void 0===n&&(n=t.slice(0,i)),n.push(r))}return void 0!==n?e.setTextRange(e.createNodeArray(n,t.hasTrailingComma),t):t},e.parenthesizeExpressionForList=b,e.parenthesizeExpressionForExpressionStatement=function(t){var n=e.skipPartiallyEmittedExpressions(t);if(e.isCallExpression(n)){var i=n.expression,r=e.skipPartiallyEmittedExpressions(i).kind;if(186===r||187===r){var s=e.getMutableClone(n);return s.expression=e.setTextRange(e.createParen(i),i),C(t,s,4)}}var o=T(n,!1).kind;return 178===o||186===o?e.setTextRange(e.createParen(t),t):t},e.parenthesizeElementTypeMember=v,e.parenthesizeArrayTypeMember=function(t){switch(t.kind){case 162:case 170:return e.createParenthesizedType(t)}return v(t)},e.parenthesizeElementTypeMembers=function(t){return e.createNodeArray(e.sameMap(t,v))},e.parenthesizeTypeParameters=function(t){if(e.some(t)){for(var n=[],i=0;i<t.length;++i){var r=t[i];n.push(0===i&&e.isFunctionOrConstructorTypeNode(r)&&r.typeParameters?e.createParenthesizedType(r):r)}return e.createNodeArray(n)}},e.parenthesizeConciseBody=function(t){return e.isBlock(t)||178!==T(t,!1).kind?t:e.setTextRange(e.createParen(t),t)},function(e){e[e.Parentheses=1]="Parentheses",e[e.Assertions=2]="Assertions",e[e.PartiallyEmittedExpressions=4]="PartiallyEmittedExpressions",e[e.All=7]="All"}(e.OuterExpressionKinds||(e.OuterExpressionKinds={})),e.isOuterExpression=k,e.skipOuterExpressions=x,e.skipParentheses=E,e.skipAssertions=S,e.recreateOuterExpressions=C,e.startOnNewLine=w,e.getExternalHelpersModuleName=I,e.getOrCreateExternalHelpersModuleNameIfNeeded=function(t,n,i){if(n.importHelpers&&e.isEffectiveExternalModule(t,n)){var r=I(t);if(r)return r;var s=e.getEmitModuleKind(n),o=i&&s!==e.ModuleKind.System&&s!==e.ModuleKind.ES2015&&s!==e.ModuleKind.ESNext;if(!o){var a=e.getEmitHelpers(t);if(a)for(var l=0,c=a;l<c.length;l++){if(!c[l].scoped){o=!0;break}}}if(o){var u=e.getOriginalNode(t,e.isSourceFile),d=e.getOrCreateEmitNode(u);return d.externalHelpersModuleName||(d.externalHelpersModuleName=e.createUniqueName(e.externalHelpersModuleNameText))}}},e.getLocalNameForExternalImport=function(t,n){var i=e.getNamespaceDeclarationNode(t);if(i&&!e.isDefaultImport(t)){var r=i.name;return e.isGeneratedIdentifier(r)?r:e.createIdentifier(e.getSourceTextOfNodeFromSourceFile(n,i.name))}return 238===t.kind&&t.importClause||244===t.kind&&t.moduleSpecifier?e.getGeneratedNameForNode(t):void 0},e.getExternalModuleNameLiteral=function(t,n,i,r,s){var o=e.getExternalModuleName(t);if(9===o.kind)return function(e,t,n,i){return A(n.getExternalModuleFileFromDeclaration(e),t,i)}(t,i,r,s)||function(t,n){var i=n.renamedDependencies&&n.renamedDependencies.get(t.text);return i&&e.createLiteral(i)}(o,n)||e.getSynthesizedClone(o)},e.tryGetModuleNameFromFile=A,e.getInitializerOfBindingOrAssignmentElement=function t(n){return e.isDeclarationBindingElement(n)?n.initializer:e.isPropertyAssignment(n)?e.isAssignmentExpression(n.initializer,!0)?n.initializer.right:void 0:e.isShorthandPropertyAssignment(n)?n.objectAssignmentInitializer:e.isAssignmentExpression(n,!0)?n.right:e.isSpreadElement(n)?t(n.expression):void 0},e.getTargetOfBindingOrAssignmentElement=N,e.getRestIndicatorOfBindingOrAssignmentElement=function(e){switch(e.kind){case 146:case 176:return e.dotDotDotToken;case 198:case 263:return e}},e.getPropertyNameOfBindingOrAssignmentElement=function(t){switch(t.kind){case 176:if(t.propertyName){var n=t.propertyName;return e.isComputedPropertyName(n)&&e.isStringOrNumericLiteral(n.expression)?n.expression:n}break;case 261:if(t.name){n=t.name;return e.isComputedPropertyName(n)&&e.isStringOrNumericLiteral(n.expression)?n.expression:n}break;case 263:return t.name}var i=N(t);if(i&&e.isPropertyName(i))return e.isComputedPropertyName(i)&&e.isStringOrNumericLiteral(i.expression)?i.expression:i;e.Debug.fail("Invalid property name for binding element.")},e.getElementsOfBindingOrAssignmentPattern=function(e){switch(e.kind){case 174:case 175:case 177:return e.elements;case 178:return e.properties}},e.convertToArrayAssignmentElement=D,e.convertToObjectAssignmentElement=O,e.convertToAssignmentPattern=R,e.convertToObjectAssignmentPattern=L,e.convertToArrayAssignmentPattern=P,e.convertToAssignmentElementTarget=M}(ts||(ts={})),function(e){function t(t,n,i,r){if(void 0===t||void 0===n)return t;e.aggregateTransformFlags(t);var s,a=n(t);return a===t?t:void 0!==a?(s=e.isArray(a)?(r||o)(a):a,e.Debug.assertNode(s,i),e.aggregateTransformFlags(s),s):void 0}function n(t,n,i,r,s){if(void 0===t||void 0===n)return t;var o,a=t.length;(void 0===r||r<0)&&(r=0),(void 0===s||s>a-r)&&(s=a-r),(r>0||s<a)&&(o=e.createNodeArray([],t.hasTrailingComma&&r+s===a));for(var l=0;l<s;l++){var c=t[l+r];e.aggregateTransformFlags(c);var u=void 0!==c?n(c):void 0;if((void 0!==o||void 0===u||u!==c)&&(void 0===o&&(o=e.createNodeArray(t.slice(0,l),t.hasTrailingComma),e.setTextRange(o,t)),u))if(e.isArray(u))for(var d=0,p=u;d<p.length;d++){var h=p[d];e.Debug.assertNode(h,i),e.aggregateTransformFlags(h),o.push(h)}else e.Debug.assertNode(u,i),e.aggregateTransformFlags(u),o.push(u)}return o||t}function i(t,i,r,s,o){r.startLexicalEnvironment(),t=n(t,i,e.isStatement,s),o&&!e.startsWithUseStrict(t)&&(t=e.setTextRange(e.createNodeArray([e.createStatement(e.createLiteral("use strict"))].concat(t)),t));var a=r.endLexicalEnvironment();return e.setTextRange(e.createNodeArray(e.concatenate(t,a)),t)}function r(t,i,r,s){void 0===s&&(s=n),r.startLexicalEnvironment();var o=s(t,i,e.isParameterDeclaration);return r.suspendLexicalEnvironment(),o}function s(n,i,r){r.resumeLexicalEnvironment();var s=t(n,i,e.isConciseBody),o=r.endLexicalEnvironment();if(e.some(o)){var a=e.convertToFunctionBody(s),l=e.mergeLexicalEnvironment(a.statements,o);return e.updateBlock(a,l)}return s}function o(t){return e.Debug.assert(t.length<=1,"Too many nodes written to output."),e.singleOrUndefined(t)}e.visitNode=t,e.visitNodes=n,e.visitLexicalEnvironment=i,e.visitParameterList=r,e.visitFunctionBody=s,e.visitEachChild=function(o,a,l,c,u){if(void 0===c&&(c=n),void 0!==o){var d=o.kind;if(d>0&&d<=142||169===d)return o;switch(d){case 71:return e.updateIdentifier(o,c(o.typeArguments,a,e.isTypeNode));case 143:return e.updateQualifiedName(o,t(o.left,a,e.isEntityName),t(o.right,a,e.isIdentifier));case 144:return e.updateComputedPropertyName(o,t(o.expression,a,e.isExpression));case 145:return e.updateTypeParameterDeclaration(o,t(o.name,a,e.isIdentifier),t(o.constraint,a,e.isTypeNode),t(o.default,a,e.isTypeNode));case 146:return e.updateParameter(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.dotDotDotToken,u,e.isToken),t(o.name,a,e.isBindingName),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 147:return e.updateDecorator(o,t(o.expression,a,e.isExpression));case 148:return e.updatePropertySignature(o,c(o.modifiers,a,e.isToken),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 149:return e.updateProperty(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 150:return e.updateMethodSignature(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken));case 151:return e.updateMethod(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.asteriskToken,u,e.isToken),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken),c(o.typeParameters,a,e.isTypeParameterDeclaration),r(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 152:return e.updateConstructor(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),r(o.parameters,a,l,c),s(o.body,a,l));case 153:return e.updateGetAccessor(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isPropertyName),r(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 154:return e.updateSetAccessor(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isPropertyName),r(o.parameters,a,l,c),s(o.body,a,l));case 155:return e.updateCallSignature(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 156:return e.updateConstructSignature(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 157:return e.updateIndexSignature(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 158:return e.updateTypePredicateNode(o,t(o.parameterName,a),t(o.type,a,e.isTypeNode));case 159:return e.updateTypeReferenceNode(o,t(o.typeName,a,e.isEntityName),c(o.typeArguments,a,e.isTypeNode));case 160:return e.updateFunctionTypeNode(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 161:return e.updateConstructorTypeNode(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 162:return e.updateTypeQueryNode(o,t(o.exprName,a,e.isEntityName));case 163:return e.updateTypeLiteralNode(o,c(o.members,a,e.isTypeElement));case 164:return e.updateArrayTypeNode(o,t(o.elementType,a,e.isTypeNode));case 165:return e.updateTypleTypeNode(o,c(o.elementTypes,a,e.isTypeNode));case 166:return e.updateUnionTypeNode(o,c(o.types,a,e.isTypeNode));case 167:return e.updateIntersectionTypeNode(o,c(o.types,a,e.isTypeNode));case 168:return e.updateParenthesizedType(o,t(o.type,a,e.isTypeNode));case 170:return e.updateTypeOperatorNode(o,t(o.type,a,e.isTypeNode));case 171:return e.updateIndexedAccessTypeNode(o,t(o.objectType,a,e.isTypeNode),t(o.indexType,a,e.isTypeNode));case 172:return e.updateMappedTypeNode(o,t(o.readonlyToken,u,e.isToken),t(o.typeParameter,a,e.isTypeParameterDeclaration),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode));case 173:return e.updateLiteralTypeNode(o,t(o.literal,a,e.isExpression));case 174:return e.updateObjectBindingPattern(o,c(o.elements,a,e.isBindingElement));case 175:return e.updateArrayBindingPattern(o,c(o.elements,a,e.isArrayBindingElement));case 176:return e.updateBindingElement(o,t(o.dotDotDotToken,u,e.isToken),t(o.propertyName,a,e.isPropertyName),t(o.name,a,e.isBindingName),t(o.initializer,a,e.isExpression));case 177:return e.updateArrayLiteral(o,c(o.elements,a,e.isExpression));case 178:return e.updateObjectLiteral(o,c(o.properties,a,e.isObjectLiteralElementLike));case 179:return e.updatePropertyAccess(o,t(o.expression,a,e.isExpression),t(o.name,a,e.isIdentifier));case 180:return e.updateElementAccess(o,t(o.expression,a,e.isExpression),t(o.argumentExpression,a,e.isExpression));case 181:return e.updateCall(o,t(o.expression,a,e.isExpression),c(o.typeArguments,a,e.isTypeNode),c(o.arguments,a,e.isExpression));case 182:return e.updateNew(o,t(o.expression,a,e.isExpression),c(o.typeArguments,a,e.isTypeNode),c(o.arguments,a,e.isExpression));case 183:return e.updateTaggedTemplate(o,t(o.tag,a,e.isExpression),t(o.template,a,e.isTemplateLiteral));case 184:return e.updateTypeAssertion(o,t(o.type,a,e.isTypeNode),t(o.expression,a,e.isExpression));case 185:return e.updateParen(o,t(o.expression,a,e.isExpression));case 186:return e.updateFunctionExpression(o,c(o.modifiers,a,e.isModifier),t(o.asteriskToken,u,e.isToken),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),r(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 187:return e.updateArrowFunction(o,c(o.modifiers,a,e.isModifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),r(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),t(o.equalsGreaterThanToken,a,e.isToken),s(o.body,a,l));case 188:return e.updateDelete(o,t(o.expression,a,e.isExpression));case 189:return e.updateTypeOf(o,t(o.expression,a,e.isExpression));case 190:return e.updateVoid(o,t(o.expression,a,e.isExpression));case 191:return e.updateAwait(o,t(o.expression,a,e.isExpression));case 192:return e.updatePrefix(o,t(o.operand,a,e.isExpression));case 193:return e.updatePostfix(o,t(o.operand,a,e.isExpression));case 194:return e.updateBinary(o,t(o.left,a,e.isExpression),t(o.right,a,e.isExpression),t(o.operatorToken,a,e.isToken));case 195:return e.updateConditional(o,t(o.condition,a,e.isExpression),t(o.questionToken,a,e.isToken),t(o.whenTrue,a,e.isExpression),t(o.colonToken,a,e.isToken),t(o.whenFalse,a,e.isExpression));case 196:return e.updateTemplateExpression(o,t(o.head,a,e.isTemplateHead),c(o.templateSpans,a,e.isTemplateSpan));case 197:return e.updateYield(o,t(o.asteriskToken,u,e.isToken),t(o.expression,a,e.isExpression));case 198:return e.updateSpread(o,t(o.expression,a,e.isExpression));case 199:return e.updateClassExpression(o,c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.heritageClauses,a,e.isHeritageClause),c(o.members,a,e.isClassElement));case 201:return e.updateExpressionWithTypeArguments(o,c(o.typeArguments,a,e.isTypeNode),t(o.expression,a,e.isExpression));case 202:return e.updateAsExpression(o,t(o.expression,a,e.isExpression),t(o.type,a,e.isTypeNode));case 203:return e.updateNonNullExpression(o,t(o.expression,a,e.isExpression));case 204:return e.updateMetaProperty(o,t(o.name,a,e.isIdentifier));case 205:return e.updateTemplateSpan(o,t(o.expression,a,e.isExpression),t(o.literal,a,e.isTemplateMiddleOrTemplateTail));case 207:return e.updateBlock(o,c(o.statements,a,e.isStatement));case 208:return e.updateVariableStatement(o,c(o.modifiers,a,e.isModifier),t(o.declarationList,a,e.isVariableDeclarationList));case 210:return e.updateStatement(o,t(o.expression,a,e.isExpression));case 211:return e.updateIf(o,t(o.expression,a,e.isExpression),t(o.thenStatement,a,e.isStatement,e.liftToBlock),t(o.elseStatement,a,e.isStatement,e.liftToBlock));case 212:return e.updateDo(o,t(o.statement,a,e.isStatement,e.liftToBlock),t(o.expression,a,e.isExpression));case 213:return e.updateWhile(o,t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 214:return e.updateFor(o,t(o.initializer,a,e.isForInitializer),t(o.condition,a,e.isExpression),t(o.incrementor,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 215:return e.updateForIn(o,t(o.initializer,a,e.isForInitializer),t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 216:return e.updateForOf(o,o.awaitModifier,t(o.initializer,a,e.isForInitializer),t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 217:return e.updateContinue(o,t(o.label,a,e.isIdentifier));case 218:return e.updateBreak(o,t(o.label,a,e.isIdentifier));case 219:return e.updateReturn(o,t(o.expression,a,e.isExpression));case 220:return e.updateWith(o,t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 221:return e.updateSwitch(o,t(o.expression,a,e.isExpression),t(o.caseBlock,a,e.isCaseBlock));case 222:return e.updateLabel(o,t(o.label,a,e.isIdentifier),t(o.statement,a,e.isStatement,e.liftToBlock));case 223:return e.updateThrow(o,t(o.expression,a,e.isExpression));case 224:return e.updateTry(o,t(o.tryBlock,a,e.isBlock),t(o.catchClause,a,e.isCatchClause),t(o.finallyBlock,a,e.isBlock));case 226:return e.updateVariableDeclaration(o,t(o.name,a,e.isBindingName),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 227:return e.updateVariableDeclarationList(o,c(o.declarations,a,e.isVariableDeclaration));case 228:return e.updateFunctionDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.asteriskToken,u,e.isToken),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),r(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 229:return e.updateClassDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.heritageClauses,a,e.isHeritageClause),c(o.members,a,e.isClassElement));case 230:return e.updateInterfaceDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.heritageClauses,a,e.isHeritageClause),c(o.members,a,e.isTypeElement));case 231:return e.updateTypeAliasDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),t(o.type,a,e.isTypeNode));case 232:return e.updateEnumDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.members,a,e.isEnumMember));case 233:return e.updateModuleDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),t(o.body,a,e.isModuleBody));case 234:return e.updateModuleBlock(o,c(o.statements,a,e.isStatement));case 235:return e.updateCaseBlock(o,c(o.clauses,a,e.isCaseOrDefaultClause));case 236:return e.updateNamespaceExportDeclaration(o,t(o.name,a,e.isIdentifier));case 237:return e.updateImportEqualsDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),t(o.moduleReference,a,e.isModuleReference));case 238:return e.updateImportDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.importClause,a,e.isImportClause),t(o.moduleSpecifier,a,e.isExpression));case 239:return e.updateImportClause(o,t(o.name,a,e.isIdentifier),t(o.namedBindings,a,e.isNamedImportBindings));case 240:return e.updateNamespaceImport(o,t(o.name,a,e.isIdentifier));case 241:return e.updateNamedImports(o,c(o.elements,a,e.isImportSpecifier));case 242:return e.updateImportSpecifier(o,t(o.propertyName,a,e.isIdentifier),t(o.name,a,e.isIdentifier));case 243:return e.updateExportAssignment(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.expression,a,e.isExpression));case 244:return e.updateExportDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.exportClause,a,e.isNamedExports),t(o.moduleSpecifier,a,e.isExpression));case 245:return e.updateNamedExports(o,c(o.elements,a,e.isExportSpecifier));case 246:return e.updateExportSpecifier(o,t(o.propertyName,a,e.isIdentifier),t(o.name,a,e.isIdentifier));case 248:return e.updateExternalModuleReference(o,t(o.expression,a,e.isExpression));case 249:return e.updateJsxElement(o,t(o.openingElement,a,e.isJsxOpeningElement),c(o.children,a,e.isJsxChild),t(o.closingElement,a,e.isJsxClosingElement));case 250:return e.updateJsxSelfClosingElement(o,t(o.tagName,a,e.isJsxTagNameExpression),t(o.attributes,a,e.isJsxAttributes));case 251:return e.updateJsxOpeningElement(o,t(o.tagName,a,e.isJsxTagNameExpression),t(o.attributes,a,e.isJsxAttributes));case 252:return e.updateJsxClosingElement(o,t(o.tagName,a,e.isJsxTagNameExpression));case 253:return e.updateJsxAttribute(o,t(o.name,a,e.isIdentifier),t(o.initializer,a,e.isStringLiteralOrJsxExpression));case 254:return e.updateJsxAttributes(o,c(o.properties,a,e.isJsxAttributeLike));case 255:return e.updateJsxSpreadAttribute(o,t(o.expression,a,e.isExpression));case 256:return e.updateJsxExpression(o,t(o.expression,a,e.isExpression));case 257:return e.updateCaseClause(o,t(o.expression,a,e.isExpression),c(o.statements,a,e.isStatement));case 258:return e.updateDefaultClause(o,c(o.statements,a,e.isStatement));case 259:return e.updateHeritageClause(o,c(o.types,a,e.isExpressionWithTypeArguments));case 260:return e.updateCatchClause(o,t(o.variableDeclaration,a,e.isVariableDeclaration),t(o.block,a,e.isBlock));case 261:return e.updatePropertyAssignment(o,t(o.name,a,e.isPropertyName),t(o.initializer,a,e.isExpression));case 262:return e.updateShorthandPropertyAssignment(o,t(o.name,a,e.isIdentifier),t(o.objectAssignmentInitializer,a,e.isExpression));case 263:return e.updateSpreadAssignment(o,t(o.expression,a,e.isExpression));case 264:return e.updateEnumMember(o,t(o.name,a,e.isPropertyName),t(o.initializer,a,e.isExpression));case 265:return e.updateSourceFileNode(o,i(o.statements,a,l));case 288:return e.updatePartiallyEmittedExpression(o,t(o.expression,a,e.isExpression));case 289:return e.updateCommaList(o,c(o.elements,a,e.isExpression));default:return o}}}}(ts||(ts={})),function(e){function t(e,t,n){return e?t(n,e):n}function n(e,t,n){return e?t(n,e):n}function i(i,r,s,o){if(void 0===i)return r;var a=o?n:e.reduceLeft,l=o||s,c=i.kind;if(c>0&&c<=142)return r;if(c>=158&&c<=173)return r;var u=r;switch(i.kind){case 206:case 209:case 200:case 225:case 287:break;case 143:u=t(i.left,s,u),u=t(i.right,s,u);break;case 144:u=t(i.expression,s,u);break;case 146:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=t(i.type,s,u),u=t(i.initializer,s,u);break;case 147:u=t(i.expression,s,u);break;case 148:u=a(i.modifiers,l,u),u=t(i.name,s,u),u=t(i.questionToken,s,u),u=t(i.type,s,u),u=t(i.initializer,s,u);break;case 149:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=t(i.type,s,u),u=t(i.initializer,s,u);break;case 151:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.typeParameters,l,u),u=a(i.parameters,l,u),u=t(i.type,s,u),u=t(i.body,s,u);break;case 152:u=a(i.modifiers,l,u),u=a(i.parameters,l,u),u=t(i.body,s,u);break;case 153:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.parameters,l,u),u=t(i.type,s,u),u=t(i.body,s,u);break;case 154:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.parameters,l,u),u=t(i.body,s,u);break;case 174:case 175:u=a(i.elements,l,u);break;case 176:u=t(i.propertyName,s,u),u=t(i.name,s,u),u=t(i.initializer,s,u);break;case 177:u=a(i.elements,l,u);break;case 178:u=a(i.properties,l,u);break;case 179:u=t(i.expression,s,u),u=t(i.name,s,u);break;case 180:u=t(i.expression,s,u),u=t(i.argumentExpression,s,u);break;case 181:case 182:u=t(i.expression,s,u),u=a(i.typeArguments,l,u),u=a(i.arguments,l,u);break;case 183:u=t(i.tag,s,u),u=t(i.template,s,u);break;case 184:u=t(i.type,s,u),u=t(i.expression,s,u);break;case 186:u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.typeParameters,l,u),u=a(i.parameters,l,u),u=t(i.type,s,u),u=t(i.body,s,u);break;case 187:u=a(i.modifiers,l,u),u=a(i.typeParameters,l,u),u=a(i.parameters,l,u),u=t(i.type,s,u),u=t(i.body,s,u);break;case 185:case 188:case 189:case 190:case 191:case 197:case 198:case 203:u=t(i.expression,s,u);break;case 192:case 193:u=t(i.operand,s,u);break;case 194:u=t(i.left,s,u),u=t(i.right,s,u);break;case 195:u=t(i.condition,s,u),u=t(i.whenTrue,s,u),u=t(i.whenFalse,s,u);break;case 196:u=t(i.head,s,u),u=a(i.templateSpans,l,u);break;case 199:u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.typeParameters,l,u),u=a(i.heritageClauses,l,u),u=a(i.members,l,u);break;case 201:u=t(i.expression,s,u),u=a(i.typeArguments,l,u);break;case 202:u=t(i.expression,s,u),u=t(i.type,s,u);break;case 205:u=t(i.expression,s,u),u=t(i.literal,s,u);break;case 207:u=a(i.statements,l,u);break;case 208:u=a(i.modifiers,l,u),u=t(i.declarationList,s,u);break;case 210:u=t(i.expression,s,u);break;case 211:u=t(i.expression,s,u),u=t(i.thenStatement,s,u),u=t(i.elseStatement,s,u);break;case 212:u=t(i.statement,s,u),u=t(i.expression,s,u);break;case 213:case 220:u=t(i.expression,s,u),u=t(i.statement,s,u);break;case 214:u=t(i.initializer,s,u),u=t(i.condition,s,u),u=t(i.incrementor,s,u),u=t(i.statement,s,u);break;case 215:case 216:u=t(i.initializer,s,u),u=t(i.expression,s,u),u=t(i.statement,s,u);break;case 219:case 223:u=t(i.expression,s,u);break;case 221:u=t(i.expression,s,u),u=t(i.caseBlock,s,u);break;case 222:u=t(i.label,s,u),u=t(i.statement,s,u);break;case 224:u=t(i.tryBlock,s,u),u=t(i.catchClause,s,u),u=t(i.finallyBlock,s,u);break;case 226:u=t(i.name,s,u),u=t(i.type,s,u),u=t(i.initializer,s,u);break;case 227:u=a(i.declarations,l,u);break;case 228:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.typeParameters,l,u),u=a(i.parameters,l,u),u=t(i.type,s,u),u=t(i.body,s,u);break;case 229:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.typeParameters,l,u),u=a(i.heritageClauses,l,u),u=a(i.members,l,u);break;case 232:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=a(i.members,l,u);break;case 233:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=t(i.body,s,u);break;case 234:u=a(i.statements,l,u);break;case 235:u=a(i.clauses,l,u);break;case 237:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.name,s,u),u=t(i.moduleReference,s,u);break;case 238:u=a(i.decorators,l,u),u=a(i.modifiers,l,u),u=t(i.importClause,s,u),u=t(i.moduleSpecifier,s,u);break;case 239:u=t(i.name,s,u),u=t(i.namedBindings,s,u);break;case 240:u=t(i.name,s,u);break;case 241:case 245:u=a(i.elements,l,u);break;case 242:case 246:u=t(i.propertyName,s,u),u=t(i.name,s,u);break;case 243:u=e.reduceLeft(i.decorators,s,u),u=e.reduceLeft(i.modifiers,s,u),u=t(i.expression,s,u);break;case 244:u=e.reduceLeft(i.decorators,s,u),u=e.reduceLeft(i.modifiers,s,u),u=t(i.exportClause,s,u),u=t(i.moduleSpecifier,s,u);break;case 248:u=t(i.expression,s,u);break;case 249:u=t(i.openingElement,s,u),u=e.reduceLeft(i.children,s,u),u=t(i.closingElement,s,u);break;case 250:case 251:u=t(i.tagName,s,u),u=t(i.attributes,s,u);break;case 254:u=a(i.properties,l,u);break;case 252:u=t(i.tagName,s,u);break;case 253:u=t(i.name,s,u),u=t(i.initializer,s,u);break;case 255:case 256:u=t(i.expression,s,u);break;case 257:u=t(i.expression,s,u);case 258:u=a(i.statements,l,u);break;case 259:u=a(i.types,l,u);break;case 260:u=t(i.variableDeclaration,s,u),u=t(i.block,s,u);break;case 261:u=t(i.name,s,u),u=t(i.initializer,s,u);break;case 262:u=t(i.name,s,u),u=t(i.objectAssignmentInitializer,s,u);break;case 263:u=t(i.expression,s,u);break;case 264:u=t(i.name,s,u),u=t(i.initializer,s,u);break;case 265:u=a(i.statements,l,u);break;case 288:u=t(i.expression,s,u);break;case 289:u=a(i.elements,l,u)}return u}function r(t){if(void 0===t)return 0;if(536870912&t.transformFlags)return t.transformFlags&~e.getTransformFlagsSubtreeExclusions(t.kind);var n=function(t){if(e.hasModifier(t,2)||e.isTypeNode(t)&&201!==t.kind)return 0;return i(t,0,s,o)}(t);return e.computeTransformFlagsForNode(t,n)}function s(e,t){return e|r(t)}function o(e,t){return e|function(e){if(void 0===e)return 0;for(var t=0,n=0,i=0,s=e;i<s.length;i++){var o=s[i];t|=r(o),n|=-536870913&o.transformFlags}return e.transformFlags=536870912|n,t}(t)}var a;e.reduceEachChild=i,e.mergeLexicalEnvironment=function(t,n){return e.some(n)?e.isNodeArray(t)?e.setTextRange(e.createNodeArray(e.concatenate(t,n)),t):e.addRange(t,n):t},e.liftToBlock=function(t){return a.assert(e.every(t,e.isStatement),"Cannot lift nodes to a Block."),e.singleOrUndefined(t)||e.createBlock(t)},e.aggregateTransformFlags=function(e){return r(e),e},function(t){var n=!1;t.failBadSyntaxKind=t.shouldAssert(1)?function(n,i){return t.fail((i||"Unexpected node.")+"\r\nNode "+e.formatSyntaxKind(n.kind)+" was unexpected.",t.failBadSyntaxKind)}:e.noop,t.assertEachNode=t.shouldAssert(1)?function(n,i,r){return t.assert(void 0===i||e.every(n,i),r||"Unexpected node.",function(){return"Node array did not pass test '"+t.getFunctionName(i)+"'."},t.assertEachNode)}:e.noop,t.assertNode=t.shouldAssert(1)?function(n,i,r){return t.assert(void 0===i||i(n),r||"Unexpected node.",function(){return"Node "+e.formatSyntaxKind(n.kind)+" did not pass test '"+t.getFunctionName(i)+"'."},t.assertNode)}:e.noop,t.assertOptionalNode=t.shouldAssert(1)?function(n,i,r){return t.assert(void 0===i||void 0===n||i(n),r||"Unexpected node.",function(){return"Node "+e.formatSyntaxKind(n.kind)+" did not pass test '"+t.getFunctionName(i)+"'."},t.assertOptionalNode)}:e.noop,t.assertOptionalToken=t.shouldAssert(1)?function(n,i,r){return t.assert(void 0===i||void 0===n||n.kind===i,r||"Unexpected node.",function(){return"Node "+e.formatSyntaxKind(n.kind)+" was not a '"+e.formatSyntaxKind(i)+"' token."},t.assertOptionalToken)}:e.noop,t.assertMissingNode=t.shouldAssert(1)?function(n,i){return t.assert(void 0===n,i||"Unexpected node.",function(){return"Node "+e.formatSyntaxKind(n.kind)+" was unexpected'."},t.assertMissingNode)}:e.noop,t.enableDebugInfo=function(){if(!n){Object.defineProperties(e.objectAllocator.getSymbolConstructor().prototype,{__debugFlags:{get:function(){return e.formatSymbolFlags(this.flags)}}}),Object.defineProperties(e.objectAllocator.getTypeConstructor().prototype,{__debugFlags:{get:function(){return e.formatTypeFlags(this.flags)}},__debugObjectFlags:{get:function(){return 32768&this.flags?e.formatObjectFlags(this.objectFlags):""}},__debugTypeToString:{value:function(){return this.checker.typeToString(this)}}});for(var t=0,i=[e.objectAllocator.getNodeConstructor(),e.objectAllocator.getIdentifierConstructor(),e.objectAllocator.getTokenConstructor(),e.objectAllocator.getSourceFileConstructor()];t<i.length;t++){var r=i[t];r.prototype.hasOwnProperty("__debugKind")||Object.defineProperties(r.prototype,{__debugKind:{get:function(){return e.formatSyntaxKind(this.kind)}},__debugModifierFlags:{get:function(){return e.formatModifierFlags(e.getModifierFlagsNoCache(this))}},__debugTransformFlags:{get:function(){return e.formatTransformFlags(this.transformFlags)}},__debugEmitFlags:{get:function(){return e.formatEmitFlags(e.getEmitFlags(this))}},__debugGetText:{value:function(t){if(e.nodeIsSynthesized(this))return"";var n=e.getParseTreeNode(this),i=n&&e.getSourceFileOfNode(n);return i?e.getSourceTextOfNodeFromSourceFile(i,n,t):""}}})}n=!0}}}(a=e.Debug||(e.Debug={}))}(ts||(ts={})),function(e){function t(t){return(t=e.getOriginalNode(t))?e.getNodeId(t):0}function n(t,i,r){if(e.isBindingPattern(t.name))for(var s=0,o=t.name.elements;s<o.length;s++){var a=o[s];e.isOmittedExpression(a)||(r=n(a,i,r))}else if(!e.isGeneratedIdentifier(t.name)){var l=e.idText(t.name);i.get(l)||(i.set(l,!0),r=e.append(r,t.name))}return r}function i(e,t,n){var i=e[t];return i?i.push(n):e[t]=i=[n],i}e.getOriginalNodeId=t,e.collectExternalModuleInfo=function(r,s,o){for(var a,l=[],c=e.createMultiMap(),u=[],d=e.createMap(),p=!1,h=void 0,f=!1,m=0,g=r.statements;m<g.length;m++){var _=g[m];switch(_.kind){case 238:l.push(_);break;case 237:248===_.moduleReference.kind&&l.push(_);break;case 244:if(_.moduleSpecifier)_.exportClause?l.push(_):(l.push(_),f=!0);else for(var y=0,b=_.exportClause.elements;y<b.length;y++){var v=b[y];if(!d.get(e.idText(v.name))){var T=v.propertyName||v.name;c.add(e.idText(T),v),(E=s.getReferencedImportDeclaration(T)||s.getReferencedValueDeclaration(T))&&i(u,t(E),v.name),d.set(e.idText(v.name),!0),a=e.append(a,v.name)}}break;case 243:_.isExportEquals&&!h&&(h=_);break;case 208:if(e.hasModifier(_,1))for(var k=0,x=_.declarationList.declarations;k<x.length;k++){var E;a=n(E=x[k],d,a)}break;case 228:if(e.hasModifier(_,1))if(e.hasModifier(_,512))p||(i(u,t(_),e.getDeclarationName(_)),p=!0);else{T=_.name;d.get(e.idText(T))||(i(u,t(_),T),d.set(e.idText(T),!0),a=e.append(a,T))}break;case 229:if(e.hasModifier(_,1))if(e.hasModifier(_,512))p||(i(u,t(_),e.getDeclarationName(_)),p=!0);else(T=_.name)&&!d.get(e.idText(T))&&(i(u,t(_),T),d.set(e.idText(T),!0),a=e.append(a,T))}}var S=e.getOrCreateExternalHelpersModuleNameIfNeeded(r,o,f),C=S&&e.createImportDeclaration(void 0,void 0,e.createImportClause(void 0,e.createNamespaceImport(S)),e.createLiteral(e.externalHelpersModuleNameText));return C&&l.unshift(C),{externalImports:l,exportSpecifiers:c,exportEquals:h,hasExportStarsToExportValues:f,exportedBindings:u,exportedNames:a,externalHelpersImportDeclaration:C}},e.isSimpleCopiableExpression=function(t){return 9===t.kind||8===t.kind||13===t.kind||e.isKeyword(t.kind)||e.isIdentifier(t)}}(ts||(ts={})),function(e){function t(r,s,o,a,l){if(!l){var c=e.visitNode(e.getInitializerOfBindingOrAssignmentElement(s),r.visitor,e.isExpression);c?o=o?function(t,n,r,s){return n=i(t,n,!0,s),e.createConditional(e.createTypeCheck(n,"undefined"),r,n)}(r,o,c,a):c:o||(o=e.createVoidZero())}var u=e.getTargetOfBindingOrAssignmentElement(s);e.isObjectBindingOrAssignmentPattern(u)?function(r,s,o,a,l){var c,u,p=e.getElementsOfBindingOrAssignmentPattern(o),h=p.length;if(1!==h){a=i(r,a,!e.isDeclarationBindingElement(s)||0!==h,l)}for(var f=0;f<h;f++){var m=p[f];if(e.getRestIndicatorOfBindingOrAssignmentElement(m)){if(f===h-1){c&&(r.emitBindingOrAssignment(r.createObjectBindingOrAssignmentPattern(c),a,l,o),c=void 0),t(r,m,_=d(r.context,a,p,u,o),m)}}else{var g=e.getPropertyNameOfBindingOrAssignmentElement(m);if(!(r.level>=1)||1572864&m.transformFlags||1572864&e.getTargetOfBindingOrAssignmentElement(m).transformFlags||e.isComputedPropertyName(g)){c&&(r.emitBindingOrAssignment(r.createObjectBindingOrAssignmentPattern(c),a,l,o),c=void 0);var _=n(r,a,g);e.isComputedPropertyName(g)&&(u=e.append(u,_.argumentExpression)),t(r,m,_,m)}else c=e.append(c,m)}}c&&r.emitBindingOrAssignment(r.createObjectBindingOrAssignmentPattern(c),a,l,o)}(r,s,u,o,a):e.isArrayBindingOrAssignmentPattern(u)?function(n,r,s,o,a){var l,c,u=e.getElementsOfBindingOrAssignmentPattern(s),d=u.length;if(n.level<1&&n.downlevelIteration)o=i(n,e.createReadHelper(n.context,o,d>0&&e.getRestIndicatorOfBindingOrAssignmentElement(u[d-1])?void 0:d,a),!1,a);else if(1!==d&&(n.level<1||0===d)||e.every(u,e.isOmittedExpression)){o=i(n,o,!e.isDeclarationBindingElement(r)||0!==d,a)}for(var p=0;p<d;p++){var h=u[p];if(n.level>=1)if(1048576&h.transformFlags){var f=e.createTempVariable(void 0);n.hoistTempVariables&&n.context.hoistVariableDeclaration(f),c=e.append(c,[f,h]),l=e.append(l,n.createArrayBindingOrAssignmentElement(f))}else l=e.append(l,h);else{if(e.isOmittedExpression(h))continue;if(e.getRestIndicatorOfBindingOrAssignmentElement(h)){if(p===d-1){t(n,h,e.createArraySlice(o,p),h)}}else t(n,h,e.createElementAccess(o,p),h)}}l&&n.emitBindingOrAssignment(n.createArrayBindingOrAssignmentPattern(l),o,a,s);if(c)for(var m=0,g=c;m<g.length;m++){var _=g[m],y=_[0];t(n,h=_[1],y,h)}}(r,s,u,o,a):r.emitBindingOrAssignment(u,o,a,s)}function n(t,n,r){if(e.isComputedPropertyName(r)){var s=i(t,e.visitNode(r.expression,t.visitor),!1,r);return e.createElementAccess(n,s)}if(e.isStringOrNumericLiteral(r))return(s=e.getSynthesizedClone(r)).text=s.text,e.createElementAccess(n,s);var o=e.createIdentifier(e.idText(r));return e.createPropertyAccess(n,o)}function i(t,n,i,r){if(e.isIdentifier(n)&&i)return n;var s=e.createTempVariable(void 0);return t.hoistTempVariables?(t.context.hoistVariableDeclaration(s),t.emitExpression(e.setTextRange(e.createAssignment(s,n),r))):t.emitBindingOrAssignment(s,n,r,void 0),s}function r(t){return e.Debug.assertEachNode(t,e.isArrayBindingElement),e.createArrayBindingPattern(t)}function s(t){return e.createArrayLiteral(e.map(t,e.convertToArrayAssignmentElement))}function o(t){return e.Debug.assertEachNode(t,e.isBindingElement),e.createObjectBindingPattern(t)}function a(t){return e.createObjectLiteral(e.map(t,e.convertToObjectAssignmentElement))}function l(t){return e.createBindingElement(void 0,void 0,t)}function c(e){return e}!function(e){e[e.All=0]="All",e[e.ObjectRest=1]="ObjectRest"}(e.FlattenLevel||(e.FlattenLevel={})),e.flattenDestructuringAssignment=function(n,r,o,l,u,d){var p,h,f=n;if(e.isDestructuringAssignment(n))for(p=n.right;e.isEmptyArrayLiteral(n.left)||e.isEmptyObjectLiteral(n.left);){if(!e.isDestructuringAssignment(p))return p;f=n=p,p=n.right}var m={context:o,level:l,downlevelIteration:o.getCompilerOptions().downlevelIteration,hoistTempVariables:!0,emitExpression:g,emitBindingOrAssignment:function(t,n,i,s){e.Debug.assertNode(t,d?e.isIdentifier:e.isExpression);var o=d?d(t,n,i):e.setTextRange(e.createAssignment(e.visitNode(t,r,e.isExpression),n),i);o.original=s,g(o)},createArrayBindingOrAssignmentPattern:s,createObjectBindingOrAssignmentPattern:a,createArrayBindingOrAssignmentElement:c,visitor:r};if(p&&(p=e.visitNode(p,r,e.isExpression),u?p=i(m,p,!0,f):e.nodeIsSynthesized(n)&&(f=p)),t(m,n,p,f,e.isDestructuringAssignment(n)),p&&u){if(!e.some(h))return p;h.push(p)}return e.aggregateTransformFlags(e.inlineExpressions(h))||e.createOmittedExpression();function g(t){e.setEmitFlags(t,64),e.aggregateTransformFlags(t),h=e.append(h,t)}},e.flattenDestructuringBinding=function(n,i,s,a,c,u,d){var p,h=[],f=[];if(t({context:s,level:a,downlevelIteration:s.getCompilerOptions().downlevelIteration,hoistTempVariables:u,emitExpression:function(t){p=e.append(p,t)},emitBindingOrAssignment:C,createArrayBindingOrAssignmentPattern:r,createObjectBindingOrAssignmentPattern:o,createArrayBindingOrAssignmentElement:l,visitor:i},n,c,n,d),p){var m=e.createTempVariable(void 0);if(u){var g=e.inlineExpressions(p);p=void 0,C(m,g,void 0,void 0)}else{s.hoistVariableDeclaration(m);var _=e.lastOrUndefined(h);_.pendingExpressions=e.append(_.pendingExpressions,e.createAssignment(m,_.value)),e.addRange(_.pendingExpressions,p),_.value=m}}for(var y=0,b=h;y<b.length;y++){var v=b[y],T=v.pendingExpressions,k=v.name,x=(g=v.value,v.location),E=v.original,S=e.createVariableDeclaration(k,void 0,T?e.inlineExpressions(e.append(T,g)):g);S.original=E,e.setTextRange(S,x),e.isIdentifier(k)&&e.setEmitFlags(S,64),e.aggregateTransformFlags(S),f.push(S)}return f;function C(t,n,i,r){e.Debug.assertNode(t,e.isBindingName),p&&(n=e.inlineExpressions(e.append(p,n)),p=void 0),h.push({pendingExpressions:p,name:t,value:n,location:i,original:r})}};var u={name:"typescript:rest",scoped:!1,text:'\n            var __rest = (this && this.__rest) || function (s, e) {\n                var t = {};\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n                    t[p] = s[p];\n                if (s != null && typeof Object.getOwnPropertySymbols === "function")\n                    for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n                        t[p[i]] = s[p[i]];\n                return t;\n            };'};function d(t,n,i,r,s){t.requestEmitHelper(u);for(var o=[],a=0,l=0;l<i.length-1;l++){var c=e.getPropertyNameOfBindingOrAssignmentElement(i[l]);if(c)if(e.isComputedPropertyName(c)){var d=r[a];a++,o.push(e.createConditional(e.createTypeCheck(d,"symbol"),d,e.createAdd(d,e.createLiteral(""))))}else o.push(e.createLiteral(c))}return e.createCall(e.getHelperName("__rest"),void 0,[n,e.setTextRange(e.createArrayLiteral(o),s)])}}(ts||(ts={})),function(e){var t,n;function i(t,n,i,s,o,a){var l=[];return l.push(e.createArrayLiteral(n,!0)),l.push(i),s&&(l.push(s),o&&l.push(o)),t.requestEmitHelper(r),e.setTextRange(e.createCall(e.getHelperName("__decorate"),void 0,l),a)}!function(e){e[e.ClassAliases=1]="ClassAliases",e[e.NamespaceExports=2]="NamespaceExports",e[e.NonQualifiedEnumMembers=8]="NonQualifiedEnumMembers"}(t||(t={})),function(e){e[e.None=0]="None",e[e.HasStaticInitializedProperties=1]="HasStaticInitializedProperties",e[e.HasConstructorDecorators=2]="HasConstructorDecorators",e[e.HasMemberDecorators=4]="HasMemberDecorators",e[e.IsExportOfNamespace=8]="IsExportOfNamespace",e[e.IsNamedExternalExport=16]="IsNamedExternalExport",e[e.IsDefaultExternalExport=32]="IsDefaultExternalExport",e[e.IsDerivedClass=64]="IsDerivedClass",e[e.UseImmediatelyInvokedFunctionExpression=128]="UseImmediatelyInvokedFunctionExpression",e[e.HasAnyDecorators=6]="HasAnyDecorators",e[e.NeedsName=5]="NeedsName",e[e.MayNeedImmediatelyInvokedFunctionExpression=7]="MayNeedImmediatelyInvokedFunctionExpression",e[e.IsExported=56]="IsExported"}(n||(n={})),e.transformTypeScript=function(t){var n,r,o,l,c,u,d,p,h=t.startLexicalEnvironment,f=t.resumeLexicalEnvironment,m=t.endLexicalEnvironment,g=t.hoistVariableDeclaration,_=t.getEmitResolver(),y=t.getCompilerOptions(),b=void 0===y.strictNullChecks?y.strict:y.strictNullChecks,v=e.getEmitScriptTarget(y),T=e.getEmitModuleKind(y),k=t.onEmitNode,x=t.onSubstituteNode;return t.onEmitNode=function(t,i,r){var s=p,o=n;e.isSourceFile(i)&&(n=i);2&u&&function(t){return 233===e.getOriginalNode(t).kind}(i)&&(p|=2);8&u&&function(t){return 232===e.getOriginalNode(t).kind}(i)&&(p|=8);k(t,i,r),p=s,n=o},t.onSubstituteNode=function(t,n){if(n=x(t,n),1===t)return function(t){switch(t.kind){case 71:return function(t){return function(t){if(1&u&&16777216&_.getNodeCheckFlags(t)){var n=_.getReferencedValueDeclaration(t);if(n){var i=d[n.id];if(i){var r=e.getSynthesizedClone(i);return e.setSourceMapRange(r,t),e.setCommentRange(r,t),r}}}return}(t)||$e(t)||t}(t);case 179:case 180:return function(e){return Ue(e)}(t)}return t}(n);if(e.isShorthandPropertyAssignment(n))return function(t){if(2&u){var n=t.name,i=$e(n);if(i){if(t.objectAssignmentInitializer){var r=e.createAssignment(i,t.objectAssignmentInitializer);return e.setTextRange(e.createPropertyAssignment(n,r),t)}return e.setTextRange(e.createPropertyAssignment(n,i),t)}}return t}(n);return n},t.enableSubstitution(179),t.enableSubstitution(180),function(i){if(i.isDeclarationFile)return i;n=i;var r=E(i,P);return e.addEmitHelpers(r,t.readEmitHelpers()),n=void 0,r};function E(t,n){var i=l,r=c;!function(t){switch(t.kind){case 265:case 235:case 234:case 207:l=t,c=void 0;break;case 229:case 228:if(e.hasModifier(t,2))break;t.name?ye(t):e.Debug.assert(229===t.kind||e.hasModifier(t,512))}}(t);var s=n(t);return l!==i&&(c=r),l=i,s}function S(e){return E(e,C)}function C(n){return 1&n.transformFlags?L(n):2&n.transformFlags?e.visitEachChild(n,S,t):n}function w(e){return E(e,I)}function I(n){switch(n.kind){case 238:case 237:case 243:case 244:return function(n){var i=e.getParseTreeNode(n);if(i!==n)return n;switch(n.kind){case 238:return function(t){if(!t.importClause)return t;var n=e.visitNode(t.importClause,xe,e.isImportClause);return n?e.updateImportDeclaration(t,void 0,void 0,n,t.moduleSpecifier):void 0}(n);case 237:return Ie(n);case 243:return function(n){return _.isValueAliasDeclaration(n)?e.visitEachChild(n,S,t):void 0}(n);case 244:return function(t){if(!t.exportClause)return y.isolatedModules||_.moduleExportsSomeValue(t.moduleSpecifier)?t:void 0;if(!_.isValueAliasDeclaration(t))return;var n=e.visitNode(t.exportClause,Ce,e.isNamedExports);return n?e.updateExportDeclaration(t,void 0,void 0,n,t.moduleSpecifier):void 0}(n);default:e.Debug.fail("Unhandled ellided statement")}}(n);default:return C(n)}}function A(e){return E(e,N)}function N(n){if(244!==n.kind&&238!==n.kind&&239!==n.kind&&(237!==n.kind||248!==n.moduleReference.kind))return 1&n.transformFlags||e.hasModifier(n,1)?L(n):2&n.transformFlags?e.visitEachChild(n,S,t):n}function D(e){return E(e,O)}function O(t){switch(t.kind){case 152:return;case 149:case 157:case 153:case 154:case 151:return C(t);case 206:return t;default:return void e.Debug.failBadSyntaxKind(t)}}function R(t){if(!(2270&e.modifierToFlag(t.kind)||r&&84===t.kind))return t}function L(s){if(e.hasModifier(s,2)&&e.isStatement(s))return e.createNotEmittedStatement(s);switch(s.kind){case 84:case 79:return r?void 0:s;case 114:case 112:case 113:case 117:case 76:case 124:case 131:case 164:case 165:case 163:case 158:case 145:case 119:case 122:case 136:case 133:case 130:case 105:case 137:case 161:case 160:case 162:case 159:case 166:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 157:case 147:case 231:case 149:case 236:return;case 152:return function(n){if(!he(n))return;return e.updateConstructor(n,e.visitNodes(n.decorators,S,e.isDecorator),e.visitNodes(n.modifiers,S,e.isModifier),e.visitParameterList(n.parameters,S,t),e.visitFunctionBody(n.body,S,t))}(s);case 230:return e.createNotEmittedStatement(s);case 229:return function(r){var s=U(r,!0),o=function(t,n){var i=0;e.some(n)&&(i|=1);var r=e.getClassExtendsHeritageClauseElement(t);r&&95!==e.skipOuterExpressions(r.expression).kind&&(i|=64);(function(t){if(t.decorators&&t.decorators.length>0)return!0;var n=e.getFirstConstructorWithBody(t);if(n)return e.forEach(n.parameters,M);return!1})(t)&&(i|=2);e.childIsDecorated(t)&&(i|=4);Ae(t)?i|=8:!function(t){return Ne(t)&&e.hasModifier(t,512)}(t)?De(t)&&(i|=16):i|=32;v<=1&&7&i&&(i|=128);return i}(r,s);128&o&&t.startLexicalEnvironment();var a=r.name||(5&o?e.getGeneratedNameForNode(r):void 0),l=2&o?function(t,n,i){var r=e.moveRangePastDecorators(t),s=function(t){if(8388608&_.getNodeCheckFlags(t)){Be();var n=e.createUniqueName(t.name&&!e.isGeneratedIdentifier(t.name)?e.idText(t.name):"default");return d[e.getOriginalNodeId(t)]=n,g(n),n}}(t),o=e.getLocalName(t,!1,!0),a=e.visitNodes(t.heritageClauses,S,e.isHeritageClause),l=F(t,!!(64&i)),c=e.createClassExpression(void 0,n,void 0,a,l);e.setOriginalNode(c,t),e.setTextRange(c,r);var u=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(o,void 0,s?e.createAssignment(s,c):c)],1));return e.setOriginalNode(u,t),e.setTextRange(u,r),e.setCommentRange(u,t),u}(r,a,o):function(t,n,i){var r=128&i?void 0:e.visitNodes(t.modifiers,R,e.isModifier),s=e.createClassDeclaration(void 0,r,n,void 0,e.visitNodes(t.heritageClauses,S,e.isHeritageClause),F(t,!!(64&i))),o=e.getEmitFlags(t);1&i&&(o|=32);return e.setTextRange(s,t),e.setOriginalNode(s,t),e.setEmitFlags(s,o),s}(r,a,o),c=[l];1&o&&j(c,s,128&o?e.getInternalName(r):e.getLocalName(r));if(Z(c,r,!1),Z(c,r,!0),function(n,r){var s=function(n){var r=function(t){var n=t.decorators,i=J(e.getFirstConstructorWithBody(t));if(!n&&!i)return;return{decorators:n,parameters:i}}(n),s=X(n,n,r);if(!s)return;var o=d&&d[e.getOriginalNodeId(n)],a=e.getLocalName(n,!1,!0),l=i(t,s,a),c=e.createAssignment(a,o?e.createAssignment(o,l):l);return e.setEmitFlags(c,1536),e.setSourceMapRange(c,e.moveRangePastDecorators(n)),c}(r);s&&n.push(e.setOriginalNode(e.createStatement(s),r))}(c,r),128&o){var u=e.createTokenRange(e.skipTrivia(n.text,r.members.end),18),p=e.getInternalName(r),h=e.createPartiallyEmittedExpression(p);h.end=u.end,e.setEmitFlags(h,1536);var f=e.createReturn(h);f.pos=u.pos,e.setEmitFlags(f,1920),c.push(f),e.addRange(c,t.endLexicalEnvironment());var m=e.createImmediatelyInvokedArrowFunction(c);e.setEmitFlags(m,33554432);var y=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.getLocalName(r,!1,!1),void 0,m)]));e.setOriginalNode(y,r),e.setCommentRange(y,r),e.setSourceMapRange(y,e.moveRangePastDecorators(r)),e.startOnNewLine(y),c=[y]}8&o?Re(c,r):(128&o||2&o)&&(32&o?c.push(e.createExportDefault(e.getLocalName(r,!1,!0))):16&o&&c.push(e.createExternalModuleExport(e.getLocalName(r,!1,!0))));c.length>1&&(c.push(e.createEndOfDeclarationMarker(r)),e.setEmitFlags(l,4194304|e.getEmitFlags(l)));return e.singleOrMany(c)}(s);case 199:return function(t){var n=U(t,!0),i=e.visitNodes(t.heritageClauses,S,e.isHeritageClause),r=F(t,e.some(i,function(e){return 85===e.token})),s=e.createClassExpression(void 0,t.name,void 0,i,r);if(e.setOriginalNode(s,t),e.setTextRange(s,t),n.length>0){var o=[],a=e.createTempVariable(g);return 8388608&_.getNodeCheckFlags(t)&&(Be(),d[e.getOriginalNodeId(t)]=e.getSynthesizedClone(a)),e.setEmitFlags(s,65536|e.getEmitFlags(s)),o.push(e.startOnNewLine(e.createAssignment(a,s))),e.addRange(o,function(t,n){for(var i=[],r=0,s=t;r<s.length;r++){var o=s[r],a=K(o,n);a.startsOnNewLine=!0,e.setSourceMapRange(a,e.moveRangePastModifiers(o)),e.setCommentRange(a,o),i.push(a)}return i}(n,a)),o.push(e.startOnNewLine(a)),e.inlineExpressions(o)}return s}(s);case 259:return function(t){if(85===t.token){var n=e.visitNodes(t.types,S,e.isExpressionWithTypeArguments,0,1);return e.setTextRange(e.createHeritageClause(85,n),t)}return}(s);case 201:return function(t){return e.updateExpressionWithTypeArguments(t,void 0,e.visitNode(t.expression,S,e.isLeftHandSideExpression))}(s);case 151:return function(n){if(!he(n))return;var i=e.updateMethod(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),n.asteriskToken,pe(n),void 0,void 0,e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t));i!==n&&(e.setCommentRange(i,n),e.setSourceMapRange(i,e.moveRangePastDecorators(n)));return i}(s);case 153:return function(n){if(!fe(n))return;var i=e.updateGetAccessor(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),pe(n),e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t)||e.createBlock([]));i!==n&&(e.setCommentRange(i,n),e.setSourceMapRange(i,e.moveRangePastDecorators(n)));return i}(s);case 154:return function(n){if(!fe(n))return;var i=e.updateSetAccessor(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),pe(n),e.visitParameterList(n.parameters,S,t),e.visitFunctionBody(n.body,S,t)||e.createBlock([]));i!==n&&(e.setCommentRange(i,n),e.setSourceMapRange(i,e.moveRangePastDecorators(n)));return i}(s);case 228:return function(n){if(!he(n))return e.createNotEmittedStatement(n);var i=e.updateFunctionDeclaration(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t)||e.createBlock([]));if(Ae(n)){var r=[i];return Re(r,n),r}return i}(s);case 186:return function(n){if(!he(n))return e.createOmittedExpression();var i=e.updateFunctionExpression(n,e.visitNodes(n.modifiers,R,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t)||e.createBlock([]));return i}(s);case 187:return function(n){var i=e.updateArrowFunction(n,e.visitNodes(n.modifiers,R,e.isModifier),void 0,e.visitParameterList(n.parameters,S,t),void 0,n.equalsGreaterThanToken,e.visitFunctionBody(n.body,S,t));return i}(s);case 146:return function(t){if(e.parameterIsThisKeyword(t))return;var n=e.createParameter(void 0,void 0,t.dotDotDotToken,e.visitNode(t.name,S,e.isBindingName),void 0,void 0,e.visitNode(t.initializer,S,e.isExpression));return e.setOriginalNode(n,t),e.setTextRange(n,e.moveRangePastModifiers(t)),e.setCommentRange(n,t),e.setSourceMapRange(n,e.moveRangePastModifiers(t)),e.setEmitFlags(n.name,32),n}(s);case 185:return function(n){var i=e.skipOuterExpressions(n.expression,-3);if(e.isAssertionExpression(i)){var r=e.visitNode(n.expression,S,e.isExpression);return e.createPartiallyEmittedExpression(r,n)}return e.visitEachChild(n,S,t)}(s);case 184:case 202:return function(t){var n=e.visitNode(t.expression,S,e.isExpression);return e.createPartiallyEmittedExpression(n,t)}(s);case 181:return function(t){return e.updateCall(t,e.visitNode(t.expression,S,e.isExpression),void 0,e.visitNodes(t.arguments,S,e.isExpression))}(s);case 182:return function(t){return e.updateNew(t,e.visitNode(t.expression,S,e.isExpression),void 0,e.visitNodes(t.arguments,S,e.isExpression))}(s);case 203:return function(t){var n=e.visitNode(t.expression,S,e.isLeftHandSideExpression);return e.createPartiallyEmittedExpression(n,t)}(s);case 232:return function(t){if(!function(t){return!e.isConst(t)||y.preserveConstEnums||y.isolatedModules}(t))return;var i=[],r=2;ve(i,t)&&(T===e.ModuleKind.System&&l===n||(r|=512));var s=Me(t),a=Fe(t),c=e.hasModifier(t,1)?e.getExternalModuleOrNamespaceExportName(o,t,!1,!0):e.getLocalName(t,!1,!0),u=e.createLogicalOr(c,e.createAssignment(c,e.createObjectLiteral()));if(_e(t)){var d=e.getLocalName(t,!1,!0);u=e.createAssignment(d,u)}var p=e.createStatement(e.createCall(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,s)],void 0,function(t,n){var i=o;o=n;var r=[];return h(),e.addRange(r,e.map(t.members,ge)),e.addRange(r,m()),o=i,e.createBlock(e.setTextRange(e.createNodeArray(r),t.members),!0)}(t,a)),void 0,[u]));return e.setOriginalNode(p,t),e.setTextRange(p,t),e.setEmitFlags(p,r),i.push(p),i.push(e.createEndOfDeclarationMarker(t)),i}(s);case 208:return function(n){if(Ae(n)){var i=e.getInitializedVariables(n.declarationList);if(0===i.length)return;return e.setTextRange(e.createStatement(e.inlineExpressions(e.map(i,me))),n)}return e.visitEachChild(n,S,t)}(s);case 226:return function(t){return e.updateVariableDeclaration(t,e.visitNode(t.name,S,e.isBindingName),void 0,e.visitNode(t.initializer,S,e.isExpression))}(s);case 233:return Te(s);case 237:return Ie(s);default:return e.Debug.failBadSyntaxKind(s),e.visitEachChild(s,S,t)}}function P(n){var i=(void 0===y.alwaysStrict?y.strict:y.alwaysStrict)&&!(e.isExternalModule(n)&&T>=e.ModuleKind.ES2015);return e.updateSourceFileNode(n,e.visitLexicalEnvironment(n.statements,w,t,0,i))}function M(e){return void 0!==e.decorators&&e.decorators.length>0}function F(n,i){var r=[],s=function(n,i){var r=e.forEach(n.members,H),s=262144&n.transformFlags,o=e.getFirstConstructorWithBody(n);if(!r&&!s)return e.visitEachChild(o,S,t);var a=function(n){return e.visitParameterList(n&&n.parameters,S,t)||[]}(o),l=function(t,n,i){var r=[],s=0;if(f(),n){s=function(t,n){if(t.body){var i=t.body.statements,r=e.addPrologue(n,i,!1,S);if(r===i.length)return r;var s=i[r];return 210===s.kind&&e.isSuperCall(s.expression)?(n.push(e.visitNode(s,S,e.isStatement)),r+1):r}return 0}(n,r);var o=function(t){return e.filter(t.parameters,B)}(n);e.addRange(r,e.map(o,$))}else i&&r.push(e.createStatement(e.createCall(e.createSuper(),void 0,[e.createSpread(e.createIdentifier("arguments"))])));var a=U(t,!1);j(r,a,e.createThis()),n&&e.addRange(r,e.visitNodes(n.body.statements,S,e.isStatement,s));return r=e.mergeLexicalEnvironment(r,m()),e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(r),n?n.body.statements:t.members),!0),n?n.body:void 0)}(n,o,i);return e.startOnNewLine(e.setOriginalNode(e.setTextRange(e.createConstructor(void 0,void 0,a,l),o||n),o))}(n,i);return s&&r.push(s),e.addRange(r,e.visitNodes(n.members,D,e.isClassElement)),e.setTextRange(e.createNodeArray(r),n.members)}function B(t){return e.hasModifier(t,92)&&e.isIdentifier(t.name)}function $(t){e.Debug.assert(e.isIdentifier(t.name));var n=t.name,i=e.getMutableClone(n);e.setEmitFlags(i,1584);var r=e.getMutableClone(n);return e.setEmitFlags(r,1536),e.startOnNewLine(e.setTextRange(e.createStatement(e.createAssignment(e.setTextRange(e.createPropertyAccess(e.createThis(),i),t.name),r)),e.moveRangePos(t,-1)))}function U(t,n){return e.filter(t.members,n?V:H)}function V(e){return G(e,!0)}function H(e){return G(e,!1)}function G(t,n){return 149===t.kind&&n===e.hasModifier(t,32)&&void 0!==t.initializer}function j(t,n,i){for(var r=0,s=n;r<s.length;r++){var o=s[r],a=e.createStatement(K(o,i));e.setSourceMapRange(a,e.moveRangePastModifiers(o)),e.setCommentRange(a,o),t.push(a)}}function K(t,n){var i=pe(t),r=e.visitNode(t.initializer,S,e.isExpression),s=e.createMemberAccessForPropertyName(n,i,i);return e.createAssignment(s,r)}function z(e){return q(e,!0)}function W(e){return q(e,!1)}function q(t,n){return e.nodeOrChildIsDecorated(t)&&n===e.hasModifier(t,32)}function J(e){var t;if(e)for(var n=e.parameters,i=0;i<n.length;i++){var r=n[i];(t||r.decorators)&&(t||(t=new Array(n.length)),t[i]=r.decorators)}return t}function Y(t,n){switch(n.kind){case 153:case 154:return function(t,n){if(!n.body)return;var i=e.getAllAccessorDeclarations(t.members,n),r=i.firstAccessor,s=i.secondAccessor,o=i.setAccessor,a=r.decorators?r:s&&s.decorators?s:void 0;if(!a||n!==a)return;var l=a.decorators,c=J(o);if(!l&&!c)return;return{decorators:l,parameters:c}}(t,n);case 151:return function(e){if(!e.body)return;var t=e.decorators,n=J(e);if(!t&&!n)return;return{decorators:t,parameters:n}}(n);case 149:return function(e){var t=e.decorators;if(!t)return;return{decorators:t}}(n);default:return}}function X(n,i,r){if(r){var o=[];return e.addRange(o,e.map(r.decorators,ee)),e.addRange(o,e.flatMap(r.parameters,te)),function(e,n,i){(function(e,n,i){y.emitDecoratorMetadata&&(ne(e)&&i.push(s(t,"design:type",se(e))),re(e)&&i.push(s(t,"design:paramtypes",oe(e,n))),ie(e)&&i.push(s(t,"design:returntype",ae(e))))})(e,n,i)}(n,i,o),o}}function Z(t,n,i){e.addRange(t,e.map(function(t,n){for(var i,r=function(t,n){return e.filter(t.members,n?z:W)}(t,n),s=0,o=r;s<o.length;s++){var a=Q(t,o[s]);a&&(i?i.push(a):i=[a])}return i}(n,i),Oe))}function Q(n,r){var s=X(r,n,Y(n,r));if(s){var o=function(t,n){return e.hasModifier(n,32)?e.getDeclarationName(t):function(t){return e.createPropertyAccess(e.getDeclarationName(t),"prototype")}(t)}(n,r),a=de(r,!0),l=v>0?149===r.kind?e.createVoidZero():e.createNull():void 0,c=i(t,s,o,a,l,e.moveRangePastDecorators(r));return e.setEmitFlags(c,1536),c}}function ee(t){return e.visitNode(t.expression,S,e.isExpression)}function te(n,i){var r;if(n){r=[];for(var s=0,o=n;s<o.length;s++){var l=o[s],c=a(t,ee(l),i,l.expression);e.setEmitFlags(c,1536),r.push(c)}}return r}function ne(e){var t=e.kind;return 151===t||153===t||154===t||149===t}function ie(e){return 151===e.kind}function re(t){switch(t.kind){case 229:case 199:return void 0!==e.getFirstConstructorWithBody(t);case 151:case 153:case 154:return!0}return!1}function se(t){switch(t.kind){case 149:case 146:case 153:return le(t.type);case 154:return le(e.getSetAccessorTypeAnnotationNode(t));case 229:case 199:case 151:return e.createIdentifier("Function");default:return e.createVoidZero()}}function oe(t,n){var i=e.isClassLike(t)?e.getFirstConstructorWithBody(t):e.isFunctionLike(t)&&e.nodeIsPresent(t.body)?t:void 0,r=[];if(i)for(var s=function(t,n){if(n&&153===t.kind){var i=e.getAllAccessorDeclarations(n.members,t).setAccessor;if(i)return i.parameters}return t.parameters}(i,n),o=s.length,a=0;a<o;a++){var l=s[a];0===a&&e.isIdentifier(l.name)&&"this"===l.name.escapedText||(l.dotDotDotToken?r.push(le(e.getRestParameterElementType(l.type))):r.push(se(l)))}return e.createArrayLiteral(r)}function ae(t){return e.isFunctionLike(t)&&t.type?le(t.type):e.isAsyncFunction(t)?e.createIdentifier("Promise"):e.createVoidZero()}function le(t){if(void 0===t)return e.createIdentifier("Object");switch(t.kind){case 105:case 139:case 95:case 130:return e.createVoidZero();case 168:return le(t.type);case 160:case 161:return e.createIdentifier("Function");case 164:case 165:return e.createIdentifier("Array");case 158:case 122:return e.createIdentifier("Boolean");case 136:return e.createIdentifier("String");case 134:return e.createIdentifier("Object");case 173:switch(t.literal.kind){case 9:return e.createIdentifier("String");case 8:return e.createIdentifier("Number");case 101:case 86:return e.createIdentifier("Boolean");default:e.Debug.failBadSyntaxKind(t.literal)}break;case 133:return e.createIdentifier("Number");case 137:return v<2?ue():e.createIdentifier("Symbol");case 159:return function(t){switch(_.getTypeReferenceSerializationKind(t.typeName,l)){case e.TypeReferenceSerializationKind.Unknown:var n=ce(t.typeName,!0),i=e.createTempVariable(g);return e.createLogicalOr(e.createLogicalAnd(e.createTypeCheck(e.createAssignment(i,n),"function"),i),e.createIdentifier("Object"));case e.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue:return ce(t.typeName,!1);case e.TypeReferenceSerializationKind.VoidNullableOrNeverType:return e.createVoidZero();case e.TypeReferenceSerializationKind.BooleanType:return e.createIdentifier("Boolean");case e.TypeReferenceSerializationKind.NumberLikeType:return e.createIdentifier("Number");case e.TypeReferenceSerializationKind.StringLikeType:return e.createIdentifier("String");case e.TypeReferenceSerializationKind.ArrayLikeType:return e.createIdentifier("Array");case e.TypeReferenceSerializationKind.ESSymbolType:return v<2?ue():e.createIdentifier("Symbol");case e.TypeReferenceSerializationKind.TypeWithCallSignature:return e.createIdentifier("Function");case e.TypeReferenceSerializationKind.Promise:return e.createIdentifier("Promise");case e.TypeReferenceSerializationKind.ObjectType:default:return e.createIdentifier("Object")}}(t);case 167:case 166:return function(t){for(var n,i=0,r=t.types;i<r.length;i++){for(var s=r[i];168===s.kind;)s=s.type;if(130!==s.kind&&(b||95!==s.kind&&139!==s.kind)){var o=le(s);if(e.isIdentifier(o)&&"Object"===o.escapedText)return o;if(n){if(!e.isIdentifier(n)||!e.isIdentifier(o)||n.escapedText!==o.escapedText)return e.createIdentifier("Object")}else n=o}}return n||e.createVoidZero()}(t);case 162:case 170:case 171:case 172:case 163:case 119:case 169:break;default:e.Debug.failBadSyntaxKind(t)}return e.createIdentifier("Object")}function ce(t,n){switch(t.kind){case 71:var i=e.getMutableClone(t);return i.flags&=-9,i.original=void 0,i.parent=e.getParseTreeNode(l),n?e.createLogicalAnd(e.createStrictInequality(e.createTypeOf(i),e.createLiteral("undefined")),i):i;case 143:return function(t,n){var i;if(71===t.left.kind)i=ce(t.left,n);else if(n){var r=e.createTempVariable(g);i=e.createLogicalAnd(e.createAssignment(r,ce(t.left,!0)),r)}else i=ce(t.left,!1);return e.createPropertyAccess(i,t.right)}(t,n)}}function ue(){return e.createConditional(e.createTypeCheck(e.createIdentifier("Symbol"),"function"),e.createIdentifier("Symbol"),e.createIdentifier("Object"))}function de(t,n){var i=t.name;return e.isComputedPropertyName(i)?n?e.getGeneratedNameForNode(i):i.expression:e.isIdentifier(i)?e.createLiteral(e.idText(i)):e.getSynthesizedClone(i)}function pe(t){var n=t.name;if(e.isComputedPropertyName(n)){var i=e.visitNode(n.expression,S,e.isExpression);if(t.decorators){var r=e.getGeneratedNameForNode(n);g(r),i=e.createAssignment(r,i)}return e.updateComputedPropertyName(n,i)}return n}function he(t){return!e.nodeIsMissing(t.body)}function fe(t){return!(e.nodeIsMissing(t.body)&&e.hasModifier(t,128))}function me(n){var i=n.name;return e.isBindingPattern(i)?e.flattenDestructuringAssignment(n,S,t,0,!1,Le):e.setTextRange(e.createAssignment(Pe(i),e.visitNode(n.initializer,S,e.isExpression)),n)}function ge(n){var i=de(n,!1),r=function(n){var i=_.getConstantValue(n);return void 0!==i?e.createLiteral(i):(8&u||(u|=8,t.enableSubstitution(71)),n.initializer?e.visitNode(n.initializer,S,e.isExpression):e.createVoidZero())}(n),s=e.createAssignment(e.createElementAccess(o,i),r),a=9===r.kind?s:e.createAssignment(e.createElementAccess(o,s),i);return e.setTextRange(e.createStatement(e.setTextRange(a,n)),n)}function _e(t){return Ae(t)||Ne(t)&&T!==e.ModuleKind.ES2015&&T!==e.ModuleKind.ESNext&&T!==e.ModuleKind.System}function ye(t){c||(c=e.createUnderscoreEscapedMap());var n=be(t);c.has(n)||c.set(n,t)}function be(t){return e.Debug.assertNode(t.name,e.isIdentifier),t.name.escapedText}function ve(t,n){var i=e.createVariableStatement(e.visitNodes(n.modifiers,R,e.isModifier),e.createVariableDeclarationList([e.createVariableDeclaration(e.getLocalName(n,!1,!0))],265===l.kind?0:1));if(e.setOriginalNode(i,n),ye(n),function(e){if(c){var t=be(e);return c.get(t)===e}return!0}(n))return 232===n.kind?e.setSourceMapRange(i.declarationList,n):e.setSourceMapRange(i,n),e.setCommentRange(i,n),e.setEmitFlags(i,4195328),t.push(i),!0;var r=e.createMergeDeclarationMarker(i);return e.setEmitFlags(r,4195840),t.push(r),!1}function Te(i){if(!function(t){return e.isInstantiatedModule(t,y.preserveConstEnums||y.isolatedModules)}(i))return e.createNotEmittedStatement(i);e.Debug.assertNode(i.name,e.isIdentifier,"A TypeScript namespace should have an Identifier name."),2&u||(u|=2,t.enableSubstitution(71),t.enableSubstitution(262),t.enableEmitNotification(233));var s=[],a=2;ve(s,i)&&(T===e.ModuleKind.System&&l===n||(a|=512));var d=Me(i),p=Fe(i),f=e.hasModifier(i,1)?e.getExternalModuleOrNamespaceExportName(o,i,!1,!0):e.getLocalName(i,!1,!0),g=e.createLogicalOr(f,e.createAssignment(f,e.createObjectLiteral()));if(_e(i)){var _=e.getLocalName(i,!1,!0);g=e.createAssignment(_,g)}var b=e.createStatement(e.createCall(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,d)],void 0,function(t,n){var i=o,s=r,a=c;o=n,r=t,c=void 0;var l,u,d=[];h();var p=t.body;if(234===p.kind)E(p,function(t){return e.addRange(d,e.visitNodes(t.statements,A,e.isStatement))}),l=p.statements,u=p;else{var f=Te(p);f&&(e.isArray(f)?e.addRange(d,f):d.push(f));var g=ke(t).body;l=e.moveRangePos(g.statements,-1)}e.addRange(d,m()),o=i,r=s,c=a;var _=e.createBlock(e.setTextRange(e.createNodeArray(d),l),!0);e.setTextRange(_,u),234!==p.kind&&e.setEmitFlags(_,1536|e.getEmitFlags(_));return _}(i,p)),void 0,[g]));return e.setOriginalNode(b,i),e.setTextRange(b,i),e.setEmitFlags(b,a),s.push(b),s.push(e.createEndOfDeclarationMarker(i)),s}function ke(e){if(233===e.body.kind)return ke(e.body)||e.body}function xe(t){var n=_.isReferencedAliasDeclaration(t)?t.name:void 0,i=e.visitNode(t.namedBindings,Ee,e.isNamedImportBindings);return n||i?e.updateImportClause(t,n,i):void 0}function Ee(t){if(240===t.kind)return _.isReferencedAliasDeclaration(t)?t:void 0;var n=e.visitNodes(t.elements,Se,e.isImportSpecifier);return e.some(n)?e.updateNamedImports(t,n):void 0}function Se(e){return _.isReferencedAliasDeclaration(e)?e:void 0}function Ce(t){var n=e.visitNodes(t.elements,we,e.isExportSpecifier);return e.some(n)?e.updateNamedExports(t,n):void 0}function we(e){return _.isValueAliasDeclaration(e)?e:void 0}function Ie(i){if(e.isExternalModuleImportEqualsDeclaration(i))return _.isReferencedAliasDeclaration(i)?e.visitEachChild(i,S,t):void 0;if(function(t){return _.isReferencedAliasDeclaration(t)||!e.isExternalModule(n)&&_.isTopLevelValueImportEqualsWithEntityName(t)}(i)){var r=e.createExpressionFromEntityName(i.moduleReference);return e.setEmitFlags(r,3584),De(i)||!Ae(i)?e.setOriginalNode(e.setTextRange(e.createVariableStatement(e.visitNodes(i.modifiers,R,e.isModifier),e.createVariableDeclarationList([e.setOriginalNode(e.createVariableDeclaration(i.name,void 0,r),i)])),i),i):e.setOriginalNode(function(t,n,i){return e.setTextRange(e.createStatement(e.createAssignment(e.getNamespaceMemberName(o,t,!1,!0),n)),i)}(i.name,r,i),i)}}function Ae(t){return void 0!==r&&e.hasModifier(t,1)}function Ne(t){return void 0===r&&e.hasModifier(t,1)}function De(t){return Ne(t)&&!e.hasModifier(t,512)}function Oe(t){return e.createStatement(t)}function Re(t,n){var i=e.createAssignment(e.getExternalModuleOrNamespaceExportName(o,n,!1,!0),e.getLocalName(n));e.setSourceMapRange(i,e.createRange(n.name?n.name.pos:n.pos,n.end));var r=e.createStatement(i);e.setSourceMapRange(r,e.createRange(-1,n.end)),t.push(r)}function Le(t,n,i){return e.setTextRange(e.createAssignment(Pe(t),n),i)}function Pe(t){return e.getNamespaceMemberName(o,t,!1,!0)}function Me(t){var n=e.getGeneratedNameForNode(t);return e.setSourceMapRange(n,t.name),n}function Fe(t){return e.getGeneratedNameForNode(t)}function Be(){1&u||(u|=1,t.enableSubstitution(71),d=[])}function $e(t){if(u&p&&!e.isGeneratedIdentifier(t)&&!e.isLocalName(t)){var n=_.getReferencedExportContainer(t,!1);if(n&&265!==n.kind)if(2&p&&233===n.kind||8&p&&232===n.kind)return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(n),t),t)}}function Ue(t){var n=function(t){if(y.isolatedModules)return;return e.isPropertyAccessExpression(t)||e.isElementAccessExpression(t)?_.getConstantValue(t):void 0}(t);if(void 0!==n){e.setConstantValue(t,n);var i=e.createLiteral(n);if(!y.removeComments){var r=e.isPropertyAccessExpression(t)?e.declarationNameToString(t.name):e.getTextOfNode(t.argumentExpression);e.addSyntheticTrailingComment(i,3," "+r+" ")}return i}return t}};var r={name:"typescript:decorate",scoped:!1,priority:2,text:'\n            var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n                var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n                if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);\n                else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n                return c > 3 && r && Object.defineProperty(target, key, r), r;\n            };'};function s(t,n,i){return t.requestEmitHelper(o),e.createCall(e.getHelperName("__metadata"),void 0,[e.createLiteral(n),i])}var o={name:"typescript:metadata",scoped:!1,priority:3,text:'\n            var __metadata = (this && this.__metadata) || function (k, v) {\n                if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);\n            };'};function a(t,n,i,r){return t.requestEmitHelper(l),e.setTextRange(e.createCall(e.getHelperName("__param"),void 0,[e.createLiteral(i),n]),r)}var l={name:"typescript:param",scoped:!1,priority:4,text:"\n            var __param = (this && this.__param) || function (paramIndex, decorator) {\n                return function (target, key) { decorator(target, key, paramIndex); }\n            };"}}(ts||(ts={})),function(e){var t;!function(e){e[e.AsyncMethodsWithSuper=1]="AsyncMethodsWithSuper"}(t||(t={})),e.transformES2017=function(t){var n,r=t.startLexicalEnvironment,s=t.resumeLexicalEnvironment,o=t.endLexicalEnvironment,a=t.getEmitResolver(),l=t.getCompilerOptions(),c=e.getEmitScriptTarget(l),u=0,d=t.onEmitNode,p=t.onSubstituteNode;return t.onEmitNode=function(e,t,i){if(1&n&&function(e){var t=e.kind;return 229===t||152===t||151===t||153===t||154===t}(t)){var r=6144&a.getNodeCheckFlags(t);if(r!==u){var s=u;return u=r,d(e,t,i),void(u=s)}}d(e,t,i)},t.onSubstituteNode=function(t,n){if(n=p(t,n),1===t&&u)return function(t){switch(t.kind){case 179:return _(t);case 180:return y(t);case 181:return function(t){var n=t.expression;if(e.isSuperProperty(n)){var i=e.isPropertyAccessExpression(n)?_(n):y(n);return e.createCall(e.createPropertyAccess(i,"call"),void 0,[e.createThis()].concat(t.arguments))}return t}(t)}return t}(n);return n},function(n){if(n.isDeclarationFile)return n;var i=e.visitEachChild(n,h,t);return e.addEmitHelpers(i,t.readEmitHelpers()),i};function h(n){if(!(16&n.transformFlags))return n;switch(n.kind){case 120:return;case 191:return function(t){return e.setOriginalNode(e.setTextRange(e.createYield(void 0,e.visitNode(t.expression,h,e.isExpression)),t),t)}(n);case 151:return function(n){return e.updateMethod(n,void 0,e.visitNodes(n.modifiers,h,e.isModifier),n.asteriskToken,n.name,void 0,void 0,e.visitParameterList(n.parameters,h,t),void 0,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);case 228:return function(n){return e.updateFunctionDeclaration(n,void 0,e.visitNodes(n.modifiers,h,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,h,t),void 0,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);case 186:return function(n){return e.updateFunctionExpression(n,e.visitNodes(n.modifiers,h,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,h,t),void 0,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);case 187:return function(n){return e.updateArrowFunction(n,e.visitNodes(n.modifiers,h,e.isModifier),void 0,e.visitParameterList(n.parameters,h,t),void 0,n.equalsGreaterThanToken,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);default:return e.visitEachChild(n,h,t)}}function f(n){s();var r=e.getOriginalNode(n,e.isFunctionLike).type,l=c<2?function(t){var n=t&&e.getEntityNameFromTypeNode(t);if(n&&e.isEntityName(n)){var i=a.getTypeReferenceSerializationKind(n);if(i===e.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue||i===e.TypeReferenceSerializationKind.Unknown)return n}return}(r):void 0,u=187===n.kind,d=!!(8192&a.getNodeCheckFlags(n));if(u){var p=i(t,d,l,m(n.body)),f=o();if(e.some(f)){b=e.convertToFunctionBody(p);return e.updateBlock(b,e.setTextRange(e.createNodeArray(e.concatenate(b.statements,f)),b.statements))}return p}var _=[],y=e.addPrologue(_,n.body.statements,!1,h);_.push(e.createReturn(i(t,d,l,m(n.body,y)))),e.addRange(_,o());var b=e.createBlock(_,!0);return e.setTextRange(b,n.body),c>=2&&(4096&a.getNodeCheckFlags(n)?(g(),e.addEmitHelper(b,e.advancedAsyncSuperHelper)):2048&a.getNodeCheckFlags(n)&&(g(),e.addEmitHelper(b,e.asyncSuperHelper))),b}function m(n,i){if(e.isBlock(n))return e.updateBlock(n,e.visitLexicalEnvironment(n.statements,h,t,i));r();var s=e.convertToFunctionBody(e.visitNode(n,h,e.isConciseBody)),a=o();return e.updateBlock(s,e.setTextRange(e.createNodeArray(e.concatenate(s.statements,a)),s.statements))}function g(){1&n||(n|=1,t.enableSubstitution(181),t.enableSubstitution(179),t.enableSubstitution(180),t.enableEmitNotification(229),t.enableEmitNotification(151),t.enableEmitNotification(153),t.enableEmitNotification(154),t.enableEmitNotification(152))}function _(t){return 97===t.expression.kind?b(e.createLiteral(e.idText(t.name)),t):t}function y(e){return 97===e.expression.kind?b(e.argumentExpression,e):e}function b(t,n){return 4096&u?e.setTextRange(e.createPropertyAccess(e.createCall(e.createIdentifier("_super"),void 0,[t]),"value"),n):e.setTextRange(e.createCall(e.createIdentifier("_super"),void 0,[t]),n)}};var n={name:"typescript:awaiter",scoped:!1,priority:5,text:'\n            var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n                return new (P || (P = Promise))(function (resolve, reject) {\n                    function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n                    function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\n                    function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n                    step((generator = generator.apply(thisArg, _arguments || [])).next());\n                });\n            };'};function i(t,i,r,s){t.requestEmitHelper(n);var o=e.createFunctionExpression(void 0,e.createToken(39),void 0,void 0,[],void 0,s);return(o.emitNode||(o.emitNode={})).flags|=786432,e.createCall(e.getHelperName("__awaiter"),void 0,[e.createThis(),i?e.createIdentifier("arguments"):e.createVoidZero(),r?e.createExpressionFromEntityName(r):e.createVoidZero(),o])}e.asyncSuperHelper={name:"typescript:async-super",scoped:!0,text:"\n            const _super = name => super[name];\n        "},e.advancedAsyncSuperHelper={name:"typescript:advanced-async-super",scoped:!0,text:"\n            const _super = (function (geti, seti) {\n                const cache = Object.create(null);\n                return name => cache[name] || (cache[name] = { get value() { return geti(name); }, set value(v) { seti(name, v); } });\n            })(name => super[name], (name, value) => super[name] = value);\n        "}}(ts||(ts={})),function(e){var t;!function(e){e[e.AsyncMethodsWithSuper=1]="AsyncMethodsWithSuper"}(t||(t={})),e.transformESNext=function(t){var n=t.resumeLexicalEnvironment,l=t.endLexicalEnvironment,u=t.hoistVariableDeclaration,d=t.getEmitResolver(),p=t.getCompilerOptions(),h=e.getEmitScriptTarget(p),f=t.onEmitNode;t.onEmitNode=function(e,t,n){if(1&m&&function(e){var t=e.kind;return 229===t||152===t||151===t||153===t||154===t}(t)){var i=6144&d.getNodeCheckFlags(t);if(i!==y){var r=y;return y=i,f(e,t,n),void(y=r)}}f(e,t,n)};var m,g,_=t.onSubstituteNode;t.onSubstituteNode=function(t,n){if(n=_(t,n),1===t&&y)return function(t){switch(t.kind){case 179:return A(t);case 180:return N(t);case 181:return function(t){var n=t.expression;if(e.isSuperProperty(n)){var i=e.isPropertyAccessExpression(n)?A(n):N(n);return e.createCall(e.createPropertyAccess(i,"call"),void 0,[e.createThis()].concat(t.arguments))}return t}(t)}return t}(n);return n};var y=0;return function(n){if(n.isDeclarationFile)return n;var i=e.visitEachChild(n,b,t);return e.addEmitHelpers(i,t.readEmitHelpers()),i};function b(e){return k(e,!1)}function v(e){return k(e,!0)}function T(e){if(120!==e.kind)return e}function k(n,o){if(!(8&n.transformFlags))return n;switch(n.kind){case 191:return function(n){if(2&g&&1&g)return e.setOriginalNode(e.setTextRange(e.createYield(s(t,e.visitNode(n.expression,b,e.isExpression))),n),n);return e.visitEachChild(n,b,t)}(n);case 197:return function(n){if(2&g&&1&g&&n.asteriskToken){var i=e.visitNode(n.expression,b,e.isExpression);return e.setOriginalNode(e.setTextRange(e.createYield(s(t,e.updateYield(n,n.asteriskToken,function(t,n,i){return t.requestEmitHelper(r),t.requestEmitHelper(a),e.setTextRange(e.createCall(e.getHelperName("__asyncDelegator"),void 0,[n]),i)}(t,c(t,i,i),i)))),n),n)}return e.visitEachChild(n,b,t)}(n);case 222:return function(n){if(2&g&&1&g){var i=e.unwrapInnermostStatementOfLabel(n);return 216===i.kind&&i.awaitModifier?x(i,n):e.restoreEnclosingLabel(e.visitEachChild(n,b,t),n)}return e.visitEachChild(n,b,t)}(n);case 178:return function(n){if(1048576&n.transformFlags){var r=function(t){for(var n,i=[],r=0,s=t;r<s.length;r++){var o=s[r];if(263===o.kind){n&&(i.push(e.createObjectLiteral(n)),n=void 0);var a=o.expression;i.push(e.visitNode(a,b,e.isExpression))}else if(n||(n=[]),261===o.kind){var l=o;n.push(e.createPropertyAssignment(l.name,e.visitNode(l.initializer,b,e.isExpression)))}else n.push(e.visitNode(o,b,e.isObjectLiteralElementLike))}n&&i.push(e.createObjectLiteral(n));return i}(n.properties);return r.length&&178!==r[0].kind&&r.unshift(e.createObjectLiteral()),i(t,r)}return e.visitEachChild(n,b,t)}(n);case 194:return function(n,i){if(e.isDestructuringAssignment(n)&&1048576&n.left.transformFlags)return e.flattenDestructuringAssignment(n,b,t,1,!i);if(26===n.operatorToken.kind)return e.updateBinary(n,e.visitNode(n.left,v,e.isExpression),e.visitNode(n.right,i?v:b,e.isExpression));return e.visitEachChild(n,b,t)}(n,o);case 226:return function(n){if(e.isBindingPattern(n.name)&&1048576&n.name.transformFlags)return e.flattenDestructuringBinding(n,b,t,1);return e.visitEachChild(n,b,t)}(n);case 216:return x(n,void 0);case 214:return function(t){return e.updateFor(t,e.visitNode(t.initializer,v,e.isForInitializer),e.visitNode(t.condition,b,e.isExpression),e.visitNode(t.incrementor,b,e.isExpression),e.visitNode(t.statement,b,e.isStatement))}(n);case 190:case 210:return function(n){return e.visitEachChild(n,v,t)}(n);case 152:return function(n){var i=g;g=0;var r=e.updateConstructor(n,void 0,n.modifiers,e.visitParameterList(n.parameters,b,t),C(n));return g=i,r}(n);case 151:return function(n){var i=g;g=e.getFunctionFlags(n);var r=e.updateMethod(n,void 0,1&g?e.visitNodes(n.modifiers,T,e.isModifier):n.modifiers,2&g?void 0:n.asteriskToken,e.visitNode(n.name,b,e.isPropertyName),e.visitNode(void 0,b,e.isToken),void 0,e.visitParameterList(n.parameters,b,t),void 0,2&g&&1&g?S(n):C(n));return g=i,r}(n);case 153:return function(n){var i=g;g=0;var r=e.updateGetAccessor(n,void 0,n.modifiers,e.visitNode(n.name,b,e.isPropertyName),e.visitParameterList(n.parameters,b,t),void 0,C(n));return g=i,r}(n);case 154:return function(n){var i=g;g=0;var r=e.updateSetAccessor(n,void 0,n.modifiers,e.visitNode(n.name,b,e.isPropertyName),e.visitParameterList(n.parameters,b,t),C(n));return g=i,r}(n);case 228:return function(n){var i=g;g=e.getFunctionFlags(n);var r=e.updateFunctionDeclaration(n,void 0,1&g?e.visitNodes(n.modifiers,T,e.isModifier):n.modifiers,2&g?void 0:n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,b,t),void 0,2&g&&1&g?S(n):C(n));return g=i,r}(n);case 186:return function(n){var i=g;g=e.getFunctionFlags(n);var r=e.updateFunctionExpression(n,1&g?e.visitNodes(n.modifiers,T,e.isModifier):n.modifiers,2&g?void 0:n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,b,t),void 0,2&g&&1&g?S(n):C(n));return g=i,r}(n);case 187:return function(n){var i=g;g=e.getFunctionFlags(n);var r=e.updateArrowFunction(n,n.modifiers,void 0,e.visitParameterList(n.parameters,b,t),void 0,n.equalsGreaterThanToken,C(n));return g=i,r}(n);case 146:return function(n){if(1048576&n.transformFlags)return e.updateParameter(n,void 0,void 0,n.dotDotDotToken,e.getGeneratedNameForNode(n),void 0,void 0,e.visitNode(n.initializer,b,e.isExpression));return e.visitEachChild(n,b,t)}(n);case 185:return function(n,i){return e.visitEachChild(n,i?v:b,t)}(n,o);case 260:return function(n){if(!n.variableDeclaration)return e.updateCatchClause(n,e.createVariableDeclaration(e.createTempVariable(void 0)),e.visitNode(n.block,b,e.isBlock));return e.visitEachChild(n,b,t)}(n);default:return e.visitEachChild(n,b,t)}}function x(n,i){return 1048576&n.initializer.transformFlags&&(n=function(t){var n=e.skipParentheses(t.initializer);if(e.isVariableDeclarationList(n)||e.isAssignmentPattern(n)){var i=void 0,r=void 0,s=e.createTempVariable(void 0),o=[e.createForOfBindingStatement(n,s)];return e.isBlock(t.statement)&&(e.addRange(o,t.statement.statements),i=t.statement,r=t.statement.statements),e.updateForOf(t,t.awaitModifier,e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(s),t.initializer)],1),t.initializer),t.expression,e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(o),r),!0),i))}return t}(n)),n.awaitModifier?function(n,i){var r=e.visitNode(n.expression,b,e.isExpression),s=e.isIdentifier(r)?e.getGeneratedNameForNode(r):e.createTempVariable(void 0),o=e.isIdentifier(r)?e.getGeneratedNameForNode(s):e.createTempVariable(void 0),a=e.createUniqueName("e"),l=e.getGeneratedNameForNode(a),d=e.createTempVariable(void 0),p=c(t,r,n.expression),h=e.createCall(e.createPropertyAccess(s,"next"),void 0,[]),f=e.createPropertyAccess(o,"done"),m=e.createPropertyAccess(o,"value"),g=e.createFunctionCall(d,s,[]);u(a),u(d);var _=e.setEmitFlags(e.setTextRange(e.createFor(e.setEmitFlags(e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(s,void 0,p),n.expression),e.createVariableDeclaration(o)]),n.expression),2097152),e.createComma(e.createAssignment(o,E(h)),e.createLogicalNot(f)),void 0,function(t,n){var i,r,s=e.createForOfBindingStatement(t.initializer,n),o=[e.visitNode(s,b,e.isStatement)],a=e.visitNode(t.statement,b,e.isStatement);e.isBlock(a)?(e.addRange(o,a.statements),i=a,r=a.statements):o.push(a);return e.setEmitFlags(e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(o),r),!0),i),432)}(n,E(m))),n),256);return e.createTry(e.createBlock([e.restoreEnclosingLabel(_,i)]),e.createCatchClause(e.createVariableDeclaration(l),e.setEmitFlags(e.createBlock([e.createStatement(e.createAssignment(a,e.createObjectLiteral([e.createPropertyAssignment("error",l)])))]),1)),e.createBlock([e.createTry(e.createBlock([e.setEmitFlags(e.createIf(e.createLogicalAnd(e.createLogicalAnd(o,e.createLogicalNot(f)),e.createAssignment(d,e.createPropertyAccess(s,"return"))),e.createStatement(E(g))),1)]),void 0,e.setEmitFlags(e.createBlock([e.setEmitFlags(e.createIf(a,e.createThrow(e.createPropertyAccess(a,"error"))),1)]),1))]))}(n,i):e.restoreEnclosingLabel(e.visitEachChild(n,b,t),i)}function E(n){return 1&g?e.createYield(void 0,s(t,n)):e.createAwait(n)}function S(i){n();var s=[],a=e.addPrologue(s,i.body.statements,!1,b);w(s,i),s.push(e.createReturn(function(t,n){return t.requestEmitHelper(r),t.requestEmitHelper(o),(n.emitNode||(n.emitNode={})).flags|=262144,e.createCall(e.getHelperName("__asyncGenerator"),void 0,[e.createThis(),e.createIdentifier("arguments"),n])}(t,e.createFunctionExpression(void 0,e.createToken(39),i.name&&e.getGeneratedNameForNode(i.name),void 0,[],void 0,e.updateBlock(i.body,e.visitLexicalEnvironment(i.body.statements,b,t,a)))))),e.addRange(s,l());var c=e.updateBlock(i.body,s);return h>=2&&(4096&d.getNodeCheckFlags(i)?(I(),e.addEmitHelper(c,e.advancedAsyncSuperHelper)):2048&d.getNodeCheckFlags(i)&&(I(),e.addEmitHelper(c,e.asyncSuperHelper))),c}function C(t){n();var i=0,r=[],s=e.visitNode(t.body,b,e.isConciseBody);e.isBlock(s)&&(i=e.addPrologue(r,s.statements,!1,b)),e.addRange(r,w(void 0,t));var o=l();if(i>0||e.some(r)||e.some(o)){var a=e.convertToFunctionBody(s,!0);return e.addRange(r,a.statements.slice(i)),e.addRange(r,o),e.updateBlock(a,e.setTextRange(e.createNodeArray(r),a.statements))}return s}function w(n,i){for(var r=0,s=i.parameters;r<s.length;r++){var o=s[r];if(1048576&o.transformFlags){var a=e.getGeneratedNameForNode(o),l=e.flattenDestructuringBinding(o,b,t,1,a,!1,!0);if(e.some(l)){var c=e.createVariableStatement(void 0,e.createVariableDeclarationList(l));e.setEmitFlags(c,1048576),n=e.append(n,c)}}}return n}function I(){1&m||(m|=1,t.enableSubstitution(181),t.enableSubstitution(179),t.enableSubstitution(180),t.enableEmitNotification(229),t.enableEmitNotification(151),t.enableEmitNotification(153),t.enableEmitNotification(154),t.enableEmitNotification(152))}function A(t){return 97===t.expression.kind?D(e.createLiteral(e.idText(t.name)),t):t}function N(e){return 97===e.expression.kind?D(e.argumentExpression,e):e}function D(t,n){return 4096&y?e.setTextRange(e.createPropertyAccess(e.createCall(e.createIdentifier("_super"),void 0,[t]),"value"),n):e.setTextRange(e.createCall(e.createIdentifier("_super"),void 0,[t]),n)}};var n={name:"typescript:assign",scoped:!1,priority:1,text:"\n            var __assign = (this && this.__assign) || Object.assign || function(t) {\n                for (var s, i = 1, n = arguments.length; i < n; i++) {\n                    s = arguments[i];\n                    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                        t[p] = s[p];\n                }\n                return t;\n            };"};function i(t,i){return t.getCompilerOptions().target>=2?e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"assign"),void 0,i):(t.requestEmitHelper(n),e.createCall(e.getHelperName("__assign"),void 0,i))}e.createAssignHelper=i;var r={name:"typescript:await",scoped:!1,text:"\n            var __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }\n        "};function s(t,n){return t.requestEmitHelper(r),e.createCall(e.getHelperName("__await"),void 0,[n])}var o={name:"typescript:asyncGenerator",scoped:!1,text:'\n            var __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {\n                if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");\n                var g = generator.apply(thisArg, _arguments || []), i, q = [];\n                return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;\n                function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n                function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n                function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\n                function fulfill(value) { resume("next", value); }\n                function reject(value) { resume("throw", value); }\n                function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n            };\n        '};var a={name:"typescript:asyncDelegator",scoped:!1,text:'\n            var __asyncDelegator = (this && this.__asyncDelegator) || function (o) {\n                var i, p;\n                return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;\n                function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; }; }\n            };\n        '};var l={name:"typescript:asyncValues",scoped:!1,text:'\n            var __asyncValues = (this && this.__asyncIterator) || function (o) {\n                if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");\n                var m = o[Symbol.asyncIterator];\n                return m ? m.call(o) : typeof __values === "function" ? __values(o) : o[Symbol.iterator]();\n            };\n        '};function c(t,n,i){return t.requestEmitHelper(l),e.setTextRange(e.createCall(e.getHelperName("__asyncValues"),void 0,[n]),i)}}(ts||(ts={})),function(e){e.transformJsx=function(n){var i=n.getCompilerOptions();return function(t){if(t.isDeclarationFile)return t;var i=e.visitEachChild(t,r,n);return e.addEmitHelpers(i,n.readEmitHelpers()),i};function r(t){return 4&t.transformFlags?function(t){switch(t.kind){case 249:return o(t,!1);case 250:return a(t,!1);case 256:return f(t);default:return e.visitEachChild(t,r,n)}}(t):t}function s(t){switch(t.kind){case 10:return function(t){var n=function(t){for(var n,i=0,r=-1,s=0;s<t.length;s++){var o=t.charCodeAt(s);e.isLineBreak(o)?(-1!==i&&-1!==r&&(n=d(n,t.substr(i,r-i+1))),i=-1):e.isWhiteSpaceSingleLine(o)||(r=s,-1===i&&(i=s))}return-1!==i?d(n,t.substr(i)):n}(e.getTextOfNode(t,!0));return void 0===n?void 0:e.createLiteral(n)}(t);case 256:return f(t);case 249:return o(t,!0);case 250:return a(t,!0);default:return void e.Debug.failBadSyntaxKind(t)}}function o(e,t){return l(e.openingElement,e.children,t,e)}function a(e,t){return l(e,void 0,t,e)}function l(t,r,o,a){var l,d=h(t),p=t.attributes.properties;if(0===p.length)l=e.createNull();else{var f=e.flatten(e.spanMap(p,e.isJsxSpreadAttribute,function(t,n){return n?e.map(t,c):e.createObjectLiteral(e.map(t,u))}));e.isJsxSpreadAttribute(p[0])&&f.unshift(e.createObjectLiteral()),(l=e.singleOrUndefined(f))||(l=e.createAssignHelper(n,f))}var m=e.createExpressionForJsxElement(n.getEmitResolver().getJsxFactoryEntity(),i.reactNamespace,d,l,e.mapDefined(r,s),t,a);return o&&e.startOnNewLine(m),m}function c(t){return e.visitNode(t.expression,r,e.isExpression)}function u(t){var n=function(t){var n=t.name,i=e.idText(n);return/^[A-Za-z_]\w*$/.test(i)?n:e.createLiteral(i)}(t),i=function(t){if(void 0===t)return e.createTrue();if(9===t.kind){var n=function(e){var t=p(e);return t===e?void 0:t}(t.text);return n?e.setTextRange(e.createLiteral(n),t):t}if(256===t.kind)return void 0===t.expression?e.createTrue():f(t);e.Debug.failBadSyntaxKind(t)}(t.initializer);return e.createPropertyAssignment(n,i)}function d(e,t){var n=p(t);return void 0===e?n:e+" "+n}function p(e){return e.replace(/&((#((\d+)|x([\da-fA-F]+)))|(\w+));/g,function(e,n,i,r,s,o,a){if(s)return String.fromCharCode(parseInt(s,10));if(o)return String.fromCharCode(parseInt(o,16));var l=t.get(a);return l?String.fromCharCode(l):e})}function h(t){if(249===t.kind)return h(t.openingElement);var n=t.tagName;return e.isIdentifier(n)&&e.isIntrinsicJsxName(n.escapedText)?e.createLiteral(e.idText(n)):e.createExpressionFromEntityName(n)}function f(t){return e.visitNode(t.expression,r,e.isExpression)}};var t=e.createMapFromTemplate({quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830})}(ts||(ts={})),function(e){e.transformES2016=function(t){var n=t.hoistVariableDeclaration;return function(n){if(n.isDeclarationFile)return n;return e.visitEachChild(n,i,t)};function i(r){return 32&r.transformFlags?194===r.kind?function(r){switch(r.operatorToken.kind){case 62:return function(t){var r,s,o=e.visitNode(t.left,i,e.isExpression),a=e.visitNode(t.right,i,e.isExpression);if(e.isElementAccessExpression(o)){var l=e.createTempVariable(n),c=e.createTempVariable(n);r=e.setTextRange(e.createElementAccess(e.setTextRange(e.createAssignment(l,o.expression),o.expression),e.setTextRange(e.createAssignment(c,o.argumentExpression),o.argumentExpression)),o),s=e.setTextRange(e.createElementAccess(l,c),o)}else if(e.isPropertyAccessExpression(o)){l=e.createTempVariable(n);r=e.setTextRange(e.createPropertyAccess(e.setTextRange(e.createAssignment(l,o.expression),o.expression),o.name),o),s=e.setTextRange(e.createPropertyAccess(l,o.name),o)}else r=o,s=o;return e.setTextRange(e.createAssignment(r,e.createMathPow(s,a,t)),t)}(r);case 40:return function(t){var n=e.visitNode(t.left,i,e.isExpression),r=e.visitNode(t.right,i,e.isExpression);return e.createMathPow(n,r,t)}(r);default:return e.visitEachChild(r,i,t)}}(r):e.visitEachChild(r,i,t):r}}}(ts||(ts={})),function(e){var t,n,i,r,s;!function(e){e[e.CapturedThis=1]="CapturedThis",e[e.BlockScopedBindings=2]="BlockScopedBindings"}(t||(t={})),function(e){e[e.ToOriginal=0]="ToOriginal",e[e.ToOutParameter=1]="ToOutParameter"}(n||(n={})),function(e){e[e.Break=2]="Break",e[e.Continue=4]="Continue",e[e.Return=8]="Return"}(i||(i={})),function(e){e[e.NoReplacement=0]="NoReplacement",e[e.ReplaceSuperCapture=1]="ReplaceSuperCapture",e[e.ReplaceWithReturn=2]="ReplaceWithReturn"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Function=1]="Function",e[e.ArrowFunction=2]="ArrowFunction",e[e.AsyncFunctionBody=4]="AsyncFunctionBody",e[e.NonStaticClassElement=8]="NonStaticClassElement",e[e.CapturesThis=16]="CapturesThis",e[e.ExportedVariableStatement=32]="ExportedVariableStatement",e[e.TopLevel=64]="TopLevel",e[e.Block=128]="Block",e[e.IterationStatement=256]="IterationStatement",e[e.IterationStatementBlock=512]="IterationStatementBlock",e[e.ForStatement=1024]="ForStatement",e[e.ForInOrForOfStatement=2048]="ForInOrForOfStatement",e[e.ConstructorWithCapturedSuper=4096]="ConstructorWithCapturedSuper",e[e.ComputedPropertyName=8192]="ComputedPropertyName",e[e.AncestorFactsMask=16383]="AncestorFactsMask",e[e.BlockScopeIncludes=0]="BlockScopeIncludes",e[e.BlockScopeExcludes=4032]="BlockScopeExcludes",e[e.SourceFileIncludes=64]="SourceFileIncludes",e[e.SourceFileExcludes=3968]="SourceFileExcludes",e[e.FunctionIncludes=65]="FunctionIncludes",e[e.FunctionExcludes=16286]="FunctionExcludes",e[e.AsyncFunctionBodyIncludes=69]="AsyncFunctionBodyIncludes",e[e.AsyncFunctionBodyExcludes=16278]="AsyncFunctionBodyExcludes",e[e.ArrowFunctionIncludes=66]="ArrowFunctionIncludes",e[e.ArrowFunctionExcludes=16256]="ArrowFunctionExcludes",e[e.ConstructorIncludes=73]="ConstructorIncludes",e[e.ConstructorExcludes=16278]="ConstructorExcludes",e[e.DoOrWhileStatementIncludes=256]="DoOrWhileStatementIncludes",e[e.DoOrWhileStatementExcludes=0]="DoOrWhileStatementExcludes",e[e.ForStatementIncludes=1280]="ForStatementIncludes",e[e.ForStatementExcludes=3008]="ForStatementExcludes",e[e.ForInOrForOfStatementIncludes=2304]="ForInOrForOfStatementIncludes",e[e.ForInOrForOfStatementExcludes=1984]="ForInOrForOfStatementExcludes",e[e.BlockIncludes=128]="BlockIncludes",e[e.BlockExcludes=3904]="BlockExcludes",e[e.IterationStatementBlockIncludes=512]="IterationStatementBlockIncludes",e[e.IterationStatementBlockExcludes=4032]="IterationStatementBlockExcludes",e[e.ComputedPropertyNameIncludes=8192]="ComputedPropertyNameIncludes",e[e.ComputedPropertyNameExcludes=0]="ComputedPropertyNameExcludes",e[e.NewTarget=16384]="NewTarget",e[e.NewTargetInComputedPropertyName=32768]="NewTargetInComputedPropertyName",e[e.SubtreeFactsMask=-16384]="SubtreeFactsMask",e[e.PropagateNewTargetMask=49152]="PropagateNewTargetMask"}(s||(s={})),e.transformES2015=function(t){var n,i,r,s,l,c,u=t.startLexicalEnvironment,d=t.resumeLexicalEnvironment,p=t.endLexicalEnvironment,h=t.hoistVariableDeclaration,f=t.getCompilerOptions(),m=t.getEmitResolver(),g=t.onSubstituteNode,_=t.onEmitNode;return t.onEmitNode=function(t,n,i){if(1&c&&e.isFunctionLike(n)){var r=y(16286,8&e.getEmitFlags(n)?81:65);return _(t,n,i),void b(r,0,0)}_(t,n,i)},t.onSubstituteNode=function(t,n){if(n=g(t,n),1===t)return function(t){switch(t.kind){case 71:return function(t){if(2&c&&!e.isInternalName(t)){var n=m.getReferencedDeclarationWithCollidingName(t);if(n&&(!e.isClassLike(n)||!function(t,n){var i=e.getParseTreeNode(n);if(!i||i===t||i.end<=t.pos||i.pos>=t.end)return!1;var r=e.getEnclosingBlockScopeContainer(t);for(;i;){if(i===r||i===t)return!1;if(e.isClassElement(i)&&i.parent===t)return!0;i=i.parent}return!1}(n,t)))return e.setTextRange(e.getGeneratedNameForNode(e.getNameOfDeclaration(n)),t)}return t}(t);case 99:return function(t){if(1&c&&16&r)return e.setTextRange(e.createIdentifier("_this"),t);return t}(t)}return t}(n);if(e.isIdentifier(n))return function(t){if(2&c&&!e.isInternalName(t)){var n=e.getParseTreeNode(t,e.isIdentifier);if(n&&function(e){var t=e.parent;switch(t.kind){case 176:case 229:case 232:case 226:return t.name===e&&m.isDeclarationWithCollidingName(t)}return!1}(n))return e.setTextRange(e.getGeneratedNameForNode(n),t)}return t}(n);return n},function(o){if(o.isDeclarationFile)return o;n=o,i=o.text;var a=function(t){var n=y(3968,64),i=[];u();var r=e.addStandardPrologue(i,t.statements,!1);L(i,t),r=e.addCustomPrologue(i,t.statements,r,k),e.addRange(i,e.visitNodes(t.statements,k,e.isStatement,r)),s&&i.push(e.createVariableStatement(void 0,e.createVariableDeclarationList(s)));return e.addRange(i,p()),b(n,0,0),e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray(i),t.statements))}(o);return e.addEmitHelpers(a,t.readEmitHelpers()),n=void 0,i=void 0,s=void 0,r=0,a};function y(e,t){var n=r;return r=16383&(r&~e|t),n}function b(e,t,n){r=-16384&(r&~t|n)|e}function v(e){return 4096&r&&219===e.kind&&!e.expression}function T(t){return!!(128&t.transformFlags)||void 0!==l||4096&r&&(e.isStatement(t)||207===t.kind)||e.isIterationStatement(t,!1)&&se(t)||!!(33554432&e.getEmitFlags(t))}function k(i){return T(i)?function(i){switch(i.kind){case 115:return;case 229:return function(t){var n=e.createVariableDeclaration(e.getLocalName(t,!0),void 0,C(t));e.setOriginalNode(n,t);var i=[],r=e.createVariableStatement(void 0,e.createVariableDeclarationList([n]));if(e.setOriginalNode(r,t),e.setTextRange(r,t),e.startOnNewLine(r),i.push(r),e.hasModifier(t,1)){var s=e.hasModifier(t,512)?e.createExportDefault(e.getLocalName(t)):e.createExternalModuleExport(e.getLocalName(t));e.setOriginalNode(s,r),i.push(s)}var o=e.getEmitFlags(t);4194304&o||(i.push(e.createEndOfDeclarationMarker(t)),e.setEmitFlags(r,4194304|o));return e.singleOrMany(i)}(i);case 199:return function(e){return C(e)}(i);case 146:return function(t){return t.dotDotDotToken?void 0:e.isBindingPattern(t.name)?e.setOriginalNode(e.setTextRange(e.createParameter(void 0,void 0,void 0,e.getGeneratedNameForNode(t),void 0,void 0,void 0),t),t):t.initializer?e.setOriginalNode(e.setTextRange(e.createParameter(void 0,void 0,void 0,t.name,void 0,void 0,void 0),t),t):t}(i);case 228:return function(n){var i=l;l=void 0;var s=y(16286,65),o=e.visitParameterList(n.parameters,k,t),a=64&n.transformFlags?H(n):G(n),c=16384&r?e.getLocalName(n):n.name;return b(s,49152,0),l=i,e.updateFunctionDeclaration(n,void 0,e.visitNodes(n.modifiers,k,e.isModifier),n.asteriskToken,c,void 0,o,void 0,a)}(i);case 187:return function(n){16384&n.transformFlags&&Ee();var i=l;l=void 0;var r=y(16256,66),s=e.createFunctionExpression(void 0,void 0,void 0,void 0,e.visitParameterList(n.parameters,k,t),void 0,H(n));return e.setTextRange(s,n),e.setOriginalNode(s,n),e.setEmitFlags(s,8),b(r,0,0),l=i,s}(i);case 186:return function(n){var i=262144&e.getEmitFlags(n)?y(16278,69):y(16286,65),s=l;l=void 0;var o=e.visitParameterList(n.parameters,k,t),a=64&n.transformFlags?H(n):G(n),c=16384&r?e.getLocalName(n):n.name;return b(i,49152,0),l=s,e.updateFunctionExpression(n,void 0,n.asteriskToken,c,void 0,o,void 0,a)}(i);case 226:return q(i);case 71:return function(t){if(!l)return t;if(e.isGeneratedIdentifier(t))return t;if("arguments"!==t.escapedText||!m.isArgumentsLocalBinding(t))return t;return l.argumentsName||(l.argumentsName=e.createUniqueName("arguments"))}(i);case 227:return function(n){if(64&n.transformFlags){3&n.flags&&xe();var i=e.flatMap(n.declarations,1&n.flags?W:q),r=e.createVariableDeclarationList(i);if(e.setOriginalNode(r,n),e.setTextRange(r,n),e.setCommentRange(r,n),8388608&n.transformFlags&&(e.isBindingPattern(n.declarations[0].name)||e.isBindingPattern(e.lastOrUndefined(n.declarations).name))){var s=e.firstOrUndefined(i);if(s){var o=e.lastOrUndefined(i);e.setSourceMapRange(r,e.createRange(s.pos,o.end))}}return r}return e.visitEachChild(n,k,t)}(i);case 221:return function(n){if(void 0!==l){var i=l.allowedNonLabeledJumps;l.allowedNonLabeledJumps|=2;var r=e.visitEachChild(n,k,t);return l.allowedNonLabeledJumps=i,r}return e.visitEachChild(n,k,t)}(i);case 235:return function(n){var i=y(4032,0),r=e.visitEachChild(n,k,t);return b(i,0,0),r}(i);case 207:return j(i,!1);case 218:case 217:return function(n){if(l){var i=218===n.kind?2:4;if(!(n.label&&l.labels&&l.labels.get(e.idText(n.label))||!n.label&&l.allowedNonLabeledJumps&i)){var r=void 0;n.label?218===n.kind?(r="break-"+n.label.escapedText,ce(l,!0,e.idText(n.label),r)):(r="continue-"+n.label.escapedText,ce(l,!1,e.idText(n.label),r)):218===n.kind?(l.nonLocalJumps|=2,r="break"):(l.nonLocalJumps|=4,r="continue");var s=e.createLiteral(r);if(l.loopOutParameters.length){for(var o=l.loopOutParameters,a=void 0,c=0;c<o.length;c++){var u=ae(o[c],1);a=0===c?u:e.createBinary(a,26,u)}s=e.createBinary(a,26,s)}return e.createReturn(s)}}return e.visitEachChild(n,k,t)}(i);case 222:return function(t){l&&!l.labels&&(l.labels=e.createMap());var n=e.unwrapInnermostStatementOfLabel(t,l&&J);return e.isIterationStatement(n,!1)?function(e,t){switch(e.kind){case 212:case 213:return Z(e,t);case 214:return Q(e,t);case 215:return ee(e,t);case 216:return te(e,t)}}(n,t):e.restoreEnclosingLabel(e.visitNode(n,k,e.isStatement),t,l&&Y)}(i);case 212:case 213:return Z(i,void 0);case 214:return Q(i,void 0);case 215:return ee(i,void 0);case 216:return te(i,void 0);case 210:return function(n){switch(n.expression.kind){case 185:return e.updateStatement(n,K(n.expression,!1));case 194:return e.updateStatement(n,z(n.expression,!1))}return e.visitEachChild(n,k,t)}(i);case 178:return function(n){for(var i=n.properties,s=i.length,o=s,a=s,l=0;l<s;l++){var c=i[l];if(16777216&c.transformFlags&&4&r&&l<a&&(a=l),144===c.name.kind){o=l;break}}if(o!==s){a<o&&(o=a);var u=e.createTempVariable(h),d=[],p=e.createAssignment(u,e.setEmitFlags(e.createObjectLiteral(e.visitNodes(i,k,e.isObjectLiteralElementLike,0,o),n.multiLine),65536));return n.multiLine&&(p.startsOnNewLine=!0),d.push(p),function(t,n,i,r){for(var s=n.properties,o=s.length,a=r;a<o;a++){var l=s[a];switch(l.kind){case 153:case 154:var c=e.getAllAccessorDeclarations(n.properties,l);l===c.firstAccessor&&t.push(U(i,c,n,n.multiLine));break;case 151:t.push(fe(l,i,n,n.multiLine));break;case 261:t.push(pe(l,i,n.multiLine));break;case 262:t.push(he(l,i,n.multiLine));break;default:e.Debug.failBadSyntaxKind(n)}}}(d,n,u,o),d.push(n.multiLine?e.startOnNewLine(e.getMutableClone(u)):u),e.inlineExpressions(d)}return e.visitEachChild(n,k,t)}(i);case 260:return function(n){var i,r=y(4032,0);if(e.Debug.assert(!!n.variableDeclaration,"Catch clause variable should always be present when downleveling ES2015."),e.isBindingPattern(n.variableDeclaration.name)){var s=e.createTempVariable(void 0),o=e.createVariableDeclaration(s);e.setTextRange(o,n.variableDeclaration);var a=e.flattenDestructuringBinding(n.variableDeclaration,k,t,0,s),l=e.createVariableDeclarationList(a);e.setTextRange(l,n.variableDeclaration);var c=e.createVariableStatement(void 0,l);i=e.updateCatchClause(n,o,(u=n.block,d=c,p=e.visitNodes(u.statements,k,e.isStatement),e.updateBlock(u,[d].concat(p))))}else i=e.visitEachChild(n,k,t);var u,d,p;return b(r,0,0),i}(i);case 262:return function(t){return e.setTextRange(e.createPropertyAssignment(t.name,e.getSynthesizedClone(t.name)),t)}(i);case 144:return function(n){var i=y(0,8192),s=e.visitEachChild(n,k,t);return b(i,49152,49152&r?32768:0),s}(i);case 177:return function(n){if(64&n.transformFlags)return ge(n.elements,!0,n.multiLine,n.elements.hasTrailingComma);return e.visitEachChild(n,k,t)}(i);case 181:return function(t){if(33554432&e.getEmitFlags(t))return function(t){var n=e.cast(e.cast(e.skipOuterExpressions(t.expression),e.isArrowFunction).body,e.isBlock),i=e.visitNodes(n.statements,k,e.isStatement,0,1),r=e.visitNodes(n.statements,k,e.isStatement,1,n.statements.length-1),s=e.cast(e.firstOrUndefined(i),e.isVariableStatement).declarationList.declarations[0],o=e.skipOuterExpressions(s.initializer),a=e.tryCast(o,e.isAssignmentExpression),l=e.cast(a?e.skipOuterExpressions(a.right):o,e.isCallExpression),c=e.cast(e.skipOuterExpressions(l.expression),e.isFunctionExpression),u=c.body.statements,d=0,p=-1,h=[];if(a){var f=e.tryCast(u[d],e.isExpressionStatement);f&&(h.push(f),d++),h.push(u[d]),d++,h.push(e.createStatement(e.createAssignment(a.left,e.cast(s.name,e.isIdentifier))))}for(;!e.isReturnStatement(e.elementAt(u,p));)p--;e.addRange(h,u,d,p),p<-1&&e.addRange(h,u,p+1);return e.addRange(h,r),e.addRange(h,i,1),e.recreateOuterExpressions(t.expression,e.recreateOuterExpressions(s.initializer,e.recreateOuterExpressions(a&&a.right,e.updateCall(l,e.recreateOuterExpressions(l.expression,e.updateFunctionExpression(c,void 0,void 0,void 0,void 0,c.parameters,void 0,e.updateBlock(c.body,h))),void 0,l.arguments))))}(t);if(64&t.transformFlags)return me(t,!0);return e.updateCall(t,e.visitNode(t.expression,E,e.isExpression),void 0,e.visitNodes(t.arguments,k,e.isExpression))}(i);case 182:return function(n){if(524288&n.transformFlags){var i=e.createCallBinding(e.createPropertyAccess(n.expression,"bind"),h),r=i.target,s=i.thisArg;return e.createNew(e.createFunctionApply(e.visitNode(r,k,e.isExpression),s,ge(e.createNodeArray([e.createVoidZero()].concat(n.arguments)),!1,!1,!1)),void 0,[])}return e.visitEachChild(n,k,t)}(i);case 185:return K(i,!0);case 194:return z(i,!0);case 13:case 14:case 15:case 16:return function(t){return e.setTextRange(e.createLiteral(t.text),t)}(i);case 9:return function(t){if(t.hasExtendedUnicodeEscape)return e.setTextRange(e.createLiteral(t.text),t);return t}(i);case 8:return function(t){if(48&t.numericLiteralFlags)return e.setTextRange(e.createNumericLiteral(t.text),t);return t}(i);case 183:return function(i){var r=e.visitNode(i.tag,k,e.isExpression),o=[void 0],l=[],c=[],u=i.template;if(e.isNoSubstitutionTemplateLiteral(u))l.push(e.createLiteral(u.text)),c.push(Te(u));else{l.push(e.createLiteral(u.head.text)),c.push(Te(u.head));for(var d=0,p=u.templateSpans;d<p.length;d++){var h=p[d];l.push(e.createLiteral(h.literal.text)),c.push(Te(h.literal)),o.push(e.visitNode(h.expression,k,e.isExpression))}}var f=function(t,n,i){return t.requestEmitHelper(a),e.createCall(e.getHelperName("__makeTemplateObject"),void 0,[n,i])}(t,e.createArrayLiteral(l),e.createArrayLiteral(c));if(e.isExternalModule(n)){var m=e.createUniqueName("templateObject");g=m,s=e.append(s,e.createVariableDeclaration(g)),o[0]=e.createLogicalOr(m,e.createAssignment(m,f))}else o[0]=f;var g;return e.createCall(r,void 0,o)}(i);case 196:return function(t){var n=[];(function(t,n){if(!function(t){return e.Debug.assert(0!==t.templateSpans.length),0!==t.head.text.length||0===t.templateSpans[0].literal.text.length}(n))return;t.push(e.createLiteral(n.head.text))})(n,t),function(t,n){for(var i=0,r=n.templateSpans;i<r.length;i++){var s=r[i];t.push(e.visitNode(s.expression,k,e.isExpression)),0!==s.literal.text.length&&t.push(e.createLiteral(s.literal.text))}}(n,t);var i=e.reduceLeft(n,e.createAdd);e.nodeIsSynthesized(i)&&(i.pos=t.pos,i.end=t.end);return i}(i);case 197:return function(n){return e.visitEachChild(n,k,t)}(i);case 198:return function(t){return e.visitNode(t.expression,k,e.isExpression)}(i);case 97:return ke(!1);case 99:return function(t){if(l)return 2&r?(l.containsLexicalThis=!0,t):l.thisName||(l.thisName=e.createUniqueName("this"));return t}(i);case 204:return function(t){if(94===t.keywordToken&&"target"===t.name.escapedText)return r|=8192&r?32768:16384,e.createIdentifier("_newTarget");return t}(i);case 151:return function(t){e.Debug.assert(!e.isComputedPropertyName(t.name));var n=V(t,e.moveRangePos(t,-1),void 0,void 0);return e.setEmitFlags(n,512|e.getEmitFlags(n)),e.setTextRange(e.createPropertyAssignment(t.name,n),t)}(i);case 153:case 154:return function(n){e.Debug.assert(!e.isComputedPropertyName(n.name));var i=l;l=void 0;var r,s=y(16286,65);if(32768&n.transformFlags){var o=e.visitParameterList(n.parameters,k,t),a=H(n);r=153===n.kind?e.updateGetAccessor(n,n.decorators,n.modifiers,n.name,o,n.type,a):e.updateSetAccessor(n,n.decorators,n.modifiers,n.name,o,a)}else r=e.visitEachChild(n,k,t);return b(s,49152,0),l=i,r}(i);case 208:return function(n){var i,r=y(0,e.hasModifier(n,1)?32:0);if(!l||3&n.declarationList.flags)i=e.visitEachChild(n,k,t);else{for(var s=void 0,o=0,a=n.declarationList.declarations;o<a.length;o++){var c=a[o];if(oe(l,c),c.initializer){var u=void 0;e.isBindingPattern(c.name)?u=e.flattenDestructuringAssignment(c,k,t,0):(u=e.createBinary(c.name,58,e.visitNode(c.initializer,k,e.isExpression)),e.setTextRange(u,c)),s=e.append(s,u)}}i=s?e.setTextRange(e.createStatement(e.inlineExpressions(s)),n):void 0}return b(r,0,0),i}(i);case 219:return function(n){if(l)return l.nonLocalJumps|=8,v(n)&&(n=S(n)),e.createReturn(e.createObjectLiteral([e.createPropertyAssignment(e.createIdentifier("value"),n.expression?e.visitNode(n.expression,k,e.isExpression):e.createVoidZero())]));if(v(n))return S(n);return e.visitEachChild(n,k,t)}(i);default:return e.visitEachChild(i,k,t)}}(i):i}function x(e){return T(e)?j(e,!0):e}function E(e){return 97===e.kind?ke(!0):k(e)}function S(t){return e.setOriginalNode(e.createReturn(e.createIdentifier("_this")),t)}function C(n){n.name&&xe();var s=e.getClassExtendsHeritageClauseElement(n),a=e.createFunctionExpression(void 0,void 0,void 0,void 0,s?[e.createParameter(void 0,void 0,void 0,"_super")]:[],void 0,function(n,s){var a=[];u(),function(n,i,r){r&&n.push(e.setTextRange(e.createStatement(function(t,n){return t.requestEmitHelper(o),e.createCall(e.getHelperName("__extends"),void 0,[n,e.createIdentifier("_super")])}(t,e.getLocalName(i))),r))}(a,n,s),function(n,i,s){var o=l;l=void 0;var a=y(16278,73),c=e.getFirstConstructorWithBody(i),u=function(t,n){if(!t||!n)return!1;if(e.some(t.parameters))return!1;var i=e.firstOrUndefined(t.body.statements);if(!i||!e.nodeIsSynthesized(i)||210!==i.kind)return!1;var r=i.expression;if(!e.nodeIsSynthesized(r)||181!==r.kind)return!1;var s=r.expression;if(!e.nodeIsSynthesized(s)||97!==s.kind)return!1;var o=e.singleOrUndefined(r.arguments);if(!o||!e.nodeIsSynthesized(o)||198!==o.kind)return!1;var a=o.expression;return e.isIdentifier(a)&&"arguments"===a.escapedText}(c,void 0!==s),h=e.createFunctionDeclaration(void 0,void 0,void 0,e.getInternalName(i),void 0,function(n,i){return e.visitParameterList(n&&!i&&n.parameters,k,t)||[]}(c,u),void 0,function(t,n,i,s){var o=[];d();var a=-1;s?a=0:t&&(a=e.addStandardPrologue(o,t.body.statements,!1));t&&(N(o,t),R(o,t,s),s||(a=e.addCustomPrologue(o,t.body.statements,a,k)),e.Debug.assert(a>=0,"statementOffset not initialized correctly!"));var l=i&&95!==e.skipOuterExpressions(i.expression).kind,c=function(t,n,i,r,s){if(!i)return n&&L(t,n),0;if(!n)return t.push(e.createReturn(A())),2;if(r)return P(t,n,A()),Ee(),1;var o,a,l=n.body.statements;s<l.length&&210===(o=l[s]).kind&&e.isSuperCall(o.expression)&&(a=function(e){return me(e,!1)}(o.expression));if(a&&s===l.length-1&&!(49152&n.transformFlags)){var c=e.createReturn(a);return 194===a.kind&&181===a.left.kind||e.Debug.fail("Assumed generated super call would have form 'super.call(...) || this'."),e.setCommentRange(c,e.getCommentRange(e.setEmitFlags(a.left,1536))),t.push(c),2}if(P(t,n,a||I(),o),a)return 1;return 0}(o,t,l,s,a);1!==c&&2!==c||a++;t&&(1===c&&(r|=4096),e.addRange(o,e.visitNodes(t.body.statements,k,e.isStatement,a)));!l||2===c||t&&w(t.body)||o.push(e.createReturn(e.createIdentifier("_this")));e.addRange(o,p()),t&&M(o,t,!1);var u=e.createBlock(e.setTextRange(e.createNodeArray(o),t?t.body.statements:n.members),!0);e.setTextRange(u,t?t.body:n),t||e.setEmitFlags(u,1536);return u}(c,i,s,u));e.setTextRange(h,c||i),s&&e.setEmitFlags(h,8);n.push(h),b(a,49152,0),l=o}(a,n,s),function(t,n){for(var i=0,r=n.members;i<r.length;i++){var s=r[i];switch(s.kind){case 206:t.push(F(s));break;case 151:t.push(B(Se(n,s),s,n));break;case 153:case 154:var o=e.getAllAccessorDeclarations(n.members,s);s===o.firstAccessor&&t.push($(Se(n,s),o,n));break;case 152:break;default:e.Debug.failBadSyntaxKind(n)}}}(a,n);var c=e.createTokenRange(e.skipTrivia(i,n.members.end),18),h=e.getInternalName(n),f=e.createPartiallyEmittedExpression(h);f.end=c.end,e.setEmitFlags(f,1536);var m=e.createReturn(f);m.pos=c.pos,e.setEmitFlags(m,1920),a.push(m),e.addRange(a,p());var g=e.createBlock(e.setTextRange(e.createNodeArray(a),n.members),!0);return e.setEmitFlags(g,1536),g}(n,s));65536&e.getEmitFlags(n)&&e.setEmitFlags(a,65536);var c=e.createPartiallyEmittedExpression(a);c.end=n.end,e.setEmitFlags(c,1536);var h=e.createPartiallyEmittedExpression(c);h.end=e.skipTrivia(i,n.pos),e.setEmitFlags(h,1536);var f=e.createParen(e.createCall(h,void 0,s?[e.visitNode(s.expression,k,e.isExpression)]:[]));return e.addSyntheticLeadingComment(f,3,"* @class "),f}function w(t){if(219===t.kind)return!0;if(211===t.kind){var n=t;if(n.elseStatement)return w(n.thenStatement)&&w(n.elseStatement)}else if(207===t.kind){var i=e.lastOrUndefined(t.statements);if(i&&w(i))return!0}return!1}function I(){return e.setEmitFlags(e.createThis(),4)}function A(){return e.createLogicalOr(e.createLogicalAnd(e.createStrictInequality(e.createIdentifier("_super"),e.createNull()),e.createFunctionApply(e.createIdentifier("_super"),I(),e.createIdentifier("arguments"))),I())}function N(t,n){if(function(e){return!!(131072&e.transformFlags)}(n))for(var i=0,r=n.parameters;i<r.length;i++){var s=r[i],o=s.name,a=s.initializer;s.dotDotDotToken||(e.isBindingPattern(o)?D(t,s,o,a):a&&O(t,s,o,a))}}function D(n,i,r,s){var o=e.getGeneratedNameForNode(i);r.elements.length>0?n.push(e.setEmitFlags(e.createVariableStatement(void 0,e.createVariableDeclarationList(e.flattenDestructuringBinding(i,k,t,0,o))),1048576)):s&&n.push(e.setEmitFlags(e.createStatement(e.createAssignment(o,e.visitNode(s,k,e.isExpression))),1048576))}function O(t,n,i,r){r=e.visitNode(r,k,e.isExpression);var s=e.createIf(e.createTypeCheck(e.getSynthesizedClone(i),"undefined"),e.setEmitFlags(e.setTextRange(e.createBlock([e.createStatement(e.setTextRange(e.createAssignment(e.setEmitFlags(e.getMutableClone(i),48),e.setEmitFlags(r,48|e.getEmitFlags(r))),n))]),n),417));s.startsOnNewLine=!0,e.setTextRange(s,n),e.setEmitFlags(s,1048992),t.push(s)}function R(t,n,i){var r=e.lastOrUndefined(n.parameters);if(function(e,t){return e&&e.dotDotDotToken&&71===e.name.kind&&!t}(r,i)){var s=e.getMutableClone(r.name);e.setEmitFlags(s,48);var o=e.getSynthesizedClone(r.name),a=n.parameters.length-1,l=e.createLoopVariable();t.push(e.setEmitFlags(e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(s,void 0,e.createArrayLiteral([]))])),r),1048576));var c=e.createFor(e.setTextRange(e.createVariableDeclarationList([e.createVariableDeclaration(l,void 0,e.createLiteral(a))]),r),e.setTextRange(e.createLessThan(l,e.createPropertyAccess(e.createIdentifier("arguments"),"length")),r),e.setTextRange(e.createPostfixIncrement(l),r),e.createBlock([e.startOnNewLine(e.setTextRange(e.createStatement(e.createAssignment(e.createElementAccess(o,0===a?l:e.createSubtract(l,e.createLiteral(a))),e.createElementAccess(e.createIdentifier("arguments"),l))),r))]));e.setEmitFlags(c,1048576),e.startOnNewLine(c),t.push(c)}}function L(t,n){32768&n.transformFlags&&187!==n.kind&&P(t,n,e.createThis())}function P(t,n,i,r){Ee();var s=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration("_this",void 0,i)]));e.setEmitFlags(s,1050112),e.setTextRange(s,r),e.setSourceMapRange(s,n),t.push(s)}function M(t,n,i){if(16384&r){var s=void 0;switch(n.kind){case 187:return t;case 151:case 153:case 154:s=e.createVoidZero();break;case 152:s=e.createPropertyAccess(e.setEmitFlags(e.createThis(),4),"constructor");break;case 228:case 186:s=e.createConditional(e.createLogicalAnd(e.setEmitFlags(e.createThis(),4),e.createBinary(e.setEmitFlags(e.createThis(),4),93,e.getLocalName(n))),e.createPropertyAccess(e.setEmitFlags(e.createThis(),4),"constructor"),e.createVoidZero());break;default:e.Debug.failBadSyntaxKind(n)}var o=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration("_newTarget",void 0,s)]));if(i)return[o].concat(t);t.unshift(o)}return t}function F(t){return e.setTextRange(e.createEmptyStatement(),t)}function B(t,n,i){var s=y(0,0),o=e.getCommentRange(n),a=e.getSourceMapRange(n),l=e.createMemberAccessForPropertyName(t,e.visitNode(n.name,k,e.isPropertyName),n.name),c=V(n,n,void 0,i);e.setEmitFlags(c,1536),e.setSourceMapRange(c,a);var u=e.setTextRange(e.createStatement(e.createAssignment(l,c)),n);return e.setOriginalNode(u,n),e.setCommentRange(u,o),e.setEmitFlags(u,48),b(s,49152,49152&r?16384:0),u}function $(t,n,i){var r=e.createStatement(U(t,n,i,!1));return e.setEmitFlags(r,1536),e.setSourceMapRange(r,e.getSourceMapRange(n.firstAccessor)),r}function U(t,n,i,s){var o=n.firstAccessor,a=n.getAccessor,l=n.setAccessor,c=y(0,0),u=e.getMutableClone(t);e.setEmitFlags(u,1568),e.setSourceMapRange(u,o.name);var d=e.createExpressionForPropertyName(e.visitNode(o.name,k,e.isPropertyName));e.setEmitFlags(d,1552),e.setSourceMapRange(d,o.name);var p=[];if(a){var h=V(a,void 0,void 0,i);e.setSourceMapRange(h,e.getSourceMapRange(a)),e.setEmitFlags(h,512);var f=e.createPropertyAssignment("get",h);e.setCommentRange(f,e.getCommentRange(a)),p.push(f)}if(l){var m=V(l,void 0,void 0,i);e.setSourceMapRange(m,e.getSourceMapRange(l)),e.setEmitFlags(m,512);var g=e.createPropertyAssignment("set",m);e.setCommentRange(g,e.getCommentRange(l)),p.push(g)}p.push(e.createPropertyAssignment("enumerable",e.createTrue()),e.createPropertyAssignment("configurable",e.createTrue()));var _=e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"defineProperty"),void 0,[u,d,e.createObjectLiteral(p,!0)]);return s&&(_.startsOnNewLine=!0),b(c,49152,49152&r?16384:0),_}function V(n,i,s,o){var a=l;l=void 0;var c=o&&e.isClassLike(o)&&!e.hasModifier(n,32)?y(16286,73):y(16286,65),u=e.visitParameterList(n.parameters,k,t),d=H(n);return 16384&r&&!s&&(228===n.kind||186===n.kind)&&(s=e.getGeneratedNameForNode(n)),b(c,49152,0),l=a,e.setOriginalNode(e.setTextRange(e.createFunctionExpression(void 0,n.asteriskToken,s,void 0,u,void 0,d),i),n)}function H(i){var r,s,o,a=!1,l=!1,c=[],u=i.body;if(d(),e.isBlock(u)&&(o=e.addStandardPrologue(c,u.statements,!1)),L(c,i),N(c,i),R(c,i,!1),!a&&c.length>0&&(a=!0),e.isBlock(u))o=e.addCustomPrologue(c,u.statements,o,k),r=u.statements,e.addRange(c,e.visitNodes(u.statements,k,e.isStatement,o)),!a&&u.multiLine&&(a=!0);else{e.Debug.assert(187===i.kind),r=e.moveRangeEnd(u,-1);var p=i.equalsGreaterThanToken;e.nodeIsSynthesized(p)||e.nodeIsSynthesized(u)||(e.rangeEndIsOnSameLineAsRangeStart(p,u,n)?l=!0:a=!0);var h=e.visitNode(u,k,e.isExpression),f=e.createReturn(h);e.setTextRange(f,u),e.setEmitFlags(f,1440),c.push(f),s=u}var m=t.endLexicalEnvironment();e.addRange(c,m),M(c,i,!1),!a&&m&&m.length&&(a=!0);var g=e.createBlock(e.setTextRange(e.createNodeArray(c),r),a);return e.setTextRange(g,i.body),!a&&l&&e.setEmitFlags(g,1),s&&e.setTokenSourceMapRange(g,18,s),e.setOriginalNode(g,i.body),g}function G(n){var i=e.visitFunctionBody(n.body,x,t);return e.updateBlock(i,e.setTextRange(e.createNodeArray(M(i.statements,n,!0)),i.statements))}function j(n,i){if(i)return e.visitEachChild(n,k,t);var s=256&r?y(4032,512):y(3904,128),o=e.visitEachChild(n,k,t);return b(s,0,0),o}function K(n,i){if(!i)switch(n.expression.kind){case 185:return e.updateParen(n,K(n.expression,!1));case 194:return e.updateParen(n,z(n.expression,!1))}return e.visitEachChild(n,k,t)}function z(n,i){return e.isDestructuringAssignment(n)?e.flattenDestructuringAssignment(n,k,t,0,i):e.visitEachChild(n,k,t)}function W(n){var i=n.name;if(e.isBindingPattern(i))return q(n);if(!n.initializer&&function(e){var t=m.getNodeCheckFlags(e),n=131072&t,i=262144&t;return!(64&r||n&&i&&512&r)&&!(2048&r)&&(!m.isDeclarationWithCollidingName(e)||i&&!n&&!(3072&r))}(n)){var s=e.getMutableClone(n);return s.initializer=e.createVoidZero(),s}return e.visitEachChild(n,k,t)}function q(n){var i,r=y(32,0);return i=e.isBindingPattern(n.name)?e.flattenDestructuringBinding(n,k,t,0,void 0,!!(32&r)):e.visitEachChild(n,k,t),b(r,0,0),i}function J(t){l.labels.set(e.idText(t.label),!0)}function Y(t){l.labels.set(e.idText(t.label),!1)}function X(n,i,s,o,a){var c=y(n,i),d=function(n,i,s){if(!se(n)){var o=void 0;l&&(o=l.allowedNonLabeledJumps,l.allowedNonLabeledJumps=6);var a=s?s(n,i,void 0):e.restoreEnclosingLabel(e.visitEachChild(n,k,t),i,l&&Y);return l&&(l.allowedNonLabeledJumps=o),a}var c,d=e.createUniqueName("_loop");switch(n.kind){case 214:case 215:case 216:var h=n.initializer;h&&227===h.kind&&(c=h)}var f=[],m=[];if(c&&3&e.getCombinedNodeFlags(c))for(var g=0,_=c.declarations;g<_.length;g++){de(_[g],f,m)}var y=l;l={loopOutParameters:m},y&&(y.argumentsName&&(l.argumentsName=y.argumentsName),y.thisName&&(l.thisName=y.thisName),y.hoistedLocalVariables&&(l.hoistedLocalVariables=y.hoistedLocalVariables));u();var b=e.visitNode(n.statement,k,e.isStatement,e.liftToBlock),v=p(),T=l;if(l=y,m.length||v){var x=e.isBlock(b)?b.statements.slice():[b];m.length&&le(m,1,x),e.addRange(x,v),b=e.createBlock(x,!0)}e.isBlock(b)?b.multiLine=!0:b=e.createBlock([b],!0);var E=!!(16777216&n.statement.transformFlags),S=E&&!!(4&r),C=0;T.containsLexicalThis&&(C|=8);S&&(C|=262144);var w,I=[e.createVariableStatement(void 0,e.setEmitFlags(e.createVariableDeclarationList([e.createVariableDeclaration(d,void 0,e.setEmitFlags(e.createFunctionExpression(void 0,E?e.createToken(39):void 0,void 0,void 0,f,void 0,b),C))]),2097152))];T.argumentsName&&(y?y.argumentsName=T.argumentsName:(w||(w=[])).push(e.createVariableDeclaration(T.argumentsName,void 0,e.createIdentifier("arguments"))));T.thisName&&(y?y.thisName=T.thisName:(w||(w=[])).push(e.createVariableDeclaration(T.thisName,void 0,e.createIdentifier("this"))));if(T.hoistedLocalVariables)if(y)y.hoistedLocalVariables=T.hoistedLocalVariables;else{w||(w=[]);for(var A=0,N=T.hoistedLocalVariables;A<N.length;A++){var D=N[A];w.push(e.createVariableDeclaration(D))}}if(m.length){w||(w=[]);for(var O=0,R=m;O<R.length;O++){var L=R[O];w.push(e.createVariableDeclaration(L.outParamName))}}w&&I.push(e.createVariableStatement(void 0,e.createVariableDeclarationList(w)));var P,M=function(t,n,i,r){var s=l,o=[],a=!(-5&i.nonLocalJumps||i.labeledNonLocalBreaks||i.labeledNonLocalContinues),c=e.createCall(t,void 0,e.map(n,function(e){return e.name})),u=r?e.createYield(e.createToken(39),e.setEmitFlags(c,8388608)):c;if(a)o.push(e.createStatement(u)),le(i.loopOutParameters,0,o);else{var d=e.createUniqueName("state"),p=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(d,void 0,u)]));if(o.push(p),le(i.loopOutParameters,0,o),8&i.nonLocalJumps){var h=void 0;s?(s.nonLocalJumps|=8,h=e.createReturn(d)):h=e.createReturn(e.createPropertyAccess(d,"value")),o.push(e.createIf(e.createBinary(e.createTypeOf(d),34,e.createLiteral("object")),h))}if(2&i.nonLocalJumps&&o.push(e.createIf(e.createBinary(d,34,e.createLiteral("break")),e.createBreak())),i.labeledNonLocalBreaks||i.labeledNonLocalContinues){var f=[];ue(i.labeledNonLocalBreaks,!0,d,s,f),ue(i.labeledNonLocalContinues,!1,d,s,f),o.push(e.createSwitch(d,e.createCaseBlock(f)))}}return o}(d,f,T,E);if(s)P=s(n,i,M);else{var F=e.getMutableClone(n);F.statement=void 0,(F=e.visitEachChild(F,k,t)).statement=e.createBlock(M,!0),F.transformFlags=0,e.aggregateTransformFlags(F),P=e.restoreEnclosingLabel(F,i,l&&Y)}return I.push(P),I}(s,o,a);return b(c,0,0),d}function Z(e,t){return X(0,256,e,t)}function Q(e,t){return X(3008,1280,e,t)}function ee(e,t){return X(1984,2304,e,t)}function te(e,t){return X(1984,2304,e,t,f.downlevelIteration?re:ie)}function ne(n,i,r){var s,o,a=[];if(e.isVariableDeclarationList(n.initializer)){3&n.initializer.flags&&xe();var l=e.firstOrUndefined(n.initializer.declarations);if(l&&e.isBindingPattern(l.name)){var c=e.flattenDestructuringBinding(l,k,t,0,i),u=e.setTextRange(e.createVariableDeclarationList(c),n.initializer);e.setOriginalNode(u,n.initializer);var d=c[0],p=e.lastOrUndefined(c);e.setSourceMapRange(u,e.createRange(d.pos,p.end)),a.push(e.createVariableStatement(void 0,u))}else a.push(e.setTextRange(e.createVariableStatement(void 0,e.setOriginalNode(e.setTextRange(e.createVariableDeclarationList([e.createVariableDeclaration(l?l.name:e.createTempVariable(void 0),void 0,i)]),e.moveRangePos(n.initializer,-1)),n.initializer)),e.moveRangeEnd(n.initializer,-1)))}else{var h=e.createAssignment(n.initializer,i);e.isDestructuringAssignment(h)?(e.aggregateTransformFlags(h),a.push(e.createStatement(z(h,!1)))):(h.end=n.initializer.end,a.push(e.setTextRange(e.createStatement(e.visitNode(h,k,e.isExpression)),e.moveRangeEnd(n.initializer,-1))))}if(r)e.addRange(a,r);else{var f=e.visitNode(n.statement,k,e.isStatement,e.liftToBlock);e.isBlock(f)?(e.addRange(a,f.statements),s=f,o=f.statements):a.push(f)}return e.setEmitFlags(e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(a),o),!0),s),432)}function ie(t,n,i){var r=e.visitNode(t.expression,k,e.isExpression),s=e.createLoopVariable(),o=e.isIdentifier(r)?e.getGeneratedNameForNode(r):e.createTempVariable(void 0);e.setEmitFlags(r,48|e.getEmitFlags(r));var a=e.setTextRange(e.createFor(e.setEmitFlags(e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(s,void 0,e.createLiteral(0)),e.moveRangePos(t.expression,-1)),e.setTextRange(e.createVariableDeclaration(o,void 0,r),t.expression)]),t.expression),2097152),e.setTextRange(e.createLessThan(s,e.createPropertyAccess(o,"length")),t.expression),e.setTextRange(e.createPostfixIncrement(s),t.expression),ne(t,e.createElementAccess(o,s),i)),t);return e.setEmitFlags(a,256),e.setTextRange(a,t),e.restoreEnclosingLabel(a,n,l&&Y)}function re(n,i,r){var s=e.visitNode(n.expression,k,e.isExpression),o=e.isIdentifier(s)?e.getGeneratedNameForNode(s):e.createTempVariable(void 0),a=e.isIdentifier(s)?e.getGeneratedNameForNode(o):e.createTempVariable(void 0),c=e.createUniqueName("e"),u=e.getGeneratedNameForNode(c),d=e.createTempVariable(void 0),p=e.createValuesHelper(t,s,n.expression),f=e.createCall(e.createPropertyAccess(o,"next"),void 0,[]);h(c),h(d);var m=e.setEmitFlags(e.setTextRange(e.createFor(e.setEmitFlags(e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(o,void 0,p),n.expression),e.createVariableDeclaration(a,void 0,f)]),n.expression),2097152),e.createLogicalNot(e.createPropertyAccess(a,"done")),e.createAssignment(a,f),ne(n,e.createPropertyAccess(a,"value"),r)),n),256);return e.createTry(e.createBlock([e.restoreEnclosingLabel(m,i,l&&Y)]),e.createCatchClause(e.createVariableDeclaration(u),e.setEmitFlags(e.createBlock([e.createStatement(e.createAssignment(c,e.createObjectLiteral([e.createPropertyAssignment("error",u)])))]),1)),e.createBlock([e.createTry(e.createBlock([e.setEmitFlags(e.createIf(e.createLogicalAnd(e.createLogicalAnd(a,e.createLogicalNot(e.createPropertyAccess(a,"done"))),e.createAssignment(d,e.createPropertyAccess(o,"return"))),e.createStatement(e.createFunctionCall(d,o,[]))),1)]),void 0,e.setEmitFlags(e.createBlock([e.setEmitFlags(e.createIf(c,e.createThrow(e.createPropertyAccess(c,"error"))),1)]),1))]))}function se(e){return!!(65536&m.getNodeCheckFlags(e))}function oe(t,n){t.hoistedLocalVariables||(t.hoistedLocalVariables=[]),function n(i){if(71===i.kind)t.hoistedLocalVariables.push(i);else for(var r=0,s=i.elements;r<s.length;r++){var o=s[r];e.isOmittedExpression(o)||n(o.name)}}(n.name)}function ae(t,n){var i=0===n?t.outParamName:t.originalName,r=0===n?t.originalName:t.outParamName;return e.createBinary(r,58,i)}function le(t,n,i){for(var r=0,s=t;r<s.length;r++){var o=s[r];i.push(e.createStatement(ae(o,n)))}}function ce(t,n,i,r){n?(t.labeledNonLocalBreaks||(t.labeledNonLocalBreaks=e.createMap()),t.labeledNonLocalBreaks.set(i,r)):(t.labeledNonLocalContinues||(t.labeledNonLocalContinues=e.createMap()),t.labeledNonLocalContinues.set(i,r))}function ue(t,n,i,r,s){t&&t.forEach(function(t,o){var a=[];if(!r||r.labels&&r.labels.get(o)){var l=e.createIdentifier(o);a.push(n?e.createBreak(l):e.createContinue(l))}else ce(r,n,o,t),a.push(e.createReturn(i));s.push(e.createCaseClause(e.createLiteral(t),a))})}function de(t,n,i){var r=t.name;if(e.isBindingPattern(r))for(var s=0,o=r.elements;s<o.length;s++){var a=o[s];e.isOmittedExpression(a)||de(a,n,i)}else if(n.push(e.createParameter(void 0,void 0,void 0,r)),2097152&m.getNodeCheckFlags(t)){var l=e.createUniqueName("out_"+e.idText(r));i.push({originalName:r,outParamName:l})}}function pe(t,n,i){var r=e.createAssignment(e.createMemberAccessForPropertyName(n,e.visitNode(t.name,k,e.isPropertyName)),e.visitNode(t.initializer,k,e.isExpression));return e.setTextRange(r,t),i&&(r.startsOnNewLine=!0),r}function he(t,n,i){var r=e.createAssignment(e.createMemberAccessForPropertyName(n,e.visitNode(t.name,k,e.isPropertyName)),e.getSynthesizedClone(t.name));return e.setTextRange(r,t),i&&(r.startsOnNewLine=!0),r}function fe(t,n,i,s){var o=y(0,0),a=e.createAssignment(e.createMemberAccessForPropertyName(n,e.visitNode(t.name,k,e.isPropertyName)),V(t,t,void 0,i));return e.setTextRange(a,t),s&&(a.startsOnNewLine=!0),b(o,49152,49152&r?16384:0),a}function me(t,n){var i,r=e.createCallBinding(t.expression,h),s=r.target,o=r.thisArg;if(97===t.expression.kind&&e.setEmitFlags(o,4),i=524288&t.transformFlags?e.createFunctionApply(e.visitNode(s,E,e.isExpression),e.visitNode(o,k,e.isExpression),ge(t.arguments,!1,!1,!1)):e.createFunctionCall(e.visitNode(s,E,e.isExpression),e.visitNode(o,k,e.isExpression),e.visitNodes(t.arguments,k,e.isExpression),t),97===t.expression.kind){var a=e.createThis();e.setEmitFlags(a,4);var l=e.createLogicalOr(i,a);i=n?e.createAssignment(e.createIdentifier("_this"),l):l}return e.setOriginalNode(i,t)}function ge(n,i,r,s){var o=n.length,a=e.flatten(e.spanMap(n,_e,function(e,t,n,i){return t(e,r,s&&i===o)}));if(f.downlevelIteration){if(1===a.length){var l=a[0];if(e.isCallExpression(l)&&e.isIdentifier(l.expression)&&4096&e.getEmitFlags(l.expression)&&"___spread"===l.expression.escapedText)return a[0]}return e.createSpreadHelper(t,a)}if(1===a.length){var c=n[0];return i&&e.isSpreadElement(c)&&177!==c.expression.kind?e.createArraySlice(a[0]):a[0]}return e.createArrayConcat(a.shift(),a)}function _e(t){return e.isSpreadElement(t)?ye:be}function ye(t){return e.map(t,ve)}function be(t,n,i){return e.createArrayLiteral(e.visitNodes(e.createNodeArray(t,i),k,e.isExpression),n)}function ve(t){return e.visitNode(t.expression,k,e.isExpression)}function Te(t){var i=e.getSourceTextOfNodeFromSourceFile(n,t),r=13===t.kind||16===t.kind;return i=(i=i.substring(1,i.length-(r?1:2))).replace(/\r\n?/g,"\n"),e.setTextRange(e.createLiteral(i),t)}function ke(t){return 8&r&&!t?e.createPropertyAccess(e.createIdentifier("_super"),"prototype"):e.createIdentifier("_super")}function xe(){2&c||(c|=2,t.enableSubstitution(71))}function Ee(){1&c||(c|=1,t.enableSubstitution(99),t.enableEmitNotification(152),t.enableEmitNotification(151),t.enableEmitNotification(153),t.enableEmitNotification(154),t.enableEmitNotification(187),t.enableEmitNotification(186),t.enableEmitNotification(228))}function Se(t,n){return e.hasModifier(n,32)?e.getInternalName(t):e.createPropertyAccess(e.getInternalName(t),"prototype")}};var o={name:"typescript:extends",scoped:!1,priority:0,text:"\n            var __extends = (this && this.__extends) || (function () {\n                var extendStatics = Object.setPrototypeOf ||\n                    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n                    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n                return function (d, b) {\n                    extendStatics(d, b);\n                    function __() { this.constructor = d; }\n                    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n                };\n            })();"},a={name:"typescript:makeTemplateObject",scoped:!1,priority:0,text:'\n            var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n                if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }\n                return cooked;\n            };'}}(ts||(ts={})),function(e){e.transformES5=function(t){var n,i,r=t.getCompilerOptions();1!==r.jsx&&3!==r.jsx||(n=t.onEmitNode,t.onEmitNode=function(t,r,s){switch(r.kind){case 251:case 252:case 250:var o=r.tagName;i[e.getOriginalNodeId(o)]=!0}n(t,r,s)},t.enableEmitNotification(251),t.enableEmitNotification(252),t.enableEmitNotification(250),i=[]);var s=t.onSubstituteNode;return t.onSubstituteNode=function(t,n){if(n.id&&i&&i[n.id])return s(t,n);if(n=s(t,n),e.isPropertyAccessExpression(n))return function(t){var n=o(t.name);if(n)return e.setTextRange(e.createElementAccess(t.expression,n),t);return t}(n);if(e.isPropertyAssignment(n))return function(t){var n=e.isIdentifier(t.name)&&o(t.name);if(n)return e.updatePropertyAssignment(t,n,t.initializer);return t}(n);return n},t.enableSubstitution(179),t.enableSubstitution(261),function(e){return e};function o(t){var n=t.originalKeywordKind||(e.nodeIsSynthesized(t)?e.stringToToken(e.idText(t)):void 0);if(n>=72&&n<=107)return e.setTextRange(e.createLiteral(t),t)}}}(ts||(ts={})),function(e){var t,n,i,r,s;!function(e){e[e.Nop=0]="Nop",e[e.Statement=1]="Statement",e[e.Assign=2]="Assign",e[e.Break=3]="Break",e[e.BreakWhenTrue=4]="BreakWhenTrue",e[e.BreakWhenFalse=5]="BreakWhenFalse",e[e.Yield=6]="Yield",e[e.YieldStar=7]="YieldStar",e[e.Return=8]="Return",e[e.Throw=9]="Throw",e[e.Endfinally=10]="Endfinally"}(t||(t={})),function(e){e[e.Open=0]="Open",e[e.Close=1]="Close"}(n||(n={})),function(e){e[e.Exception=0]="Exception",e[e.With=1]="With",e[e.Switch=2]="Switch",e[e.Loop=3]="Loop",e[e.Labeled=4]="Labeled"}(i||(i={})),function(e){e[e.Try=0]="Try",e[e.Catch=1]="Catch",e[e.Finally=2]="Finally",e[e.Done=3]="Done"}(r||(r={})),function(e){e[e.Next=0]="Next",e[e.Throw=1]="Throw",e[e.Return=2]="Return",e[e.Break=3]="Break",e[e.Yield=4]="Yield",e[e.YieldStar=5]="YieldStar",e[e.Catch=6]="Catch",e[e.Endfinally=7]="Endfinally"}(s||(s={})),e.transformGenerators=function(t){var n,i,r,s,a,l,c,u,d,p,h=t.resumeLexicalEnvironment,f=t.endLexicalEnvironment,m=t.hoistFunctionDeclaration,g=t.hoistVariableDeclaration,_=t.getCompilerOptions(),y=e.getEmitScriptTarget(_),b=t.getEmitResolver(),v=t.onSubstituteNode;t.onSubstituteNode=function(t,r){if(r=v(t,r),1===t)return function(t){if(e.isIdentifier(t))return function(t){if(!e.isGeneratedIdentifier(t)&&n&&n.has(e.idText(t))){var r=e.getOriginalNode(t);if(e.isIdentifier(r)&&r.parent){var s=b.getReferencedValueDeclaration(r);if(s){var o=i[e.getOriginalNodeId(s)];if(o){var a=e.getMutableClone(o);return e.setSourceMapRange(a,t),e.setCommentRange(a,t),a}}}}return t}(t);return t}(r);return r};var T,k,x,E,S,C,w,I,A,N,D,O,R=1,L=0,P=0;return function(n){if(n.isDeclarationFile||!(512&n.transformFlags))return n;var i=e.visitEachChild(n,M,t);return e.addEmitHelpers(i,t.readEmitHelpers()),i};function M(n){var i=n.transformFlags;return s?function(n){switch(n.kind){case 212:case 213:return function(n){return s?(ie(),n=e.visitEachChild(n,M,t),se(),n):e.visitEachChild(n,M,t)}(n);case 221:return function(n){s&&Q({kind:2,isScript:!0,breakLabel:-1});n=e.visitEachChild(n,M,t),s&&oe();return n}(n);case 222:return function(n){s&&Q({kind:4,isScript:!0,labelText:e.idText(n.label),breakLabel:-1});n=e.visitEachChild(n,M,t),s&&ae();return n}(n);default:return F(n)}}(n):r?F(n):256&i?function(n){switch(n.kind){case 228:return B(n);case 186:return $(n);default:return e.Debug.failBadSyntaxKind(n),e.visitEachChild(n,M,t)}}(n):512&i?e.visitEachChild(n,M,t):n}function F(n){switch(n.kind){case 228:return B(n);case 186:return $(n);case 153:case 154:return function(n){var i=r,o=s;return r=!1,s=!1,n=e.visitEachChild(n,M,t),r=i,s=o,n}(n);case 208:return function(t){if(16777216&t.transformFlags)return void K(t.declarationList);if(1048576&e.getEmitFlags(t))return t;for(var n=0,i=t.declarationList.declarations;n<i.length;n++){var r=i[n];g(r.name)}var s=e.getInitializedVariables(t.declarationList);if(0===s.length)return;return e.setSourceMapRange(e.createStatement(e.inlineExpressions(e.map(s,z))),t)}(n);case 214:return function(n){s&&ie();var i=n.initializer;if(i&&e.isVariableDeclarationList(i)){for(var r=0,o=i.declarations;r<o.length;r++){var a=o[r];g(a.name)}var l=e.getInitializedVariables(i);n=e.updateFor(n,l.length>0?e.inlineExpressions(e.map(l,z)):void 0,e.visitNode(n.condition,M,e.isExpression),e.visitNode(n.incrementor,M,e.isExpression),e.visitNode(n.statement,M,e.isStatement,e.liftToBlock))}else n=e.visitEachChild(n,M,t);s&&se();return n}(n);case 215:return function(n){s&&ie();var i=n.initializer;if(e.isVariableDeclarationList(i)){for(var r=0,o=i.declarations;r<o.length;r++){var a=o[r];g(a.name)}n=e.updateForIn(n,i.declarations[0].name,e.visitNode(n.expression,M,e.isExpression),e.visitNode(n.statement,M,e.isStatement,e.liftToBlock))}else n=e.visitEachChild(n,M,t);s&&se();return n}(n);case 218:return function(n){if(s){var i=pe(n.label&&e.idText(n.label));if(i>0)return ge(i,n)}return e.visitEachChild(n,M,t)}(n);case 217:return function(n){if(s){var i=he(n.label&&e.idText(n.label));if(i>0)return ge(i,n)}return e.visitEachChild(n,M,t)}(n);case 219:return function(t){return function(t,n){return e.setTextRange(e.createReturn(e.createArrayLiteral(t?[me(2),t]:[me(2)])),n)}(e.visitNode(t.expression,M,e.isExpression),t)}(n);default:return 16777216&n.transformFlags?function(n){switch(n.kind){case 194:return function(n){switch(e.getExpressionAssociativity(n)){case 0:return function(n){if(W(n.right)){if(e.isLogicalOperator(n.operatorToken.kind))return function(t){var n=X(),i=Y();be(i,e.visitNode(t.left,M,e.isExpression),t.left),53===t.operatorToken.kind?ke(n,i,t.left):Te(n,i,t.left);return be(i,e.visitNode(t.right,M,e.isExpression),t.right),Z(n),i}(n);if(26===n.operatorToken.kind)return function(t){var n=[];return i(t.left),i(t.right),e.inlineExpressions(n);function i(t){e.isBinaryExpression(t)&&26===t.operatorToken.kind?(i(t.left),i(t.right)):(W(t)&&n.length>0&&(xe(1,[e.createStatement(e.inlineExpressions(n))]),n=[]),n.push(e.visitNode(t,M,e.isExpression)))}}(n);var i=e.getMutableClone(n);return i.left=J(e.visitNode(n.left,M,e.isExpression)),i.right=e.visitNode(n.right,M,e.isExpression),i}return e.visitEachChild(n,M,t)}(n);case 1:return function(n){var i=n.left,r=n.right;if(W(r)){var s=void 0;switch(i.kind){case 179:s=e.updatePropertyAccess(i,J(e.visitNode(i.expression,M,e.isLeftHandSideExpression)),i.name);break;case 180:s=e.updateElementAccess(i,J(e.visitNode(i.expression,M,e.isLeftHandSideExpression)),J(e.visitNode(i.argumentExpression,M,e.isExpression)));break;default:s=e.visitNode(i,M,e.isExpression)}var o=n.operatorToken.kind;return(a=o)>=59&&a<=70?e.setTextRange(e.createAssignment(s,e.setTextRange(e.createBinary(J(s),function(e){switch(e){case 59:return 37;case 60:return 38;case 61:return 39;case 62:return 40;case 63:return 41;case 64:return 42;case 65:return 45;case 66:return 46;case 67:return 47;case 68:return 48;case 69:return 49;case 70:return 50}}(o),e.visitNode(r,M,e.isExpression)),n)),n):e.updateBinary(n,s,e.visitNode(r,M,e.isExpression))}var a;return e.visitEachChild(n,M,t)}(n);default:e.Debug.fail("Unknown associativity.")}}(n);case 195:return function(n){if(W(n.whenTrue)||W(n.whenFalse)){var i=X(),r=X(),s=Y();return ke(i,e.visitNode(n.condition,M,e.isExpression),n.condition),be(s,e.visitNode(n.whenTrue,M,e.isExpression),n.whenTrue),ve(r),Z(i),be(s,e.visitNode(n.whenFalse,M,e.isExpression),n.whenFalse),Z(r),s}return e.visitEachChild(n,M,t)}(n);case 197:return function(n){var i=X(),r=e.visitNode(n.expression,M,e.isExpression);if(n.asteriskToken){!function(e,t){xe(7,[e],t)}(8388608&e.getEmitFlags(n.expression)?r:e.createValuesHelper(t,r,n),n)}else!function(e,t){xe(6,[e],t)}(r,n);return Z(i),function(t){return e.setTextRange(e.createCall(e.createPropertyAccess(E,"sent"),void 0,[]),t)}(n)}(n);case 177:return function(e){return V(e.elements,void 0,void 0,e.multiLine)}(n);case 178:return function(t){var n=t.properties,i=t.multiLine,r=q(n),s=Y();be(s,e.createObjectLiteral(e.visitNodes(n,M,e.isObjectLiteralElementLike,0,r),i));var o=e.reduceLeft(n,a,[],r);return o.push(i?e.startOnNewLine(e.getMutableClone(s)):s),e.inlineExpressions(o);function a(n,r){W(r)&&n.length>0&&(ye(e.createStatement(e.inlineExpressions(n))),n=[]);var o=e.createExpressionForObjectLiteralElementLike(t,r,s),a=e.visitNode(o,M,e.isExpression);return a&&(i&&(a.startsOnNewLine=!0),n.push(a)),n}}(n);case 180:return function(n){if(W(n.argumentExpression)){var i=e.getMutableClone(n);return i.expression=J(e.visitNode(n.expression,M,e.isLeftHandSideExpression)),i.argumentExpression=e.visitNode(n.argumentExpression,M,e.isExpression),i}return e.visitEachChild(n,M,t)}(n);case 181:return function(n){if(!e.isImportCall(n)&&e.forEach(n.arguments,W)){var i=e.createCallBinding(n.expression,g,y,!0),r=i.target,s=i.thisArg;return e.setOriginalNode(e.createFunctionApply(J(e.visitNode(r,M,e.isLeftHandSideExpression)),s,V(n.arguments),n),n)}return e.visitEachChild(n,M,t)}(n);case 182:return function(n){if(e.forEach(n.arguments,W)){var i=e.createCallBinding(e.createPropertyAccess(n.expression,"bind"),g),r=i.target,s=i.thisArg;return e.setOriginalNode(e.setTextRange(e.createNew(e.createFunctionApply(J(e.visitNode(r,M,e.isExpression)),s,V(n.arguments,e.createVoidZero())),void 0,[]),n),n)}return e.visitEachChild(n,M,t)}(n);default:return e.visitEachChild(n,M,t)}}(n):33554944&n.transformFlags?e.visitEachChild(n,M,t):n}}function B(n){if(n.asteriskToken)n=e.setOriginalNode(e.setTextRange(e.createFunctionDeclaration(void 0,n.modifiers,void 0,n.name,void 0,e.visitParameterList(n.parameters,M,t),void 0,U(n.body)),n),n);else{var i=r,o=s;r=!1,s=!1,n=e.visitEachChild(n,M,t),r=i,s=o}return r?void m(n):n}function $(n){if(n.asteriskToken)n=e.setOriginalNode(e.setTextRange(e.createFunctionExpression(void 0,void 0,n.name,void 0,e.visitParameterList(n.parameters,M,t),void 0,U(n.body)),n),n);else{var i=r,o=s;r=!1,s=!1,n=e.visitEachChild(n,M,t),r=i,s=o}return n}function U(t){var n=[],i=r,o=s,m=a,g=l,_=c,y=u,b=d,v=p,S=R,C=T,w=k,I=x,A=E;r=!0,s=!1,a=void 0,l=void 0,c=void 0,u=void 0,d=void 0,p=void 0,R=1,T=void 0,k=void 0,x=void 0,E=e.createTempVariable(void 0),h();var N=e.addPrologue(n,t.statements,!1,M);H(t.statements,N);var D=Ee();return e.addRange(n,f()),n.push(e.createReturn(D)),r=i,s=o,a=m,l=g,c=_,u=y,d=b,p=v,R=S,T=C,k=w,x=I,E=A,e.setTextRange(e.createBlock(n,t.multiLine),t)}function V(t,n,i,r){var s,o=q(t);if(o>0){s=Y();var a=e.visitNodes(t,M,e.isExpression,0,o);be(s,e.createArrayLiteral(n?[n].concat(a):a)),n=void 0}var l=e.reduceLeft(t,function(t,i){if(W(i)&&t.length>0){var o=void 0!==s;s||(s=Y()),be(s,o?e.createArrayConcat(s,[e.createArrayLiteral(t,r)]):e.createArrayLiteral(n?[n].concat(t):t,r)),n=void 0,t=[]}return t.push(e.visitNode(i,M,e.isExpression)),t},[],o);return s?e.createArrayConcat(s,[e.createArrayLiteral(l,r)]):e.setTextRange(e.createArrayLiteral(n?[n].concat(l):l,r),i)}function H(e,t){void 0===t&&(t=0);for(var n=e.length,i=t;i<n;i++)j(e[i])}function G(t){e.isBlock(t)?H(t.statements):j(t)}function j(r){var o=s;s||(s=W(r)),function(r){switch(r.kind){case 207:return function(t){W(t)?H(t.statements):ye(e.visitNode(t,M,e.isStatement))}(r);case 210:return function(t){ye(e.visitNode(t,M,e.isStatement))}(r);case 211:return function(t){if(W(t))if(W(t.thenStatement)||W(t.elseStatement)){var n=X(),i=t.elseStatement?X():void 0;ke(t.elseStatement?i:n,e.visitNode(t.expression,M,e.isExpression),t.expression),G(t.thenStatement),t.elseStatement&&(ve(n),Z(i),G(t.elseStatement)),Z(n)}else ye(e.visitNode(t,M,e.isStatement));else ye(e.visitNode(t,M,e.isStatement))}(r);case 212:return function(t){if(W(t)){var n=X(),i=X();re(n),Z(i),G(t.statement),Z(n),Te(i,e.visitNode(t.expression,M,e.isExpression)),se()}else ye(e.visitNode(t,M,e.isStatement))}(r);case 213:return function(t){if(W(t)){var n=X(),i=re(n);Z(n),ke(i,e.visitNode(t.expression,M,e.isExpression)),G(t.statement),ve(n),se()}else ye(e.visitNode(t,M,e.isStatement))}(r);case 214:return function(t){if(W(t)){var n=X(),i=X(),r=re(i);if(t.initializer){var s=t.initializer;e.isVariableDeclarationList(s)?K(s):ye(e.setTextRange(e.createStatement(e.visitNode(s,M,e.isExpression)),s))}Z(n),t.condition&&ke(r,e.visitNode(t.condition,M,e.isExpression)),G(t.statement),Z(i),t.incrementor&&ye(e.setTextRange(e.createStatement(e.visitNode(t.incrementor,M,e.isExpression)),t.incrementor)),ve(n),se()}else ye(e.visitNode(t,M,e.isStatement))}(r);case 215:return function(t){if(W(t)){var n=Y(),i=Y(),r=e.createLoopVariable(),s=t.initializer;g(r),be(n,e.createArrayLiteral()),ye(e.createForIn(i,e.visitNode(t.expression,M,e.isExpression),e.createStatement(e.createCall(e.createPropertyAccess(n,"push"),void 0,[i])))),be(r,e.createLiteral(0));var o=X(),a=X(),l=re(a);Z(o),ke(l,e.createLessThan(r,e.createPropertyAccess(n,"length")));var c=void 0;if(e.isVariableDeclarationList(s)){for(var u=0,d=s.declarations;u<d.length;u++){var p=d[u];g(p.name)}c=e.getSynthesizedClone(s.declarations[0].name)}else c=e.visitNode(s,M,e.isExpression),e.Debug.assert(e.isLeftHandSideExpression(c));be(c,e.createElementAccess(n,r)),G(t.statement),Z(a),ye(e.createStatement(e.createPostfixIncrement(r))),ve(o),se()}else ye(e.visitNode(t,M,e.isStatement))}(r);case 217:return function(t){var n=he(t.label?e.idText(t.label):void 0);n>0?ve(n,t):ye(t)}(r);case 218:return function(t){var n=pe(t.label?e.idText(t.label):void 0);n>0?ve(n,t):ye(t)}(r);case 219:return function(t){!function(e,t){xe(8,[e],t)}(e.visitNode(t.expression,M,e.isExpression),t)}(r);case 220:return function(t){W(t)?(n=J(e.visitNode(t.expression,M,e.isExpression)),i=X(),r=X(),Z(i),Q({kind:1,expression:n,startLabel:i,endLabel:r}),G(t.statement),e.Debug.assert(1===ne()),Z(ee().endLabel)):ye(e.visitNode(t,M,e.isStatement));var n,i,r}(r);case 221:return function(t){if(W(t.caseBlock)){for(var n=t.caseBlock,i=n.clauses.length,r=(Q({kind:2,isScript:!1,breakLabel:f=X()}),f),s=J(e.visitNode(t.expression,M,e.isExpression)),o=[],a=-1,l=0;l<i;l++){var c=n.clauses[l];o.push(X()),258===c.kind&&-1===a&&(a=l)}for(var u=0,d=[];u<i;){var p=0;for(l=u;l<i;l++){if(257===(c=n.clauses[l]).kind){var h=c;if(W(h.expression)&&d.length>0)break;d.push(e.createCaseClause(e.visitNode(h.expression,M,e.isExpression),[ge(o[l],h.expression)]))}else p++}d.length&&(ye(e.createSwitch(s,e.createCaseBlock(d))),u+=d.length,d=[]),p>0&&(u+=p,p=0)}ve(a>=0?o[a]:r);for(l=0;l<i;l++)Z(o[l]),H(n.clauses[l].statements);oe()}else ye(e.visitNode(t,M,e.isStatement));var f}(r);case 222:return function(t){W(t)?(n=e.idText(t.label),i=X(),Q({kind:4,isScript:!1,labelText:n,breakLabel:i}),G(t.statement),ae()):ye(e.visitNode(t,M,e.isStatement));var n,i}(r);case 223:return function(t){!function(e,t){xe(9,[e],t)}(e.visitNode(t.expression,M,e.isExpression),t)}(r);case 224:return function(r){W(r)?(s=X(),o=X(),Z(s),Q({kind:0,state:0,startLabel:s,endLabel:o}),_e(),G(r.tryBlock),r.catchClause&&(!function(r){var s;if(e.Debug.assert(0===ne()),e.isGeneratedIdentifier(r.name))s=r.name,g(r.name);else{var o=e.idText(r.name);s=Y(o),n||(n=e.createMap(),i=[],t.enableSubstitution(71)),n.set(o,!0),i[e.getOriginalNodeId(r)]=s}var a=te();e.Debug.assert(a.state<1);var l=a.endLabel;ve(l);var c=X();Z(c),a.state=1,a.catchVariable=s,a.catchLabel=c,be(s,e.createCall(e.createPropertyAccess(E,"sent"),void 0,[])),_e()}(r.catchClause.variableDeclaration),G(r.catchClause.block)),r.finallyBlock&&(!function(){e.Debug.assert(0===ne());var t=te();e.Debug.assert(t.state<2);var n=t.endLabel;ve(n);var i=X();Z(i),t.state=2,t.finallyLabel=i}(),G(r.finallyBlock)),function(){e.Debug.assert(0===ne());var t=ee(),n=t.state;n<2?ve(t.endLabel):xe(10);Z(t.endLabel),_e(),t.state=3}()):ye(e.visitEachChild(r,M,t));var s,o}(r);default:ye(e.visitNode(r,M,e.isStatement))}}(r),s=o}function K(t){for(var n=0,i=t.declarations;n<i.length;n++){var r=i[n],s=e.getSynthesizedClone(r.name);e.setCommentRange(s,r.name),g(s)}for(var o=e.getInitializedVariables(t),a=o.length,l=0,c=[];l<a;){for(var u=l;u<a;u++){if(W((r=o[u]).initializer)&&c.length>0)break;c.push(z(r))}c.length&&(ye(e.createStatement(e.inlineExpressions(c))),l+=c.length,c=[])}}function z(t){return e.setSourceMapRange(e.createAssignment(e.setSourceMapRange(e.getSynthesizedClone(t.name),t.name),e.visitNode(t.initializer,M,e.isExpression)),t)}function W(e){return e&&!!(16777216&e.transformFlags)}function q(e){for(var t=e.length,n=0;n<t;n++)if(W(e[n]))return n;return-1}function J(t){var n;return e.isGeneratedIdentifier(t)||4096&e.getEmitFlags(t)?t:(be(n=e.createTempVariable(g),t,t),n)}function Y(t){var n=t?e.createUniqueName(t):e.createTempVariable(void 0);return g(n),n}function X(){d||(d=[]);var e=R;return R++,d[e]=-1,e}function Z(t){e.Debug.assert(void 0!==d,"No labels were defined."),d[t]=T?T.length:0}function Q(e){a||(a=[],c=[],l=[],u=[]);var t=c.length;return c[t]=0,l[t]=T?T.length:0,a[t]=e,u.push(e),t}function ee(){var t=te();e.Debug.assert(void 0!==t,"beginBlock was never called.");var n=c.length;return c[n]=1,l[n]=T?T.length:0,a[n]=t,u.pop(),t}function te(){return e.lastOrUndefined(u)}function ne(){var e=te();return e&&e.kind}function ie(){Q({kind:3,isScript:!0,breakLabel:-1,continueLabel:-1})}function re(e){var t=X();return Q({kind:3,isScript:!1,breakLabel:t,continueLabel:e}),t}function se(){e.Debug.assert(3===ne());var t=ee(),n=t.breakLabel;t.isScript||Z(n)}function oe(){e.Debug.assert(2===ne());var t=ee(),n=t.breakLabel;t.isScript||Z(n)}function ae(){e.Debug.assert(4===ne());var t=ee();t.isScript||Z(t.breakLabel)}function le(e){return 2===e.kind||3===e.kind}function ce(e){return 4===e.kind}function ue(e){return 3===e.kind}function de(e,t){for(var n=t;n>=0;n--){var i=u[n];if(!ce(i))break;if(i.labelText===e)return!0}return!1}function pe(e){if(u)if(e)for(var t=u.length-1;t>=0;t--){if(ce(n=u[t])&&n.labelText===e)return n.breakLabel;if(le(n)&&de(e,t-1))return n.breakLabel}else for(t=u.length-1;t>=0;t--){var n;if(le(n=u[t]))return n.breakLabel}return 0}function he(e){if(u)if(e)for(var t=u.length-1;t>=0;t--){if(ue(n=u[t])&&de(e,t-1))return n.continueLabel}else for(t=u.length-1;t>=0;t--){var n;if(ue(n=u[t]))return n.continueLabel}return 0}function fe(t){if(t>0){void 0===p&&(p=[]);var n=e.createLiteral(-1);return void 0===p[t]?p[t]=[n]:p[t].push(n),n}return e.createOmittedExpression()}function me(t){var n=e.createLiteral(t);return e.addSyntheticTrailingComment(n,3,function(e){switch(e){case 2:return"return";case 3:return"break";case 4:return"yield";case 5:return"yield*";case 7:return"endfinally"}}(t)),n}function ge(t,n){return e.Debug.assertLessThan(0,t,"Invalid label"),e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),n)}function _e(){xe(0)}function ye(e){e?xe(1,[e]):_e()}function be(e,t,n){xe(2,[e,t],n)}function ve(e,t){xe(3,[e],t)}function Te(e,t,n){xe(4,[e,t],n)}function ke(e,t,n){xe(5,[e,t],n)}function xe(e,t,n){void 0===T&&(T=[],k=[],x=[]),void 0===d&&Z(X());var i=T.length;T[i]=e,k[i]=t,x[i]=n}function Ee(){L=0,P=0,S=void 0,C=!1,w=!1,I=void 0,A=void 0,N=void 0,D=void 0,O=void 0;var n=function(){if(T){for(var t=0;t<T.length;t++)Ae(t);Ce(T.length)}else Ce(0);if(I){var n=e.createPropertyAccess(E,"label"),i=e.createSwitch(n,e.createCaseBlock(I));return i.startsOnNewLine=!0,[i]}if(A)return A;return[]}();return function(t,n){return t.requestEmitHelper(o),e.createCall(e.getHelperName("__generator"),void 0,[e.createThis(),n])}(t,e.setEmitFlags(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,E)],void 0,e.createBlock(n,n.length>0)),524288))}function Se(){A&&(we(!C),C=!1,w=!1,P++)}function Ce(e){(function(e){if(!w)return!0;if(!d||!p)return!1;for(var t=0;t<d.length;t++)if(d[t]===e&&p[t])return!0;return!1})(e)&&(Ie(e),O=void 0,De(void 0,void 0)),A&&I&&we(!1),function(){if(void 0!==p&&void 0!==S)for(var e=0;e<S.length;e++){var t=S[e];if(void 0!==t)for(var n=0,i=t;n<i.length;n++){var r=i[n],s=p[r];if(void 0!==s)for(var o=0,a=s;o<a.length;o++){a[o].text=String(e)}}}}()}function we(t){if(I||(I=[]),A){if(O)for(var n=O.length-1;n>=0;n--){var i=O[n];A=[e.createWith(i.expression,e.createBlock(A))]}if(D){var r=D.startLabel,s=D.catchLabel,o=D.finallyLabel,a=D.endLabel;A.unshift(e.createStatement(e.createCall(e.createPropertyAccess(e.createPropertyAccess(E,"trys"),"push"),void 0,[e.createArrayLiteral([fe(r),fe(s),fe(o),fe(a)])]))),D=void 0}t&&A.push(e.createStatement(e.createAssignment(e.createPropertyAccess(E,"label"),e.createLiteral(P+1))))}I.push(e.createCaseClause(e.createLiteral(P),A||[])),A=void 0}function Ie(e){if(d)for(var t=0;t<d.length;t++)d[t]===e&&(Se(),void 0===S&&(S=[]),void 0===S[P]?S[P]=[t]:S[P].push(t))}function Ae(t){if(Ie(t),function(e){if(a)for(;L<c.length&&l[L]<=e;L++){var t=a[L],n=c[L];switch(t.kind){case 0:0===n?(N||(N=[]),A||(A=[]),N.push(D),D=t):1===n&&(D=N.pop());break;case 1:0===n?(O||(O=[]),O.push(t)):1===n&&O.pop()}}}(t),!C){C=!1,w=!1;var n=T[t];if(0!==n){if(10===n)return C=!0,void Ne(e.createReturn(e.createArrayLiteral([me(7)])));var i=k[t];if(1===n)return Ne(i[0]);var r,s,o,u=x[t];switch(n){case 2:return r=i[0],s=i[1],o=u,void Ne(e.setTextRange(e.createStatement(e.createAssignment(r,s)),o));case 3:return function(t,n){C=!0,Ne(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),n),384))}(i[0],u);case 4:return function(t,n,i){Ne(e.setEmitFlags(e.createIf(n,e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),i),384)),1))}(i[0],i[1],u);case 5:return function(t,n,i){Ne(e.setEmitFlags(e.createIf(e.createLogicalNot(n),e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),i),384)),1))}(i[0],i[1],u);case 6:return function(t,n){C=!0,Ne(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral(t?[me(4),t]:[me(4)])),n),384))}(i[0],u);case 7:return function(t,n){C=!0,Ne(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(5),t])),n),384))}(i[0],u);case 8:return De(i[0],u);case 9:return function(t,n){C=!0,w=!0,Ne(e.setTextRange(e.createThrow(t),n))}(i[0],u)}}}}function Ne(e){e&&(A?A.push(e):A=[e])}function De(t,n){C=!0,w=!0,Ne(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral(t?[me(2),t]:[me(2)])),n),384))}};var o={name:"typescript:generator",scoped:!1,priority:6,text:'\n            var __generator = (this && this.__generator) || function (thisArg, body) {\n                var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n                return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\n                function verb(n) { return function (v) { return step([n, v]); }; }\n                function step(op) {\n                    if (f) throw new TypeError("Generator is already executing.");\n                    while (_) try {\n                        if (f = 1, y && (t = y[op[0] & 2 ? "return" : op[0] ? "throw" : "next"]) && !(t = t.call(y, op[1])).done) return t;\n                        if (y = 0, t) op = [0, t.value];\n                        switch (op[0]) {\n                            case 0: case 1: t = op; break;\n                            case 4: _.label++; return { value: op[1], done: false };\n                            case 5: _.label++; y = op[1]; op = [0]; continue;\n                            case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                            default:\n                                if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                                if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                                if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                                if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                                if (t[2]) _.ops.pop();\n                                _.trys.pop(); continue;\n                        }\n                        op = body.call(thisArg, _);\n                    } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n                    if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n                }\n            };'}}(ts||(ts={})),function(e){e.transformModule=function(i){var r=i.startLexicalEnvironment,s=i.endLexicalEnvironment,o=i.hoistVariableDeclaration,a=i.getCompilerOptions(),l=i.getEmitResolver(),c=i.getEmitHost(),u=e.getEmitScriptTarget(a),d=e.getEmitModuleKind(a),p=i.onSubstituteNode,h=i.onEmitNode;i.onSubstituteNode=function(t,n){if((n=p(t,n)).id&&g[n.id])return n;if(1===t)return function(t){switch(t.kind){case 71:return j(t);case 194:return function(t){if(e.isAssignmentOperator(t.operatorToken.kind)&&e.isIdentifier(t.left)&&!e.isGeneratedIdentifier(t.left)&&!e.isLocalName(t.left)&&!e.isDeclarationNameOfEnumOrNamespace(t.left)){var n=K(t.left);if(n){for(var i=t,r=0,s=n;r<s.length;r++){var o=s[r];g[e.getNodeId(i)]=!0,i=H(o,i,t)}return i}}return t}(t);case 193:case 192:return function(t){if((43===t.operator||44===t.operator)&&e.isIdentifier(t.operand)&&!e.isGeneratedIdentifier(t.operand)&&!e.isLocalName(t.operand)&&!e.isDeclarationNameOfEnumOrNamespace(t.operand)){var n=K(t.operand);if(n){for(var i=193===t.kind?e.setTextRange(e.createBinary(t.operand,e.createToken(43===t.operator?59:60),e.createLiteral(1)),t):t,r=0,s=n;r<s.length;r++){var o=s[r];g[e.getNodeId(i)]=!0,i=H(o,i)}return i}}return t}(t)}return t}(n);if(e.isShorthandPropertyAssignment(n))return function(t){var n=t.name,i=j(n);if(i!==n){if(t.objectAssignmentInitializer){var r=e.createAssignment(i,t.objectAssignmentInitializer);return e.setTextRange(e.createPropertyAssignment(n,r),t)}return e.setTextRange(e.createPropertyAssignment(n,i),t)}return t}(n);return n},i.onEmitNode=function(t,n,i){265===n.kind?(f=n,m=y[e.getOriginalNodeId(f)],g=[],h(t,n,i),f=void 0,m=void 0,g=void 0):h(t,n,i)},i.enableSubstitution(71),i.enableSubstitution(194),i.enableSubstitution(192),i.enableSubstitution(193),i.enableSubstitution(262),i.enableEmitNotification(265);var f,m,g,_,y=[],b=[];return function(t){if(t.isDeclarationFile||!(e.isExternalModule(t)||a.isolatedModules||67108864&t.transformFlags))return t;f=t,m=e.collectExternalModuleInfo(t,l,a),y[e.getOriginalNodeId(t)]=m;var n=function(t){switch(t){case e.ModuleKind.AMD:return k;case e.ModuleKind.UMD:return x;default:return T}}(d),i=n(t);return f=void 0,m=void 0,_=!1,e.aggregateTransformFlags(i)};function v(){return!(m.exportEquals||!e.isExternalModule(f))}function T(n){r();var o=[],l=a.alwaysStrict||!a.noImplicitUseStrict&&e.isExternalModule(f),c=e.addPrologue(o,n.statements,l,w);v()&&e.append(o,V()),e.append(o,e.visitNode(m.externalHelpersImportDeclaration,w,e.isStatement)),e.addRange(o,e.visitNodes(n.statements,w,e.isStatement,c)),C(o,!1),e.addRange(o,s());var u=e.updateSourceFileNode(n,e.setTextRange(e.createNodeArray(o),n.statements));return m.hasExportStarsToExportValues&&!a.importHelpers&&e.addEmitHelper(u,t),e.addEmitHelpers(u,i.readEmitHelpers()),u}function k(t){var n=e.createIdentifier("define"),i=e.tryGetModuleNameFromFile(t,c,a),r=E(t,!0),s=r.aliasedModuleNames,o=r.unaliasedModuleNames,l=r.importAliasNames;return e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray([e.createStatement(e.createCall(n,void 0,(i?[i]:[]).concat([e.createArrayLiteral([e.createLiteral("require"),e.createLiteral("exports")].concat(s,o)),e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,"require"),e.createParameter(void 0,void 0,void 0,"exports")].concat(l),void 0,S(t))])))]),t.statements))}function x(t){var n=E(t,!1),i=n.aliasedModuleNames,r=n.unaliasedModuleNames,s=n.importAliasNames,o=e.tryGetModuleNameFromFile(t,c,a),l=e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,"factory")],void 0,e.setTextRange(e.createBlock([e.createIf(e.createLogicalAnd(e.createTypeCheck(e.createIdentifier("module"),"object"),e.createTypeCheck(e.createPropertyAccess(e.createIdentifier("module"),"exports"),"object")),e.createBlock([e.createVariableStatement(void 0,[e.createVariableDeclaration("v",void 0,e.createCall(e.createIdentifier("factory"),void 0,[e.createIdentifier("require"),e.createIdentifier("exports")]))]),e.setEmitFlags(e.createIf(e.createStrictInequality(e.createIdentifier("v"),e.createIdentifier("undefined")),e.createStatement(e.createAssignment(e.createPropertyAccess(e.createIdentifier("module"),"exports"),e.createIdentifier("v")))),1)]),e.createIf(e.createLogicalAnd(e.createTypeCheck(e.createIdentifier("define"),"function"),e.createPropertyAccess(e.createIdentifier("define"),"amd")),e.createBlock([e.createStatement(e.createCall(e.createIdentifier("define"),void 0,(o?[o]:[]).concat([e.createArrayLiteral([e.createLiteral("require"),e.createLiteral("exports")].concat(i,r)),e.createIdentifier("factory")])))])))],!0),void 0));return e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray([e.createStatement(e.createCall(l,void 0,[e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,"require"),e.createParameter(void 0,void 0,void 0,"exports")].concat(s),void 0,S(t))]))]),t.statements))}function E(t,n){for(var i=[],r=[],s=[],o=0,u=t.amdDependencies;o<u.length;o++){var d=u[o];d.name?(i.push(e.createLiteral(d.path)),s.push(e.createParameter(void 0,void 0,void 0,d.name))):r.push(e.createLiteral(d.path))}for(var p=0,h=m.externalImports;p<h.length;p++){var g=h[p],_=e.getExternalModuleNameLiteral(g,f,c,l,a),y=e.getLocalNameForExternalImport(g,f);_&&(n&&y?(e.setEmitFlags(y,4),i.push(_),s.push(e.createParameter(void 0,void 0,void 0,y))):r.push(_))}return{aliasedModuleNames:i,unaliasedModuleNames:r,importAliasNames:s}}function S(i){r();var o=[],l=e.addPrologue(o,i.statements,!a.noImplicitUseStrict,w);v()&&e.append(o,V()),e.append(o,e.visitNode(m.externalHelpersImportDeclaration,w,e.isStatement)),e.addRange(o,e.visitNodes(i.statements,w,e.isStatement,l)),C(o,!0),e.addRange(o,s());var c=e.createBlock(o,!0);return m.hasExportStarsToExportValues&&!a.importHelpers&&e.addEmitHelper(c,t),_&&e.addEmitHelper(c,n),c}function C(t,n){if(m.exportEquals){var i=e.visitNode(m.exportEquals.expression,I);if(i)if(n){var r=e.createReturn(i);e.setTextRange(r,m.exportEquals),e.setEmitFlags(r,1920),t.push(r)}else{r=e.createStatement(e.createAssignment(e.createPropertyAccess(e.createIdentifier("module"),"exports"),i));e.setTextRange(r,m.exportEquals),e.setEmitFlags(r,1536),t.push(r)}}}function w(t){switch(t.kind){case 238:return function(t){var n,i=e.getNamespaceDeclarationNode(t);if(d!==e.ModuleKind.AMD){if(!t.importClause)return e.setTextRange(e.createStatement(D(t)),t);var r=[];i&&!e.isDefaultImport(t)?r.push(e.createVariableDeclaration(e.getSynthesizedClone(i.name),void 0,D(t))):(r.push(e.createVariableDeclaration(e.getGeneratedNameForNode(t),void 0,D(t))),i&&e.isDefaultImport(t)&&r.push(e.createVariableDeclaration(e.getSynthesizedClone(i.name),void 0,e.getGeneratedNameForNode(t)))),n=e.append(n,e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList(r,u>=2?2:0)),t))}else i&&e.isDefaultImport(t)&&(n=e.append(n,e.createVariableStatement(void 0,e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(e.getSynthesizedClone(i.name),void 0,e.getGeneratedNameForNode(t)),t)],u>=2?2:0))));if(R(t)){var s=e.getOriginalNodeId(t);b[s]=L(b[s],t)}else n=L(n,t);return e.singleOrMany(n)}(t);case 237:return function(t){var n;e.Debug.assert(e.isExternalModuleImportEqualsDeclaration(t),"import= for internal module references should be handled in an earlier transformer."),d!==e.ModuleKind.AMD?n=e.hasModifier(t,1)?e.append(n,e.setTextRange(e.createStatement(H(t.name,D(t))),t)):e.append(n,e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.getSynthesizedClone(t.name),void 0,D(t))],u>=2?2:0)),t)):e.hasModifier(t,1)&&(n=e.append(n,e.setTextRange(e.createStatement(H(e.getExportName(t),e.getLocalName(t))),t)));if(R(t)){var i=e.getOriginalNodeId(t);b[i]=P(b[i],t)}else n=P(n,t);return e.singleOrMany(n)}(t);case 244:return function(t){if(!t.moduleSpecifier)return;var n=e.getGeneratedNameForNode(t);if(t.exportClause){var r=[];d!==e.ModuleKind.AMD&&r.push(e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(n,void 0,D(t))])),t));for(var s=0,o=t.exportClause.elements;s<o.length;s++){var a=o[s],l=e.createPropertyAccess(n,a.propertyName||a.name);r.push(e.setTextRange(e.createStatement(H(e.getExportName(a),l)),a))}return e.singleOrMany(r)}return e.setTextRange(e.createStatement(function(t,n){var i=t.getCompilerOptions();return i.importHelpers?e.createCall(e.getHelperName("__exportStar"),void 0,[n,e.createIdentifier("exports")]):e.createCall(e.createIdentifier("__export"),void 0,[n])}(i,d!==e.ModuleKind.AMD?D(t):n)),t)}(t);case 243:return function(t){if(t.isExportEquals)return;var n,i=t.original;if(i&&R(i)){var r=e.getOriginalNodeId(t);b[r]=U(b[r],e.createIdentifier("default"),e.visitNode(t.expression,I),t,!0)}else n=U(n,e.createIdentifier("default"),e.visitNode(t.expression,I),t,!0);return e.singleOrMany(n)}(t);case 208:return function(t){var n,r,s;if(e.hasModifier(t,1)){for(var o=void 0,a=0,l=t.declarationList.declarations;a<l.length;a++){var c=l[a];e.isIdentifier(c.name)&&e.isLocalName(c.name)?(o||(o=e.visitNodes(t.modifiers,G,e.isModifier)),r=e.append(r,c)):c.initializer&&(s=e.append(s,O(c)))}r&&(n=e.append(n,e.updateVariableStatement(t,o,e.updateVariableDeclarationList(t.declarationList,r)))),s&&(n=e.append(n,e.setTextRange(e.createStatement(e.inlineExpressions(s)),t)))}else n=e.append(n,e.visitEachChild(t,I,i));if(R(t)){var u=e.getOriginalNodeId(t);b[u]=M(b[u],t)}else n=M(n,t);return e.singleOrMany(n)}(t);case 228:return function(t){var n;n=e.hasModifier(t,1)?e.append(n,e.setOriginalNode(e.setTextRange(e.createFunctionDeclaration(void 0,e.visitNodes(t.modifiers,G,e.isModifier),t.asteriskToken,e.getDeclarationName(t,!0,!0),void 0,e.visitNodes(t.parameters,I),void 0,e.visitEachChild(t.body,I,i)),t),t)):e.append(n,e.visitEachChild(t,I,i));if(R(t)){var r=e.getOriginalNodeId(t);b[r]=B(b[r],t)}else n=B(n,t);return e.singleOrMany(n)}(t);case 229:return function(t){var n;n=e.hasModifier(t,1)?e.append(n,e.setOriginalNode(e.setTextRange(e.createClassDeclaration(void 0,e.visitNodes(t.modifiers,G,e.isModifier),e.getDeclarationName(t,!0,!0),void 0,e.visitNodes(t.heritageClauses,I),e.visitNodes(t.members,I)),t),t)):e.append(n,e.visitEachChild(t,I,i));if(R(t)){var r=e.getOriginalNodeId(t);b[r]=B(b[r],t)}else n=B(n,t);return e.singleOrMany(n)}(t);case 290:return function(t){if(R(t)&&208===t.original.kind){var n=e.getOriginalNodeId(t);b[n]=M(b[n],t.original)}return t}(t);case 291:return function(t){var n=e.getOriginalNodeId(t),i=b[n];if(i)return delete b[n],e.append(i,t);return t}(t);default:return e.visitEachChild(t,I,i)}}function I(t){return 67108864&t.transformFlags?e.isImportCall(t)?function(t){var n=e.visitNode(e.firstOrUndefined(t.arguments),I),i=!!(16384&t.transformFlags);switch(a.module){case e.ModuleKind.AMD:return A(n,i);case e.ModuleKind.UMD:return function(t,n){if(_=!0,e.isSimpleCopiableExpression(t)){var i=e.isGeneratedIdentifier(t)?t:e.isStringLiteral(t)?e.createLiteral(t):e.setEmitFlags(e.setTextRange(e.getSynthesizedClone(t),t),1536);return e.createConditional(e.createIdentifier("__syncRequire"),N(t,n),A(i,n))}var r=e.createTempVariable(o);return e.createComma(e.createAssignment(r,t),e.createConditional(e.createIdentifier("__syncRequire"),N(r,n),A(r,n)))}(n,i);case e.ModuleKind.CommonJS:default:return N(n,i)}}(t):e.visitEachChild(t,I,i):t}function A(t,n){var i,r=e.createUniqueName("resolve"),s=e.createUniqueName("reject"),o=[e.createParameter(void 0,void 0,void 0,r),e.createParameter(void 0,void 0,void 0,s)],a=e.createBlock([e.createStatement(e.createCall(e.createIdentifier("require"),void 0,[e.createArrayLiteral([t||e.createOmittedExpression()]),r,s]))]);return u>=2?i=e.createArrowFunction(void 0,void 0,o,void 0,void 0,a):(i=e.createFunctionExpression(void 0,void 0,void 0,void 0,o,void 0,a),n&&e.setEmitFlags(i,8)),e.createNew(e.createIdentifier("Promise"),void 0,[i])}function N(t,n){var i,r=e.createCall(e.createPropertyAccess(e.createIdentifier("Promise"),"resolve"),void 0,[]),s=e.createCall(e.createIdentifier("require"),void 0,t?[t]:[]);return u>=2?i=e.createArrowFunction(void 0,void 0,[],void 0,void 0,s):(i=e.createFunctionExpression(void 0,void 0,void 0,void 0,[],void 0,e.createBlock([e.createReturn(s)])),n&&e.setEmitFlags(i,8)),e.createCall(e.createPropertyAccess(r,"then"),void 0,[i])}function D(t){var n=e.getExternalModuleNameLiteral(t,f,c,l,a),i=[];return n&&i.push(n),e.createCall(e.createIdentifier("require"),void 0,i)}function O(t){return e.isBindingPattern(t.name)?e.flattenDestructuringAssignment(e.visitNode(t,I),void 0,i,0,!1,H):e.createAssignment(e.setTextRange(e.createPropertyAccess(e.createIdentifier("exports"),t.name),t.name),e.visitNode(t.initializer,I))}function R(t){return!!(4194304&e.getEmitFlags(t))}function L(e,t){if(m.exportEquals)return e;var n=t.importClause;if(!n)return e;n.name&&(e=$(e,n));var i=n.namedBindings;if(i)switch(i.kind){case 240:e=$(e,i);break;case 241:for(var r=0,s=i.elements;r<s.length;r++){e=$(e,s[r])}}return e}function P(e,t){return m.exportEquals?e:$(e,t)}function M(e,t){if(m.exportEquals)return e;for(var n=0,i=t.declarationList.declarations;n<i.length;n++){e=F(e,i[n])}return e}function F(t,n){if(m.exportEquals)return t;if(e.isBindingPattern(n.name))for(var i=0,r=n.name.elements;i<r.length;i++){var s=r[i];e.isOmittedExpression(s)||(t=F(t,s))}else e.isGeneratedIdentifier(n.name)||(t=$(t,n));return t}function B(t,n){if(m.exportEquals)return t;e.hasModifier(n,1)&&(t=U(t,e.hasModifier(n,512)?e.createIdentifier("default"):e.getDeclarationName(n),e.getLocalName(n),n));return n.name&&(t=$(t,n)),t}function $(t,n){var i=e.getDeclarationName(n),r=m.exportSpecifiers.get(e.idText(i));if(r)for(var s=0,o=r;s<o.length;s++){var a=o[s];t=U(t,a.name,i,a.name)}return t}function U(t,n,i,r,s){return t=e.append(t,function(t,n,i,r){var s=e.setTextRange(e.createStatement(H(t,n)),i);e.startOnNewLine(s),r||e.setEmitFlags(s,1536);return s}(n,i,r,s)),t}function V(){var t;return t=0===u?e.createStatement(H(e.createIdentifier("__esModule"),e.createLiteral(!0))):e.createStatement(e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"defineProperty"),void 0,[e.createIdentifier("exports"),e.createLiteral("__esModule"),e.createObjectLiteral([e.createPropertyAssignment("value",e.createLiteral(!0))])])),e.setEmitFlags(t,1048576),t}function H(t,n,i){return e.setTextRange(e.createAssignment(e.createPropertyAccess(e.createIdentifier("exports"),e.getSynthesizedClone(t)),n),i)}function G(e){switch(e.kind){case 84:case 79:return}return e}function j(t){if(4096&e.getEmitFlags(t)){var n=e.getExternalHelpersModuleName(f);return n?e.createPropertyAccess(n,t):t}if(!e.isGeneratedIdentifier(t)&&!e.isLocalName(t)){var i=l.getReferencedExportContainer(t,e.isExportName(t));if(i&&265===i.kind)return e.setTextRange(e.createPropertyAccess(e.createIdentifier("exports"),e.getSynthesizedClone(t)),t);var r=l.getReferencedImportDeclaration(t);if(r){if(e.isImportClause(r))return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(r.parent),e.createIdentifier("default")),t);if(e.isImportSpecifier(r)){var s=r.propertyName||r.name;return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(r.parent.parent.parent),e.getSynthesizedClone(s)),t)}}}return t}function K(t){if(!e.isGeneratedIdentifier(t)){var n=l.getReferencedImportDeclaration(t)||l.getReferencedValueDeclaration(t);if(n)return m&&m.exportedBindings[e.getOriginalNodeId(n)]}}};var t={name:"typescript:export-star",scoped:!0,text:"\n            function __export(m) {\n                for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n            }\n        "};var n={name:"typescript:dynamicimport-sync-require",scoped:!0,text:'\n            var __syncRequire = typeof module === "object" && typeof module.exports === "object";'}}(ts||(ts={})),function(e){e.transformSystemModule=function(t){var n=t.startLexicalEnvironment,i=t.endLexicalEnvironment,r=t.hoistVariableDeclaration,s=t.getCompilerOptions(),o=t.getEmitResolver(),a=t.getEmitHost(),l=t.onSubstituteNode,c=t.onEmitNode;t.onSubstituteNode=function(t,n){if(function(e){return g&&e.id&&g[e.id]}(n=l(t,n)))return n;if(1===t)return function(t){switch(t.kind){case 71:return function(t){if(4096&e.getEmitFlags(t)){var n=e.getExternalHelpersModuleName(u);return n?e.createPropertyAccess(n,t):t}if(!e.isGeneratedIdentifier(t)&&!e.isLocalName(t)){var i=o.getReferencedImportDeclaration(t);if(i){if(e.isImportClause(i))return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(i.parent),e.createIdentifier("default")),t);if(e.isImportSpecifier(i))return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(i.parent.parent.parent),e.getSynthesizedClone(i.propertyName||i.name)),t)}}return t}(t);case 194:return function(t){if(e.isAssignmentOperator(t.operatorToken.kind)&&e.isIdentifier(t.left)&&!e.isGeneratedIdentifier(t.left)&&!e.isLocalName(t.left)&&!e.isDeclarationNameOfEnumOrNamespace(t.left)){var n=K(t.left);if(n){for(var i=t,r=0,s=n;r<s.length;r++){i=$(s[r],z(i))}return i}}return t}(t);case 192:case 193:return function(t){if((43===t.operator||44===t.operator)&&e.isIdentifier(t.operand)&&!e.isGeneratedIdentifier(t.operand)&&!e.isLocalName(t.operand)&&!e.isDeclarationNameOfEnumOrNamespace(t.operand)){var n=K(t.operand);if(n){for(var i=193===t.kind?e.setTextRange(e.createPrefix(t.operator,t.operand),t):t,r=0,s=n;r<s.length;r++){i=$(s[r],z(i))}return 193===t.kind&&(i=43===t.operator?e.createSubtract(z(i),e.createLiteral(1)):e.createAdd(z(i),e.createLiteral(1))),i}}return t}(t)}return t}(n);return n},t.onEmitNode=function(t,n,i){if(265===n.kind){var r=e.getOriginalNodeId(n);u=n,d=_[r],p=b[r],(g=v[r])&&delete v[r],c(t,n,i),u=void 0,d=void 0,p=void 0,g=void 0}else c(t,n,i)},t.enableSubstitution(71),t.enableSubstitution(194),t.enableSubstitution(192),t.enableSubstitution(193),t.enableEmitNotification(265);var u,d,p,h,f,m,g,_=[],y=[],b=[],v=[];return function(t){if(t.isDeclarationFile||!(e.isEffectiveExternalModule(t,s)||67108864&t.transformFlags))return t;var r=e.getOriginalNodeId(t);u=t,m=t,d=_[r]=e.collectExternalModuleInfo(t,o,s),p=e.createUniqueName("exports"),b[r]=p,h=e.createUniqueName("context");var l=function(t){for(var n=e.createMap(),i=[],r=0;r<t.length;r++){var l=t[r],c=e.getExternalModuleNameLiteral(l,u,a,o,s);if(c){var d=c.text,p=n.get(d);void 0!==p?i[p].externalImports.push(l):(n.set(d,i.length),i.push({name:c,externalImports:[l]}))}}return i}(d.externalImports),c=function(t,r){var o=[];n();var a=s.alwaysStrict||!s.noImplicitUseStrict&&e.isExternalModule(u),l=e.addPrologue(o,t.statements,a,x);o.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration("__moduleName",void 0,e.createLogicalAnd(h,e.createPropertyAccess(h,"id")))]))),e.visitNode(d.externalHelpersImportDeclaration,x,e.isStatement);var c=e.visitNodes(t.statements,x,e.isStatement,l);e.addRange(o,f),e.addRange(o,i());var p=function(t){if(!d.hasExportStarsToExportValues)return;if(!d.exportedNames&&0===d.exportSpecifiers.size){for(var n=!1,i=0,r=d.externalImports;i<r.length;i++){if(244===(h=r[i]).kind&&h.exportClause){n=!0;break}}if(!n){var s=T(void 0);return t.push(s),s.name}}var o=[];if(d.exportedNames)for(var a=0,l=d.exportedNames;a<l.length;a++){var c=l[a];"default"!==c.escapedText&&o.push(e.createPropertyAssignment(e.createLiteral(c),e.createTrue()))}for(var u=0,p=d.externalImports;u<p.length;u++){var h;if(244===(h=p[u]).kind){var f=h;if(f.exportClause)for(var m=0,g=f.exportClause.elements;m<g.length;m++){var _=g[m];o.push(e.createPropertyAssignment(e.createLiteral(e.idText(_.name||_.propertyName)),e.createTrue()))}}}var y=e.createUniqueName("exportedNames");t.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(y,void 0,e.createObjectLiteral(o,!0))])));var b=T(y);return t.push(b),b.name}(o),m=e.createObjectLiteral([e.createPropertyAssignment("setters",k(p,r)),e.createPropertyAssignment("execute",e.createFunctionExpression(void 0,void 0,void 0,void 0,[],void 0,e.createBlock(c,!0)))]);return m.multiLine=!0,o.push(e.createReturn(m)),e.createBlock(o,!0)}(t,l),y=e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,p),e.createParameter(void 0,void 0,void 0,h)],void 0,c),E=e.tryGetModuleNameFromFile(t,a,s),S=e.createArrayLiteral(e.map(l,function(e){return e.name})),C=e.setEmitFlags(e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray([e.createStatement(e.createCall(e.createPropertyAccess(e.createIdentifier("System"),"register"),void 0,E?[E,S,y]:[S,y]))]),t.statements)),1024);s.outFile||s.out||e.moveEmitHelpers(C,c,function(e){return!e.scoped});g&&(v[r]=g,g=void 0);return u=void 0,d=void 0,p=void 0,h=void 0,f=void 0,m=void 0,e.aggregateTransformFlags(C)};function T(t){var n=e.createUniqueName("exportStar"),i=e.createIdentifier("m"),r=e.createIdentifier("n"),s=e.createIdentifier("exports"),o=e.createStrictInequality(r,e.createLiteral("default"));return t&&(o=e.createLogicalAnd(o,e.createLogicalNot(e.createCall(e.createPropertyAccess(t,"hasOwnProperty"),void 0,[r])))),e.createFunctionDeclaration(void 0,void 0,void 0,n,void 0,[e.createParameter(void 0,void 0,void 0,i)],void 0,e.createBlock([e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(s,void 0,e.createObjectLiteral([]))])),e.createForIn(e.createVariableDeclarationList([e.createVariableDeclaration(r,void 0)]),i,e.createBlock([e.setEmitFlags(e.createIf(o,e.createStatement(e.createAssignment(e.createElementAccess(s,r),e.createElementAccess(i,r)))),1)])),e.createStatement(e.createCall(p,void 0,[s]))],!0))}function k(t,n){for(var i=[],r=0,s=n;r<s.length;r++){for(var o=s[r],a=e.forEach(o.externalImports,function(t){return e.getLocalNameForExternalImport(t,u)}),l=a?e.getGeneratedNameForNode(a):e.createUniqueName(""),c=[],d=0,h=o.externalImports;d<h.length;d++){var f=h[d],m=e.getLocalNameForExternalImport(f,u);switch(f.kind){case 238:if(!f.importClause)break;case 237:e.Debug.assert(void 0!==m),c.push(e.createStatement(e.createAssignment(m,l)));break;case 244:if(e.Debug.assert(void 0!==m),f.exportClause){for(var g=[],_=0,y=f.exportClause.elements;_<y.length;_++){var b=y[_];g.push(e.createPropertyAssignment(e.createLiteral(e.idText(b.name)),e.createElementAccess(l,e.createLiteral(e.idText(b.propertyName||b.name)))))}c.push(e.createStatement(e.createCall(p,void 0,[e.createObjectLiteral(g,!0)])))}else c.push(e.createStatement(e.createCall(t,void 0,[l])))}}i.push(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,l)],void 0,e.createBlock(c,!0)))}return e.createArrayLiteral(i,!0)}function x(t){switch(t.kind){case 238:return function(t){var n;t.importClause&&r(e.getLocalNameForExternalImport(t,u));if(N(t)){var i=e.getOriginalNodeId(t);y[i]=D(y[i],t)}else n=D(n,t);return e.singleOrMany(n)}(t);case 237:return function(t){var n;if(e.Debug.assert(e.isExternalModuleImportEqualsDeclaration(t),"import= for internal module references should be handled in an earlier transformer."),r(e.getLocalNameForExternalImport(t,u)),N(t)){var i=e.getOriginalNodeId(t);y[i]=O(y[i],t)}else n=O(n,t);return e.singleOrMany(n)}(t);case 244:return;case 243:return function(t){if(t.isExportEquals)return;var n=e.visitNode(t.expression,H,e.isExpression),i=t.original;if(!i||!N(i))return B(e.createIdentifier("default"),n,!0);var r=e.getOriginalNodeId(t);y[r]=F(y[r],e.createIdentifier("default"),n,!0)}(t);default:return U(t)}}function E(t){if(e.isBindingPattern(t.name))for(var n=0,i=t.name.elements;n<i.length;n++){var s=i[n];e.isOmittedExpression(s)||E(s)}else r(e.getSynthesizedClone(t.name))}function S(t){return!(2097152&e.getEmitFlags(t)||265!==m.kind&&3&e.getOriginalNode(t).flags)}function C(n,i){var r=i?w:I;return e.isBindingPattern(n.name)?e.flattenDestructuringAssignment(n,H,t,0,!1,r):n.initializer?r(n.name,e.visitNode(n.initializer,H,e.isExpression)):n.name}function w(e,t,n){return A(e,t,n,!0)}function I(e,t,n){return A(e,t,n,!1)}function A(t,n,i,s){return r(e.getSynthesizedClone(t)),s?$(t,z(e.setTextRange(e.createAssignment(t,n),i))):z(e.setTextRange(e.createAssignment(t,n),i))}function N(t){return!!(4194304&e.getEmitFlags(t))}function D(e,t){if(d.exportEquals)return e;var n=t.importClause;if(!n)return e;n.name&&(e=M(e,n));var i=n.namedBindings;if(i)switch(i.kind){case 240:e=M(e,i);break;case 241:for(var r=0,s=i.elements;r<s.length;r++){e=M(e,s[r])}}return e}function O(e,t){return d.exportEquals?e:M(e,t)}function R(e,t,n){if(d.exportEquals)return e;for(var i=0,r=t.declarationList.declarations;i<r.length;i++){var s=r[i];(s.initializer||n)&&(e=L(e,s,n))}return e}function L(t,n,i){if(d.exportEquals)return t;if(e.isBindingPattern(n.name))for(var r=0,s=n.name.elements;r<s.length;r++){var o=s[r];e.isOmittedExpression(o)||(t=L(t,o,i))}else if(!e.isGeneratedIdentifier(n.name)){var a=void 0;i&&(t=F(t,n.name,e.getLocalName(n)),a=e.idText(n.name)),t=M(t,n,a)}return t}function P(t,n){if(d.exportEquals)return t;var i;if(e.hasModifier(n,1)){var r=e.hasModifier(n,512)?e.createLiteral("default"):n.name;t=F(t,r,e.getLocalName(n)),i=e.getTextOfIdentifierOrLiteral(r)}return n.name&&(t=M(t,n,i)),t}function M(t,n,i){if(d.exportEquals)return t;var r=e.getDeclarationName(n),s=d.exportSpecifiers.get(e.idText(r));if(s)for(var o=0,a=s;o<a.length;o++){var l=a[o];l.name.escapedText!==i&&(t=F(t,l.name,r))}return t}function F(t,n,i,r){return t=e.append(t,B(n,i,r))}function B(t,n,i){var r=e.createStatement($(t,n));return e.startOnNewLine(r),i||e.setEmitFlags(r,1536),r}function $(t,n){var i=e.isIdentifier(t)?e.createLiteral(t):t;return e.setEmitFlags(n,1536|e.getEmitFlags(n)),e.setCommentRange(e.createCall(p,void 0,[i,n]),n)}function U(n){switch(n.kind){case 208:return function(t){if(!S(t.declarationList))return e.visitNode(t,H,e.isStatement);for(var n,i,r=e.hasModifier(t,1),s=N(t),o=0,a=t.declarationList.declarations;o<a.length;o++){var l=a[o];l.initializer?n=e.append(n,C(l,r&&!s)):E(l)}if(n&&(i=e.append(i,e.setTextRange(e.createStatement(e.inlineExpressions(n)),t))),s){var c=e.getOriginalNodeId(t);y[c]=R(y[c],t,r)}else i=R(i,t,!1);return e.singleOrMany(i)}(n);case 228:return function(n){if(f=e.hasModifier(n,1)?e.append(f,e.updateFunctionDeclaration(n,n.decorators,e.visitNodes(n.modifiers,j,e.isModifier),n.asteriskToken,e.getDeclarationName(n,!0,!0),void 0,e.visitNodes(n.parameters,H,e.isParameterDeclaration),void 0,e.visitNode(n.body,H,e.isBlock))):e.append(f,e.visitEachChild(n,H,t)),N(n)){var i=e.getOriginalNodeId(n);y[i]=P(y[i],n)}else f=P(f,n)}(n);case 229:return function(t){var n,i=e.getLocalName(t);if(r(i),n=e.append(n,e.setTextRange(e.createStatement(e.createAssignment(i,e.setTextRange(e.createClassExpression(void 0,t.name,void 0,e.visitNodes(t.heritageClauses,H,e.isHeritageClause),e.visitNodes(t.members,H,e.isClassElement)),t))),t)),N(t)){var s=e.getOriginalNodeId(t);y[s]=P(y[s],t)}else n=P(n,t);return e.singleOrMany(n)}(n);case 214:return function(t){var n=m;return m=t,t=e.updateFor(t,V(t.initializer),e.visitNode(t.condition,H,e.isExpression),e.visitNode(t.incrementor,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement)),m=n,t}(n);case 215:return function(t){var n=m;return m=t,t=e.updateForIn(t,V(t.initializer),e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock)),m=n,t}(n);case 216:return function(t){var n=m;return m=t,t=e.updateForOf(t,t.awaitModifier,V(t.initializer),e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock)),m=n,t}(n);case 212:return function(t){return e.updateDo(t,e.visitNode(t.statement,U,e.isStatement,e.liftToBlock),e.visitNode(t.expression,H,e.isExpression))}(n);case 213:return function(t){return e.updateWhile(t,e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock))}(n);case 222:return function(t){return e.updateLabel(t,t.label,e.visitNode(t.statement,U,e.isStatement,e.liftToBlock))}(n);case 220:return function(t){return e.updateWith(t,e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock))}(n);case 221:return function(t){return e.updateSwitch(t,e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.caseBlock,U,e.isCaseBlock))}(n);case 235:return function(t){var n=m;return m=t,t=e.updateCaseBlock(t,e.visitNodes(t.clauses,U,e.isCaseOrDefaultClause)),m=n,t}(n);case 257:return function(t){return e.updateCaseClause(t,e.visitNode(t.expression,H,e.isExpression),e.visitNodes(t.statements,U,e.isStatement))}(n);case 258:case 224:return function(n){return e.visitEachChild(n,U,t)}(n);case 260:return function(t){var n=m;return m=t,t=e.updateCatchClause(t,t.variableDeclaration,e.visitNode(t.block,U,e.isBlock)),m=n,t}(n);case 207:return function(n){var i=m;return m=n,n=e.visitEachChild(n,U,t),m=i,n}(n);case 290:return function(t){if(N(t)&&208===t.original.kind){var n=e.getOriginalNodeId(t),i=e.hasModifier(t.original,1);y[n]=R(y[n],t.original,i)}return t}(n);case 291:return function(t){var n=e.getOriginalNodeId(t),i=y[n];return i?(delete y[n],e.append(i,t)):t}(n);default:return H(n)}}function V(n){if(!n)return n;if(function(t){return e.isVariableDeclarationList(t)&&S(t)}(n)){for(var i=void 0,r=0,s=n.declarations;r<s.length;r++){var o=s[r];i=e.append(i,C(o,!1)),o.initializer||E(o)}return i?e.inlineExpressions(i):e.createOmittedExpression()}return e.visitEachChild(n,U,t)}function H(n){return 1024&n.transformFlags&&194===n.kind?function(n){if(G(n.left))return e.flattenDestructuringAssignment(n,H,t,0,!0);return e.visitEachChild(n,H,t)}(n):e.isImportCall(n)?function(t){return e.createCall(e.createPropertyAccess(h,e.createIdentifier("import")),void 0,e.some(t.arguments)?[e.visitNode(t.arguments[0],H)]:[])}(n):2048&n.transformFlags||67108864&n.transformFlags?e.visitEachChild(n,H,t):n}function G(t){if(e.isAssignmentExpression(t,!0))return G(t.left);if(e.isSpreadElement(t))return G(t.expression);if(e.isObjectLiteralExpression(t))return e.some(t.properties,G);if(e.isArrayLiteralExpression(t))return e.some(t.elements,G);if(e.isShorthandPropertyAssignment(t))return G(t.name);if(e.isPropertyAssignment(t))return G(t.initializer);if(e.isIdentifier(t)){var n=o.getReferencedExportContainer(t);return void 0!==n&&265===n.kind}return!1}function j(e){switch(e.kind){case 84:case 79:return}return e}function K(t){var n;if(!e.isGeneratedIdentifier(t)){var i=o.getReferencedImportDeclaration(t)||o.getReferencedValueDeclaration(t);if(i){var r=o.getReferencedExportContainer(t,!1);r&&265===r.kind&&(n=e.append(n,e.getDeclarationName(i))),n=e.addRange(n,d&&d.exportedBindings[e.getOriginalNodeId(i)])}}return n}function z(t){return void 0===g&&(g=[]),g[e.getNodeId(t)]=!0,t}}}(ts||(ts={})),function(e){e.transformES2015Module=function(t){var n,i=t.getCompilerOptions(),r=t.onEmitNode,s=t.onSubstituteNode;return t.onEmitNode=function(t,i,s){e.isSourceFile(i)?(n=i,r(t,i,s),n=void 0):r(t,i,s)},t.onSubstituteNode=function(t,i){if(i=s(t,i),e.isIdentifier(i)&&1===t)return function(t){if(4096&e.getEmitFlags(t)){var i=e.getExternalHelpersModuleName(n);if(i)return e.createPropertyAccess(i,t)}return t}(i);return i},t.enableEmitNotification(265),t.enableSubstitution(71),function(n){if(n.isDeclarationFile)return n;if(e.isExternalModule(n)||i.isolatedModules){var r=e.getOrCreateExternalHelpersModuleNameIfNeeded(n,i);if(r){var s=[],a=e.addPrologue(s,n.statements);return e.append(s,e.createImportDeclaration(void 0,void 0,e.createImportClause(void 0,e.createNamespaceImport(r)),e.createLiteral(e.externalHelpersModuleNameText))),e.addRange(s,e.visitNodes(n.statements,o,e.isStatement,a)),e.updateSourceFileNode(n,e.setTextRange(e.createNodeArray(s),n.statements))}return e.visitEachChild(n,o,t)}return n};function o(e){switch(e.kind){case 237:return;case 243:return function(e){return e.isExportEquals?void 0:e}(e)}return e}}}(ts||(ts={})),function(e){var t,n;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",e[e.Completed=2]="Completed",e[e.Disposed=3]="Disposed"}(t||(t={})),function(e){e[e.Substitution=1]="Substitution",e[e.EmitNotifications=2]="EmitNotifications"}(n||(n={})),e.getTransformers=function(t,n){var i=t.jsx,r=e.getEmitScriptTarget(t),s=e.getEmitModuleKind(t),o=[];return e.addRange(o,n&&n.before),o.push(e.transformTypeScript),2===i&&o.push(e.transformJsx),r<5&&o.push(e.transformESNext),r<4&&o.push(e.transformES2017),r<3&&o.push(e.transformES2016),r<2&&(o.push(e.transformES2015),o.push(e.transformGenerators)),o.push(function(t){switch(t){case e.ModuleKind.ESNext:case e.ModuleKind.ES2015:return e.transformES2015Module;case e.ModuleKind.System:return e.transformSystemModule;default:return e.transformModule}}(s)),r<1&&o.push(e.transformES5),e.addRange(o,n&&n.after),o},e.transformNodes=function(t,n,i,r,s,o){for(var a,l,c,u=new Array(292),d=[],p=[],h=0,f=!1,m=function(e,t){return t},g=function(e,t,n){return n(e,t)},_=0,y={getCompilerOptions:function(){return i},getEmitResolver:function(){return t},getEmitHost:function(){return n},startLexicalEnvironment:function(){e.Debug.assert(_>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(_<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(!f,"Lexical environment is suspended."),d[h]=a,p[h]=l,h++,a=void 0,l=void 0},suspendLexicalEnvironment:function(){e.Debug.assert(_>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(_<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(!f,"Lexical environment is already suspended."),f=!0},resumeLexicalEnvironment:function(){e.Debug.assert(_>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(_<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(f,"Lexical environment is not suspended."),f=!1},endLexicalEnvironment:function(){var t;if(e.Debug.assert(_>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(_<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(!f,"Lexical environment is suspended."),(a||l)&&(l&&(t=l.slice()),a)){var n=e.createVariableStatement(void 0,e.createVariableDeclarationList(a));t?t.push(n):t=[n]}h--,a=d[h],l=p[h],0===h&&(d=[],p=[]);return t},hoistVariableDeclaration:function(t){e.Debug.assert(_>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(_<2,"Cannot modify the lexical environment after transformation has completed.");var n=e.setEmitFlags(e.createVariableDeclaration(t),64);a?a.push(n):a=[n]},hoistFunctionDeclaration:function(t){e.Debug.assert(_>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(_<2,"Cannot modify the lexical environment after transformation has completed."),l?l.push(t):l=[t]},requestEmitHelper:function(t){e.Debug.assert(_>0,"Cannot modify the transformation context during initialization."),e.Debug.assert(_<2,"Cannot modify the transformation context after transformation has completed."),e.Debug.assert(!t.scoped,"Cannot request a scoped emit helper."),c=e.append(c,t)},readEmitHelpers:function(){e.Debug.assert(_>0,"Cannot modify the transformation context during initialization."),e.Debug.assert(_<2,"Cannot modify the transformation context after transformation has completed.");var t=c;return c=void 0,t},enableSubstitution:function(t){e.Debug.assert(_<2,"Cannot modify the transformation context after transformation has completed."),u[t]|=1},enableEmitNotification:function(t){e.Debug.assert(_<2,"Cannot modify the transformation context after transformation has completed."),u[t]|=2},isSubstitutionEnabled:E,isEmitNotificationEnabled:S,get onSubstituteNode(){return m},set onSubstituteNode(t){e.Debug.assert(_<1,"Cannot modify transformation hooks after initialization has completed."),e.Debug.assert(void 0!==t,"Value must not be 'undefined'"),m=t},get onEmitNode(){return g},set onEmitNode(t){e.Debug.assert(_<1,"Cannot modify transformation hooks after initialization has completed."),e.Debug.assert(void 0!==t,"Value must not be 'undefined'"),g=t}},b=0,v=r;b<v.length;b++){var T=v[b];e.disposeEmitNodes(e.getSourceFileOfNode(e.getParseTreeNode(T)))}e.performance.mark("beforeTransform");var k=e.chain.apply(void 0,s)(y);_=1;var x=e.map(r,o?k:function(t){return!t||e.isSourceFile(t)&&t.isDeclarationFile?t:k(t)});return _=2,e.performance.mark("afterTransform"),e.performance.measure("transformTime","beforeTransform","afterTransform"),{transformed:x,substituteNode:function(t,n){return e.Debug.assert(_<3,"Cannot substitute a node after the result is disposed."),n&&E(n)&&m(t,n)||n},emitNodeWithNotification:function(t,n,i){e.Debug.assert(_<3,"Cannot invoke TransformationResult callbacks after the result is disposed."),n&&(S(n)?g(t,n,i):i(t,n))},dispose:function(){if(_<3){for(var t=0,n=r;t<n.length;t++){var i=n[t];e.disposeEmitNodes(e.getSourceFileOfNode(e.getParseTreeNode(i)))}a=void 0,d=void 0,l=void 0,p=void 0,m=void 0,g=void 0,c=void 0,_=3}}};function E(t){return!(!(1&u[t.kind])||4&e.getEmitFlags(t))}function S(t){return!!(2&u[t.kind])||!!(2&e.getEmitFlags(t))}}}(ts||(ts={})),function(e){var t={emittedLine:1,emittedColumn:1,sourceLine:1,sourceColumn:1,sourceIndex:0};e.createSourceMapWriter=function(n,i){var s,o,a,l,c,u,d,p,h=n.getCompilerOptions(),f=h.extendedDiagnostics,m=!(h.sourceMap||h.inlineSourceMap);return{initialize:function(i,r,f){if(m)return;p&&_();s=void 0,o=void 0,l=-1,c=void 0,u=t,d=0,(p={sourceMapFilePath:r,jsSourceMappingURL:h.inlineSourceMap?void 0:e.getBaseFileName(e.normalizeSlashes(r)),sourceMapFile:e.getBaseFileName(e.normalizeSlashes(i)),sourceMapSourceRoot:h.sourceRoot||"",sourceMapSources:[],inputSourceFileNames:[],sourceMapNames:[],sourceMapMappings:"",sourceMapSourcesContent:h.inlineSources?[]:void 0,sourceMapDecodedMappings:[]}).sourceMapSourceRoot=e.normalizeSlashes(p.sourceMapSourceRoot),p.sourceMapSourceRoot.length&&47!==p.sourceMapSourceRoot.charCodeAt(p.sourceMapSourceRoot.length-1)&&(p.sourceMapSourceRoot+=e.directorySeparator);h.mapRoot?(a=e.normalizeSlashes(h.mapRoot),265===f.kind&&(a=e.getDirectoryPath(e.getSourceFilePathInNewDir(f,n,a))),e.isRootedDiskPath(a)||e.isUrl(a)?p.jsSourceMappingURL=e.combinePaths(a,p.jsSourceMappingURL):(a=e.combinePaths(n.getCommonSourceDirectory(),a),p.jsSourceMappingURL=e.getRelativePathToDirectoryOrUrl(e.getDirectoryPath(e.normalizePath(i)),e.combinePaths(a,p.jsSourceMappingURL),n.getCurrentDirectory(),n.getCanonicalFileName,!0))):a=e.getDirectoryPath(e.normalizePath(i))},reset:_,getSourceMapData:function(){return p},setSourceFile:v,emitPos:b,emitNodeWithSourceMap:function(e,t,n){if(m)return n(e,t);if(t){var i=t.emitNode,r=i&&i.flags,o=i&&i.sourceMapRange,a=o||t,l=a.pos,c=a.end,u=o&&o.source,d=s;u===d&&(u=void 0),u&&v(u),287!==t.kind&&!(16&r)&&l>=0&&b(g(l)),u&&v(d),64&r?(m=!0,n(e,t),m=!1):n(e,t),u&&v(u),287!==t.kind&&!(32&r)&&c>=0&&b(c),u&&v(d)}},emitTokenWithSourceMap:function(e,t,n,i){if(m)return i(t,n);var r=e&&e.emitNode,s=r&&r.flags,o=r&&r.tokenSourceMapRanges&&r.tokenSourceMapRanges[t];n=g(o?o.pos:n),!(128&s)&&n>=0&&b(n);n=i(t,n),o&&(n=o.end);!(256&s)&&n>=0&&b(n);return n},getText:T,getSourceMappingURL:function(){if(m)return;if(h.inlineSourceMap){var t=e.convertToBase64(T());return p.jsSourceMappingURL="data:application/json;base64,"+t}return p.jsSourceMappingURL}};function g(t){return s.skipTrivia?s.skipTrivia(t):e.skipTrivia(o,t)}function _(){m||(s=void 0,a=void 0,l=void 0,c=void 0,u=void 0,d=void 0,p=void 0)}function y(){if(c&&c!==u){var t=u.emittedColumn;if(u.emittedLine===c.emittedLine)p.sourceMapMappings&&(p.sourceMapMappings+=",");else{for(var n=u.emittedLine;n<c.emittedLine;n++)p.sourceMapMappings+=";";t=1}p.sourceMapMappings+=r(c.emittedColumn-t),p.sourceMapMappings+=r(c.sourceIndex-u.sourceIndex),p.sourceMapMappings+=r(c.sourceLine-u.sourceLine),p.sourceMapMappings+=r(c.sourceColumn-u.sourceColumn),c.nameIndex>=0&&(e.Debug.assert(!1,"We do not support name index right now, Make sure to update updateLastEncodedAndRecordedSpans when we start using this"),p.sourceMapMappings+=r(c.nameIndex-d),d=c.nameIndex),u=c,p.sourceMapDecodedMappings.push(u)}}function b(t){if(!m&&!e.positionIsSynthesized(t)){f&&e.performance.mark("beforeSourcemap");var n=e.getLineAndCharacterOfPosition(s,t);n.line++,n.character++;var r=i.getLine(),o=i.getColumn();!c||c.emittedLine!==r||c.emittedColumn!==o||c.sourceIndex===l&&(c.sourceLine>n.line||c.sourceLine===n.line&&c.sourceColumn>n.character)?(y(),c={emittedLine:r,emittedColumn:o,sourceLine:n.line,sourceColumn:n.character,sourceIndex:l}):(c.sourceLine=n.line,c.sourceColumn=n.character,c.sourceIndex=l),f&&(e.performance.mark("afterSourcemap"),e.performance.measure("Source Map","beforeSourcemap","afterSourcemap"))}}function v(t){if(!m){o=(s=t).text;var i=h.sourceRoot?n.getCommonSourceDirectory():a,r=e.getRelativePathToDirectoryOrUrl(i,s.fileName,n.getCurrentDirectory(),n.getCanonicalFileName,!0);-1===(l=e.indexOf(p.sourceMapSources,r))&&(l=p.sourceMapSources.length,p.sourceMapSources.push(r),p.inputSourceFileNames.push(s.fileName),h.inlineSources&&p.sourceMapSourcesContent.push(s.text))}}function T(){if(!m)return y(),JSON.stringify({version:3,file:p.sourceMapFile,sourceRoot:p.sourceMapSourceRoot,sources:p.sourceMapSources,names:p.sourceMapNames,mappings:p.sourceMapMappings,sourcesContent:p.sourceMapSourcesContent})}};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function i(e){if(e<64)return n.charAt(e);throw TypeError(e+": not a 64 based value")}function r(e){e<0?e=1+(-e<<1):e<<=1;var t="";do{var n=31&e;(e>>=5)>0&&(n|=32),t+=i(n)}while(e>0);return t}}(ts||(ts={})),function(e){e.createCommentWriter=function(t,n){var i,r,s,o,a,l=t.extendedDiagnostics,c=e.getNewLineCharacter(t),u=-1,d=-1,p=-1,h=!1,f=t.removeComments;return{reset:function(){r=void 0,s=void 0,o=void 0,a=void 0},setWriter:function(e){i=e},setSourceFile:function(t){s=(r=t).text,o=e.getLineStarts(r),a=void 0},emitNodeWithComments:function(t,n,i){if(f)return void i(t,n);if(n){h=!1;var r=n.emitNode,s=r&&r.flags,o=r&&r.commentRange||n,a=o.pos,c=o.end;if(a<0&&c<0||a===c)m(t,n,r,s,i);else{l&&e.performance.mark("preEmitNodeWithComment");var g=287!==n.kind,_=a<0||!!(512&s)||10===n.kind,y=c<0||!!(1024&s)||10===n.kind;_||b(a,g);var v=u,T=d,x=p;_||(u=a),y||(d=c,227===n.kind&&(p=c)),l&&e.performance.measure("commentTime","preEmitNodeWithComment"),m(t,n,r,s,i),l&&e.performance.mark("postEmitNodeWithComment"),u=v,d=T,p=x,!y&&g&&function(e){S(e,k)}(c),l&&e.performance.measure("commentTime","postEmitNodeWithComment")}}},emitBodyWithDetachedComments:function(t,n,r){l&&e.performance.mark("preEmitBodyWithDetachedComments");var u=n.pos,d=n.end,p=e.getEmitFlags(t),m=f||d<0||!!(1024&p);u<0||512&p||(g=n,(_=e.emitDetachedComments(s,o,i,C,g,c,f))&&(a?a.push(_):a=[_]));var g,_;l&&e.performance.measure("commentTime","preEmitBodyWithDetachedComments");2048&p&&!f?(f=!0,r(t),f=!1):r(t);l&&e.performance.mark("beginEmitBodyWithDetachedCommetns");m||(b(n.end,!0),h&&!i.isAtStartOfLine()&&i.writeLine());l&&e.performance.measure("commentTime","beginEmitBodyWithDetachedCommetns")},emitTrailingCommentsOfPosition:function(t,n){if(f)return;l&&e.performance.mark("beforeEmitTrailingCommentsOfPosition");S(t,n?k:x),l&&e.performance.measure("commentTime","beforeEmitTrailingCommentsOfPosition")},emitLeadingCommentsOfPosition:function(e){if(f||-1===e)return;b(e,!0)}};function m(t,n,i,r,s){var o=i&&i.leadingComments;e.some(o)&&(l&&e.performance.mark("preEmitNodeWithSynthesizedComments"),e.forEach(o,g),l&&e.performance.measure("commentTime","preEmitNodeWithSynthesizedComments")),function(e,t,n,i){2048&n?(f=!0,i(e,t),f=!1):i(e,t)}(t,n,r,s);var a=i&&i.trailingComments;e.some(a)&&(l&&e.performance.mark("postEmitNodeWithSynthesizedComments"),e.forEach(a,_),l&&e.performance.measure("commentTime","postEmitNodeWithSynthesizedComments"))}function g(e){2===e.kind&&i.writeLine(),y(e),e.hasTrailingNewLine||2===e.kind?i.writeLine():i.write(" ")}function _(e){i.isAtStartOfLine()||i.write(" "),y(e),e.hasTrailingNewLine&&i.writeLine()}function y(t){var n=function(e){return 3===e.kind?"/*"+e.text+"*/":"//"+e.text}(t),r=3===t.kind?e.computeLineStarts(n):void 0;e.writeCommentRange(n,r,i,0,n.length,c)}function b(e,t){h=!1,t?E(e,T):0===e&&E(e,v)}function v(t,n,i,r,o){(function(t,n){return e.isRecognizedTripleSlashComment(s,t,n)})(t,n)&&T(t,n,i,r,o)}function T(t,r,a,l,u){h||(e.emitNewLineBeforeLeadingCommentOfPosition(o,i,u,t),h=!0),n&&n(t),e.writeCommentRange(s,o,i,t,r,c),n&&n(r),l?i.writeLine():i.write(" ")}function k(t,r,a,l){i.isAtStartOfLine()||i.write(" "),n&&n(t),e.writeCommentRange(s,o,i,t,r,c),n&&n(r),l&&i.writeLine()}function x(t,r,a,l){n&&n(t),e.writeCommentRange(s,o,i,t,r,c),n&&n(r),l?i.writeLine():i.write(" ")}function E(t,n){-1!==u&&t===u||(function(t){return void 0!==a&&e.lastOrUndefined(a).nodePos===t}(t)?function(t){var n=e.lastOrUndefined(a).detachedCommentEndPos;a.length-1?a.pop():a=void 0;e.forEachLeadingCommentRange(s,n,t,n)}(n):e.forEachLeadingCommentRange(s,t,n,t))}function S(t,n){(-1===d||t!==d&&t!==p)&&e.forEachTrailingCommentRange(s,t,n)}function C(t,i,r,s,o,a){n&&n(s),e.writeCommentRange(t,i,r,s,o,a),n&&n(o)}}}(ts||(ts={})),function(e){function t(t,n,i,r,s,o){var a,l,c,u,d,p,h,f,m,g,_,y,b=266===s.kind?s.sourceFiles:[s],v=266===s.kind,T=t.getNewLine(),k=t.getCompilerOptions();M();var x,E,S,C=!1,w=k.removeComments?e.noop:function(t){if(t){var n=e.getJSDocCommentRanges(t,m,k);e.emitNewLineBeforeLeadingComments(g,p,t,n),e.emitComments(m,g,p,n,!1,!0,T,e.writeCommentRange)}},I=k.stripInternal?function(t){if(t){var n=e.getLeadingCommentRanges(m,t.pos);if(e.forEach(n,P))return;_e(t)}}:_e,A=!0,N=[],D="",O=[],R=!1,L=[];return e.forEach(b,function(n){if(!e.isSourceFileJavaScript(n)){if(k.noResolve||e.forEach(n.referencedFiles,function(i){var s=e.tryResolveScriptReference(t,n,i);s&&!e.contains(O,s)&&(function(n,i,s){var o,a=!1;n.isDeclarationFile?o=n.fileName:e.forEachEmittedFile(t,l,n,s);o&&(o=e.getRelativePathToDirectoryOrUrl(e.getDirectoryPath(e.normalizeSlashes(r)),o,t.getCurrentDirectory(),t.getCanonicalFileName,!1),D+='/// <reference path="'+o+'" />'+T);return a;function l(t,r){var s=266===r.kind;s&&!i||(e.Debug.assert(!!t.declarationFilePath||e.isSourceFileJavaScript(n),"Declaration file is not present only for javascript files"),o=t.declarationFilePath||t.jsFilePath,a=s)}}(s,!v&&!R,o)&&(R=!0),O.push(s))}),f=!1,v&&e.isExternalModule(n)?e.isExternalModule(n)&&(A=!1,a('declare module "'+e.getResolvedExternalModuleName(t,n)+'" {'),l(),c(),Y(n),u(),a("}"),l()):(A=!0,Y(n)),N.length){var i=p;e.forEach(N,function(t){if(t.isVisible&&!t.asynchronousOutput){e.Debug.assert(238===t.node.kind),M(),e.Debug.assert(0===t.indent||1===t.indent&&v);for(var n=0;n<t.indent;n++)c();ie(t.node),t.asynchronousOutput=p.getText();for(n=0;n<t.indent;n++)u()}}),F(i),L=L.concat(N),N=[]}!v&&e.isExternalModule(n)&&n.moduleAugmentations.length&&!f&&(a("export {};"),l())}}),S&&e.forEachKey(S,function(e){D+='/// <reference types="'+e+'" />'+T}),{reportedDeclarationError:C,moduleElementDeclarationEmitInfo:L,synchronousDeclarationOutput:p.getText(),referencesOutput:D};function P(t){var n=m.substring(t.pos,t.end);return e.stringContains(n,"@internal")}function M(){var t=e.createTextWriter(T);t.trackSymbol=V,t.reportInaccessibleThisError=G,t.reportPrivateInBaseOfClassExpression=H,t.writeKeyword=t.write,t.writeOperator=t.write,t.writePunctuation=t.write,t.writeSpace=t.write,t.writeStringLiteral=t.writeLiteral,t.writeParameter=t.write,t.writeProperty=t.write,t.writeSymbol=t.write,F(t)}function F(e){p=e,a=e.write,d=e.writeTextOfNode,l=e.writeLine,c=e.increaseIndent,u=e.decreaseIndent}function B(t){var n=p;e.forEach(t,function(t){var n;226===t.kind?n=t.parent.parent:241===t.kind||242===t.kind||239===t.kind?e.Debug.fail("We should be getting ImportDeclaration instead to write"):n=t;var i=e.forEach(N,function(e){return e.node===n?e:void 0});if(!i&&E&&(i=e.forEach(E,function(e){return e.node===n?e:void 0})),i)if(238===i.node.kind)i.isVisible=!0;else{M();for(var r=i.indent;r;r--)c();233===n.kind&&(e.Debug.assert(void 0===E),E=[]),Q(n),233===n.kind&&(i.subModuleElementDeclarationEmitInfo=E,E=void 0),i.asynchronousOutput=p.getText()}}),F(n)}function $(t){if(t){S||(S=e.createMap());for(var n=0,i=t;n<i.length;n++){var r=i[n];S.has(r)||S.set(r,r)}}}function U(t){if(0===t.accessibility)t&&t.aliasesToMakeVisible&&B(t.aliasesToMakeVisible);else{C=!0;var n=p.getSymbolAccessibilityDiagnostic(t);n&&(n.typeName?i.add(e.createDiagnosticForNode(t.errorNode||n.errorNode,n.diagnosticMessage,e.getTextOfNodeFromSourceText(m,n.typeName),t.errorSymbolName,t.errorModuleName)):i.add(e.createDiagnosticForNode(t.errorNode||n.errorNode,n.diagnosticMessage,t.errorSymbolName,t.errorModuleName)))}}function V(e,t,i){U(n.isSymbolAccessible(e,t,i,!0)),$(n.getTypeReferenceDirectivesForSymbol(e,i))}function H(t){x&&(C=!0,i.add(e.createDiagnosticForNode(x,e.Diagnostics.Property_0_of_exported_class_expression_may_not_be_private_or_protected,t)))}function G(){x&&(C=!0,i.add(e.createDiagnosticForNode(x,e.Diagnostics.The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary,e.declarationNameToString(x))))}function j(e,t,i){p.getSymbolAccessibilityDiagnostic=i,a(": ");var r=146===e.kind&&(n.isRequiredInitializedParameter(e)||n.isOptionalUninitializedParameterProperty(e));if(t&&!r)J(t);else{x=e.name;var s=16388|(r?8192:0);n.writeTypeOfDeclaration(e,h,s,p),x=void 0}}function K(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];I(i)}}function z(e,t,n,i){for(var r=p.getTextPos(),s=0,o=e;s<o.length;s++){var l=o[s];i&&!i(l)||(r!==p.getTextPos()&&a(t),r=p.getTextPos(),n(l))}}function W(e,t,n){z(e,", ",t,n)}function q(e,t){p.getSymbolAccessibilityDiagnostic=t,J(e)}function J(t){switch(t.kind){case 119:case 136:case 133:case 122:case 134:case 137:case 105:case 139:case 95:case 130:case 169:case 173:return d(m,t);case 201:return i=t,void(e.isEntityNameExpression(i.expression)&&(e.Debug.assert(71===i.expression.kind||179===i.expression.kind),s(i.expression),i.typeArguments&&(a("<"),W(i.typeArguments,J),a(">"))));case 159:return function(e){s(e.typeName),e.typeArguments&&(a("<"),W(e.typeArguments,J),a(">"))}(t);case 162:return function(e){a("typeof "),s(e.exprName)}(t);case 164:return function(e){J(e.elementType),a("[]")}(t);case 165:return function(e){a("["),W(e.elementTypes,J),a("]")}(t);case 166:return function(e){z(e.types," | ",J)}(t);case 167:return function(e){z(e.types," & ",J)}(t);case 168:return function(e){a("("),J(e.type),a(")")}(t);case 170:return function(t){a(e.tokenToString(t.operator)),a(" "),J(t.type)}(t);case 171:return function(e){J(e.objectType),a("["),J(e.indexType),a("]")}(t);case 172:return function(e){var t=h;h=e,a("{"),l(),c(),e.readonlyToken&&a("readonly ");a("["),r(e.typeParameter.name),a(" in "),J(e.typeParameter.constraint),a("]"),e.questionToken&&a("?");a(": "),J(e.type),a(";"),l(),u(),a("}"),h=t}(t);case 160:case 161:return fe(t);case 163:return function(e){a("{"),e.members.length&&(l(),c(),K(e.members),u());a("}")}(t);case 71:case 143:return s(t);case 158:return function(e){d(m,e.parameterName),a(" is "),J(e.type)}(t)}var i;function r(e){if(71===e.kind)d(m,e);else{var t=143===e.kind?e.left:e.expression,n=143===e.kind?e.right:e.name;r(t),a("."),d(m,n)}}function s(e){U(n.isEntityNameVisible(e,237===e.parent.kind?e.parent:h)),$(n.getTypeReferenceDirectivesForEntityName(e)),r(e)}}function Y(t){m=t.text,g=e.getLineStarts(t),_=t.identifiers,y=e.isExternalModule(t),h=t,e.emitDetachedComments(m,g,p,e.writeCommentRange,t,T,!0),K(t.statements)}function X(e,t,i,r){var s=function(e){if(!_.has(e))return e;for(var t=0;;){var n=e+"_"+ ++t;if(!_.has(n))return n}}(t);return r&&a("declare "),a("const "),a(s),a(": "),p.getSymbolAccessibilityDiagnostic=function(){return i},n.writeTypeOfExpression(e,h,16388,p),a(";"),l(),s}function Z(e,t){if(t)Q(e);else if(237===e.kind||265===e.parent.kind&&y){var i=void 0;if(E&&265!==e.parent.kind)E.push({node:e,outputPos:p.getTextPos(),indent:p.getIndent(),isVisible:i});else{if(238===e.kind){var r=e;r.importClause&&(i=r.importClause.name&&n.isDeclarationVisible(r.importClause)||ne(r.importClause.namedBindings))}N.push({node:e,outputPos:p.getTextPos(),indent:p.getIndent(),isVisible:i})}}}function Q(t){switch(t.kind){case 228:return he(t);case 208:return function(t){if(e.every(t.declarationList&&t.declarationList.declarations,function(t){return t.name&&e.isEmptyBindingPattern(t.name)}))return;w(t),ee(t),e.isLet(t.declarationList)?a("let "):e.isConst(t.declarationList)?a("const "):a("var ");W(t.declarationList.declarations,de,n.isDeclarationVisible),a(";"),l()}(t);case 230:return function(t){w(t),ee(t),a("interface "),d(m,t.name);var n=h;h=t,le(t.typeParameters);var i=e.filter(e.getInterfaceBaseTypeNodes(t),function(t){return e.isEntityNameExpression(t.expression)});i&&i.length&&ce(i,!1);a(" {"),l(),c(),K(t.members),u(),a("}"),l(),h=n}(t);case 229:return function(t){function n(t){t&&e.forEach(t.parameters,function(t){e.hasModifier(t,92)&&ue(t)})}var i=h;h=t;var r,s=e.getClassExtendsHeritageClauseElement(t);s&&!e.isEntityNameExpression(s.expression)&&(r=95===s.expression.kind?"null":X(s.expression,t.name.escapedText+"_base",{diagnosticMessage:e.Diagnostics.extends_clause_of_exported_class_0_has_or_is_using_private_name_1,errorNode:s,typeName:t.name},!e.findAncestor(t,function(e){return 233===e.kind})));w(t),ee(t),e.hasModifier(t,128)&&a("abstract ");a("class "),d(m,t.name),le(t.typeParameters),s&&(e.isEntityNameExpression(s.expression)?ce([s],!1):(a(" extends "),a(r),s.typeArguments&&(a("<"),W(s.typeArguments,J),a(">"))));ce(e.getClassImplementsHeritageClauseElements(t),!0),a(" {"),l(),c(),n(e.getFirstConstructorWithBody(t)),K(t.members),u(),a("}"),l(),h=i}(t);case 231:return function(t){var n=h;function i(){return{diagnosticMessage:e.Diagnostics.Exported_type_alias_0_has_or_is_using_private_name_1,errorNode:t.type,typeName:t.name}}h=t,w(t),ee(t),a("type "),d(m,t.name),le(t.typeParameters),a(" = "),q(t.type,i),a(";"),l(),h=n}(t);case 232:return function(t){w(t),ee(t),e.isConst(t)&&a("const ");a("enum "),d(m,t.name),a(" {"),l(),c(),K(t.members),u(),a("}"),l()}(t);case 233:return function(t){w(t),ee(t),e.isGlobalScopeAugmentation(t)?a("global "):(16&t.flags?a("namespace "):a("module "),e.isExternalModuleAugmentation(t)?re(t):d(m,t.name));for(;t.body&&234!==t.body.kind;)t=t.body,a("."),d(m,t.name);var n=h;t.body?(h=t,a(" {"),l(),c(),K(t.body.statements),u(),a("}"),l(),h=n):a(";")}(t);case 237:return function(t){w(t),e.hasModifier(t,1)&&a("export ");a("import "),d(m,t.name),a(" = "),e.isInternalModuleImportEqualsDeclaration(t)?(q(t.moduleReference,n),a(";")):(a("require("),re(t),a(");"));function n(){return{diagnosticMessage:e.Diagnostics.Import_declaration_0_is_using_private_name_1,errorNode:t,typeName:t.name}}p.writeLine()}(t);case 238:return ie(t);default:e.Debug.fail("Unknown symbol kind")}}function ee(t){if(265===t.parent.kind){var n=e.getModifierFlags(t);1&n&&a("export "),512&n?a("default "):230!==t.kind&&A&&a("declare ")}}function te(e){8&e?a("private "):16&e&&a("protected "),32&e&&a("static "),64&e&&a("readonly "),128&e&&a("abstract ")}function ne(t){if(t)return 240===t.kind?n.isDeclarationVisible(t):e.forEach(t.elements,function(e){return n.isDeclarationVisible(e)})}function ie(t){if(w(t),e.hasModifier(t,1)&&a("export "),a("import "),t.importClause){var i=p.getTextPos();t.importClause.name&&n.isDeclarationVisible(t.importClause)&&d(m,t.importClause.name),t.importClause.namedBindings&&ne(t.importClause.namedBindings)&&(i!==p.getTextPos()&&a(", "),240===t.importClause.namedBindings.kind?(a("* as "),d(m,t.importClause.namedBindings.name)):(a("{ "),W(t.importClause.namedBindings.elements,se,n.isDeclarationVisible),a(" }"))),a(" from ")}re(t),a(";"),p.writeLine()}function re(i){var r;if(f=f||233!==i.kind,237===i.kind){var s=i;r=e.getExternalModuleImportEqualsDeclarationExpression(s)}else if(233===i.kind)r=i.name;else{r=(s=i).moduleSpecifier}if(9===r.kind&&v&&(k.out||k.outFile)){var o=e.getExternalModuleNameFromDeclaration(t,n,i);if(o)return a('"'),a(o),void a('"')}d(m,r)}function se(e){e.propertyName&&(d(m,e.propertyName),a(" as ")),d(m,e.name)}function oe(e){se(e),B(n.collectLinkedAliases(e.propertyName||e.name))}function ae(t){return 151===t.parent.kind&&e.hasModifier(t.parent,8)}function le(t){t&&(a("<"),W(t,function(t){function n(){var n;switch(t.parent.kind){case 229:n=e.Diagnostics.Type_parameter_0_of_exported_class_has_or_is_using_private_name_1;break;case 230:n=e.Diagnostics.Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1;break;case 156:n=e.Diagnostics.Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1;break;case 155:n=e.Diagnostics.Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1;break;case 151:case 150:n=e.hasModifier(t.parent,32)?e.Diagnostics.Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:229===t.parent.parent.kind?e.Diagnostics.Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:e.Diagnostics.Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1;break;case 228:n=e.Diagnostics.Type_parameter_0_of_exported_function_has_or_is_using_private_name_1;break;case 231:n=e.Diagnostics.Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1;break;default:e.Debug.fail("This is unknown parent for type parameter: "+t.parent.kind)}return{diagnosticMessage:n,errorNode:t,typeName:t.name}}c(),w(t),u(),d(m,t.name),t.constraint&&!ae(t)&&(a(" extends "),160===t.parent.kind||161===t.parent.kind||t.parent.parent&&163===t.parent.parent.kind?(e.Debug.assert(151===t.parent.kind||150===t.parent.kind||160===t.parent.kind||161===t.parent.kind||155===t.parent.kind||156===t.parent.kind),J(t.constraint)):q(t.constraint,n)),t.default&&!ae(t)&&(a(" = "),160===t.parent.kind||161===t.parent.kind||t.parent.parent&&163===t.parent.parent.kind?(e.Debug.assert(151===t.parent.kind||150===t.parent.kind||160===t.parent.kind||161===t.parent.kind||155===t.parent.kind||156===t.parent.kind),J(t.default)):q(t.default,n))}),a(">"))}function ce(t,n){t&&(a(n?" implements ":" extends "),W(t,function(t){e.isEntityNameExpression(t.expression)?q(t,i):n||95!==t.expression.kind||a("null");function i(){return{diagnosticMessage:229===t.parent.parent.kind?n?e.Diagnostics.Implements_clause_of_exported_class_0_has_or_is_using_private_name_1:e.Diagnostics.extends_clause_of_exported_class_0_has_or_is_using_private_name_1:e.Diagnostics.extends_clause_of_exported_interface_0_has_or_is_using_private_name_1,errorNode:t,typeName:e.getNameOfDeclaration(t.parent.parent)}}}))}function ue(t){e.hasDynamicName(t)||(w(t),te(e.getModifierFlags(t)),de(t),a(";"),l())}function de(t){function i(n){return 226===t.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Exported_variable_0_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Exported_variable_0_has_or_is_using_private_name_1:149===t.kind||148===t.kind||146===t.kind&&e.hasModifier(t.parent,8)?e.hasModifier(t,32)?n.errorModuleName?2===n.accessibility?e.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_private_name_1:229===t.parent.kind||146===t.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_private_name_1:n.errorModuleName?e.Diagnostics.Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Property_0_of_exported_interface_has_or_is_using_private_name_1:void 0}function r(e){for(var t=[],n=0,i=e.elements;n<i.length;n++){var r=i[n];200!==r.kind&&t.push(r)}W(t,s)}function s(t){t.name&&(e.isBindingPattern(t.name)?r(t.name):(d(m,t.name),j(t,void 0,function(e){var n=i(e);return void 0!==n?{diagnosticMessage:n,errorNode:t,typeName:t.name}:void 0})))}(226!==t.kind||n.isDeclarationVisible(t))&&(e.isBindingPattern(t.name)?r(t.name):(d(m,t.name),(149===t.kind||148===t.kind||146===t.kind&&!e.isParameterPropertyDeclaration(t))&&e.hasQuestionToken(t)&&a("?"),149!==t.kind&&148!==t.kind||163!==t.parent.kind?n.isLiteralConstDeclaration(t)?(a(" = "),n.writeLiteralConstValue(t,p)):e.hasModifier(t,8)||j(t,t.type,function(e){var n=i(e);return void 0!==n?{diagnosticMessage:n,errorNode:t,typeName:t.name}:void 0}):pe(t)))}function pe(e){e.type&&(a(": "),J(e.type))}function he(t){e.hasDynamicName(t)||n.isImplementationOfOverload(t)||(w(t),228===t.kind?ee(t):151!==t.kind&&152!==t.kind||te(e.getModifierFlags(t)),228===t.kind?(a("function "),d(m,t.name)):152===t.kind?a("constructor"):(d(m,t.name),e.hasQuestionToken(t)&&a("?")),me(t))}function fe(e){w(e),me(e)}function me(t){var i=h;h=t;var r=!1;if(157===t.kind)te(e.getModifierFlags(t)),a("[");else{if(152===t.kind&&e.hasModifier(t,8))return a("();"),void l();if(156===t.kind||161===t.kind)a("new ");else if(160===t.kind){var s=p.getText();t.typeParameters&&"<"===s.charAt(s.length-1)&&(r=!0,a("("))}le(t.typeParameters),a("(")}W(t.parameters,ge),157===t.kind?a("]"):a(")");var o,c,u=160===t.kind||161===t.kind;u||163===t.parent.kind?t.type&&(a(u?" => ":": "),J(t.type)):152===t.kind||e.hasModifier(t,8)||(o=t,c=function(n){var i;switch(t.kind){case 156:i=n.errorModuleName?e.Diagnostics.Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 155:i=n.errorModuleName?e.Diagnostics.Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 157:i=n.errorModuleName?e.Diagnostics.Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 151:case 150:i=e.hasModifier(t,32)?n.errorModuleName?2===n.accessibility?e.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0:229===t.parent.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0:n.errorModuleName?e.Diagnostics.Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0;break;case 228:i=n.errorModuleName?2===n.accessibility?e.Diagnostics.Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_exported_function_has_or_is_using_private_name_0;break;default:e.Debug.fail("This is unknown kind for signature: "+t.kind)}return{diagnosticMessage:i,errorNode:t.name||t}},p.getSymbolAccessibilityDiagnostic=c,a(": "),o.type?J(o.type):(x=o.name,n.writeReturnTypeOfSignatureDeclaration(o,h,16388,p),x=void 0)),h=i,u?r&&a(")"):(a(";"),l())}function ge(t){function i(e){if(174===e.kind)a("{"),W(e.elements,r),a("}");else if(175===e.kind){a("[");var t=e.elements;W(t,r),t&&t.hasTrailingComma&&a(", "),a("]")}}function r(t){200===t.kind?a(" "):176===t.kind&&(t.propertyName&&(d(m,t.propertyName),a(": ")),t.name&&(e.isBindingPattern(t.name)?i(t.name):(e.Debug.assert(71===t.name.kind),t.dotDotDotToken&&a("..."),d(m,t.name))))}c(),w(t),t.dotDotDotToken&&a("..."),e.isBindingPattern(t.name)?i(t.name):d(m,t.name),n.isOptionalParameter(t)&&a("?"),u(),160===t.parent.kind||161===t.parent.kind||163===t.parent.parent.kind?pe(t):e.hasModifier(t.parent,8)||j(t,t.type,function(n){var i=function(n){switch(t.parent.kind){case 152:return n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1;case 156:return n.errorModuleName?e.Diagnostics.Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1;case 155:return n.errorModuleName?e.Diagnostics.Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1;case 157:return n.errorModuleName?e.Diagnostics.Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1;case 151:case 150:return e.hasModifier(t.parent,32)?n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:229===t.parent.parent.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:n.errorModuleName?e.Diagnostics.Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1;case 228:return n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_private_name_1;default:e.Debug.fail("This is unknown parent for parameter: "+t.parent.kind)}}(n);return void 0!==i?{diagnosticMessage:i,errorNode:t,typeName:t.name}:void 0})}function _e(t){switch(t.kind){case 228:case 233:case 237:case 230:case 229:case 231:case 232:return Z(t,function(e){return n.isDeclarationVisible(e)}(t));case 208:return Z(t,function(t){return e.forEach(t.declarationList.declarations,function(e){return n.isDeclarationVisible(e)})}(t));case 238:return Z(t,!t.importClause);case 244:return function(e){w(e),a("export "),e.exportClause?(a("{ "),W(e.exportClause.elements,oe),a(" }")):a("*"),e.moduleSpecifier&&(a(" from "),re(e)),a(";"),p.writeLine()}(t);case 152:case 151:case 150:return he(t);case 156:case 155:case 157:return fe(t);case 153:case 154:return function(t){if(!e.hasDynamicName(t)){var n,i=e.getAllAccessorDeclarations(t.parent.members,t);if(t===i.firstAccessor){if(w(i.getAccessor),w(i.setAccessor),te(e.getModifierFlags(t)|(i.setAccessor?0:64)),d(m,t.name),!e.hasModifier(t,8)){n=t;var r=o(t);if(!r){var s=153===t.kind?i.setAccessor:i.getAccessor;(r=o(s))&&(n=s)}j(t,r,function(t){return 154===n.kind?{diagnosticMessage:e.hasModifier(n.parent,32)?t.errorModuleName?e.Diagnostics.Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1:t.errorModuleName?e.Diagnostics.Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1,errorNode:n.parameters[0],typeName:n.name}:{diagnosticMessage:e.hasModifier(n,32)?t.errorModuleName?2===t.accessibility?e.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0:t.errorModuleName?2===t.accessibility?e.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0,errorNode:n.name,typeName:void 0}})}a(";"),l()}}function o(e){if(e)return 153===e.kind?e.type:e.parameters.length>0?e.parameters[0].type:void 0}}(t);case 149:case 148:return ue(t);case 264:return function(t){w(t),d(m,t.name);var i=n.getConstantValue(t);void 0!==i&&(a(" = "),a(e.getTextOfConstantValue(i))),a(","),l()}(t);case 243:return function(t){if(71===t.expression.kind)a(t.isExportEquals?"export = ":"export default "),d(m,t.expression);else{var i=X(t.expression,"_default",{diagnosticMessage:e.Diagnostics.Default_export_of_the_module_has_or_is_using_private_name_0,errorNode:t},A);a(t.isExportEquals?"export = ":"export default "),a(i)}a(";"),l(),71===t.expression.kind&&B(n.collectLinkedAliases(t.expression))}(t);case 265:return Y(t)}}}e.getDeclarationDiagnostics=function(n,i,r){var s=e.createDiagnosticCollection();return e.forEachEmittedFile(n,function(e,r){var o=e.declarationFilePath;t(n,i,s,o,r,!1)},r),s.getDiagnostics(r?r.fileName:void 0)},e.writeDeclarationFile=function(n,i,r,s,o,a){var l=t(r,s,o,n,i,a),c=l.reportedDeclarationError||r.isEmitBlocked(n)||r.getCompilerOptions().noEmit;if(!c){var u=266===i.kind?i.sourceFiles:[i],d=l.referencesOutput+function t(n,i){var r=0,s="";return e.forEach(i,function(e){e.asynchronousOutput&&(s+=n.substring(r,e.outputPos),s+=t(e.asynchronousOutput,e.subModuleElementDeclarationEmitInfo),r=e.outputPos)}),s+=n.substring(r),s}(l.synchronousDeclarationOutput,l.moduleElementDeclarationEmitInfo);e.writeFile(r,o,n,d,r.getCompilerOptions().emitBOM,u)}return c}}(ts||(ts={})),function(e){var t,n,i=function(){var e=[];return e[0]="",e[16]=",",e[4]=" |",e[8]=" &",e}(),r=function(){var e=[];return e[512]=["{","}"],e[1024]=["(",")"],e[2048]=["<",">"],e[4096]=["[","]"],e}();function s(t,n,i,r){var s=e.isArray(i)?i:e.getSourceFilesToEmit(t,i),l=t.getCompilerOptions();if(l.outFile||l.out)s.length&&n({jsFilePath:d=l.outFile||l.out,sourceMapFilePath:o(d,l),declarationFilePath:l.declaration?e.removeFileExtension(d)+".d.ts":""},e.createBundle(s),r);else for(var c=0,u=s;c<u.length;c++){var d,p=u[c];n({jsFilePath:d=e.getOwnEmitOutputFilePath(p,t,a(p,l)),sourceMapFilePath:o(d,l),declarationFilePath:e.isSourceFileJavaScript(p)||!r&&!l.declaration?void 0:e.getDeclarationEmitOutputFilePath(p,t)},p,r)}}function o(e,t){return t.sourceMap?e+".map":void 0}function a(t,n){if(1===n.jsx)if(e.isSourceFileJavaScript(t)){if(e.fileExtensionIs(t.fileName,".jsx"))return".jsx"}else if(1===t.languageVariant)return".jsx";return".js"}function l(t,n){void 0===t&&(t={}),void 0===n&&(n={});var s,o,a,l,c,u,d,p,h=n.hasGlobalName,f=n.onEmitSourceMapOfNode,m=n.onEmitSourceMapOfToken,g=n.onEmitSourceMapOfPosition,_=n.onEmitNode,y=n.onEmitHelpers,b=n.onSetSourceFile,v=n.substituteNode,T=n.onBeforeEmitNodeArray,k=n.onAfterEmitNodeArray,x=n.onBeforeEmitToken,E=n.onAfterEmitToken,S=e.getNewLineCharacter(t),C=e.createCommentWriter(t,g),w=C.emitNodeWithComments,I=C.emitBodyWithDetachedComments,A=C.emitTrailingCommentsOfPosition,N=C.emitLeadingCommentsOfPosition;return V(),{printNode:function(t,n,i){switch(t){case 0:e.Debug.assert(e.isSourceFile(n),"Expected a SourceFile node.");break;case 2:e.Debug.assert(e.isIdentifier(n),"Expected an Identifier node.");break;case 1:e.Debug.assert(e.isExpression(n),"Expected an Expression node.")}switch(n.kind){case 265:return O(n);case 266:return D(n)}return R(t,n,i,M()),F()},printFile:O,printBundle:D,writeNode:R,writeFile:P,writeBundle:L};function D(e){return L(e,M()),F()}function O(e){return P(e,M()),F()}function R(e,t,n,i){var r=d;U(i),B(e,t,n),V(),d=r}function L(e,t){var n=d;U(t),be(e),ye(e),Z(e);for(var i=0,r=e.sourceFiles;i<r.length;i++){var s=r[i];B(0,s,s)}V(),d=n}function P(e,t){var n=d;U(t),be(e),ye(e),B(0,e,e),V(),d=n}function M(){return p||(p=e.createTextWriter(S))}function F(){var e=p.getText();return p.reset(),e}function B(e,t,n){n&&$(n),z(e,t)}function $(e){s=e,C.setSourceFile(e),b&&b(e)}function U(e){d=e,C.setWriter(e)}function V(){o=[],a=[],l=e.createMap(),c=[],u=0,C.reset(),U(void 0)}function H(e){e&&G(e)}function G(e){z(4,e)}function j(e){z(2,e)}function K(e){z(1,e)}function z(e,t){_?_(e,t,W):W(e,t)}function W(e,t){t=X(e,t),w&&0!==e?w(e,t,q):q(e,t)}function q(e,t){f&&0!==e&&2!==e?f(e,t,J):J(e,t)}function J(t,n){switch(t){case 0:return function(t){e.Debug.assertNode(t,e.isSourceFile),function(t){Pe();var n=t.statements;if(I){if(0===n.length||!e.isPrologueDirective(n[0])||e.nodeIsSynthesized(n[0]))return void I(t,n,ge)}ge(t)}(t)}(n);case 2:return function(t){e.Debug.assertNode(t,e.isIdentifier),ee(t)}(n);case 1:return Y(n);case 3:return function(e){G(e.name),Le(" in "),G(e.constraint)}(e.cast(n,e.isTypeParameterDeclaration));case 4:return function(t){var n=t.kind;if(e.isKeyword(n))return void $e(t);switch(n){case 14:case 15:case 16:return Q(t);case 71:return ee(t);case 143:return function(e){(function(e){71===e.kind?K(e):G(e)})(e.left),Le("."),G(e.right)}(t);case 144:return function(e){Le("["),K(e.expression),Le("]")}(t);case 145:return function(e){G(e.name),Te(" extends ",e.constraint),Te(" = ",e.default)}(t);case 146:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),H(e.dotDotDotToken),e.name&&G(e.name);H(e.questionToken),e.parent&&273===e.parent.kind&&!e.name?G(e.type):Te(": ",e.type);ke(" = ",e.initializer)}(t);case 147:return i=t,Le("@"),void K(i.expression);case 148:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),G(e.name),H(e.questionToken),Te(": ",e.type),Le(";")}(t);case 149:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),G(e.name),H(e.questionToken),Te(": ",e.type),ke(" = ",e.initializer),Le(";")}(t);case 150:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),G(e.name),H(e.questionToken),Ie(e,e.typeParameters),Ae(e,e.parameters),Te(": ",e.type),Le(";")}(t);case 151:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),H(e.asteriskToken),G(e.name),H(e.questionToken),oe(e,ae)}(t);case 152:return function(e){ve(e,e.modifiers),Le("constructor"),oe(e,ae)}(t);case 153:case 154:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le(153===e.kind?"get ":"set "),G(e.name),oe(e,ae)}(t);case 155:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Ie(e,e.typeParameters),Ae(e,e.parameters),Te(": ",e.type),Le(";")}(t);case 156:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("new "),Ie(e,e.typeParameters),Ae(e,e.parameters),Te(": ",e.type),Le(";")}(t);case 157:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),t=e,n=e.parameters,De(t,n,4432),Te(": ",e.type),Le(";");var t,n}(t);case 158:return function(e){G(e.parameterName),Le(" is "),G(e.type)}(t);case 159:return function(e){G(e.typeName),we(e,e.typeArguments)}(t);case 160:return function(e){Ie(e,e.typeParameters),Ne(e,e.parameters),Le(" => "),G(e.type)}(t);case 273:return function(e){Le("function"),Ae(e,e.parameters),Le(":"),G(e.type)}(t);case 161:return function(e){Le("new "),Ie(e,e.typeParameters),Ae(e,e.parameters),Le(" => "),G(e.type)}(t);case 162:return function(e){Le("typeof "),G(e.exprName)}(t);case 163:return function(t){Le("{");var n=1&e.getEmitFlags(t)?448:65;De(t,t.members,262144|n),Le("}")}(t);case 164:return function(e){G(e.elementType),Le("[]")}(t);case 165:return function(e){Le("["),De(e,e.elementTypes,336),Le("]")}(t);case 166:return function(e){De(e,e.types,260)}(t);case 167:return function(e){De(e,e.types,264)}(t);case 168:return function(e){Le("("),G(e.type),Le(")")}(t);case 201:return function(e){K(e.expression),we(e,e.typeArguments)}(t);case 169:return void Le("this");case 170:return function(e){Ue(e.operator),Le(" "),G(e.type)}(t);case 171:return function(e){G(e.objectType),Le("["),G(e.indexType),Le("]")}(t);case 172:return function(t){var n=e.getEmitFlags(t);Le("{"),1&n?Le(" "):(Pe(),Me());t.readonlyToken&&(G(t.readonlyToken),Le(" "));Le("["),z(3,t.typeParameter),Le("]"),H(t.questionToken),Le(": "),G(t.type),Le(";"),1&n?Le(" "):(Pe(),Fe());Le("}")}(t);case 173:return function(e){K(e.literal)}(t);case 268:return void Le("*");case 269:return void Le("?");case 270:return function(e){Le("?"),G(e.type)}(t);case 271:return function(e){Le("!"),G(e.type)}(t);case 272:return function(e){G(e.type),Le("=")}(t);case 274:return function(e){Le("..."),G(e.type)}(t);case 174:return function(e){var t=e.elements;0===t.length?Le("{}"):(Le("{"),De(e,t,432),Le("}"))}(t);case 175:return function(e){var t=e.elements;0===t.length?Le("[]"):(Le("["),De(e,e.elements,304),Le("]"))}(t);case 176:return function(e){Ee(e.propertyName,": "),H(e.dotDotDotToken),G(e.name),ke(" = ",e.initializer)}(t);case 205:return function(e){K(e.expression),G(e.literal)}(t);case 206:case 209:return void Le(";");case 207:return function(e){Be(17,e.pos,e),ne(e,!e.multiLine&&Ye(e)),Me(),N(e.statements.end),Fe(),Be(18,e.statements.end,e)}(t);case 208:return function(e){ve(e,e.modifiers),G(e.declarationList),Le(";")}(t);case 210:return function(e){K(e.expression),Le(";")}(t);case 211:return function(e){var t=Be(90,e.pos,e);Le(" "),Be(19,t,e),K(e.expression),Be(20,e.expression.end,e),Se(e,e.thenStatement),e.elseStatement&&(Ve(e),Be(82,e.thenStatement.end,e),211===e.elseStatement.kind?(Le(" "),G(e.elseStatement)):Se(e,e.elseStatement))}(t);case 212:return function(t){Le("do"),Se(t,t.statement),e.isBlock(t.statement)?Le(" "):Ve(t);Le("while ("),K(t.expression),Le(");")}(t);case 213:return function(e){Le("while ("),K(e.expression),Le(")"),Se(e,e.statement)}(t);case 214:return function(e){var t=Be(88,e.pos);Le(" "),Be(19,t,e),ie(e.initializer),Le(";"),ke(" ",e.condition),Le(";"),ke(" ",e.incrementor),Le(")"),Se(e,e.statement)}(t);case 215:return function(e){var t=Be(88,e.pos);Le(" "),Be(19,t),ie(e.initializer),Le(" in "),K(e.expression),Be(20,e.expression.end),Se(e,e.statement)}(t);case 216:return function(e){var t=Be(88,e.pos);Le(" "),Ee(e.awaitModifier," "),Be(19,t),ie(e.initializer),Le(" of "),K(e.expression),Be(20,e.expression.end),Se(e,e.statement)}(t);case 217:return function(e){Be(77,e.pos),Te(" ",e.label),Le(";")}(t);case 218:return function(e){Be(72,e.pos),Te(" ",e.label),Le(";")}(t);case 219:return function(t){(function(t,n,i){var r=i&&e.getParseTreeNode(i);r&&r.kind===i.kind&&(n=e.skipTrivia(s.text,n));n=Be(t,n,i),r&&r.kind===i.kind&&A(n,!0)})(96,t.pos,t),ke(" ",t.expression),Le(";")}(t);case 220:return function(e){Le("with ("),K(e.expression),Le(")"),Se(e,e.statement)}(t);case 221:return function(e){var t=Be(98,e.pos);Le(" "),Be(19,t),K(e.expression),Be(20,e.expression.end),Le(" "),G(e.caseBlock)}(t);case 222:return function(e){G(e.label),Le(": "),G(e.statement)}(t);case 223:return function(e){Le("throw"),ke(" ",e.expression),Le(";")}(t);case 224:return function(e){Le("try "),G(e.tryBlock),e.catchClause&&(Ve(e),G(e.catchClause));e.finallyBlock&&(Ve(e),Le("finally "),G(e.finallyBlock))}(t);case 225:return function(e){Be(78,e.pos),Le(";")}(t);case 226:return function(e){G(e.name),Te(": ",e.type),ke(" = ",e.initializer)}(t);case 227:return function(t){Le(e.isLet(t)?"let ":e.isConst(t)?"const ":"var "),De(t,t.declarations,272)}(t);case 228:return function(e){re(e)}(t);case 229:return function(e){de(e)}(t);case 230:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("interface "),G(e.name),Ie(e,e.typeParameters),De(e,e.heritageClauses,256),Le(" {"),De(e,e.members,65),Le("}")}(t);case 231:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("type "),G(e.name),Ie(e,e.typeParameters),Le(" = "),G(e.type),Le(";")}(t);case 232:return function(e){ve(e,e.modifiers),Le("enum "),G(e.name),et(),Le(" {"),De(e,e.members,81),Le("}"),tt()}(t);case 233:return function(e){ve(e,e.modifiers),512&~e.flags&&Le(16&e.flags?"namespace ":"module ");G(e.name);var t=e.body;for(;233===t.kind;)Le("."),G(t.name),t=t.body;Le(" "),G(t)}(t);case 234:return function(e){et(),Le("{"),ne(e,Ye(e)),Le("}"),tt()}(t);case 235:return function(e){Be(17,e.pos),De(e,e.clauses,65),Be(18,e.clauses.end)}(t);case 236:return function(e){Le("export as namespace "),G(e.name),Le(";")}(t);case 237:return function(e){ve(e,e.modifiers),Le("import "),G(e.name),Le(" = "),function(e){71===e.kind?K(e):G(e)}(e.moduleReference),Le(";")}(t);case 238:return function(e){ve(e,e.modifiers),Le("import "),e.importClause&&(G(e.importClause),Le(" from "));K(e.moduleSpecifier),Le(";")}(t);case 239:return function(e){G(e.name),e.name&&e.namedBindings&&Le(", ");G(e.namedBindings)}(t);case 240:return function(e){Le("* as "),G(e.name)}(t);case 241:case 245:return function(e){pe(e)}(t);case 242:case 246:return function(e){he(e)}(t);case 243:return function(e){Le(e.isExportEquals?"export = ":"export default "),K(e.expression),Le(";")}(t);case 244:return function(e){Le("export "),e.exportClause?G(e.exportClause):Le("*");e.moduleSpecifier&&(Le(" from "),K(e.moduleSpecifier));Le(";")}(t);case 247:return;case 248:return function(e){Le("require("),K(e.expression),Le(")")}(t);case 10:return function(e){d.writeLiteral(Ze(e,!0))}(t);case 251:return function(t){Le("<"),fe(t.tagName),n=t.attributes.properties,i=" ",void(e.some(n)&&Le(i)),t.attributes.properties&&t.attributes.properties.length>0&&G(t.attributes);var n,i;Le(">")}(t);case 252:return function(e){Le("</"),fe(e.tagName),Le(">")}(t);case 253:return function(e){G(e.name),Te("=",e.initializer)}(t);case 254:return function(e){De(e,e.properties,131328)}(t);case 255:return function(e){Le("{..."),K(e.expression),Le("}")}(t);case 256:return function(e){e.expression&&(Le("{"),H(e.dotDotDotToken),K(e.expression),Le("}"))}(t);case 257:return function(e){Le("case "),K(e.expression),Le(":"),me(e,e.statements)}(t);case 258:return function(e){Le("default:"),me(e,e.statements)}(t);case 259:return function(e){Le(" "),Ue(e.token),Le(" "),De(e,e.types,272)}(t);case 260:return function(e){var t=Be(74,e.pos);Le(" "),e.variableDeclaration&&(Be(19,t),G(e.variableDeclaration),Be(20,e.variableDeclaration.end),Le(" "));G(e.block)}(t);case 261:return function(t){G(t.name),Le(": ");var n=t.initializer;if(A&&!(512&e.getEmitFlags(n))){var i=e.getCommentRange(n);A(i.pos)}K(n)}(t);case 262:return function(e){G(e.name),e.objectAssignmentInitializer&&(Le(" = "),K(e.objectAssignmentInitializer))}(t);case 263:return function(e){e.expression&&(Le("..."),K(e.expression))}(t);case 264:return function(e){G(e.name),ke(" = ",e.initializer)}(t)}var i;if(e.isExpression(t))return Y(X(1,t));if(e.isToken(t))return void $e(t)}(n)}}function Y(n){switch(n.kind){case 8:return function(e){Q(e)}(n);case 9:case 12:case 13:return Q(n);case 71:return ee(n);case 86:case 95:case 97:case 101:case 99:case 91:return void $e(n);case 177:return function(e){var t=e.elements,n=e.multiLine?32768:0;Oe(e,t,4466|n)}(n);case 178:return function(t){var n=65536&e.getEmitFlags(t);n&&Me();var i=t.multiLine?32768:0,r=s.languageVersion>=1?32:0;De(t,t.properties,263122|r|i),n&&Fe()}(n);case 179:return function(n){var i=!1,r=!1;if(!(131072&e.getEmitFlags(n))){var o=n.expression.end,a=e.skipTrivia(s.text,n.expression.end)+1,l=e.createToken(23);l.pos=o,l.end=a,i=Je(n,n.expression,l),r=Je(n,l,n.name)}K(n.expression),Ge(i);var c=!i&&function(n){if(n=e.skipPartiallyEmittedExpressions(n),e.isNumericLiteral(n)){var i=Qe(n);return!n.numericLiteralFlags&&!e.stringContains(i,e.tokenToString(23))}if(e.isPropertyAccessExpression(n)||e.isElementAccessExpression(n)){var r=e.getConstantValue(n);return"number"==typeof r&&isFinite(r)&&Math.floor(r)===r&&t.removeComments}}(n.expression);Le(c?"..":"."),Ge(r),G(n.name),je(i,r)}(n);case 180:return function(e){K(e.expression),Le("["),K(e.argumentExpression),Le("]")}(n);case 181:return function(e){K(e.expression),we(e,e.typeArguments),Oe(e,e.arguments,1296)}(n);case 182:return function(e){Le("new "),K(e.expression),we(e,e.typeArguments),Oe(e,e.arguments,9488)}(n);case 183:return function(e){K(e.tag),Le(" "),K(e.template)}(n);case 184:return function(e){Le("<"),G(e.type),Le(">"),K(e.expression)}(n);case 185:return function(e){Le("("),K(e.expression),Le(")")}(n);case 186:return function(e){re(e)}(n);case 187:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),oe(e,te)}(n);case 188:return function(e){Le("delete "),K(e.expression)}(n);case 189:return function(e){Le("typeof "),K(e.expression)}(n);case 190:return function(e){Le("void "),K(e.expression)}(n);case 191:return function(e){Le("await "),K(e.expression)}(n);case 192:return function(e){Ue(e.operator),function(e){var t=e.operand;return 192===t.kind&&(37===e.operator&&(37===t.operator||43===t.operator)||38===e.operator&&(38===t.operator||44===t.operator))}(e)&&Le(" ");K(e.operand)}(n);case 193:return function(e){K(e.operand),Ue(e.operator)}(n);case 194:return function(e){var t=26!==e.operatorToken.kind,n=Je(e,e.left,e.operatorToken),i=Je(e,e.operatorToken,e.right);K(e.left),Ge(n,t?" ":void 0),N(e.operatorToken.pos),$e(e.operatorToken),A(e.operatorToken.end,!0),Ge(i," "),K(e.right),je(n,i)}(n);case 195:return function(e){var t=Je(e,e.condition,e.questionToken),n=Je(e,e.questionToken,e.whenTrue),i=Je(e,e.whenTrue,e.colonToken),r=Je(e,e.colonToken,e.whenFalse);K(e.condition),Ge(t," "),G(e.questionToken),Ge(n," "),K(e.whenTrue),je(t,n),Ge(i," "),G(e.colonToken),Ge(r," "),K(e.whenFalse),je(i,r)}(n);case 196:return function(e){G(e.head),De(e,e.templateSpans,131072)}(n);case 197:return function(e){Le("yield"),G(e.asteriskToken),ke(" ",e.expression)}(n);case 198:return function(e){Le("..."),K(e.expression)}(n);case 199:return function(e){de(e)}(n);case 200:return;case 202:return function(e){K(e.expression),e.type&&(Le(" as "),G(e.type))}(n);case 203:return function(e){K(e.expression),Le("!")}(n);case 204:return function(e){Be(e.keywordToken,e.pos),Le("."),G(e.name)}(n);case 249:return function(e){G(e.openingElement),De(e,e.children,131072),G(e.closingElement)}(n);case 250:return function(e){Le("<"),fe(e.tagName),Le(" "),e.attributes.properties&&e.attributes.properties.length>0&&G(e.attributes);Le("/>")}(n);case 288:return function(e){K(e.expression)}(n);case 289:return function(e){Oe(e,e.elements,272)}(n)}}function X(e,t){return t&&v&&v(e,t)||t}function Z(e){y&&y(e,He)}function Q(n){var i=Qe(n);!t.sourceMap&&!t.inlineSourceMap||9!==n.kind&&!e.isTemplateLiteralKind(n.kind)?Le(i):d.writeLiteral(i)}function ee(e){Le(Ze(e,!1)),we(e,e.typeArguments)}function te(e){Ie(e,e.typeParameters),Ne(e,e.parameters),Te(": ",e.type),Le(" "),G(e.equalsGreaterThanToken)}function ne(t,n){var i=n||1&e.getEmitFlags(t)?384:65;De(t,t.statements,i)}function ie(e){void 0!==e&&(227===e.kind?G(e):K(e))}function re(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("function"),H(e.asteriskToken),Le(" "),j(e.name),oe(e,ae)}function se(e,t){le(t)}function oe(t,n){var i=t.body;if(i)if(e.isBlock(i)){var r=65536&e.getEmitFlags(t);r&&Me(),524288&e.getEmitFlags(t)?(n(t),_?_(4,i,se):le(i)):(et(),n(t),_?_(4,i,se):le(i),tt()),r&&Fe()}else n(t),Le(" "),K(i);else n(t),Le(";")}function ae(e){Ie(e,e.typeParameters),Ae(e,e.parameters),Te(": ",e.type)}function le(t){Le(" {"),Me();var n=function(t){if(1&e.getEmitFlags(t))return!0;if(t.multiLine)return!1;if(!e.nodeIsSynthesized(t)&&!e.rangeIsOnSingleLine(t,s))return!1;if(Ke(t,t.statements,2)||We(t,t.statements,2))return!1;for(var n,i=0,r=t.statements;i<r.length;i++){var o=r[i];if(ze(n,o,2))return!1;n=o}return!0}(t)?ce:ue;I?I(t,t.statements,n):n(t),Fe(),Be(18,t.statements.end,t)}function ce(e){ue(e,!0)}function ue(e,t){var n=_e(e.statements,!0),i=d.getTextPos();Z(e),0===n&&i===d.getTextPos()&&t?(Fe(),De(e,e.statements,384),Me()):De(e,e.statements,1,n)}function de(t){Ce(t,t.decorators),ve(t,t.modifiers),Le("class"),xe(" ",t.name,j);var n=65536&e.getEmitFlags(t);n&&Me(),Ie(t,t.typeParameters),De(t,t.heritageClauses,256),et(),Le(" {"),De(t,t.members,65),Le("}"),tt(),n&&Fe()}function pe(e){Le("{"),De(e,e.elements,432),Le("}")}function he(e){e.propertyName&&(G(e.propertyName),Le(" as ")),G(e.name)}function fe(e){71===e.kind?K(e):G(e)}function me(t,n){var i=1===n.length&&(e.nodeIsSynthesized(t)||e.nodeIsSynthesized(n[0])||e.rangeStartPositionsAreOnSameLine(t,n[0],s));n.length>0&&A(n.pos);var r=81985;i&&(Le(" "),r&=-66),De(t,n,r)}function ge(t){var n=t.statements;et(),Z(t);var i=e.findIndex(n,function(t){return!e.isPrologueDirective(t)});De(t,n,1,-1===i?n.length:i),tt()}function _e(t,n,i){for(var r=0;r<t.length;r++){var s=t[r];if(!e.isPrologueDirective(s))return r;(!i||!i.has(s.expression.text))&&((n||r>0)&&Pe(),G(s),i&&i.set(s.expression.text,!0))}return t.length}function ye(t){if(e.isSourceFile(t))$(t),_e(t.statements);else for(var n=e.createMap(),i=0,r=t.sourceFiles;i<r.length;i++){var s=r[i];$(s),_e(s.statements,!0,n)}}function be(t){if(e.isSourceFile(t)){var n=e.getShebang(t.text);if(n)return Le(n),Pe(),!0}else for(var i=0,r=t.sourceFiles;i<r.length;i++){if(be(r[i]))break}}function ve(e,t){t&&t.length&&(De(e,t,131328),Le(" "))}function Te(e,t){xe(e,t,G)}function ke(e,t){xe(e,t,K)}function xe(e,t,n){t&&(Le(e),n(t))}function Ee(e,t){e&&(G(e),Le(t))}function Se(t,n){e.isBlock(n)||1&e.getEmitFlags(t)?(Le(" "),G(n)):(Pe(),Me(),G(n),Fe())}function Ce(e,t){De(e,t,24577)}function we(e,t){De(e,t,26960)}function Ie(e,t){De(e,t,26960)}function Ae(e,t){De(e,t,1360)}function Ne(t,n){!function(t,n){var i=e.singleOrUndefined(n);return i&&i.pos===t.pos&&!(e.isArrowFunction(t)&&t.type)&&!e.some(t.decorators)&&!e.some(t.modifiers)&&!e.some(t.typeParameters)&&!e.some(i.decorators)&&!e.some(i.modifiers)&&!i.dotDotDotToken&&!i.questionToken&&!i.type&&!i.initializer&&e.isIdentifier(i.name)}(t,n)?Ae(t,n):De(t,n,336)}function De(e,t,n,i,r){Re(G,e,t,n,i,r)}function Oe(e,t,n,i,r){Re(K,e,t,n,i,r)}function Re(t,n,s,o,a,l){void 0===a&&(a=0),void 0===l&&(l=s?s.length-a:0);var c=void 0===s;if(!(c&&8192&o)){var u=c||a>=s.length||0===l;if(u&&16384&o)return T&&T(s),void(k&&k(s));if(7680&o&&Le(function(e){return r[7680&e][0]}(o)),T&&T(s),u)1&o?Pe():128&o&&!(262144&o)&&Le(" ");else{var d=!(131072&o),p=d;Ke(n,s,o)?(Pe(),p=!1):128&o&&Le(" "),64&o&&Me();for(var h=void 0,f=void 0,m=function(e){return i[28&e]}(o),g=0;g<l;g++){var _=s[a+g];if(h&&(m&&h.end!==n.end&&N(h.end),Le(m),ze(h,_,o)?(67&o||(Me(),f=!0),Pe(),p=!1):h&&256&o&&Le(" ")),p){if(A){var y=e.getCommentRange(_);A(y.pos)}}else p=d;t(_),f&&(Fe(),f=!1),h=_}var b=32&o&&s.hasTrailingComma;16&o&&b&&Le(","),!h||!m||h.end===n.end||1024&e.getEmitFlags(h)||N(h.end),64&o&&Fe(),We(n,s,o)?Pe():128&o&&Le(" ")}k&&k(s),7680&o&&Le(function(e){return r[7680&e][1]}(o))}}function Le(e){d.write(e)}function Pe(){d.writeLine()}function Me(){d.increaseIndent()}function Fe(){d.decreaseIndent()}function Be(e,t,n){return m?m(n,e,t,Ue):Ue(e,t)}function $e(t){x&&x(t),Le(e.tokenToString(t.kind)),E&&E(t)}function Ue(t,n){var i=e.tokenToString(t);return Le(i),n<0?n:n+i.length}function Ve(t){1&e.getEmitFlags(t)?Le(" "):Pe()}function He(t){for(var n=t.split(/\r\n?|\n/g),i=function(t){for(var n,i=0,r=t;i<r.length;i++)for(var s=r[i],o=0;o<s.length&&(void 0===n||o<n);o++)if(!e.isWhiteSpaceLike(s.charCodeAt(o))&&(void 0===n||o<n)){n=o;break}return n}(n),r=0;r<n.length;r++){var s=i?n[r].slice(i):n[r];s.length&&(Pe(),Le(s),Pe())}}function Ge(e,t){e?(Me(),Pe()):t&&Le(t)}function je(e,t){e&&Fe(),t&&Fe()}function Ke(t,n,i){if(1&i)return!0;if(2&i){if(32768&i)return!0;var r=n[0];return void 0===r?!e.rangeIsOnSingleLine(t,s):e.positionIsSynthesized(t.pos)||e.nodeIsSynthesized(r)?qe(r,i):!e.rangeStartPositionsAreOnSameLine(t,r,s)}return!1}function ze(t,n,i){return!!(1&i)||(2&i?void 0!==t&&void 0!==n&&(e.nodeIsSynthesized(t)||e.nodeIsSynthesized(n)?qe(t,i)||qe(n,i):!e.rangeEndIsOnSameLineAsRangeStart(t,n,s)):n.startsOnNewLine)}function We(t,n,i){if(1&i)return!(65536&i);if(2&i){if(32768&i)return!0;var r=e.lastOrUndefined(n);return void 0===r?!e.rangeIsOnSingleLine(t,s):e.positionIsSynthesized(t.pos)||e.nodeIsSynthesized(r)?qe(r,i):!e.rangeEndPositionsAreOnSameLine(t,r,s)}return!1}function qe(t,n){if(e.nodeIsSynthesized(t)){var i=t.startsOnNewLine;return void 0===i?!!(32768&n):i}return!!(32768&n)}function Je(t,n,i){return t=Xe(t),n=Xe(n),!!(i=Xe(i)).startsOnNewLine||!(e.nodeIsSynthesized(t)||e.nodeIsSynthesized(n)||e.nodeIsSynthesized(i)||e.rangeEndIsOnSameLineAsRangeStart(n,i,s))}function Ye(t){return 0===t.statements.length&&e.rangeEndIsOnSameLineAsRangeStart(t,t,s)}function Xe(t){for(;185===t.kind&&e.nodeIsSynthesized(t);)t=t.expression;return t}function Ze(t,n){return e.isGeneratedIdentifier(t)?function(t){if(4===t.autoGenerateKind){var n=function(t){var n=t.autoGenerateId,i=t,r=i.original;for(;r&&(i=r,!e.isIdentifier(i)||4!==i.autoGenerateKind||i.autoGenerateId===n);)r=i.original;return i}(t);return nt(n)}var i=t.autoGenerateId;return a[i]||(a[i]=function(t){switch(t.autoGenerateKind){case 1:return rt(0);case 2:return rt(268435456);case 3:return st(e.idText(t))}e.Debug.fail("Unsupported GeneratedIdentifierKind.")}(t))}(t):!e.isIdentifier(t)||!e.nodeIsSynthesized(t)&&t.parent?9===t.kind&&t.textSourceNode?Ze(t.textSourceNode,n):!e.isLiteralExpression(t)||!e.nodeIsSynthesized(t)&&t.parent?e.getSourceTextOfNodeFromSourceFile(s,t,n):t.text:e.idText(t)}function Qe(t){if(9===t.kind&&t.textSourceNode){var n=t.textSourceNode;return e.isIdentifier(n)?16777216&e.getEmitFlags(t)?'"'+e.escapeString(Ze(n))+'"':'"'+e.escapeNonAsciiString(Ze(n))+'"':Qe(n)}return e.getLiteralText(t,s)}function et(){c.push(u),u=0}function tt(){u=c.pop()}function nt(t){var n=e.getNodeId(t);return o[n]||(o[n]=function(t){switch(t.kind){case 71:return st(Ze(t));case 233:case 232:return function(t){var n=Ze(t.name);return function(t,n){for(var i=n;e.isNodeDescendantOf(i,n);i=i.nextContainer)if(i.locals){var r=i.locals.get(e.escapeLeadingUnderscores(t));if(r&&3253183&r.flags)return!1}return!0}(n,t)?n:st(n)}(t);case 238:case 244:return function(t){var n=e.getExternalModuleName(t);return st(e.isStringLiteral(n)?e.makeIdentifierFromModuleName(n.text):"module")}(t);case 228:case 229:case 243:return st("default");case 199:return st("class");case 151:case 153:case 154:return function(t){if(e.isIdentifier(t.name))return nt(t.name);return rt(0)}(t);default:return rt(0)}}(t))}function it(e){return!(h&&h(e)||s.identifiers.has(e)||l.has(e))}function rt(e){if(e&&!(u&e)&&it(t=268435456===e?"_i":"_n"))return u|=e,t;for(;;){var t,n=268435455&u;if(u++,8!==n&&13!==n)if(it(t=n<26?"_"+String.fromCharCode(97+n):"_"+(n-26)))return t}}function st(e){95!==e.charCodeAt(e.length-1)&&(e+="_");for(var t=1;;){var n=e+t;if(it(n))return l.set(n,!0),n;t++}}}e.forEachEmittedFile=s,e.emitFiles=function(t,n,i,r,o){var a,c,u,d=n.getCompilerOptions(),p=e.getEmitModuleKind(d),h=d.sourceMap||d.inlineSourceMap?[]:void 0,f=d.listEmittedFiles?[]:void 0,m=e.createDiagnosticCollection(),g=n.getNewLine(),_=e.createTextWriter(g),y=e.createSourceMapWriter(n,_),b=!1,v=e.getSourceFilesToEmit(n,i),T=e.transformNodes(t,n,d,v,o,!1),k=l(d,{hasGlobalName:t.hasGlobalName,onEmitNode:T.emitNodeWithNotification,substituteNode:T.substituteNode,onEmitSourceMapOfNode:y.emitNodeWithSourceMap,onEmitSourceMapOfToken:y.emitTokenWithSourceMap,onEmitSourceMapOfPosition:y.emitPos,onEmitHelpers:function(t,n){var i=!1,r=266===t.kind?t:void 0;if(r&&p===e.ModuleKind.None)return;for(var s=r?r.sourceFiles.length:1,o=0;o<s;o++){var l=r?r.sourceFiles[o]:t,h=e.isSourceFile(l)?l:a,f=d.noEmitHelpers||void 0!==e.getExternalHelpersModuleName(h),m=e.isSourceFile(l)&&!u,g=e.getEmitHelpers(l);if(g)for(var _=0,y=e.stableSort(g,e.compareEmitHelpers);_<y.length;_++){var b=y[_];if(b.scoped){if(r)continue}else{if(f)continue;if(m){if(c.get(b.name))continue;c.set(b.name,!0)}}n(b.text),i=!0}}return i},onSetSourceFile:function(e){a=e,y.setSourceFile(e)}});return e.performance.mark("beforePrint"),s(n,function(i,s){var o=i.jsFilePath,l=i.sourceMapFilePath,p=i.declarationFilePath;n.isEmitBlocked(o)||d.noEmit?b=!0:r||function(t,i,r){var s=266===r.kind?r:void 0,o=265===r.kind?r:void 0,l=s?s.sourceFiles:[o];y.initialize(t,i,r),s?(c=e.createMap(),u=!1,k.writeBundle(s,_)):(u=!0,k.writeFile(o,_));_.writeLine();var p=y.getSourceMappingURL();p&&_.write("//# sourceMappingURL="+p);d.sourceMap&&!d.inlineSourceMap&&e.writeFile(n,m,i,y.getText(),!1,l);h&&h.push(y.getSourceMapData());e.writeFile(n,m,t,_.getText(),d.emitBOM,l),y.reset(),_.reset(),a=void 0,c=void 0,u=!1}(o,l,s);p&&(b=e.writeDeclarationFile(p,function(t){return 266===t.kind?e.updateBundle(t,e.sameMap(t.sourceFiles,e.getOriginalSourceFile)):e.getOriginalSourceFile(t)}(s),n,t,m,r)||b);!b&&f&&(r||f.push(o),l&&f.push(l),p&&f.push(p))},T.transformed,r),e.performance.measure("printTime","beforePrint"),T.dispose(),{emitSkipped:b,diagnostics:m.getDiagnostics(),emittedFiles:f,sourceMaps:h}},e.createPrinter=l,function(e){e[e.Auto=0]="Auto",e[e.CountMask=268435455]="CountMask",e[e._i=268435456]="_i"}(t||(t={})),function(e){e[e.None=0]="None",e[e.SingleLine=0]="SingleLine",e[e.MultiLine=1]="MultiLine",e[e.PreserveLines=2]="PreserveLines",e[e.LinesMask=3]="LinesMask",e[e.NotDelimited=0]="NotDelimited",e[e.BarDelimited=4]="BarDelimited",e[e.AmpersandDelimited=8]="AmpersandDelimited",e[e.CommaDelimited=16]="CommaDelimited",e[e.DelimitersMask=28]="DelimitersMask",e[e.AllowTrailingComma=32]="AllowTrailingComma",e[e.Indented=64]="Indented",e[e.SpaceBetweenBraces=128]="SpaceBetweenBraces",e[e.SpaceBetweenSiblings=256]="SpaceBetweenSiblings",e[e.Braces=512]="Braces",e[e.Parenthesis=1024]="Parenthesis",e[e.AngleBrackets=2048]="AngleBrackets",e[e.SquareBrackets=4096]="SquareBrackets",e[e.BracketsMask=7680]="BracketsMask",e[e.OptionalIfUndefined=8192]="OptionalIfUndefined",e[e.OptionalIfEmpty=16384]="OptionalIfEmpty",e[e.Optional=24576]="Optional",e[e.PreferNewLine=32768]="PreferNewLine",e[e.NoTrailingNewLine=65536]="NoTrailingNewLine",e[e.NoInterveningComments=131072]="NoInterveningComments",e[e.NoSpaceIfEmpty=262144]="NoSpaceIfEmpty",e[e.SingleElement=524288]="SingleElement",e[e.Modifiers=131328]="Modifiers",e[e.HeritageClauses=256]="HeritageClauses",e[e.SingleLineTypeLiteralMembers=448]="SingleLineTypeLiteralMembers",e[e.MultiLineTypeLiteralMembers=65]="MultiLineTypeLiteralMembers",e[e.TupleTypeElements=336]="TupleTypeElements",e[e.UnionTypeConstituents=260]="UnionTypeConstituents",e[e.IntersectionTypeConstituents=264]="IntersectionTypeConstituents",e[e.ObjectBindingPatternElements=432]="ObjectBindingPatternElements",e[e.ArrayBindingPatternElements=304]="ArrayBindingPatternElements",e[e.ObjectLiteralExpressionProperties=263122]="ObjectLiteralExpressionProperties",e[e.ArrayLiteralExpressionElements=4466]="ArrayLiteralExpressionElements",e[e.CommaListElements=272]="CommaListElements",e[e.CallExpressionArguments=1296]="CallExpressionArguments",e[e.NewExpressionArguments=9488]="NewExpressionArguments",e[e.TemplateExpressionSpans=131072]="TemplateExpressionSpans",e[e.SingleLineBlockStatements=384]="SingleLineBlockStatements",e[e.MultiLineBlockStatements=65]="MultiLineBlockStatements",e[e.VariableDeclarationList=272]="VariableDeclarationList",e[e.SingleLineFunctionBodyStatements=384]="SingleLineFunctionBodyStatements",e[e.MultiLineFunctionBodyStatements=1]="MultiLineFunctionBodyStatements",e[e.ClassHeritageClauses=256]="ClassHeritageClauses",e[e.ClassMembers=65]="ClassMembers",e[e.InterfaceMembers=65]="InterfaceMembers",e[e.EnumMembers=81]="EnumMembers",e[e.CaseBlockClauses=65]="CaseBlockClauses",e[e.NamedImportsOrExportsElements=432]="NamedImportsOrExportsElements",e[e.JsxElementChildren=131072]="JsxElementChildren",e[e.JsxElementAttributes=131328]="JsxElementAttributes",e[e.CaseOrDefaultClauseStatements=81985]="CaseOrDefaultClauseStatements",e[e.HeritageClauseTypes=272]="HeritageClauseTypes",e[e.SourceFileStatements=65537]="SourceFileStatements",e[e.Decorators=24577]="Decorators",e[e.TypeArguments=26960]="TypeArguments",e[e.TypeParameters=26960]="TypeParameters",e[e.Parameters=1360]="Parameters",e[e.IndexSignatureParameters=4432]="IndexSignatureParameters"}(n||(n={}))}(ts||(ts={})),function(e){function t(e,t,n,i,r){var s=[],o=e.emit(t,function(e,t,n){s.push({name:e,writeByteOrderMark:n,text:t})},i,n,r);return{outputFiles:s,emitSkipped:o.emitSkipped}}e.getFileEmitOutput=t,e.createBuilder=function(n){var i,r,s,o=e.createMap(),a=e.createMap(),l=e.createMap(),c=e.createMap();return{updateProgram:function(e){s&&u(e)},getFilesAffectedBy:f,emitChangedFiles:function(t,n){h(t);var i=t.getCompilerOptions();if(!l.size)return e.emptyArray;if(i.outFile||i.out)return e.Debug.assert(0===a.size),l.clear(),[t.emit(void 0,n)];var r,s=e.createMap();return l.forEach(function(e,i){f(t,i).forEach(function(e){a.delete(e.path),s.has(e.path)||(s.set(e.path,!0),(r||(r=[])).push(t.emit(e,n)))})}),l.clear(),r||e.emptyArray},getSemanticDiagnostics:function(t,n){h(t),e.Debug.assert(0===l.size);var i,r=t.getCompilerOptions();if(r.outFile||r.out)return e.Debug.assert(0===a.size),t.getSemanticDiagnostics(void 0,n);for(var s=0,o=t.getSourceFiles();s<o.length;s++){var c=o[s];i=e.addRange(i,m(t,c,n))}return i||e.emptyArray},clear:function(){i=void 0,s=void 0,o.clear(),a.clear(),l.clear(),c.clear()}};function u(t){var n=t.getCompilerOptions().module!==e.ModuleKind.None;i!==n&&(s=(i=n)?function(){var t=e.createMap();return{onAddSourceFile:n,onRemoveSourceFile:s,onUpdateSourceFile:i,onUpdateSourceFileWithSameVersion:r,getFilesAffectedByUpdatedShape:l};function n(e,n){var i=_(e,n);i&&t.set(n.path,i)}function i(e,n){var i=_(e,n);i?t.set(n.path,i):t.delete(n.path)}function r(n,i){var r=_(n,i);if(!r)return t.delete(i.path);var s=t.get(i.path);return t.set(i.path,r),!s||s.size!==r.size||(e.forEachEntry(r,function(e,t){return!s.delete(t)})||!!s.size)}function s(e){t.forEach(function(t,n){t.has(e)&&(o.get(n)&&d(n))}),t.delete(e)}function a(n){return e.mapDefinedIter(t.entries(),function(e){var t=e[0];return e[1].has(n)?t:void 0})}function l(t,n){if(!e.isExternalModule(n)&&!function(t){for(var n=0,i=t.statements;n<i.length;n++){var r=i[n];if(!e.isModuleWithStringLiteralName(r))return!1}return!0}(n))return y(t,n);var i=t.getCompilerOptions();if(i&&(i.isolatedModules||i.out||i.outFile))return[n];var r=e.createMap(),s=n.path;r.set(s,n);for(var o=a(s);o.length>0;){var l=o.pop();if(!r.has(l)){var c=t.getSourceFileByPath(l);r.set(l,c),c&&g(t,c)&&o.push.apply(o,a(l))}}return e.flatMapIter(r.values(),function(e){return e})}}():function(){return{onAddSourceFile:e.noop,onRemoveSourceFile:e.noop,onUpdateSourceFile:e.noop,onUpdateSourceFileWithSameVersion:e.returnFalse,getFilesAffectedByUpdatedShape:t};function t(e,t){var n=e.getCompilerOptions();return n&&(n.out||n.outFile)?[t]:y(e,t)}}(),o.clear(),a.clear()),c.clear(),r=void 0,e.mutateMap(o,e.arrayToMap(t.getSourceFiles(),function(e){return e.path}),{createNewValue:function(e,n){return function(e,t){return d(t.path),s.onAddSourceFile(e,t),{version:t.version,signature:void 0}}(t,n)},onDeleteValue:p,onExistingValue:function(e,n){return function(e,t,n){t.version!==n.version?(d(n.path),t.version=n.version,s.onUpdateSourceFile(e,n)):s.onUpdateSourceFileWithSameVersion(e,n)&&d(n.path)}(t,e,n)}})}function d(e){l.set(e,!0),a.delete(e)}function p(e,t){l.delete(t),a.delete(t),s.onRemoveSourceFile(t)}function h(e){s||u(e)}function f(t,n){h(t);var i=t.getSourceFileByPath(n);return i?g(t,i)?s.getFilesAffectedByUpdatedShape(t,i):[i]:e.emptyArray}function m(e,t,n){var i=t.path,r=a.get(i);if(r)return r;var s=e.getSemanticDiagnostics(t,n);return a.set(i,s),s}function g(i,r){if(e.Debug.assert(!!r),c.has(r.path))return!1;c.set(r.path,!0);var s=o.get(r.path);e.Debug.assert(!!s);var a,l=s.signature;if(r.isDeclarationFile)a=r.version,s.signature=a;else{var u=t(i,r,!0);u.outputFiles&&u.outputFiles.length>0?(a=n.computeHash(u.outputFiles[0].text),s.signature=a):a=l}return!l||a!==l}function _(t,i){var r;if(i.imports&&i.imports.length>0)for(var s=t.getTypeChecker(),o=0,a=i.imports;o<a.length;o++){var l=a[o],c=s.getSymbolAtLocation(l);if(c&&c.declarations&&c.declarations[0]){var u=e.getSourceFileOfNode(c.declarations[0]);u&&m(u.path)}}var d=e.getDirectoryPath(i.path);if(i.referencedFiles&&i.referencedFiles.length>0)for(var p=0,h=i.referencedFiles;p<h.length;p++){var f=h[p];m(e.toPath(f.fileName,d,n.getCanonicalFileName))}return i.resolvedTypeReferenceDirectiveNames&&i.resolvedTypeReferenceDirectiveNames.forEach(function(t){if(t){var i=t.resolvedFileName;m(e.toPath(i,d,n.getCanonicalFileName))}}),r;function m(t){r||(r=e.createMap()),r.set(t,!0)}}function y(t,n){if(r)return r;var i;l(n);for(var s=0,o=t.getSourceFiles();s<o.length;s++){var a=o[s];a!==n&&l(a)}return r=i||e.emptyArray;function l(e){t.isSourceFileDefaultLibrary(e)||(i||(i=[])).push(e)}}}}(ts||(ts={})),function(e){var t=/(^\s*$)|(^\s*\/\/\/?\s*(@ts-ignore)?)/;function n(t,n){var i=e.getDirectoryPath(n),r=e.isRootedDiskPath(t)?t:e.combinePaths(i,t);return e.normalizePath(r)}function i(t,n,i){var r;return e.forEach(t,function(t){var s=e.getNormalizedPathComponents(t,n);if(s.pop(),r){for(var o=Math.min(r.length,s.length),a=0;a<o;a++)if(i(r[a])!==i(s[a])){if(0===a)return!0;r.length=a;break}s.length<r.length&&(r.length=s.length)}else r=s})?"":r?e.getNormalizedPathFromPathComponents(r):n}function r(t,n){var i,r=e.createMap();function s(t){t.length>e.getRootLength(t)&&!function(t){return!!r.has(t)||!!e.sys.directoryExists(t)&&(r.set(t,!0),!0)}(t)&&(s(e.getDirectoryPath(t)),e.sys.createDirectory(t))}function o(){return e.getDirectoryPath(e.normalizePath(e.sys.getExecutingFilePath()))}var a=e.getNewLineCharacter(t),l=e.sys.realpath&&function(t){return e.sys.realpath(t)};return{getSourceFile:function(i,r,s){var o;try{e.performance.mark("beforeIORead"),o=e.sys.readFile(i,t.charset),e.performance.mark("afterIORead"),e.performance.measure("I/O Read","beforeIORead","afterIORead")}catch(e){s&&s(e.message),o=""}return void 0!==o?e.createSourceFile(i,o,r,n):void 0},getDefaultLibLocation:o,getDefaultLibFileName:function(t){return e.combinePaths(o(),e.getDefaultLibFileName(t))},writeFile:function(n,r,o,a){try{e.performance.mark("beforeIOWrite"),s(e.getDirectoryPath(e.normalizePath(n))),e.isWatchSet(t)&&e.sys.createHash&&e.sys.getModifiedTime?function(t,n,r){i||(i=e.createMap());var s=e.sys.createHash(n),o=e.sys.getModifiedTime(t);if(o){var a=i.get(t);if(a&&a.byteOrderMark===r&&a.hash===s&&a.mtime.getTime()===o.getTime())return}e.sys.writeFile(t,n,r);var l=e.sys.getModifiedTime(t);i.set(t,{hash:s,byteOrderMark:r,mtime:l})}(n,r,o):e.sys.writeFile(n,r,o),e.performance.mark("afterIOWrite"),e.performance.measure("I/O Write","beforeIOWrite","afterIOWrite")}catch(e){a&&a(e.message)}},getCurrentDirectory:e.memoize(function(){return e.sys.getCurrentDirectory()}),useCaseSensitiveFileNames:function(){return e.sys.useCaseSensitiveFileNames},getCanonicalFileName:function(t){return e.sys.useCaseSensitiveFileNames?t:t.toLowerCase()},getNewLine:function(){return a},fileExists:function(t){return e.sys.fileExists(t)},readFile:function(t){return e.sys.readFile(t)},trace:function(t){return e.sys.write(t+a)},directoryExists:function(t){return e.sys.directoryExists(t)},getEnvironmentVariable:function(t){return e.sys.getEnvironmentVariable?e.sys.getEnvironmentVariable(t):""},getDirectories:function(t){return e.sys.getDirectories(t)},realpath:l}}function s(t,n){var i=e.DiagnosticCategory[t.category].toLowerCase()+" TS"+t.code+": "+p(t.messageText,n.getNewLine())+n.getNewLine();if(t.file){var r=e.getLineAndCharacterOfPosition(t.file,t.start),s=r.line,o=r.character,a=t.file.fileName,l=e.convertToRelativePath(a,n.getCurrentDirectory(),function(e){return n.getCanonicalFileName(e)});return l+"("+(s+1)+","+(o+1)+"): "+i}return i}e.findConfigFile=function(t,n,i){for(void 0===i&&(i="tsconfig.json");;){var r=e.combinePaths(t,i);if(n(r))return r;var s=e.getDirectoryPath(t);if(s===t)break;t=s}},e.resolveTripleslashReference=n,e.computeCommonSourceDirectoryOfFilenames=i,e.createCompilerHost=r,e.getPreEmitDiagnostics=function(t,n,i){var r=t.getOptionsDiagnostics(i).concat(t.getSyntacticDiagnostics(n,i),t.getGlobalDiagnostics(i),t.getSemanticDiagnostics(n,i));return t.getCompilerOptions().declaration&&e.addRange(r,t.getDeclarationDiagnostics(n,i)),e.sortAndDeduplicateDiagnostics(r)},e.formatDiagnostics=function(e,t){for(var n="",i=0,r=e;i<r.length;i++){n+=s(r[i],t)}return n},e.formatDiagnostic=s;var o="[91m",a="[30;47m",l="[0m";function c(t){switch(t){case e.DiagnosticCategory.Warning:return"[93m";case e.DiagnosticCategory.Error:return o;case e.DiagnosticCategory.Message:return"[93m"}}function u(e,t){return t+e+l}function d(e,t){for(;e.length<t;)e=" "+e;return e}function p(t,n){if(e.isString(t))return t;for(var i=t,r="",s=0;i;){if(s){r+=n;for(var o=0;o<s;o++)r+="  "}r+=i.messageText,s++,i=i.next}return r}function h(t,n,i){if(0===t.length)return[];for(var r=[],s=e.createMap(),o=0,a=t;o<a.length;o++){var l=a[o],c=void 0;s.has(l)?c=s.get(l):s.set(l,c=i(l,n)),r.push(c)}return r}function f(t,n){switch(n.extension){case".ts":case".d.ts":return;case".tsx":return i();case".jsx":return i()||r();case".js":return r()}function i(){return t.jsx?void 0:e.Diagnostics.Module_0_was_resolved_to_1_but_jsx_is_not_set}function r(){return t.allowJs||!t.noImplicitAny?void 0:e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type}}function m(t){return e.Debug.assert(t.every(function(e){return void 0!==e}),"A name is undefined.",function(){return JSON.stringify(t)}),t}function g(e){for(var t=e.imports,n=e.moduleAugmentations,i=t.map(function(e){return e.text}),r=0,s=n;r<s.length;r++){var o=s[r];9===o.kind&&i.push(o.text)}return i}e.formatDiagnosticsWithColorAndContext=function(t,n){for(var i="",r=0,s=t;r<s.length;r++){var h=s[r],f="";if(h.file){var m=h.start,g=h.length,_=h.file,y=e.getLineAndCharacterOfPosition(_,m),b=y.line,v=y.character,T=e.getLineAndCharacterOfPosition(_,m+g),k=T.line,x=T.character,E=e.getLineAndCharacterOfPosition(_,_.text.length).line,S=n?e.convertToRelativePath(_.fileName,n.getCurrentDirectory(),function(e){return n.getCanonicalFileName(e)}):_.fileName,C=k-b>=4,w=(k+1+"").length;C&&(w=Math.max(3,w)),f+=n.getNewLine();for(var I=b;I<=k;I++){C&&b+1<I&&I<k-1&&(f+=u(d("...",w),a)+" "+n.getNewLine(),I=k-1);var A=e.getPositionOfLineAndCharacter(_,I,0),N=I<E?e.getPositionOfLineAndCharacter(_,I+1,0):_.text.length,D=_.text.slice(A,N);if(D=(D=D.replace(/\s+$/g,"")).replace("\t"," "),f+=u(d(I+1+"",w),a)+" ",f+=D+n.getNewLine(),f+=u(d("",w),a)+" ",f+=o,I===b){var O=I===k?x:void 0;f+=D.slice(0,v).replace(/\S/g," "),f+=D.slice(v,O).replace(/./g,"~")}else f+=I===k?D.slice(0,x).replace(/./g,"~"):D.replace(/./g,"~");f+=l}i+=n.getNewLine(),i+=S+"("+(b+1)+","+(v+1)+"): "}var R=c(h.category);i+=u(e.DiagnosticCategory[h.category].toLowerCase(),R)+" TS"+h.code+": "+p(h.messageText,n.getNewLine()),h.file&&(i+=n.getNewLine(),i+=f),i+=n.getNewLine()}return i},e.flattenDiagnosticMessageText=p,e.isProgramUptoDate=function(t,n,i,r,s,o,a){if(!t||a)return!1;if(t.getRootFileNames().length!==n.length)return!1;if(t.getSourceFiles().some(function(e){return e.version!==r(e.path)||o(e.path)}))return!1;if(t.getMissingFilePaths().some(s))return!1;var l=t.getCompilerOptions();return!!e.compareDataObjects(l,i)&&(!l.configFile||!i.configFile||l.configFile.text===i.configFile.text)},e.createProgram=function(s,o,a,l){var c,u,d,p,_,y,b=[],v={},T={},k=e.createMap(),x=e.createDiagnosticCollection(),E="number"==typeof o.maxNodeModuleJsDepth?o.maxNodeModuleJsDepth:0,S=0,C=e.createMap(),w=e.createMap();e.performance.mark("beforeProgram"),a=a||r(o);var I,A,N,D,O=o.noLib,R=e.memoize(function(){return a.getDefaultLibFileName(o)}),L=a.getDefaultLibLocation?a.getDefaultLibLocation():e.getDirectoryPath(R()),P=e.createDiagnosticCollection(),M=a.getCurrentDirectory(),F=e.getSupportedExtensions(o),B=e.createMap(),$=a.hasInvalidatedResolution||e.returnFalse;if(a.resolveModuleNames)N=function(t,n,i){return a.resolveModuleNames(m(t),n,i).map(function(t){if(!t||void 0!==t.extension)return t;var n=e.clone(t);return n.extension=e.extensionFromPath(t.resolvedFileName),n})};else{A=e.createModuleResolutionCache(M,function(e){return a.getCanonicalFileName(e)});var U=function(t,n){return e.resolveModuleName(t,n,o,a,A).resolvedModule};N=function(e,t){return h(m(e),t,U)}}if(a.resolveTypeReferenceDirectives)D=function(e,t){return a.resolveTypeReferenceDirectives(m(e),t)};else{var V=function(t,n){return e.resolveTypeReferenceDirective(t,n,o,a).resolvedTypeReferenceDirective};D=function(e,t){return h(m(e),t,V)}}var H,G=e.createMap(),j=e.createMap(),K=e.createMap(),z=e.createMap(),W=a.useCaseSensitiveFileNames()?e.createMap():void 0,q=function(t,n){var i=t&&t.getCompilerOptions();return i&&(i.target!==n.target||i.module!==n.module||i.moduleResolution!==n.moduleResolution||i.noResolve!==n.noResolve||i.jsx!==n.jsx||i.allowJs!==n.allowJs||i.disableSizeLimit!==n.disableSizeLimit||i.baseUrl!==n.baseUrl||!e.equalOwnProperties(i.paths,n.paths))}(l,o),J=function(){if(!l)return 0;var t=l.getCompilerOptions();if(e.changesAffectModuleResolution(t,o))return l.structureIsReused=0;e.Debug.assert(!(3&l.structureIsReused));var n=l.getRootFileNames();if(!e.arrayIsEqualTo(n,s))return l.structureIsReused=0;if(!e.arrayIsEqualTo(o.types,t.types))return l.structureIsReused=0;var i=[],r=[],c=[];if(l.structureIsReused=2,l.getMissingFilePaths().some(function(e){return a.fileExists(e)}))return l.structureIsReused=0;var u,d=l.getSourceFiles();!function(e){e[e.Exists=0]="Exists",e[e.Modified=1]="Modified"}(u||(u={}));for(var p=e.createMap(),h=0,f=d;h<f.length;h++){var m=f[h];if(!(A=a.getSourceFileByPath?a.getSourceFileByPath(m.fileName,m.path,o.target,void 0,q):a.getSourceFile(m.fileName,o.target,void 0,q)))return l.structureIsReused=0;e.Debug.assert(!A.redirectInfo,"Host should not return a redirect source file from `getSourceFile`");var _=void 0;if(m.redirectInfo){if(A!==m.redirectInfo.unredirected)return l.structureIsReused=0;_=!1,A=m}else if(l.redirectTargetsSet.has(m.path)){if(A!==m)return l.structureIsReused=0;_=!1}else _=A!==m;A.path=m.path,r.push(A.path);var v=l.sourceFileToPackageName.get(m.path);if(void 0!==v){var T=p.get(v),E=_?1:0;if(void 0!==T&&1===E||1===T)return l.structureIsReused=0;p.set(v,E)}_?(m.hasNoDefaultLib!==A.hasNoDefaultLib&&(l.structureIsReused=1),e.arrayIsEqualTo(m.referencedFiles,A.referencedFiles,Se)||(l.structureIsReused=1),we(A),e.arrayIsEqualTo(m.imports,A.imports,Ce)||(l.structureIsReused=1),e.arrayIsEqualTo(m.moduleAugmentations,A.moduleAugmentations,Ce)||(l.structureIsReused=1),(524288&m.flags)!=(524288&A.flags)&&(l.structureIsReused=1),e.arrayIsEqualTo(m.typeReferenceDirectives,A.typeReferenceDirectives,Se)||(l.structureIsReused=1),c.push({oldFile:m,newFile:A})):$(m.path)&&(l.structureIsReused=1,c.push({oldFile:m,newFile:A})),i.push(A)}if(2!==l.structureIsReused)return l.structureIsReused;y=c.map(function(e){return e.newFile.path});for(var S=0,C=c;S<C.length;S++){var I=C[S],A=(m=I.oldFile,I.newFile),O=e.getNormalizedAbsolutePath(A.fileName,M);if(N){var R=g(A),L=oe(R,O,A,{program:l,file:m,modifiedFilePaths:y});e.hasChangesInResolutions(R,L,m.resolvedModules,e.moduleResolutionIsEqualTo)?(l.structureIsReused=1,A.resolvedModules=e.zipToMap(R,L)):A.resolvedModules=m.resolvedModules}if(D){var P=e.map(A.typeReferenceDirectives,function(e){return e.fileName});L=D(P,O);e.hasChangesInResolutions(P,L,m.resolvedTypeReferenceDirectiveNames,e.typeDirectiveIsEqualTo)?(l.structureIsReused=1,A.resolvedTypeReferenceDirectiveNames=e.zipToMap(P,L)):A.resolvedTypeReferenceDirectiveNames=m.resolvedTypeReferenceDirectiveNames}}if(2!==l.structureIsReused)return l.structureIsReused;if(a.hasChangedAutomaticTypeDirectiveNames)return l.structureIsReused=1;H=l.getMissingFilePaths();for(var F=0;F<i.length;F++)z.set(r[F],i[F]),l.isSourceFileFromExternalLibrary(l.getSourceFileByPath(r[F]))&&w.set(r[F],!0);b=i,x=l.getFileProcessingDiagnostics();for(var B=0,U=c;B<U.length;B++){var V=U[B];x.reattachFileDiagnostics(V.newFile)}return k=l.getResolvedTypeReferenceDirectives(),j=l.sourceFileToPackageName,K=l.redirectTargetsSet,l.structureIsReused=2}();if(2!==J){e.forEach(s,function(e){return Ee(e,!1)});var Y=e.getAutomaticTypeDirectiveNames(o,a);if(Y.length)for(var X=o.configFilePath?e.getDirectoryPath(o.configFilePath):a.getCurrentDirectory(),Z=e.combinePaths(X,"__inferred type names__.ts"),Q=D(Y,Z),ee=0;ee<Y.length;ee++)Le(Y[ee],Q[ee]);O||(o.lib?e.forEach(o.lib,function(t){Ee(e.combinePaths(L,t),!0)}):Ee(R(),!0)),H=e.arrayFrom(z.keys(),function(e){return e}).filter(function(e){return!z.get(e)})}if(e.Debug.assert(!!H),A=void 0,l&&a.onReleaseOldSourceFile)for(var te=0,ne=l.getSourceFiles();te<ne.length;te++){var ie=ne[te];pe(ie.path)&&!q||a.onReleaseOldSourceFile(ie,l.getCompilerOptions())}return l=void 0,c={getRootFileNames:function(){return s},getSourceFile:pe,getSourceFileByPath:he,getSourceFiles:function(){return b},getMissingFilePaths:function(){return H},getCompilerOptions:function(){return o},getSyntacticDiagnostics:function(e,t){return fe(e,me,t)},getOptionsDiagnostics:function(){return e.sortAndDeduplicateDiagnostics(e.concatenate(x.getGlobalDiagnostics(),e.concatenate(P.getGlobalDiagnostics(),o.configFile?P.getDiagnostics(o.configFile.fileName):[])))},getGlobalDiagnostics:function(){return e.sortAndDeduplicateDiagnostics(ce().getGlobalDiagnostics().slice())},getSemanticDiagnostics:function(e,t){return fe(e,_e,t)},getDeclarationDiagnostics:function(e,t){var n=c.getCompilerOptions();return!e||n.out||n.outFile?ve(e,t):fe(e,xe,t)},getTypeChecker:ue,getClassifiableNames:function(){if(!_){ue(),_=e.createUnderscoreEscapedMap();for(var t=0,n=b;t<n.length;t++){var i=n[t];e.copyEntries(i.classifiableNames,_)}}return _},getDiagnosticsProducingTypeChecker:ce,getCommonSourceDirectory:se,emit:function(t,n,i,r,s){return ge(function(){return function(t,n,i,r,s,a){var l=[];if(o.noEmit)return{diagnostics:l,sourceMaps:void 0,emittedFiles:void 0,emitSkipped:!0};if(o.noEmitOnError){var c=t.getOptionsDiagnostics(r).concat(t.getSyntacticDiagnostics(n,r),t.getGlobalDiagnostics(r),t.getSemanticDiagnostics(n,r));if(0===c.length&&t.getCompilerOptions().declaration&&(l=t.getDeclarationDiagnostics(void 0,r)),c.length>0||l.length>0)return{diagnostics:e.concatenate(c,l),sourceMaps:void 0,emittedFiles:void 0,emitSkipped:!0}}var u=ce().getEmitResolver(o.outFile||o.out?void 0:n);e.performance.mark("beforeEmit");var d=s?[]:e.getTransformers(o,a),p=e.emitFiles(u,ae(i),n,s,d);return e.performance.mark("afterEmit"),e.performance.measure("Emit","beforeEmit","afterEmit"),p}(c,t,n,i,r,s)})},getCurrentDirectory:function(){return M},getNodeCount:function(){return ce().getNodeCount()},getIdentifierCount:function(){return ce().getIdentifierCount()},getSymbolCount:function(){return ce().getSymbolCount()},getTypeCount:function(){return ce().getTypeCount()},getFileProcessingDiagnostics:function(){return x},getResolvedTypeReferenceDirectives:function(){return k},isSourceFileFromExternalLibrary:le,isSourceFileDefaultLibrary:function(t){if(t.hasNoDefaultLib)return!0;if(!o.noLib)return!1;return o.lib?e.forEach(o.lib,function(n){return 0===e.compareStrings(t.fileName,e.combinePaths(L,n),!a.useCaseSensitiveFileNames())}):0===e.compareStrings(t.fileName,R(),!a.useCaseSensitiveFileNames())},dropDiagnosticsProducingTypeChecker:function(){d=void 0},getSourceFileFromReference:function(e,t){return Ie(n(t.fileName,e.fileName),function(e){return z.get(re(e))})},sourceFileToPackageName:j,redirectTargetsSet:K},function(){o.isolatedModules&&(o.declaration&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"declaration","isolatedModules"),o.noEmitOnError&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"noEmitOnError","isolatedModules"),o.out&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"out","isolatedModules"),o.outFile&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"outFile","isolatedModules"));o.inlineSourceMap&&(o.sourceMap&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"sourceMap","inlineSourceMap"),o.mapRoot&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"mapRoot","inlineSourceMap"));o.paths&&void 0===o.baseUrl&&Ve(e.Diagnostics.Option_paths_cannot_be_used_without_specifying_baseUrl_option,"paths");if(o.paths)for(var t in o.paths)if(e.hasProperty(o.paths,t))if(e.hasZeroOrOneAsteriskCharacter(t)||$e(!0,t,e.Diagnostics.Pattern_0_can_have_at_most_one_Asterisk_character,t),e.isArray(o.paths[t])){var n=o.paths[t].length;0===n&&$e(!1,t,e.Diagnostics.Substitutions_for_pattern_0_shouldn_t_be_an_empty_array,t);for(var i=0;i<n;i++){var r=o.paths[t][i],s=typeof r;"string"===s?e.hasZeroOrOneAsteriskCharacter(r)||Be(t,i,e.Diagnostics.Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character,r,t):Be(t,i,e.Diagnostics.Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2,r,t,s)}}else $e(!1,t,e.Diagnostics.Substitutions_for_pattern_0_should_be_an_array,t);o.sourceMap||o.inlineSourceMap||(o.inlineSources&&Ve(e.Diagnostics.Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided,"inlineSources"),o.sourceRoot&&Ve(e.Diagnostics.Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided,"sourceRoot"));o.out&&o.outFile&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"out","outFile");o.mapRoot&&!o.sourceMap&&Ve(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"mapRoot","sourceMap");o.declarationDir&&(o.declaration||Ve(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"declarationDir","declaration"),(o.out||o.outFile)&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"declarationDir",o.out?"out":"outFile"));o.lib&&o.noLib&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"lib","noLib");o.noImplicitUseStrict&&(void 0===o.alwaysStrict?o.strict:o.alwaysStrict)&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"noImplicitUseStrict","alwaysStrict");var l=o.target||0,c=o.outFile||o.out,u=e.forEach(b,function(t){return e.isExternalModule(t)&&!t.isDeclarationFile?t:void 0});if(o.isolatedModules){o.module===e.ModuleKind.None&&l<2&&Ve(e.Diagnostics.Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES2015_or_higher,"isolatedModules","target");var d=e.forEach(b,function(t){return e.isExternalModule(t)||t.isDeclarationFile?void 0:t});if(d){var p=e.getErrorSpanForNode(d,d);P.add(e.createFileDiagnostic(d,p.start,p.length,e.Diagnostics.Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided))}}else if(u&&l<2&&o.module===e.ModuleKind.None){var h=e.getErrorSpanForNode(u,u.externalModuleIndicator);P.add(e.createFileDiagnostic(u,h.start,h.length,e.Diagnostics.Cannot_use_imports_exports_or_module_augmentations_when_module_is_none))}if(c)if(o.module&&o.module!==e.ModuleKind.AMD&&o.module!==e.ModuleKind.System)Ve(e.Diagnostics.Only_amd_and_system_modules_are_supported_alongside_0,o.out?"out":"outFile","module");else if(void 0===o.module&&u){var f=e.getErrorSpanForNode(u,u.externalModuleIndicator);P.add(e.createFileDiagnostic(u,f.start,f.length,e.Diagnostics.Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system,o.out?"out":"outFile"))}if(o.outDir||o.sourceRoot||o.mapRoot){var m=se();o.outDir&&""===m&&e.forEach(b,function(t){return e.getRootLength(t.fileName)>1})&&Ve(e.Diagnostics.Cannot_find_the_common_subdirectory_path_for_the_input_files,"outDir")}!o.noEmit&&o.allowJs&&o.declaration&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"allowJs","declaration");o.checkJs&&!o.allowJs&&P.add(e.createCompilerDiagnostic(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"checkJs","allowJs"));o.emitDecoratorMetadata&&!o.experimentalDecorators&&Ve(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"emitDecoratorMetadata","experimentalDecorators");o.jsxFactory?(o.reactNamespace&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"reactNamespace","jsxFactory"),e.parseIsolatedEntityName(o.jsxFactory,l)||He("jsxFactory",e.Diagnostics.Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name,o.jsxFactory)):o.reactNamespace&&!e.isIdentifierText(o.reactNamespace,l)&&He("reactNamespace",e.Diagnostics.Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier,o.reactNamespace);if(!o.noEmit&&!o.suppressOutputPathCheck){var g=ae(),_=e.createMap();e.forEachEmittedFile(g,function(e){y(e.jsFilePath,_),y(e.declarationFilePath,_)})}function y(t,n){if(t){var i,r=re(t);if(z.has(r))o.configFilePath||(i=e.chainDiagnosticMessages(void 0,e.Diagnostics.Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript_files_Learn_more_at_https_Colon_Slash_Slashaka_ms_Slashtsconfig)),i=e.chainDiagnosticMessages(i,e.Diagnostics.Cannot_write_file_0_because_it_would_overwrite_input_file,t),ze(t,e.createCompilerDiagnosticFromMessageChain(i));var s=a.useCaseSensitiveFileNames()?r:r.toLocaleLowerCase();n.has(s)?ze(t,e.createCompilerDiagnostic(e.Diagnostics.Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files,t)):n.set(s,!0)}}}(),e.performance.mark("afterProgram"),e.performance.measure("Program","beforeProgram","afterProgram"),c;function re(t){return e.toPath(t,M,Me)}function se(){if(void 0===u){var t=e.filter(b,function(t){return e.sourceFileMayBeEmitted(t,o,le)});u=o.rootDir&&function(t,n){var i=!0;if(t)for(var r=a.getCanonicalFileName(e.getNormalizedAbsolutePath(n,M)),s=0,l=t;s<l.length;s++){var c=l[s];if(!c.isDeclarationFile)0!==a.getCanonicalFileName(e.getNormalizedAbsolutePath(c.fileName,M)).indexOf(r)&&(P.add(e.createCompilerDiagnostic(e.Diagnostics.File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files,c.fileName,o.rootDir)),i=!1)}return i}(t,o.rootDir)?e.getNormalizedAbsolutePath(o.rootDir,M):function(e){for(var t=[],n=0,r=e;n<r.length;n++){var s=r[n];s.isDeclarationFile||t.push(s.fileName)}return i(t,M,Me)}(t),u&&u[u.length-1]!==e.directorySeparator&&(u+=e.directorySeparator)}return u}function oe(t,n,i,r){if(0===J&&!i.ambientModuleNames.length)return N(t,n);var s,l,c,u=r.program&&r.program.getSourceFile(n);if(u!==i&&i.resolvedModules){for(var d=[],p=0,h=t;p<h.length;p++){var f=h[p],m=i.resolvedModules.get(f);d.push(m)}return d}for(var g={},_=0;_<t.length;_++){f=t[_];if(i===u&&!$(u.path)){var y=u&&u.resolvedModules.get(f);if(y){e.isTraceEnabled(o,a)&&e.trace(a,e.Diagnostics.Reusing_resolution_of_module_0_to_file_1_from_old_program,f,n),(l||(l=new Array(t.length)))[_]=y,(c||(c=[])).push(f);continue}}var b=!1;e.contains(i.ambientModuleNames,f)?(b=!0,e.isTraceEnabled(o,a)&&e.trace(a,e.Diagnostics.Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1,f,n)):b=k(f,r),b?(l||(l=new Array(t.length)))[_]=g:(s||(s=[])).push(f)}var v=s&&s.length?N(s,n,c):e.emptyArray;if(!l)return e.Debug.assert(v.length===t.length),v;var T=0;for(_=0;_<l.length;_++)l[_]?l[_]===g&&(l[_]=void 0):(l[_]=v[T],T++);return e.Debug.assert(T===v.length),l;function k(t,n){if(e.getResolvedModule(n.file,t))return!1;var i=n.program&&n.program.getTypeChecker().tryFindAmbientModuleWithoutAugmentations(t);if(!i||!i.declarations)return!1;var r=e.forEach(i.declarations,function(t){var i=e.getSourceFileOfNode(t);return!e.contains(n.modifiedFilePaths,i.path)&&i});return!!r&&(e.isTraceEnabled(o,a)&&e.trace(a,e.Diagnostics.Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified,t,r.fileName),!0)}}function ae(e){return{getCanonicalFileName:Me,getCommonSourceDirectory:c.getCommonSourceDirectory,getCompilerOptions:c.getCompilerOptions,getCurrentDirectory:function(){return M},getNewLine:function(){return a.getNewLine()},getSourceFile:c.getSourceFile,getSourceFileByPath:c.getSourceFileByPath,getSourceFiles:c.getSourceFiles,isSourceFileFromExternalLibrary:le,writeFile:e||function(e,t,n,i,r){return a.writeFile(e,t,n,i,r)},isEmitBlocked:de}}function le(e){return w.get(e.path)}function ce(){return d||(d=e.createTypeChecker(c,!0))}function ue(){return p||(p=e.createTypeChecker(c,!1))}function de(e){return B.has(re(e))}function pe(e){return he(re(e))}function he(e){return z.get(e)}function fe(t,n,i){return t?n(t,i):e.sortAndDeduplicateDiagnostics(e.flatMap(c.getSourceFiles(),function(e){return i&&i.throwIfCancellationRequested(),n(e,i)}))}function me(t){return e.isSourceFileJavaScript(t)?(t.additionalSyntacticDiagnostics||(t.additionalSyntacticDiagnostics=function(t){return ge(function(){var n=[],i=t;return r(t),n;function r(t){switch(i.kind){case 146:case 149:if(i.questionToken===t)return void n.push(c(t,e.Diagnostics._0_can_only_be_used_in_a_ts_file,"?"));case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:case 226:if(i.type===t)return void n.push(c(t,e.Diagnostics.types_can_only_be_used_in_a_ts_file))}switch(t.kind){case 237:return void n.push(c(t,e.Diagnostics.import_can_only_be_used_in_a_ts_file));case 243:if(t.isExportEquals)return void n.push(c(t,e.Diagnostics.export_can_only_be_used_in_a_ts_file));break;case 259:if(108===t.token)return void n.push(c(t,e.Diagnostics.implements_clauses_can_only_be_used_in_a_ts_file));break;case 230:return void n.push(c(t,e.Diagnostics.interface_declarations_can_only_be_used_in_a_ts_file));case 233:return void n.push(c(t,e.Diagnostics.module_declarations_can_only_be_used_in_a_ts_file));case 231:return void n.push(c(t,e.Diagnostics.type_aliases_can_only_be_used_in_a_ts_file));case 232:return void n.push(c(t,e.Diagnostics.enum_declarations_can_only_be_used_in_a_ts_file));case 203:return void n.push(c(t,e.Diagnostics.non_null_assertions_can_only_be_used_in_a_ts_file));case 202:return void n.push(c(t.type,e.Diagnostics.type_assertion_expressions_can_only_be_used_in_a_ts_file));case 184:e.Debug.fail()}var o=i;i=t,e.forEachChild(t,r,s),i=o}function s(t){switch(i.decorators!==t||o.experimentalDecorators||n.push(c(i,e.Diagnostics.Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning)),i.kind){case 229:case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:if(t===i.typeParameters)return void n.push(l(t,e.Diagnostics.type_parameter_declarations_can_only_be_used_in_a_ts_file));case 208:if(t===i.modifiers)return a(t,208===i.kind);break;case 149:if(t===i.modifiers){for(var s=0,u=t;s<u.length;s++){var d=u[s];115!==d.kind&&n.push(c(d,e.Diagnostics._0_can_only_be_used_in_a_ts_file,e.tokenToString(d.kind)))}return}break;case 146:if(t===i.modifiers)return void n.push(l(t,e.Diagnostics.parameter_modifiers_can_only_be_used_in_a_ts_file));break;case 181:case 182:case 201:if(t===i.typeArguments)return void n.push(l(t,e.Diagnostics.type_arguments_can_only_be_used_in_a_ts_file))}for(var p=0,h=t;p<h.length;p++){r(h[p])}}function a(t,i){for(var r=0,s=t;r<s.length;r++){var o=s[r];switch(o.kind){case 76:if(i)continue;case 114:case 112:case 113:case 131:case 124:case 117:n.push(c(o,e.Diagnostics._0_can_only_be_used_in_a_ts_file,e.tokenToString(o.kind)))}}}function l(n,i,r,s,o){var a=n.pos;return e.createFileDiagnostic(t,a,n.end-a,i,r,s,o)}function c(n,i,r,s,o){return e.createDiagnosticForNodeInSourceFile(t,n,i,r,s,o)}})}(t),e.isCheckJsEnabledForFile(t,o)&&(t.additionalSyntacticDiagnostics=e.concatenate(t.additionalSyntacticDiagnostics,t.jsDocDiagnostics))),e.concatenate(t.additionalSyntacticDiagnostics,t.parseDiagnostics)):t.parseDiagnostics}function ge(t){try{return t()}catch(t){throw t instanceof e.OperationCanceledException&&(p=void 0,d=void 0),t}}function _e(e,t){return ke(e,t,v,ye)}function ye(t,n){return ge(function(){if(o.skipLibCheck&&t.isDeclarationFile||o.skipDefaultLibCheck&&t.hasNoDefaultLib)return e.emptyArray;var i=ce();e.Debug.assert(!!t.bindDiagnostics);var r=3===t.scriptKind||4===t.scriptKind||5===t.scriptKind||e.isCheckJsEnabledForFile(t,o),s=r?t.bindDiagnostics:e.emptyArray,a=r?i.getDiagnostics(t,n):e.emptyArray,l=x.getDiagnostics(t.fileName),c=P.getDiagnostics(t.fileName),u=s.concat(a,l,c);return e.filter(u,be)})}function be(n){var i=n.file,r=n.start;if(i)for(var s=e.getLineStarts(i),o=e.computeLineAndCharacterOfPosition(s,r).line;o>0;){var a=i.text.slice(s[o-1],s[o]),l=t.exec(a);if(!l)return!0;if(l[3])return!1;o--}return!0}function ve(e,t){return ke(e,t,T,Te)}function Te(t,n){return ge(function(){var i=ce().getEmitResolver(t,n);return e.getDeclarationDiagnostics(ae(e.noop),i,t)})}function ke(t,n,i,r){var s=t?i.perFile&&i.perFile.get(t.path):i.allDiagnostics;if(s)return s;var o=r(t,n)||e.emptyArray;return t?(i.perFile||(i.perFile=e.createMap()),i.perFile.set(t.path,o)):i.allDiagnostics=o,o}function xe(e,t){return e.isDeclarationFile?[]:ve(e,t)}function Ee(t,n){Ae(e.normalizePath(t),n,void 0)}function Se(e,t){return e.fileName===t.fileName}function Ce(e,t){return 9===e.kind?9===t.kind&&e.text===t.text:71===t.kind&&e.escapedText===t.escapedText}function we(t){if(!t.imports){var n,i,r,s=e.isSourceFileJavaScript(t),a=e.isExternalModule(t);if(o.importHelpers&&(o.isolatedModules||a)&&!t.isDeclarationFile){var l=e.createLiteral(e.externalHelpersModuleNameText),c=e.createImportDeclaration(void 0,void 0,void 0);l.parent=c,c.parent=t,n=[l]}for(var u=0,d=t.statements;u<d.length;u++){var p=d[u];h(p,!1),(524288&t.flags||s)&&f(p)}return t.imports=n||e.emptyArray,t.moduleAugmentations=i||e.emptyArray,void(t.ambientModuleNames=r||e.emptyArray)}function h(s,o){switch(s.kind){case 238:case 237:case 244:var l=e.getExternalModuleName(s);if(!l||!e.isStringLiteral(l))break;if(!l.text)break;o&&e.isExternalModuleNameRelative(l.text)||(n||(n=[])).push(l);break;case 233:if(e.isAmbientModule(s)&&(o||e.hasModifier(s,2)||t.isDeclarationFile)){var c=s.name,u=e.getTextOfIdentifierOrLiteral(c);if(a||o&&!e.isExternalModuleNameRelative(u))(i||(i=[])).push(c);else if(!o){t.isDeclarationFile&&(r||(r=[])).push(u);var d=s.body;if(d)for(var p=0,f=d.statements;p<f.length;p++){h(f[p],!0)}}}}}function f(t){e.isRequireCall(t,!0)||e.isImportCall(t)&&1===t.arguments.length&&9===t.arguments[0].kind?(n||(n=[])).push(t.arguments[0]):e.forEachChild(t,f)}}function Ie(t,n,i,r){if(e.hasExtension(t)){if(!o.allowNonTsExtensions&&!e.forEach(F,function(n){return e.fileExtensionIs(a.getCanonicalFileName(t),n)}))return void(i&&i(e.Diagnostics.File_0_has_unsupported_extension_The_only_supported_extensions_are_1,t,"'"+F.join("', '")+"'"));var s=n(t);return i&&(s?r&&a.getCanonicalFileName(t)===a.getCanonicalFileName(r.fileName)&&i(e.Diagnostics.A_file_cannot_have_a_reference_to_itself):i(e.Diagnostics.File_0_not_found,t)),s}var l=o.allowNonTsExtensions&&n(t);if(l)return l;if(!i||!o.allowNonTsExtensions){var c=e.forEach(F,function(e){return n(t+e)});return i&&!c&&i(e.Diagnostics.File_0_not_found,t+".ts"),c}i(e.Diagnostics.File_0_not_found,t)}function Ae(t,n,i,r,s,o){Ie(t,function(e){return De(e,re(e),n,r,s,o,i)},function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];x.add(void 0!==r&&void 0!==o&&void 0!==s?e.createFileDiagnostic.apply(void 0,[r,s,o-s,t].concat(n)):e.createCompilerDiagnostic.apply(void 0,[t].concat(n)))},r)}function Ne(t,n,i,r,s){void 0!==i&&void 0!==r&&void 0!==s?x.add(e.createFileDiagnostic(i,r,s-r,e.Diagnostics.File_name_0_differs_from_already_included_file_name_1_only_in_casing,t,n)):x.add(e.createCompilerDiagnostic(e.Diagnostics.File_name_0_differs_from_already_included_file_name_1_only_in_casing,t,n))}function De(t,n,i,r,s,l,c){if(z.has(n)){var u=z.get(n);return u&&o.forceConsistentCasingInFileNames&&e.getNormalizedAbsolutePath(u.fileName,M)!==e.getNormalizedAbsolutePath(t,M)&&Ne(t,u.fileName,r,s,l),u&&w.get(u.path)&&0===S?(w.set(u.path,!1),o.noResolve||(Oe(u,i),Re(u)),C.set(u.path,!1),Fe(u)):u&&C.get(u.path)&&S<E&&(C.set(u.path,!1),Fe(u)),u}var d=a.getSourceFile(t,o.target,function(n){void 0!==r&&void 0!==s&&void 0!==l?x.add(e.createFileDiagnostic(r,s,l-s,e.Diagnostics.Cannot_read_file_0_Colon_1,t,n)):x.add(e.createCompilerDiagnostic(e.Diagnostics.Cannot_read_file_0_Colon_1,t,n))},q);if(c){var p=c.name+"/"+c.subModuleName+"@"+c.version,h=G.get(p);if(h){var f=function(e,t,n,i){var r=Object.create(e);return r.fileName=n,r.path=i,r.redirectInfo={redirectTarget:e,unredirected:t},Object.defineProperties(r,{id:{get:function(){return this.redirectInfo.redirectTarget.id},set:function(e){this.redirectInfo.redirectTarget.id=e}},symbol:{get:function(){return this.redirectInfo.redirectTarget.symbol},set:function(e){this.redirectInfo.redirectTarget.symbol=e}}}),r}(h,d,t,n);return K.set(h.path,!0),z.set(n,f),j.set(n,c.name),b.push(f),f}d&&(G.set(p,d),j.set(n,c.name))}if(z.set(n,d),d){if(w.set(n,S>0),d.path=n,a.useCaseSensitiveFileNames()){var m=n.toLowerCase(),g=W.get(m);g?Ne(t,g.fileName,r,s,l):W.set(m,d)}O=O||d.hasNoDefaultLib,o.noResolve||(Oe(d,i),Re(d)),Fe(d),i?b.unshift(d):b.push(d)}return d}function Oe(t,i){e.forEach(t.referencedFiles,function(e){Ae(n(e.fileName,t.fileName),i,void 0,t,e.pos,e.end)})}function Re(t){for(var n=e.map(t.typeReferenceDirectives,function(e){return e.fileName.toLocaleLowerCase()}),i=D(n,t.fileName),r=0;r<n.length;r++){var s=t.typeReferenceDirectives[r],o=i[r],a=s.fileName.toLocaleLowerCase();e.setResolvedTypeReferenceDirective(t,a,o),Le(a,o,t,s.pos,s.end)}}function Le(t,n,i,r,s){var o=k.get(t);if(!o||!o.primary){var l=!0;if(n)if(n.primary)Ae(n.resolvedFileName,!1,n.packageId,i,r,s);else if(o){if(n.resolvedFileName!==o.resolvedFileName)a.readFile(n.resolvedFileName)!==pe(o.resolvedFileName).text&&x.add(Pe(i,r,s,e.Diagnostics.Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_library_to_resolve_the_conflict,t,n.resolvedFileName,o.resolvedFileName));l=!1}else Ae(n.resolvedFileName,!1,n.packageId,i,r,s);else x.add(Pe(i,r,s,e.Diagnostics.Cannot_find_type_definition_file_for_0,t));l&&k.set(t,n)}}function Pe(t,n,i,r){for(var s=[],o=4;o<arguments.length;o++)s[o-4]=arguments[o];return void 0===t||void 0===n||void 0===i?e.createCompilerDiagnostic.apply(void 0,[r].concat(s)):e.createFileDiagnostic.apply(void 0,[t,n,i-n,r].concat(s))}function Me(e){return a.getCanonicalFileName(e)}function Fe(t){if(we(t),t.imports.length||t.moduleAugmentations.length){var n=g(t),i={program:l,file:t,modifiedFilePaths:y},r=oe(n,e.getNormalizedAbsolutePath(t.fileName,M),t,i);e.Debug.assert(r.length===n.length);for(var s=0;s<n.length;s++){var a=r[s];if(e.setResolvedModule(t,n[s],a),a){var c=a.isExternalLibraryImport,u=!e.extensionIsTypeScript(a.extension),d=c&&u,p=a.resolvedFileName;c&&S++;var h=d&&S>E,m=p&&!f(o,a)&&!o.noResolve&&s<t.imports.length&&!h&&!(u&&!o.allowJs);if(h)C.set(t.path,!0);else if(m){De(p,re(p),!1,t,e.skipTrivia(t.text,t.imports[s].pos),t.imports[s].end,a.packageId)}c&&S--}}}else t.resolvedModules=void 0}function Be(t,n,i,r,s,a){for(var l=!0,c=0,u=Ue();c<u.length;c++){var d=u[c];if(e.isObjectLiteralExpression(d.initializer))for(var p=0,h=e.getPropertyAssignment(d.initializer,t);p<h.length;p++){var f=h[p];e.isArrayLiteralExpression(f.initializer)&&f.initializer.elements.length>n&&(P.add(e.createDiagnosticForNodeInSourceFile(o.configFile,f.initializer.elements[n],i,r,s,a)),l=!1)}}l&&P.add(e.createCompilerDiagnostic(i,r,s,a))}function $e(t,n,i,r){for(var s=!0,o=0,a=Ue();o<a.length;o++){var l=a[o];e.isObjectLiteralExpression(l.initializer)&&Ke(l.initializer,t,n,void 0,i,r)&&(s=!1)}s&&P.add(e.createCompilerDiagnostic(i,r))}function Ue(){var t=je();return t?e.getPropertyAssignment(t,"paths"):e.emptyArray}function Ve(e,t,n){Ge(!0,t,n,e,t,n)}function He(e,t,n){Ge(!1,e,void 0,t,n)}function Ge(t,n,i,r,s,o){var a=je();(!a||!Ke(a,t,n,i,r,s,o))&&P.add(e.createCompilerDiagnostic(r,s,o))}function je(){if(void 0===I&&(I=null,o.configFile&&o.configFile.jsonObject))for(var t=0,n=e.getPropertyAssignment(o.configFile.jsonObject,"compilerOptions");t<n.length;t++){var i=n[t];if(e.isObjectLiteralExpression(i.initializer)){I=i.initializer;break}}return I}function Ke(t,n,i,r,s,a,l){for(var c=e.getPropertyAssignment(t,i,r),u=0,d=c;u<d.length;u++){var p=d[u];P.add(e.createDiagnosticForNodeInSourceFile(o.configFile,n?p.name:p.initializer,s,a,l))}return!!c.length}function ze(e,t){B.set(re(e),!0),P.add(t)}},e.getResolutionDiagnostic=f}(ts||(ts={})),function(e){var t,n;function i(e){return e&&void 0!==e.enableAutoDiscovery&&void 0===e.enable?{enable:e.enableAutoDiscovery,include:e.include||[],exclude:e.exclude||[]}:e}function r(){if(t)return t;var n=e.createMap(),i=e.createMap();return e.forEach(e.optionDeclarations,function(e){n.set(e.name.toLowerCase(),e),e.shortName&&i.set(e.shortName,e.name)}),t={optionNameMap:n,shortOptionNames:i}}function s(t){return o(t,e.createCompilerDiagnostic)}function o(t,n){var i=e.arrayFrom(t.type.keys()).map(function(e){return"'"+e+"'"}).join(", ");return n(e.Diagnostics.Argument_for_0_option_must_be_Colon_1,"--"+t.name,i)}function a(e,t,n){return L(e,P(t||""),n)}function l(t,n,i){if(void 0===n&&(n=""),n=P(n),!e.startsWith(n,"-")){if(""===n)return[];var r=n.split(",");switch(t.element.type){case"number":return e.map(r,parseInt);case"string":return e.map(r,function(e){return e||""});default:return e.filter(e.map(r,function(e){return a(t.element,e,i)}),function(e){return!!e})}}}function c(e,t){void 0===t&&(t=!1),e=e.toLowerCase();var n=r(),i=n.optionNameMap,s=n.shortOptionNames;if(t){var o=s.get(e);void 0!==o&&(e=o)}return i.get(e)}function u(t,n){var i=e.parseJsonText(t,n);return{config:f(i,i.parseDiagnostics),error:i.parseDiagnostics.length?i.parseDiagnostics[0]:void 0}}function d(t,n){var i=p(t,n);return e.isString(i)?e.parseJsonText(t,i):{parseDiagnostics:[i]}}function p(t,n){var i;try{i=n(t)}catch(n){return e.createCompilerDiagnostic(e.Diagnostics.Cannot_read_file_0_Colon_1,t,n.message)}return void 0===i?e.createCompilerDiagnostic(e.Diagnostics.The_specified_path_does_not_exist_Colon_0,t):i}function h(t){return e.arrayToMap(t,function(e){return e.name})}function f(e,t){return m(e,t,void 0,void 0)}function m(t,n,i,r){return t.jsonObject?s(t.jsonObject,i,void 0,void 0):{};function s(s,o,c,u){for(var d={},p=0,h=s.properties;p<h.length;p++){var f=h[p];if(261===f.kind){f.questionToken&&n.push(e.createDiagnosticForNodeInSourceFile(t,f.questionToken,e.Diagnostics._0_can_only_be_used_in_a_ts_file,"?")),l(f.name)||n.push(e.createDiagnosticForNodeInSourceFile(t,f.name,e.Diagnostics.String_literal_with_double_quotes_expected));var m=e.unescapeLeadingUnderscores(e.getTextOfPropertyName(f.name)),g=o?o.get(m):void 0;c&&!g&&n.push(e.createDiagnosticForNodeInSourceFile(t,f.name,c,m));var y=a(f.initializer,g);if(void 0!==m&&(d[m]=y,r&&(u||o===i))){var b=_(g,y);u?b&&r.onSetValidOptionKeyValueInParent(u,g,y):o===i&&(b?r.onSetValidOptionKeyValueInRoot(m,f.name,y,f.initializer):g||r.onSetUnknownOptionKeyValueInRoot(m,f.name,y,f.initializer))}}else n.push(e.createDiagnosticForNodeInSourceFile(t,f,e.Diagnostics.Property_assignment_expected))}return d}function a(i,r){switch(i.kind){case 101:return m(r&&"boolean"!==r.type),!0;case 86:return m(r&&"boolean"!==r.type),!1;case 95:return m(r&&"extends"===r.name),null;case 9:l(i)||n.push(e.createDiagnosticForNodeInSourceFile(t,i,e.Diagnostics.String_literal_with_double_quotes_expected)),m(r&&e.isString(r.type)&&"string"!==r.type);var c=i.text;if(r&&!e.isString(r.type)){var u=r;u.type.has(c.toLowerCase())||n.push(o(u,function(n,r,s){return e.createDiagnosticForNodeInSourceFile(t,i,n,r,s)}))}return c;case 8:return m(r&&"number"!==r.type),Number(i.text);case 178:m(r&&"object"!==r.type);var d=i;if(r){var p=r;return s(d,p.elementOptions,p.extraKeyDiagnosticMessage,p.name)}return s(d,void 0,void 0,void 0);case 177:return m(r&&"list"!==r.type),h=i.elements,f=r&&r.element,h.map(function(e){return a(e,f)})}var h,f;return void(r?m(!0):n.push(e.createDiagnosticForNodeInSourceFile(t,i,e.Diagnostics.Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_literal)));function m(s){s&&n.push(e.createDiagnosticForNodeInSourceFile(t,i,e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,r.name,g(r)))}}function l(n){return e.isStringLiteral(n)&&e.isStringDoubleQuoted(n,t)}}function g(t){return"list"===t.type?"Array":e.isString(t.type)?t.type:"string"}function _(t,n){if(t)return!!b(n)||("list"===t.type?e.isArray(n):typeof n===(e.isString(t.type)?t.type:"string"))}function y(e,t){t&&Object.defineProperty(e,"configFile",{enumerable:!1,writable:!1,value:t})}function b(e){return null==e}function v(t,n){return e.getDirectoryPath(e.toPath(t,n,e.identity))}function T(t,n,i,r,s,o,a,l){void 0===s&&(s={}),void 0===a&&(a=[]),void 0===l&&(l=[]),e.Debug.assert(void 0===t&&void 0!==n||void 0!==t&&void 0===n);var c=[],u=e.createGetCanonicalFileName(i.useCaseSensitiveFileNames),d=E(t,n,i,r,o,u,a,c),p=d.raw,h=e.extend(s,d.options||{});h.configFilePath=o,y(h,n);var f=function(){var t,s,u;e.hasProperty(p,"files")&&!b(p.files)&&(e.isArray(p.files)?0===(t=p.files).length&&T(e.Diagnostics.The_files_list_in_config_file_0_is_empty,o||"tsconfig.json"):T(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"files","Array"));e.hasProperty(p,"include")&&!b(p.include)&&(e.isArray(p.include)?s=p.include:T(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"include","Array"));if(e.hasProperty(p,"exclude")&&!b(p.exclude))e.isArray(p.exclude)?u=p.exclude:T(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"exclude","Array");else{var d=p.compilerOptions&&p.compilerOptions.outDir;d&&(u=[d])}void 0===t&&void 0===s&&(s=["**/*"]);var f=function(t,n,i,r,s,o,a,l,c){var u,d;r=e.normalizePath(r),n&&(u=H(n,a,!1,c,"include"));i&&(d=H(i,a,!0,c,"exclude"));var p=function(t,n,i,r){var s=e.getRegularExpressionForWildcard(n,i,"exclude"),o=s&&new RegExp(s,r?"":"i"),a={};if(void 0!==t){for(var l=[],c=0,u=t;c<u.length;c++){var d=u[c],p=e.normalizePath(e.combinePaths(i,d));if(!o||!o.test(p)){var h=G(p,r);if(h){var f=h.key,m=h.flags,g=a[f];(void 0===g||g<m)&&(a[f]=m,1===m&&l.push(f))}}}for(var f in a)if(e.hasProperty(a,f))for(var _=0,y=l;_<y.length;_++){var b=y[_];f!==b&&e.containsPath(b,f,i,!r)&&delete a[f]}}return a}(u,d,r,o.useCaseSensitiveFileNames),h={filesSpecs:t,includeSpecs:n,excludeSpecs:i,validatedIncludeSpecs:u,validatedExcludeSpecs:d,wildcardDirectories:p};return V(h,r,s,o,l)}(t,s,u,o?v(o,r):r,h,i,c,l,n);0!==f.fileNames.length||e.hasProperty(p,"files")||0!==a.length||c.push(k(f.spec,o));return f}(),m=f.fileNames,g=f.wildcardDirectories,_=f.spec;return{options:h,fileNames:m,typeAcquisition:d.typeAcquisition||I(),raw:p,errors:c,wildcardDirectories:g,compileOnSave:!!p.compileOnSave,configFileSpecs:_};function T(t,i,r){n||c.push(e.createCompilerDiagnostic(t,i,r))}}function k(t,n){var i=t.includeSpecs,r=t.excludeSpecs;return e.createCompilerDiagnostic(e.Diagnostics.No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2,n||"tsconfig.json",JSON.stringify(i||[]),JSON.stringify(r||[]))}function x(e){return!!e.options}function E(t,i,r,s,o,a,l,c){s=e.normalizeSlashes(s);var u=e.toPath(o||"",s,a);if(l.indexOf(u)>=0)return c.push(e.createCompilerDiagnostic(e.Diagnostics.Circularity_detected_while_resolving_configuration_Colon_0,l.concat([u]).join(" -> "))),{raw:t||f(i,c)};var p=t?function(t,n,i,r,s,o){e.hasProperty(t,"excludes")&&o.push(e.createCompilerDiagnostic(e.Diagnostics.Unknown_option_excludes_Did_you_mean_exclude));var a,l=w(t.compilerOptions,i,o,s),c=A(t.typeAcquisition||t.typingOptions,i,o,s);if(t.compileOnSave=function(t,n,i){if(!e.hasProperty(t,e.compileOnSaveCommandLineOption.name))return;var r=D(e.compileOnSaveCommandLineOption,t.compileOnSave,n,i);if("boolean"==typeof r&&r)return r;return!1}(t,i,o),t.extends)if(e.isString(t.extends)){var u=s?v(s,i):i;a=S(t.extends,n,u,r,o,e.createCompilerDiagnostic)}else o.push(e.createCompilerDiagnostic(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"extends","string"));return{raw:t,options:l,typeAcquisition:c,extendedConfigPath:a}}(t,r,s,a,o,c):function(t,i,r,s,o,a){var l,c,u,d=C(o),p={onSetValidOptionKeyValueInParent:function(t,n,i){e.Debug.assert("compilerOptions"===t||"typeAcquisition"===t||"typingOptions"===t),("compilerOptions"===t?d:"typeAcquisition"===t?l||(l=I(o)):c||(c=I(o)))[n.name]=O(n,r,i)},onSetValidOptionKeyValueInRoot:function(n,l,c,d){switch(n){case"extends":var p=o?v(o,r):r;return void(u=S(c,i,p,s,a,function(n,i){return e.createDiagnosticForNodeInSourceFile(t,d,n,i)}));case"files":return void(0===c.length&&a.push(e.createDiagnosticForNodeInSourceFile(t,d,e.Diagnostics.The_files_list_in_config_file_0_is_empty,o||"tsconfig.json")))}},onSetUnknownOptionKeyValueInRoot:function(n,i,r,s){"excludes"===n&&a.push(e.createDiagnosticForNodeInSourceFile(t,i,e.Diagnostics.Unknown_option_excludes_Did_you_mean_exclude))}},f=m(t,a,(void 0===n&&(n=h([{name:"compilerOptions",type:"object",elementOptions:h(e.optionDeclarations),extraKeyDiagnosticMessage:e.Diagnostics.Unknown_compiler_option_0},{name:"typingOptions",type:"object",elementOptions:h(e.typeAcquisitionDeclarations),extraKeyDiagnosticMessage:e.Diagnostics.Unknown_type_acquisition_option_0},{name:"typeAcquisition",type:"object",elementOptions:h(e.typeAcquisitionDeclarations),extraKeyDiagnosticMessage:e.Diagnostics.Unknown_type_acquisition_option_0},{name:"extends",type:"string"},{name:"files",type:"list",element:{name:"files",type:"string"}},{name:"include",type:"list",element:{name:"include",type:"string"}},{name:"exclude",type:"list",element:{name:"exclude",type:"string"}},e.compileOnSaveCommandLineOption])),n),p);l||(l=c?void 0!==c.enableAutoDiscovery?{enable:c.enableAutoDiscovery,include:c.include,exclude:c.exclude}:c:I(o));return{raw:f,options:d,typeAcquisition:l,extendedConfigPath:u}}(i,r,s,a,o,c);if(p.extendedConfigPath){l=l.concat([u]);var g=function(t,n,i,r,s,o,a){var l=d(n,function(e){return i.readFile(e)});t&&(t.extendedSourceFiles||(t.extendedSourceFiles=[])).push(l.fileName);if(l.parseDiagnostics.length)return void a.push.apply(a,l.parseDiagnostics);var c,u=e.getDirectoryPath(n),p=E(void 0,l,i,u,e.getBaseFileName(n),s,o,a);t&&(c=t.extendedSourceFiles).push.apply(c,l.extendedSourceFiles);if(x(p)){var h=e.convertToRelativePath(u,r,s),f=function(t){return e.isRootedDiskPath(t)?t:e.combinePaths(h,t)},m=function(t){g[t]&&(g[t]=e.map(g[t],f))},g=p.raw;m("include"),m("exclude"),m("files")}return p}(i,p.extendedConfigPath,r,s,a,l,c);if(g&&x(g)){var _=g.raw,y=p.raw,b=function(e){var t=y[e]||_[e];t&&(y[e]=t)};b("include"),b("exclude"),b("files"),void 0===y.compileOnSave&&(y.compileOnSave=_.compileOnSave),p.options=e.assign({},g.options,p.options)}}return p}function S(t,n,i,r,s,o){if(t=e.normalizeSlashes(t),e.isRootedDiskPath(t)||e.startsWith(t,"./")||e.startsWith(t,"../")){var a=e.toPath(t,i,r);if(n.fileExists(a)||e.endsWith(a,".json")||(a+=".json",n.fileExists(a)))return a;s.push(o(e.Diagnostics.File_0_does_not_exist,t))}else s.push(o(e.Diagnostics.A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not,t))}function C(t){return"jsconfig.json"===e.getBaseFileName(t)?{allowJs:!0,maxNodeModuleJsDepth:2,allowSyntheticDefaultImports:!0,skipLibCheck:!0}:{}}function w(t,n,i,r){var s=C(r);return N(e.optionDeclarations,t,n,s,e.Diagnostics.Unknown_compiler_option_0,i),s}function I(t){return{enable:"jsconfig.json"===e.getBaseFileName(t),include:[],exclude:[]}}function A(t,n,r,s){var o=I(s),a=i(t);return N(e.typeAcquisitionDeclarations,a,n,o,e.Diagnostics.Unknown_type_acquisition_option_0,r),o}function N(t,n,i,r,s,o){if(n){var a=h(t);for(var l in n){var c=a.get(l);c?r[c.name]=D(c,n[l],i,o):o.push(e.createCompilerDiagnostic(s,l))}}}function D(t,n,i,r){if(_(t,n)){var s=t.type;return"list"===s&&e.isArray(n)?function(t,n,i,r){return e.filter(e.map(n,function(e){return D(t.element,e,i,r)}),function(e){return!!e})}(t,n,i,r):e.isString(s)?R(t,i,n):L(t,n,r)}r.push(e.createCompilerDiagnostic(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,t.name,g(t)))}function O(t,n,i){if(!b(i)){if("list"===t.type){var r=t;return r.element.isFilePath||!e.isString(r.element.type)?e.filter(e.map(i,function(e){return O(r.element,n,e)}),function(e){return!!e}):i}return e.isString(t.type)?R(t,n,i):t.type.get(e.isString(i)?i.toLowerCase():i)}}function R(t,n,i){return t.isFilePath&&""===(i=e.normalizePath(e.combinePaths(n,i)))&&(i="."),i}function L(e,t,n){if(!b(t)){var i=t.toLowerCase(),r=e.type.get(i);if(void 0!==r)return r;n.push(s(e))}}function P(e){return"function"==typeof e.trim?e.trim():e.replace(/^[\s]+|[\s]+$/g,"")}e.compileOnSaveCommandLineOption={name:"compileOnSave",type:"boolean"},e.optionDeclarations=[{name:"help",shortName:"h",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Print_this_message},{name:"help",shortName:"?",type:"boolean"},{name:"all",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Show_all_compiler_options},{name:"version",shortName:"v",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Print_the_compiler_s_version},{name:"init",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file},{name:"project",shortName:"p",type:"string",isFilePath:!0,showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,paramType:e.Diagnostics.FILE_OR_DIRECTORY,description:e.Diagnostics.Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json},{name:"pretty",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Stylize_errors_and_messages_using_color_and_context_experimental},{name:"watch",shortName:"w",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Watch_input_files},{name:"target",shortName:"t",type:e.createMapFromTemplate({es3:0,es5:1,es6:2,es2015:2,es2016:3,es2017:4,esnext:5}),paramType:e.Diagnostics.VERSION,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT},{name:"module",shortName:"m",type:e.createMapFromTemplate({none:e.ModuleKind.None,commonjs:e.ModuleKind.CommonJS,amd:e.ModuleKind.AMD,system:e.ModuleKind.System,umd:e.ModuleKind.UMD,es6:e.ModuleKind.ES2015,es2015:e.ModuleKind.ES2015,esnext:e.ModuleKind.ESNext}),paramType:e.Diagnostics.KIND,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext},{name:"lib",type:"list",element:{name:"lib",type:e.createMapFromTemplate({es5:"lib.es5.d.ts",es6:"lib.es2015.d.ts",es2015:"lib.es2015.d.ts",es7:"lib.es2016.d.ts",es2016:"lib.es2016.d.ts",es2017:"lib.es2017.d.ts",esnext:"lib.esnext.d.ts",dom:"lib.dom.d.ts","dom.iterable":"lib.dom.iterable.d.ts",webworker:"lib.webworker.d.ts",scripthost:"lib.scripthost.d.ts","es2015.core":"lib.es2015.core.d.ts","es2015.collection":"lib.es2015.collection.d.ts","es2015.generator":"lib.es2015.generator.d.ts","es2015.iterable":"lib.es2015.iterable.d.ts","es2015.promise":"lib.es2015.promise.d.ts","es2015.proxy":"lib.es2015.proxy.d.ts","es2015.reflect":"lib.es2015.reflect.d.ts","es2015.symbol":"lib.es2015.symbol.d.ts","es2015.symbol.wellknown":"lib.es2015.symbol.wellknown.d.ts","es2016.array.include":"lib.es2016.array.include.d.ts","es2017.object":"lib.es2017.object.d.ts","es2017.sharedmemory":"lib.es2017.sharedmemory.d.ts","es2017.string":"lib.es2017.string.d.ts","es2017.intl":"lib.es2017.intl.d.ts","esnext.asynciterable":"lib.esnext.asynciterable.d.ts"})},showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_library_files_to_be_included_in_the_compilation_Colon},{name:"allowJs",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Allow_javascript_files_to_be_compiled},{name:"checkJs",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Report_errors_in_js_files},{name:"jsx",type:e.createMapFromTemplate({preserve:1,"react-native":3,react:2}),paramType:e.Diagnostics.KIND,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_JSX_code_generation_Colon_preserve_react_native_or_react},{name:"declaration",shortName:"d",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Generates_corresponding_d_ts_file},{name:"sourceMap",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Generates_corresponding_map_file},{name:"outFile",type:"string",isFilePath:!0,paramType:e.Diagnostics.FILE,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Concatenate_and_emit_output_to_single_file},{name:"outDir",type:"string",isFilePath:!0,paramType:e.Diagnostics.DIRECTORY,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Redirect_output_structure_to_the_directory},{name:"rootDir",type:"string",isFilePath:!0,paramType:e.Diagnostics.LOCATION,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir},{name:"removeComments",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Do_not_emit_comments_to_output},{name:"noEmit",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Do_not_emit_outputs},{name:"importHelpers",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Import_emit_helpers_from_tslib},{name:"downlevelIteration",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3},{name:"isolatedModules",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule},{name:"strict",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Enable_all_strict_type_checking_options},{name:"noImplicitAny",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Raise_error_on_expressions_and_declarations_with_an_implied_any_type},{name:"strictNullChecks",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Enable_strict_null_checks},{name:"strictFunctionTypes",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Enable_strict_checking_of_function_types},{name:"noImplicitThis",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Raise_error_on_this_expressions_with_an_implied_any_type},{name:"alwaysStrict",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Parse_in_strict_mode_and_emit_use_strict_for_each_source_file},{name:"noUnusedLocals",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_errors_on_unused_locals},{name:"noUnusedParameters",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_errors_on_unused_parameters},{name:"noImplicitReturns",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_error_when_not_all_code_paths_in_function_return_a_value},{name:"noFallthroughCasesInSwitch",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_errors_for_fallthrough_cases_in_switch_statement},{name:"moduleResolution",type:e.createMapFromTemplate({node:e.ModuleResolutionKind.NodeJs,classic:e.ModuleResolutionKind.Classic}),paramType:e.Diagnostics.STRATEGY,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6},{name:"baseUrl",type:"string",isFilePath:!0,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Base_directory_to_resolve_non_absolute_module_names},{name:"paths",type:"object",isTSConfigOnly:!0,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl},{name:"rootDirs",type:"list",isTSConfigOnly:!0,element:{name:"rootDirs",type:"string",isFilePath:!0},category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime},{name:"typeRoots",type:"list",element:{name:"typeRoots",type:"string",isFilePath:!0},category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.List_of_folders_to_include_type_definitions_from},{name:"types",type:"list",element:{name:"types",type:"string"},showInSimplifiedHelpView:!0,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Type_declaration_files_to_be_included_in_compilation},{name:"allowSyntheticDefaultImports",type:"boolean",category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typechecking},{name:"preserveSymlinks",type:"boolean",category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Do_not_resolve_the_real_path_of_symlinks},{name:"sourceRoot",type:"string",isFilePath:!0,paramType:e.Diagnostics.LOCATION,category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations},{name:"mapRoot",type:"string",isFilePath:!0,paramType:e.Diagnostics.LOCATION,category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations},{name:"inlineSourceMap",type:"boolean",category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file},{name:"inlineSources",type:"boolean",category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap_to_be_set},{name:"experimentalDecorators",type:"boolean",category:e.Diagnostics.Experimental_Options,description:e.Diagnostics.Enables_experimental_support_for_ES7_decorators},{name:"emitDecoratorMetadata",type:"boolean",category:e.Diagnostics.Experimental_Options,description:e.Diagnostics.Enables_experimental_support_for_emitting_type_metadata_for_decorators},{name:"jsxFactory",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h},{name:"diagnostics",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Show_diagnostic_information},{name:"extendedDiagnostics",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Show_verbose_diagnostic_information},{name:"traceResolution",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Enable_tracing_of_the_name_resolution_process},{name:"listFiles",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Print_names_of_files_part_of_the_compilation},{name:"listEmittedFiles",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Print_names_of_generated_files_part_of_the_compilation},{name:"out",type:"string",isFilePath:!1,category:e.Diagnostics.Advanced_Options,paramType:e.Diagnostics.FILE,description:e.Diagnostics.Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file},{name:"reactNamespace",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react_JSX_emit},{name:"skipDefaultLibCheck",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files},{name:"charset",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.The_character_set_of_the_input_files},{name:"emitBOM",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files},{name:"locale",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.The_locale_used_when_displaying_messages_to_the_user_e_g_en_us},{name:"newLine",type:e.createMapFromTemplate({crlf:0,lf:1}),paramType:e.Diagnostics.NEWLINE,category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix},{name:"noErrorTruncation",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_truncate_error_messages},{name:"noLib",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_include_the_default_library_file_lib_d_ts},{name:"noResolve",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files},{name:"stripInternal",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_emit_declarations_for_code_that_has_an_internal_annotation},{name:"disableSizeLimit",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Disable_size_limitations_on_JavaScript_projects},{name:"noImplicitUseStrict",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_emit_use_strict_directives_in_module_output},{name:"noEmitHelpers",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_generate_custom_helper_functions_like_extends_in_compiled_output},{name:"noEmitOnError",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_emit_outputs_if_any_errors_were_reported},{name:"preserveConstEnums",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_erase_const_enum_declarations_in_generated_code},{name:"declarationDir",type:"string",isFilePath:!0,paramType:e.Diagnostics.DIRECTORY,category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Output_directory_for_generated_declaration_files},{name:"skipLibCheck",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Skip_type_checking_of_declaration_files},{name:"allowUnusedLabels",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_report_errors_on_unused_labels},{name:"allowUnreachableCode",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_report_errors_on_unreachable_code},{name:"suppressExcessPropertyErrors",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Suppress_excess_property_checks_for_object_literals},{name:"suppressImplicitAnyIndexErrors",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures},{name:"forceConsistentCasingInFileNames",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Disallow_inconsistently_cased_references_to_the_same_file},{name:"maxNodeModuleJsDepth",type:"number",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files},{name:"noStrictGenericChecks",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Disable_strict_checking_of_generic_signatures_in_function_types},{name:"plugins",type:"list",isTSConfigOnly:!0,element:{name:"plugin",type:"object"},description:e.Diagnostics.List_of_language_service_plugins}],e.typeAcquisitionDeclarations=[{name:"enableAutoDiscovery",type:"boolean"},{name:"enable",type:"boolean"},{name:"include",type:"list",element:{name:"include",type:"string"}},{name:"exclude",type:"list",element:{name:"exclude",type:"string"}}],e.defaultInitCompilerOptions={module:e.ModuleKind.CommonJS,target:1,strict:!0},e.convertEnableAutoDiscoveryToEnable=i,e.createCompilerDiagnosticForInvalidCustomType=s,e.parseCustomTypeOption=a,e.parseListTypeOption=l,e.parseCommandLine=function(t,n){var i={},r=[],s=[];return o(t),{options:i,fileNames:r,errors:s};function o(t){for(var n=0;n<t.length;){var o=t[n];if(n++,64===o.charCodeAt(0))u(o.slice(1));else if(45===o.charCodeAt(0)){var d=c(o.slice(45===o.charCodeAt(1)?2:1),!0);if(d)if(d.isTSConfigOnly)s.push(e.createCompilerDiagnostic(e.Diagnostics.Option_0_can_only_be_specified_in_tsconfig_json_file,d.name));else switch(t[n]||"boolean"===d.type||s.push(e.createCompilerDiagnostic(e.Diagnostics.Compiler_option_0_expects_an_argument,d.name)),d.type){case"number":i[d.name]=parseInt(t[n]),n++;break;case"boolean":var p=t[n];i[d.name]="false"!==p,"false"!==p&&"true"!==p||n++;break;case"string":i[d.name]=t[n]||"",n++;break;case"list":var h=l(d,t[n],s);i[d.name]=h||[],h&&n++;break;default:i[d.name]=a(d,t[n],s),n++}else s.push(e.createCompilerDiagnostic(e.Diagnostics.Unknown_compiler_option_0,o))}else r.push(o)}}function u(t){var i=n?n(t):e.sys.readFile(t);if(i){for(var r=[],a=0;;){for(;a<i.length&&i.charCodeAt(a)<=32;)a++;if(a>=i.length)break;var l=a;if(34===i.charCodeAt(l)){for(a++;a<i.length&&34!==i.charCodeAt(a);)a++;a<i.length?(r.push(i.substring(l+1,a)),a++):s.push(e.createCompilerDiagnostic(e.Diagnostics.Unterminated_quoted_string_in_response_file_0,t))}else{for(;i.charCodeAt(a)>32;)a++;r.push(i.substring(l,a))}}o(r)}else s.push(e.createCompilerDiagnostic(e.Diagnostics.File_0_not_found,t))}},e.readConfigFile=function(t,n){var i=p(t,n);return e.isString(i)?u(t,i):{config:{},error:i}},e.parseConfigFileTextToJson=u,e.readJsonConfigFile=d,e.convertToObject=f,e.generateTSConfig=function(t,n,i){var s=function(t){var n=e.createMap(),i=r().optionNameMap,s=function(r){if(e.hasProperty(t,r)){if(i.has(r)&&i.get(r).category===e.Diagnostics.Command_line_Options)return"continue";var s=t[r],l=i.get(r.toLowerCase());if(l){var c=o(l);c?"list"===l.type?n.set(r,s.map(function(e){return a(e,c)})):n.set(r,a(s,c)):n.set(r,s)}}};for(var l in t)s(l);return n}(e.extend(t,e.defaultInitCompilerOptions));return function(){for(var t=e.createMultiMap(),r=0,o=e.optionDeclarations;r<o.length;r++){var a=o[r],u=a.category;void 0!==u&&u!==e.Diagnostics.Command_line_Options&&u!==e.Diagnostics.Advanced_Options&&t.add(e.getLocaleSpecificMessage(u),a)}var d=0,p=0,h=[],f=[];t.forEach(function(t,n){0!==h.length&&(h.push(""),f.push("")),h.push("/* "+n+" */"),f.push("");for(var i=0,r=t;i<r.length;i++){var o=r[i],a=void 0;a=s.has(o.name)?'"'+o.name+'": '+JSON.stringify(s.get(o.name))+((p+=1)===s.size?"":","):'// "'+o.name+'": '+JSON.stringify(l(o))+",",h.push(a),f.push("/* "+(o.description&&e.getLocaleSpecificMessage(o.description)||o.name)+" */"),d=Math.max(a.length,d)}});var m=c(2),g=[];g.push("{"),g.push(m+'"compilerOptions": {');for(var _=0;_<h.length;_++){var y=h[_],b=f[_];g.push(y&&""+m+m+y+(b&&c(d-y.length+2)+b))}if(n.length){g.push(m+"},"),g.push(m+'"files": [');for(_=0;_<n.length;_++)g.push(""+m+m+JSON.stringify(n[_])+(_===n.length-1?"":","));g.push(m+"]")}else g.push(m+"}");return g.push("}"),g.join(i)}();function o(e){return"string"===e.type||"number"===e.type||"boolean"===e.type?void 0:"list"===e.type?o(e.element):e.type}function a(t,n){return e.forEachEntry(n,function(e,n){if(e===t)return n})}function l(e){switch(e.type){case"number":return 1;case"boolean":return!0;case"string":return e.isFilePath?"./":"";case"list":return[];case"object":return{};default:return e.type.keys().next().value}}function c(e){return Array(e+1).join(" ")}},e.parseJsonConfigFileContent=function(e,t,n,i,r,s,o){return T(e,void 0,t,n,i,r,s,o)},e.parseJsonSourceFileConfigFileContent=function(e,t,n,i,r,s,o){return T(void 0,e,t,n,i,r,s,o)},e.setConfigFileInOptions=y,e.isErrorNoInputFiles=function(t){return t.code===e.Diagnostics.No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2.code},e.getErrorForNoInputFiles=k,e.convertCompilerOptionsFromJson=function(e,t,n){var i=[];return{options:w(e,t,i,n),errors:i}},e.convertTypeAcquisitionFromJson=function(e,t,n){var i=[];return{options:A(e,t,i,n),errors:i}};var M=/(^|\/)\*\*\/?$/,F=/(^|\/)\*\*\/(.*\/)?\*\*($|\/)/,B=/(^|\/)\*\*\/(.*\/)?\.\.($|\/)/,$=/\/[^/]*?[*?][^/]*\//,U=/^[^*?]*(?=\/[^/]*[*?])/;function V(t,n,i,r,s){void 0===s&&(s=[]),n=e.normalizePath(n);var o=r.useCaseSensitiveFileNames?z:W,a=e.createMap(),l=e.createMap(),c=t.filesSpecs,u=t.validatedIncludeSpecs,d=t.validatedExcludeSpecs,p=t.wildcardDirectories,h=e.getSupportedExtensions(i,s);if(c)for(var f=0,m=c;f<m.length;f++){var g=m[f],_=e.getNormalizedAbsolutePath(g,n);a.set(o(_),_)}if(u&&u.length>0)for(var y=0,b=r.readDirectory(n,h,d,u,void 0);y<b.length;y++){if(!j(_=b[y],a,l,h,o)){K(_,l,h,o);var v=o(_);a.has(v)||l.has(v)||l.set(v,_)}}var T=e.arrayFrom(a.values()),k=e.arrayFrom(l.values());return{fileNames:T.concat(k),wildcardDirectories:p,spec:t}}function H(t,n,i,r,s){return t.filter(function(t){var o=function(t,n){if(!n&&M.test(t))return e.Diagnostics.File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0;if(F.test(t))return e.Diagnostics.File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0;if(B.test(t))return e.Diagnostics.File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0}(t,i);return void 0!==o&&n.push(function(t,n){if(r&&r.jsonObject)for(var i=0,o=e.getPropertyAssignment(r.jsonObject,s);i<o.length;i++){var a=o[i];if(e.isArrayLiteralExpression(a.initializer))for(var l=0,c=a.initializer.elements;l<c.length;l++){var u=c[l];if(e.isStringLiteral(u)&&u.text===n)return e.createDiagnosticForNodeInSourceFile(r,u,t,n)}}return e.createCompilerDiagnostic(t,n)}(o,t)),void 0===o})}function G(t,n){var i=U.exec(t);return i?{key:n?i[0]:i[0].toLowerCase(),flags:$.test(t)?1:0}:e.isImplicitGlob(t)?{key:t,flags:1}:void 0}function j(t,n,i,r,s){for(var o=e.getExtensionPriority(t,r),a=e.adjustExtensionPriority(o,r),l=0;l<a;l++){var c=r[l],u=s(e.changeExtension(t,c));if(n.has(u)||i.has(u))return!0}return!1}function K(t,n,i,r){for(var s=e.getExtensionPriority(t,i),o=e.getNextLowestExtensionPriority(s,i);o<i.length;o++){var a=i[o],l=r(e.changeExtension(t,a));n.delete(l)}}function z(e){return e}function W(e){return e.toLowerCase()}function q(t,n){switch(n.type){case"object":case"string":return"";case"number":return"number"==typeof t?t:"";case"boolean":return"boolean"==typeof t?t:"";case"list":var i=n.element;return e.isArray(t)?t.map(function(e){return q(e,i)}):"";default:return e.forEachEntry(n.type,function(e,n){if(e===t)return n})}}e.getFileNamesFromConfigSpecs=V,e.convertCompilerOptionsForTelemetry=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=c(n);void 0!==i&&(t[n]=q(e[n],i))}return t}}(ts||(ts={})),function(e){!function(e){var t=function(){function e(e){this.text=e}return e.prototype.getText=function(e,t){return 0===e&&t===this.text.length?this.text:this.text.substring(e,t)},e.prototype.getLength=function(){return this.text.length},e.prototype.getChangeRange=function(){},e}();e.fromString=function(e){return new t(e)}}(e.ScriptSnapshot||(e.ScriptSnapshot={}));var t=function(){};e.TextChange=t,function(e){e.none="none",e.definition="definition",e.reference="reference",e.writtenReference="writtenReference"}(e.HighlightSpanKind||(e.HighlightSpanKind={})),function(e){e[e.None=0]="None",e[e.Block=1]="Block",e[e.Smart=2]="Smart"}(e.IndentStyle||(e.IndentStyle={})),function(e){e[e.aliasName=0]="aliasName",e[e.className=1]="className",e[e.enumName=2]="enumName",e[e.fieldName=3]="fieldName",e[e.interfaceName=4]="interfaceName",e[e.keyword=5]="keyword",e[e.lineBreak=6]="lineBreak",e[e.numericLiteral=7]="numericLiteral",e[e.stringLiteral=8]="stringLiteral",e[e.localName=9]="localName",e[e.methodName=10]="methodName",e[e.moduleName=11]="moduleName",e[e.operator=12]="operator",e[e.parameterName=13]="parameterName",e[e.propertyName=14]="propertyName",e[e.punctuation=15]="punctuation",e[e.space=16]="space",e[e.text=17]="text",e[e.typeParameterName=18]="typeParameterName",e[e.enumMemberName=19]="enumMemberName",e[e.functionName=20]="functionName",e[e.regularExpressionLiteral=21]="regularExpressionLiteral"}(e.SymbolDisplayPartKind||(e.SymbolDisplayPartKind={})),function(e){e[e.JavaScript=0]="JavaScript",e[e.SourceMap=1]="SourceMap",e[e.Declaration=2]="Declaration"}(e.OutputFileType||(e.OutputFileType={})),function(e){e[e.None=0]="None",e[e.InMultiLineCommentTrivia=1]="InMultiLineCommentTrivia",e[e.InSingleQuoteStringLiteral=2]="InSingleQuoteStringLiteral",e[e.InDoubleQuoteStringLiteral=3]="InDoubleQuoteStringLiteral",e[e.InTemplateHeadOrNoSubstitutionTemplate=4]="InTemplateHeadOrNoSubstitutionTemplate",e[e.InTemplateMiddleOrTail=5]="InTemplateMiddleOrTail",e[e.InTemplateSubstitutionPosition=6]="InTemplateSubstitutionPosition"}(e.EndOfLineState||(e.EndOfLineState={})),function(e){e[e.Punctuation=0]="Punctuation",e[e.Keyword=1]="Keyword",e[e.Operator=2]="Operator",e[e.Comment=3]="Comment",e[e.Whitespace=4]="Whitespace",e[e.Identifier=5]="Identifier",e[e.NumberLiteral=6]="NumberLiteral",e[e.StringLiteral=7]="StringLiteral",e[e.RegExpLiteral=8]="RegExpLiteral"}(e.TokenClass||(e.TokenClass={})),function(e){e.unknown="",e.warning="warning",e.keyword="keyword",e.scriptElement="script",e.moduleElement="module",e.classElement="class",e.localClassElement="local class",e.interfaceElement="interface",e.typeElement="type",e.enumElement="enum",e.enumMemberElement="enum member",e.variableElement="var",e.localVariableElement="local var",e.functionElement="function",e.localFunctionElement="local function",e.memberFunctionElement="method",e.memberGetAccessorElement="getter",e.memberSetAccessorElement="setter",e.memberVariableElement="property",e.constructorImplementationElement="constructor",e.callSignatureElement="call",e.indexSignatureElement="index",e.constructSignatureElement="construct",e.parameterElement="parameter",e.typeParameterElement="type parameter",e.primitiveType="primitive type",e.label="label",e.alias="alias",e.constElement="const",e.letElement="let",e.directory="directory",e.externalModuleName="external module name",e.jsxAttribute="JSX attribute"}(e.ScriptElementKind||(e.ScriptElementKind={})),function(e){e.none="",e.publicMemberModifier="public",e.privateMemberModifier="private",e.protectedMemberModifier="protected",e.exportedModifier="export",e.ambientModifier="declare",e.staticModifier="static",e.abstractModifier="abstract"}(e.ScriptElementKindModifier||(e.ScriptElementKindModifier={})),function(e){e.comment="comment",e.identifier="identifier",e.keyword="keyword",e.numericLiteral="number",e.operator="operator",e.stringLiteral="string",e.whiteSpace="whitespace",e.text="text",e.punctuation="punctuation",e.className="class name",e.enumName="enum name",e.interfaceName="interface name",e.moduleName="module name",e.typeParameterName="type parameter name",e.typeAliasName="type alias name",e.parameterName="parameter name",e.docCommentTagName="doc comment tag name",e.jsxOpenTagName="jsx open tag name",e.jsxCloseTagName="jsx close tag name",e.jsxSelfClosingTagName="jsx self closing tag name",e.jsxAttribute="jsx attribute",e.jsxText="jsx text",e.jsxAttributeStringLiteralValue="jsx attribute string literal value"}(e.ClassificationTypeNames||(e.ClassificationTypeNames={})),function(e){e[e.comment=1]="comment",e[e.identifier=2]="identifier",e[e.keyword=3]="keyword",e[e.numericLiteral=4]="numericLiteral",e[e.operator=5]="operator",e[e.stringLiteral=6]="stringLiteral",e[e.regularExpressionLiteral=7]="regularExpressionLiteral",e[e.whiteSpace=8]="whiteSpace",e[e.text=9]="text",e[e.punctuation=10]="punctuation",e[e.className=11]="className",e[e.enumName=12]="enumName",e[e.interfaceName=13]="interfaceName",e[e.moduleName=14]="moduleName",e[e.typeParameterName=15]="typeParameterName",e[e.typeAliasName=16]="typeAliasName",e[e.parameterName=17]="parameterName",e[e.docCommentTagName=18]="docCommentTagName",e[e.jsxOpenTagName=19]="jsxOpenTagName",e[e.jsxCloseTagName=20]="jsxCloseTagName",e[e.jsxSelfClosingTagName=21]="jsxSelfClosingTagName",e[e.jsxAttribute=22]="jsxAttribute",e[e.jsxText=23]="jsxText",e[e.jsxAttributeStringLiteralValue=24]="jsxAttributeStringLiteralValue"}(e.ClassificationType||(e.ClassificationType={}))}(ts||(ts={})),function(e){function t(t){switch(t.kind){case 146:case 226:case 176:case 149:case 148:case 261:case 262:case 151:case 150:case 152:case 153:case 154:case 228:case 186:case 187:case 260:case 253:return 1;case 145:case 230:case 231:case 163:return 2;case 283:return void 0===t.name?3:2;case 264:case 229:return 3;case 233:return e.isAmbientModule(t)||1===e.getModuleInstanceState(t)?5:4;case 232:case 241:case 242:case 237:case 238:case 243:case 244:return 7;case 265:return 5}return 7}function n(t){for(;143===t.parent.kind;)t=t.parent;return e.isInternalModuleImportEqualsDeclaration(t.parent)&&t.parent.moduleReference===t}function i(e,t){var n=r(e);return n&&n.parent&&n.parent.kind===t&&n.parent.expression===n}function r(e){return o(e)?e.parent:e}function s(e){return 71===e.kind&&(218===e.parent.kind||217===e.parent.kind)&&e.parent.label===e}function o(e){return e&&e.parent&&179===e.parent.kind&&e.parent.name===e}e.scanner=e.createScanner(5,!0),function(e){e[e.None=0]="None",e[e.Value=1]="Value",e[e.Type=2]="Type",e[e.Namespace=4]="Namespace",e[e.All=7]="All"}(e.SemanticMeaning||(e.SemanticMeaning={})),e.getMeaningFromDeclaration=t,e.getMeaningFromLocation=function(i){return 265===i.kind?1:243===i.parent.kind?7:n(i)?function(t){if(e.Debug.assert(71===t.kind),143===t.parent.kind&&t.parent.right===t&&237===t.parent.parent.kind)return 7;return 4}(i):e.isDeclarationName(i)?t(i.parent):function(t){e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent);switch(t.kind){case 99:return!e.isPartOfExpression(t);case 169:return!0}switch(t.parent.kind){case 159:return!0;case 201:return!e.isExpressionWithTypeArgumentsInClassExtendsClause(t.parent)}return!1}(i)?2:function(e){return function(e){var t=e,n=!0;if(143===t.parent.kind){for(;t.parent&&143===t.parent.kind;)t=t.parent;n=t.right===e}return 159===t.parent.kind&&!n}(e)||function(e){var t=e,n=!0;if(179===t.parent.kind){for(;t.parent&&179===t.parent.kind;)t=t.parent;n=t.name===e}if(!n&&201===t.parent.kind&&259===t.parent.parent.kind){var i=t.parent.parent.parent;return 229===i.kind&&108===t.parent.parent.token||230===i.kind&&85===t.parent.parent.token}return!1}(e)}(i)?4:e.isTypeParameterDeclaration(i.parent)?(e.Debug.assert(e.isJSDocTemplateTag(i.parent.parent)),2):1},e.isInRightSideOfInternalImportEqualsDeclaration=n,e.isCallExpressionTarget=function(e){return i(e,181)},e.isNewExpressionTarget=function(e){return i(e,182)},e.climbPastPropertyAccess=r,e.getTargetLabel=function(e,t){for(;e;){if(222===e.kind&&e.label.escapedText===t)return e.label;e=e.parent}},e.isJumpStatementTarget=s,e.isLabelName=function(e){return function(e){return 71===e.kind&&222===e.parent.kind&&e.parent.label===e}(e)||s(e)},e.isRightSideOfQualifiedName=function(e){return 143===e.parent.kind&&e.parent.right===e},e.isRightSideOfPropertyAccess=o,e.isNameOfModuleDeclaration=function(e){return 233===e.parent.kind&&e.parent.name===e},e.isNameOfFunctionDeclaration=function(t){return 71===t.kind&&e.isFunctionLike(t.parent)&&t.parent.name===t},e.isLiteralNameOfPropertyDeclarationOrIndexAccess=function(t){switch(t.parent.kind){case 149:case 148:case 261:case 264:case 151:case 150:case 153:case 154:case 233:return e.getNameOfDeclaration(t.parent)===t;case 180:return t.parent.argumentExpression===t;case 144:return!0;case 173:return 171===t.parent.parent.kind}},e.isExpressionOfExternalModuleImportEqualsDeclaration=function(t){return e.isExternalModuleImportEqualsDeclaration(t.parent.parent)&&e.getExternalModuleImportEqualsDeclarationExpression(t.parent.parent)===t},e.getContainerNode=function(e){for(283===e.kind&&(e=e.parent.parent);;){if(!(e=e.parent))return;switch(e.kind){case 265:case 151:case 150:case 228:case 186:case 153:case 154:case 229:case 230:case 232:case 233:return e}}},e.getNodeKind=function t(n){switch(n.kind){case 265:return e.isExternalModule(n)?"module":"script";case 233:return"module";case 229:case 199:return"class";case 230:return"interface";case 231:return"type";case 232:return"enum";case 226:return o(n);case 176:return o(e.getRootDeclaration(n));case 187:case 228:case 186:return"function";case 153:return"getter";case 154:return"setter";case 151:case 150:return"method";case 149:case 148:return"property";case 157:return"index";case 156:return"construct";case 155:return"call";case 152:return"constructor";case 145:return"type parameter";case 264:return"enum member";case 146:return e.hasModifier(n,92)?"property":"parameter";case 237:case 242:case 239:case 246:case 240:return"alias";case 283:return"type";case 194:var i=e.getSpecialPropertyAssignmentKind(n),r=n.right;switch(i){case 0:return"";case 1:case 2:var s=t(r);return""===s?"const":s;case 3:return"method";case 4:return"property";case 5:return e.isFunctionExpression(r)?"method":"property";default:return e.assertTypeIsNever(i),""}default:return""}function o(t){return e.isConst(t)?"const":e.isLet(t)?"let":"var"}},e.isThis=function(t){switch(t.kind){case 99:return!0;case 71:return e.identifierIsThisKeyword(t)&&146===t.parent.kind;default:return!1}};var a=/^\/\/\/\s*</;function l(e,t,n){return e<=n.pos&&t>=n.end}function c(e,t,n,i){return Math.max(e,n)<Math.min(t,i)}function u(t,n){if(e.nodeIsMissing(t))return!1;switch(t.kind){case 229:case 230:case 232:case 178:case 174:case 163:case 207:case 234:case 235:case 241:case 245:return d(t,18,n);case 260:return u(t.block,n);case 182:if(!t.arguments)return!0;case 181:case 185:case 168:return d(t,20,n);case 160:case 161:return u(t.type,n);case 152:case 153:case 154:case 228:case 186:case 151:case 150:case 156:case 155:case 187:return t.body?u(t.body,n):t.type?u(t.type,n):p(t,20,n);case 233:return t.body&&u(t.body,n);case 211:return t.elseStatement?u(t.elseStatement,n):u(t.thenStatement,n);case 210:return u(t.expression,n)||p(t,25);case 177:case 175:case 180:case 144:case 165:return d(t,22,n);case 157:return t.type?u(t.type,n):p(t,22,n);case 257:case 258:return!1;case 214:case 215:case 216:case 213:return u(t.statement,n);case 212:return h(t,106,n)?d(t,20,n):u(t.statement,n);case 162:return u(t.exprName,n);case 189:case 188:case 190:case 197:case 198:return u(t.expression,n);case 183:return u(t.template,n);case 196:return u(e.lastOrUndefined(t.templateSpans),n);case 205:return e.nodeIsPresent(t.literal);case 244:case 238:return e.nodeIsPresent(t.moduleSpecifier);case 192:return u(t.operand,n);case 194:return u(t.right,n);case 195:return u(t.whenFalse,n);default:return!0}}function d(t,n,i){var r=t.getChildren(i);if(r.length){var s=e.lastOrUndefined(r);if(s.kind===n)return!0;if(25===s.kind&&1!==r.length)return r[r.length-2].kind===n}return!1}function p(e,t,n){return!!h(e,t,n)}function h(t,n,i){return e.forEach(t.getChildren(i),function(e){return e.kind===n&&e})}function f(t){var n=e.forEach(t.parent.getChildren(),function(n){if(e.isSyntaxList(n)&&n.pos<=t.pos&&n.end>=t.end)return n});return e.Debug.assert(!n||e.contains(n.getChildren(),t)),n}function m(e,t,n,i){return _(e,t,!1,i,!1,n)}function g(e,t,n,i){return _(e,t,!0,void 0,i,n)}function _(t,n,i,r,s,o){var a=t;e:for(;;){if(e.isToken(a))return a;for(var l=0,c=a.getChildren();l<c.length;l++){var u=c[l];if(o||!e.isJSDocNode(u)){if((i?u.getFullStart():u.getStart(t,o))>n)break;var d=u.getEnd();if(n<d||n===d&&(1===u.kind||s)){a=u;continue e}if(r&&d===n){var p=y(n,t,u);if(p&&r(p))return p}}}return a}}function y(t,n,i,r){var s=function s(l){if(e.isToken(l))return l;for(var c=l.getChildren(),u=0;u<c.length;u++){var d=c[u];if(t<d.end)return d.getStart(n,r)>=t||!T(d)||b(d)?(p=a(c,u))&&o(p):s(d)}if(e.Debug.assert(void 0!==i||265===l.kind||e.isJSDocCommentContainingNode(l)),c.length){var p;return(p=a(c,c.length))&&o(p)}}(i||n);return e.Debug.assert(!(s&&b(s))),s;function o(t){if(e.isToken(t))return t;var n=t.getChildren(),i=a(n,n.length);return i&&o(i)}function a(t,n){for(var i=n-1;i>=0;i--){if(b(t[i]))e.Debug.assert(i>0,"`JsxText` tokens should not be the first child of `JsxElement | JsxSelfClosingElement`");else if(T(t[i]))return t[i]}}}function b(t){return e.isJsxText(t)&&t.containsOnlyWhiteSpaces}function v(t,n,i,r){return!!e.formatting.getRangeOfEnclosingComment(t,n,!1,void 0,i,r)}function T(e){return 0!==e.getWidth()}function k(t){return 71===t||e.isKeyword(t)}e.getLineStartPositionForPosition=function(t,n){return e.getLineStarts(n)[n.getLineAndCharacterOfPosition(t).line]},e.rangeContainsRange=function(e,t){return l(e.pos,e.end,t)},e.startEndContainsRange=l,e.rangeContainsStartEnd=function(e,t,n){return e.pos<=t&&e.end>=n},e.rangeOverlapsWithStartEnd=function(e,t,n){return c(e.pos,e.end,t,n)},e.startEndOverlapsWithStartEnd=c,e.positionBelongsToNode=function(e,t,n){return t<e.end||!u(e,n)},e.isCompletedNode=u,e.findListItemInfo=function(t){var n=f(t);if(n){var i=n.getChildren();return{listItemIndex:e.indexOfNode(i,t),list:n}}},e.hasChildOfKind=p,e.findChildOfKind=h,e.findContainingList=f,e.getTouchingWord=function(e,t,n){return m(e,t,n,function(e){return k(e.kind)})},e.getTouchingPropertyName=function(e,t,n){return m(e,t,n,function(e){return 9===(t=e.kind)||8===t||k(t);var t})},e.getTouchingToken=m,e.getTokenAtPosition=g,e.findTokenOnLeftOfPosition=function(t,n){var i=g(t,n,!1);return e.isToken(i)&&n>i.getStart(t)&&n<i.getEnd()?i:y(n,t)},e.findNextToken=function(t,n){return function n(i){if(e.isToken(i)&&i.pos===t.end)return i;for(var r=i.getChildren(),s=0,o=r;s<o.length;s++){var a=o[s];if((a.pos<=t.pos&&a.end>t.end||a.pos===t.end)&&T(a))return n(a)}return}(n)},e.findPrecedingToken=y,e.isInString=function(t,n){var i=y(n,t);if(i&&e.isStringTextContainingNode(i)){var r=i.getStart(),s=i.getEnd();if(r<n&&n<s)return!0;if(n===s)return!!i.isUnterminated}return!1},e.isInsideJsxElementOrAttribute=function(e,t){var n=g(e,t,!1);return!!n&&(10===n.kind||(27===n.kind&&10===n.parent.kind||(27===n.kind&&256===n.parent.kind||(!(!n||18!==n.kind||256!==n.parent.kind)||27===n.kind&&252===n.parent.kind))))},e.isWhiteSpaceOnlyJsxText=b,e.isInTemplateString=function(t,n){var i=g(t,n,!1);return e.isTemplateLiteralKind(i.kind)&&n>i.getStart(t)},e.isInComment=v,e.hasDocComment=function(t,n){var i=g(t,n,!1),r=e.getLeadingCommentRanges(t.text,i.pos);return e.forEach(r,function(e){var n=t.text;return n.length>=e.pos+3&&"/"===n[e.pos]&&"*"===n[e.pos+1]&&"*"===n[e.pos+2]})},e.getNodeModifiers=function(t){var n=e.getCombinedModifierFlags(t),i=[];return 8&n&&i.push("private"),16&n&&i.push("protected"),4&n&&i.push("public"),32&n&&i.push("static"),128&n&&i.push("abstract"),1&n&&i.push("export"),e.isInAmbientContext(t)&&i.push("declare"),i.length>0?i.join(","):""},e.getTypeArgumentOrTypeParameterList=function(t){return 159===t.kind||181===t.kind?t.typeArguments:e.isFunctionLike(t)||229===t.kind||230===t.kind?t.typeParameters:void 0},e.isWord=k,e.isComment=function(e){return 2===e||3===e},e.isStringOrRegularExpressionOrTemplateLiteral=function(t){return!(9!==t&&12!==t&&!e.isTemplateLiteralKind(t))},e.isPunctuation=function(e){return 17<=e&&e<=70},e.isInsideTemplateLiteral=function(t,n){return e.isTemplateLiteralKind(t.kind)&&t.getStart()<n&&n<t.getEnd()||!!t.isUnterminated&&n===t.getEnd()},e.isAccessibilityModifier=function(e){switch(e){case 114:case 112:case 113:return!0}return!1},e.cloneCompilerOptions=function(t){var n=e.clone(t);return e.setConfigFileInOptions(n,t&&t.configFile),n},e.isArrayLiteralOrObjectLiteralDestructuringPattern=function e(t){if(177===t.kind||178===t.kind){if(194===t.parent.kind&&t.parent.left===t&&58===t.parent.operatorToken.kind)return!0;if(216===t.parent.kind&&t.parent.initializer===t)return!0;if(e(261===t.parent.kind?t.parent.parent:t.parent))return!0}return!1},e.hasTrailingDirectorySeparator=function(e){var t=e.charAt(e.length-1);return"/"===t||"\\"===t},e.isInReferenceComment=function(e,t){return v(e,t,void 0,function(t){var n=e.text.substring(t.pos,t.end);return a.test(n)})},e.isInNonReferenceComment=function(e,t){return v(e,t,void 0,function(t){var n=e.text.substring(t.pos,t.end);return!a.test(n)})},e.createTextSpanFromNode=function(t,n){return e.createTextSpanFromBounds(t.getStart(n),t.getEnd())},e.createTextSpanFromRange=function(t){return e.createTextSpanFromBounds(t.pos,t.end)},e.isTypeKeyword=function(e){switch(e){case 119:case 122:case 130:case 133:case 134:case 136:case 137:case 105:return!0;default:return!1}},e.isExternalModuleSymbol=function(t){return e.Debug.assert(!!(1536&t.flags)),34===t.name.charCodeAt(0)},e.nodeSeenTracker=function(){var t=[];return function(n){var i=e.getNodeId(n);return!t[i]&&(t[i]=!0)}}}(ts||(ts={})),function(e){function t(e){return e.declarations&&e.declarations.length>0&&146===e.declarations[0].kind}e.isFirstDeclarationOfSymbolParameter=t;var n=function(){var t,n,s;return c(),{displayParts:function(){return t},writeKeyword:function(t){return l(t,e.SymbolDisplayPartKind.keyword)},writeOperator:function(t){return l(t,e.SymbolDisplayPartKind.operator)},writePunctuation:function(t){return l(t,e.SymbolDisplayPartKind.punctuation)},writeSpace:function(t){return l(t,e.SymbolDisplayPartKind.space)},writeStringLiteral:function(t){return l(t,e.SymbolDisplayPartKind.stringLiteral)},writeParameter:function(t){return l(t,e.SymbolDisplayPartKind.parameterName)},writeProperty:function(t){return l(t,e.SymbolDisplayPartKind.propertyName)},writeSymbol:function(e,n){o(),t.push(i(e,n))},writeLine:function(){t.push(a()),n=!0},increaseIndent:function(){s++},decreaseIndent:function(){s--},clear:c,trackSymbol:e.noop,reportInaccessibleThisError:e.noop,reportPrivateInBaseOfClassExpression:e.noop};function o(){if(n){var i=e.getIndentString(s);i&&t.push(r(i,e.SymbolDisplayPartKind.space)),n=!1}}function l(e,n){o(),t.push(r(e,n))}function c(){t=[],n=!0,s=0}}();function i(n,i){return r(n,function(n){var i=n.flags;if(3&i)return t(n)?e.SymbolDisplayPartKind.parameterName:e.SymbolDisplayPartKind.localName;if(4&i)return e.SymbolDisplayPartKind.propertyName;if(32768&i)return e.SymbolDisplayPartKind.propertyName;if(65536&i)return e.SymbolDisplayPartKind.propertyName;if(8&i)return e.SymbolDisplayPartKind.enumMemberName;if(16&i)return e.SymbolDisplayPartKind.functionName;if(32&i)return e.SymbolDisplayPartKind.className;if(64&i)return e.SymbolDisplayPartKind.interfaceName;if(384&i)return e.SymbolDisplayPartKind.enumName;if(1536&i)return e.SymbolDisplayPartKind.moduleName;if(8192&i)return e.SymbolDisplayPartKind.methodName;if(262144&i)return e.SymbolDisplayPartKind.typeParameterName;if(524288&i)return e.SymbolDisplayPartKind.aliasName;if(2097152&i)return e.SymbolDisplayPartKind.aliasName;return e.SymbolDisplayPartKind.text}(i))}function r(t,n){return{text:t,kind:e.SymbolDisplayPartKind[n]}}function s(t){return r(e.tokenToString(t),e.SymbolDisplayPartKind.keyword)}function o(t){return r(t,e.SymbolDisplayPartKind.text)}e.symbolPart=i,e.displayPart=r,e.spacePart=function(){return r(" ",e.SymbolDisplayPartKind.space)},e.keywordPart=s,e.punctuationPart=function(t){return r(e.tokenToString(t),e.SymbolDisplayPartKind.punctuation)},e.operatorPart=function(t){return r(e.tokenToString(t),e.SymbolDisplayPartKind.operator)},e.textOrKeywordPart=function(t){var n=e.stringToToken(t);return void 0===n?o(t):s(n)},e.textPart=o;function a(){return r("\n",e.SymbolDisplayPartKind.lineBreak)}function l(e){try{return e(n),n.displayParts()}finally{n.clear()}}function c(e){return e.parent&&(242===e.parent.kind||246===e.parent.kind)&&e.parent.propertyName===e}function u(t,n){return e.ensureScriptKind(t,n&&n.getScriptKind&&n.getScriptKind(t))}e.getNewLineOrDefaultFromHost=function(e){return e.getNewLine?e.getNewLine():"\r\n"},e.lineBreakPart=a,e.mapToDisplayParts=l,e.typeToDisplayParts=function(e,t,n,i){return l(function(r){e.getSymbolDisplayBuilder().buildTypeDisplay(t,r,n,i)})},e.symbolToDisplayParts=function(e,t,n,i,r){return l(function(s){e.getSymbolDisplayBuilder().buildSymbolDisplay(t,s,n,i,r)})},e.signatureToDisplayParts=function(e,t,n,i){return i|=65536,l(function(r){e.getSymbolDisplayBuilder().buildSignatureDisplay(t,r,n,i)})},e.getDeclaredName=function(t,n,i){if(c(i)||e.isStringOrNumericLiteral(i)&&144===i.parent.kind)return e.getTextOfIdentifierOrLiteral(i);var r=e.getLocalSymbolForExportDefault(n);return t.symbolToString(r||n)},e.isImportOrExportSpecifierName=c,e.stripQuotes=function(t){var n=t.length;return n>=2&&t.charCodeAt(0)===t.charCodeAt(n-1)&&e.isSingleOrDoubleQuote(t.charCodeAt(0))?t.substring(1,n-1):t},e.scriptKindIs=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var s=u(t,n);return e.forEach(i,function(e){return e===s})},e.getScriptKind=u,e.getUniqueSymbolId=function(t,n){return e.getSymbolId(e.skipAlias(t,n))},e.getFirstNonSpaceCharacterPosition=function(t,n){for(;e.isWhiteSpaceLike(t.charCodeAt(n));)n+=1;return n},e.getOpenBrace=function(e,t){return e.body.getFirstToken(t)},e.getOpenBraceOfClassLike=function(t,n){return e.getTokenAtPosition(n,t.members.pos-1,!1)},e.getSourceFileImportLocation=function(t){var n=t.text,i=e.getLeadingCommentRanges(n,0);if(!i)return 0;var r=0;i.length&&3===i[0].kind&&e.isPinnedComment(n,i[0])&&(r=i[0].end+1,i=i.slice(1));for(var s=0,o=i;s<o.length;s++){var a=o[s];if(2!==a.kind||!e.isRecognizedTripleSlashComment(t.text,a.pos,a.end))break;r=a.end+1}return r},e.getSynthesizedDeepClone=function t(n){if(void 0!==n){var i=e.visitEachChild(n,t,e.nullTransformationContext);if(i===n){var r=e.getSynthesizedClone(n);return e.isStringLiteral(r)?r.textSourceNode=n:e.isNumericLiteral(r)&&(r.numericLiteralFlags=n.numericLiteralFlags),r.pos=n.pos,r.end=n.end,r}return i.parent=void 0,i}},e.suppressLeadingAndTrailingTrivia=function(t){e.Debug.assert(void 0!==t),function t(n){e.addEmitFlags(n,512);var i=e.forEachChild(n,function(e){return e});i&&t(i)}(t),function t(n){e.addEmitFlags(n,1024);var i=void 0;e.forEachChild(n,function(e){i=e},function(t){t.length&&(i=e.last(t))}),i&&t(i)}(t)}}(ts||(ts={})),function(e){function t(e,t){switch(t){case 233:case 229:case 230:case 228:e.throwIfCancellationRequested()}}function n(n,i,r,s,o){var a=[];return function r(l){if(l&&e.textSpanIntersectsWith(o,l.getFullStart(),l.getFullWidth())){var c=l.kind;if(t(i,c),71===c&&!e.nodeIsMissing(l)){var u=l;if(s.has(u.escapedText)){var d=n.getSymbolAtLocation(l);if(d){var p=function(t,n){var i=t.getFlags();if(!(788448&i))return;if(32&i)return 11;if(384&i)return 12;if(524288&i)return 16;if(2&n){if(64&i)return 13;if(262144&i)return 15}else if(1536&i&&(4&n||1&n&&r(t)))return 14;return;function r(t){return e.forEach(t.declarations,function(t){return 233===t.kind&&1===e.getModuleInstanceState(t)})}}(d,e.getMeaningFromLocation(l));p&&function(e,t,n){a.push(e),a.push(t),a.push(n)}(l.getStart(),l.getWidth(),p)}}}e.forEachChild(l,r)}}(r),{spans:a,endOfLineState:0}}function i(e){switch(e){case 1:return"comment";case 2:return"identifier";case 3:return"keyword";case 4:return"number";case 5:return"operator";case 6:return"string";case 8:return"whitespace";case 9:return"text";case 10:return"punctuation";case 11:return"class name";case 12:return"enum name";case 13:return"interface name";case 14:return"module name";case 15:return"type parameter name";case 16:return"type alias name";case 17:return"parameter name";case 18:return"doc comment tag name";case 19:return"jsx open tag name";case 20:return"jsx close tag name";case 21:return"jsx self closing tag name";case 22:return"jsx attribute";case 23:return"jsx text";case 24:return"jsx attribute string literal value"}}function r(t){e.Debug.assert(t.spans.length%3==0);for(var n=t.spans,r=[],s=0;s<n.length;s+=3)r.push({textSpan:e.createTextSpan(n[s],n[s+1]),classificationType:i(n[s+2])});return r}function s(n,i,r){var s=r.start,o=r.length,a=e.createScanner(5,!1,i.languageVariant,i.text),l=e.createScanner(5,!1,i.languageVariant,i.text),c=[];return y(i),{spans:c,endOfLineState:0};function u(e,t,n){c.push(e),c.push(t),c.push(n)}function d(t,n,r,s){if(3===n){var o=e.parseIsolatedJSDocComment(i.text,r,s);if(o&&o.jsDoc)return o.jsDoc.parent=t,void function(e){var t=e.pos;if(e.tags)for(var n=0,i=e.tags;n<i.length;n++){var r=i[n];switch(r.pos!==t&&p(t,r.pos-t),u(r.atToken.pos,r.atToken.end-r.atToken.pos,10),u(r.tagName.pos,r.tagName.end-r.tagName.pos,18),t=r.tagName.end,r.kind){case 279:s(r);break;case 282:h(r);break;case 281:case 280:y(r.typeExpression)}t=r.end}t!==e.end&&p(t,e.end-t);return;function s(e){e.isNameFirst&&(p(t,e.name.pos-t),u(e.name.pos,e.name.end-e.name.pos,17),t=e.name.end),e.typeExpression&&(p(t,e.typeExpression.pos-t),y(e.typeExpression),t=e.typeExpression.end),e.isNameFirst||(p(t,e.name.pos-t),u(e.name.pos,e.name.end-e.name.pos,17),t=e.name.end)}}(o.jsDoc)}p(r,s)}function p(e,t){u(e,t,1)}function h(e){for(var t=0,n=e.getChildren();t<n.length;t++){y(n[t])}}function f(t,n,i){var r;for(r=n;r<i&&!e.isLineBreak(t.charCodeAt(r));r++);for(u(n,r-n,1),l.setTextPos(r);l.getTextPos()<i;)m()}function m(){var e=l.getTextPos(),t=l.scan(),n=l.getTextPos(),i=_(t);i&&u(e,n-e,i)}function g(t){if(e.isJSDoc(t))return!0;if(e.nodeIsMissing(t))return!0;var n=function(e){switch(e.parent&&e.parent.kind){case 251:if(e.parent.tagName===e)return 19;break;case 252:if(e.parent.tagName===e)return 20;break;case 250:if(e.parent.tagName===e)return 21;break;case 253:if(e.parent.name===e)return 22}return}(t);if(!e.isToken(t)&&10!==t.kind&&void 0===n)return!1;var r=10===t.kind?t.pos:function(t){for(a.setTextPos(t.pos);;){var n=a.getTextPos();if(!e.couldStartTrivia(i.text,n))return n;var r=a.scan(),s=a.getTextPos(),o=s-n;if(!e.isTrivia(r))return n;if(4!==r&&5!==r)if(e.isComment(r))d(t,r,n,o),a.setTextPos(s);else if(7===r){var l=i.text,c=l.charCodeAt(n);if(60===c||62===c){u(n,o,1);continue}e.Debug.assert(124===c||61===c),f(l,n,s)}}}(t),s=t.end-r;if(e.Debug.assert(s>=0),s>0){var o=n||_(t.kind,t);o&&u(r,s,o)}return!0}function _(t,n){if(e.isKeyword(t))return 3;if((27===t||29===t)&&n&&e.getTypeArgumentOrTypeParameterList(n.parent))return 10;if(e.isPunctuation(t)){if(n){if(58===t&&(226===n.parent.kind||149===n.parent.kind||146===n.parent.kind||253===n.parent.kind))return 5;if(194===n.parent.kind||192===n.parent.kind||193===n.parent.kind||195===n.parent.kind)return 5}return 10}if(8===t)return 4;if(9===t)return 253===n.parent.kind?24:6;if(12===t)return 6;if(e.isTemplateLiteralKind(t))return 6;if(10===t)return 23;if(71===t){if(n)switch(n.parent.kind){case 229:return n.parent.name===n?11:void 0;case 145:return n.parent.name===n?15:void 0;case 230:return n.parent.name===n?13:void 0;case 232:return n.parent.name===n?12:void 0;case 233:return n.parent.name===n?14:void 0;case 146:return n.parent.name===n?e.isThisIdentifier(n)?3:17:void 0}return 2}}function y(r){if(r&&e.decodedTextSpanIntersectsWith(s,o,r.pos,r.getFullWidth())){t(n,r.kind);for(var a=0,l=r.getChildren(i);a<l.length;a++){var c=l[a];g(c)||y(c)}}}}e.createClassifier=function(){var t=e.createScanner(5,!1),n=[];n[71]=!0,n[9]=!0,n[8]=!0,n[12]=!0,n[99]=!0,n[43]=!0,n[44]=!0,n[20]=!0,n[22]=!0,n[18]=!0,n[101]=!0,n[86]=!0;var i=[];function r(t,n){return!e.isAccessibilityModifier(t)||(125===n||135===n||123===n||115===n)}function s(t){switch(t){case 1:return e.TokenClass.Comment;case 3:return e.TokenClass.Keyword;case 4:return e.TokenClass.NumberLiteral;case 5:return e.TokenClass.Operator;case 6:return e.TokenClass.StringLiteral;case 8:return e.TokenClass.Whitespace;case 10:return e.TokenClass.Punctuation;default:return e.TokenClass.Identifier}}function o(s,o,l){for(var c=0,u=0,d=0;i.length>0;)i.pop();switch(o){case 3:s='"\\\n'+s,c=3;break;case 2:s="'\\\n"+s,c=3;break;case 1:s="/*\n"+s,c=3;break;case 4:s="`\n"+s,c=2;break;case 5:s="}\n"+s,c=2;case 6:i.push(14)}t.setText(s);var p={endOfLineState:0,spans:[]},h=0;do{if(u=t.scan(),!e.isTrivia(u)){if(41!==u&&63!==u||n[d]){if(23===d&&a(u))u=71;else if(a(d)&&a(u)&&!r(d,u))u=71;else if(71===d&&27===u)h++;else if(29===u&&h>0)h--;else if(119===u||136===u||133===u||122===u||137===u)h>0&&!l&&(u=71);else if(14===u)i.push(u);else if(17===u)i.length>0&&i.push(u);else if(18===u&&i.length>0){var f=e.lastOrUndefined(i);14===f?16===(u=t.reScanTemplateToken())?i.pop():e.Debug.assertEqual(u,15,"Should have been a template middle."):(e.Debug.assertEqual(f,17,"Should have been an open brace"),i.pop())}}else 12===t.reScanSlashToken()&&(u=12);d=u}m()}while(1!==u);return p;function m(){var n=t.getTokenPos(),r=t.getTextPos();if(function(e,t,n){if(8===n)return;0===e&&c>0&&(e+=c);e-=c,t-=c;var i=t-e;i>0&&(p.spans.push(e),p.spans.push(i),p.spans.push(n))}(n,r,function(t){if(a(t))return 3;if(function(e){switch(e){case 39:case 41:case 42:case 37:case 38:case 45:case 46:case 47:case 27:case 29:case 30:case 31:case 93:case 92:case 118:case 32:case 33:case 34:case 35:case 48:case 50:case 49:case 53:case 54:case 69:case 68:case 70:case 65:case 66:case 67:case 59:case 60:case 61:case 63:case 64:case 58:case 26:return!0;default:return!1}}(t)||function(e){switch(e){case 37:case 38:case 52:case 51:case 43:case 44:return!0;default:return!1}}(t))return 5;if(t>=17&&t<=70)return 10;switch(t){case 8:return 4;case 9:return 6;case 12:return 7;case 7:case 3:case 2:return 1;case 5:case 4:return 8;default:return e.isTemplateLiteralKind(t)?6:2}}(u)),r>=s.length)if(9===u){var o=t.getTokenText();if(t.isUnterminated()){for(var l=o.length-1,d=0;92===o.charCodeAt(l-d);)d++;if(1&d){var h=o.charCodeAt(0);p.endOfLineState=34===h?3:2}}}else 3===u?t.isUnterminated()&&(p.endOfLineState=1):e.isTemplateLiteralKind(u)?t.isUnterminated()&&(16===u?p.endOfLineState=5:13===u?p.endOfLineState=4:e.Debug.fail("Only 'NoSubstitutionTemplateLiteral's and 'TemplateTail's can be unterminated; got SyntaxKind #"+u)):i.length>0&&14===e.lastOrUndefined(i)&&(p.endOfLineState=6)}}function a(e){return e>=72&&e<=142}return{getClassificationsForLine:function(t,n,i){return function(t,n){for(var i=[],r=t.spans,o=0,a=0;a<r.length;a+=3){var l=r[a],c=r[a+1],u=r[a+2];if(o>=0){var d=l-o;d>0&&i.push({length:d,classification:e.TokenClass.Whitespace})}i.push({length:c,classification:s(u)}),o=l+c}var p=n.length-o;return p>0&&i.push({length:p,classification:e.TokenClass.Whitespace}),{entries:i,finalLexState:t.endOfLineState}}(o(t,n,i),t)},getEncodedLexicalClassifications:o}},e.getSemanticClassifications=function(e,t,i,s,o){return r(n(e,t,i,s,o))},e.getEncodedSemanticClassifications=n,e.getSyntacticClassifications=function(e,t,n){return r(s(e,t,n))},e.getEncodedSyntacticClassifications=s}(ts||(ts={})),function(e){!function(t){!function(t){function n(t,n,i,r,s,o,l,u){void 0===u&&(u=[]),void 0===t&&(t=""),t=e.normalizeSlashes(t),""===(t=e.getDirectoryPath(t))&&(t="."+e.directorySeparator),t=e.ensureTrailingDirectorySeparator(t);var d=c(e.isRootedDiskPath(t)?t:e.combinePaths(n,t)),f=e.getDirectoryPath(d),g=!(o.useCaseSensitiveFileNames&&o.useCaseSensitiveFileNames());if(m(o,f)){var _=h(o,f,i,void 0,["./*"]);if(_){for(var y=e.createMap(),b=0,v=_;b<v.length;b++){var T=v[b];if(T=e.normalizePath(T),!l||0!==e.comparePaths(T,l,n,g)){var k=r?e.getBaseFileName(T):e.removeFileExtension(e.getBaseFileName(T));y.get(k)||y.set(k,!0)}}e.forEachKey(y,function(e){u.push(a(e,"script",s))})}var x=p(o,f);if(x)for(var E=0,S=x;E<S.length;E++){var C=S[E],w=e.getBaseFileName(e.normalizePath(C));u.push(a(w,"directory",s))}}return u}function i(t,n,i,r,s){if(s.readDirectory){var o=e.hasZeroOrOneAsteriskCharacter(i)?e.tryParsePattern(i):void 0;if(o){var a=c(o.prefix),l=e.getDirectoryPath(a),u=e.getBaseFileName(a),d=e.stringContains(t,e.directorySeparator),p=d?e.combinePaths(l,u+e.getDirectoryPath(t)):l,f=e.normalizePath(o.suffix),m=e.combinePaths(n,p),g=d?m:e.ensureTrailingDirectorySeparator(m)+u,_=h(s,m,r,void 0,[f?"**/*":"./*"]);if(_){for(var y=[],b=0,v=_;b<v.length;b++){var T=v[b],k=e.normalizePath(T);if(e.endsWith(k,f)&&e.startsWith(k,g)){var x=g.length,E=k.length-x-f.length;y.push(e.removeFileExtension(k.substr(x,E)))}}return y}}}}function r(t,n,i,r,l){if(void 0===l&&(l=[]),n.types)for(var c=0,u=n.types;c<u.length;c++){var d=u[c];l.push(a(d,"external module name",r))}else if(t.getDirectories){var p=void 0;try{p=e.getEffectiveTypeRoots(n,t)}catch(e){}if(p)for(var h=0,f=p;h<f.length;h++){s(t,f[h],r,l)}}if(t.getDirectories)for(var m=0,g=o(i,t);m<g.length;m++){var _=g[m];s(t,e.combinePaths(e.getDirectoryPath(_),"node_modules/@types"),r,l)}return l}function s(t,n,i,r){if(t.getDirectories&&m(t,n)){var s=p(t,n);if(s)for(var o=0,l=s;o<l.length;o++){var c=l[o];c=e.normalizePath(c),r.push(a(e.getBaseFileName(c),"external module name",i))}}}function o(t,n){for(var i,r=[];i=e.findConfigFile(t,function(e){return f(n,e)},"package.json");){r.push(i),t=e.getDirectoryPath(i);var s=e.getDirectoryPath(t);if(t===s)break;t=s}return r}function a(e,t,n){return{name:e,kind:t,kindModifiers:"",sortText:e,replacementSpan:n}}function l(t,n){var i=t.lastIndexOf(e.directorySeparator),r=-1!==i?i+1:0;return{start:n+r,length:t.length-r}}function c(t){return e.hasTrailingDirectorySeparator(t)?e.ensureTrailingDirectorySeparator(e.normalizePath(t)):e.normalizePath(t)}t.getStringLiteralCompletionEntriesFromModuleNames=function(t,s,c,u){var p,f=e.normalizeSlashes(t.text),m=t.getSourceFile().path,_=e.getDirectoryPath(m),y=l(t.text,t.getStart()+1);if(function(e){if(e&&e.length>=2&&46===e.charCodeAt(0)){var t=e.length>=3&&46===e.charCodeAt(1)?2:1,n=e.charCodeAt(t);return 47===n||92===n}return!1}(f)||e.isRootedDiskPath(f)){var b=e.getSupportedExtensions(s);p=s.rootDirs?function(t,i,r,s,o,a,l,c,u){for(var d=l.project||c.getCurrentDirectory(),p=!(c.useCaseSensitiveFileNames&&c.useCaseSensitiveFileNames()),h=function(t,n,i,r){t=e.map(t,function(t){return e.normalizePath(e.isRootedDiskPath(t)?t:e.combinePaths(n,t))});var s=e.forEach(t,function(t){return e.containsPath(t,i,n,r)?i.substr(t.length):void 0});return e.deduplicate(e.map(t,function(t){return e.combinePaths(t,s)}))}(t,d,r,p),f=[],m=0,g=h;m<g.length;m++){n(i,g[m],s,o,a,c,u,f)}return f}(s.rootDirs,f,_,b,!1,y,s,c,m):n(f,_,b,!1,y,c,m)}else p=function(t,s,l,c,u,p){var f,m=c.baseUrl,_=c.paths;if(m){var y=e.getSupportedExtensions(c),b=c.project||u.getCurrentDirectory(),v=e.isRootedDiskPath(m)?m:e.combinePaths(b,m);if(f=n(t,e.normalizePath(v),y,!1,l,u),_)for(var T in _)if(_.hasOwnProperty(T))if("*"===T){if(_[T])for(var k=0,x=_[T];k<x.length;k++)for(var E=0,S=i(t,m,x[k],y,u);E<S.length;E++){var C=S[E];f.push(a(C,"external module name",l))}}else if(e.startsWith(T,t)){_[T]&&1===_[T].length&&_[T][0]&&f.push(a(T,"external module name",l))}}else f=[];r(u,c,s,l,f);for(var w=0,I=function(t,n,i,r,s){var a=e.stringContains(t,e.directorySeparator),l=a?t.substr(0,t.lastIndexOf(e.directorySeparator)):void 0,c=e.map(r.getAmbientModules(),function(t){return e.stripQuotes(t.name)}),u=e.filter(c,function(n){return e.startsWith(n,t)});if(a){var p=e.ensureTrailingDirectorySeparator(l);u=e.map(u,function(t){return e.removePrefix(t,p)})}if(!i.moduleResolution||i.moduleResolution===e.ModuleResolutionKind.NodeJs)for(var f=0,m=function(t,n){var i=[];if(t.readFile&&t.fileExists)for(var r=0,s=o(n,t);r<s.length;r++){var a=s[r],l=b(a);if(!l)return;for(var c=e.combinePaths(e.getDirectoryPath(a),"node_modules"),u=[],p=0,h=d;p<h.length;p++){v(l[h[p]],u)}for(var f=0,m=u;f<m.length;f++){var _=m[f],y=e.combinePaths(c,_);i.push({moduleName:_,moduleDir:y})}}return i;function b(e){try{var n=function(e,t){return g(e,e.readFile,t)}(t,e);return n?JSON.parse(n):void 0}catch(e){return}}function v(t,n){if(t)for(var i in t)t.hasOwnProperty(i)&&!e.startsWith(i,"@types/")&&n.push(i)}}(s,n);f<m.length;f++){var _=m[f];if(a){if(e.startsWith(_.moduleName,l)){var y=h(s,_.moduleDir,e.supportedTypeScriptExtensions,void 0,["./*"]);if(y)for(var b=0,v=y;b<v.length;b++){var T=v[b];T=e.normalizePath(T);var k=e.removeFileExtension(e.getBaseFileName(T));u.push(k)}}}else u.push(_.moduleName)}return e.deduplicate(u)}(t,s,c,p,u);w<I.length;w++){var A=I[w];f.push(a(A,"external module name",l))}return f}(f,_,y,s,c,u);return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:p}},t.getTripleSlashReferenceCompletion=function(t,i,s,o){var a=e.getTokenAtPosition(t,i,!1);if(a){var c=e.getLeadingCommentRanges(t.text,a.pos);if(c&&c.length){var d=e.forEach(c,function(e){return i>=e.pos&&i<=e.end&&e});if(d){var p={isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:[]},h=t.text.substr(d.pos,i-d.pos),f=u.exec(h);if(f){var m=f[1],g=f[2],_=f[3],y=e.getDirectoryPath(t.path);if("path"===g){var b=l(_,d.pos+m.length);p.entries=n(_,y,e.getSupportedExtensions(s),!0,b,o,t.path)}else{var v={start:d.pos+m.length,length:f[0].length-m.length};p.entries=r(o,s,y,v)}}return p}}}};var u=/^(\/\/\/\s*<reference\s+(path|types)\s*=\s*(?:'|"))([^\3"]*)$/,d=["dependencies","devDependencies","peerDependencies","optionalDependencies"];function p(e,t){return g(e,e.getDirectories,t)}function h(e,t,n,i,r){return g(e,e.readDirectory,t,n,i,r)}function f(e,t){return g(e,e.fileExists,t)}function m(t,n){try{return e.directoryProbablyExists(n,t)}catch(e){}}function g(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];try{return t&&t.apply(e,n)}catch(e){}}}(t.PathCompletions||(t.PathCompletions={}))}(e.Completions||(e.Completions={}))}(ts||(ts={})),function(e){!function(t){var n;function i(t,n,i,s,o,a,l){var c=u(t,o,i,a);if(c)return{name:c,kind:e.SymbolDisplay.getSymbolKind(s,t,n),kindModifiers:e.SymbolDisplay.getSymbolModifiers(t),sortText:"0",source:r(l),hasAction:void 0!==l||void 0}}function r(t){return t&&e.stripQuotes(t.moduleSymbol.name)}function s(t,n,r,s,o,a,l,c,u){var d=e.timestamp(),p=e.createMap();if(t)for(var h=0,f=t;h<f.length;h++){var m=f[h],g=u?u[e.getSymbolId(m)]:void 0,_=i(m,r,s,o,a,c,g);if(_){var y=_.name;p.has(y)||(g||void 0===m.parent&&!e.some(m.declarations,function(e){return e.getSourceFile()===r.getSourceFile()})||p.set(y,!0),n.push(_))}}return l("getCompletionsAtPosition: getCompletionEntriesFromSymbols: "+(e.timestamp()-d)),p}function o(e,t){if(e){var n=[];if(a(e,n,t),n.length)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!1,entries:n}}}function a(t,n,i,r){if(void 0===r&&(r=e.createMap()),t&&16384&t.flags&&(t=i.getBaseConstraintOfType(t)),t)if(65536&t.flags)for(var s=0,o=t.types;s<o.length;s++){a(o[s],n,i,r)}else if(32&t.flags&&!(256&t.flags)){var l=t.value;r.has(l)||(r.set(l,!0),n.push({name:l,kindModifiers:"",kind:"var",sortText:"0"}))}}function l(t,n,i,s,o,a,l){var d=a.name,p=a.source,h=c(t,n,s,o,l);if(h){var f=h.symbols,m=h.location,g=h.allowStringLiteral,_=h.symbolToOriginInfoMap,y=e.find(f,function(t){return u(t,i.target,!1,g)===d&&r(_[e.getSymbolId(t)])===p});return y&&{symbol:y,location:m,symbolToOriginInfoMap:_}}}function c(t,n,i,r,s){var o,a=e.isSourceFileJavaScript(i),l=e.timestamp(),c=e.getTokenAtPosition(i,r,!1);n("getCompletionData: Get current token: "+(e.timestamp()-l)),l=e.timestamp();var u=e.isInComment(i,r,c);n("getCompletionData: Is inside comment: "+(e.timestamp()-l));var d=!1;if(u){if(e.hasDocComment(i,r))if(64===i.text.charCodeAt(r-1))o={kind:"JsDocTagName"};else{var p=e.getLineStartPositionForPosition(r,i);i.text.substring(p,r).match(/[^\*|\s|(/\*\*)]/)||(o={kind:"JsDocTag"})}var h=function(t,n){var i=function(t){if(!e.isToken(t))return t;switch(t.kind){case 104:case 110:case 76:return t.parent.parent;default:return t.parent}}(t).jsDoc;if(!i)return;for(var r=0,s=i;r<s.length;r++){var o=s[r],a=o.pos,l=o.end,c=o.tags;if(!(!c||n<a||n>l))for(var u=c.length-1;u>=0;u--){var d=c[u];if(n>=d.pos)return d}}}(c,r);if(h&&(h.tagName.pos<=r&&r<=h.tagName.end&&(o={kind:"JsDocTagName"}),function(e){switch(e.kind){case 279:case 284:case 280:case 281:case 283:return!0}}(h)&&h.typeExpression&&267===h.typeExpression.kind&&((c=e.getTokenAtPosition(i,r,!0))&&(e.isDeclarationName(c)||284===c.parent.kind&&c.parent.name===c)||(d=K(h.typeExpression))),e.isJSDocParameterTag(h)&&(e.nodeIsMissing(h.name)||h.name.pos<=r&&r<=h.name.end)&&(o={kind:"JsDocParameterName",tag:h})),o)return{symbols:void 0,isGlobalCompletion:!1,isMemberCompletion:!1,allowStringLiteral:!1,isNewIdentifierLocation:!1,location:void 0,isRightOfDot:!1,request:o,keywordFilters:0,symbolToOriginInfoMap:void 0};if(!d)return void n("Returning an empty list because completion was inside a regular comment or plain text part of a JsDoc comment.")}l=e.timestamp();var y=e.findPrecedingToken(r,i,void 0,d);n("getCompletionData: Get previous token 1: "+(e.timestamp()-l));var b=y;if(b&&r<=b.end&&e.isWord(b.kind)){var v=e.timestamp();b=e.findPrecedingToken(b.getFullStart(),i,void 0,d),n("getCompletionData: Get previous token 2: "+(e.timestamp()-v))}var T=c,k=!1,x=!1,E=!1,S=e.getTouchingPropertyName(i,r,d);if(b){if(function(t){var i=e.timestamp(),s=function(t){if(9===t.kind||12===t.kind||e.isTemplateLiteralKind(t.kind)){var n=t.getStart(),i=t.getEnd();if(n<r&&r<i)return!0;if(r===i)return!!t.isUnterminated||12===t.kind}return!1}(t)||function(t){var n=t.parent.kind;switch(t.kind){case 26:return 226===n||227===n||208===n||232===n||j(n)||230===n||175===n||231===n||e.isClassLike(t.parent)&&t.parent.typeParameters&&t.parent.typeParameters.end>=t.pos;case 23:return 175===n;case 56:return 176===n;case 21:return 175===n;case 19:return 260===n||j(n);case 17:return 232===n||230===n||163===n;case 25:return 148===n&&t.parent&&t.parent.parent&&(230===t.parent.parent.kind||163===t.parent.parent.kind);case 27:return 229===n||199===n||230===n||231===n||e.isFunctionLikeKind(n);case 115:return 149===n&&!e.isClassLike(t.parent.parent);case 24:return 146===n||t.parent&&t.parent.parent&&175===t.parent.parent.kind;case 114:case 112:case 113:return 146===n&&!e.isConstructorDeclaration(t.parent.parent);case 118:return 242===n||246===n||240===n;case 125:case 135:if(H(t))return!1;case 75:case 83:case 109:case 89:case 104:case 91:case 110:case 76:case 116:case 138:return!0}if(m(t.getText())&&H(t))return!1;if(G(t)&&(!e.isIdentifier(t)||_(t.getText())||K(t)))return!1;switch(t.getText()){case"abstract":case"async":case"class":case"const":case"declare":case"enum":case"function":case"interface":case"let":case"private":case"protected":case"public":case"static":case"var":case"yield":return!0}return e.isDeclarationName(t)&&!e.isJsxAttribute(t.parent)}(t)||function(e){if(8===e.kind){var t=e.getFullText();return"."===t.charAt(t.length-1)}return!1}(t)||function(e){if(10===e.kind)return!0;if(29===e.kind&&e.parent){if(251===e.parent.kind)return!0;if(252===e.parent.kind||250===e.parent.kind)return e.parent.parent&&249===e.parent.parent.kind}return!1}(t);return n("getCompletionsAtPosition: isCompletionListBlocker: "+(e.timestamp()-i)),s}(b))return void n("Returning an empty list because completion was requested in an invalid position.");var C=b.parent;if(23===b.kind)if(179===C.kind)T=b.parent.expression,k=!0;else{if(143!==C.kind)return;T=b.parent.left,k=!0}else if(1===i.languageVariant)switch(C&&179===C.kind&&(b=C,C=C.parent),C.kind){case 252:41===b.kind&&(E=!0,S=b);break;case 194:if(!(32768&C.left.flags))break;case 250:case 249:case 251:27===b.kind&&(x=!0,S=b)}}var w,I,A=e.timestamp(),N=!1,D=!1,O=0,R=[],L=[];if(k)!function(){N=!1,w=!0,I=!1;var n=d||e.isPartOfTypeNode(T.parent),i=e.isInRightSideOfInternalImportEqualsDeclaration(T);if(e.isEntityName(T)){var r=t.getSymbolAtLocation(T);if(r&&1920&(r=e.skipAlias(r,t)).flags){for(var s=t.getExportsOfModule(r),o=function(e){return t.isValidPropertyAccess(T.parent,e.name)},a=function(e){return U(e)},l=i?function(e){return a(e)||o(e)}:n?a:o,c=0,u=s;c<u.length;c++){var p=u[c];l(p)&&R.push(p)}return void(!n&&r.declarations.some(function(e){return 265!==e.kind&&233!==e.kind&&232!==e.kind})&&B(t.getTypeOfSymbolAtLocation(r,T)))}}n||B(t.getTypeAtLocation(T))}();else if(x){var P=t.getJsxIntrinsicTagNames();R=$()?P.concat(R.filter(function(e){return!!(2204607&e.flags)})):P,w=!0,I=!1}else if(E){var M=b.parent.parent.openingElement.tagName,F=t.getSymbolAtLocation(M);t.isUnknownSymbol(F)||(R=[F]),w=!0,I=!1}else if(!$())return;return n("getCompletionData: Semantic work: "+(e.timestamp()-A)),{symbols:R,isGlobalCompletion:N,isMemberCompletion:w,allowStringLiteral:D,isNewIdentifierLocation:I,location:S,isRightOfDot:k||x,request:o,keywordFilters:O,symbolToOriginInfoMap:L};function B(e){for(var n=0,i=e.getApparentProperties();n<i.length;n++){var r=i[n];t.isValidPropertyAccess(T.parent,r.name)&&R.push(r)}if(a&&65536&e.flags)for(var s=0,o=e.types;s<o.length;s++){B(o[s])}}function $(){var n,o,a,l;if(n=function(t){if(t)switch(t.kind){case 17:case 26:var n=t.parent;if(e.isObjectLiteralExpression(n)||e.isObjectBindingPattern(n))return n}return}(b))return function(n){var i,r;if(w=!0,D=!0,178===n.kind){if(I=!0,!(a=t.getContextualType(n)))return!1;i=function(e,t){if(!(65536&e.flags))return t.getPropertiesOfType(e);var n=e.types.filter(function(e){return!(8190&e.flags||t.isArrayLikeType(e))});return t.getAllPossiblePropertiesOfTypes(n)}(a,t),r=n.properties}else{e.Debug.assert(174===n.kind),I=!1;var s=e.getRootDeclaration(n.parent);if(!e.isVariableLike(s))throw e.Debug.fail("Root declaration is not variable-like.");var o=s.initializer||s.type||216===s.parent.parent.kind;if(o||146!==s.kind||(e.isExpression(s.parent)?o=!!t.getContextualType(s.parent):151!==s.parent.kind&&154!==s.parent.kind||(o=e.isExpression(s.parent.parent)&&!!t.getContextualType(s.parent.parent))),o){var a;if(!(a=t.getTypeAtLocation(n)))return!1;i=t.getPropertiesOfType(a).filter(function(t){return!(24&e.getDeclarationModifierFlagsFromSymbol(t))}),r=n.elements}}i&&i.length>0&&(R=function(t,n){if(!n||0===n.length)return t;for(var i=e.createUnderscoreEscapedMap(),r=0,s=n;r<s.length;r++){var o=s[r];if((261===o.kind||262===o.kind||176===o.kind||151===o.kind||153===o.kind||154===o.kind)&&!K(o)){var a=void 0;if(176===o.kind&&o.propertyName)71===o.propertyName.kind&&(a=o.propertyName.escapedText);else{var l=e.getNameOfDeclaration(o);a=e.getEscapedTextOfIdentifierOrLiteral(l)}i.set(a,!0)}}return e.filter(t,function(e){return!i.get(e.escapedName)})}(i,r));return!0}(n);if(o=function(e){if(e)switch(e.kind){case 17:case 26:switch(e.parent.kind){case 241:case 245:return e.parent}}return}(b))return function(n){var i=241===n.kind?238:244,r=e.getAncestor(n,i),s=r.moduleSpecifier;if(!s)return!1;w=!0,I=!1;var o=t.getSymbolAtLocation(s);if(!o)return R=e.emptyArray,!0;var a=t.getExportsAndPropertiesOfModule(o);return R=function(t,n){for(var i=e.createUnderscoreEscapedMap(),r=0,s=n;r<s.length;r++){var o=s[r];if(!K(o)){var a=o.propertyName||o.name;i.set(a.escapedText,!0)}}if(0===i.size)return e.filter(t,function(e){return"default"!==e.escapedName});return e.filter(t,function(e){return"default"!==e.escapedName&&!i.get(e.escapedName)})}(a,n.elements),!0}(o);if(function(t){if(t)switch(t.kind){case 19:case 26:return e.isConstructorDeclaration(t.parent)&&t.parent;default:if(G(t))return t.parent.parent}return}(b))return w=!1,I=!0,O=2,!0;if(a=function(t){if(t)switch(t.kind){case 17:case 26:if(e.isClassLike(t.parent))return t.parent;break;case 25:case 18:if(e.isClassLike(S))return S;if(H(S)&&S.parent.name===S)return S.parent.parent;break;default:if(H(t)&&(f(t.kind)||m(t.getText())))return t.parent.parent}if(S&&286===S.kind&&e.isClassLike(S.parent))return S.parent;return}(b))return function(n){w=!0,I=!0,O=1;var i=e.getClassExtendsHeritageClauseElement(n),r=e.getClassImplementsHeritageClauseElements(n);if(i||r){var s=b.parent,o=e.isClassElement(s)&&e.getModifierFlags(s);if(71===b.kind&&!K(b))switch(b.getText()){case"private":o|=8;break;case"static":o|=32}if(!(8&o)){var a=void 0;i&&(a=t.getTypeAtLocation(i),32&o&&(a=t.getTypeOfSymbolAtLocation(a.symbol,n)));var l=32&o?e.emptyArray:e.flatMap(r||e.emptyArray,function(e){return t.getPropertiesOfType(t.getTypeAtLocation(e))});R=function(t,n,i,r){for(var s=e.createUnderscoreEscapedMap(),o=0,a=i;o<a.length;o++){var l=a[o];if((149===l.kind||151===l.kind||153===l.kind||154===l.kind)&&(!K(l)&&!e.hasModifier(l,8))){var c=e.hasModifier(l,32),u=!!(32&r);if(!(c&&!u||!c&&u)){var d=e.getPropertyNameForPropertyNameNode(l.name);d&&s.set(d,!0)}}}var p=[];return h(t,8),h(n,24),p;function h(e,t){for(var n=0,i=e;n<i.length;n++){var r=i[n];f(r,t)&&p.push(r)}}function f(t,n){return!s.get(t.escapedName)&&t.getDeclarations()&&!(e.getDeclarationModifierFlagsFromSymbol(t)&n)}}(a?t.getPropertiesOfType(a):e.emptyArray,l,n.members,o)}}}(a),!0;if(l=function(e){if(e){var t=e.parent;switch(e.kind){case 28:case 41:case 71:case 179:case 254:case 253:case 255:if(t&&(250===t.kind||251===t.kind))return t;if(253===t.kind)return t.parent.parent;break;case 9:if(t&&(253===t.kind||255===t.kind))return t.parent.parent;break;case 18:if(t&&256===t.kind&&t.parent&&253===t.parent.kind)return t.parent.parent.parent;if(t&&255===t.kind)return t.parent.parent}}return}(b)){var c=void 0;if((250===l.kind||251===l.kind)&&(c=t.getAllAttributesTypeFromJsxOpeningLikeElement(l)))return R=function(t,n){for(var i=e.createUnderscoreEscapedMap(),r=0,s=n;r<s.length;r++){var o=s[r];K(o)||253===o.kind&&i.set(o.name.escapedText,!0)}return e.filter(t,function(e){return!i.get(e.escapedName)})}(t.getPropertiesOfType(c),l.attributes.properties),w=!0,I=!1,!0}w=!1,I=function(e){if(e){var t=e.parent.kind;switch(e.kind){case 26:return 181===t||152===t||182===t||177===t||194===t||160===t;case 19:return 181===t||152===t||182===t||185===t||168===t;case 21:return 177===t||157===t||144===t;case 128:case 129:return!0;case 23:return 233===t;case 17:return 229===t;case 58:return 226===t||194===t;case 14:return 196===t;case 15:return 205===t;case 114:case 112:case 113:return 149===t}switch(e.getText()){case"public":case"protected":case"private":return!0}}return!1}(b),y!==b&&e.Debug.assert(!!y,"Expected 'contextToken' to be defined when different from 'previousToken'.");var u=y!==b?y.getStart():r,p=function(t,n,i){var r=t;for(;r&&!e.positionBelongsToNode(r,n,i);)r=r.parent;return r}(b,u,i)||i;p&&(N=265===p.kind||196===p.kind||256===p.kind||e.isStatement(p));return function(n,r){var o=r.toLowerCase();e.codefix.forEachExternalModule(t,s,function(r){if(r!==i.symbol)for(var s=0,a=t.getExportsOfModule(r);s<a.length;s++){var l=a[s],c=l.name,u="default"===c;if(u){var d=e.getLocalSymbolForExportDefault(l);d&&(l=d,c=d.name)}l.declarations&&l.declarations.some(function(t){return e.isExportSpecifier(t)&&!!t.parent.parent.moduleSpecifier})||V(c.toLowerCase(),o)&&(n.push(l),L[e.getSymbolId(l)]={moduleSymbol:r,isDefaultExport:u})}})}(R=t.getSymbolsInScope(p,2998271),y&&e.isIdentifier(y)?y.text:""),function(n){e.filterMutate(n,function(n){if(!e.isSourceFile(S)){if(e.isExportAssignment(S.parent))return!0;if(n&&2097152&n.flags&&(n=t.getAliasedSymbol(n)),e.isInRightSideOfInternalImportEqualsDeclaration(S))return!!(1920&n.flags);if(d||!function(e){return e&&103===e.kind&&162===e.parent.kind}(b)&&(e.isPartOfTypeNode(S)||function(t){if(t){var n=t.parent.kind;switch(t.kind){case 56:return 149===n||148===n||146===n||226===n||e.isFunctionLikeKind(n);case 58:return 231===n;case 118:return 202===n}}}(b)))return U(n)}return!!(107455&e.getCombinedLocalAndExportSymbolFlags(n))})}(R),!0}function U(n){if(n=n.exportSymbol||n,793064&(n=e.skipAlias(n,t)).flags)return!0;if(1536&n.flags){var i=t.getExportsOfModule(n);return e.forEach(i,U)}}function V(e,t){if(0===t.length)return!0;for(var n=0,i=0;i<e.length;i++)if(e.charCodeAt(i)===t.charCodeAt(n)&&++n===t.length)return!0;return!1}function H(t){return e.isClassElement(t.parent)&&e.isClassLike(t.parent.parent)}function G(t){return t.parent&&function(t){return e.isParameter(t)&&e.isConstructorDeclaration(t.parent)}(t.parent)&&(g(t.kind)||e.isDeclarationName(t))}function j(t){return e.isFunctionLikeKind(t)&&152!==t}function K(e){return e.getStart()<=r&&r<=e.getEnd()}}function u(t,n,i,r){var s=t.name;if(s){if(1920&t.flags){var o=s.charCodeAt(0);if(e.isSingleOrDoubleQuote(o))return}return d(s,n,i,r)}}function d(t,n,i,r){return i&&!e.isIdentifierText(t,n)?r?JSON.stringify(t):void 0:t}!function(e){e[e.None=0]="None",e[e.ClassElementKeywords=1]="ClassElementKeywords",e[e.ConstructorParameterKeywords=2]="ConstructorParameterKeywords"}(n||(n={})),t.getCompletionsAtPosition=function(n,i,r,l,u,p,f){if(e.isInReferenceComment(u,p))return t.PathCompletions.getTripleSlashReferenceCompletion(u,p,l,n);if(e.isInString(u,p))return function(n,i,r,l,c,u){var d=e.findPrecedingToken(i,n);if(!d||9!==d.kind)return;if(261===d.parent.kind&&178===d.parent.parent.kind&&d.parent.name===d)return function(e,t,n,i){var r=t.getContextualType(e.parent),o=[];if(r&&(s(r.getApparentProperties(),o,e,!1,t,n,i,!0),o.length))return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!0,entries:o}}(d.parent,r,l.target,u);if(e.isElementAccessExpression(d.parent)&&d.parent.argumentExpression===d)return function(e,t,n,i){var r=t.getTypeAtLocation(e.expression),o=[];if(r&&(s(r.getApparentProperties(),o,e,!1,t,n,i,!0),o.length))return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!0,entries:o};return}(d.parent,r,l.target,u);if(238===d.parent.kind||e.isExpressionOfExternalModuleImportEqualsDeclaration(d)||e.isRequireCall(d.parent,!1))return t.PathCompletions.getStringLiteralCompletionEntriesFromModuleNames(d,l,c,r);if(function(t){return e.isBinaryExpression(t)&&(n=t.operatorToken.kind,32===n||33===n||34===n||35===n);var n}(d.parent))return o(r.getTypeAtLocation(d.parent.left===d?d.parent.right:d.parent.left),r);if(e.isCaseOrDefaultClause(d.parent))return o(r.getTypeAtLocation(d.parent.parent.parent.expression),r);var p=e.SignatureHelp.getImmediatelyContainingArgumentInfo(d,i,n);return p?function(t,n){var i=[],r=[],s=e.createMap();n.getResolvedSignature(t.invocation,i,t.argumentCount);for(var o=0,l=i;o<l.length;o++){var c=l[o];a(n.getParameterType(c,t.argumentIndex),r,n,s)}if(r.length)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:r};return}(p,r):o(r.getContextualType(d),r)}(u,p,i,l,n,r);var m=c(i,r,u,p,f);if(m){var g=m.symbols,_=m.isGlobalCompletion,y=m.isMemberCompletion,b=m.allowStringLiteral,v=m.isNewIdentifierLocation,T=m.location,k=m.request,x=m.keywordFilters,E=m.symbolToOriginInfoMap;if(1===u.languageVariant&&T&&T.parent&&252===T.parent.kind)return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!1,entries:[{name:T.parent.parent.openingElement.tagName.getFullText(),kind:"class",kindModifiers:void 0,sortText:"0"}]};if(k)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!1,entries:"JsDocTagName"===k.kind?e.JsDoc.getJSDocTagNameCompletions():"JsDocTag"===k.kind?e.JsDoc.getJSDocTagCompletions():e.JsDoc.getJSDocParameterNameCompletions(k.tag)};var S=[];if(e.isSourceFileJavaScript(u)){var C=s(g,S,T,!0,i,l.target,r,b,E);!function(t,n,i,r,s){e.getNameTable(t).forEach(function(t,o){if(t!==n){var a=e.unescapeLeadingUnderscores(o);if(!i.has(a)){i.set(a,!0);var l=d(a,r,!0,!1);l&&s.push({name:l,kind:"warning",kindModifiers:"",sortText:"1"})}}})}(u,T.pos,C,l.target,S)}else{if((!g||0===g.length)&&0===x)return;s(g,S,T,!0,i,l.target,r,b,E)}return 0===x&&y||e.addRange(S,h(x)),{isGlobalCompletion:_,isMemberCompletion:y,isNewIdentifierLocation:v,entries:S}}},t.getCompletionEntryDetails=function(t,n,i,r,s,o,a,c,u){var d=o.name,p=o.source,f=l(t,n,i,r,s,o,a);if(f){var m=f.symbol,g=f.location,_=function(t,n,i,r,s,o,a){var l=t[e.getSymbolId(n)];if(!l)return;var c=l.moduleSymbol,u=l.isDefaultExport;return e.codefix.getCodeActionForImport(c,{host:r,checker:i,newLineCharacter:r.getNewLine(),compilerOptions:s,sourceFile:o,rulesProvider:a,symbolName:n.name,getCanonicalFileName:e.createGetCanonicalFileName(!!r.useCaseSensitiveFileNames&&r.useCaseSensitiveFileNames()),symbolToken:void 0,kind:u?1:0})}(f.symbolToOriginInfoMap,m,t,c,i,r,u),y=e.SymbolDisplay.getSymbolModifiers(m),b=e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(t,m,r,g,g,7),v=b.displayParts,T=b.documentation,k=b.symbolKind,x=b.tags;return{name:d,kindModifiers:y,kind:k,displayParts:v,documentation:T,tags:x,codeActions:_,source:void 0===p?void 0:[e.textPart(p)]}}if(void 0===p&&e.some(h(0),function(e){return e.name===d}))return{name:d,kind:"keyword",kindModifiers:"",displayParts:[e.displayPart(d,e.SymbolDisplayPartKind.keyword)],documentation:void 0,tags:void 0,codeActions:void 0,source:void 0}},t.getCompletionEntrySymbol=function(e,t,n,i,r,s,o){var a=l(e,t,n,i,r,s,o);return a&&a.symbol};var p=[];function h(t){var n=p[t];return n||(p[t]=function(t){switch(t){case 0:return function(){for(var t=[],n=72;n<=142;n++)t.push({name:e.tokenToString(n),kind:"keyword",kindModifiers:"",sortText:"0"});return t}();case 1:return i(m);case 2:return i(_)}}(t));function i(t){return e.filter(h(0),function(e){return t(e.name)})}}function f(e){switch(e){case 114:case 113:case 112:case 117:case 115:case 123:case 131:case 125:case 135:case 120:return!0}}function m(t){return f(e.stringToToken(t))}function g(e){switch(e){case 114:case 112:case 113:case 131:return!0}}function _(t){return g(e.stringToToken(t))}}(e.Completions||(e.Completions={}))}(ts||(ts={})),function(e){!function(t){function n(t,n){return{fileName:n.fileName,textSpan:e.createTextSpanFromNode(t,n),kind:"none"}}function i(e,t){return void 0!==e&&e.kind===t}function r(e){return e&&e.parent}function s(t){var n=[];return function t(i){if(223===i.kind)n.push(i);else if(224===i.kind){var r=i;r.catchClause?t(r.catchClause):t(r.tryBlock),r.finallyBlock&&t(r.finallyBlock)}else e.isFunctionLike(i)||e.forEachChild(i,t)}(t),n}function o(t){var n=[];return function t(i){218===i.kind||217===i.kind?n.push(i):e.isFunctionLike(i)||e.forEachChild(i,t)}(t),n}function a(e,t){var n=l(t);return n&&n===e}function l(t){for(var n=t.parent;n;n=n.parent)switch(n.kind){case 221:if(217===t.kind)continue;case 214:case 215:case 216:case 213:case 212:if(!t.label||p(n,t.label.text))return n;break;default:if(e.isFunctionLike(n))return}}function c(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return!(!n||!e.contains(i,n.kind))&&(t.push(n),!0)}function u(t){var n=[];if(c(n,t.getFirstToken(),88,106,81)&&212===t.kind)for(var i=t.getChildren(),r=i.length-1;r>=0&&!c(n,i[r],106);r--);var s=o(t.statement);return e.forEach(s,function(e){a(t,e)&&c(n,e.getFirstToken(),72,77)}),n}function d(t){var n=[];return c(n,t.getFirstToken(),98),e.forEach(t.caseBlock.clauses,function(i){c(n,i.getFirstToken(),73,79);var r=o(i);e.forEach(r,function(e){a(t,e)&&c(n,e.getFirstToken(),72)})}),n}function p(e,t){for(var n=e.parent;222===n.kind;n=n.parent)if(n.label.escapedText===t)return!0;return!1}t.getDocumentHighlights=function(t,o,a,p,h){var f=e.getTouchingWord(a,p,!0);if(f!==a){if(e.Debug.assert(void 0!==f.parent),e.isJsxOpeningElement(f.parent)&&f.parent.tagName===f||e.isJsxClosingElement(f.parent)){var m=f.parent.parent,g=[m.openingElement,m.closingElement].map(function(e){return n(e.tagName,a)});return[{fileName:a.fileName,highlightSpans:g}]}return function(t,n,i,r){var s=e.FindAllReferences.getReferenceEntriesForNode(t,n,r,i);return s&&function(t){for(var n=e.createMap(),i=0,r=t;i<r.length;i++){var s=r[i],o=e.FindAllReferences.toHighlightSpan(s),a=o.fileName,l=o.span,c=n.get(a);c||n.set(a,c=[]),c.push(l)}return e.arrayFrom(n.entries(),function(e){return{fileName:e[0],highlightSpans:e[1]}})}(s)}(f,t,o,h)||function(t,o){var a=function(t,o){if(!t)return;switch(t.kind){case 90:case 82:if(i(t.parent,211))return function(t,r){var s=[];for(;i(t.parent,211)&&t.parent.elseStatement===t;)t=t.parent;for(;t;){var o=t.getChildren();c(s,o[0],90);for(var a=o.length-1;a>=0&&!c(s,o[a],82);a--);if(!i(t.elseStatement,211))break;t=t.elseStatement}var l=[];for(a=0;a<s.length;a++){if(82===s[a].kind&&a<s.length-1){for(var u=s[a],d=s[a+1],p=!0,h=d.getStart()-1;h>=u.end;h--)if(!e.isWhiteSpaceSingleLine(r.text.charCodeAt(h))){p=!1;break}if(p){l.push({fileName:r.fileName,textSpan:e.createTextSpanFromBounds(u.getStart(),d.end),kind:"reference"}),a++;continue}}l.push(n(s[a],r))}return l}(t.parent,o);break;case 96:if(i(t.parent,219))return m(function(t){var n=e.getContainingFunction(t);if(!n||!i(n.body,207))return;var r=[];return e.forEachReturnStatement(n.body,function(e){c(r,e.getFirstToken(),96)}),e.forEach(s(n.body),function(e){c(r,e.getFirstToken(),100)}),r}(t.parent));break;case 100:if(i(t.parent,223))return m(function(t){var n=function(t){var n=t;for(;n.parent;){var i=n.parent;if(e.isFunctionBlock(i)||265===i.kind)return i;if(224===i.kind){var r=i;if(r.tryBlock===n&&r.catchClause)return n}n=i}return}(t);if(!n)return;var i=[];e.forEach(s(n),function(e){c(i,e.getFirstToken(),100)}),e.isFunctionBlock(n)&&e.forEachReturnStatement(n,function(e){c(i,e.getFirstToken(),96)});return i}(t.parent));break;case 102:case 74:case 87:var a=74===t.kind?r(r(t)):r(t);if(i(a,224))return m(function(t,n){var i=[];c(i,t.getFirstToken(),102),t.catchClause&&c(i,t.catchClause.getFirstToken(),74);if(t.finallyBlock){c(i,e.findChildOfKind(t,87,n),87)}return i}(a,o));break;case 98:if(i(t.parent,221))return m(d(t.parent));break;case 73:case 79:if(i(r(r(r(t))),221))return m(d(t.parent.parent.parent));break;case 72:case 77:if(i(t.parent,218)||i(t.parent,217))return m(function(e){var t=l(e);if(t)switch(t.kind){case 214:case 215:case 216:case 212:case 213:return u(t);case 221:return d(t)}return}(t.parent));break;case 88:if(i(t.parent,214)||i(t.parent,215)||i(t.parent,216))return m(u(t.parent));break;case 106:case 81:if(i(t.parent,213)||i(t.parent,212))return m(u(t.parent));break;case 123:if(i(t.parent,152))return m((p=t.parent,h=p.symbol.getDeclarations(),f=[],e.forEach(h,function(t){e.forEach(t.getChildren(),function(e){return c(f,e,123)})}),f));break;case 125:case 135:if(i(t.parent,153)||i(t.parent,154))return m(function(t){var n=[];return i(t.symbol,153),i(t.symbol,154),n;function i(t,i){var r=e.getDeclarationOfKind(t,i);r&&e.forEach(r.getChildren(),function(e){return c(n,e,125,135)})}}(t.parent));break;default:if(e.isModifierKind(t.kind)&&t.parent&&(e.isDeclaration(t.parent)||208===t.parent.kind))return m(function(t,n){if(!function(e,t){var n=t.parent;switch(e){case 112:case 113:case 114:switch(n.kind){case 229:case 199:return!0;case 152:return 146===t.kind;default:return!1}case 115:return 229===n.kind||199===n.kind;case 84:case 124:return 234===n.kind||265===n.kind;case 117:return 229===n.kind||229===t.kind;default:return!1}}(t,n))return;var i=e.modifierToFlag(t);return e.mapDefined(function(t,n){var i=t.parent;switch(i.kind){case 234:case 265:case 207:case 257:case 258:return 128&n?t.members.concat([t]):i.statements;case 152:return i.parameters.concat(i.parent.members);case 229:case 199:var r=i.members;if(28&n){var s=e.find(i.members,e.isConstructorDeclaration);if(s)return r.concat(s.parameters)}else if(128&n)return r.concat([i]);return r;default:e.Debug.fail("Invalid container kind.")}}(n,i),function(n){if(e.getModifierFlags(n)&i){var r=e.find(n.modifiers,function(e){return e.kind===t});return e.Debug.assert(!!r),r}})}(t.kind,t.parent))}var p,h,f;function m(e){return e&&e.map(function(e){return n(e,o)})}}(t,o);if(!a||0===a.length)return;return[{fileName:o.fileName,highlightSpans:a}]}(f,a)}}}(e.DocumentHighlights||(e.DocumentHighlights={}))}(ts||(ts={})),function(e){e.createDocumentRegistry=function(t,n){void 0===n&&(n="");var i=e.createMap(),r=e.createGetCanonicalFileName(!!t);function s(e){return"_"+e.target+"|"+e.module+"|"+e.noResolve+"|"+e.jsx+"|"+e.allowJs+"|"+e.baseUrl+"|"+JSON.stringify(e.typeRoots)+"|"+JSON.stringify(e.rootDirs)+"|"+JSON.stringify(e.paths)}function o(t,n){var r=i.get(t);return!r&&n&&i.set(t,r=e.createMap()),r}function a(e,t,n,i,r,s,o){return c(e,t,n,i,r,s,!0,o)}function l(e,t,n,i,r,s,o){return c(e,t,n,i,r,s,!1,o)}function c(t,n,i,r,s,a,l,c){var u=o(r,!0),d=u.get(n);d?(d.sourceFile.version!==a&&(d.sourceFile=e.updateLanguageServiceSourceFile(d.sourceFile,s,a,s.getChangeRange(d.sourceFile.scriptSnapshot))),l&&d.languageServiceRefCount++):(d={sourceFile:e.createLanguageServiceSourceFile(t,s,i.target,a,!1,c),languageServiceRefCount:1,owners:[]},u.set(n,d));return d.sourceFile}function u(t,n){var i=o(n,!1);e.Debug.assert(void 0!==i);var r=i.get(t);r.languageServiceRefCount--,e.Debug.assert(r.languageServiceRefCount>=0),0===r.languageServiceRefCount&&i.delete(t)}return{acquireDocument:function(t,i,o,l,c){return a(t,e.toPath(t,n,r),i,s(i),o,l,c)},acquireDocumentWithKey:a,updateDocument:function(t,i,o,a,c){return l(t,e.toPath(t,n,r),i,s(i),o,a,c)},updateDocumentWithKey:l,releaseDocument:function(t,i){return u(e.toPath(t,n,r),s(i))},releaseDocumentWithKey:u,reportStats:function(){var t=e.arrayFrom(i.keys()).filter(function(e){return e&&"_"===e.charAt(0)}).map(function(e){var t=i.get(e),n=[];return t.forEach(function(e,t){n.push({name:t,refCount:e.languageServiceRefCount,references:e.owners.slice(0)})}),n.sort(function(e,t){return t.refCount-e.refCount}),{bucket:e,sourceFiles:n}});return JSON.stringify(t,void 0,2)},getKeyForCompilationSettings:s}}}(ts||(ts={})),function(e){!function(t){function n(t,n){return e.forEach(265===t.kind?t.statements:t.body.statements,function(t){return n(t)||c(t)&&e.forEach(t.body&&t.body.statements,n)})}function i(e,t){if(e.externalModuleIndicator||void 0!==e.imports)for(var i=0,s=e.imports;i<s.length;i++){var o=s[i];t(r(o),o)}else n(e,function(e){switch(e.kind){case 244:case 238:(n=e).moduleSpecifier&&9===n.moduleSpecifier.kind&&t(n,n.moduleSpecifier);break;case 237:var n,i=(n=e).moduleReference;248===i.kind&&9===i.expression.kind&&t(n,i.expression)}})}function r(t){var n=t.parent;switch(n.kind){case 181:case 238:case 244:return n;case 248:return n.parent;default:e.Debug.fail("Unexpected module specifier parent: "+n.kind)}}function s(t,n,i){var r=i.getMergedSymbol(t.parent);return e.isExternalModuleSymbol(r)?{exportingModuleSymbol:r,exportKind:n}:void 0}function o(t){return"default"!==t.escapedName?t.escapedName:e.forEach(t.declarations,function(t){var n=e.getNameOfDeclaration(t);return n&&71===n.kind&&n.escapedText})}function a(e,t){return t.getMergedSymbol(l(e).symbol)}function l(t){if(181===t.kind)return t.getSourceFile();var n=t.parent;return 265===n.kind?n:(e.Debug.assert(234===n.kind&&c(n.parent)),n.parent)}function c(e){return 233===e.kind&&9===e.name.kind}function u(e){var t=e.moduleReference;return 248===t.kind&&9===t.expression.kind}t.createImportTracker=function(t,r,s){var c=function(t,n,r){for(var s=e.createMap(),o=0,a=t;o<a.length;o++){var l=a[o];r.throwIfCancellationRequested(),i(l,function(t,i){var r=n.getSymbolAtLocation(i);if(r){var o=e.getSymbolId(r).toString(),a=s.get(o);a||s.set(o,a=[]),a.push(t)}})}return s}(t,r,s);return function(i,d,p){var h=function(t,i,r,s,o){var c=r.exportingModuleSymbol,u=r.exportKind,d=e.nodeSeenTracker(),p=e.nodeSeenTracker(),h=[],f=!!c.globalExports,m=f?void 0:[];return _(c),{directImports:h,indirectUsers:g()};function g(){if(f)return t;for(var n=0,i=c.declarations;n<i.length;n++){var r=i[n];e.isExternalModuleAugmentation(r)&&b(r)}return m.map(e.getSourceFileOfNode)}function _(t){var n=T(t);if(n)for(var i=0,r=n;i<r.length;i++){var l=r[i];if(d(l))switch(o.throwIfCancellationRequested(),l.kind){case 181:if(!f){var c=l.parent;if(2===u&&226===c.kind){var p=c.name;if(71===p.kind){h.push(p);break}}b(l.getSourceFile())}break;case 237:y(l,l.name,e.hasModifier(l,1));break;case 238:var m=l.importClause&&l.importClause.namedBindings;m&&240===m.kind?y(l,m.name):h.push(l);break;case 244:l.exportClause?h.push(l):_(a(l,s))}}}function y(t,i,r){if(2===u)h.push(t);else if(!f){var o=l(t);e.Debug.assert(265===o.kind||233===o.kind),r||function(e,t,i){var r=i.getSymbolAtLocation(t);return n(e,function(e){if(244===e.kind){var t=e,n=t.exportClause;if(!t.moduleSpecifier&&n)for(var s=0,o=n.elements;s<o.length;s++){var a=o[s];if(i.getExportSpecifierLocalTargetSymbol(a)===r)return!0}}})}(o,i,s)?v(o):b(o)}}function b(t){e.Debug.assert(!f);var n=p(t);return n&&m.push(t),n}function v(t){if(b(t)){var n=s.getMergedSymbol(t.symbol);e.Debug.assert(!!(1536&n.flags));var i=T(n);if(i)for(var r=0,o=i;r<o.length;r++){v(l(o[r]))}}}function T(t){return i.get(e.getSymbolId(t).toString())}}(t,c,d,r,s),f=h.directImports,m=h.indirectUsers;return __assign({indirectUsers:m},function(e,t,n,i,r){var s=[],a=[];function l(e,t){s.push([e,t])}if(e)for(var c=0,d=e;c<d.length;c++){p(d[c])}return{importSearches:s,singleReferences:a};function p(e){if(237!==e.kind)if(71!==e.kind){if(9===e.moduleSpecifier.kind)if(244!==e.kind){var s=e.importClause;if(s){var a=s.namedBindings;if(a&&240===a.kind)h(a.name);else if(0===n)f(a);else{var c=s.name;if(c&&(!r||c.escapedText===o(t)))l(c,i.getSymbolAtLocation(c));r||1!==n||f(a)}}}else f(e.exportClause)}else h(e);else u(e)&&h(e.name)}function h(e){2!==n||r&&!m(e.escapedText)||l(e,i.getSymbolAtLocation(e))}function f(e){if(e)for(var t=0,n=e.elements;t<n.length;t++){var s=n[t],o=s.name,c=s.propertyName;if(m((c||o).escapedText))if(c)a.push(c),r||l(o,i.getSymbolAtLocation(o));else l(o,246===s.kind&&s.propertyName?i.getExportSpecifierLocalTargetSymbol(s):i.getSymbolAtLocation(o))}}function m(e){return e===t.escapedName||0!==n&&"default"===e}}(f,i,d.exportKind,r,p))}},function(e){e[e.Named=0]="Named",e[e.Default=1]="Default",e[e.ExportEquals=2]="ExportEquals"}(t.ExportKind||(t.ExportKind={})),function(e){e[e.Import=0]="Import",e[e.Export=1]="Export"}(t.ImportExport||(t.ImportExport={})),t.findModuleReferences=function(e,t,n){for(var r=[],s=e.getTypeChecker(),o=0,a=t;o<a.length;o++){var l=a[o],c=n.valueDeclaration;if(265===c.kind){for(var u=0,d=l.referencedFiles;u<d.length;u++){var p=d[u];e.getSourceFileFromReference(l,p)===c&&r.push({kind:"reference",referencingFile:l,ref:p})}for(var h=0,f=l.typeReferenceDirectives;h<f.length;h++){p=f[h];var m=e.getResolvedTypeReferenceDirectives().get(p.fileName);void 0!==m&&m.resolvedFileName===c.fileName&&r.push({kind:"reference",referencingFile:l,ref:p})}}i(l,function(e,t){s.getSymbolAtLocation(t)===n&&r.push({kind:"import",literal:t})})}return r},t.getImportOrExportSymbol=function(t,n,i,r){return r?a():a()||function(){var r=function(t){var n=t.parent;switch(n.kind){case 237:return n.name===t&&u(n)?{isNamedImport:!1}:void 0;case 242:return n.propertyName?void 0:{isNamedImport:!0};case 239:case 240:return e.Debug.assert(n.name===t),{isNamedImport:!1};default:return}}(t);if(!r)return;var s=i.getImmediateAliasedSymbol(n);if(!s)return;s=function(t,n){if(t.declarations)for(var i=0,r=t.declarations;i<r.length;i++){var s=r[i];if(e.isExportSpecifier(s)&&!s.propertyName&&!s.parent.parent.moduleSpecifier)return n.getExportSpecifierLocalTargetSymbol(s)}return t}(s,i),"export="===s.escapedName&&(s=function(t,n){if(2097152&t.flags)return n.getImmediateAliasedSymbol(t);var i=t.valueDeclaration;if(e.isExportAssignment(i))return i.expression.symbol;if(e.isBinaryExpression(i))return i.right.symbol;e.Debug.fail()}(s,i));var a=o(s);if(void 0===a||"default"===a||a===n.escapedName)return __assign({kind:0,symbol:s},r)}();function a(){var s=t.parent;if(n.exportSymbol)return 179===s.kind?n.declarations.some(function(e){return e===s})&&e.isBinaryExpression(s.parent)?u(s.parent,!1):void 0:l(n.exportSymbol,c(s));var o=function(e,t){if(226===e.kind){var n=e;return n.name!==t||260===n.parent.kind?void 0:208===n.parent.parent.kind?n.parent.parent:void 0}return e}(s,t);if(o&&e.hasModifier(o,1)){if(e.isImportEqualsDeclaration(o)&&o.moduleReference===t){if(r)return;return{kind:0,symbol:i.getSymbolAtLocation(o.name),isNamedImport:!1}}return l(n,c(o))}if(e.isExportAssignment(s))return a(s);if(e.isExportAssignment(s.parent))return a(s.parent);if(e.isBinaryExpression(s))return u(s,!0);if(e.isBinaryExpression(s.parent))return u(s.parent,!0);function a(t){var i=t.symbol.parent;e.Debug.assert(!!i);var r=t.isExportEquals?2:1;return{kind:1,symbol:n,exportInfo:{exportingModuleSymbol:i,exportKind:r}}}function u(t,r){var s;switch(e.getSpecialPropertyAssignmentKind(t)){case 1:s=0;break;case 2:s=2;break;default:return}var o=r?i.getSymbolAtLocation(t.left.name):n;return o&&l(o,s)}}function l(e,t){var n=s(e,t,i);return n&&{kind:1,symbol:e,exportInfo:n}}function c(t){return e.hasModifier(t,512)?1:0}},t.getExportInfo=s}(e.FindAllReferences||(e.FindAllReferences={}))}(ts||(ts={})),function(e){!function(t){function n(e,t){return{type:"node",node:e,isInString:t}}function i(e,n,i,r,o){return void 0===o&&(o={}),s(t.Core.getReferencedSymbolsForNode(e,n,i,r,o))}function r(n,i,r,s,o,a){var l=e.getTouchingPropertyName(s,o,!0);return t.Core.getReferencedSymbolsForNode(l,n,r,i,a)}function s(t){return t&&e.flatMap(t,function(e){return e.references})}function o(t,n){var i=function(){switch(t.type){case"symbol":var i=t.symbol,r=t.node,s=a(i,r,n),o=s.displayParts,l=s.kind;return{node:r,name:o.map(function(e){return e.text}).join(""),kind:l,displayParts:o};case"label":var c=t.node;return{node:c,name:c.text,kind:"label",displayParts:[e.displayPart(c.text,e.SymbolDisplayPartKind.text)]};case"keyword":var u=t.node,d=e.tokenToString(u.kind);return{node:u,name:d,kind:"keyword",displayParts:[{text:d,kind:"keyword"}]};case"this":var p=t.node,h=(i=n.getSymbolAtLocation(p))&&e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(n,i,p.getSourceFile(),e.getContainerNode(p),p).displayParts;return{node:p,name:"this",kind:"var",displayParts:h};case"string":var f=t.node;return{node:f,name:f.text,kind:"var",displayParts:[e.displayPart(e.getTextOfNode(f),e.SymbolDisplayPartKind.stringLiteral)]}}}();if(i){var r=i.node,s=i.name,o=i.kind,l=i.displayParts,c=r.getSourceFile();return{containerKind:"",containerName:"",fileName:c.fileName,kind:o,name:s,textSpan:e.createTextSpanFromNode(r,c),displayParts:l}}}function a(t,n,i){var r=e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(i,t,n.getSourceFile(),e.getContainerNode(n),n);return{displayParts:r.displayParts,kind:r.symbolKind}}function l(t){if("span"===t.type)return{textSpan:t.textSpan,fileName:t.fileName,isWriteAccess:!1,isDefinition:!1};var n=t.node,i=t.isInString;return{fileName:n.getSourceFile().fileName,textSpan:c(n),isWriteAccess:u(n),isDefinition:79===n.kind||e.isAnyDeclarationName(n)||e.isLiteralComputedPropertyDeclarationName(n),isInString:i}}function c(t){var n=t.getStart(),i=t.getEnd();return 9===t.kind&&(n+=1,i-=1),e.createTextSpanFromBounds(n,i)}function u(t){return 79===t.kind||e.isAnyDeclarationName(t)||e.isWriteAccess(t)}t.nodeEntry=n,t.findReferencedSymbols=function(e,t,n,i,s){var a=r(e,t,n,i,s);if(a&&a.length){for(var c=[],u=e.getTypeChecker(),d=0,p=a;d<p.length;d++){var h=p[d],f=h.definition,m=h.references;f&&c.push({definition:o(f,u),references:m.map(l)})}return c}},t.getImplementationsAtPosition=function(r,s,o,l,u){var d=function(r,s,o,a){if(265===a.kind)return;var l=r.getTypeChecker();if(262===a.parent.kind){var c=[];return t.Core.getReferenceEntriesForShorthandPropertyAssignment(a,l,function(e){return c.push(n(e))}),c}if(97===a.kind||e.isSuperProperty(a.parent)){var u=l.getSymbolAtLocation(a);return u.valueDeclaration&&[n(u.valueDeclaration)]}return i(a,r,o,s,{implementations:!0})}(r,s,o,e.getTouchingPropertyName(l,u,!1)),p=r.getTypeChecker();return e.map(d,function(t){return function(t,n){if("node"===t.type){var i=t.node;return __assign({textSpan:c(i),fileName:i.getSourceFile().fileName},function(t,n){var i=n.getSymbolAtLocation(e.isDeclaration(t)&&t.name?t.name:t);return i?a(i,t,n):178===t.kind?{kind:"interface",displayParts:[e.punctuationPart(19),e.textPart("object literal"),e.punctuationPart(20)]}:199===t.kind?{kind:"local class",displayParts:[e.punctuationPart(19),e.textPart("anonymous local class"),e.punctuationPart(20)]}:{kind:e.getNodeKind(t),displayParts:[]}}(i,n))}return{textSpan:t.textSpan,fileName:t.fileName,kind:"",displayParts:[]}}(t,p)})},t.findReferencedEntries=function(t,n,i,o,a,c){var u=s(r(t,n,i,o,a,c));return e.map(u,l)},t.getReferenceEntriesForNode=i,t.toHighlightSpan=function(e){if("span"===e.type)return{fileName:e.fileName,span:{textSpan:e.textSpan,kind:"reference"}};var t=e.node,n=e.isInString,i=e.node.getSourceFile().fileName,r=u(t);return{fileName:i,span:{textSpan:c(t),kind:r?"writtenReference":"reference",isInString:n}}}}(e.FindAllReferences||(e.FindAllReferences={}))}(ts||(ts={})),function(e){!function(t){!function(n){n.getReferencedSymbolsForNode=function(n,s,a,c,p){if(void 0===p&&(p={}),265!==n.kind){if(!p.implementations){var f=function(n,i,r){if(e.isTypeKeyword(n.kind))return function(t,n,i){for(var r=[],s=0,o=t;s<o.length;s++){var a=o[s];i.throwIfCancellationRequested(),h(a,n,e.tokenToString(n),r)}return r.length?[{definition:{type:"keyword",node:r[0].node},references:r}]:void 0}(i,n.kind,r);if(e.isLabelName(n)){if(e.isJumpStatementTarget(n)){var s=e.getTargetLabel(n.parent,n.text);return s&&d(s.parent,s)}return d(n.parent,n)}if(e.isThis(n))return function(n,i,r){var s=e.getThisContainer(n,!1),o=32;switch(s.kind){case 151:case 150:if(e.isObjectLiteralMethod(s))break;case 149:case 148:case 152:case 153:case 154:o&=e.getModifierFlags(s),s=s.parent;break;case 265:if(e.isExternalModule(s))return;case 228:case 186:break;default:return}var a=[];if(265===s.kind)e.forEach(i,function(e){r.throwIfCancellationRequested(),c(e,e,u(e,"this"),a)});else{var l=s.getSourceFile();c(l,s,u(l,"this",s),a)}return[{definition:{type:"this",node:n},references:a}];function c(n,i,r,s){e.forEach(r,function(r){var a=e.getTouchingWord(n,r,!1);if(a&&e.isThis(a)){var l=e.getThisContainer(a,!1);switch(i.kind){case 186:case 228:i.symbol===l.symbol&&s.push(t.nodeEntry(a));break;case 151:case 150:e.isObjectLiteralMethod(i)&&i.symbol===l.symbol&&s.push(t.nodeEntry(a));break;case 199:case 229:l.parent&&i.symbol===l.parent.symbol&&(32&e.getModifierFlags(l))===o&&s.push(t.nodeEntry(a));break;case 265:265!==l.kind||e.isExternalModule(l)||s.push(t.nodeEntry(a))}}})}}(n,i,r);if(97===n.kind)return function(n){var i=e.getSuperContainer(n,!1);if(!i)return;var r=32;switch(i.kind){case 149:case 148:case 151:case 150:case 152:case 153:case 154:r&=e.getModifierFlags(i),i=i.parent;break;default:return}for(var s=[],o=i.getSourceFile(),a=u(o,"super",i),l=0,c=a;l<c.length;l++){var d=c[l],p=e.getTouchingWord(o,d,!1);if(p&&97===p.kind){var h=e.getSuperContainer(p,!1);h&&(32&e.getModifierFlags(h))===r&&h.parent.symbol===i.symbol&&s.push(t.nodeEntry(p))}}return[{definition:{type:"symbol",symbol:i.symbol,node:n},references:s}]}(n);return}(n,a,c);if(f)return f}var g=s.getTypeChecker(),b=g.getSymbolAtLocation(n);return b?1536&b.flags&&function(t){if(9!==t.kind)return!1;switch(t.parent.kind){case 233:case 248:case 238:case 244:return!0;case 181:return e.isRequireCall(t.parent,!1)||e.isImportCall(t.parent);default:return!1}}(n)?function(n,i,r){e.Debug.assert(!!i.valueDeclaration);for(var s=t.findModuleReferences(n,r,i).map(function(t){return"import"===t.kind?{type:"node",node:t.literal}:{type:"span",fileName:t.referencingFile.fileName,textSpan:e.createTextSpanFromRange(t.ref)}}),o=0,a=i.declarations;o<a.length;o++){var l=a[o];switch(l.kind){case 265:break;case 233:s.push({type:"node",node:l.name});break;default:e.Debug.fail("Expected a module symbol to be declared by a SourceFile or ModuleDeclaration.")}}return[{definition:{type:"symbol",symbol:i,node:i.valueDeclaration},references:s}]}(s,b,a):function(t,n,s,a,c,u){t=function(t,n,i){var r=n.parent;if(e.isExportSpecifier(r))return _(n,t,r,i);if(e.isImportSpecifier(r)&&r.propertyName===n)return i.getImmediateAliasedSymbol(t);return t}(t,n,a);var d=function(t,n){if(n){var i=void 0;do{i=t;for(var r=0,s=n;r<s.length;r++){var o=s[r],a=e.getMeaningFromDeclaration(o);a&t&&(t|=a)}}while(t!==i)}return t}(e.getMeaningFromLocation(n),t.declarations),p=[],h=new i(s,123===n.kind,a,c,d,u,p);if(79===n.kind)y(n,t,n,h),r(n,t,{exportingModuleSymbol:t.parent,exportKind:1},h);else{var f=h.createSearch(n,t,void 0,{allSearchSymbols:k(t,n,a,u.implementations)}),g=function(t){var n=t.declarations,i=t.flags,r=t.parent,s=t.valueDeclaration;if(s&&(186===s.kind||199===s.kind))return s;if(!n)return;if(8196&i){var o=e.find(n,function(t){return e.hasModifier(t,8)});return o?e.getAncestor(o,229):void 0}if(l(t))return;var a,c=r&&!(262144&t.flags);if(c&&(!(1536&r.flags&&e.isExternalModuleSymbol(r))||r.globalExports))return;for(var u=0,d=n;u<d.length;u++){var p=d[u],h=e.getContainerNode(p);if(a&&a!==h)return;if(!h||265===h.kind&&!e.isExternalOrCommonJsModule(h))return;a=h}return c?a.getSourceFile():a}(t);if(g)m(g,g.getSourceFile(),f,h);else for(var b=0,v=h.sourceFiles;b<v.length;b++){var T=v[b];h.cancellationToken.throwIfCancellationRequested(),o(T,f,h)}}return p}(b,n,a,g,c,p):p.implementations||9!==n.kind?void 0:function(n,i,r){for(var s=[],o=0,a=i;o<a.length;o++){var l=a[o];r.throwIfCancellationRequested();var c=u(l,n.text);d(l,n.text,c,s)}return[{definition:{type:"string",node:n},references:s}];function d(n,i,r,s){for(var o=0,a=r;o<a.length;o++){var l=a[o],c=e.getTouchingWord(n,l,!1);c&&9===c.kind&&c.text===i&&s.push(t.nodeEntry(c,!0))}}}(n,a,c)}};var i=function(){function n(t,n,i,r,s,o,a){this.sourceFiles=t,this.isForConstructor=n,this.checker=i,this.cancellationToken=r,this.searchMeaning=s,this.options=o,this.result=a,this.inheritsFromCache=e.createMap(),this.markSeenContainingTypeReference=e.nodeSeenTracker(),this.markSeenReExportRHS=e.nodeSeenTracker(),this.symbolIdToReferences=[],this.sourceFileToSeenSymbols=[]}return n.prototype.getImportSearches=function(e,n){return this.importTracker||(this.importTracker=t.createImportTracker(this.sourceFiles,this.checker,this.cancellationToken)),this.importTracker(e,n,this.options.isForRename)},n.prototype.createSearch=function(t,n,i,r){void 0===r&&(r={});var s=r.text,o=void 0===s?e.stripQuotes(e.unescapeLeadingUnderscores((e.getLocalSymbolForExportDefault(n)||n).escapedName)):s,a=r.allSearchSymbols,l=void 0===a?void 0:a,c=e.escapeLeadingUnderscores(o),u=this.options.implementations&&function(t,n,i){var r=(s=t,e.isRightSideOfPropertyAccess(s)&&s.parent);var s;if(!r)return;var o=i.getTypeAtLocation(r.expression);if(!o)return;if(o.symbol&&96&o.symbol.flags&&o.symbol!==n.parent)return[o.symbol];if(196608&o.flags)return b(o)}(t,n,this.checker);return{location:t,symbol:n,comingFrom:i,text:o,escapedText:c,parents:u,includes:function(t){return l?e.contains(l,t):t===n}}},n.prototype.referenceAdder=function(n,i){var r=e.getSymbolId(n),s=this.symbolIdToReferences[r];return s||(s=this.symbolIdToReferences[r]=[],this.result.push({definition:{type:"symbol",symbol:n,node:i},references:s})),function(e){return s.push(t.nodeEntry(e))}},n.prototype.addStringOrCommentReference=function(e,t){this.result.push({definition:void 0,references:[{type:"span",fileName:e,textSpan:t}]})},n.prototype.markSearchedSymbol=function(t,n){var i=e.getNodeId(t),r=e.getSymbolId(n),s=this.sourceFileToSeenSymbols[i]||(this.sourceFileToSeenSymbols[i]=[]);return!s[r]&&(s[r]=!0)},n}();function r(e,t,n,i){var r=i.getImportSearches(t,n),s=r.importSearches,a=r.singleReferences,l=r.indirectUsers;if(a.length)for(var c=i.referenceAdder(t,e),u=0,d=a;u<d.length;u++){c(d[u])}for(var p=0,h=s;p<h.length;p++){var m=h[p],g=m[0],_=m[1];f(g.getSourceFile(),i.createSearch(g,_,1),i)}if(l.length){var y=void 0;switch(n.exportKind){case 0:y=i.createSearch(e,t,1);break;case 1:y=i.options.isForRename?void 0:i.createSearch(e,t,1,{text:"default"})}if(y)for(var b=0,v=l;b<v.length;b++){o(v[b],y,i)}}}function s(e,t){for(var n=0,i=e.declarations;n<i.length;n++){var r=i[n];f(r.getSourceFile(),t.createSearch(r,e,0),t)}}function o(t,n,i){void 0!==e.getNameTable(t).get(n.escapedText)&&f(t,n,i)}function a(t,n){return e.isArrayLiteralOrObjectLiteralDestructuringPattern(t.parent.parent)&&n.getPropertySymbolOfDestructuringAssignment(t)}function l(t){var n=e.getDeclarationOfKind(t,176);if(n&&174===n.parent.kind&&!n.propertyName)return n}function c(t,n){var i=l(t);if(i){var r=n.getTypeAtLocation(i.parent),s=r&&n.getPropertyOfType(r,i.name.text);return s&&98304&s.flags?(e.Debug.assert(!!(33554432&s.flags)),s.target):s}}function u(t,n,i){void 0===i&&(i=t);var r=[];if(!n||!n.length)return r;for(var s=t.text,o=s.length,a=n.length,l=s.indexOf(n,i.pos);l>=0&&!(l>i.end);){var c=l+a;0!==l&&e.isIdentifierPart(s.charCodeAt(l-1),5)||c!==o&&e.isIdentifierPart(s.charCodeAt(c),5)||r.push(l),l=s.indexOf(n,l+a+1)}return r}function d(n,i){for(var r=[],s=n.getSourceFile(),o=i.text,a=0,l=u(s,o,n);a<l.length;a++){var c=l[a],d=e.getTouchingWord(s,c,!1);d&&(d===i||e.isJumpStatementTarget(d)&&e.getTargetLabel(d,o)===i)&&r.push(t.nodeEntry(d))}return[{definition:{type:"label",node:i},references:r}]}function p(t,n){switch(t.kind){case 71:return t.text.length===n.length;case 9:return(e.isLiteralNameOfPropertyDeclarationOrIndexAccess(t)||function(t){if(9===t.kind)return e.isNameOfModuleDeclaration(t)||e.isExpressionOfExternalModuleImportEqualsDeclaration(t);return!1}(t))&&t.text.length===n.length;case 8:return e.isLiteralNameOfPropertyDeclarationOrIndexAccess(t)&&t.text.length===n.length;case 79:return 7===n.length;default:return!1}}function h(n,i,r,s){for(var o=0,a=u(n,r,n);o<a.length;o++){var l=a[o],c=e.getTouchingPropertyName(n,l,!0);c.kind===i&&s.push(t.nodeEntry(c))}}function f(e,t,n){return n.cancellationToken.throwIfCancellationRequested(),m(e,e,t,n)}function m(e,t,n,i){if(i.markSearchedSymbol(t,n.symbol))for(var r=0,s=u(t,n.text,e);r<s.length;r++){g(t,s[r],n,i)}}function g(n,i,o,l){var u=e.getTouchingPropertyName(n,i,!0);if(p(u,o.text)){if(e.getMeaningFromLocation(u)&l.searchMeaning){var d=l.checker.getSymbolAtLocation(u);if(d){var h=u.parent;if(!e.isImportSpecifier(h)||h.propertyName!==u){if(e.isExportSpecifier(h))return e.Debug.assert(71===u.kind),void function(n,i,o,a,l){var c=o.parent,u=o.propertyName,d=o.name,p=c.parent,h=_(n,i,o,l.checker);if(!a.includes(h))return;u?n===u?(p.moduleSpecifier||g(),!l.options.isForRename&&l.markSeenReExportRHS(d)&&y(d,i,d,l)):l.markSeenReExportRHS(n)&&g():g();if(n!==u||!l.options.isForRename){var f=79===n.originalKeywordKind?1:0,m=t.getExportInfo(i,f,l.checker);e.Debug.assert(!!m),r(n,i,m,l)}1!==a.comingFrom&&p.moduleSpecifier&&!u&&s(l.checker.getExportSpecifierLocalTargetSymbol(o),l);function g(){y(n,h,a.location,l)}}(u,d,h,o,l);var f=function(t,n,i,r){if(t.includes(n))return n;var s=e.getContainingObjectLiteralElement(i);if(s){var o=e.forEach(E(s,r.checker),function(n){return e.find(r.checker.getRootSymbols(n),t.includes)});if(o)return o;var l=a(i,r.checker);if(l&&t.includes(l))return l}var u=c(n,r.checker);if(u){var d=p(u);if(d)return d}return p(n);function p(n){return e.forEach(r.checker.getRootSymbols(n),function(n){if(t.includes(n))return n;if(n.parent&&96&n.parent.flags){if(t.parents&&!e.some(t.parents,function(t){return function(t,n,i,r){var s=64&n.getFlags();return o(t);function o(t){if(t===n)return!0;var r=e.getSymbolId(t)+","+e.getSymbolId(n),o=i.get(r);if(void 0!==o)return o;i.set(r,!1);var l=e.forEach(t.getDeclarations(),function(t){if(e.isClassLike(t)){if(s){var n=e.getClassImplementsHeritageClauseElements(t);if(n)for(var i=0,r=n;i<r.length;i++){if(a(r[i]))return!0}}return a(e.getClassExtendsHeritageClauseElement(t))}return!(230!==t.kind||!s)&&e.forEach(e.getInterfaceBaseTypeNodes(t),a)});return i.set(r,l),l}function a(e){if(e){var t=r.getTypeAtLocation(e);if(t&&t.symbol)return o(t.symbol)}return!1}}(n.parent,t,r.inheritsFromCache,r.checker)}))return;var i=[];return x(n.parent,n.name,i,e.createSymbolTable(),r.checker),e.find(i,t.includes)}})}}(o,d,u,l);f?(l.isForConstructor?function(t,n,i,r){e.isNewExpressionTarget(t)&&y(t,i.symbol,i.location,r);var s=r.referenceAdder(i.symbol,i.location);if(e.isClassLike(t.parent))e.Debug.assert(t.parent.name===t),function(t,n,i){for(var r=0,s=t.members.get("__constructor").declarations;r<s.length;r++){var o=s[r],a=e.findChildOfKind(o,123,n);e.Debug.assert(152===o.kind&&!!a),i(a)}t.exports.forEach(function(t){var n=t.valueDeclaration;if(n&&151===n.kind){var r=n.body;r&&C(r,99,function(t){e.isNewExpressionTarget(t)&&i(t)})}})}(i.symbol,n,s);else{var o=(a=t,e.tryGetClassExtendingExpressionWithTypeArguments(e.climbPastPropertyAccess(a).parent));o&&e.isClassLike(o)&&function(t,n){var i=t.symbol.members.get("__constructor");if(!i)return;for(var r=0,s=i.declarations;r<s.length;r++){var o=s[r];e.Debug.assert(152===o.kind);var a=o.body;a&&C(a,97,function(t){e.isCallExpressionTarget(t)&&n(t)})}}(o,s)}var a}(u,n,o,l):y(u,f,o.location,l),function(e,n,i,o){var a=t.getImportOrExportSymbol(e,n,o.checker,1===i.comingFrom);if(!a)return;var l=a.symbol;0===a.kind?o.options.isForRename&&!a.isNamedImport||s(l,o):r(e,l,a.exportInfo,o)}(u,d,o,l)):function(t,n,i){var r=t.flags,s=t.valueDeclaration,o=i.checker.getShorthandAssignmentValueSymbol(s);33554432&r||!n.includes(o)||y(e.getNameOfDeclaration(s),o,n.location,i)}(d,o,l)}}}}else!l.options.implementations&&(l.options.findInStrings&&e.isInString(n,i)||l.options.findInComments&&e.isInNonReferenceComment(n,i))&&l.addStringOrCommentReference(n.fileName,e.createTextSpan(i,o.text.length))}function _(t,n,i,r){return function(t,n){var i=n.parent,r=n.propertyName,s=n.name;return e.Debug.assert(r===t||s===t),r?r===t:!i.parent.moduleSpecifier}(t,i)?r.getExportSpecifierLocalTargetSymbol(i):n}function y(t,n,i,r){var s=r.referenceAdder(n,i);r.options.implementations?function(t,n,i){if(e.isDeclarationName(t)&&function(t){if(!t)return!1;if(e.isVariableLike(t)){if(t.initializer)return!0;if(226===t.kind){var n=function(t){if(t.parent&&t.parent.parent&&208===t.parent.parent.kind)return e.Debug.assert(227===t.parent.kind),t.parent.parent}(t);return n&&e.hasModifier(n,2)}}else{if(e.isFunctionLike(t))return!!t.body||e.hasModifier(t,2);switch(t.kind){case 229:case 199:case 232:case 233:return!0}}return!1}(t.parent))return void n(t.parent);if(71!==t.kind)return;262===t.parent.kind&&S(t,i.checker,n);var r=v(t);if(r)return void n(r);var s=function(t){var n=void 0;for(;t;)e.isTypeNode(t)&&(n=t),t=t.parent;return n}(t);if(s&&i.markSeenContainingTypeReference(s)){var o=s.parent;if(e.isVariableLike(o)&&o.type===s&&o.initializer&&T(o.initializer))n(o.initializer);else if(e.isFunctionLike(o)&&o.type===s&&o.body){var a=o.body;207===a.kind?e.forEachReturnStatement(a,function(e){e.expression&&T(e.expression)&&n(e.expression)}):T(a)&&n(a)}else e.isAssertionExpression(o)&&T(o.expression)&&n(o.expression)}}(t,s,r):s(t)}function b(e,t){void 0===t&&(t=[]);for(var n=0,i=e.types;n<i.length;n++){var r=i[n];r.symbol&&96&r.symbol.getFlags()&&t.push(r.symbol),196608&r.getFlags()&&b(r,t)}return t}function v(t){if(t&&t.parent){if(201===t.kind&&259===t.parent.kind&&e.isClassLike(t.parent.parent))return t.parent.parent;if(71===t.kind||179===t.kind)return v(t.parent)}}function T(e){switch(e.kind){case 185:return T(e.expression);case 187:case 186:case 178:case 199:case 177:return!0;default:return!1}}function k(t,n,i,r){var s=[t],o=e.getContainingObjectLiteralElement(n);if(o){if(262!==o.kind){var l=a(n,i);l&&s.push(l)}e.forEach(E(o,i),function(t){e.addRange(s,i.getRootSymbols(t))});var u=i.getShorthandAssignmentValueSymbol(n.parent);u&&s.push(u)}t.valueDeclaration&&146===t.valueDeclaration.kind&&e.isParameterPropertyDeclaration(t.valueDeclaration)&&e.addRange(s,i.getSymbolsOfParameterPropertyDeclaration(t.valueDeclaration,t.name));var d=c(t,i);return d&&(s.push(d),p(d)),p(t),s;function p(t){for(var n=0,o=i.getRootSymbols(t);n<o.length;n++){var a=o[n];a!==t&&s.push(a),!r&&a.parent&&96&a.parent.flags&&x(a.parent,a.name,s,e.createSymbolTable(),i)}}}function x(t,n,i,r,s){function o(e){if(e){var o=s.getTypeAtLocation(e);if(o){var a=s.getPropertyOfType(o,n);a&&i.push.apply(i,s.getRootSymbols(a)),r.set(t.escapedName,t),x(o.symbol,n,i,r,s)}}}!t||r.has(t.escapedName)||96&t.flags&&e.forEach(t.getDeclarations(),function(t){e.isClassLike(t)?(o(e.getClassExtendsHeritageClauseElement(t)),e.forEach(e.getClassImplementsHeritageClauseElements(t),o)):230===t.kind&&e.forEach(e.getInterfaceBaseTypeNodes(t),o)})}function E(t,n){var i=t.parent,r=n.getContextualType(i),s=function(t){if(144===t.name.kind){var n=t.name.expression;return e.isStringOrNumericLiteral(n)?n.text:void 0}return e.getTextOfIdentifierOrLiteral(t.name)}(t);if(s&&r){var o=[],a=r.getProperty(s);return a&&o.push(a),65536&r.flags&&e.forEach(r.types,function(e){var t=e.getProperty(s);t&&o.push(t)}),o}}function S(t,n,i){var r=n.getSymbolAtLocation(t),s=n.getShorthandAssignmentValueSymbol(r.valueDeclaration);if(s)for(var o=0,a=s.getDeclarations();o<a.length;o++){var l=a[o];1&e.getMeaningFromDeclaration(l)&&i(l)}}function C(t,n,i){e.forEachChild(t,function(e){e.kind===n&&i(e),C(e,n,i)})}n.getReferenceEntriesForShorthandPropertyAssignment=S}(t.Core||(t.Core={}))}(e.FindAllReferences||(e.FindAllReferences={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,s){var a=[],l=n.getDeclarations(),c=o(t,n,s),u=c.symbolName,d=c.symbolKind,p=c.containerName;return function(t,n,i,r,s,o){if((e.isNewExpressionTarget(n)||123===n.kind)&&32&t.flags){for(var a=0,l=t.getDeclarations();a<l.length;a++){var c=l[a];if(e.isClassLike(c))return h(c.members,!0,i,r,s,o)}e.Debug.fail("Expected declaration to have at least one class-like declaration")}return!1}(n,s,d,u,p,a)||function(t,n,i,r,s,o){if(e.isCallExpressionTarget(n)||e.isNewExpressionTarget(n)||e.isNameOfFunctionDeclaration(n))return h(t.declarations,!1,i,r,s,o);return!1}(n,s,d,u,p,a)||e.forEach(l,function(e){a.push(r(e,d,u,p))}),a;function h(t,n,s,o,a,l){if(!t)return!1;for(var c,u=[],d=0,p=t;d<p.length;d++){var h=p[d];(n?152===h.kind:i(h))&&(u.push(h),h.body&&(c=h))}return!!u.length&&(l.push(r(c||e.lastOrUndefined(u),s,o,a)),!0)}}function i(e){switch(e.kind){case 152:case 228:case 151:case 150:return!0;default:return!1}}function r(t,n,i,r){return s(e.getNameOfDeclaration(t)||t,n,i,r)}function s(t,n,i,r){var s=t.getSourceFile();return{fileName:s.fileName,textSpan:e.createTextSpanFromNode(t,s),kind:n,name:i,containerKind:void 0,containerName:r}}function o(t,n,i){return{symbolName:t.symbolToString(n),symbolKind:e.SymbolDisplay.getSymbolKind(t,n,i),containerName:n.parent?t.symbolToString(n.parent,i):""}}function a(e,t){var n=o(e,t.symbol,t),i=n.symbolName;return r(t,n.symbolKind,i,n.containerName)}function l(e,t){for(var n=0,i=e;n<i.length;n++){var r=i[n];if(r.pos<=t&&t<=r.end)return r}}function c(t,n){return{fileName:n,textSpan:e.createTextSpanFromBounds(0,0),kind:"script",name:t,containerName:void 0,containerKind:void 0}}function u(t){return e.isRightSideOfPropertyAccess(t)?u(t.parent):t}t.getDefinitionAtPosition=function(t,o,d){var p=l(o.referencedFiles,d);if(p&&(h=e.tryResolveScriptReference(t,o,p)))return[c(p.fileName,h.fileName)];var h,f=l(o.typeReferenceDirectives,d);if(f)return(h=t.getResolvedTypeReferenceDirectives().get(f.fileName))&&h.resolvedFileName&&[c(f.fileName,h.resolvedFileName)];var m=e.getTouchingPropertyName(o,d,!0);if(m!==o){if(e.isJumpStatementTarget(m)){var g=m.text,_=e.getTargetLabel(m.parent,g);return _?[s(_,"label",g,void 0)]:void 0}var y=t.getTypeChecker(),b=function(t,n){var r=function(t){var n=u(t),i=n.parent;return i&&e.isCallLikeExpression(i)&&e.getInvokedExpression(i)===n&&i}(n),s=r&&t.getResolvedSignature(r);if(s){var o=s.declaration;if(o&&i(o))return o}return}(y,m);if(b)return[a(y,b)];var v=y.getSymbolAtLocation(m);if(v){if(2097152&v.flags&&function(e,t){if(71!==e.kind)return!1;if(e.parent===t)return!0;switch(t.kind){case 239:case 237:return!0;case 242:return 241===t.parent.kind;default:return!1}}(m,v.declarations[0])){var T=y.getAliasedSymbol(v);T.declarations&&(v=T)}if(262===m.parent.kind){var k=y.getShorthandAssignmentValueSymbol(v.valueDeclaration);if(!k)return[];var x=k.getDeclarations(),E=e.SymbolDisplay.getSymbolKind(y,k,m),S=y.symbolToString(k),C=y.symbolToString(v.parent,m);return e.map(x,function(e){return r(e,E,S,C)})}if(e.isPropertyName(m)&&e.isBindingElement(m.parent)&&e.isObjectBindingPattern(m.parent.parent)&&m===(m.parent.propertyName||m.parent.name)){var w=y.getTypeAtLocation(m.parent.parent);if(w){var I=e.getPropertySymbolsFromType(w,m);if(I)return e.flatMap(I,function(e){return n(y,e,m)})}}var A=e.getContainingObjectLiteralElement(m);return A&&y.getContextualType(A.parent)?e.flatMap(e.getPropertySymbolsFromContextualType(y,A),function(e){return n(y,e,m)}):n(y,v,m)}}},t.getTypeDefinitionAtPosition=function(t,i,r){var s=e.getTouchingPropertyName(i,r,!0);if(s!==i){var o=t.getSymbolAtLocation(s);if(o){var a=t.getTypeOfSymbolAtLocation(o,s);if(a){if(65536&a.flags&&!(16&a.flags)){var l=[];return e.forEach(a.types,function(i){i.symbol&&e.addRange(l,n(t,i.symbol,s))}),l}if(a.symbol)return n(t,a.symbol,s)}}}}}(e.GoToDefinition||(e.GoToDefinition={}))}(ts||(ts={})),function(e){!function(t){var n,i,r=["augments","author","argument","borrows","class","constant","constructor","constructs","default","deprecated","description","event","example","extends","field","fileOverview","function","ignore","inner","lends","link","memberOf","method","name","namespace","param","private","prop","property","public","requires","returns","see","since","static","throws","type","typedef","version"];function s(t,n){if(t)for(var i=0;i<t.length;i++)if(e.indexOf(t,t[i])===i){var r=n(t[i],i);if(r)return r}}function o(t){for(;185===t.kind;)t=t.expression;switch(t.kind){case 186:case 187:return t.parameters;case 199:for(var n=0,i=t.members;n<i.length;n++){var r=i[n];if(152===r.kind)return r.parameters}}return e.emptyArray}t.getJsDocCommentsFromDeclarations=function(t){var n=[];return s(t,function(t){e.forEach(e.getAllJSDocs(t),function(t){t.comment&&(n.length&&n.push(e.lineBreakPart()),n.push(e.textPart(t.comment)))})}),n},t.getJsDocTagsFromDeclarations=function(t){var n=[];return s(t,function(t){for(var i=0,r=e.getJSDocTags(t);i<r.length;i++){var s=r[i];276===s.kind&&n.push({name:s.tagName.text,text:s.comment})}}),n},t.getJSDocTagNameCompletions=function(){return n||(n=e.map(r,function(e){return{name:e,kind:"keyword",kindModifiers:"",sortText:"0"}}))},t.getJSDocTagCompletions=function(){return i||(i=e.map(r,function(e){return{name:"@"+e,kind:"keyword",kindModifiers:"",sortText:"0"}}))},t.getJSDocParameterNameCompletions=function(t){if(!e.isIdentifier(t.name))return e.emptyArray;var n=t.name.text,i=t.parent,r=i.parent;return e.isFunctionLike(r)?e.mapDefined(r.parameters,function(r){if(e.isIdentifier(r.name)){var s=r.name.text;if(!i.tags.some(function(n){return n!==t&&e.isJSDocParameterTag(n)&&e.isIdentifier(n.name)&&n.name.escapedText===s})&&(void 0===n||e.startsWith(s,n)))return{name:s,kind:"parameter",kindModifiers:"",sortText:"0"}}}):[]},t.getDocCommentTemplateAtPosition=function(t,n,i){if(!(e.isInString(n,i)||e.isInComment(n,i)||e.hasDocComment(n,i))){var r=e.getTokenAtPosition(n,i,!1),s=r.getStart();if(r&&!(s<i)){var a=function(t){for(var n=t;n;n=n.parent)switch(n.kind){case 228:case 151:case 152:return{commentOwner:n,parameters:n.parameters};case 229:return{commentOwner:n};case 208:var i=n.declarationList.declarations;return{commentOwner:n,parameters:1===i.length&&i[0].initializer?o(i[0].initializer):void 0};case 265:return;case 233:return 233===n.parent.kind?void 0:{commentOwner:n};case 194:var r=n;if(0===e.getSpecialPropertyAssignmentKind(r))return;return{commentOwner:n,parameters:e.isFunctionLike(r.right)?r.right.parameters:e.emptyArray}}}(r);if(a){var l=a.commentOwner,c=a.parameters;if(!(l.getStart()<i)){var u=n.getLineAndCharacterOfPosition(i),d=n.getLineStarts()[u.line],p=n.text.substr(d,u.character).replace(/\S/i,function(){return" "}),h=e.hasJavaScriptFileExtension(n.fileName),f="";if(c)for(var m=0;m<c.length;m++){var g=c[m].name,_=71===g.kind?g.escapedText:"param"+m;f+=h?p+" * @param {any} "+_+t:p+" * @param "+_+t}var y="/**"+t+p+" * ";return{newText:y+t+f+p+" */"+(s===i?t+p:""),caretOffset:y.length}}}}}}}(e.JsDoc||(e.JsDoc={}))}(ts||(ts={})),function(e){!function(t){t.nodeCoreModuleList=["buffer","querystring","events","http","cluster","zlib","os","https","punycode","repl","readline","vm","child_process","url","dns","net","dgram","fs","path","string_decoder","tls","crypto","stream","util","assert","tty","domain","constants","process","v8","timers","console"];var n=e.arrayToSet(t.nodeCoreModuleList);t.loadSafeList=function(t,n){var i=e.readConfigFile(n,function(e){return t.readFile(e)});return e.createMapFromTemplate(i.config)},t.loadTypesMap=function(t,n){var i=e.readConfigFile(n,function(e){return t.readFile(e)});if(i.config)return e.createMapFromTemplate(i.config.simpleMap)},t.discoverTypings=function(t,i,r,s,o,a,l,c){if(!l||!l.enable)return{cachedTypingPaths:[],newTypingNames:[],filesToWatch:[]};var u=e.createMap();r=e.mapDefined(r,function(t){var n=e.normalizePath(t);if(e.hasJavaScriptFileExtension(n))return n});var d=[];l.include&&T(l.include,"Explicitly included types");var p=l.exclude||[],h=e.arrayToSet(r,e.getDirectoryPath);h.set(s,!0),h.forEach(function(t,n){k(e.combinePaths(n,"package.json"),d),k(e.combinePaths(n,"bower.json"),d),x(e.combinePaths(n,"bower_components"),d),x(e.combinePaths(n,"node_modules"),d)}),function(t){var n=e.mapDefined(t,function(t){if(e.hasJavaScriptFileExtension(t)){var n=e.removeFileExtension(e.getBaseFileName(t.toLowerCase())).replace(/((?:\.|-)min(?=\.|$))|((?:-|\.)\d+)/g,"");return o.get(n)}});n.length&&T(n,"Inferred typings from file names");var r=e.some(t,function(t){return e.fileExtensionIs(t,".jsx")});r&&(i&&i("Inferred 'react' typings due to presence of '.jsx' extension"),v("react"))}(r),c&&T(e.deduplicate(c.map(function(e){return n.has(e)?"node":e})),"Inferred typings from unresolved imports"),a.forEach(function(e,t){u.has(t)&&void 0===u.get(t)&&u.set(t,e)});for(var f=0,m=p;f<m.length;f++){var g=m[f];u.delete(g)&&i&&i("Typing for "+g+" is in exclude list, will be ignored.")}var _=[],y=[];u.forEach(function(e,t){void 0!==e?y.push(e):_.push(t)});var b={cachedTypingPaths:y,newTypingNames:_,filesToWatch:d};return i&&i("Result: "+JSON.stringify(b)),b;function v(e){u.has(e)||u.set(e,void 0)}function T(t,n){i&&i(n+": "+JSON.stringify(t)),e.forEach(t,v)}function k(n,i){if(t.fileExists(n)){i.push(n);var r=e.readConfigFile(n,function(e){return t.readFile(e)}).config;T(e.flatMap([r.dependencies,r.devDependencies,r.optionalDependencies,r.peerDependencies],e.getOwnKeys),"Typing names in '"+n+"' dependencies")}}function x(n,r){if(r.push(n),t.directoryExists(n)){var s=t.readDirectory(n,[".json"],void 0,void 0,2);i&&i("Searching for typing names in "+n+"; all files: "+JSON.stringify(s));for(var o=[],a=0,l=s;a<l.length;a++){var c=l[a],d=e.normalizePath(c),p=e.getBaseFileName(d);if("package.json"===p||"bower.json"===p){var h=e.readConfigFile(d,function(e){return t.readFile(e)}).config;if(("package.json"!==p||!h._requiredBy||0!==e.filter(h._requiredBy,function(e){return"#"===e[0]||"/"===e}).length)&&h.name){var f=h.types||h.typings;if(f){var m=e.getNormalizedAbsolutePath(f,e.getDirectoryPath(d));i&&i("    Package '"+h.name+"' provides its own types."),u.set(h.name,m)}else o.push(h.name)}}}T(o,"    Found package names")}}},function(e){e[e.Ok=0]="Ok",e[e.ScopedPackagesNotSupported=1]="ScopedPackagesNotSupported",e[e.EmptyName=2]="EmptyName",e[e.NameTooLong=3]="NameTooLong",e[e.NameStartsWithDot=4]="NameStartsWithDot",e[e.NameStartsWithUnderscore=5]="NameStartsWithUnderscore",e[e.NameContainsNonURISafeCharacters=6]="NameContainsNonURISafeCharacters"}(t.PackageNameValidationResult||(t.PackageNameValidationResult={}));t.validatePackageName=function(e){return e?e.length>214?3:46===e.charCodeAt(0)?4:95===e.charCodeAt(0)?5:/^@[^/]+\/[^/]+$/.test(e)?1:encodeURIComponent(e)!==e?6:0:2},t.renderPackageNameValidationFailure=function(t,n){switch(t){case 2:return"Package name '"+n+"' cannot be empty";case 3:return"Package name '"+n+"' should be less than 214 characters";case 4:return"Package name '"+n+"' cannot start with '.'";case 5:return"Package name '"+n+"' cannot start with '_'";case 1:return"Package '"+n+"' is scoped and currently is not supported";case 6:return"Package name '"+n+"' contains non URI safe characters";case 0:throw e.Debug.fail();default:e.Debug.assertNever(t)}}}(e.JsTyping||(e.JsTyping={}))}(ts||(ts={})),function(e){!function(t){function n(e,t){switch(e.kind){case 239:case 242:case 237:var n=t.getSymbolAtLocation(e.name),i=t.getAliasedSymbol(n);return n.escapedName!==i.escapedName;default:return!0}}function i(t){e.Debug.assert(t.length>0);for(var n=0,i=t;n<i.length;n++){if(!i[n].isCaseSensitive)return!1}return!0}function r(t,n){if(t){var i=e.getNameOfDeclaration(t);if(i){var r=e.getTextOfIdentifierOrLiteral(i);if(void 0===r)return 144===i.kind&&s(i.expression,n,!0);n.unshift(r)}}return!0}function s(t,n,i){var r=e.getTextOfIdentifierOrLiteral(t);if(void 0!==r)return i&&n.unshift(r),!0;if(179===t.kind){var o=t;return i&&n.unshift(o.name.text),s(o.expression,n,!0)}return!1}function o(t){var n=[],i=e.getNameOfDeclaration(t);if(144!==i.kind||s(i.expression,n,!1)){for(t=e.getContainerNode(t);t;){if(!r(t,n))return;t=e.getContainerNode(t)}return n}}function a(t){e.Debug.assert(t.length>0);for(var n=e.PatternMatchKind.camelCase,i=0,r=t;i<r.length;i++){var s=r[i].kind;s<n&&(n=s)}return n}function l(t,n){return t.matchKind-n.matchKind||e.compareStringsCaseInsensitive(t.name,n.name)||e.compareStrings(t.name,n.name)}function c(t){var n=t.declaration,i=e.getContainerNode(n),r=i&&e.getNameOfDeclaration(i);return{name:t.name,kind:e.getNodeKind(n),kindModifiers:e.getNodeModifiers(n),matchKind:e.PatternMatchKind[t.matchKind],isCaseSensitive:t.isCaseSensitive,fileName:t.fileName,textSpan:e.createTextSpanFromNode(n),containerName:r?r.text:"",containerKind:r?e.getNodeKind(i):""}}t.getNavigateToItems=function(t,r,s,u,d,p){for(var h=e.createPatternMatcher(u),f=[],m=function(t){if(s.throwIfCancellationRequested(),p&&e.fileExtensionIs(t.fileName,".d.ts"))return"continue";e.forEachEntry(t.getNamedDeclarations(),function(e,s){!function(e,t,r,s,l,c){var u=e.getMatchesForLastSegmentOfPattern(t);if(!u)return;for(var d=0,p=r;d<p.length;d++){var h=p[d];if(n(h,s)){var f=u;if(!e.patternContainsDots||(f=e.getMatches(o(h),t))){var m=a(f),g=i(f);c.push({name:t,fileName:l,matchKind:m,isCaseSensitive:g,declaration:h})}}}}(h,s,e,r,t.fileName,f)})},g=0,_=t;g<_.length;g++){m(_[g])}return f.sort(l),void 0!==d&&(f=f.slice(0,d)),f.map(c)}}(e.NavigateTo||(e.NavigateTo={}))}(ts||(ts={})),function(e){!function(t){var n,i,r,s=/\s+/g,o=[],a=[];function l(){i=void 0,n=void 0,o=[],r=void 0,a=[]}function c(e){return e.getText(i)}function u(e){return e.node.kind}function d(e,t){e.children?e.children.push(t):e.children=[t]}function p(t){e.Debug.assert(!o.length);var n={node:t,additionalNodes:void 0,parent:void 0,children:void 0,indent:0};r=n;for(var i=0,s=t.statements;i<s.length;i++){y(s[i])}return g(),e.Debug.assert(!r&&!o.length),n}function h(e){d(r,f(e))}function f(e){return{node:e,additionalNodes:void 0,parent:r,children:void 0,indent:r.indent+1}}function m(e){var t=f(e);d(r,t),o.push(r),r=t}function g(){r.children&&(b(r.children),v(r.children)),r=o.pop()}function _(e,t){m(e),y(t),g()}function y(t){if(n.throwIfCancellationRequested(),t&&!e.isToken(t))switch(t.kind){case 152:var i=t;_(i,i.body);for(var r=0,s=i.parameters;r<s.length;r++){var o=s[r];e.isParameterPropertyDeclaration(o)&&h(o)}break;case 151:case 153:case 154:case 150:e.hasDynamicName(t)||_(t,t.body);break;case 149:case 148:e.hasDynamicName(t)||h(t);break;case 239:var a=t;a.name&&h(a);var l=a.namedBindings;if(l)if(240===l.kind)h(l);else for(var c=0,u=l.elements;c<u.length;c++){h(u[c])}break;case 176:case 226:var d=t,p=d.name,f=d.initializer;e.isBindingPattern(p)?y(p):f&&function(e){switch(e.kind){case 187:case 186:case 199:return!0;default:return!1}}(f)?f.name?y(f):(m(t),e.forEachChild(f,y),g()):_(t,f);break;case 187:case 228:case 186:_(t,t.body);break;case 232:m(t);for(var b=0,v=t.members;b<v.length;b++){N(x=v[b])||h(x)}g();break;case 229:case 199:case 230:m(t);for(var T=0,k=t.members;T<k.length;T++){var x;y(x=k[T])}g();break;case 233:_(t,A(t).body);break;case 246:case 237:case 157:case 155:case 156:case 231:h(t);break;default:e.hasJSDocNodes(t)&&e.forEach(t.jsDoc,function(t){e.forEach(t.tags,function(e){283===e.kind&&h(e)})}),e.forEachChild(t,y)}}function b(t){var n=e.createMap();e.filterMutate(t,function(t){var i=e.getNameOfDeclaration(t.node),r=i&&c(i);if(!r)return!0;var s=n.get(r);if(!s)return n.set(r,t),!0;if(s instanceof Array){for(var o=0,a=s;o<a.length;o++){var l;if(u(l=a[o],t))return!1}return s.push(t),!0}return!u(l=s,t)&&(n.set(r,[l,t]),!0);function u(t,n){return!!function(e,t){return e.kind===t.kind&&(233!==e.kind||n(e,t));function n(e,t){return e.body.kind===t.body.kind&&(233!==e.body.kind||n(e.body,t.body))}}(t.node,n.node)&&(function(t,n){t.additionalNodes=t.additionalNodes||[],t.additionalNodes.push(n.node),n.additionalNodes&&(i=t.additionalNodes).push.apply(i,n.additionalNodes);t.children=e.concatenate(t.children,n.children),t.children&&(b(t.children),v(t.children));var i}(t,n),!0)}})}function v(e){e.sort(T)}function T(t,n){var i=k(t.node),r=k(n.node);if(i&&r){var s=e.compareStringsCaseInsensitive(i,r);return 0!==s?s:u(t)-u(n)}return i?1:r?-1:u(t)-u(n)}function k(t){if(233===t.kind)return I(t);var n=e.getNameOfDeclaration(t);if(n)return e.unescapeLeadingUnderscores(e.getPropertyNameForPropertyNameNode(n));switch(t.kind){case 186:case 187:case 199:return R(t);case 283:return E(t);default:return}}function x(t){if(233===t.kind)return I(t);var n=e.getNameOfDeclaration(t);if(n){var i=c(n);if(i.length>0)return i}switch(t.kind){case 265:var r=t;return e.isExternalModule(r)?'"'+e.escapeString(e.getBaseFileName(e.removeFileExtension(e.normalizePath(r.fileName))))+'"':"<global>";case 187:case 228:case 186:case 229:case 199:return 512&e.getModifierFlags(t)?"default":R(t);case 152:return"constructor";case 156:return"new()";case 155:return"()";case 157:return"[]";case 283:return E(t);default:return"<unknown>"}}function E(e){if(e.name)return e.name.text;var t=e.parent&&e.parent.parent;if(t&&208===t.kind&&t.declarationList.declarations.length>0){var n=t.declarationList.declarations[0].name;if(71===n.kind)return n.text}return"<typedef>"}function S(t){return{text:x(t.node),kind:e.getNodeKind(t.node),kindModifiers:O(t.node),spans:w(t),childItems:e.map(t.children,S)}}function C(t){return{text:x(t.node),kind:e.getNodeKind(t.node),kindModifiers:O(t.node),spans:w(t),childItems:e.map(t.children,function(t){return{text:x(t.node),kind:e.getNodeKind(t.node),kindModifiers:e.getNodeModifiers(t.node),spans:w(t),childItems:a,indent:0,bolded:!1,grayed:!1}})||a,indent:t.indent,bolded:!1,grayed:!1}}function w(e){var t=[D(e.node)];if(e.additionalNodes)for(var n=0,i=e.additionalNodes;n<i.length;n++){var r=i[n];t.push(D(r))}return t}function I(t){if(e.isAmbientModule(t))return e.getTextOfNode(t.name);var n=[];for(n.push(e.getTextOfIdentifierOrLiteral(t.name));t.body&&233===t.body.kind;)t=t.body,n.push(e.getTextOfIdentifierOrLiteral(t.name));return n.join(".")}function A(e){return 233===e.body.kind?A(e.body):e}function N(e){return!e.name||144===e.name.kind}function D(t){return 265===t.kind?e.createTextSpanFromBounds(t.getFullStart(),t.getEnd()):e.createTextSpanFromNode(t,i)}function O(t){return t.parent&&226===t.parent.kind&&(t=t.parent),e.getNodeModifiers(t)}function R(t){return t.name&&e.getFullWidth(t.name)>0?e.declarationNameToString(t.name):226===t.parent.kind?e.declarationNameToString(t.parent.name):194===t.parent.kind&&58===t.parent.operatorToken.kind?c(t.parent.left).replace(s,""):261===t.parent.kind&&t.parent.name?c(t.parent.name):512&e.getModifierFlags(t)?"default":e.isClassLike(t)?"<class>":"<function>"}t.getNavigationBarItems=function(t,r){n=r,i=t;try{return e.map(function(t){var n=[];function i(e){if(r(e)&&(n.push(e),e.children))for(var t=0,s=e.children;t<s.length;t++){i(s[t])}}return i(t),n;function r(t){switch(u(t)){case 229:case 199:case 232:case 230:case 233:case 265:case 231:case 283:return!0;case 152:case 151:case 153:case 154:case 226:return i(t);case 187:case 228:case 186:return n(t);default:return!1}function n(e){if(!e.node.body)return!1;switch(u(e.parent)){case 234:case 265:case 151:case 152:return!0;default:return i(e)}}function i(t){return e.forEach(t.children,function(e){var t=u(e);return 226!==t&&176!==t})}}}(p(t)),C)}finally{l()}},t.getNavigationTree=function(e,t){n=t,i=e;try{return S(p(e))}finally{l()}}}(e.NavigationBar||(e.NavigationBar={}))}(ts||(ts={})),function(e){!function(t){var n="...",i=new RegExp("^\\s*//\\s*#(end)?region(?:\\s+(.*))?$");t.collectElements=function(t,r){var s=[],o=0,a=[];return function i(a){if(r.throwIfCancellationRequested(),o>40)return;e.isDeclaration(a)&&function(n){var i=e.getLeadingCommentRangesOfNode(n,t);if(i){for(var s=-1,o=-1,a=!0,l=0,d=0,p=i;d<p.length;d++){var h=p[d];r.throwIfCancellationRequested(),2===h.kind?(a&&(s=h.pos),a=!1,o=h.end,l++):3===h.kind&&(u(l,s,o),c(h,!1),l=0,o=-1,a=!0)}u(l,s,o)}}(a);switch(a.kind){case 207:if(!e.isFunctionBlock(a)){var p=a.parent,h=e.findChildOfKind(a,17,t),f=e.findChildOfKind(a,18,t);if(212===p.kind||215===p.kind||216===p.kind||214===p.kind||211===p.kind||213===p.kind||220===p.kind||260===p.kind){l(p,h,f,d(a),!0);break}if(224===p.kind){var m=p;if(m.tryBlock===a){l(p,h,f,d(a),!0);break}if(m.finallyBlock===a){var g=e.findChildOfKind(m,87,t);if(g){l(g,h,f,d(a),!0);break}}}var _=e.createTextSpanFromNode(a);s.push({textSpan:_,hintSpan:_,bannerText:n,autoCollapse:d(a)});break}case 234:var y=e.findChildOfKind(a,17,t),b=e.findChildOfKind(a,18,t);l(a.parent,y,b,d(a),!0);break;case 229:case 230:case 232:case 235:l(a,e.findChildOfKind(a,17,t),e.findChildOfKind(a,18,t),d(a),!0);break;case 178:l(a,e.findChildOfKind(a,17,t),e.findChildOfKind(a,18,t),d(a),!e.isArrayLiteralExpression(a.parent));break;case 177:l(a,e.findChildOfKind(a,21,t),e.findChildOfKind(a,22,t),d(a),!e.isArrayLiteralExpression(a.parent))}o++,e.forEachChild(a,i),o--}(t),function(){for(var n=t.getLineStarts(),r=0;r<n.length;r++){var o=n[r],l=n[r+1]-1||t.getEnd(),c=t.text.substring(o,l).match(i);if(c&&!e.isInComment(t,o))if(c[1]){(p=a.pop())&&(p.textSpan.length=l-p.textSpan.start,p.hintSpan.length=l-p.textSpan.start,s.push(p))}else{var u=t.getFullText().indexOf("//",o),d=e.createTextSpanFromBounds(u,l),p={textSpan:d,hintSpan:d,bannerText:c[2]||"#region",autoCollapse:!1};a.push(p)}}}(),s.sort(function(e,t){return e.textSpan.start-t.textSpan.start});function l(i,r,o,a,l){if(i&&r&&o){var c={textSpan:e.createTextSpanFromBounds(l?r.getFullStart():r.getStart(),o.getEnd()),hintSpan:e.createTextSpanFromNode(i,t),bannerText:n,autoCollapse:a};s.push(c)}}function c(t,i){if(t){var r={textSpan:e.createTextSpanFromBounds(t.pos,t.end),hintSpan:e.createTextSpanFromBounds(t.pos,t.end),bannerText:n,autoCollapse:i};s.push(r)}}function u(e,t,n){e>1&&c({kind:2,pos:t,end:n},!1)}function d(t){return e.isFunctionBlock(t)&&187!==t.parent.kind}}}(e.OutliningElementsCollector||(e.OutliningElementsCollector={}))}(ts||(ts={})),function(e){var t;function n(e,t,n,i){return{kind:e,punctuationStripped:t,isCaseSensitive:n,camelCaseWeight:i}}function i(e){return 0===e.subWordTextChunks.length}function r(t){if(t>=65&&t<=90)return!0;if(t<127||!e.isUnicodeIdentifierStart(t,5))return!1;var n=String.fromCharCode(t);return n===n.toUpperCase()}function s(t){if(t>=97&&t<=122)return!0;if(t<127||!e.isUnicodeIdentifierStart(t,5))return!1;var n=String.fromCharCode(t);return n===n.toLowerCase()}function o(e,t,n){for(var i=0;i<t.length;i++){if(a(e.charCodeAt(i+n))!==t.charCodeAt(i))return!1}return!0}function a(e){return e>=65&&e<=90?e-65+97:e<127?e:String.fromCharCode(e).toLowerCase().charCodeAt(0)}function l(e){return e>=48&&e<=57}function c(e){return r(e)||s(e)||l(e)||95===e||36===e}function u(e){for(var t=[],n=0,i=0,r=0;r<e.length;r++){c(e.charCodeAt(r))?(0===i&&(n=r),i++):i>0&&(t.push(d(e.substr(n,i))),i=0)}return i>0&&t.push(d(e.substr(n,i))),t}function d(e){var t=e.toLowerCase();return{text:e,textLowerCase:t,isLowerCase:e===t,characterSpans:p(e)}}function p(e){return f(e,!1)}function h(e){return f(e,!0)}function f(t,n){for(var i=[],r=0,s=1;s<t.length;s++){var o=l(t.charCodeAt(s-1)),a=l(t.charCodeAt(s)),c=y(t,n,s),u=_(t,n,s,r);(m(t.charCodeAt(s-1))||m(t.charCodeAt(s))||o!==a||c||u)&&(g(t,r,s)||i.push(e.createTextSpan(r,s-r)),r=s)}return g(t,r,t.length)||i.push(e.createTextSpan(r,t.length-r)),i}function m(e){switch(e){case 33:case 34:case 35:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 45:case 46:case 47:case 58:case 59:case 63:case 64:case 91:case 92:case 93:case 95:case 123:case 125:return!0}return!1}function g(e,t,n){for(var i=t;i<n;i++){var r=e.charCodeAt(i);if(!m(r)||95===r||36===r)return!1}return!0}function _(e,t,n,i){if(t&&n!==i&&n+1<e.length){var o=r(e.charCodeAt(n)),a=s(e.charCodeAt(n+1));if(o&&a){for(var l=i;l<n;l++)if(!r(e.charCodeAt(l)))return!1;return!0}}return!1}function y(e,t,n){var i=r(e.charCodeAt(n-1)),s=r(e.charCodeAt(n));return t?s&&!i:s}!function(e){e[e.exact=0]="exact",e[e.prefix=1]="prefix",e[e.substring=2]="substring",e[e.camelCase=3]="camelCase"}(t=e.PatternMatchKind||(e.PatternMatchKind={})),e.createPatternMatcher=function(s){var l=e.createMap(),c=(s=s.trim()).split(".").map(function(e){return{totalTextChunk:d(t=e.trim()),subWordTextChunks:u(t)};var t}),p=0===c.length||e.forEach(c,i);return{getMatches:function(t,n){if(f(n))return;var i=_(n,e.lastOrUndefined(c));if(!i)return;if(t=t||[],c.length-1>t.length)return;for(var r=i,s=c.length-2,o=t.length-1;s>=0;s-=1,o-=1){var a=c[s],l=_(t[o],a);if(!l)return;e.addRange(r,l)}return r},getMatchesForLastSegmentOfPattern:function(t){if(f(t))return;return _(t,e.lastOrUndefined(c))},patternContainsDots:c.length>1};function f(e){return p||!e}function m(e){var t=l.get(e);return t||l.set(e,t=h(e)),t}function g(i,s,a){var l=function(e,t){for(var n=e.length-t.length,i=0;i<=n;i++)if(o(e,t,i))return i;return-1}(i,s.textLowerCase);if(0===l)return s.text.length===i.length?n(t.exact,a,i===s.text):n(t.prefix,a,e.startsWith(i,s.text));var c=s.isLowerCase;if(c){if(l>0)for(var u=0,d=m(i);u<d.length;u++){var p=d[u];if(y(i,p,s.text,!0))return n(t.substring,a,y(i,p,s.text,!1))}}else if(i.indexOf(s.text)>0)return n(t.substring,a,!0);if(!c&&s.characterSpans.length>0){var h=m(i),f=b(i,h,s,!1);if(void 0!==f)return n(t.camelCase,a,!0,f);if(void 0!==(f=b(i,h,s,!0)))return n(t.camelCase,a,!1,f)}return c&&s.text.length<i.length&&l>0&&r(i.charCodeAt(l))?n(t.substring,a,!1):void 0}function _(e,t){if(!function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(32===n||42===n)return!0}return!1}(t.totalTextChunk.text)){var n=g(e,t.totalTextChunk,!1);if(n)return[n]}for(var i=void 0,r=0,s=t.subWordTextChunks;r<s.length;r++){var o=g(e,s[r],!0);if(!o)return;(i=i||[]).push(o)}return i}function y(e,t,n,i,r){var s=r?r.start:0,o=r?r.length:n.length;if(o>t.length)return!1;if(i)for(var l=0;l<o;l++){var c=n.charCodeAt(s+l),u=e.charCodeAt(t.start+l);if(a(c)!==a(u))return!1}else for(l=0;l<o;l++){if((c=n.charCodeAt(s+l))!==(u=e.charCodeAt(t.start+l)))return!1}return!0}function b(t,n,i,s){for(var o=i.characterSpans,a=0,l=0,c=void 0,u=void 0;;){if(l===o.length){var d=0;return u&&(d+=1),0===c&&(d+=2),d}if(a===n.length)return;for(var p=n[a],h=!1;l<o.length;l++){var f=o[l];if(h&&(!r(i.text.charCodeAt(o[l-1].start))||!r(i.text.charCodeAt(o[l].start))))break;if(!y(t,p,i.text,s,f))break;h=!0,c=void 0===c?a:c,u=void 0===u||u,p=e.createTextSpan(p.start+f.length,p.length-f.length)}h||void 0===u||(u=!1),a++}}},e.breakIntoCharacterSpans=p,e.breakIntoWordSpans=h}(ts||(ts={})),function(e){e.preProcessFile=function(t,n,i){void 0===n&&(n=!0),void 0===i&&(i=!1);var r,s,o=[],a=[],l=[],c=!1,u=0,d=!1;function p(){var t=e.scanner.scan();return 17===t?u++:18===t&&u--,t}function h(){var t=e.scanner.getTokenValue(),n=e.scanner.getTokenPos();return{fileName:t,pos:n,end:n+t.length}}function f(){l.push(h()),m()}function m(){0===u&&(d=!0)}function g(){var t=e.scanner.getToken();return 124===t&&(128===(t=p())&&9===(t=p())&&(r||(r=[]),r.push({ref:h(),depth:u})),!0)}function _(){var t=e.scanner.getToken();if(91===t){if(19===(t=p())){if(9===(t=p()))return f(),!0}else{if(9===t)return f(),!0;if(71===t||e.isKeyword(t))if(140===(t=p())){if(9===(t=p()))return f(),!0}else if(58===t){if(b(!0))return!0}else{if(26!==t)return!0;t=p()}if(17===t){for(t=p();18!==t&&1!==t;)t=p();18===t&&140===(t=p())&&9===(t=p())&&f()}else 39===t&&118===(t=p())&&(71===(t=p())||e.isKeyword(t))&&140===(t=p())&&9===(t=p())&&f()}return!0}return!1}function y(){var t=e.scanner.getToken();if(84===t){if(m(),17===(t=p())){for(t=p();18!==t&&1!==t;)t=p();18===t&&140===(t=p())&&9===(t=p())&&f()}else if(39===t)140===(t=p())&&9===(t=p())&&f();else if(91===t&&(71===(t=p())||e.isKeyword(t))&&58===(t=p())&&b(!0))return!0;return!0}return!1}function b(t){var n=t?p():e.scanner.getToken();return 132===n&&(19===(n=p())&&9===(n=p())&&f(),!0)}function v(){var t=e.scanner.getToken();if(71===t&&"define"===e.scanner.getTokenValue()){if(19!==(t=p()))return!0;if(9===(t=p())){if(26!==(t=p()))return!0;t=p()}if(21!==t)return!0;for(t=p();22!==t&&1!==t;)9===t&&f(),t=p();return!0}return!1}if(n&&function(){for(e.scanner.setText(t),p();1!==e.scanner.getToken();)g()||_()||y()||i&&(b(!1)||v())||p();e.scanner.setText(void 0)}(),s=e.getLeadingCommentRanges(t,0),e.forEach(s,function(n){var i=t.substring(n.pos,n.end),r=e.getFileReferenceFromReferencePath(i,n);if(r){c=r.isNoDefaultLib;var s=r.fileReference;s&&(r.isTypeReferenceDirective?a:o).push(s)}}),d){if(r)for(var T=0,k=r;T<k.length;T++){var x=k[T];l.push(x.ref)}return{referencedFiles:o,typeReferenceDirectives:a,importedFiles:l,isLibFile:c,ambientExternalModules:void 0}}var E=void 0;if(r)for(var S=0,C=r;S<C.length;S++){0===(x=C[S]).depth?(E||(E=[]),E.push(x.ref.fileName)):l.push(x.ref)}return{referencedFiles:o,typeReferenceDirectives:a,importedFiles:l,isLibFile:c,ambientExternalModules:E}}}(ts||(ts={})),function(e){!function(t){function n(e,t,n,i,s,o){return{canRename:!0,kind:n,displayName:e,localizedErrorMessage:void 0,fullDisplayName:t,kindModifiers:i,triggerSpan:r(s,o)}}function i(t){return{canRename:!1,localizedErrorMessage:e.getLocaleSpecificMessage(t),displayName:void 0,fullDisplayName:void 0,kind:void 0,kindModifiers:void 0,triggerSpan:void 0}}function r(t,n){var i=t.getStart(n),r=t.getWidth(n);return 9===t.kind&&(i+=1,r-=2),e.createTextSpan(i,r)}t.getRenameInfo=function(t,r,s,o,a){var l=e.memoize(function(){return s(e.normalizePath(r))}),c=e.getTouchingWord(o,a,!0);return(c&&function(t){switch(t.kind){case 71:case 9:case 99:return!0;case 8:return e.isLiteralNameOfPropertyDeclarationOrIndexAccess(t);default:return!1}}(c)?function(t,r,s,o){var a=r.getSymbolAtLocation(t);if(a){var l=a.getDeclarations();if(l&&l.length>0){if(e.some(l,o))return i(e.Diagnostics.You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library);if(71===t.kind&&79===t.originalKeywordKind&&1536&a.parent.flags)return;var c=e.stripQuotes(e.getDeclaredName(r,a,t)),u=e.SymbolDisplay.getSymbolKind(r,a,t);return u?n(c,r.getFullyQualifiedName(a),u,e.SymbolDisplay.getSymbolModifiers(a),t,s):void 0}}else if(9===t.kind){return o(t)?i(e.Diagnostics.You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library):n(c=e.stripQuotes(t.text),c,"var","",t,s)}}(c,t,o,function(t){if(!r)return!1;var n=t.getSourceFile(),i=s(e.normalizePath(n.fileName));return i===l()}):void 0)||i(e.Diagnostics.You_cannot_rename_this_element)}}(e.Rename||(e.Rename={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,r){if(e.isCallOrNewExpression(t.parent)){var s=t.parent,o=void 0,a=void 0;if(27===t.kind||19===t.kind)o=function(t,n,i){var r=t.getChildren(i),s=r.indexOf(n);return e.Debug.assert(s>=0&&r.length>s+1),r[s+1]}(s,t,r),e.Debug.assert(void 0!==o),a=0;else{if(!(o=e.findContainingList(t)))return;a=function(e,t){for(var n=0,i=e.getChildren(),r=0,s=i;r<s.length;r++){var o=s[r];if(o===t)break;26!==o.kind&&n++}return n}(o,t)}var l=s.typeArguments&&s.typeArguments.pos===o.pos?0:1,c=function(t){var n=t.getChildren(),i=e.countWhere(n,function(e){return 26!==e.kind});n.length>0&&26===e.lastOrUndefined(n).kind&&i++;return i}(o);0!==a&&e.Debug.assertLessThan(a,c);var u=function(t,n){var i=t.getFullStart(),r=e.skipTrivia(n.text,t.getEnd(),!1);return e.createTextSpan(i,r-i)}(o,r);return{kind:l,invocation:s,argumentsSpan:u,argumentIndex:a,argumentCount:c}}if(13===t.kind&&183===t.parent.kind){if(e.isInsideTemplateLiteral(t,n))return i(t.parent,0,r)}else{if(14===t.kind&&183===t.parent.parent.kind){var d=(p=t.parent).parent;return e.Debug.assert(196===p.kind),i(d,a=e.isInsideTemplateLiteral(t,n)?0:1,r)}if(205===t.parent.kind&&183===t.parent.parent.parent.kind){var p,h=t.parent;d=(p=h.parent).parent;if(e.Debug.assert(196===p.kind),16===t.kind&&!e.isInsideTemplateLiteral(t,n))return;a=function(t,n,i){if(e.Debug.assert(i>=n.getStart(),"Assumed 'position' could not occur before node."),e.isTemplateLiteralKind(n.kind))return e.isInsideTemplateLiteral(n,i)?0:t+2;return t+1}(p.templateSpans.indexOf(h),t,n);return i(d,a,r)}if(t.parent&&e.isJsxOpeningLikeElement(t.parent)){var f=t.parent.attributes.getFullStart(),m=e.skipTrivia(r.text,t.parent.attributes.getEnd(),!1);return{kind:3,invocation:t.parent,argumentsSpan:e.createTextSpan(f,m-f),argumentIndex:0,argumentCount:1}}}}function i(t,n,i){var s=13===t.template.kind?1:t.template.templateSpans.length+1;return 0!==n&&e.Debug.assertLessThan(n,s),{kind:2,invocation:t,argumentsSpan:r(t,i),argumentIndex:n,argumentCount:s}}function r(t,n){var i=t.template,r=i.getStart(),s=i.getEnd();196===i.kind&&(0===e.lastOrUndefined(i.templateSpans).literal.getFullWidth()&&(s=e.skipTrivia(n.text,s,!1)));return e.createTextSpan(r,s-r)}function s(t,i,r){for(var s=t;265!==s.kind;s=s.parent){if(e.isFunctionBlock(s))return;(s.pos<s.parent.pos||s.end>s.parent.end)&&e.Debug.fail("Node of kind "+s.kind+" is not a subspan of its parent of kind "+s.parent.kind);var o=n(s,i,r);if(o)return o}}function o(t,n,i,r){var s=i.argumentCount,o=i.argumentsSpan,a=i.invocation,l=i.argumentIndex,c=0===i.kind,u=e.getInvokedExpression(a),d=r.getSymbolAtLocation(u),p=d&&e.symbolToDisplayParts(r,d,void 0,void 0),h=e.map(t,function(t){var n,i,s=[],o=[];if(p&&e.addRange(s,p),c){i=!1,s.push(e.punctuationPart(27));var l=(t.target||t).typeParameters;n=l&&l.length>0?e.map(l,g):e.emptyArray,o.push(e.punctuationPart(29));var u=e.mapToDisplayParts(function(e){return r.getSymbolDisplayBuilder().buildDisplayForParametersAndDelimiters(t.thisParameter,t.parameters,e,a)});e.addRange(o,u)}else{i=t.hasRestParameter;var d=e.mapToDisplayParts(function(e){return r.getSymbolDisplayBuilder().buildDisplayForTypeParametersAndDelimiters(t.typeParameters,e,a)});e.addRange(s,d),s.push(e.punctuationPart(19)),n=e.map(t.parameters,m),o.push(e.punctuationPart(20))}var h=e.mapToDisplayParts(function(e){return r.getSymbolDisplayBuilder().buildReturnTypeDisplay(t,e,a)});return e.addRange(o,h),{isVariadic:i,prefixDisplayParts:s,suffixDisplayParts:o,separatorDisplayParts:[e.punctuationPart(26),e.spacePart()],parameters:n,documentation:t.getDocumentationComment(),tags:t.getJsDocTags()}});0!==l&&e.Debug.assertLessThan(l,s);var f=t.indexOf(n);return e.Debug.assert(-1!==f),{items:h,applicableSpan:o,selectedItemIndex:f,argumentIndex:l,argumentCount:s};function m(t){var n=e.mapToDisplayParts(function(e){return r.getSymbolDisplayBuilder().buildParameterDisplay(t,e,a)});return{name:t.name,documentation:t.getDocumentationComment(),displayParts:n,isOptional:r.isOptionalParameter(t.valueDeclaration)}}function g(t){var n=e.mapToDisplayParts(function(e){return r.getSymbolDisplayBuilder().buildTypeParameterDisplay(t,e,a)});return{name:t.symbol.name,documentation:e.emptyArray,displayParts:n,isOptional:!1}}}!function(e){e[e.TypeArguments=0]="TypeArguments",e[e.CallArguments=1]="CallArguments",e[e.TaggedTemplateArguments=2]="TaggedTemplateArguments",e[e.JSXAttributesArguments=3]="JSXAttributesArguments"}(t.ArgumentListKind||(t.ArgumentListKind={})),t.getSignatureHelpItems=function(t,n,i,r){var a=t.getTypeChecker(),l=e.findTokenOnLeftOfPosition(n,i);if(l){var c=s(l,i,n);if(c){r.throwIfCancellationRequested();var u=c.invocation,d=[],p=a.getResolvedSignature(u,d,c.argumentCount);return r.throwIfCancellationRequested(),d.length?o(d,p,c,a):e.isSourceFileJavaScript(n)?function(e,t){if(181!==e.invocation.kind)return;var n=e.invocation,i=n.expression,r=71===i.kind?i:179===i.kind?i.name:void 0;if(!r||!r.escapedText)return;for(var s=t.getTypeChecker(),a=0,l=t.getSourceFiles();a<l.length;a++){var c=l[a].getNamedDeclarations().get(r.text);if(c)for(var u=0,d=c;u<d.length;u++){var p=d[u],h=p.symbol;if(h){var f=s.getTypeOfSymbolAtLocation(h,p);if(f){var m=f.getCallSignatures();if(m&&m.length)return o(m,m[0],e,s)}}}}}(c,t):void 0}}},t.getImmediatelyContainingArgumentInfo=n,t.getContainingArgumentInfo=s}(e.SignatureHelp||(e.SignatureHelp={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,r){var s=e.getCombinedLocalAndExportSymbolFlags(n);if(32&s)return e.getDeclarationOfKind(n,199)?"local class":"class";if(384&s)return"enum";if(524288&s)return"type";if(64&s)return"interface";if(262144&s)return"type parameter";var o=i(t,n,r);if(""===o){if(262144&s)return"type parameter";if(8&s)return"enum member";if(2097152&s)return"alias";if(1536&s)return"module"}return o}function i(t,n,i){if(t.isUndefinedSymbol(n))return"var";if(t.isArgumentsSymbol(n))return"local var";if(99===i.kind&&e.isExpression(i))return"parameter";var s=e.getCombinedLocalAndExportSymbolFlags(n);if(3&s)return e.isFirstDeclarationOfSymbolParameter(n)?"parameter":n.valueDeclaration&&e.isConst(n.valueDeclaration)?"const":e.forEach(n.declarations,e.isLet)?"let":r(n)?"local var":"var";if(16&s)return r(n)?"local function":"function";if(32768&s)return"getter";if(65536&s)return"setter";if(8192&s)return"method";if(16384&s)return"constructor";if(4&s){if(33554432&s&&6&n.checkFlags){var o=e.forEach(t.getRootSymbols(n),function(t){var n=t.getFlags();if(98311&n)return"property";e.Debug.assert(!!(8208&n))});return o||(t.getTypeOfSymbolAtLocation(n,i).getCallSignatures().length?"method":"property")}return i.parent&&e.isJsxAttribute(i.parent)?"JSX attribute":"property"}return""}function r(t){return!t.parent&&e.forEach(t.declarations,function(t){if(186===t.kind)return!0;if(226!==t.kind&&228!==t.kind)return!1;for(var n=t.parent;!e.isFunctionBlock(n);n=n.parent)if(265===n.kind||234===n.kind)return!1;return!0})}t.getSymbolKind=n,t.getSymbolModifiers=function(t){return t&&t.declarations&&t.declarations.length>0?e.getNodeModifiers(t.declarations[0]):""},t.getSymbolDisplayPartsDocumentationAndSymbolKind=function(t,r,s,o,a,l){void 0===l&&(l=e.getMeaningFromLocation(a));var c,u,d,p,h=[],f=e.getCombinedLocalAndExportSymbolFlags(r),m=i(t,r,a),g=99===a.kind&&e.isExpression(a);if(""!==m||32&f||2097152&f){"getter"!==m&&"setter"!==m||(m="property");var _=void 0;if(p=g?t.getTypeAtLocation(a):t.getTypeOfSymbolAtLocation(r.exportSymbol||r,a),a.parent&&179===a.parent.kind){var y=a.parent.name;(y===a||y&&0===y.getFullWidth())&&(a=a.parent)}var b=void 0;if(e.isCallOrNewExpression(a)?b=a:(e.isCallExpressionTarget(a)||e.isNewExpressionTarget(a)||a.parent&&e.isJsxOpeningLikeElement(a.parent)&&e.isFunctionLike(r.valueDeclaration))&&(b=a.parent),b){_=t.getResolvedSignature(b,[]);var v=182===b.kind||e.isCallExpression(b)&&97===b.expression.kind,T=v?p.getConstructSignatures():p.getCallSignatures();if(e.contains(T,_.target)||e.contains(T,_)||(_=T.length?T[0]:void 0),_){switch(v&&32&f?(m="constructor",P(p.symbol,m)):2097152&f?(M(m="alias"),h.push(e.spacePart()),v&&(h.push(e.keywordPart(94)),h.push(e.spacePart())),L(r)):P(r,m),m){case"JSX attribute":case"property":case"var":case"const":case"let":case"parameter":case"local var":h.push(e.punctuationPart(56)),h.push(e.spacePart()),v&&(h.push(e.keywordPart(94)),h.push(e.spacePart())),32768&p.flags&&16&p.objectFlags||!p.symbol||e.addRange(h,e.symbolToDisplayParts(t,p.symbol,o,void 0,1)),F(_,T,16);break;default:F(_,T)}d=!0}}else if(e.isNameOfFunctionDeclaration(a)&&!(98304&f)||123===a.kind&&152===a.parent.kind){var k=a.parent,x=e.find(r.declarations,function(e){return e===(123===a.kind?k.parent:k)});if(x){T=152===k.kind?p.getNonNullableType().getConstructSignatures():p.getNonNullableType().getCallSignatures();_=t.isImplementationOfOverload(k)?T[0]:t.getSignatureFromDeclaration(k),152===k.kind?(m="constructor",P(p.symbol,m)):P(155!==k.kind||2048&p.symbol.flags||4096&p.symbol.flags?r:p.symbol,m),F(_,T),d=!0}}}if(32&f&&!d&&!g&&(e.getDeclarationOfKind(r,199)?M("local class"):h.push(e.keywordPart(75)),h.push(e.spacePart()),L(r),B(r,s)),64&f&&2&l&&(O(),h.push(e.keywordPart(109)),h.push(e.spacePart()),L(r),B(r,s)),524288&f&&(O(),h.push(e.keywordPart(138)),h.push(e.spacePart()),L(r),B(r,s),h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),e.addRange(h,e.typeToDisplayParts(t,t.getDeclaredTypeOfSymbol(r),o,1024))),384&f&&(O(),e.forEach(r.declarations,e.isConstEnumDeclaration)&&(h.push(e.keywordPart(76)),h.push(e.spacePart())),h.push(e.keywordPart(83)),h.push(e.spacePart()),L(r)),1536&f){O();var E=(N=e.getDeclarationOfKind(r,233))&&N.name&&71===N.name.kind;h.push(e.keywordPart(E?129:128)),h.push(e.spacePart()),L(r)}if(262144&f&&2&l)if(O(),h.push(e.punctuationPart(19)),h.push(e.textPart("type parameter")),h.push(e.punctuationPart(20)),h.push(e.spacePart()),L(r),r.parent)R(),L(r.parent,o),B(r.parent,o);else{var S=e.getDeclarationOfKind(r,145);if(e.Debug.assert(void 0!==S),N=S.parent)if(e.isFunctionLikeKind(N.kind)){R();_=t.getSignatureFromDeclaration(N);156===N.kind?(h.push(e.keywordPart(94)),h.push(e.spacePart())):155!==N.kind&&N.name&&L(N.symbol),e.addRange(h,e.signatureToDisplayParts(t,_,s,64))}else 231===N.kind&&(R(),h.push(e.keywordPart(138)),h.push(e.spacePart()),L(N.symbol),B(N.symbol,s))}if(8&f&&(m="enum member",P(r,"enum member"),264===(N=r.declarations[0]).kind)){var C=t.getConstantValue(N);void 0!==C&&(h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),h.push(e.displayPart(e.getTextOfConstantValue(C),"number"==typeof C?e.SymbolDisplayPartKind.numericLiteral:e.SymbolDisplayPartKind.stringLiteral)))}if(2097152&f){switch(O(),r.declarations[0].kind){case 236:h.push(e.keywordPart(84)),h.push(e.spacePart()),h.push(e.keywordPart(129));break;case 243:h.push(e.keywordPart(84)),h.push(e.spacePart()),h.push(e.keywordPart(r.declarations[0].isExportEquals?58:79));break;default:h.push(e.keywordPart(91))}h.push(e.spacePart()),L(r),e.forEach(r.declarations,function(n){if(237===n.kind){var i=n;if(e.isExternalModuleImportEqualsDeclaration(i))h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),h.push(e.keywordPart(132)),h.push(e.punctuationPart(19)),h.push(e.displayPart(e.getTextOfNode(e.getExternalModuleImportEqualsDeclarationExpression(i)),e.SymbolDisplayPartKind.stringLiteral)),h.push(e.punctuationPart(20));else{var r=t.getSymbolAtLocation(i.moduleReference);r&&(h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),L(r,o))}return!0}})}if(!d)if(""!==m){if(p)if(g?(O(),h.push(e.keywordPart(99))):P(r,m),"property"===m||"JSX attribute"===m||3&f||"local var"===m||g)if(h.push(e.punctuationPart(56)),h.push(e.spacePart()),p.symbol&&262144&p.symbol.flags){var w=e.mapToDisplayParts(function(e){t.getSymbolDisplayBuilder().buildTypeParameterDisplay(p,e,o)});e.addRange(h,w)}else e.addRange(h,e.typeToDisplayParts(t,p,o));else if(16&f||8192&f||16384&f||131072&f||98304&f||"method"===m){(T=p.getNonNullableType().getCallSignatures()).length&&F(T[0],T)}}else m=n(t,r,a);if(!c&&(c=r.getDocumentationComment(),u=r.getJsDocTags(),0===c.length&&4&f&&r.parent&&e.forEach(r.parent.declarations,function(e){return 265===e.kind})))for(var I=0,A=r.declarations;I<A.length;I++){var N;if((N=A[I]).parent&&194===N.parent.kind){var D=t.getSymbolAtLocation(N.parent.right);if(D&&(c=D.getDocumentationComment(),u=D.getJsDocTags(),c.length>0))break}}return{displayParts:h,documentation:c,symbolKind:m,tags:u};function O(){h.length&&h.push(e.lineBreakPart())}function R(){h.push(e.spacePart()),h.push(e.keywordPart(92)),h.push(e.spacePart())}function L(n,i){var r=e.symbolToDisplayParts(t,n,i||s,void 0,3);e.addRange(h,r)}function P(t,n){O(),n&&(M(n),h.push(e.spacePart()),L(t))}function M(t){switch(t){case"var":case"function":case"let":case"const":case"constructor":return void h.push(e.textOrKeywordPart(t));default:return h.push(e.punctuationPart(19)),h.push(e.textOrKeywordPart(t)),void h.push(e.punctuationPart(20))}}function F(n,i,r){e.addRange(h,e.signatureToDisplayParts(t,n,o,64|r)),i.length>1&&(h.push(e.spacePart()),h.push(e.punctuationPart(19)),h.push(e.operatorPart(37)),h.push(e.displayPart((i.length-1).toString(),e.SymbolDisplayPartKind.numericLiteral)),h.push(e.spacePart()),h.push(e.textPart(2===i.length?"overload":"overloads")),h.push(e.punctuationPart(20))),c=n.getDocumentationComment(),u=n.getJsDocTags()}function B(n,i){var r=e.mapToDisplayParts(function(e){t.getSymbolDisplayBuilder().buildTypeParameterDisplayFromSymbol(n,e,i)});e.addRange(h,r)}}}(e.SymbolDisplay||(e.SymbolDisplay={}))}(ts||(ts={})),function(e){function t(t,n){var r=[],s=n.compilerOptions?i(n.compilerOptions,r):e.getDefaultCompilerOptions();s.isolatedModules=!0,s.suppressOutputPathCheck=!0,s.allowNonTsExtensions=!0,s.noLib=!0,s.lib=void 0,s.types=void 0,s.noEmit=void 0,s.noEmitOnError=void 0,s.paths=void 0,s.rootDirs=void 0,s.declaration=void 0,s.declarationDir=void 0,s.out=void 0,s.outFile=void 0,s.noResolve=!0;var o=n.fileName||(s.jsx?"module.tsx":"module.ts"),a=e.createSourceFile(o,t,s.target);n.moduleName&&(a.moduleName=n.moduleName),n.renamedDependencies&&(a.renamedDependencies=e.createMapFromTemplate(n.renamedDependencies));var l,c,u=e.getNewLineCharacter(s),d={getSourceFile:function(t){return t===e.normalizePath(o)?a:void 0},writeFile:function(t,n){e.fileExtensionIs(t,".map")?(e.Debug.assertEqual(c,void 0,"Unexpected multiple source map outputs, file:",t),c=n):(e.Debug.assertEqual(l,void 0,"Unexpected multiple outputs, file:",t),l=n)},getDefaultLibFileName:function(){return"lib.d.ts"},useCaseSensitiveFileNames:function(){return!1},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return""},getNewLine:function(){return u},fileExists:function(e){return e===o},readFile:function(){return""},directoryExists:function(){return!0},getDirectories:function(){return[]}},p=e.createProgram([o],s,d);return n.reportDiagnostics&&(e.addRange(r,p.getSyntacticDiagnostics(a)),e.addRange(r,p.getOptionsDiagnostics())),p.emit(void 0,void 0,void 0,void 0,n.transformers),e.Debug.assert(void 0!==l,"Output generation failed"),{outputText:l,diagnostics:r,sourceMapText:c}}var n;function i(t,i){n=n||e.filter(e.optionDeclarations,function(t){return"object"==typeof t.type&&!e.forEachEntry(t.type,function(e){return"number"!=typeof e})}),t=e.cloneCompilerOptions(t);for(var r=function(n){if(!e.hasProperty(t,n.name))return"continue";var r=t[n.name];e.isString(r)?t[n.name]=e.parseCustomTypeOption(n,r,i):e.forEachEntry(n.type,function(e){return e===r})||i.push(e.createCompilerDiagnosticForInvalidCustomType(n))},s=0,o=n;s<o.length;s++){r(o[s])}return t}e.transpileModule=t,e.transpile=function(n,i,r,s,o){var a=t(n,{compilerOptions:i,fileName:r,reportDiagnostics:!!s,moduleName:o});return e.addRange(s,a.diagnostics),a.outputText},e.fixupCompilerOptions=i}(ts||(ts={})),function(e){!function(t){var n,i=e.createScanner(5,!1,0),r=e.createScanner(5,!1,1);!function(e){e[e.Scan=0]="Scan",e[e.RescanGreaterThanToken=1]="RescanGreaterThanToken",e[e.RescanSlashToken=2]="RescanSlashToken",e[e.RescanTemplateToken=3]="RescanTemplateToken",e[e.RescanJsxIdentifier=4]="RescanJsxIdentifier",e[e.RescanJsxText=5]="RescanJsxText"}(n||(n={})),t.getFormattingScanner=function(t,n,s,o,a){var l=1===n?r:i;l.setText(t),l.setTextPos(s);var c,u,d,p,h,f=!0,m=a({advance:function(){h=void 0,l.getStartPos()!==s?f=u&&4===e.lastOrUndefined(u).kind:l.scan();c=void 0,u=void 0;var t=l.getStartPos();for(;t<o;){var n=l.getToken();if(!e.isTrivia(n))break;l.scan();var i={pos:t,end:l.getStartPos(),kind:n};t=l.getStartPos(),c=e.append(c,i)}d=l.getStartPos()},readTokenInfo:function(t){e.Debug.assert(g());var n=function(e){switch(e.kind){case 31:case 66:case 67:case 47:case 46:return!0}return!1}(t)?1:(r=t,12===r.kind?2:function(e){return 15===e.kind||16===e.kind}(t)?3:function(t){if(t.parent)switch(t.parent.kind){case 253:case 251:case 252:case 250:return e.isKeyword(t.kind)||71===t.kind}return!1}(t)?4:(i=t,10===i.kind?5:0));var i;var r;if(h&&n===p)return _(h,t);l.getStartPos()!==d&&(e.Debug.assert(void 0!==h),l.setTextPos(d),l.scan());var s=function(t,n){var i=l.getToken();switch(p=0,n){case 1:if(29===i){p=1;var r=l.reScanGreaterToken();return e.Debug.assert(t.kind===r),r}break;case 2:if(41===(s=i)||63===s){p=2;r=l.reScanSlashToken();return e.Debug.assert(t.kind===r),r}break;case 3:if(18===i)return p=3,l.reScanTemplateToken();break;case 4:return p=4,l.scanJsxIdentifier();case 5:return p=5,l.reScanJsxToken();case 0:break;default:e.Debug.assertNever(n)}var s;return i}(t,n),a={pos:l.getStartPos(),end:l.getTextPos(),kind:s};u&&(u=void 0);for(;l.getStartPos()<o&&(s=l.scan(),e.isTrivia(s));){var f={pos:l.getStartPos(),end:l.getTextPos(),kind:s};if(u||(u=[]),u.push(f),4===s){l.scan();break}}return _(h={leadingTrivia:c,trailingTrivia:u,token:a},t)},isOnToken:g,getCurrentLeadingTrivia:function(){return c},lastTrailingTriviaWasNewLine:function(){return f},skipToEndOf:function(e){l.setTextPos(e.end),d=l.getStartPos(),p=void 0,h=void 0,f=!1,c=void 0,u=void 0}});return h=void 0,l.setText(void 0),m;function g(){var t=h?h.token.kind:l.getToken();return(h?h.token.pos:l.getStartPos())<o&&1!==t&&!e.isTrivia(t)}function _(t,n){return e.isToken(n)&&t.token.kind!==n.kind&&(t.token.kind=n.kind),t}}}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function t(e,t,n){this.sourceFile=e,this.formattingRequestKind=t,this.options=n}return t.prototype.updateContext=function(t,n,i,r,s){e.Debug.assert(void 0!==t,"currentTokenSpan is null"),e.Debug.assert(void 0!==n,"currentTokenParent is null"),e.Debug.assert(void 0!==i,"nextTokenSpan is null"),e.Debug.assert(void 0!==r,"nextTokenParent is null"),e.Debug.assert(void 0!==s,"commonParent is null"),this.currentTokenSpan=t,this.currentTokenParent=n,this.nextTokenSpan=i,this.nextTokenParent=r,this.contextNode=s,this.contextNodeAllOnSameLine=void 0,this.nextNodeAllOnSameLine=void 0,this.tokensAreOnSameLine=void 0,this.contextNodeBlockIsOnOneLine=void 0,this.nextNodeBlockIsOnOneLine=void 0},t.prototype.ContextNodeAllOnSameLine=function(){return void 0===this.contextNodeAllOnSameLine&&(this.contextNodeAllOnSameLine=this.NodeIsOnOneLine(this.contextNode)),this.contextNodeAllOnSameLine},t.prototype.NextNodeAllOnSameLine=function(){return void 0===this.nextNodeAllOnSameLine&&(this.nextNodeAllOnSameLine=this.NodeIsOnOneLine(this.nextTokenParent)),this.nextNodeAllOnSameLine},t.prototype.TokensAreOnSameLine=function(){if(void 0===this.tokensAreOnSameLine){var e=this.sourceFile.getLineAndCharacterOfPosition(this.currentTokenSpan.pos).line,t=this.sourceFile.getLineAndCharacterOfPosition(this.nextTokenSpan.pos).line;this.tokensAreOnSameLine=e===t}return this.tokensAreOnSameLine},t.prototype.ContextNodeBlockIsOnOneLine=function(){return void 0===this.contextNodeBlockIsOnOneLine&&(this.contextNodeBlockIsOnOneLine=this.BlockIsOnOneLine(this.contextNode)),this.contextNodeBlockIsOnOneLine},t.prototype.NextNodeBlockIsOnOneLine=function(){return void 0===this.nextNodeBlockIsOnOneLine&&(this.nextNodeBlockIsOnOneLine=this.BlockIsOnOneLine(this.nextTokenParent)),this.nextNodeBlockIsOnOneLine},t.prototype.NodeIsOnOneLine=function(e){return this.sourceFile.getLineAndCharacterOfPosition(e.getStart(this.sourceFile)).line===this.sourceFile.getLineAndCharacterOfPosition(e.getEnd()).line},t.prototype.BlockIsOnOneLine=function(t){var n=e.findChildOfKind(t,17,this.sourceFile),i=e.findChildOfKind(t,18,this.sourceFile);return!(!n||!i)&&this.sourceFile.getLineAndCharacterOfPosition(n.getEnd()).line===this.sourceFile.getLineAndCharacterOfPosition(i.getStart(this.sourceFile)).line},t}();t.FormattingContext=n}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){!function(e){e[e.FormatDocument=0]="FormatDocument",e[e.FormatSelection=1]="FormatSelection",e[e.FormatOnEnter=2]="FormatOnEnter",e[e.FormatOnSemicolon=3]="FormatOnSemicolon",e[e.FormatOnOpeningCurlyBrace=4]="FormatOnOpeningCurlyBrace",e[e.FormatOnClosingCurlyBrace=5]="FormatOnClosingCurlyBrace"}(e.FormattingRequestKind||(e.FormattingRequestKind={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(e,t,n){void 0===n&&(n=0),this.Descriptor=e,this.Operation=t,this.Flag=n};e.Rule=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){!function(e){e[e.Ignore=1]="Ignore",e[e.Space=2]="Space",e[e.NewLine=4]="NewLine",e[e.Delete=8]="Delete"}(e.RuleAction||(e.RuleAction={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(){function t(e,t){this.LeftTokenRange=e,this.RightTokenRange=t}return t.prototype.toString=function(){return"[leftRange="+this.LeftTokenRange+",rightRange="+this.RightTokenRange+"]"},t.create1=function(n,i){return t.create4(e.Shared.TokenRange.FromToken(n),e.Shared.TokenRange.FromToken(i))},t.create2=function(n,i){return t.create4(n,e.Shared.TokenRange.FromToken(i))},t.create3=function(n,i){return t.create4(e.Shared.TokenRange.FromToken(n),i)},t.create4=function(e,n){return new t(e,n)},t}();e.RuleDescriptor=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){!function(e){e[e.None=0]="None",e[e.CanDeleteNewLines=1]="CanDeleteNewLines"}(e.RuleFlags||(e.RuleFlags={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(){function t(e,t){this.Context=e,this.Action=t}return t.prototype.toString=function(){return"[context="+this.Context+",action="+this.Action+"]"},t.create1=function(n){return t.create2(e.RuleOperationContext.Any,n)},t.create2=function(e,n){return new t(e,n)},t}();e.RuleOperation=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.customContextChecks=e}return e.prototype.IsAny=function(){return this===e.Any},e.prototype.InContext=function(e){if(this.IsAny())return!0;for(var t=0,n=this.customContextChecks;t<n.length;t++){if(!(0,n[t])(e))return!1}return!0},e.Any=new e,e}();e.RuleOperationContext=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function n(){if(this.IgnoreBeforeComment=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.Comments),t.RuleOperation.create1(1)),this.IgnoreAfterLineComment=new t.Rule(t.RuleDescriptor.create3(2,t.Shared.TokenRange.Any),t.RuleOperation.create1(1)),this.NoSpaceBeforeSemicolon=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,25),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeColon=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,56),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.NoSpaceBeforeQuestionMark=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,55),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.SpaceAfterColon=new t.Rule(t.RuleDescriptor.create3(56,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),2)),this.SpaceAfterQuestionMarkInConditionalOperator=new t.Rule(t.RuleDescriptor.create3(55,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsConditionalOperatorContext),2)),this.NoSpaceAfterQuestionMark=new t.Rule(t.RuleDescriptor.create3(55,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterSemicolon=new t.Rule(t.RuleDescriptor.create3(25,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterCloseBrace=new t.Rule(t.RuleDescriptor.create3(18,t.Shared.TokenRange.FromRange(0,142,[20])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsAfterCodeBlockContext),2)),this.SpaceBetweenCloseBraceAndElse=new t.Rule(t.RuleDescriptor.create1(18,82),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenCloseBraceAndWhile=new t.Rule(t.RuleDescriptor.create1(18,106),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterCloseBrace=new t.Rule(t.RuleDescriptor.create3(18,t.Shared.TokenRange.FromTokens([22,26,25])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeDot=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,23),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterDot=new t.Rule(t.RuleDescriptor.create3(23,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeOpenBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.AnyExcept(120),21),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterCloseBracket=new t.Rule(t.RuleDescriptor.create3(22,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBeforeBlockInFunctionDeclarationContext),8)),this.FunctionOpenBraceLeftTokenRange=t.Shared.TokenRange.AnyIncludingMultilineComments,this.SpaceBeforeOpenBraceInFunction=new t.Rule(t.RuleDescriptor.create2(this.FunctionOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForFunctions"),n.IsFunctionDeclContext,n.IsBeforeBlockContext,n.IsNotFormatOnEnter,n.IsSameLineTokenOrBeforeBlockContext),2),1),this.TypeScriptOpenBraceLeftTokenRange=t.Shared.TokenRange.FromTokens([71,3,75,84,91]),this.SpaceBeforeOpenBraceInTypeScriptDeclWithBlock=new t.Rule(t.RuleDescriptor.create2(this.TypeScriptOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForFunctions"),n.IsTypeScriptDeclWithBlockContext,n.IsNotFormatOnEnter,n.IsSameLineTokenOrBeforeBlockContext),2),1),this.ControlOpenBraceLeftTokenRange=t.Shared.TokenRange.FromTokens([20,3,81,102,87,82]),this.SpaceBeforeOpenBraceInControl=new t.Rule(t.RuleDescriptor.create2(this.ControlOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForControlBlocks"),n.IsControlDeclContext,n.IsNotFormatOnEnter,n.IsSameLineTokenOrBeforeBlockContext),2),1),this.SpaceAfterOpenBrace=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsBraceWrappedContext),2)),this.SpaceBeforeCloseBrace=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsBraceWrappedContext),2)),this.NoSpaceAfterOpenBrace=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseBrace=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBetweenEmptyBraceBrackets=new t.Rule(t.RuleDescriptor.create1(17,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsObjectContext),8)),this.NewLineAfterOpenBraceInBlockContext=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsMultilineBlockContext),4)),this.NewLineBeforeCloseBraceInBlockContext=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.AnyIncludingMultilineComments,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsMultilineBlockContext),4)),this.NoSpaceAfterUnaryPrefixOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.UnaryPrefixOperators,t.Shared.TokenRange.UnaryPrefixExpressions),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.NoSpaceAfterUnaryPreincrementOperator=new t.Rule(t.RuleDescriptor.create3(43,t.Shared.TokenRange.UnaryPreincrementExpressions),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterUnaryPredecrementOperator=new t.Rule(t.RuleDescriptor.create3(44,t.Shared.TokenRange.UnaryPredecrementExpressions),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeUnaryPostincrementOperator=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.UnaryPostincrementExpressions,43),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeUnaryPostdecrementOperator=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.UnaryPostdecrementExpressions,44),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterPostincrementWhenFollowedByAdd=new t.Rule(t.RuleDescriptor.create1(43,37),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterAddWhenFollowedByUnaryPlus=new t.Rule(t.RuleDescriptor.create1(37,37),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterAddWhenFollowedByPreincrement=new t.Rule(t.RuleDescriptor.create1(37,43),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterPostdecrementWhenFollowedBySubtract=new t.Rule(t.RuleDescriptor.create1(44,38),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterSubtractWhenFollowedByUnaryMinus=new t.Rule(t.RuleDescriptor.create1(38,38),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterSubtractWhenFollowedByPredecrement=new t.Rule(t.RuleDescriptor.create1(38,44),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.NoSpaceBeforeComma=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,26),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterCertainKeywords=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([104,100,94,80,96,103,121]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterNewKeywordOnConstructorSignature=new t.Rule(t.RuleDescriptor.create1(94,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsConstructorSignatureContext),8)),this.SpaceAfterLetConstInVariableDeclaration=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([110,76]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsStartOfVariableDeclarationList),2)),this.NoSpaceBeforeOpenParenInFuncCall=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsFunctionCallOrNewContext,n.IsPreviousTokenNotComma),8)),this.SpaceAfterFunctionInFuncDecl=new t.Rule(t.RuleDescriptor.create3(89,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclContext),2)),this.SpaceBeforeOpenParenInFuncDecl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceBeforeFunctionParenthesis"),n.IsNonJsxSameLineTokenContext,n.IsFunctionDeclContext),2)),this.NoSpaceBeforeOpenParenInFuncDecl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceBeforeFunctionParenthesis"),n.IsNonJsxSameLineTokenContext,n.IsFunctionDeclContext),8)),this.SpaceAfterVoidOperator=new t.Rule(t.RuleDescriptor.create3(105,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsVoidOpContext),2)),this.NoSpaceBetweenReturnAndSemicolon=new t.Rule(t.RuleDescriptor.create1(96,25),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceBetweenStatements=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([20,81,82,73]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNonJsxElementContext,n.IsNotForContext),2)),this.SpaceAfterTryFinally=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.FromTokens([102,87]),17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterGetSetInMember=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.FromTokens([125,135]),71),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclContext),2)),this.SpaceBeforeBinaryKeywordOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.BinaryKeywordOperators),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterBinaryKeywordOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.BinaryKeywordOperators,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterConstructor=new t.Rule(t.RuleDescriptor.create1(123,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterConstructor"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterConstructor=new t.Rule(t.RuleDescriptor.create1(123,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterConstructor"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterModuleImport=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.FromTokens([128,132]),19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterCertainTypeScriptKeywords=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([117,75,124,79,83,84,85,125,108,91,109,128,129,112,114,113,131,135,115,138,140,127]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCertainTypeScriptKeywords=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([85,108,140])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterModuleName=new t.Rule(t.RuleDescriptor.create1(9,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsModuleDeclContext),2)),this.SpaceBeforeArrow=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,36),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterArrow=new t.Rule(t.RuleDescriptor.create3(36,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterEllipsis=new t.Rule(t.RuleDescriptor.create1(24,71),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOptionalParameters=new t.Rule(t.RuleDescriptor.create3(55,t.Shared.TokenRange.FromTokens([20,26])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.NoSpaceBeforeOpenAngularBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.TypeNames,27),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBetweenCloseParenAndAngularBracket=new t.Rule(t.RuleDescriptor.create1(20,27),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceAfterOpenAngularBracket=new t.Rule(t.RuleDescriptor.create3(27,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBeforeCloseAngularBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,29),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceAfterCloseAngularBracket=new t.Rule(t.RuleDescriptor.create3(29,t.Shared.TokenRange.FromTokens([19,21,29,26])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBetweenEmptyInterfaceBraceBrackets=new t.Rule(t.RuleDescriptor.create1(17,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsObjectTypeContext),8)),this.SpaceBeforeAt=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,57),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterAt=new t.Rule(t.RuleDescriptor.create3(57,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterDecorator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([117,71,84,79,75,115,114,112,113,125,135,21,39])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsEndOfDecoratorContextOnSameLine),2)),this.NoSpaceBetweenFunctionKeywordAndStar=new t.Rule(t.RuleDescriptor.create1(89,39),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclarationOrFunctionExpressionContext),8)),this.SpaceAfterStarInGeneratorDeclaration=new t.Rule(t.RuleDescriptor.create3(39,t.Shared.TokenRange.FromTokens([71,19])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclarationOrFunctionExpressionContext),2)),this.NoSpaceBetweenYieldKeywordAndStar=new t.Rule(t.RuleDescriptor.create1(116,39),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsYieldOrYieldStarWithOperand),8)),this.SpaceBetweenYieldOrYieldStarAndOperand=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([116,39]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsYieldOrYieldStarWithOperand),2)),this.SpaceBetweenAsyncAndOpenParen=new t.Rule(t.RuleDescriptor.create1(120,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsArrowFunctionContext,n.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenAsyncAndFunctionKeyword=new t.Rule(t.RuleDescriptor.create1(120,89),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenTagAndTemplateString=new t.Rule(t.RuleDescriptor.create3(71,t.Shared.TokenRange.FromTokens([13,14])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceBeforeJsxAttribute=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,71),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNextTokenParentJsxAttribute,n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeSlashInJsxOpeningElement=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,41),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxSelfClosingElementContext,n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBeforeGreaterThanTokenInJsxOpeningElement=new t.Rule(t.RuleDescriptor.create1(41,29),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxSelfClosingElementContext,n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeEqualInJsxAttribute=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,58),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxAttributeContext,n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterEqualInJsxAttribute=new t.Rule(t.RuleDescriptor.create3(58,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxAttributeContext,n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeNonNullAssertionOperator=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,51),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNonNullAssertionContext),8)),this.SpaceAfterComma=new t.Rule(t.RuleDescriptor.create3(26,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterCommaDelimiter"),n.IsNonJsxSameLineTokenContext,n.IsNonJsxElementContext,n.IsNextTokenNotCloseBracket),2)),this.NoSpaceAfterComma=new t.Rule(t.RuleDescriptor.create3(26,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterCommaDelimiter"),n.IsNonJsxSameLineTokenContext,n.IsNonJsxElementContext),8)),this.SpaceBeforeBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.BinaryOperators),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.BinaryOperators,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.NoSpaceBeforeBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.BinaryOperators),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),8)),this.NoSpaceAfterBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.BinaryOperators,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),8)),this.SpaceAfterKeywordInControl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Keywords,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterKeywordsInControlFlowStatements"),n.IsControlDeclContext),2)),this.NoSpaceAfterKeywordInControl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Keywords,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterKeywordsInControlFlowStatements"),n.IsControlDeclContext),8)),this.NewLineBeforeOpenBraceInFunction=new t.Rule(t.RuleDescriptor.create2(this.FunctionOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("placeOpenBraceOnNewLineForFunctions"),n.IsFunctionDeclContext,n.IsBeforeMultilineBlockContext),4),1),this.NewLineBeforeOpenBraceInTypeScriptDeclWithBlock=new t.Rule(t.RuleDescriptor.create2(this.TypeScriptOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("placeOpenBraceOnNewLineForFunctions"),n.IsTypeScriptDeclWithBlockContext,n.IsBeforeMultilineBlockContext),4),1),this.NewLineBeforeOpenBraceInControl=new t.Rule(t.RuleDescriptor.create2(this.ControlOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("placeOpenBraceOnNewLineForControlBlocks"),n.IsControlDeclContext,n.IsBeforeMultilineBlockContext),4),1),this.SpaceAfterSemicolonInFor=new t.Rule(t.RuleDescriptor.create3(25,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterSemicolonInForStatements"),n.IsNonJsxSameLineTokenContext,n.IsForContext),2)),this.NoSpaceAfterSemicolonInFor=new t.Rule(t.RuleDescriptor.create3(25,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterSemicolonInForStatements"),n.IsNonJsxSameLineTokenContext,n.IsForContext),8)),this.SpaceAfterOpenParen=new t.Rule(t.RuleDescriptor.create3(19,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCloseParen=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,20),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenOpenParens=new t.Rule(t.RuleDescriptor.create1(19,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenParens=new t.Rule(t.RuleDescriptor.create1(19,20),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOpenParen=new t.Rule(t.RuleDescriptor.create3(19,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseParen=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,20),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterOpenBracket=new t.Rule(t.RuleDescriptor.create3(21,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCloseBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,22),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenBrackets=new t.Rule(t.RuleDescriptor.create1(21,22),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOpenBracket=new t.Rule(t.RuleDescriptor.create3(21,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,22),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterTemplateHeadAndMiddle=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([14,15]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterTemplateHeadAndMiddle=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([14,15]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBeforeTemplateMiddleAndTail=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([15,16])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),8)),this.SpaceBeforeTemplateMiddleAndTail=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([15,16])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterOpenBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),8)),this.SpaceAfterOpenBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),2)),this.NoSpaceBeforeCloseBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),8)),this.SpaceBeforeCloseBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),2)),this.SpaceAfterAnonymousFunctionKeyword=new t.Rule(t.RuleDescriptor.create1(89,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterFunctionKeywordForAnonymousFunctions"),n.IsFunctionDeclContext),2)),this.NoSpaceAfterAnonymousFunctionKeyword=new t.Rule(t.RuleDescriptor.create1(89,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterFunctionKeywordForAnonymousFunctions"),n.IsFunctionDeclContext),8)),this.NoSpaceAfterTypeAssertion=new t.Rule(t.RuleDescriptor.create3(29,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterTypeAssertion"),n.IsNonJsxSameLineTokenContext,n.IsTypeAssertionContext),8)),this.SpaceAfterTypeAssertion=new t.Rule(t.RuleDescriptor.create3(29,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterTypeAssertion"),n.IsNonJsxSameLineTokenContext,n.IsTypeAssertionContext),2)),this.HighPriorityCommonRules=[this.IgnoreBeforeComment,this.IgnoreAfterLineComment,this.NoSpaceBeforeColon,this.SpaceAfterColon,this.NoSpaceBeforeQuestionMark,this.SpaceAfterQuestionMarkInConditionalOperator,this.NoSpaceAfterQuestionMark,this.NoSpaceBeforeDot,this.NoSpaceAfterDot,this.NoSpaceAfterUnaryPrefixOperator,this.NoSpaceAfterUnaryPreincrementOperator,this.NoSpaceAfterUnaryPredecrementOperator,this.NoSpaceBeforeUnaryPostincrementOperator,this.NoSpaceBeforeUnaryPostdecrementOperator,this.SpaceAfterPostincrementWhenFollowedByAdd,this.SpaceAfterAddWhenFollowedByUnaryPlus,this.SpaceAfterAddWhenFollowedByPreincrement,this.SpaceAfterPostdecrementWhenFollowedBySubtract,this.SpaceAfterSubtractWhenFollowedByUnaryMinus,this.SpaceAfterSubtractWhenFollowedByPredecrement,this.NoSpaceAfterCloseBrace,this.NewLineBeforeCloseBraceInBlockContext,this.SpaceAfterCloseBrace,this.SpaceBetweenCloseBraceAndElse,this.SpaceBetweenCloseBraceAndWhile,this.NoSpaceBetweenEmptyBraceBrackets,this.NoSpaceBetweenFunctionKeywordAndStar,this.SpaceAfterStarInGeneratorDeclaration,this.SpaceAfterFunctionInFuncDecl,this.NewLineAfterOpenBraceInBlockContext,this.SpaceAfterGetSetInMember,this.NoSpaceBetweenYieldKeywordAndStar,this.SpaceBetweenYieldOrYieldStarAndOperand,this.NoSpaceBetweenReturnAndSemicolon,this.SpaceAfterCertainKeywords,this.SpaceAfterLetConstInVariableDeclaration,this.NoSpaceBeforeOpenParenInFuncCall,this.SpaceBeforeBinaryKeywordOperator,this.SpaceAfterBinaryKeywordOperator,this.SpaceAfterVoidOperator,this.SpaceBetweenAsyncAndOpenParen,this.SpaceBetweenAsyncAndFunctionKeyword,this.NoSpaceBetweenTagAndTemplateString,this.SpaceBeforeJsxAttribute,this.SpaceBeforeSlashInJsxOpeningElement,this.NoSpaceBeforeGreaterThanTokenInJsxOpeningElement,this.NoSpaceBeforeEqualInJsxAttribute,this.NoSpaceAfterEqualInJsxAttribute,this.NoSpaceAfterModuleImport,this.SpaceAfterCertainTypeScriptKeywords,this.SpaceBeforeCertainTypeScriptKeywords,this.SpaceAfterModuleName,this.SpaceBeforeArrow,this.SpaceAfterArrow,this.NoSpaceAfterEllipsis,this.NoSpaceAfterOptionalParameters,this.NoSpaceBetweenEmptyInterfaceBraceBrackets,this.NoSpaceBeforeOpenAngularBracket,this.NoSpaceBetweenCloseParenAndAngularBracket,this.NoSpaceAfterOpenAngularBracket,this.NoSpaceBeforeCloseAngularBracket,this.NoSpaceAfterCloseAngularBracket,this.SpaceBeforeAt,this.NoSpaceAfterAt,this.SpaceAfterDecorator,this.NoSpaceBeforeNonNullAssertionOperator,this.NoSpaceAfterNewKeywordOnConstructorSignature],this.UserConfigurableRules=[this.SpaceAfterConstructor,this.NoSpaceAfterConstructor,this.SpaceAfterComma,this.NoSpaceAfterComma,this.SpaceAfterAnonymousFunctionKeyword,this.NoSpaceAfterAnonymousFunctionKeyword,this.SpaceAfterKeywordInControl,this.NoSpaceAfterKeywordInControl,this.SpaceAfterOpenParen,this.SpaceBeforeCloseParen,this.SpaceBetweenOpenParens,this.NoSpaceBetweenParens,this.NoSpaceAfterOpenParen,this.NoSpaceBeforeCloseParen,this.SpaceAfterOpenBracket,this.SpaceBeforeCloseBracket,this.NoSpaceBetweenBrackets,this.NoSpaceAfterOpenBracket,this.NoSpaceBeforeCloseBracket,this.SpaceAfterOpenBrace,this.SpaceBeforeCloseBrace,this.NoSpaceBetweenEmptyBraceBrackets,this.NoSpaceAfterOpenBrace,this.NoSpaceBeforeCloseBrace,this.SpaceAfterTemplateHeadAndMiddle,this.SpaceBeforeTemplateMiddleAndTail,this.NoSpaceAfterTemplateHeadAndMiddle,this.NoSpaceBeforeTemplateMiddleAndTail,this.SpaceAfterOpenBraceInJsxExpression,this.SpaceBeforeCloseBraceInJsxExpression,this.NoSpaceAfterOpenBraceInJsxExpression,this.NoSpaceBeforeCloseBraceInJsxExpression,this.SpaceAfterSemicolonInFor,this.NoSpaceAfterSemicolonInFor,this.SpaceBeforeBinaryOperator,this.SpaceAfterBinaryOperator,this.NoSpaceBeforeBinaryOperator,this.NoSpaceAfterBinaryOperator,this.SpaceBeforeOpenParenInFuncDecl,this.NoSpaceBeforeOpenParenInFuncDecl,this.NewLineBeforeOpenBraceInControl,this.NewLineBeforeOpenBraceInFunction,this.NewLineBeforeOpenBraceInTypeScriptDeclWithBlock,this.SpaceAfterTypeAssertion,this.NoSpaceAfterTypeAssertion],this.LowPriorityCommonRules=[this.NoSpaceBeforeSemicolon,this.SpaceBeforeOpenBraceInControl,this.SpaceBeforeOpenBraceInFunction,this.SpaceBeforeOpenBraceInTypeScriptDeclWithBlock,this.NoSpaceBeforeComma,this.NoSpaceBeforeOpenBracket,this.NoSpaceAfterCloseBracket,this.SpaceAfterSemicolon,this.SpaceBetweenStatements,this.SpaceAfterTryFinally],e.Debug.isDebugging){for(var i in this){var r=this[i];r instanceof t.Rule&&(r.debugName=i)}}}return n.IsOptionEnabled=function(e){return function(t){return t.options&&t.options.hasOwnProperty(e)&&!!t.options[e]}},n.IsOptionDisabled=function(e){return function(t){return t.options&&t.options.hasOwnProperty(e)&&!t.options[e]}},n.IsOptionDisabledOrUndefined=function(e){return function(t){return!t.options||!t.options.hasOwnProperty(e)||!t.options[e]}},n.isOptionDisabledOrUndefinedOrTokensOnSameLine=function(e){return function(t){return!t.options||!t.options.hasOwnProperty(e)||!t.options[e]||t.TokensAreOnSameLine()}},n.IsOptionEnabledOrUndefined=function(e){return function(t){return!t.options||!t.options.hasOwnProperty(e)||!!t.options[e]}},n.IsForContext=function(e){return 214===e.contextNode.kind},n.IsNotForContext=function(e){return!n.IsForContext(e)},n.IsBinaryOpContext=function(e){switch(e.contextNode.kind){case 194:case 195:case 202:case 246:case 242:case 158:case 166:case 167:return!0;case 176:case 231:case 237:case 226:case 146:case 264:case 149:case 148:return 58===e.currentTokenSpan.kind||58===e.nextTokenSpan.kind;case 215:case 145:return 92===e.currentTokenSpan.kind||92===e.nextTokenSpan.kind;case 216:return 142===e.currentTokenSpan.kind||142===e.nextTokenSpan.kind}return!1},n.IsNotBinaryOpContext=function(e){return!n.IsBinaryOpContext(e)},n.IsConditionalOperatorContext=function(e){return 195===e.contextNode.kind},n.IsSameLineTokenOrBeforeBlockContext=function(e){return e.TokensAreOnSameLine()||n.IsBeforeBlockContext(e)},n.IsBraceWrappedContext=function(e){return 174===e.contextNode.kind||n.IsSingleLineBlockContext(e)},n.IsBeforeMultilineBlockContext=function(e){return n.IsBeforeBlockContext(e)&&!(e.NextNodeAllOnSameLine()||e.NextNodeBlockIsOnOneLine())},n.IsMultilineBlockContext=function(e){return n.IsBlockContext(e)&&!(e.ContextNodeAllOnSameLine()||e.ContextNodeBlockIsOnOneLine())},n.IsSingleLineBlockContext=function(e){return n.IsBlockContext(e)&&(e.ContextNodeAllOnSameLine()||e.ContextNodeBlockIsOnOneLine())},n.IsBlockContext=function(e){return n.NodeIsBlockContext(e.contextNode)},n.IsBeforeBlockContext=function(e){return n.NodeIsBlockContext(e.nextTokenParent)},n.NodeIsBlockContext=function(e){if(n.NodeIsTypeScriptDeclWithBlockContext(e))return!0;switch(e.kind){case 207:case 235:case 178:case 234:return!0}return!1},n.IsFunctionDeclContext=function(e){switch(e.contextNode.kind){case 228:case 151:case 150:case 153:case 154:case 155:case 186:case 152:case 187:case 230:return!0}return!1},n.IsFunctionDeclarationOrFunctionExpressionContext=function(e){return 228===e.contextNode.kind||186===e.contextNode.kind},n.IsTypeScriptDeclWithBlockContext=function(e){return n.NodeIsTypeScriptDeclWithBlockContext(e.contextNode)},n.NodeIsTypeScriptDeclWithBlockContext=function(e){switch(e.kind){case 229:case 199:case 230:case 232:case 163:case 233:case 244:case 245:case 238:case 241:return!0}return!1},n.IsAfterCodeBlockContext=function(e){switch(e.currentTokenParent.kind){case 229:case 233:case 232:case 260:case 234:case 221:return!0;case 207:var t=e.currentTokenParent.parent;if(!t||187!==t.kind&&186!==t.kind)return!0}return!1},n.IsControlDeclContext=function(e){switch(e.contextNode.kind){case 211:case 221:case 214:case 215:case 216:case 213:case 224:case 212:case 220:case 260:return!0;default:return!1}},n.IsObjectContext=function(e){return 178===e.contextNode.kind},n.IsFunctionCallContext=function(e){return 181===e.contextNode.kind},n.IsNewContext=function(e){return 182===e.contextNode.kind},n.IsFunctionCallOrNewContext=function(e){return n.IsFunctionCallContext(e)||n.IsNewContext(e)},n.IsPreviousTokenNotComma=function(e){return 26!==e.currentTokenSpan.kind},n.IsNextTokenNotCloseBracket=function(e){return 22!==e.nextTokenSpan.kind},n.IsArrowFunctionContext=function(e){return 187===e.contextNode.kind},n.IsNonJsxSameLineTokenContext=function(e){return e.TokensAreOnSameLine()&&10!==e.contextNode.kind},n.IsNonJsxElementContext=function(e){return 249!==e.contextNode.kind},n.IsJsxExpressionContext=function(e){return 256===e.contextNode.kind},n.IsNextTokenParentJsxAttribute=function(e){return 253===e.nextTokenParent.kind},n.IsJsxAttributeContext=function(e){return 253===e.contextNode.kind},n.IsJsxSelfClosingElementContext=function(e){return 250===e.contextNode.kind},n.IsNotBeforeBlockInFunctionDeclarationContext=function(e){return!n.IsFunctionDeclContext(e)&&!n.IsBeforeBlockContext(e)},n.IsEndOfDecoratorContextOnSameLine=function(e){return e.TokensAreOnSameLine()&&e.contextNode.decorators&&n.NodeIsInDecoratorContext(e.currentTokenParent)&&!n.NodeIsInDecoratorContext(e.nextTokenParent)},n.NodeIsInDecoratorContext=function(t){for(;e.isPartOfExpression(t);)t=t.parent;return 147===t.kind},n.IsStartOfVariableDeclarationList=function(e){return 227===e.currentTokenParent.kind&&e.currentTokenParent.getStart(e.sourceFile)===e.currentTokenSpan.pos},n.IsNotFormatOnEnter=function(e){return 2!==e.formattingRequestKind},n.IsModuleDeclContext=function(e){return 233===e.contextNode.kind},n.IsObjectTypeContext=function(e){return 163===e.contextNode.kind},n.IsConstructorSignatureContext=function(e){return 156===e.contextNode.kind},n.IsTypeArgumentOrParameterOrAssertion=function(e,t){if(27!==e.kind&&29!==e.kind)return!1;switch(t.kind){case 159:case 184:case 231:case 229:case 199:case 230:case 228:case 186:case 187:case 151:case 150:case 155:case 156:case 181:case 182:case 201:return!0;default:return!1}},n.IsTypeArgumentOrParameterOrAssertionContext=function(e){return n.IsTypeArgumentOrParameterOrAssertion(e.currentTokenSpan,e.currentTokenParent)||n.IsTypeArgumentOrParameterOrAssertion(e.nextTokenSpan,e.nextTokenParent)},n.IsTypeAssertionContext=function(e){return 184===e.contextNode.kind},n.IsVoidOpContext=function(e){return 105===e.currentTokenSpan.kind&&190===e.currentTokenParent.kind},n.IsYieldOrYieldStarWithOperand=function(e){return 197===e.contextNode.kind&&void 0!==e.contextNode.expression},n.IsNonNullAssertionContext=function(e){return 203===e.contextNode.kind},n}();t.Rules=n}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function t(e){this.mapRowLength=143,this.map=new Array(this.mapRowLength*this.mapRowLength);for(var t=new Array(this.map.length),n=0,i=e;n<i.length;n++){var r=i[n];this.FillRule(r,t)}}return t.prototype.GetRuleBucketIndex=function(t,n){return e.Debug.assert(t<=142&&n<=142,"Must compute formatting context from tokens"),t*this.mapRowLength+n},t.prototype.FillRule=function(e,t){var n=this,i=e.Descriptor.LeftTokenRange.isSpecific()&&e.Descriptor.RightTokenRange.isSpecific();e.Descriptor.LeftTokenRange.GetTokens().forEach(function(r){e.Descriptor.RightTokenRange.GetTokens().forEach(function(o){var a=n.GetRuleBucketIndex(r,o),l=n.map[a];void 0===l&&(l=n.map[a]=new s),l.AddRule(e,i,t,a)})})},t.prototype.GetRule=function(e){var t=this.GetRuleBucketIndex(e.currentTokenSpan.kind,e.nextTokenSpan.kind),n=this.map[t];if(n)for(var i=0,r=n.Rules();i<r.length;i++){var s=r[i];if(s.Operation.Context.InContext(e))return s}},t}();t.RulesMap=n;var i;!function(e){e[e.IgnoreRulesSpecific=0]="IgnoreRulesSpecific",e[e.IgnoreRulesAny=5]="IgnoreRulesAny",e[e.ContextRulesSpecific=10]="ContextRulesSpecific",e[e.ContextRulesAny=15]="ContextRulesAny",e[e.NoContextRulesSpecific=20]="NoContextRulesSpecific",e[e.NoContextRulesAny=25]="NoContextRulesAny"}(i||(i={}));var r=function(){function t(){this.rulesInsertionIndexBitmap=0}return t.prototype.GetInsertionIndex=function(e){for(var t=0,n=0,i=this.rulesInsertionIndexBitmap;n<=e;)t+=31&i,i>>=5,n+=5;return t},t.prototype.IncreaseInsertionIndex=function(t){var n=this.rulesInsertionIndexBitmap>>t&31;n++,e.Debug.assert((31&n)===n,"Adding more rules into the sub-bucket than allowed. Maximum allowed is 32 rules.");var i=this.rulesInsertionIndexBitmap&~(31<<t);i|=n<<t,this.rulesInsertionIndexBitmap=i},t}();t.RulesBucketConstructionState=r;var s=function(){function e(){this.rules=[]}return e.prototype.Rules=function(){return this.rules},e.prototype.AddRule=function(e,t,n,s){var o;o=1===e.Operation.Action?t?i.IgnoreRulesSpecific:i.IgnoreRulesAny:e.Operation.Context.IsAny()?t?i.NoContextRulesSpecific:i.NoContextRulesAny:t?i.ContextRulesSpecific:i.ContextRulesAny;var a=n[s];void 0===a&&(a=n[s]=new r);var l=a.GetInsertionIndex(o);this.rules.splice(l,0,e),a.IncreaseInsertionIndex(o)},e}();t.RulesBucket=s}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){!function(t){for(var n=[],i=0;i<=142;i++)n.push(i);var r=function(){function e(e){void 0===e&&(e=[]),this.tokens=e}return e.prototype.GetTokens=function(){return this.tokens},e.prototype.Contains=function(e){return this.tokens.indexOf(e)>=0},e.prototype.isSpecific=function(){return!0},e}(),s=function(){function e(e){this.token=e}return e.prototype.GetTokens=function(){return[this.token]},e.prototype.Contains=function(e){return e===this.token},e.prototype.isSpecific=function(){return!0},e}(),o=function(){function e(){}return e.prototype.GetTokens=function(){return n},e.prototype.Contains=function(){return!0},e.prototype.toString=function(){return"[allTokens]"},e.prototype.isSpecific=function(){return!1},e}(),a=function(){function e(e){this.except=e}return e.prototype.GetTokens=function(){var e=this;return n.filter(function(t){return t!==e.except})},e.prototype.Contains=function(e){return e!==this.except},e.prototype.isSpecific=function(){return!1},e}();!function(t){t.FromToken=function(e){return new s(e)},t.FromTokens=function(e){return new r(e)},t.FromRange=function(t,n,i){void 0===i&&(i=[]);for(var s=[],o=t;o<=n;o++)e.indexOf(i,o)<0&&s.push(o);return new r(s)},t.AnyExcept=function(e){return new a(e)},t.Any=new o,t.AnyIncludingMultilineComments=t.FromTokens(n.concat([3])),t.Keywords=t.FromRange(72,142),t.BinaryOperators=t.FromRange(27,70),t.BinaryKeywordOperators=t.FromTokens([92,93,142,118,126]),t.UnaryPrefixOperators=t.FromTokens([43,44,52,51]),t.UnaryPrefixExpressions=t.FromTokens([8,71,19,21,17,99,94]),t.UnaryPreincrementExpressions=t.FromTokens([71,19,99,94]),t.UnaryPostincrementExpressions=t.FromTokens([71,20,22,94]),t.UnaryPredecrementExpressions=t.FromTokens([71,19,99,94]),t.UnaryPostdecrementExpressions=t.FromTokens([71,20,22,94]),t.Comments=t.FromTokens([2,3]),t.TypeNames=t.FromTokens([71,133,136,122,137,105,119])}(t.TokenRange||(t.TokenRange={}))}(t.Shared||(t.Shared={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function n(){this.globalRules=new t.Rules;var e=this.globalRules.HighPriorityCommonRules.concat(this.globalRules.UserConfigurableRules).concat(this.globalRules.LowPriorityCommonRules);this.rulesMap=new t.RulesMap(e)}return n.prototype.getRulesMap=function(){return this.rulesMap},n.prototype.getFormatOptions=function(){return this.options},n.prototype.ensureUpToDate=function(t){this.options&&e.compareDataObjects(this.options,t)||(this.options=e.clone(t))},n}();t.RulesProvider=n}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n,i,r,s;function o(t,n,i){var r=e.findPrecedingToken(t,i);return r&&r.kind===n&&t===r.getEnd()?r:void 0}function a(e){for(var t=e;t&&t.parent&&t.parent.end===e.end&&!l(t.parent,t);)t=t.parent;return t}function l(t,n){switch(t.kind){case 229:case 230:return e.rangeContainsRange(t.members,n);case 233:var i=t.body;return i&&234===i.kind&&e.rangeContainsRange(i.statements,n);case 265:case 207:case 234:return e.rangeContainsRange(t.statements,n);case 260:return e.rangeContainsRange(t.block.statements,n)}return!1}function c(t,n,i,r,s){return t?u({pos:e.getLineStartPositionForPosition(t.getStart(n),n),end:t.end},n,i,r,s):[]}function u(n,i,r,s,o){var a=function(t,n){return function i(r){var s=e.forEachChild(r,function(i){return e.startEndContainsRange(i.getStart(n),i.end,t)&&i});if(s){var o=i(s);if(o)return o}return r}(n)}(n,i);return t.getFormattingScanner(i.text,i.languageVariant,function(t,n,i){var r=t.getStart(i);if(r===n.pos&&t.end===n.end)return r;var s=e.findPrecedingToken(n.pos,i);return s?s.end>=n.pos?t.pos:s.end:t.pos}(a,n,i),n.end,function(l){return d(n,a,t.SmartIndenter.getIndentationForNode(a,n,i,r),function(e,n,i){for(var r,s=-1;e;){var o=i.getLineAndCharacterOfPosition(e.getStart(i)).line;if(-1!==s&&o!==s)break;if(t.SmartIndenter.shouldIndentChildNode(e,r))return n.indentSize;s=o,r=e,e=e.parent}return 0}(a,r,i),l,r,s,o,function(t,n){if(!t.length)return s;var i=t.filter(function(t){return e.rangeOverlapsWithStartEnd(n,t.start,t.start+t.length)}).sort(function(e,t){return e.start-t.start});if(!i.length)return s;var r=0;return function(t){for(;;){if(r>=i.length)return!1;var n=i[r];if(t.end<=n.start)return!1;if(e.startEndOverlapsWithStartEnd(t.pos,t.end,n.start,n.start+n.length))return!0;r++}};function s(){return!1}}(i.parseDiagnostics,n),i)})}function d(n,i,r,s,o,a,l,c,u,d){var h,f,m,g,_,y=new t.FormattingContext(d,c,a),b=[];if(o.advance(),o.isOnToken()){var v=d.getLineAndCharacterOfPosition(i.getStart(d)).line,T=v;i.decorators&&(T=d.getLineAndCharacterOfPosition(e.getNonDecoratorTokenPosOfNode(i,d)).line),function i(r,s,l,c,p,f){if(!e.rangeOverlapsWithStartEnd(n,r.getStart(d),r.getEnd()))return;var m=E(r,l,p,f),y=s;e.forEachChild(r,function(e){v(e,-1,r,m,l,c,!1)},function(e){T(e,r,l,m)});for(;o.isOnToken();){var b=o.readTokenInfo(r);if(b.token.end>r.end)break;k(b,r,m,r)}function v(s,l,c,u,p,h,f,m){var g=s.getStart(d),_=d.getLineAndCharacterOfPosition(g).line,b=_;s.decorators&&(b=d.getLineAndCharacterOfPosition(e.getNonDecoratorTokenPosOfNode(s,d)).line);var v=-1;if(f&&e.rangeContainsRange(n,c)&&(v=function(n,i,r,s,o){if(e.rangeOverlapsWithStartEnd(s,n,i)||e.rangeContainsStartEnd(s,n,i)){if(-1!==o)return o}else{var l=d.getLineAndCharacterOfPosition(n).line,c=e.getLineStartPositionForPosition(n,d),u=t.SmartIndenter.findFirstNonWhitespaceColumn(c,n,d,a);if(l!==r||n===u){var p=t.SmartIndenter.getBaseIndentation(a);return p>u?p:u}}return-1}(g,s.end,p,n,l),-1!==v&&(l=v)),!e.rangeOverlapsWithStartEnd(n,s.pos,s.end))return s.end<n.pos&&o.skipToEndOf(s),l;if(0===s.getFullWidth())return l;for(;o.isOnToken();){if((T=o.readTokenInfo(r)).token.end>g)break;k(T,r,u,r)}if(!o.isOnToken())return l;if(e.isToken(s)&&10!==s.kind){var T=o.readTokenInfo(s);return e.Debug.assert(T.token.end===s.end,"Token end is child end"),k(T,r,u,s),l}var E=147===s.kind?_:h,S=x(s,_,v,r,u,E);return i(s,y,_,b,S.indentation,S.delta),y=r,m&&177===c.kind&&-1===l&&(l=S.indentation),l}function T(t,n,i,s){e.Debug.assert(e.isNodeArray(t));var a=function(e,t){switch(e.kind){case 152:case 228:case 186:case 151:case 150:case 187:if(e.typeParameters===t)return 27;if(e.parameters===t)return 19;break;case 181:case 182:if(e.typeArguments===t)return 27;if(e.arguments===t)return 19;break;case 159:if(e.typeArguments===t)return 27}return 0}(n,t),l=function(e){switch(e){case 19:return 20;case 27:return 29}return 0}(a),c=s,u=i;if(0!==a)for(;o.isOnToken();){if((h=o.readTokenInfo(n)).token.end>t.pos)break;if(h.token.kind===a){u=d.getLineAndCharacterOfPosition(h.token.pos).line;var p=x(h.token,u,-1,n,s,i);k(h,n,c=E(n,i,p.indentation,p.delta),n)}else k(h,n,s,n)}for(var h,f=-1,m=0;m<t.length;m++){f=v(t[m],f,r,c,u,u,!0,0===m)}0!==l&&(o.isOnToken()&&(h=o.readTokenInfo(n)).token.kind===l&&e.rangeContainsRange(n,h.token)&&k(h,n,c,n))}function k(t,i,r,s){e.Debug.assert(e.rangeContainsRange(i,t.token));var a,l=o.lastTrailingTriviaWasNewLine(),c=!1;t.leadingTrivia&&S(t.leadingTrivia,i,y,r);var p=e.rangeContainsRange(n,t.token),f=d.getLineAndCharacterOfPosition(t.token.pos);if(p){var m=u(t.token),b=h;if(a=C(t.token,f,i,y,r),m)c=!1;else if(void 0!==a)c=a;else{var v=b&&d.getLineAndCharacterOfPosition(b.end).line;c=l&&f.line!==v}}if(t.trailingTrivia&&S(t.trailingTrivia,i,y,r),c){var T=p&&!u(t.token)?r.getIndentationForToken(f.line,t.token.kind,s):-1,k=!0;if(t.leadingTrivia)for(var x=r.getIndentationForComment(t.token.kind,T,s),E=0,A=t.leadingTrivia;E<A.length;E++){var N=A[E],D=e.rangeContainsRange(n,N);switch(N.kind){case 3:D&&I(N,x,!k),k=!1;break;case 2:k&&D&&w(N.pos,x,!1),k=!1;break;case 4:k=!0}}-1!==T&&k&&(w(t.token.pos,T,a),g=f.line,_=T)}o.advance(),y=i}}(i,i,v,T,r,s)}if(!o.isOnToken()){var k=o.getCurrentLeadingTrivia();k&&(S(k,i,i,void 0),function(){var e=h?h.end:n.pos,t=d.getLineAndCharacterOfPosition(e).line,i=d.getLineAndCharacterOfPosition(n.end).line;A(t,i+1,h)}())}return b;function x(e,n,i,r,s,o){var l=i,c=t.SmartIndenter.shouldIndentChildNode(e)?a.indentSize:0;return o===n?(l=n===g?_:s.getIndentation(),c=Math.min(a.indentSize,s.getDelta(e)+c)):-1===l&&(l=t.SmartIndenter.childStartsOnTheSameLineWithElseInIfStatement(r,e,n,d)?s.getIndentation():s.getIndentation()+s.getDelta(e)),{indentation:l,delta:c}}function E(n,i,r,s){return{getIndentationForComment:function(e,t,n){switch(e){case 18:case 22:case 20:return r+o(s,n)}return-1!==t?t:r},getIndentationForToken:function(t,a,l){if(i!==t&&n.decorators&&a===function(t){if(t.modifiers&&t.modifiers.length)return t.modifiers[0].kind;switch(t.kind){case 229:return 75;case 230:return 109;case 228:return 89;case 232:return 232;case 153:return 125;case 154:return 135;case 151:if(t.asteriskToken)return 39;case 149:case 146:return e.getNameOfDeclaration(t).kind}}(n))return r;switch(a){case 17:case 18:case 19:case 20:case 82:case 106:case 57:return r;case 41:case 29:if(251===l.kind||252===l.kind||250===l.kind)return r;break;case 21:case 22:if(172!==l.kind)return r}return i!==t?r+o(s,l):r},getIndentation:function(){return r},getDelta:function(e){return o(s,e)},recomputeIndentation:function(e){n.parent&&t.SmartIndenter.shouldIndentChildNode(n.parent,n)&&(e?r+=a.indentSize:r-=a.indentSize,s=t.SmartIndenter.shouldIndentChildNode(n)?a.indentSize:0)}};function o(e,i){return t.SmartIndenter.nodeWillIndentChild(n,i,!0)?e:0}}function S(t,i,r,s){for(var o=0,a=t;o<a.length;o++){var l=a[o];if(e.isComment(l.kind)&&e.rangeContainsRange(n,l))C(l,d.getLineAndCharacterOfPosition(l.pos),i,r,s)}}function C(e,t,i,r,s){var o;u(e)||(h?o=function(e,t,n,i,r,s,o,c){y.updateContext(i,s,e,n,o);var u,p,h=l.getRulesMap().GetRule(y);h?(!function(e,t,n,i,r){switch(e.Operation.Action){case 1:return;case 8:t.end!==i.pos&&O(t.end,i.pos-t.end);break;case 4:if(1!==e.Flag&&n!==r)return;1!==r-n&&R(t.end,i.pos-t.end,a.newLineCharacter);break;case 2:if(1!==e.Flag&&n!==r)return;1===i.pos-t.end&&32===d.text.charCodeAt(t.end)||R(t.end,i.pos-t.end," ")}}(h,i,r,e,t),10&h.Operation.Action&&t!==r?(p=!1,n.getStart(d)===e.pos&&c.recomputeIndentation(!1)):4&h.Operation.Action&&t===r&&(p=!0,n.getStart(d)===e.pos&&c.recomputeIndentation(!0)),u=!(8&h.Operation.Action)&&1!==h.Flag):u=!0;t!==r&&u&&A(r,t,i);return p}(e,t.line,i,h,m,f,r,s):A(d.getLineAndCharacterOfPosition(n.pos).line,t.line));return h=e,f=i,m=t.line,o}function w(t,n,i){var r=p(n,a);if(i)R(t,0,r);else{var s=d.getLineAndCharacterOfPosition(t),o=e.getStartPositionOfLine(s.line,d);(n!==function(e,t){for(var n=0,i=0;i<t;i++)9===d.text.charCodeAt(e+i)?n+=a.tabSize-n%a.tabSize:n++;return n}(o,s.character)||function(e,t){return e!==d.text.substr(t,e.length)}(r,o))&&R(o,s.character,r)}}function I(n,i,r){var s,o=d.getLineAndCharacterOfPosition(n.pos).line,l=d.getLineAndCharacterOfPosition(n.end).line;if(o!==l){s=[];for(var c=n.pos,u=o;u<l;u++){var h=e.getEndLinePosition(u,d);s.push({pos:c,end:h}),c=e.getStartPositionOfLine(u+1,d)}s.push({pos:c,end:n.end});var f=e.getStartPositionOfLine(o,d),m=t.SmartIndenter.findFirstNonWhitespaceCharacterAndColumn(f,s[0].pos,d,a);if(i!==m.column){var g=0;r&&(g=1,o++);for(var _=i-m.column,y=g;y<s.length;y++,o++){var b=e.getStartPositionOfLine(o,d),v=0===y?m:t.SmartIndenter.findFirstNonWhitespaceCharacterAndColumn(s[y].pos,s[y].end,d,a),T=v.column+_;if(T>0){var k=p(T,a);R(b,v.character,k)}else O(b,v.character)}}}else r||w(n.pos,i,!1)}function A(t,n,i){for(var r=t;r<n;r++){var s=e.getStartPositionOfLine(r,d),o=e.getEndLinePosition(r,d);if(!(i&&(e.isComment(i.kind)||e.isStringOrRegularExpressionOrTemplateLiteral(i.kind))&&i.pos<=o&&i.end>o)){var a=N(s,o);-1!==a&&(e.Debug.assert(a===s||!e.isWhiteSpaceSingleLine(d.text.charCodeAt(a-1))),O(a,o+1-a))}}}function N(t,n){for(var i=n;i>=t&&e.isWhiteSpaceSingleLine(d.text.charCodeAt(i));)i--;return i!==n?i+1:-1}function D(t,n,i){return{span:e.createTextSpan(t,n),newText:i}}function O(e,t){t&&b.push(D(e,t,""))}function R(e,t,n){(t||n)&&b.push(D(e,t,n))}}function p(e,t){if((!i||i.tabSize!==t.tabSize||i.indentSize!==t.indentSize)&&(i={tabSize:t.tabSize,indentSize:t.indentSize},r=s=void 0),t.convertTabsToSpaces){var n=void 0,o=Math.floor(e/t.indentSize),a=e%t.indentSize;return s||(s=[]),void 0===s[o]?(n=d(" ",t.indentSize*o),s[o]=n):n=s[o],a?n+d(" ",a):n}var l=Math.floor(e/t.tabSize),c=e-l*t.tabSize,u=void 0;return r||(r=[]),void 0===r[l]?r[l]=u=d("\t",l):u=r[l],c?u+d(" ",c):u;function d(e,t){for(var n="",i=0;i<t;i++)n+=e;return n}}!function(e){e[e.Unknown=-1]="Unknown"}(n||(n={})),t.formatOnEnter=function(t,n,i,r){var s=n.getLineAndCharacterOfPosition(t).line;if(0===s)return[];for(var o=e.getEndLinePosition(s,n);e.isWhiteSpaceSingleLine(n.text.charCodeAt(o));)o--;return e.isLineBreak(n.text.charCodeAt(o))&&o--,u({pos:e.getStartPositionOfLine(s-1,n),end:o+1},n,r,i,2)},t.formatOnSemicolon=function(e,t,n,i){return c(a(o(e,25,t)),t,i,n,3)},t.formatOnOpeningCurly=function(t,n,i,r){var s=o(t,17,n);if(!s)return[];var l=a(s.parent);return u({pos:e.getLineStartPositionForPosition(l.getStart(n),n),end:t},n,r,i,4)},t.formatOnClosingCurly=function(e,t,n,i){return c(a(o(e,18,t)),t,i,n,5)},t.formatDocument=function(e,t,n){return u({pos:0,end:e.text.length},e,n,t,0)},t.formatSelection=function(t,n,i,r,s){return u({pos:e.getLineStartPositionForPosition(t,i),end:n},i,s,r,1)},t.formatNodeGivenIndentation=function(e,n,i,r,s,o){var a={pos:0,end:n.text.length};return t.getFormattingScanner(n.text,i,a.pos,a.end,function(t){return d(a,e,r,s,t,o.getFormatOptions(),o,1,function(e){return!1},n)})},t.getRangeOfEnclosingComment=function(t,n,i,r,s,o){if(void 0===s&&(s=e.getTokenAtPosition(t,n,!1)),!(s.getStart(t)<=n&&n<s.getEnd())){void 0===r&&(r=e.findPrecedingToken(n,t));var a=r&&e.getTrailingCommentRanges(t.text,r.end),l=e.getLeadingCommentRangesOfNode(s,t),c=a&&l?a.concat(l):a||l;if(c)for(var u=0,d=c;u<d.length;u++){var p=d[u];if(p.pos<n&&n<p.end||n===p.end&&(2===p.kind||n===t.getFullWidth()))return 3!==p.kind&&i||o&&!o(p)?void 0:p}}},t.getIndentationString=p}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){!function(n){var i,r;function s(e){return e.baseIndentSize||0}function o(e,t,n,i,r,o){for(var c,u=e.parent;u;){var h=!0;if(n){var f=e.getStart(r);h=f<n.pos||f>n.end}if(h)if(-1!==(y=m(e,r,o)))return y+i;var _=(c=a(u,e,r)).line===t.line||p(u,e,t.line,r);if(h){var y;if(-1!==(y=l(e,u,t,_,r,o)))return y+i;if(-1!==(y=g(e,r,o)))return y+i}k(u,e)&&!_&&(i+=o.indentSize);var b=d(u,e,t.line,r);u=(e=u).parent,t=b?r.getLineAndCharacterOfPosition(e.getStart()):c}return i+s(o)}function a(e,t,n){var i=f(t,n),r=i?i.pos:e.getStart(n);return n.getLineAndCharacterOfPosition(r)}function l(t,n,i,r,s,o){return(e.isDeclaration(t)||e.isStatementButNotDeclaration(t))&&(265===n.kind||!r)?y(i,s,o):-1}function c(t,n,i,r){var s=e.findNextToken(t,n);return s?17===s.kind?1:18===s.kind&&i===u(s,r).line?2:0:0}function u(e,t){return t.getLineAndCharacterOfPosition(e.getStart(t))}function d(t,n,i,r){if(!e.isCallExpression(t)||!e.contains(t.arguments,n))return!1;var s=t.expression.getEnd();return e.getLineAndCharacterOfPosition(r,s).line===i}function p(t,n,i,r){if(211===t.kind&&t.elseStatement===n){var s=e.findChildOfKind(t,82,r);return e.Debug.assert(void 0!==s),u(s,r).line===i}return!1}function h(t,n,i){return t&&e.rangeContainsStartEnd(t,n,i)?t:void 0}function f(e,t){if(e.parent)switch(e.parent.kind){case 159:return h(e.parent.typeArguments,e.getStart(t),e.getEnd());case 178:return e.parent.properties;case 177:return e.parent.elements;case 228:case 186:case 187:case 151:case 150:case 155:case 152:case 161:case 156:var n=e.getStart(t);return h(e.parent.typeParameters,n,e.getEnd())||h(e.parent.parameters,n,e.getEnd());case 229:return h(e.parent.typeParameters,e.getStart(t),e.getEnd());case 182:case 181:n=e.getStart(t);return h(e.parent.typeArguments,n,e.getEnd())||h(e.parent.arguments,n,e.getEnd());case 227:return h(e.parent.declarations,e.getStart(t),e.getEnd());case 241:case 245:return h(e.parent.elements,e.getStart(t),e.getEnd())}}function m(t,n,i){var r,s,o=f(t,n);return o?(r=o,-1!==(s=e.indexOf(r,t))?_(r,s,n,i):-1):-1}function g(t,n,i){if(20===t.kind)return-1;if(t.parent&&e.isCallOrNewExpression(t.parent)&&t.parent.expression!==t){var r=t.parent.expression,s=function(e){for(;;)switch(e.kind){case 181:case 182:case 179:case 180:e=e.expression;break;default:return e}}(r);if(r===s)return-1;var o=n.getLineAndCharacterOfPosition(r.end),a=n.getLineAndCharacterOfPosition(s.end);return o.line===a.line?-1:y(o,n,i)}return-1}function _(t,n,i,r){e.Debug.assert(n>=0&&n<t.length);for(var s=u(t[n],i),o=n-1;o>=0;o--)if(26!==t[o].kind){if(i.getLineAndCharacterOfPosition(t[o].end).line!==s.line)return y(s,i,r);s=u(t[o],i)}return-1}function y(e,t,n){var i=t.getPositionOfLineAndCharacter(e.line,0);return v(i,i+e.character,t,n)}function b(t,n,i,r){for(var s=0,o=0,a=t;a<n;a++){var l=i.text.charCodeAt(a);if(!e.isWhiteSpaceSingleLine(l))break;9===l?o+=r.tabSize+o%r.tabSize:o++,s++}return{column:o,character:s}}function v(e,t,n,i){return b(e,t,n,i).column}function T(e,t,n){var i=t?t.kind:0;switch(e.kind){case 212:case 213:case 215:case 216:case 214:case 211:case 228:case 186:case 151:case 187:case 152:case 153:case 154:return 207!==i;case 244:return 245!==i;case 238:return 239!==i||t.namedBindings&&241!==t.namedBindings.kind;case 249:return 252!==i}return n}function k(e,t){return function(e){switch(e){case 210:case 229:case 199:case 230:case 232:case 231:case 177:case 207:case 234:case 178:case 163:case 172:case 165:case 235:case 258:case 257:case 185:case 179:case 181:case 182:case 208:case 226:case 243:case 219:case 195:case 175:case 174:case 251:case 250:case 256:case 150:case 155:case 156:case 146:case 160:case 161:case 168:case 183:case 191:case 245:case 241:case 246:case 242:case 261:case 149:return!0}return!1}(e.kind)||T(e,t,!1)}!function(e){e[e.Unknown=-1]="Unknown"}(i||(i={})),n.getIndentation=function(i,r,a,l){if(void 0===l&&(l=!1),i>r.text.length)return s(a);if(a.indentStyle===e.IndentStyle.None)return 0;var d=e.findPrecedingToken(i,r),p=t.getRangeOfEnclosingComment(r,i,!0,d||null);if(p){var h=e.getLineAndCharacterOfPosition(r,i).line-1,f=e.getLineAndCharacterOfPosition(r,p.pos).line;if(e.Debug.assert(f>=0),h<=f)return v(e.getStartPositionOfLine(f,r),i,r,a);var y=e.getStartPositionOfLine(h,r),T=b(y,i,r,a),x=T.column,E=T.character;return 0===x?x:42===r.text.charCodeAt(y+E)?x-1:x}if(!d)return s(a);if(e.isStringOrRegularExpressionOrTemplateLiteral(d.kind)&&d.getStart(r)<=i&&i<d.end)return 0;var S,C=r.getLineAndCharacterOfPosition(i).line;if(a.indentStyle===e.IndentStyle.Block){for(var w=i;w>0;){var I=r.text.charCodeAt(w);if(!e.isWhiteSpaceLike(I))break;w--}var A=e.getLineStartPositionForPosition(w,r);return n.findFirstNonWhitespaceColumn(A,w,r,a)}if(26===d.kind&&194!==d.parent.kind){var N=function(t,n,i){var r=e.findListItemInfo(t);return r&&r.listItemIndex>0?_(r.list.getChildren(),r.listItemIndex-1,n,i):-1}(d,r,a);if(-1!==N)return N}for(var D,O,R=d;R;){if(e.positionBelongsToNode(R,i,r)&&k(R,S)){D=u(R,r);var L=c(d,R,C,r);O=0!==L?l&&2===L?a.indentSize:0:C!==D.line?a.indentSize:0;break}if(-1!==(N=m(R,r,a)))return N;if(-1!==(N=g(R,r,a)))return N+a.indentSize;S=R,R=R.parent}return R?o(R,D,void 0,O,r,a):s(a)},n.getIndentationForNode=function(e,t,n,i){var r=n.getLineAndCharacterOfPosition(e.getStart(n));return o(e,r,t,0,n,i)},n.getBaseIndentation=s,function(e){e[e.Unknown=0]="Unknown",e[e.OpenBrace=1]="OpenBrace",e[e.CloseBrace=2]="CloseBrace"}(r||(r={})),n.isArgumentAndStartLineOverlapsExpressionBeingCalled=d,n.childStartsOnTheSameLineWithElseInIfStatement=p,n.getContainingList=f,n.findFirstNonWhitespaceCharacterAndColumn=b,n.findFirstNonWhitespaceColumn=v,n.nodeWillIndentChild=T,n.shouldIndentChildNode=k}(t.SmartIndenter||(t.SmartIndenter={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){function n(t){var n=t.__pos;return e.Debug.assert("number"==typeof n),n}function i(t,n){e.Debug.assert("number"==typeof n),t.__pos=n}function r(t){var n=t.__end;return e.Debug.assert("number"==typeof n),n}function s(t,n){e.Debug.assert("number"==typeof n),t.__end=n}var o,a;function l(t,n){return e.skipTrivia(t,n,!1,!0)}function c(t,n,i,r){if(i.useNonAdjustedStartPosition)return n.getFullStart();var s=n.getFullStart(),a=n.getStart(t);if(s===a)return a;var c=e.getLineStartPositionForPosition(s,t);if(e.getLineStartPositionForPosition(a,t)===c)return r===o.Start?a:s;var u=s>0?1:0,d=e.getStartPositionOfLine(e.getLineOfLocalPosition(t,c)+u,t);return d=l(t.text,d),e.getStartPositionOfLine(e.getLineOfLocalPosition(t,d),t)}function u(t,n,i){if(i.useNonAdjustedEndPosition||e.isExpression(n))return n.getEnd();var r=n.getEnd(),s=e.skipTrivia(t.text,r,!0);return s!==r&&e.isLineBreak(t.text.charCodeAt(s-1))?s:r}function d(e,t){return t&&e.parent&&(26===t.kind||25===t.kind&&178===e.parent.kind)}!function(e){e[e.FullStart=0]="FullStart",e[e.Start=1]="Start"}(o=t.Position||(t.Position={})),function(e){e[e.Remove=0]="Remove",e[e.ReplaceWithSingleNode=1]="ReplaceWithSingleNode",e[e.ReplaceWithMultipleNodes=2]="ReplaceWithMultipleNodes"}(a||(a={})),t.getSeparatorCharacter=function(t){return e.tokenToString(t.kind)},t.getAdjustedStartPosition=c,t.getAdjustedEndPosition=u;var p=function(){function t(t,n,i){this.newLine=t,this.rulesProvider=n,this.validator=i,this.changes=[],this.newLineCharacter=e.getNewLineCharacter({newLine:t})}return t.fromContext=function(e){return new t("\n"===e.newLineCharacter?1:0,e.rulesProvider)},t.with=function(e,n){var i=t.fromContext(e);return n(i),i.getChanges()},t.prototype.deleteRange=function(e,t){return this.changes.push({kind:a.Remove,sourceFile:e,range:t}),this},t.prototype.deleteNode=function(e,t,n){void 0===n&&(n={});var i=c(e,t,n,o.FullStart),r=u(e,t,n);return this.changes.push({kind:a.Remove,sourceFile:e,range:{pos:i,end:r}}),this},t.prototype.deleteNodeRange=function(e,t,n,i){void 0===i&&(i={});var r=c(e,t,i,o.FullStart),s=u(e,n,i);return this.changes.push({kind:a.Remove,sourceFile:e,range:{pos:r,end:s}}),this},t.prototype.deleteNodeInList=function(t,n){var i=e.formatting.SmartIndenter.getContainingList(n,t);if(!i)return e.Debug.fail("node is not a list element"),this;var r=e.indexOfNode(i,n);if(r<0)return this;if(1===i.length)return this.deleteNode(t,n),this;if(r!==i.length-1){var s=e.getTokenAtPosition(t,n.end,!1);if(s&&d(n,s)){var a=e.skipTrivia(t.text,c(t,n,{},o.FullStart),!1,!0),l=i[r+1],u=e.skipTrivia(t.text,c(t,l,{},o.FullStart),!1,!0);this.deleteRange(t,{pos:a,end:u})}}else{var p=e.getTokenAtPosition(t,i[r-1].end,!1);p&&d(n,p)&&this.deleteNodeRange(t,p,n)}return this},t.prototype.replaceRange=function(e,t,n,i){return void 0===i&&(i={}),this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:e,range:t,options:i,node:n}),this},t.prototype.replaceNode=function(e,t,n,i){void 0===i&&(i={});var r=c(e,t,i,o.Start),s=u(e,t,i);return this.replaceWithSingle(e,r,s,n,i)},t.prototype.replaceNodeRange=function(e,t,n,i,r){void 0===r&&(r={});var s=c(e,t,r,o.Start),a=u(e,n,r);return this.replaceWithSingle(e,s,a,i,r)},t.prototype.replaceWithSingle=function(e,t,n,i,r){return this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:e,options:r,node:i,range:{pos:t,end:n}}),this},t.prototype.replaceWithMultiple=function(e,t,n,i,r){return this.changes.push({kind:a.ReplaceWithMultipleNodes,sourceFile:e,options:r,nodes:i,range:{pos:t,end:n}}),this},t.prototype.replaceNodeWithNodes=function(e,t,n,i){var r=c(e,t,i,o.Start),s=u(e,t,i);return this.replaceWithMultiple(e,r,s,n,i)},t.prototype.replaceNodesWithNodes=function(t,n,i,r){var s=c(t,n[0],r,o.Start),a=u(t,e.lastOrUndefined(n),r);return this.replaceWithMultiple(t,s,a,i,r)},t.prototype.replaceRangeWithNodes=function(e,t,n,i){return this.replaceWithMultiple(e,t.pos,t.end,n,i)},t.prototype.replaceNodeRangeWithNodes=function(e,t,n,i,r){var s=c(e,t,r,o.Start),a=u(e,n,r);return this.replaceWithMultiple(e,s,a,i,r)},t.prototype.insertNodeAt=function(e,t,n,i){return void 0===i&&(i={}),this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:e,options:i,node:n,range:{pos:t,end:t}}),this},t.prototype.insertNodeBefore=function(e,t,n,i){void 0===i&&(i={});var r=c(e,t,i,o.Start);return this.replaceWithSingle(e,r,r,n,i)},t.prototype.insertNodeAfter=function(t,n,i,r){void 0===r&&(r={}),(e.isStatementButNotDeclaration(n)||149===n.kind||148===n.kind||150===n.kind)&&59!==t.text.charCodeAt(n.end-1)&&this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,options:{},range:{pos:n.end,end:n.end},node:e.createToken(25)});var s=u(t,n,r);return this.replaceWithSingle(t,s,s,i,r)},t.prototype.insertNodeInListAfter=function(t,n,i){var r=e.formatting.SmartIndenter.getContainingList(n,t);if(!r)return e.Debug.fail("node is not a list element"),this;var s=e.indexOfNode(r,n);if(s<0)return this;var o=n.getEnd();if(s!==r.length-1){var c=e.getTokenAtPosition(t,n.end,!1);if(c&&d(n,c)){var u=e.getLineAndCharacterOfPosition(t,l(t.text,r[s+1].getFullStart())),p=e.getLineAndCharacterOfPosition(t,c.end),h=void 0,f=void 0;p.line===u.line?(f=c.end,h=function(e){for(var t="",n=0;n<e;n++)t+=" ";return t}(u.character-p.character)):f=e.getStartPositionOfLine(u.line,t),this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:f,end:r[s+1].getStart(t)},node:i,options:{prefix:h,suffix:""+e.tokenToString(c.kind)+t.text.substring(c.end,r[s+1].getStart(t))}})}}else{var m=n.getStart(t),g=e.getLineStartPositionForPosition(m,t),_=void 0,y=!1;if(1===r.length)_=26;else{var b=e.findPrecedingToken(n.pos,t);_=d(n,b)?b.kind:26,y=e.getLineStartPositionForPosition(r[s-1].getStart(t),t)!==g}if(function(t,n){for(var i=n;i<t.length;){var r=t.charCodeAt(i);if(!e.isWhiteSpaceSingleLine(r))return 47===r;i++}return!1}(t.text,n.end)&&(y=!0),y){this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:o,end:o},node:e.createToken(_),options:{}});var v=e.formatting.SmartIndenter.findFirstNonWhitespaceColumn(g,m,t,this.rulesProvider.getFormatOptions()),T=e.skipTrivia(t.text,o,!0,!1);T!==o&&e.isLineBreak(t.text.charCodeAt(T-1))&&T--,this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:T,end:T},node:i,options:{indentation:v,prefix:this.newLineCharacter}})}else this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:o,end:o},node:i,options:{prefix:e.tokenToString(_)+" "}})}return this},t.prototype.getChanges=function(){for(var n=this,i=e.createMap(),r=0,s=this.changes;r<s.length;r++){var o=s[r],a=i.get(o.sourceFile.path);a||i.set(o.sourceFile.path,a=[]),a.push(o)}var l=[];return i.forEach(function(e){for(var i=e[0].sourceFile,r={fileName:i.fileName,textChanges:[]},s=0,o=t.normalize(e);s<o.length;s++){var a=o[s];r.textChanges.push({span:n.computeSpan(a,i),newText:n.computeNewText(a,i)})}l.push(r)}),l},t.prototype.computeSpan=function(t,n){return e.createTextSpanFromBounds(t.range.pos,t.range.end)},t.prototype.computeNewText=function(t,n){var i=this;if(t.kind===a.Remove)return"";var r,s=t.options||{},o=t.range.pos,l=e.getLineStartPositionForPosition(o,n)===o;t.kind===a.ReplaceWithMultipleNodes?r=t.nodes.map(function(e){return i.getFormattedTextOfNode(e,n,o,s)}).join(t.options.nodeSeparator):(e.Debug.assert(t.kind===a.ReplaceWithSingleNode,"change.kind === ReplaceWithSingleNode"),r=this.getFormattedTextOfNode(t.node,n,o,s));return r=l||void 0!==s.indentation?r:r.replace(/^\s+/,""),(s.prefix||"")+r+(s.suffix||"")},t.prototype.getFormattedTextOfNode=function(t,n,i,r){var s=function(t,n,i){var r={newLine:i,target:n&&n.languageVersion},s=new g(e.getNewLineCharacter(r)),o=e.createPrinter(r,s);return o.writeNode(4,t,n,s),{text:s.getText(),node:f(t)}}(t,n,this.newLine);this.validator&&this.validator(s);var o=this.rulesProvider.getFormatOptions(),a=e.getLineStartPositionForPosition(i,n)===i;return function(t,n,i,r,s){var o=e.computeLineStarts(t.text),a={text:t.text,lineMap:o,getLineAndCharacterOfPosition:function(t){return e.computeLineAndCharacterOfPosition(o,t)}},l=e.formatting.formatNodeGivenIndentation(t.node,a,n.languageVariant,i,r,s);return h(t.text,l)}(s,n,void 0!==r.indentation?r.indentation:!1!==r.useIndentationFromFile?e.formatting.SmartIndenter.getIndentation(i,n,o,a||r.prefix===this.newLineCharacter):0,void 0!==r.delta?r.delta:e.formatting.SmartIndenter.shouldIndentChildNode(t)&&o.indentSize||0,this.rulesProvider)},t.normalize=function(t){for(var n=e.stableSort(t,function(e,t){return e.range.pos-t.range.pos}),i=0;i<n.length-2;i++)e.Debug.assert(n[i].range.end<=n[i+1].range.pos);return n},t}();function h(t,n){for(var i=n.length-1;i>=0;i--){var r=n[i];t=""+t.substring(0,r.span.start)+r.newText+t.substring(e.textSpanEnd(r.span))}return t}function f(t){var i=e.visitEachChild(t,f,e.nullTransformationContext,m,f),s=e.nodeIsSynthesized(i)?i:Object.create(i);return s.pos=n(t),s.end=r(t),s}function m(t,i,s,o,a){var l=e.visitNodes(t,i,s,o,a);if(!l)return l;var c=l===t?e.createNodeArray(l.slice(0)):l;return c.pos=n(t),c.end=r(t),c}t.ChangeTracker=p,t.applyChanges=h;var g=function(){function t(t){var n=this;this.lastNonTriviaPosition=0,this.writer=e.createTextWriter(t),this.onEmitNode=function(e,t,r){t&&i(t,n.lastNonTriviaPosition),r(e,t),t&&s(t,n.lastNonTriviaPosition)},this.onBeforeEmitNodeArray=function(e){e&&i(e,n.lastNonTriviaPosition)},this.onAfterEmitNodeArray=function(e){e&&s(e,n.lastNonTriviaPosition)},this.onBeforeEmitToken=function(e){e&&i(e,n.lastNonTriviaPosition)},this.onAfterEmitToken=function(e){e&&s(e,n.lastNonTriviaPosition)}}return t.prototype.setLastNonTriviaPosition=function(t,n){if(n||!function(t){return e.skipTrivia(t,0)===t.length}(t)){this.lastNonTriviaPosition=this.writer.getTextPos();for(var i=0;e.isWhiteSpaceLike(t.charCodeAt(t.length-i-1));)i++;this.lastNonTriviaPosition-=i}},t.prototype.write=function(e){this.writer.write(e),this.setLastNonTriviaPosition(e,!1)},t.prototype.writeTextOfNode=function(e,t){this.writer.writeTextOfNode(e,t)},t.prototype.writeLine=function(){this.writer.writeLine()},t.prototype.increaseIndent=function(){this.writer.increaseIndent()},t.prototype.decreaseIndent=function(){this.writer.decreaseIndent()},t.prototype.getText=function(){return this.writer.getText()},t.prototype.rawWrite=function(e){this.writer.rawWrite(e),this.setLastNonTriviaPosition(e,!1)},t.prototype.writeLiteral=function(e){this.writer.writeLiteral(e),this.setLastNonTriviaPosition(e,!0)},t.prototype.getTextPos=function(){return this.writer.getTextPos()},t.prototype.getLine=function(){return this.writer.getLine()},t.prototype.getColumn=function(){return this.writer.getColumn()},t.prototype.getIndent=function(){return this.writer.getIndent()},t.prototype.isAtStartOfLine=function(){return this.writer.isAtStartOfLine()},t.prototype.reset=function(){this.writer.reset(),this.lastNonTriviaPosition=0},t}()}(e.textChanges||(e.textChanges={}))}(ts||(ts={})),function(e){!function(t){var n=[];t.registerCodeFix=function(t){e.forEach(t.errorCodes,function(e){var i=n[e];i||(i=[],n[e]=i),i.push(t)})},t.getSupportedErrorCodes=function(){return Object.keys(n)},t.getFixes=function(t){var i=n[t.errorCode],r=[];return e.forEach(i,function(e){var n=e.getCodeActions(t);if(n&&n.length>0)for(var i=0,s=n;i<s.length;i++){var o=s[i];void 0===o?t.host.log("Action for error code "+t.errorCode+" added an invalid action entry; please log a bug"):r.push(o)}}),r}}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){var t,n;t=e.refactor||(e.refactor={}),n=e.createMap(),t.registerRefactor=function(e){n.set(e.name,e)},t.getApplicableRefactors=function(t){return e.flatMapIter(n.values(),function(e){return t.cancellationToken&&t.cancellationToken.isCancellationRequested()?void 0:e.getAvailableActions(t)})},t.getEditsForRefactor=function(e,t,i){var r=n.get(t);return r&&r.getEditsForAction(e,i)},e.getRefactorContextLength=function(e){return void 0===e.endPosition?0:e.endPosition-e.startPosition}}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics._0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0.code],getCodeActions:function(t){var n=t.sourceFile,i=e.getTokenAtPosition(n,t.span.start,!1),r=e.getAncestor(i,147);e.Debug.assert(!!r,"Expected position to be owned by a decorator.");var s=e.createCall(r.expression,void 0,void 0),o=e.textChanges.ChangeTracker.fromContext(t);return o.replaceNode(n,r.expression,s),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Call_decorator_expression),changes:o.getChanges()}]}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1.code],getCodeActions:function(t){var n=t.sourceFile,i=e.getTokenAtPosition(n,t.span.start,!1),r=e.getAncestor(i,143);if(e.Debug.assert(!!r,"Expected position to be owned by a qualified name."),e.isIdentifier(r.left)){var s=r.left.getText(n),o=r.right.getText(n),a=e.createIndexedAccessTypeNode(e.createTypeReferenceNode(r.left,void 0),e.createLiteralTypeNode(e.createLiteral(o))),l=e.textChanges.ChangeTracker.fromContext(t);return l.replaceNode(n,r,a),[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Rewrite_as_the_indexed_access_type_0),[s+'["'+o+'"]']),changes:l.getChanges()}]}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Class_0_incorrectly_implements_interface_1.code],getCodeActions:function(n){var i=n.sourceFile,r=n.span.start,s=e.getTokenAtPosition(i,r,!1),o=n.program.getTypeChecker(),a=e.getContainingClass(s);if(!a)return;for(var l=e.getOpenBraceOfClassLike(a,i),c=o.getTypeAtLocation(a),u=e.getClassImplementsHeritageClauseElements(a),d=!!o.getIndexTypeOfType(c,1),p=!!o.getIndexTypeOfType(c,0),h=[],f=0,m=u;f<m.length;f++){var g=m[f],_=o.getTypeAtLocation(g),y=o.getPropertiesOfType(_).filter(function(t){return!(8&e.getModifierFlags(t.valueDeclaration))}),b=[];T(_,1,d,b),T(_,0,p,b),b=b.concat(t.createMissingMemberNodes(a,y,o));var v=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Implement_interface_0),[g.getText()]);b.length>0&&k(h,b,v)}return h;function T(e,t,n,i){if(!n){var r=o.getIndexInfoOfType(e,t);if(r){var s=o.indexInfoToIndexSignatureDeclaration(r,t,a);i.push(s)}}}function k(e,i,r){e.push({description:r,changes:t.newNodesToChanges(i,l,n)})}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Property_0_does_not_exist_on_type_1.code,e.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2.code],getCodeActions:function(n){var i=n.sourceFile,r=n.span.start,s=e.getTokenAtPosition(i,r,!1);if(71!==s.kind)return;if(!e.isPropertyAccessExpression(s.parent))return;var o,a=s.getText(i),l=!1;if(99===s.parent.expression.kind){var c=e.getThisContainer(s,!1);if(!e.isClassElement(c))return;o=c.parent,l=o&&e.hasModifier(c,32)}else{var u=n.program.getTypeChecker(),d=s.parent.expression,p=u.getTypeAtLocation(d);if(32768&p.flags){var h=p.symbol;32&h.flags&&(o=h.declarations&&h.declarations[0],p!==u.getDeclaredTypeOfSymbol(h)&&(l=!0))}}if(!o||!e.isClassLike(o))return;var f=e.getSourceFileOfNode(o),m=e.getOpenBraceOfClassLike(o,f);return e.isInJavaScriptFile(f)?function(t,i){var r,s=g(!1);s&&(r=[s]);if(i){if(199===t.kind)return r;var o=t.name.getText(),l=e.createStatement(e.createAssignment(e.createPropertyAccess(e.createIdentifier(o),a),e.createIdentifier("undefined"))),c=e.textChanges.ChangeTracker.fromContext(n);c.insertNodeAfter(f,t,l,{prefix:n.newLineCharacter,suffix:n.newLineCharacter});var u={description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Initialize_static_property_0),[a]),changes:c.getChanges()};return(r||(r=[])).push(u),r}var d=e.getFirstConstructorWithBody(t);if(!d)return r;var p=e.createStatement(e.createAssignment(e.createPropertyAccess(e.createThis(),a),e.createIdentifier("undefined"))),h=e.textChanges.ChangeTracker.fromContext(n);h.insertNodeBefore(f,d.body.getLastToken(),p,{suffix:n.newLineCharacter});var m={description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Initialize_property_0_in_the_constructor),[a]),changes:h.getChanges()};return(r||(r=[])).push(m),r}(o,l):function(t,i){var r,o,l=g(!0);l&&(r=[l]);if(194===s.parent.parent.kind){var c=s.parent.parent,u=s.parent===c.left?c.right:c.left,d=n.program.getTypeChecker(),p=d.getWidenedType(d.getBaseTypeOfLiteralType(d.getTypeAtLocation(u)));o=d.typeToTypeNode(p,t)}o=o||e.createKeywordTypeNode(119);var h=e.createProperty(void 0,i?[e.createToken(115)]:void 0,a,void 0,o,void 0),_=e.textChanges.ChangeTracker.fromContext(n);_.insertNodeAfter(f,m,h,{suffix:n.newLineCharacter});var y=i?e.Diagnostics.Declare_static_property_0:e.Diagnostics.Declare_property_0;if(r=e.append(r,{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(y),[a]),changes:_.getChanges()}),!i){var b=e.createKeywordTypeNode(136),v=e.createParameter(void 0,void 0,void 0,"x",void 0,b,void 0),T=e.createIndexSignature(void 0,void 0,[v],o),k=e.textChanges.ChangeTracker.fromContext(n);k.insertNodeAfter(f,m,T,{suffix:n.newLineCharacter}),r.push({description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Add_index_signature_for_property_0),[a]),changes:k.getChanges()})}return r}(o,l);function g(i){if(181===s.parent.parent.kind){var r=s.parent.parent,o=t.createMethodFromCallExpression(r,a,i,l),c=e.textChanges.ChangeTracker.fromContext(n);c.insertNodeAfter(f,m,o,{suffix:n.newLineCharacter});var u=l?e.Diagnostics.Declare_static_method_0:e.Diagnostics.Declare_method_0;return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(u),[a]),changes:c.getChanges()}}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2.code,e.Diagnostics.Cannot_find_name_0_Did_you_mean_1.code],getCodeActions:function(t){var n,i=t.sourceFile,r=e.getTokenAtPosition(i,t.span.start,!1),s=t.program.getTypeChecker();if(e.isPropertyAccessExpression(r.parent)&&r.parent.name===r){e.Debug.assert(71===r.kind);var o=s.getTypeAtLocation(r.parent.expression);n=s.getSuggestionForNonexistentProperty(r,o)}else{var a=e.getMeaningFromLocation(r);n=s.getSuggestionForNonexistentSymbol(r,e.getTextOfNode(r),function(e){var t=0;4&e&&(t|=1920);2&e&&(t|=793064);1&e&&(t|=107455);return t}(a))}if(n)return[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Change_spelling_to_0),[n]),changes:[{fileName:i.fileName,textChanges:[{span:{start:r.getStart(),length:r.getWidth()},newText:n}]}]}]}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(t,n){var i=e.getPackageName(n).packageName;if(t.isKnownTypesPackageName(i)){var r=e.getTypesPackageName(i);return{description:"Install '"+r+"'",changes:[],commands:[{type:"install package",packageName:r}]}}}t.registerCodeFix({errorCodes:[e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type.code],getCodeActions:function(t){var i=t.sourceFile,r=t.span.start,s=e.getTokenAtPosition(i,r,!1);if(!e.isStringLiteral(s))throw e.Debug.fail();var o=n(t.host,s.text);return o&&[o]}}),t.tryGetCodeActionForInstallPackageTypes=n}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(n){var r=n.sourceFile,s=n.span.start,o=e.getTokenAtPosition(r,s,!1),a=n.program.getTypeChecker();if(e.isClassLike(o.parent)){var l=o.parent,c=e.getClassExtendsHeritageClauseElement(l),u=a.getTypeAtLocation(c),d=a.getPropertiesOfType(u).filter(i),p=t.createMissingMemberNodes(l,d,a),h=t.newNodesToChanges(p,e.getOpenBraceOfClassLike(l,r),n);if(h&&h.length>0)return[{description:e.getLocaleSpecificMessage(e.Diagnostics.Implement_inherited_abstract_class),changes:h}]}}function i(t){var n=t.getDeclarations();e.Debug.assert(!!(n&&n.length>0));var i=e.getModifierFlags(n[0]);return!(8&i||!(128&i))}t.registerCodeFix({errorCodes:[e.Diagnostics.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2.code],getCodeActions:n}),t.registerCodeFix({errorCodes:[e.Diagnostics.Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1.code],getCodeActions:n})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class.code],getCodeActions:function(t){var n=t.sourceFile,i=e.getTokenAtPosition(n,t.span.start,!1);if(99===i.kind){var r=e.getContainingFunction(i),s=function t(n){if(210===n.kind&&e.isSuperCall(n.expression))return n;if(e.isFunctionLike(n))return;return e.forEachChild(n,t)}(r.body);if(s){if(s.expression&&181===s.expression.kind)for(var o=s.expression.arguments,a=0;a<o.length;a++)if(o[a].expression===i)return;var l=e.textChanges.ChangeTracker.fromContext(t);return l.insertNodeAfter(n,e.getOpenBrace(r,n),s,{suffix:t.newLineCharacter}),l.deleteNode(n,s),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Make_super_call_the_first_statement_in_the_constructor),changes:l.getChanges()}]}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Constructors_for_derived_classes_must_contain_a_super_call.code],getCodeActions:function(t){var n=t.sourceFile,i=e.getTokenAtPosition(n,t.span.start,!1);if(123===i.kind){var r=e.textChanges.ChangeTracker.fromContext(t),s=e.createStatement(e.createCall(e.createSuper(),void 0,e.emptyArray));return r.insertNodeAfter(n,e.getOpenBrace(i.parent,n),s,{suffix:t.newLineCharacter}),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Add_missing_super_call),changes:r.getChanges()}]}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_extend_an_interface_0_Did_you_mean_implements.code],getCodeActions:function(t){var n=t.sourceFile,i=t.span.start,r=e.getTokenAtPosition(n,i,!1),s=e.getContainingClass(r);if(71===r.kind&&e.isClassLike(s)){var o=s.heritageClauses;if(o&&o.length>0){var a=o[0].getFirstToken();if(a&&85===a.kind){var l=e.textChanges.ChangeTracker.fromContext(t);l.replaceNode(n,a,e.createToken(108));for(var c=1;c<o.length;c++){var u=o[c].getFirstToken();u&&l.replaceNode(n,u,e.createToken(26))}return[{description:e.getLocaleSpecificMessage(e.Diagnostics.Change_extends_to_implements),changes:l.getChanges()}]}}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_find_name_0_Did_you_mean_the_instance_member_this_0.code],getCodeActions:function(t){var n=t.sourceFile,i=e.getTokenAtPosition(n,t.span.start,!1);if(71===i.kind){var r=e.textChanges.ChangeTracker.fromContext(t);return r.replaceNode(n,i,e.createPropertyAccess(e.createThis(),i)),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Add_this_to_unresolved_variable),changes:r.getChanges()}]}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics._0_is_declared_but_its_value_is_never_read.code,e.Diagnostics.Property_0_is_declared_but_its_value_is_never_read.code],getCodeActions:function(t){var n=t.sourceFile,i=t.span.start,r=e.getTokenAtPosition(n,i,!1);switch(21===r.kind&&(r=e.getTokenAtPosition(n,i+1,!1)),r.kind){case 71:return function(t){var i=t.parent;switch(i.kind){case 226:return function(t,n){switch(n.parent.parent.kind){case 214:var i=n.parent.parent.initializer;return[1===i.declarations.length?l(i):u(n)];case 216:var r=n.parent.parent;return e.Debug.assert(227===r.initializer.kind),[p(r.initializer.declarations[0],e.createObjectLiteral()),o(t)];case 215:return[o(t)];default:var s=n.parent.parent;return 1===s.declarationList.declarations.length?[l(s)]:[u(n)]}}(t,i);case 145:var r=i.parent.typeParameters;if(1===r.length){var h=e.getTokenAtPosition(n,r.pos-1,!1),f=e.getTokenAtPosition(n,r.end,!1);return e.Debug.assert(27===h.kind),e.Debug.assert(29===f.kind),[d(h,f)]}return[u(i)];case 146:return[1===i.parent.parameters.length?l(i):u(i),o(t)];case 237:return[l(e.getAncestor(t,237))];case 242:var m=i.parent;return 1===m.elements.length?a(m):[u(i)];case 239:var g=i;if(g.namedBindings){var _=g.name.getStart(n);return(f=e.getTokenAtPosition(n,g.name.end,!1))&&26===f.kind?[c({pos:_,end:e.skipTrivia(n.text,f.end,!1,!0)})]:[l(g.name)]}return[l(e.getAncestor(g,238))];case 240:return a(i);default:return s()}}(r);case 149:case 240:return[l(r.parent)];default:return s()}function s(){return e.isDeclarationName(r)?[l(r.parent)]:e.isLiteralComputedPropertyDeclarationName(r)?[l(r.parent.parent)]:void 0}function o(t){var i=t.getStart(n,!1);return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Prefix_0_with_an_underscore),{0:r.getText()}),changes:[{fileName:n.path,textChanges:[{span:{start:i,length:0},newText:"_"}]}]}}function a(t){if(t.parent.name){var i=e.getTokenAtPosition(n,t.pos-1,!1);return i&&26===i.kind?[c({pos:i.getStart(),end:t.end})]:void 0}return[l(e.getAncestor(t,238))]}function l(i){return h(e.textChanges.ChangeTracker.fromContext(t).deleteNode(n,i))}function c(i){return h(e.textChanges.ChangeTracker.fromContext(t).deleteRange(n,i))}function u(i){return h(e.textChanges.ChangeTracker.fromContext(t).deleteNodeInList(n,i))}function d(i,r){return h(e.textChanges.ChangeTracker.fromContext(t).deleteNodeRange(n,i,r))}function p(i,r){return h(e.textChanges.ChangeTracker.fromContext(t).replaceNode(n,i,r))}function h(t){return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Remove_declaration_for_Colon_0),{0:r.getText()}),changes:t.getChanges()}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,i,r){return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Change_0_to_1),[i,r]),changes:[{fileName:n,textChanges:[{span:{start:t.getStart(),length:t.getWidth()},newText:r}]}]}}t.registerCodeFix({errorCodes:[e.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments.code],getCodeActions:function(t){var i=t.sourceFile,r=e.getTokenAtPosition(i,t.span.start,!1),s=e.findAncestor(r,function(e){return 202===e.kind||155===e.kind||156===e.kind||228===e.kind||153===e.kind||157===e.kind||172===e.kind||151===e.kind||150===e.kind||146===e.kind||149===e.kind||148===e.kind||154===e.kind||231===e.kind||184===e.kind||226===e.kind});if(!s)return;var o=t.program.getTypeChecker(),a=s.type;if(!a)return;var l=e.getTextOfNode(a),c=o.getTypeFromTypeNode(a),u=[n(a,i.fileName,l,o.typeToString(c,void 0,8))];if(270===a.kind){var d=o.typeToString(o.getNullableType(c,2048),void 0,8);u.push(n(a,i.fileName,l,d))}return u}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){var n,i=e.textChanges.ChangeTracker;t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_find_name_0.code,e.Diagnostics.Cannot_find_name_0_Did_you_mean_1.code,e.Diagnostics.Cannot_find_namespace_0.code,e.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead.code],getCodeActions:function(t){var n=function(t){var n=!!t.host.useCaseSensitiveFileNames&&t.host.useCaseSensitiveFileNames(),i=t.program.getTypeChecker(),r=e.getTokenAtPosition(t.sourceFile,t.span.start,!1);return{host:t.host,newLineCharacter:t.newLineCharacter,rulesProvider:t.rulesProvider,sourceFile:t.sourceFile,checker:i,compilerOptions:t.program.getCompilerOptions(),cachedImportDeclarations:[],getCanonicalFileName:e.createGetCanonicalFileName(n),symbolName:r.getText(),symbolToken:r}}(t);return t.errorCode===e.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead.code?function(t){var n,i,r=t.checker,s=t.symbolToken,a=r.getSymbolAtLocation(s);2097152&a.flags?(n=r.getAliasedSymbol(a),i=t.symbolName):e.isJsxOpeningLikeElement(s.parent)&&s.parent.tagName===s?i=(n=r.getAliasedSymbol(r.resolveName(r.getJsxNamespace(),s.parent.tagName,107455))).name:e.Debug.fail("Either the symbol or the JSX namespace should be a UMD global if we got here");return o(n,__assign({},t,{symbolName:i,kind:2}))}(n):function(t,n,i){var s=t.sourceFile,a=t.checker,l=t.symbolName,c=t.symbolToken;e.Debug.assert("default"!==l);var u=new r,d=e.getMeaningFromLocation(c);return m(a,n,function(n){if(n!==s.symbol){i.throwIfCancellationRequested();var r=a.tryGetMemberInModuleExports("default",n);if(r){var c=e.getLocalSymbolForExportDefault(r);if(c&&c.escapedName===l&&f(c,d)){var p=e.getUniqueSymbolId(c,a);u.addActions(p,o(n,__assign({},t,{kind:1})))}}var h=a.tryGetMemberInModuleExportsAndProperties(l,n);if(h&&f(h,d)){p=e.getUniqueSymbolId(h,a);u.addActions(p,o(n,__assign({},t,{kind:0})))}}}),u.getAllActions()}(n,t.program.getSourceFiles(),t.cancellationToken)}}),function(e){e[e.Better=0]="Better",e[e.Equal=1]="Equal",e[e.Worse=2]="Worse"}(n||(n={}));var r=function(){function t(){this.symbolIdToActionMap=[]}return t.prototype.addAction=function(e,t){var n=this.symbolIdToActionMap[e];if(n)if("CodeChange"!==t.kind){for(var i=[],r=0,s=this.symbolIdToActionMap[e];r<s.length;r++){var o=s[r];if("CodeChange"!==o.kind)switch(this.compareModuleSpecifiers(o.moduleSpecifier,t.moduleSpecifier)){case 0:if("NewImport"===t.kind)return;case 1:i.push(o);break;case 2:continue}else i.push(o)}i.push(t),this.symbolIdToActionMap[e]=i}else n.push(t);else this.symbolIdToActionMap[e]=[t]},t.prototype.addActions=function(e,t){for(var n=0,i=t;n<i.length;n++){var r=i[n];this.addAction(e,r)}},t.prototype.getAllActions=function(){var t=[];for(var n in this.symbolIdToActionMap)t=e.concatenate(t,this.symbolIdToActionMap[n]);return t},t.prototype.compareModuleSpecifiers=function(t,n){if(t===n)return 1;if(0===n.indexOf(t))return 0;if(0===t.indexOf(n))return 2;if(e.isExternalModuleNameRelative(t)&&e.isExternalModuleNameRelative(n)){var i=new RegExp(e.directorySeparator,"g"),r=(t.match(i)||[]).length,s=(n.match(i)||[]).length;return r<s?0:r===s?1:2}return 1},t}();function s(t,n,i,r,s){return{description:e.formatMessage.apply(void 0,[void 0,t].concat(n)),changes:i,kind:r,moduleSpecifier:s}}function o(t,n){var r=function(t,n,i,r){var s=i.imports;void 0===r&&(r=[]);var o=e.getUniqueSymbolId(t,n),a=r[o];a||(a=r[o]=e.mapDefined(s,function(i){return n.getSymbolAtLocation(i)===t?function(t){var n=t.parent;switch(n.kind){case 238:return n;case 248:return n.parent;default:return void e.Debug.assert(244===n.kind)}}(i):void 0}));return a}(t,n.checker,n.sourceFile,n.cachedImportDeclarations),o=[];if(n.symbolToken)for(var f=0,m=r;f<m.length;f++){var g=a(m[f]);g&&o.push(h(g.text,n,n.symbolToken))}return o.push(function(t,n,r){var o=e.firstDefined(r,function(t){if(238===t.kind&&t.importClause){var r=function(t,n){var r=t.symbolName,s=t.sourceFile,o=t.kind,a=n.name,l=n.namedBindings;switch(o){case 1:return a?void 0:i.with(t,function(t){return t.replaceNode(s,n,e.createImportClause(e.createIdentifier(r),l))});case 0:var c=e.createImportSpecifier(void 0,e.createIdentifier(r));return l&&241===l.kind&&0!==l.elements.length?i.with(t,function(e){return e.insertNodeInListAfter(s,l.elements[l.elements.length-1],c)}):!l||241===l.kind&&0===l.elements.length?i.with(t,function(t){return t.replaceNode(s,n,e.createImportClause(a,e.createNamedImports([c])))}):void 0;case 2:return l?void 0:i.with(t,function(t){return t.replaceNode(s,n,e.createImportClause(a,e.createNamespaceImport(e.createIdentifier(r))))});default:e.Debug.assertNever(o)}}(n,t.importClause);if(r){var o=e.stripQuotes(t.moduleSpecifier.getText());return s(e.Diagnostics.Add_0_to_existing_import_declaration_from_1,[n.symbolName,o],r,"InsertingIntoExistingImport",o)}}});if(o)return o;var a=e.firstDefined(r,p)||function(t,n,i,r,s){var o=n.valueDeclaration.getSourceFile().fileName,a=e.getDirectoryPath(t.fileName);return function(t){var n=t.valueDeclaration;if(e.isModuleDeclaration(n)&&e.isStringLiteral(n.name))return n.name.text}(n)||function(t,n,i,r){var s=e.getEffectiveTypeRoots(t,n);return s&&e.firstDefined(s,function(t){var n=e.toPath(t,void 0,i);if(e.startsWith(r,n))return c(r.substring(n.length+1))})}(i,s,r,o)||function(t,n,i,r,s){if(e.getEmitModuleResolutionKind(t)!==e.ModuleResolutionKind.NodeJs)return;var o=function(e){var t,n=0,i=0,r=0,s=0;!function(e){e[e.BeforeNodeModules=0]="BeforeNodeModules",e[e.NodeModules=1]="NodeModules",e[e.Scope=2]="Scope",e[e.PackageContent=3]="PackageContent"}(t||(t={}));var o=0,a=0,l=0;for(;a>=0;)switch(o=a,a=e.indexOf("/",o+1),l){case 0:e.indexOf("/node_modules/",o)===o&&(n=o,i=a,l=1);break;case 1:case 2:1===l&&"@"===e.charAt(o+1)?l=2:(r=a,l=3);break;case 3:l=e.indexOf("/node_modules/",o)===o?1:3}return s=o,l>1?{topLevelNodeModulesIndex:n,topLevelPackageNameIndex:i,packageRootIndex:r,fileNameIndex:s}:void 0}(n);if(!o)return;var a=l(n);return a=c(a),e.getPackageNameFromAtTypesDirectory(a);function l(t){var n=t.substring(0,o.packageRootIndex),s=e.combinePaths(n,"package.json");if(i.fileExists(s)){var a=JSON.parse(i.readFile(s));if(a){var l=a.typings||a.types||a.main;if(l)if(e.toPath(l,n,r)===r(t))return n}}var c=e.removeFileExtension(t);return"/index"===r(c.substring(o.fileNameIndex))?c.substring(0,o.fileNameIndex):c}function c(e){var t=e.substring(0,o.topLevelNodeModulesIndex);return 0===s.indexOf(t)?e.substring(o.topLevelPackageNameIndex+1):d(e,s,r)}}(i,o,s,r,a)||function(t,n,i){if(!t.baseUrl)return;var r=u(n,t.baseUrl,i);if(!r)return;var s=e.removeFileExtension(r);if(r=c(r),t.paths)for(var o in t.paths)for(var a=0,l=t.paths[o];a<l.length;a++){var d=l[a],p=d.indexOf("*");if(0!==p||1!==d.length)if(-1!==p){var h=d.substr(0,p),f=d.substr(p+1);if(r.length>=h.length+f.length&&e.startsWith(r,h)&&e.endsWith(r,f)){var m=r.substr(h.length,r.length-f.length);return o.replace("*",m)}}else if(d===r||d===s)return o}return r}(i,o,r)||i.rootDirs&&function(t,n,i,r){var s=l(n,t,r);if(void 0===s)return;var o=l(i,t,r),a=void 0!==o?d(s,o,r):s;return e.removeFileExtension(a)}(i.rootDirs,o,a,r)||e.removeFileExtension(d(o,a,r))}(n.sourceFile,t,n.compilerOptions,n.getCanonicalFileName,n.host);return function(t,n){var r=t.kind,o=t.sourceFile,a=t.newLineCharacter,l=t.symbolName,c=e.findLast(o.statements,e.isAnyImportSyntax),u=e.stripQuotes(n),d=e.createImportDeclaration(void 0,void 0,function(t,n){var i=e.createIdentifier(n);switch(t){case 1:return e.createImportClause(i,void 0);case 2:return e.createImportClause(void 0,e.createNamespaceImport(i));case 0:return e.createImportClause(void 0,e.createNamedImports([e.createImportSpecifier(void 0,i)]));default:e.Debug.assertNever(t)}}(r,l),function(t,n){var i=e.createLiteral(n),r=e.firstOrUndefined(t.imports);return i.singleQuote=!!r&&!e.isStringDoubleQuoted(r,t),i}(o,u)),p=i.with(t,function(t){c?t.insertNodeAfter(o,c,d,{suffix:a}):t.insertNodeAt(o,e.getSourceFileImportLocation(o),d,{suffix:""+a+a})});return s(e.Diagnostics.Import_0_from_1,[l,u],p,"NewImport",u)}(n,a)}(t,n,r)),o}function a(e){if(238===e.kind){var t=e.importClause&&e.importClause.namedBindings;return t&&240===t.kind?t.name:void 0}return e.name}function l(t,n,i){return e.firstDefined(n,function(e){return u(t,e,i)})}function c(t){return t=e.removeFileExtension(t),e.endsWith(t,"/index")&&(t=t.substr(0,t.length-6)),t}function u(t,n,i){var r=e.getRelativePathToDirectoryOrUrl(n,t,n,i,!1);return e.isRootedDiskPath(r)||e.startsWith(r,"..")?void 0:r}function d(t,n,i){var r=e.getRelativePathToDirectoryOrUrl(n,t,n,i,!1);return e.pathIsRelative(r)?r:"./"+r}function p(t){var n=238===t.kind?t.moduleSpecifier:248===t.moduleReference.kind?t.moduleReference.expression:void 0;return n&&e.isStringLiteral(n)?n.text:void 0}function h(t,n,r){var o=n.symbolName,a=n.sourceFile;return s(e.Diagnostics.Change_0_to_1,[o,t+"."+o],i.with(n,function(n){return n.replaceNode(a,r,e.createPropertyAccess(e.createIdentifier(t),o))}),"CodeChange",void 0)}function f(t,n){var i=t.declarations;return e.some(i,function(t){return!!(e.getMeaningFromDeclaration(t)&n)})}function m(t,n,i){for(var r=0,s=t.getAmbientModules();r<s.length;r++){i(s[r])}for(var o=0,a=n;o<a.length;o++){var l=a[o];e.isExternalOrCommonJsModule(l)&&i(l.symbol)}}!function(e){e[e.Named=0]="Named",e[e.Default=1]="Default",e[e.Namespace=2]="Namespace"}(t.ImportKind||(t.ImportKind={})),t.getCodeActionForImport=o,t.forEachExternalModule=m}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){var n;function i(t,n,i){var r=e.getLineAndCharacterOfPosition(t,n).line,s=e.getStartPositionOfLine(r,t),o=e.getFirstNonSpaceCharacterPosition(t.text,s);if(!e.isInComment(t,o)&&!e.isInString(t,o)&&!e.isInTemplateString(t,o)){var a=e.getTouchingToken(t,o,!1),l=e.getLeadingCommentRangesOfNode(a,t);if(!l||!l.length||l[0].pos>=o)return{span:{start:o,length:0},newText:"// @ts-ignore"+i}}return{span:{start:n,length:0},newText:(n===o?"":i)+"// @ts-ignore"+i}}t.registerCodeFix({errorCodes:(n=e.Diagnostics,Object.keys(n).filter(function(t){return n[t]&&n[t].category===e.DiagnosticCategory.Error}).map(function(e){return n[e].code})),getCodeActions:function(t){var n=t.sourceFile,r=t.program,s=t.newLineCharacter,o=t.span;if(!e.isInJavaScriptFile(n)||!e.isCheckJsEnabledForFile(n,r.getCompilerOptions()))return;return[{description:e.getLocaleSpecificMessage(e.Diagnostics.Ignore_this_error_message),changes:[{fileName:n.fileName,textChanges:[i(n,o.start,s)]}]},{description:e.getLocaleSpecificMessage(e.Diagnostics.Disable_checking_for_this_file),changes:[{fileName:n.fileName,textChanges:[{span:{start:n.checkJsDirective?n.checkJsDirective.pos:0,length:n.checkJsDirective?n.checkJsDirective.end-n.checkJsDirective.pos:0},newText:"// @ts-nocheck"+s}]}]}]}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,o){var a=t.getDeclarations();if(a&&a.length){var l=a[0],c=e.getSynthesizedClone(e.getNameOfDeclaration(l)),u=function(t){if(4&t)return e.createToken(114);if(16&t)return e.createToken(113);return}(e.getModifierFlags(l)),d=u?e.createNodeArray([u]):void 0,p=o.getWidenedType(o.getTypeOfSymbolAtLocation(t,n)),h=!!(16777216&t.flags);switch(l.kind){case 153:case 154:case 148:case 149:var f=o.typeToTypeNode(p,n);return e.createProperty(void 0,d,c,h?e.createToken(55):void 0,f,void 0);case 150:case 151:var m=o.getSignaturesOfType(p,0);if(!e.some(m))return;if(1===a.length)return e.Debug.assert(1===m.length),v(m[0],n,s());for(var g=[],_=0;_<m.length;_++){(y=v(m[_],n))&&g.push(y)}if(a.length>m.length){var y;(y=v(o.getSignatureFromDeclaration(a[a.length-1]),n,s()))&&g.push(y)}else{e.Debug.assert(a.length===m.length);var b=function(t,n,s,o){for(var a=t[0],l=t[0].minArgumentCount,c=!1,u=0;u<t.length;u++){var d=t[u];l=Math.min(d.minArgumentCount,l),d.hasRestParameter&&(c=!0),d.parameters.length>=a.parameters.length&&(!d.hasRestParameter||a.hasRestParameter)&&(a=d)}var p=a.parameters.length-(a.hasRestParameter?1:0),h=a.parameters.map(function(e){return e.name}),f=i(p,h,l,!0);if(c){var m=e.createArrayTypeNode(e.createKeywordTypeNode(119)),g=e.createParameter(void 0,void 0,e.createToken(24),h[p]||"rest",p>=l?e.createToken(55):void 0,m,void 0);f.push(g)}return r(o,n,s,void 0,f,void 0)}(m,c,h,d);g.push(b)}return g;default:return}}function v(t,n,i){var r=o.signatureToSignatureDeclaration(t,151,n,e.NodeBuilderFlags.SuppressAnyReturnType);return r&&(r.decorators=void 0,r.modifiers=d,r.name=c,r.questionToken=h?e.createToken(55):void 0,r.body=i),r}}function i(t,n,i,r){for(var s=[],o=0;o<t;o++){var a=e.createParameter(void 0,void 0,void 0,n&&n[o]||"arg"+o,void 0!==i&&o>=i?e.createToken(55):void 0,r?e.createKeywordTypeNode(119):void 0,void 0);s.push(a)}return s}function r(t,n,i,r,o,a){return e.createMethod(void 0,t,void 0,n,i?e.createToken(55):void 0,r,o,a,s())}function s(){return e.createBlock([e.createThrow(e.createNew(e.createIdentifier("Error"),void 0,[e.createLiteral("Method not implemented.")]))],!0)}t.newNodesToChanges=function(t,n,i){for(var r=i.sourceFile,s=e.textChanges.ChangeTracker.fromContext(i),o=0,a=t;o<a.length;o++){var l=a[o];s.insertNodeAfter(r,n,l,{suffix:i.newLineCharacter})}var c=s.getChanges();return e.some(c)?(e.Debug.assert(1===c.length),[{fileName:c[0].fileName,textChanges:[{span:c[0].textChanges[0].span,newText:c[0].textChanges.reduce(function(e,t){return e+t.newText},"")}]}]):c},t.createMissingMemberNodes=function(e,t,i){for(var r=e.symbol.members,s=t.filter(function(e){return!r.has(e.escapedName)}),o=[],a=0,l=s;a<l.length;a++){var c=n(l[a],e,i);c&&(Array.isArray(c)?o=o.concat(c):o.push(c))}return o},t.createMethodFromCallExpression=function(t,n,r,o){var a,l=i(t.arguments.length,void 0,void 0,r);if(r)for(var c=e.length(t.typeArguments),u=0;u<c;u++){var d=c<8?String.fromCharCode(84+u):"T"+u,p=e.createTypeParameterDeclaration(d,void 0,void 0);(a||(a=[])).push(p)}return e.createMethod(void 0,o?[e.createToken(115)]:void 0,void 0,n,void 0,a,l,r?e.createKeywordTypeNode(119):void 0,s())},t.createStubbedMethod=r}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){var n;t.registerCodeFix({errorCodes:[e.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined.code,e.Diagnostics.Variable_0_implicitly_has_an_1_type.code,e.Diagnostics.Parameter_0_implicitly_has_an_1_type.code,e.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type.code,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation.code,e.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type.code,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation.code,e.Diagnostics.Member_0_implicitly_has_an_1_type.code],getCodeActions:function(t){var i,r=t.sourceFile,s=t.program,o=t.span.start,a=t.errorCode,l=t.cancellationToken,c=e.getTokenAtPosition(r,o,!1);if(e.isInJavaScriptFile(c))return;switch(c.kind){case 71:case 24:case 114:case 112:case 113:case 131:break;default:return}var u=e.getContainingFunction(c),d=s.getTypeChecker();switch(a){case e.Diagnostics.Member_0_implicitly_has_an_1_type.code:case e.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined.code:return p(c.parent);case e.Diagnostics.Variable_0_implicitly_has_an_1_type.code:return function(e){var t=d.getSymbolAtLocation(e);return t&&t.valueDeclaration&&p(t.valueDeclaration)}(c);case e.Diagnostics.Parameter_0_implicitly_has_an_1_type.code:if(e.isSetAccessor(u))return h(u);case e.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type.code:return function(t){if(!e.isIdentifier(t.name)||!function(e){switch(e.kind){case 228:case 151:case 152:return!0;case 186:return!!e.name}return!1}(u))return;var i=function(e){switch(e.kind){case 152:case 186:case 228:case 151:var t=152===e.kind?b(e,r,123):e.name;if(t)return n.inferTypeForParametersFromReferences(m(t),e,d,l)}}(u)||e.map(u.parameters,function(t){return e.isIdentifier(t.name)&&g(t.name)});if(!i)return;var s=e.zipWith(u.parameters,i,function(e,t){if(t&&!e.type&&!e.initializer){var n=y(t,u);return n?{span:{start:e.end,length:0},newText:": "+n}:void 0}}).filter(function(e){return!!e});return s.length?[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Infer_parameter_types_from_usage),[t.name.getText()]),changes:[{fileName:r.fileName,textChanges:s}]}]:void 0}(c.parent);case e.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation.code:case e.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type.code:return e.isGetAccessor(u)?function(t){if(!e.isIdentifier(t.name))return;var n=g(t.name),i=n&&y(n,u);if(!i)return;var s=b(t,r,20);return f(t.name.getText(),s.getEnd(),": "+i)}(u):void 0;case e.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation.code:return e.isSetAccessor(u)?h(u):void 0}return;function p(t){if(e.isIdentifier(t.name)){var n=g(t.name),i=n&&y(n,t);if(i)return f(t.name.getText(),t.name.getEnd(),": "+i)}}function h(t){var n=t.parameters[0];if(n&&e.isIdentifier(t.name)&&e.isIdentifier(n.name)){var i=g(t.name)||g(n.name),r=i&&y(i,u);if(r)return f(t.name.getText(),n.name.getEnd(),": "+r)}}function f(t,n,i){return[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Infer_type_of_0_from_usage),[t]),changes:[{fileName:r.fileName,textChanges:[{span:{start:n,length:0},newText:i}]}]}]}function m(t){var n=e.FindAllReferences.findReferencedSymbols(s,l,s.getSourceFiles(),t.getSourceFile(),t.getStart());return e.Debug.assert(!!n,"Found no references!"),e.Debug.assert(1===n.length,"Found more references than expected"),e.map(n[0].references,function(t){return e.getTokenAtPosition(s.getSourceFile(t.fileName),t.textSpan.start,!1)})}function g(e){return n.inferTypeFromReferences(m(e),d,l)}function _(){if(!i){var t="",n=!0,r=function(e){return t+=e};i={string:function(){return n?t:void 0},writeKeyword:r,writeOperator:r,writePunctuation:r,writeSpace:r,writeStringLiteral:r,writeParameter:r,writeProperty:r,writeSymbol:r,writeLine:function(){return t+=" "},increaseIndent:e.noop,decreaseIndent:e.noop,clear:function(){t="",n=!0},trackSymbol:function(e,t,i){0!==d.isSymbolAccessible(e,t,i,!1).accessibility&&(n=!1)},reportInaccessibleThisError:function(){n=!1},reportPrivateInBaseOfClassExpression:function(){n=!1}}}return i.clear(),i}function y(e,t){var n=_();return d.getSymbolDisplayBuilder().buildTypeDisplay(e,n,t),n.string()}function b(e,t,n){for(var i=0,r=e.getChildren(t);i<r.length;i++){var s=r[i];if(s.kind===n)return s}}}}),function(t){function n(t,r,s){for(;e.isRightSideOfQualifiedNameOrPropertyAccess(t);)t=t.parent;switch(t.parent.kind){case 193:s.isNumber=!0;break;case 192:!function(e,t){switch(e.operator){case 43:case 44:case 38:case 52:t.isNumber=!0;break;case 37:t.isNumberOrString=!0}}(t.parent,s);break;case 194:!function(t,n,i,r){switch(n.operatorToken.kind){case 40:case 39:case 41:case 42:case 45:case 46:case 47:case 48:case 49:case 50:case 60:case 62:case 61:case 63:case 64:case 68:case 69:case 70:case 65:case 67:case 66:case 38:case 27:case 30:case 29:case 31:var s=i.getTypeAtLocation(n.left===t?n.right:n.left);272&s.flags?a(r,s):r.isNumber=!0;break;case 59:case 37:var o=i.getTypeAtLocation(n.left===t?n.right:n.left);272&o.flags?a(r,o):84&o.flags?r.isNumber=!0:262178&o.flags?r.isString=!0:r.isNumberOrString=!0;break;case 58:case 32:case 34:case 35:case 33:a(r,i.getTypeAtLocation(n.left===t?n.right:n.left));break;case 92:t===n.left&&(r.isString=!0);break;case 54:t!==n.left||226!==t.parent.parent.kind&&!e.isAssignmentExpression(t.parent.parent,!0)||a(r,i.getTypeAtLocation(n.right))}}(t,t.parent,r,s);break;case 257:case 258:!function(e,t,n){a(n,t.getTypeAtLocation(e.parent.parent.expression))}(t.parent,r,s);break;case 181:case 182:t.parent.expression===t?function(e,t,i){var r={argumentTypes:[],returnType:{}};if(e.arguments)for(var s=0,o=e.arguments;s<o.length;s++){var a=o[s];r.argumentTypes.push(t.getTypeAtLocation(a))}n(e,t,r.returnType),181===e.kind?(i.callContexts||(i.callContexts=[])).push(r):(i.constructContexts||(i.constructContexts=[])).push(r)}(t.parent,r,s):i(t,r,s);break;case 179:!function(t,i,r){var s=e.escapeLeadingUnderscores(t.name.text);r.properties||(r.properties=e.createUnderscoreEscapedMap());var o=r.properties.get(s)||{};n(t,i,o),r.properties.set(s,o)}(t.parent,r,s);break;case 180:!function(e,t,i,r){if(t===e.argumentExpression)return void(r.isNumberOrString=!0);var s=i.getTypeAtLocation(e),o={};n(e,i,o),84&s.flags?r.numberIndexContext=o:r.stringIndexContext=o}(t.parent,t,r,s);break;default:return i(t,r,s)}}function i(t,n,i){e.isPartOfExpression(t)&&a(i,n.getContextualType(t))}function r(t,n){if(t.isNumberOrString&&!t.isNumber&&!t.isString)return n.getUnionType([n.getNumberType(),n.getStringType()]);if(t.isNumber)return n.getNumberType();if(t.isString)return n.getStringType();if(t.candidateTypes)return n.getWidenedType(n.getUnionType(e.map(t.candidateTypes,function(e){return n.getBaseTypeOfLiteralType(e)}),!0));if(t.properties&&l(t.properties.get("then"))){var i=s(0,t.properties.get("then").callContexts,!1,n).getCallSignatures().map(function(e){return e.getReturnType()});return n.createPromiseType(i.length?n.getUnionType(i,!0):n.getAnyType())}if(t.properties&&l(t.properties.get("push")))return n.createArrayType(s(0,t.properties.get("push").callContexts,!1,n));if(t.properties||t.callContexts||t.constructContexts||t.numberIndexContext||t.stringIndexContext){var a=e.createUnderscoreEscapedMap(),c=[],u=[],d=void 0,p=void 0;if(t.properties&&t.properties.forEach(function(e,t){var i=n.createSymbol(4,t);i.type=r(e,n)||n.getAnyType(),a.set(t,i)}),t.callContexts)for(var h=0,f=t.callContexts;h<f.length;h++){var m=f[h];c.push(o(m,n))}if(t.constructContexts)for(var g=0,_=t.constructContexts;g<_.length;g++){var y=_[g];u.push(o(y,n))}return t.numberIndexContext&&(p=n.createIndexInfo(r(t.numberIndexContext,n),!1)),t.stringIndexContext&&(d=n.createIndexInfo(r(t.stringIndexContext,n),!1)),n.createAnonymousType(void 0,a,c,u,d,p)}}function s(t,n,i,r){var s=[];if(n)for(var o=0,a=n;o<a.length;o++){var l=a[o];l.argumentTypes.length>t&&(i?s=e.concatenate(s,e.map(l.argumentTypes.slice(t),function(e){return r.getBaseTypeOfLiteralType(e)})):s.push(r.getBaseTypeOfLiteralType(l.argumentTypes[t])))}if(s.length){var c=r.getWidenedType(r.getUnionType(s,!0));return i?r.createArrayType(c):c}}function o(t,n){for(var i=[],s=0;s<t.argumentTypes.length;s++){var o=n.createSymbol(1,e.escapeLeadingUnderscores("arg"+s));o.type=n.getWidenedType(n.getBaseTypeOfLiteralType(t.argumentTypes[s])),i.push(o)}var a=r(t.returnType,n)||n.getVoidType();return n.createSignature(void 0,void 0,void 0,i,a,void 0,t.argumentTypes.length,!1,!1)}function a(e,t){!t||1&t.flags||8192&t.flags||(e.candidateTypes||(e.candidateTypes=[])).push(t)}function l(e){return e&&e.callContexts}t.inferTypeFromReferences=function(e,t,i){for(var s={},o=0,a=e;o<a.length;o++){var l=a[o];i.throwIfCancellationRequested(),n(l,t,s)}return r(s,t)},t.inferTypeForParametersFromReferences=function(t,i,r,s){if(i.parameters){for(var o={},a=0,l=t;a<l.length;a++){var c=l[a];s.throwIfCancellationRequested(),n(c,r,o)}var u=152===i.kind?o.constructContexts:o.callContexts;if(u){for(var d=[],p=0;p<i.parameters.length;p++){for(var h=[],f=e.isRestParameter(i.parameters[p]),m=0,g=u;m<g.length;m++){var _=g[m];_.argumentTypes.length>p&&(f?h=e.concatenate(h,e.map(_.argumentTypes.slice(p),function(e){return r.getBaseTypeOfLiteralType(e)})):h.push(r.getBaseTypeOfLiteralType(_.argumentTypes[p])))}if(h.length){var y=r.getWidenedType(r.getUnionType(h,!0));d[p]=f?r.createArrayType(y):y}}return d}}}}(n||(n={}))}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){!function(){var n="annotate",i={name:"Annotate with type from JSDoc",description:e.Diagnostics.Annotate_with_type_from_JSDoc.message,getEditsForAction:function(i,r){if(n!==r)return e.Debug.fail("actionName !== action: "+n+" !== "+r);var a=e.getTokenAtPosition(i.file,i.startPosition,!1),l=e.findAncestor(a,s);if(!l||l.type)return;var c=e.getJSDocType(l);if(e.isFunctionLikeDeclaration(l)&&(e.getJSDocReturnType(l)||l.parameters.some(function(t){return!!e.getJSDocType(t)}))||c&&146===l.kind)return function(t){var n=t.file,i=e.getTokenAtPosition(n,t.startPosition,!1),r=e.findAncestor(i,e.isFunctionLikeDeclaration),s=e.textChanges.ChangeTracker.fromContext(t),a=function(t){var n=e.getEffectiveTypeParameterDeclarations(t,!0),i=t.parameters.map(function(t){return e.createParameter(t.decorators,t.modifiers,t.dotDotDotToken,t.name,t.questionToken,o(e.getEffectiveTypeAnnotationNode(t,!0)),t.initializer)}),r=o(e.getEffectiveReturnTypeNode(t,!0));switch(t.kind){case 228:return e.createFunctionDeclaration(t.decorators,t.modifiers,t.asteriskToken,t.name,n,i,r,t.body);case 152:return e.createConstructor(t.decorators,t.modifiers,i,t.body);case 186:return e.createFunctionExpression(t.modifiers,t.asteriskToken,t.name,n,i,r,t.body);case 187:return e.createArrowFunction(t.modifiers,n,i,r,t.equalsGreaterThanToken,t.body);case 151:return e.createMethod(t.decorators,t.modifiers,t.asteriskToken,t.name,t.questionToken,n,i,r,t.body);case 153:return e.createGetAccessor(t.decorators,t.modifiers,t.name,t.parameters,r,t.body);case 154:return e.createSetAccessor(t.decorators,t.modifiers,t.name,i,t.body);default:return e.Debug.assertNever(t,"Unexpected SyntaxKind: "+t.kind)}}(r);return e.suppressLeadingAndTrailingTrivia(a),s.replaceRange(n,{pos:r.getStart(),end:r.end},a),{edits:s.getChanges(),renameFilename:void 0,renameLocation:void 0}}(i);if(c)return function(t){var n=t.file,i=e.getTokenAtPosition(n,t.startPosition,!1),r=e.findAncestor(i,s),a=e.getJSDocType(r);if(!r||!a||r.type)return e.Debug.fail("!decl || !jsdocType || decl.type: !"+r+" || !"+a+" || "+r.type);var l=e.textChanges.ChangeTracker.fromContext(t),c=function(t,n){switch(t.kind){case 226:return e.createVariableDeclaration(t.name,n,t.initializer);case 148:return e.createPropertySignature(t.modifiers,t.name,t.questionToken,n,t.initializer);case 149:return e.createProperty(t.decorators,t.modifiers,t.name,t.questionToken,n,t.initializer);default:return e.Debug.fail("Unexpected SyntaxKind: "+t.kind)}}(r,o(a));return e.suppressLeadingAndTrailingTrivia(c),l.replaceRange(n,{pos:r.getStart(),end:r.end},c),{edits:l.getChanges(),renameFilename:void 0,renameLocation:void 0}}(i);e.Debug.assert(!!t,"No applicable refactor found.")},getAvailableActions:function(t){if(e.isInJavaScriptFile(t.file))return;var o=e.getTokenAtPosition(t.file,t.startPosition,!1);if(r(e.findAncestor(o,s)))return[{name:i.name,description:i.description,actions:[{description:i.description,name:n}]}]}};function r(t){return!!t&&(e.isFunctionLikeDeclaration(t)?t.parameters.some(r)||!t.type&&!!e.getJSDocReturnType(t):!t.type&&!!e.getJSDocType(t))}function s(t){return e.isFunctionLikeDeclaration(t)||226===t.kind||146===t.kind||148===t.kind||149===t.kind}function o(t){if(void 0!==t)switch(t.kind){case 268:case 269:return e.createTypeReferenceNode("any",e.emptyArray);case 272:return function(t){return e.createUnionTypeNode([e.visitNode(t.type,o),e.createTypeReferenceNode("undefined",e.emptyArray)])}(t);case 271:return o(t.type);case 270:return function(t){return e.createUnionTypeNode([e.visitNode(t.type,o),e.createTypeReferenceNode("null",e.emptyArray)])}(t);case 274:return function(t){return e.createArrayTypeNode(e.visitNode(t.type,o))}(t);case 273:return function(t){var n=t.parameters&&t.parameters.map(o);return e.createFunctionTypeNode(e.emptyArray,n,t.type)}(t);case 146:return function(t){var n=t.parent.parameters.indexOf(t),i=274===t.type.kind&&n===t.parent.parameters.length-1,r=t.name||(i?"rest":"arg"+n),s=i?e.createToken(24):t.dotDotDotToken;return e.createParameter(t.decorators,t.modifiers,s,r,t.questionToken,e.visitNode(t.type,o),t.initializer)}(t);case 159:return function(t){var n=t.typeName,i=t.typeArguments;if(e.isIdentifier(t.typeName)){if(e.isJSDocIndexSignature(t))return function(t){var n=e.createParameter(void 0,void 0,void 0,133===t.typeArguments[0].kind?"n":"s",void 0,e.createTypeReferenceNode(133===t.typeArguments[0].kind?"number":"string",[]),void 0),i=e.createTypeLiteralNode([e.createIndexSignature(void 0,void 0,[n],t.typeArguments[1])]);return e.setEmitFlags(i,1),i}(t);var r=t.typeName.text;switch(t.typeName.text){case"String":case"Boolean":case"Object":case"Number":r=r.toLowerCase();break;case"array":case"date":case"promise":r=r[0].toUpperCase()+r.slice(1)}n=e.createIdentifier(r),i="Array"!==r&&"Promise"!==r||t.typeArguments?e.visitNodes(t.typeArguments,o):e.createNodeArray([e.createTypeReferenceNode("any",e.emptyArray)])}return e.createTypeReferenceNode(n,i)}(t);default:var n=e.visitEachChild(t,o,void 0);return e.setEmitFlags(n,1),n}}t.registerRefactor(i)}(t.annotateWithTypeFromJSDoc||(t.annotateWithTypeFromJSDoc={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){!function(t){!function(){var n="convert",i={name:"Convert to ES2015 class",description:e.Diagnostics.Convert_function_to_an_ES2015_class.message,getEditsForAction:function(t,i){if(n!==i)return;var s=t.file,o=r(t),a=t.rulesProvider.getFormatOptions().newLineCharacter,l=[],c=[];if(!(19&o.flags))return;var u,d,p=o.valueDeclaration,h=e.textChanges.ChangeTracker.fromContext(t);switch(p.kind){case 228:u=p,g(p),d=function(t){var n=_(o);t.body&&n.unshift(e.createConstructor(void 0,void 0,t.parameters,t.body));var i=b(t,84);return e.createClassDeclaration(void 0,i,t.name,void 0,void 0,n)}(p);break;case 226:u=p.parent.parent,1===p.parent.declarations.length?g(u):g(p,!0),d=function(t){var n=t.initializer;if(!n||186!==n.kind)return;if(71!==t.name.kind)return;var i=_(n.symbol);n.body&&i.unshift(e.createConstructor(void 0,void 0,n.parameters,n.body));var r=b(u,84);return e.createClassDeclaration(void 0,r,t.name,void 0,void 0,i)}(p)}if(!d)return;h.insertNodeAfter(s,u,d,{suffix:a});for(var f=0,m=c;f<m.length;f++){(0,m[f])()}return{edits:h.getChanges(),renameFilename:void 0,renameLocation:void 0};function g(t,n){void 0===n&&(n=!1),l.some(function(n){return e.isNodeDescendantOf(t,n)})||(l.push(t),n?c.push(function(){return h.deleteNodeInList(s,t)}):c.push(function(){return h.deleteNode(s,t)}))}function _(t){var n=[];return t.members&&t.members.forEach(function(e){var t=i(e,void 0);t&&n.push(t)}),t.exports&&t.exports.forEach(function(t){var r=i(t,[e.createToken(115)]);r&&n.push(r)}),n;function i(t,n){if(4&t.flags){var i=t.valueDeclaration,r=i.parent;if(o=r.right,e.isFunctionLike(o)){var o;if(g(r.parent&&210===r.parent.kind?r.parent:r),!r.right)return e.createProperty([],n,t.name,void 0,void 0,void 0);switch(r.right.kind){case 186:var a=r.right,l=e.concatenate(n,b(a,120));return y(r,h=e.createMethod(void 0,l,void 0,i.name,void 0,void 0,a.parameters,void 0,a.body)),h;case 187:var c=r.right,u=c.body,d=void 0;if(207===u.kind)d=u;else{var p=u;d=e.createBlock([e.createReturn(p)])}var h;l=e.concatenate(n,b(c,120));return y(r,h=e.createMethod(void 0,l,void 0,i.name,void 0,void 0,c.parameters,void 0,d)),h;default:if(e.isSourceFileJavaScript(s))return;var f=e.createProperty(void 0,n,i.name,void 0,void 0,r.right);return y(r.parent,f),f}}}}}function y(t,n){e.forEachLeadingCommentRange(s.text,t.pos,function(t,i,r,o){3===r?(t+=2,i-=2):t+=2,e.addSyntheticLeadingComment(n,r,s.text.slice(t,i),o)})}function b(t,n){return e.filter(t.modifiers,function(e){return e.kind===n})}},getAvailableActions:function(t){if(!e.isInJavaScriptFile(t.file))return;var s=r(t);if(!s)return;e.isDeclarationOfFunctionOrClassExpression(s)&&(s=s.valueDeclaration.initializer.symbol);if(16&s.flags&&s.members&&s.members.size>0)return[{name:i.name,description:i.description,actions:[{description:i.description,name:n}]}]}};function r(t){var n=t.startPosition,i=t.file,r=t.program.getTypeChecker(),s=e.getTokenAtPosition(i,n,!1);return r.getSymbolAtLocation(s)}t.registerRefactor(i)}(t.convertFunctionToES6Class||(t.convertFunctionToES6Class={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){!function(t){!function(n){var i,r,s,o,a={name:"Extract Symbol",description:e.getLocaleSpecificMessage(e.Diagnostics.Extract_symbol),getAvailableActions:l,getEditsForAction:c};function l(t){var n=u(t.file,{start:t.startPosition,length:e.getRefactorContextLength(t)}).targetRange;if(void 0!==n){var i=function(t,n){var i=h(t,n),r=i.scopes,s=i.readsAndWrites,o=s.functionErrorsPerScope,a=s.constantErrorsPerScope,l=r.map(function(t,n){var i,r,s=function(t){return e.isFunctionLikeDeclaration(t)?"inner function":e.isClassLike(t)?"method":"function"}(t),l=function(t){return e.isClassLike(t)?"readonly field":"constant"}(t),c=e.isFunctionLikeDeclaration(t)?function(t){switch(t.kind){case 152:return"constructor";case 186:return t.name?"function expression '"+t.name.text+"'":"anonymous function expression";case 228:return"function '"+t.name.text+"'";case 187:return"arrow function";case 151:return"method '"+t.name.getText();case 153:return"'get "+t.name.getText()+"'";case 154:return"'set "+t.name.getText()+"'";default:e.Debug.assertNever(t)}}(t):e.isClassLike(t)?function(e){return 229===e.kind?"class '"+e.name.text+"'":e.name?"class expression '"+e.name.text+"'":"anonymous class expression"}(t):function(e){return 234===e.kind?"namespace '"+e.parent.name.getText()+"'":e.externalModuleIndicator?0:1}(t);return 1===c?(i=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[s,"global"]),r=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[l,"global"])):0===c?(i=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[s,"module"]),r=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[l,"module"])):(i=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1),[s,c]),r=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1),[l,c])),0!==n||e.isClassLike(t)||(r=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_enclosing_scope),[l])),{functionExtraction:{description:i,errors:o[n]},constantExtraction:{description:r,errors:a[n]}}});return l}(n,t);if(void 0!==i){for(var r=[],s=e.createMap(),o=[],l=e.createMap(),c=0,d=0,p=i;d<p.length;d++){var f=p[d],m=f.functionExtraction,g=f.constantExtraction;if(0===m.errors.length){var _=m.description;s.has(_)||(s.set(_,!0),r.push({description:_,name:"function_scope_"+c}))}if(0===g.errors.length){_=g.description;l.has(_)||(l.set(_,!0),o.push({description:_,name:"constant_scope_"+c}))}c++}var y=[];return r.length&&y.push({name:a.name,description:e.getLocaleSpecificMessage(e.Diagnostics.Extract_function),actions:r}),o.length&&y.push({name:a.name,description:e.getLocaleSpecificMessage(e.Diagnostics.Extract_constant),actions:o}),y.length?y:void 0}}}function c(t,n){var i=u(t.file,{start:t.startPosition,length:e.getRefactorContextLength(t)}).targetRange,s=/^function_scope_(\d+)$/.exec(n);if(s){var o=+s[1];return e.Debug.assert(isFinite(o),"Expected to parse a finite number from the function scope index"),function(t,n,i){var s=h(t,n),o=s.scopes,a=s.readsAndWrites,l=a.target,c=a.usagesPerScope,u=a.functionErrorsPerScope,d=a.exposedVariableDeclarations;return e.Debug.assert(!u[i].length,"The extraction went missing? How?"),n.cancellationToken.throwIfCancellationRequested(),function(t,n,i,s,o,a){var l,c=i.usages,u=i.typeParameterUsages,d=i.substitutions,p=a.program.getTypeChecker(),h=n.getSourceFile(),v=f(e.isClassLike(n)?"newMethod":"newFunction",h.text),T=e.isInJavaScriptFile(n),k=e.createIdentifier(v),x=void 0,E=[],S=[];c.forEach(function(n,i){var r=void 0;if(!T){var s=p.getTypeOfSymbolAtLocation(n.symbol,n.node);s=p.getBaseTypeOfLiteralType(s),r=p.typeToTypeNode(s,t,e.NodeBuilderFlags.NoTruncation)}var o=e.createParameter(void 0,void 0,void 0,i,void 0,r);E.push(o),2===n.usage&&(l||(l=[])).push(n),S.push(e.createIdentifier(i))});var C=e.arrayFrom(u.values()).map(function(e){return{type:e,declaration:g(e)}}).sort(_),w=0===C.length?void 0:C.map(function(e){return e.declaration}),I=void 0!==w?w.map(function(t){return e.createTypeReferenceNode(t.name,void 0)}):void 0;if(e.isExpression(t)&&!T){var A=p.getContextualType(t);x=p.typeToTypeNode(A,n,e.NodeBuilderFlags.NoTruncation)}var N,D=function(t,n,i,r,s){var o,a=void 0!==i||n.length>0;if(e.isBlock(t)&&!a&&0===r.size)return{body:e.createBlock(t.statements,!0),returnValueProperty:void 0};var l=!1,c=e.createNodeArray(e.isBlock(t)?t.statements.slice(0):[e.isStatement(t)?t:e.createReturn(t)]);if(a||r.size){var u=e.visitNodes(c,p).slice();if(a&&!s&&e.isStatement(t)){var d=y(n,i);1===d.length?u.push(e.createReturn(d[0].name)):u.push(e.createReturn(e.createObjectLiteral(d)))}return{body:e.createBlock(u,!0),returnValueProperty:o}}return{body:e.createBlock(c,!0),returnValueProperty:void 0};function p(t){if(!l&&219===t.kind&&a){var s=y(n,i);return t.expression&&(o||(o="__return"),s.unshift(e.createPropertyAssignment(o,e.visitNode(t.expression,p)))),1===s.length?e.createReturn(s[0].name):e.createReturn(e.createObjectLiteral(s))}var c=l;l=l||e.isFunctionLikeDeclaration(t)||e.isClassLike(t);var u=r.get(e.getNodeId(t).toString()),d=u?e.getSynthesizedDeepClone(u):e.visitEachChild(t,p,e.nullTransformationContext);return l=c,d}}(t,s,l,d,!!(o.facts&r.HasReturn)),O=D.body,R=D.returnValueProperty;if(e.suppressLeadingAndTrailingTrivia(O),e.isClassLike(n)){var L=T?[]:[e.createToken(112)];o.facts&r.InStaticRegion&&L.push(e.createToken(115)),o.facts&r.IsAsyncFunction&&L.push(e.createToken(120)),N=e.createMethod(void 0,L.length?L:void 0,o.facts&r.IsGenerator?e.createToken(39):void 0,k,void 0,w,E,x,O)}else N=e.createFunctionDeclaration(void 0,o.facts&r.IsAsyncFunction?[e.createToken(120)]:void 0,o.facts&r.IsGenerator?e.createToken(39):void 0,k,w,E,x,O);var P=e.textChanges.ChangeTracker.fromContext(a),M=function(t,n){return e.find(function(t){if(e.isFunctionLikeDeclaration(t)){var n=t.body;if(e.isBlock(n))return n.statements}else{if(e.isModuleBlock(t)||e.isSourceFile(t))return t.statements;if(e.isClassLike(t))return t.members;e.assertTypeIsNever(t)}return e.emptyArray}(n),function(n){return n.pos>=t&&e.isFunctionLikeDeclaration(n)&&!e.isConstructorDeclaration(n)})}((b(o.range)?e.last(o.range):o.range).end,n);M?P.insertNodeBefore(a.file,M,N,{suffix:a.newLineCharacter+a.newLineCharacter}):P.insertNodeBefore(a.file,n.getLastToken(),N,{prefix:e.isLineBreak(h.text.charCodeAt(n.getLastToken().pos))?a.newLineCharacter:a.newLineCharacter+a.newLineCharacter,suffix:a.newLineCharacter});var F=[],B=function(t,n,i){var s=e.createIdentifier(i);if(e.isClassLike(t)){var o=n.facts&r.InStaticRegion?e.createIdentifier(t.name.text):e.createThis();return e.createPropertyAccess(o,s)}return s}(n,o,v),$=e.createCall(B,I,S);o.facts&r.IsGenerator&&($=e.createYield(e.createToken(39),$));o.facts&r.IsAsyncFunction&&($=e.createAwait($));if(s.length&&!l)if(e.Debug.assert(!R),e.Debug.assert(!(o.facts&r.HasReturn)),1===s.length){var U=s[0];F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.getSynthesizedDeepClone(U.name),e.getSynthesizedDeepClone(U.type),$)],U.parent.flags)))}else{for(var V=[],H=[],G=s[0].parent.flags,j=!1,K=0,z=s;K<z.length;K++){U=z[K];V.push(e.createBindingElement(void 0,void 0,e.getSynthesizedDeepClone(U.name)));var W=p.typeToTypeNode(p.getBaseTypeOfLiteralType(p.getTypeAtLocation(U)),n,e.NodeBuilderFlags.NoTruncation);H.push(e.createPropertySignature(void 0,U.symbol.name,void 0,W,void 0)),j=j||void 0!==U.type,G&=U.parent.flags}var q=j?e.createTypeLiteralNode(H):void 0;q&&e.setEmitFlags(q,1),F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.createObjectBindingPattern(V),q,$)],G)))}else if(s.length||l){if(s.length)for(var J=0,Y=s;J<Y.length;J++){var X=(U=Y[J]).parent.flags;2&X&&(X=-3&X|1),F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(U.symbol.name,ie(U.type))],X)))}R&&F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(R,ie(x))],1)));var Z=y(s,l);R&&Z.unshift(e.createShorthandPropertyAssignment(R)),1===Z.length?(e.Debug.assert(!R),F.push(e.createStatement(e.createAssignment(Z[0].name,$))),o.facts&r.HasReturn&&F.push(e.createReturn())):(F.push(e.createStatement(e.createAssignment(e.createObjectLiteral(Z),$))),R&&F.push(e.createReturn(e.createIdentifier(R))))}else o.facts&r.HasReturn?F.push(e.createReturn($)):b(o.range)?F.push(e.createStatement($)):F.push($);var Q=b(o.range)?{pos:e.first(o.range).getStart(),end:e.last(o.range).end}:{pos:o.range.getStart(),end:o.range.end};P.replaceRangeWithNodes(a.file,Q,F,{nodeSeparator:a.newLineCharacter});var ee=P.getChanges(),te=(b(o.range)?e.first(o.range):o.range).getSourceFile().fileName,ne=m(ee,te,v,!1);return{renameFilename:te,renameLocation:ne,edits:ee};function ie(t){if(void 0!==t){for(var n=e.getSynthesizedDeepClone(t),i=n;e.isParenthesizedTypeNode(i);)i=i.type;return e.isUnionTypeNode(i)&&e.find(i.types,function(e){return 139===e.kind})?n:e.createUnionTypeNode([n,e.createKeywordTypeNode(139)])}}}(l,o[i],c[i],d,t,n)}(i,t,o)}var a=/^constant_scope_(\d+)$/.exec(n);if(a){o=+a[1];return e.Debug.assert(isFinite(o),"Expected to parse a finite number from the constant scope index"),function(t,n,i){var s=h(t,n),o=s.scopes,a=s.readsAndWrites,l=a.target,c=a.usagesPerScope,u=a.constantErrorsPerScope,d=a.exposedVariableDeclarations;return e.Debug.assert(!u[i].length,"The extraction went missing? How?"),e.Debug.assert(0===d.length,"Extract constant accepted a range containing a variable declaration?"),n.cancellationToken.throwIfCancellationRequested(),function(t,n,i,s,o){var a=i.substitutions,l=o.program.getTypeChecker(),c=n.getSourceFile(),u=f(e.isClassLike(n)?"newProperty":"newLocal",c.text),d=e.isInJavaScriptFile(n),h=d?void 0:l.typeToTypeNode(l.getContextualType(t),n,e.NodeBuilderFlags.NoTruncation),g=function(t,n){return n.size?i(t):t;function i(t){var r=n.get(e.getNodeId(t).toString());return r?e.getSynthesizedDeepClone(r):e.visitEachChild(t,i,e.nullTransformationContext)}}(t,a);e.suppressLeadingAndTrailingTrivia(g);var _=e.textChanges.ChangeTracker.fromContext(o);if(e.isClassLike(n)){e.Debug.assert(!d);var y=[];y.push(e.createToken(112)),s&r.InStaticRegion&&y.push(e.createToken(115)),y.push(e.createToken(131));var b=e.createProperty(void 0,y,u,void 0,h,g),v=e.createPropertyAccess(s&r.InStaticRegion?e.createIdentifier(n.name.getText()):e.createThis(),e.createIdentifier(u)),T=function(t,n){var i=n.members;e.Debug.assert(i.length>0);for(var r=void 0,s=!0,o=0,a=i;o<a.length;o++){var l=a[o];if(l.pos>t)return r||i[0];if(s&&!e.isPropertyDeclaration(l)){if(void 0!==r)return l;s=!1}r=l}return e.Debug.assert(void 0!==r),r}(t.pos,n);_.insertNodeBefore(o.file,T,b,{suffix:o.newLineCharacter+o.newLineCharacter}),_.replaceRange(o.file,{pos:t.getStart(),end:t.end},v)}else{var x=e.createVariableDeclaration(u,h,g),E=function(t,n){var i=void 0;for(;void 0!==t&&t!==n;){if(e.isVariableDeclaration(t)&&t.initializer===i&&e.isVariableDeclarationList(t.parent)&&t.parent.declarations.length>1)return t;i=t,t=t.parent}}(t,n);if(E){_.insertNodeAt(o.file,E.getStart(),x,{suffix:", "});v=e.createIdentifier(u);_.replaceRange(o.file,{pos:t.getStart(),end:t.end},v)}else if(210===t.parent.kind&&n===e.findAncestor(t,p)){var S=e.createVariableStatement(void 0,e.createVariableDeclarationList([x],2));_.replaceRange(o.file,{pos:t.parent.getStart(),end:t.parent.end},S)}else{S=e.createVariableStatement(void 0,e.createVariableDeclarationList([x],2)),T=function(t,n){e.Debug.assert(!e.isClassLike(n));for(var i=void 0,r=t;r!==n;r=r.parent)p(r)&&(i=r);for(r=(i||t).parent;;r=r.parent){if(k(r)){for(var s=void 0,o=0,a=r.statements;o<a.length;o++){var l=a[o];if(l.pos>t.pos)break;s=l}return e.Debug.assert(void 0!==s),s}if(r===n){e.Debug.fail("Didn't encounter a block-like before encountering scope");break}}}(t,n);if(0===T.pos){var C=e.getSourceFileImportLocation(c);_.insertNodeAt(o.file,C,S,{prefix:0===C?void 0:o.newLineCharacter,suffix:e.isLineBreak(c.text.charCodeAt(C))?o.newLineCharacter:o.newLineCharacter+o.newLineCharacter})}else _.insertNodeBefore(o.file,T,S,{suffix:o.newLineCharacter+o.newLineCharacter});if(210===t.parent.kind)_.deleteRange(o.file,{pos:t.parent.getStart(),end:t.parent.end});else{v=e.createIdentifier(u);_.replaceRange(o.file,{pos:t.getStart(),end:t.end},v)}}}var w=_.getChanges(),I=t.getSourceFile().fileName,A=m(w,I,u,!0);return{renameFilename:I,renameLocation:A,edits:w}}(e.isExpression(l)?l:l.statements[0].expression,o[i],c[i],t.facts,n)}(i,t,o)}e.Debug.fail("Unrecognized action name")}function u(t,n){var s=n.length;if(0===s)return{errors:[e.createFileDiagnostic(t,n.start,s,i.CannotExtractEmpty)]};var o=v(e.getTokenAtPosition(t,n.start,!1),t,n),a=v(e.findTokenOnLeftOfPosition(t,e.textSpanEnd(n)),t,n),l=[],c=r.None;if(!o||!a)return{errors:[e.createFileDiagnostic(t,n.start,s,i.CannotExtractRange)]};if(o.parent!==a.parent)return{errors:[e.createFileDiagnostic(t,n.start,s,i.CannotExtractRange)]};if(o!==a){if(!k(o.parent))return{errors:[e.createFileDiagnostic(t,n.start,s,i.CannotExtractRange)]};for(var u=[],p=0,h=o.parent.statements;p<h.length;p++){var f=h[p];if(f===o||u.length){var m=_(f);if(m)return{errors:m};u.push(f)}if(f===a)break}return{targetRange:{range:u,facts:c,declarations:l}}}var g=function(t){if(e.isIdentifier(e.isExpressionStatement(t)?t.expression:t))return[e.createDiagnosticForNode(t,i.CannotExtractIdentifier)];return}(o)||_(o);return g?{errors:g}:{targetRange:{range:d(o),facts:c,declarations:l}};function _(t){var s;if(function(e){e[e.None=0]="None",e[e.Break=1]="Break",e[e.Continue=2]="Continue",e[e.Return=4]="Return"}(s||(s={})),!(e.isStatement(t)||e.isPartOfExpression(t)&&function(e){if(264===e.parent.kind)return!1;switch(e.kind){case 9:return 238!==e.parent.kind&&242!==e.parent.kind;case 198:case 174:case 176:return!1;case 71:return 176!==e.parent.kind&&242!==e.parent.kind&&246!==e.parent.kind}return!0}(t)))return[e.createDiagnosticForNode(t,i.StatementOrExpressionExpected)];if(e.isInAmbientContext(t))return[e.createDiagnosticForNode(t,i.CannotExtractAmbientBlock)];var o,a=e.getContainingClass(t);a&&function(t,n){for(var i=t;i!==n;){if(149===i.kind){e.hasModifier(i,32)&&(c|=r.InStaticRegion);break}if(146===i.kind){152===e.getContainingFunction(i).kind&&(c|=r.InStaticRegion);break}151===i.kind&&e.hasModifier(i,32)&&(c|=r.InStaticRegion),i=i.parent}}(t,a);var u,d=4;return function t(s){if(o)return!0;if(e.isDeclaration(s)){var a=226===s.kind?s.parent.parent:s;if(e.hasModifier(a,1))return(o||(o=[])).push(e.createDiagnosticForNode(s,i.CannotExtractExportedEntity)),!0;l.push(s.symbol)}switch(s.kind){case 238:return(o||(o=[])).push(e.createDiagnosticForNode(s,i.CannotExtractImport)),!0;case 97:if(181===s.parent.kind){var p=e.getContainingClass(s);if(p.pos<n.start||p.end>=n.start+n.length)return(o||(o=[])).push(e.createDiagnosticForNode(s,i.CannotExtractSuper)),!0}else c|=r.UsesThis}if(!s||e.isFunctionLikeDeclaration(s)||e.isClassLike(s)){switch(s.kind){case 228:case 229:265===s.parent.kind&&void 0===s.parent.externalModuleIndicator&&(o||(o=[])).push(e.createDiagnosticForNode(s,i.FunctionWillNotBeVisibleInTheNewScope))}return!1}var h=d;switch(s.kind){case 211:case 224:d=0;break;case 207:s.parent&&224===s.parent.kind&&s.parent.finallyBlock===s&&(d=4);break;case 257:d|=1;break;default:e.isIterationStatement(s,!1)&&(d|=3)}switch(s.kind){case 169:case 99:c|=r.UsesThis;break;case 222:var f=s.label;(u||(u=[])).push(f.escapedText),e.forEachChild(s,t),u.pop();break;case 218:case 217:(f=s.label)?e.contains(u,f.escapedText)||(o||(o=[])).push(e.createDiagnosticForNode(s,i.CannotExtractRangeContainingLabeledBreakOrContinueStatementWithTargetOutsideOfTheRange)):d&(218===s.kind?1:2)||(o||(o=[])).push(e.createDiagnosticForNode(s,i.CannotExtractRangeContainingConditionalBreakOrContinueStatements));break;case 191:c|=r.IsAsyncFunction;break;case 197:c|=r.IsGenerator;break;case 219:4&d?c|=r.HasReturn:(o||(o=[])).push(e.createDiagnosticForNode(s,i.CannotExtractRangeContainingConditionalReturnStatement));break;default:e.forEachChild(s,t)}d=h}(t),o}}function d(t){return e.isStatement(t)?[t]:e.isPartOfExpression(t)?e.isExpressionStatement(t.parent)?[t.parent]:t:void 0}function p(t){return e.isFunctionLikeDeclaration(t)||e.isSourceFile(t)||e.isModuleBlock(t)||e.isClassLike(t)}function h(t,n){var s=n.file,o=function(t){var n=b(t.range)?e.first(t.range):t.range;if(t.facts&r.UsesThis){var i=e.getContainingClass(n);if(i){var s=e.findAncestor(n,e.isFunctionLikeDeclaration);return s?[s,i]:[i]}}for(var o=[];;)if(146===(n=n.parent).kind&&(n=e.findAncestor(n,function(t){return e.isFunctionLikeDeclaration(t)}).parent),p(n)&&(o.push(n),265===n.kind))return o}(t),a=function(t,n){return b(t.range)?{pos:e.first(t.range).getStart(n),end:e.last(t.range).getEnd()}:t.range}(t,s),l=function(t,n,s,o,a,l){var c=e.createMap(),u=[],d=[],p=[],h=[],f=[],m=e.createMap(),g=[],_=void 0,y=b(t.range)?1===t.range.length&&e.isExpressionStatement(t.range[0])?t.range[0].expression:void 0:t.range,v=void 0;if(void 0===y){var T=t.range,k=e.first(T).getStart(),x=e.last(T).end;v=e.createFileDiagnostic(o,k,x-k,i.ExpressionExpected)}else 9216&a.getTypeAtLocation(y).flags&&(v=e.createDiagnosticForNode(y,i.UselessConstantType));for(var E=0,S=n;E<S.length;E++){var C=S[E];u.push({usages:e.createMap(),typeParameterUsages:e.createMap(),substitutions:e.createMap()}),d.push(e.createMap()),p.push(e.isFunctionLikeDeclaration(C)&&228!==C.kind?[e.createDiagnosticForNode(C,i.CannotExtractToOtherFunctionLike)]:[]);var w=[];v&&w.push(v),e.isClassLike(C)&&e.isInJavaScriptFile(C)&&w.push(e.createDiagnosticForNode(C,i.CannotExtractToJSClass)),e.isArrowFunction(C)&&!e.isBlock(C.body)&&w.push(e.createDiagnosticForNode(C,i.CannotExtractToExpressionArrowFunction)),h.push(w)}var I=e.createMap(),A=b(t.range)?e.createBlock(t.range):t.range,N=b(t.range)?e.first(t.range):t.range,D=G(N);if(K(A),D&&!b(t.range)){j(a.getContextualType(t.range))}if(c.size>0){for(var O=e.createMap(),R=0,L=N;void 0!==L&&R<n.length;L=L.parent)if(L===n[R]&&(O.forEach(function(e,t){u[R].typeParameterUsages.set(t,e)}),R++),e.isDeclarationWithTypeParameters(L)&&L.typeParameters)for(var P=0,M=L.typeParameters;P<M.length;P++){var F=M[P],B=a.getTypeAtLocation(F);c.has(B.id.toString())&&O.set(B.id.toString(),B)}e.Debug.assert(R===n.length)}if(f.length){var $=e.isBlockScope(n[0],n[0].parent)?n[0]:e.getEnclosingBlockScopeContainer(n[0]);e.forEachChild($,q)}for(var U=function(n){var r=u[n];if(n>0&&(r.usages.size>0||r.typeParameterUsages.size>0)){var s=b(t.range)?t.range[0]:t.range;h[n].push(e.createDiagnosticForNode(s,i.CannotAccessVariablesFromNestedScopes))}var o=!1,a=void 0;if(u[n].usages.forEach(function(t){2===t.usage&&(o=!0,106500&t.symbol.flags&&t.symbol.valueDeclaration&&e.hasModifier(t.symbol.valueDeclaration,64)&&(a=t.symbol.valueDeclaration))}),e.Debug.assert(b(t.range)||0===g.length),o&&!b(t.range)){var l=e.createDiagnosticForNode(t.range,i.CannotWriteInExpression);p[n].push(l),h[n].push(l)}else if(a&&n>0){l=e.createDiagnosticForNode(a,i.CannotExtractReadonlyPropertyInitializerOutsideConstructor);p[n].push(l),h[n].push(l)}else if(_){l=e.createDiagnosticForNode(_,i.CannotExtractExportedEntity);p[n].push(l),h[n].push(l)}},V=0;V<n.length;V++)U(V);return{target:A,usagesPerScope:u,functionErrorsPerScope:p,constantErrorsPerScope:h,exposedVariableDeclarations:g};function H(t){return e.isDeclarationWithTypeParameters(t)&&void 0!==t.typeParameters&&t.typeParameters.length>0}function G(e){for(;e;e=e.parent)if(H(e))return!0;return!1}function j(e){for(var t=0,n=a.getSymbolWalker(function(){return l.throwIfCancellationRequested(),!0}).walkType(e).visitedTypes;t<n.length;t++){var i=n[t];16384&i.flags&&c.set(i.id.toString(),i)}}function K(t,n){(void 0===n&&(n=1),D)&&j(a.getTypeAtLocation(t));if(e.isDeclaration(t)&&t.symbol&&f.push(t),e.isAssignmentExpression(t))K(t.left,2),K(t.right);else if(e.isUnaryExpressionWithWrite(t))K(t.operand,2);else if(e.isPropertyAccessExpression(t)||e.isElementAccessExpression(t))e.forEachChild(t,K);else if(e.isIdentifier(t)){if(!t.parent)return;if(e.isQualifiedName(t.parent)&&t!==t.parent.left)return;if(e.isPropertyAccessExpression(t.parent)&&t!==t.parent.expression)return;z(t,n,e.isPartOfTypeNode(t))}else e.forEachChild(t,K)}function z(t,i,r){var s=W(t,i,r);if(s)for(var o=0;o<n.length;o++){var a=d[o].get(s);a&&u[o].substitutions.set(e.getNodeId(t).toString(),a)}}function W(l,c,f){var m=J(l);if(m){var g=e.getSymbolId(m).toString(),_=I.get(g);if(_&&_>=c)return g;if(I.set(g,c),_){for(var y=0,b=u;y<b.length;y++){var v=b[y];v.usages.get(l.text)&&v.usages.set(l.text,{usage:c,symbol:m,node:l})}return g}var T=e.find(m.getDeclarations(),function(e){return e.getSourceFile()===o});if(T&&!e.rangeContainsStartEnd(s,T.getStart(),T.end)){if(t.facts&r.IsGenerator&&2===c){for(var k=e.createDiagnosticForNode(l,i.CannotExtractRangeThatContainsWritesToReferencesLocatedOutsideOfTheTargetRangeInGenerators),x=0,E=p;x<E.length;x++){E[x].push(k)}for(var S=0,C=h;S<C.length;S++){C[S].push(k)}}for(var w=0;w<n.length;w++){var A=n[w];if(a.resolveName(m.name,A,m.flags)!==m&&!d[w].has(g)){var N=Y(m.exportSymbol||m,A,f);if(N)d[w].set(g,N);else if(f){if(!(262144&m.flags)){k=e.createDiagnosticForNode(l,i.TypeWillNotBeVisibleInTheNewScope);p[w].push(k),h[w].push(k)}}else u[w].usages.set(l.text,{usage:c,symbol:m,node:l})}}return g}}}function q(n){if(!(n===t.range||b(t.range)&&t.range.indexOf(n)>=0)){var i=e.isIdentifier(n)?J(n):a.getSymbolAtLocation(n);if(i){var r=e.find(f,function(e){return e.symbol===i});if(r)if(e.isVariableDeclaration(r)){var s=r.symbol.id.toString();m.has(s)||(g.push(r),m.set(s,!0))}else _=_||r}e.forEachChild(n,q)}}function J(t){return t.parent&&e.isShorthandPropertyAssignment(t.parent)&&t.parent.name===t?a.getShorthandAssignmentValueSymbol(t.parent):a.getSymbolAtLocation(t)}function Y(t,n,i){if(t){if(t.getDeclarations().some(function(e){return e.parent===n}))return e.createIdentifier(t.name);var r=Y(t.parent,n,i);if(void 0!==r)return i?e.createQualifiedName(r,e.createIdentifier(t.name)):e.createPropertyAccess(r,t.name)}}}(t,o,a,s,n.program.getTypeChecker(),n.cancellationToken);return{scopes:o,readsAndWrites:l}}function f(t,n){for(var i=t,r=1;e.stringContains(n,i);r++)i=t+"_"+r;return i}function m(t,n,i,r){for(var s=0,o=-1,a=0,l=t;a<l.length;a++){var c=l[a],u=c.fileName,d=c.textChanges;e.Debug.assert(u===n);for(var p=0,h=d;p<h.length;p++){var f=h[p],m=f.span,g=f.newText,_=g.indexOf(i);if(-1!==_&&(o=m.start+s+_,!r))return o;s+=g.length-m.length}}return e.Debug.assert(r),e.Debug.assert(o>=0),o}function g(e){var t=void 0,n=e.symbol;if(n&&n.declarations)for(var i=0,r=n.declarations;i<r.length;i++){var s=r[i];(void 0===t||s.pos<t.pos)&&(t=s)}return t}function _(t,n){var i=t.type,r=t.declaration,s=n.type,o=n.declaration;if(r){if(!o)return 1;var a=r.pos-o.pos;if(0!==a)return a}else if(o)return-1;var l=i.symbol?i.symbol.getName():"",c=s.symbol?s.symbol.getName():"",u=e.compareStrings(l,c);return 0!==u?u:i.id-s.id}function y(t,n){var i=e.map(t,function(t){return e.createShorthandPropertyAssignment(t.symbol.name)}),r=e.map(n,function(t){return e.createShorthandPropertyAssignment(t.symbol.name)});return void 0===i?r:void 0===r?i:i.concat(r)}function b(t){return e.isArray(t)}function v(t,n,i){if(t)for(;t.parent;){if(e.isSourceFile(t.parent)||!T(i,t.parent,n))return t;t=t.parent}}function T(t,n,i){return e.textSpanContainsPosition(t,n.getStart(i))&&n.getEnd()<=e.textSpanEnd(t)}function k(e){switch(e.kind){case 207:case 265:case 234:case 257:return!0;default:return!1}}t.registerRefactor(a),n.getAvailableActions=l,n.getEditsForAction=c,function(t){function n(t){return{message:t,code:0,category:e.DiagnosticCategory.Message,key:t}}t.CannotExtractRange=n("Cannot extract range."),t.CannotExtractImport=n("Cannot extract import statement."),t.CannotExtractSuper=n("Cannot extract super call."),t.CannotExtractEmpty=n("Cannot extract empty range."),t.ExpressionExpected=n("expression expected."),t.UselessConstantType=n("No reason to extract constant of type."),t.StatementOrExpressionExpected=n("Statement or expression expected."),t.CannotExtractRangeContainingConditionalBreakOrContinueStatements=n("Cannot extract range containing conditional break or continue statements."),t.CannotExtractRangeContainingConditionalReturnStatement=n("Cannot extract range containing conditional return statement."),t.CannotExtractRangeContainingLabeledBreakOrContinueStatementWithTargetOutsideOfTheRange=n("Cannot extract range containing labeled break or continue with target outside of the range."),t.CannotExtractRangeThatContainsWritesToReferencesLocatedOutsideOfTheTargetRangeInGenerators=n("Cannot extract range containing writes to references located outside of the target range in generators."),t.TypeWillNotBeVisibleInTheNewScope=n("Type will not visible in the new scope."),t.FunctionWillNotBeVisibleInTheNewScope=n("Function will not visible in the new scope."),t.CannotExtractIdentifier=n("Select more than a single identifier."),t.CannotExtractExportedEntity=n("Cannot extract exported declaration"),t.CannotWriteInExpression=n("Cannot write back side-effects when extracting an expression"),t.CannotExtractReadonlyPropertyInitializerOutsideConstructor=n("Cannot move initialization of read-only class property outside of the constructor"),t.CannotExtractAmbientBlock=n("Cannot extract code from ambient contexts"),t.CannotAccessVariablesFromNestedScopes=n("Cannot access variables from nested scopes"),t.CannotExtractToOtherFunctionLike=n("Cannot extract method to a function-like scope that is not a function"),t.CannotExtractToJSClass=n("Cannot extract constant to a class scope in JS"),t.CannotExtractToExpressionArrowFunction=n("Cannot extract constant to an arrow function without a block")}(i=n.Messages||(n.Messages={})),function(e){e[e.None=0]="None",e[e.HasReturn=1]="HasReturn",e[e.IsGenerator=2]="IsGenerator",e[e.IsAsyncFunction=4]="IsAsyncFunction",e[e.UsesThis=8]="UsesThis",e[e.InStaticRegion=16]="InStaticRegion"}(r||(r={})),n.getRangeToExtract=u,function(e){e[e.Module=0]="Module",e[e.Global=1]="Global"}(s||(s={})),function(e){e[e.Read=1]="Read",e[e.Write=2]="Write"}(o||(o={}))}(t.extractSymbol||(t.extractSymbol={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){!function(t){!function(){var n="install",i={name:"Install missing types package",description:"Install missing types package",getEditsForAction:function(t,i){e.Debug.assertEqual(n,i);var s=r(t);return{edits:[],renameFilename:void 0,renameLocation:void 0,commands:s.commands}},getAvailableActions:function(e){var t=e.program.getCompilerOptions();if(void 0===t.noImplicitAny?t.strict:t.noImplicitAny)return;var s=r(e);return s&&[{name:i.name,description:i.description,actions:[{description:s.description,name:n}]}]}};function r(t){var n=t.file,i=t.startPosition,r=e.getTokenAtPosition(n,i,!1);if(e.isStringLiteral(r)&&function(e){switch(e.parent.kind){case 238:case 248:return!0;default:return!1}}(r)&&void 0===e.getResolvedModule(n,r.text))return e.codefix.tryGetCodeActionForInstallPackageTypes(t.host,r.text)}t.registerRefactor(i)}(t.installTypesForPackage||(t.installTypesForPackage={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){var t;function n(t,n,r,s){var l=e.isNodeKind(t)?new i(t,n,r):71===t?new a(71,n,r):new o(t,n,r);return l.parent=s,l}e.servicesVersion="0.6";var i=function(){function t(e,t,n){this.pos=t,this.end=n,this.flags=0,this.transformFlags=void 0,this.parent=void 0,this.kind=e}return t.prototype.getSourceFile=function(){return e.getSourceFileOfNode(this)},t.prototype.getStart=function(t,n){return e.getTokenPosOfNode(this,t,n)},t.prototype.getFullStart=function(){return this.pos},t.prototype.getEnd=function(){return this.end},t.prototype.getWidth=function(e){return this.getEnd()-this.getStart(e)},t.prototype.getFullWidth=function(){return this.end-this.pos},t.prototype.getLeadingTriviaWidth=function(e){return this.getStart(e)-this.pos},t.prototype.getFullText=function(e){return(e||this.getSourceFile()).text.substring(this.pos,this.end)},t.prototype.getText=function(e){return e||(e=this.getSourceFile()),e.text.substring(this.getStart(e),this.getEnd())},t.prototype.addSyntheticNodes=function(t,i,r){for(e.scanner.setTextPos(i);i<r;){var s=e.scanner.scan(),o=e.scanner.getTextPos();if(o<=r&&t.push(n(s,i,o,this)),i=o,1===s)break}return i},t.prototype.createSyntaxList=function(e){var t=n(286,e.pos,e.end,this);t._children=[];for(var i=e.pos,r=0,s=e;r<s.length;r++){var o=s[r];i<o.pos&&(i=this.addSyntheticNodes(t._children,i,o.pos)),t._children.push(o),i=o.end}return i<e.end&&this.addSyntheticNodes(t._children,i,e.end),t},t.prototype.createChildren=function(t){var n=this;if(e.isNodeKind(this.kind)){if(e.isJSDocCommentContainingNode(this)){var i=[];return this.forEachChild(function(e){i.push(e)}),void(this._children=i)}var r=[];e.scanner.setText((t||this.getSourceFile()).text);var s=this.pos,o=function(e){s=n.addSyntheticNodes(r,s,e.pos),r.push(e),s=e.end};if(this.jsDoc)for(var a=0,l=this.jsDoc;a<l.length;a++){o(l[a])}s=this.pos,e.forEachChild(this,o,function(e){s<e.pos&&(s=n.addSyntheticNodes(r,s,e.pos)),r.push(n.createSyntaxList(e)),s=e.end}),s<this.end&&this.addSyntheticNodes(r,s,this.end),e.scanner.setText(void 0),this._children=r}else this._children=e.emptyArray},t.prototype.getChildCount=function(e){return this._children||this.createChildren(e),this._children.length},t.prototype.getChildAt=function(e,t){return this._children||this.createChildren(t),this._children[e]},t.prototype.getChildren=function(e){return this._children||this.createChildren(e),this._children},t.prototype.getFirstToken=function(t){var n=this.getChildren(t);if(n.length){var i=e.find(n,function(e){return e.kind<267||e.kind>285});return i.kind<143?i:i.getFirstToken(t)}},t.prototype.getLastToken=function(t){var n=this.getChildren(t),i=e.lastOrUndefined(n);if(i)return i.kind<143?i:i.getLastToken(t)},t.prototype.forEachChild=function(t,n){return e.forEachChild(this,t,n)},t}(),r=function(){function t(e,t){this.pos=e,this.end=t,this.flags=0,this.parent=void 0}return t.prototype.getSourceFile=function(){return e.getSourceFileOfNode(this)},t.prototype.getStart=function(t,n){return e.getTokenPosOfNode(this,t,n)},t.prototype.getFullStart=function(){return this.pos},t.prototype.getEnd=function(){return this.end},t.prototype.getWidth=function(e){return this.getEnd()-this.getStart(e)},t.prototype.getFullWidth=function(){return this.end-this.pos},t.prototype.getLeadingTriviaWidth=function(e){return this.getStart(e)-this.pos},t.prototype.getFullText=function(e){return(e||this.getSourceFile()).text.substring(this.pos,this.end)},t.prototype.getText=function(e){return(e||this.getSourceFile()).text.substring(this.getStart(),this.getEnd())},t.prototype.getChildCount=function(){return 0},t.prototype.getChildAt=function(){},t.prototype.getChildren=function(){return e.emptyArray},t.prototype.getFirstToken=function(){},t.prototype.getLastToken=function(){},t.prototype.forEachChild=function(){},t}(),s=function(){function t(e,t){this.flags=e,this.escapedName=t}return t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"name",{get:function(){return e.symbolName(this)},enumerable:!0,configurable:!0}),t.prototype.getEscapedName=function(){return this.escapedName},t.prototype.getName=function(){return this.name},t.prototype.getDeclarations=function(){return this.declarations},t.prototype.getDocumentationComment=function(){return void 0===this.documentationComment&&(this.documentationComment=e.JsDoc.getJsDocCommentsFromDeclarations(this.declarations)),this.documentationComment},t.prototype.getJsDocTags=function(){return void 0===this.tags&&(this.tags=e.JsDoc.getJsDocTagsFromDeclarations(this.declarations)),this.tags},t}(),o=function(e){function t(t,n,i){var r=e.call(this,n,i)||this;return r.kind=t,r}return __extends(t,e),t}(r),a=function(t){function n(e,n,i){return t.call(this,n,i)||this}return __extends(n,t),Object.defineProperty(n.prototype,"text",{get:function(){return e.idText(this)},enumerable:!0,configurable:!0}),n}(r);a.prototype.kind=71;var l=function(){function e(e,t){this.checker=e,this.flags=t}return e.prototype.getFlags=function(){return this.flags},e.prototype.getSymbol=function(){return this.symbol},e.prototype.getProperties=function(){return this.checker.getPropertiesOfType(this)},e.prototype.getProperty=function(e){return this.checker.getPropertyOfType(this,e)},e.prototype.getApparentProperties=function(){return this.checker.getAugmentedPropertiesOfType(this)},e.prototype.getCallSignatures=function(){return this.checker.getSignaturesOfType(this,0)},e.prototype.getConstructSignatures=function(){return this.checker.getSignaturesOfType(this,1)},e.prototype.getStringIndexType=function(){return this.checker.getIndexTypeOfType(this,0)},e.prototype.getNumberIndexType=function(){return this.checker.getIndexTypeOfType(this,1)},e.prototype.getBaseTypes=function(){return 32768&this.flags&&3&this.objectFlags?this.checker.getBaseTypes(this):void 0},e.prototype.getNonNullableType=function(){return this.checker.getNonNullableType(this)},e}(),c=function(){function t(e){this.checker=e}return t.prototype.getDeclaration=function(){return this.declaration},t.prototype.getTypeParameters=function(){return this.typeParameters},t.prototype.getParameters=function(){return this.parameters},t.prototype.getReturnType=function(){return this.checker.getReturnTypeOfSignature(this)},t.prototype.getDocumentationComment=function(){return void 0===this.documentationComment&&(this.documentationComment=this.declaration?e.JsDoc.getJsDocCommentsFromDeclarations([this.declaration]):[]),this.documentationComment},t.prototype.getJsDocTags=function(){return void 0===this.jsDocTags&&(this.jsDocTags=this.declaration?e.JsDoc.getJsDocTagsFromDeclarations([this.declaration]):[]),this.jsDocTags},t}(),u=function(t){function n(e,n,i){return t.call(this,e,n,i)||this}return __extends(n,t),n.prototype.update=function(t,n){return e.updateSourceFile(this,t,n)},n.prototype.getLineAndCharacterOfPosition=function(t){return e.getLineAndCharacterOfPosition(this,t)},n.prototype.getLineStarts=function(){return e.getLineStarts(this)},n.prototype.getPositionOfLineAndCharacter=function(t,n){return e.getPositionOfLineAndCharacter(this,t,n)},n.prototype.getLineEndOfPosition=function(e){var t,n=this.getLineAndCharacterOfPosition(e).line,i=this.getLineStarts();n+1>=i.length&&(t=this.getEnd()),t||(t=i[n+1]-1);var r=this.getFullText();return"\n"===r[t]&&"\r"===r[t-1]?t-1:t},n.prototype.getNamedDeclarations=function(){return this.namedDeclarations||(this.namedDeclarations=this.computeNamedDeclarations()),this.namedDeclarations},n.prototype.computeNamedDeclarations=function(){var t=e.createMultiMap();return e.forEachChild(this,function r(s){switch(s.kind){case 228:case 186:case 151:case 150:var o=s,a=i(o);if(a){var l=function(e){var n=t.get(e);n||t.set(e,n=[]);return n}(a),c=e.lastOrUndefined(l);c&&o.parent===c.parent&&o.symbol===c.symbol?o.body&&!c.body&&(l[l.length-1]=o):l.push(o)}e.forEachChild(s,r);break;case 229:case 199:case 230:case 231:case 232:case 233:case 237:case 246:case 242:case 239:case 240:case 153:case 154:case 163:n(s),e.forEachChild(s,r);break;case 146:if(!e.hasModifier(s,92))break;case 226:case 176:var u=s;if(e.isBindingPattern(u.name)){e.forEachChild(u.name,r);break}u.initializer&&r(u.initializer);case 264:case 149:case 148:n(s);break;case 244:s.exportClause&&e.forEach(s.exportClause.elements,r);break;case 238:var d=s.importClause;d&&(d.name&&n(d),d.namedBindings&&(240===d.namedBindings.kind?n(d.namedBindings):e.forEach(d.namedBindings.elements,r)));break;case 194:0!==e.getSpecialPropertyAssignmentKind(s)&&n(s);default:e.forEachChild(s,r)}}),t;function n(e){var n=i(e);n&&t.add(n,e)}function i(t){var n=e.getNameOfDeclaration(t);if(n){var i=e.getTextOfIdentifierOrLiteral(n);if(void 0!==i)return i;if(144===n.kind){var r=n.expression;return 179===r.kind?r.name.text:e.getTextOfIdentifierOrLiteral(r)}}}},n}(i),d=function(){function t(e,t,n){this.fileName=e,this.text=t,this.skipTrivia=n}return t.prototype.getLineAndCharacterOfPosition=function(t){return e.getLineAndCharacterOfPosition(this,t)},t}();function p(t){var n=!0;for(var i in t)if(e.hasProperty(t,i)&&!h(i)){n=!1;break}if(n)return t;var r={};for(var i in t){if(e.hasProperty(t,i))r[h(i)?i:i.charAt(0).toLowerCase()+i.substr(1)]=t[i]}return r}function h(e){return!e.length||e.charAt(0)===e.charAt(0).toLowerCase()}function f(){return{target:1,jsx:1}}e.toEditorSettings=p,e.displayPartsToString=function(t){return t?e.map(t,function(e){return e.text}).join(""):""},e.getDefaultCompilerOptions=f,e.getSupportedCodeFixes=function(){return e.codefix.getSupportedErrorCodes()};var m=function(){function t(t,n){this.host=t,this.currentDirectory=t.getCurrentDirectory(),this.fileNameToEntry=e.createMap();for(var i=0,r=t.getScriptFileNames();i<r.length;i++){var s=r[i];this.createEntry(s,e.toPath(s,this.currentDirectory,n))}this._compilationSettings=t.getCompilationSettings()||{target:1,jsx:1}}return t.prototype.compilationSettings=function(){return this._compilationSettings},t.prototype.createEntry=function(t,n){var i,r=this.host.getScriptSnapshot(t);return i=r?{hostFileName:t,version:this.host.getScriptVersion(t),scriptSnapshot:r,scriptKind:e.getScriptKind(t,this.host)}:t,this.fileNameToEntry.set(n,i),i},t.prototype.getEntryByPath=function(e){return this.fileNameToEntry.get(e)},t.prototype.getHostFileInformation=function(t){var n=this.fileNameToEntry.get(t);return e.isString(n)?void 0:n},t.prototype.getOrCreateEntryByPath=function(t,n){var i=this.getEntryByPath(n)||this.createEntry(t,n);return e.isString(i)?void 0:i},t.prototype.getRootFileNames=function(){return e.arrayFrom(this.fileNameToEntry.values(),function(t){return e.isString(t)?t:t.hostFileName})},t.prototype.getVersion=function(e){var t=this.getHostFileInformation(e);return t&&t.version},t.prototype.getScriptSnapshot=function(e){var t=this.getHostFileInformation(e);return t&&t.scriptSnapshot},t}(),g=function(){function t(e){this.host=e}return t.prototype.getCurrentSourceFile=function(t){var n=this.host.getScriptSnapshot(t);if(!n)throw new Error("Could not find file: '"+t+"'.");var i,r=e.getScriptKind(t,this.host),s=this.host.getScriptVersion(t);if(this.currentFileName!==t)i=y(t,n,5,s,!0,r);else if(this.currentFileVersion!==s){var o=n.getChangeRange(this.currentFileScriptSnapshot);i=b(this.currentSourceFile,n,s,o)}return i&&(this.currentFileVersion=s,this.currentFileName=t,this.currentFileScriptSnapshot=n,this.currentSourceFile=i),this.currentSourceFile},t}();function _(e,t,n){e.version=n,e.scriptSnapshot=t}function y(t,n,i,r,s,o){var a=n.getText(0,n.getLength()),l=e.createSourceFile(t,a,i,s,o);return _(l,n,r),l}function b(t,n,i,r,s){if(r&&i!==t.version&&!e.disableIncrementalParsing){var o=void 0,a=0!==r.span.start?t.text.substr(0,r.span.start):"",l=e.textSpanEnd(r.span)!==t.text.length?t.text.substr(e.textSpanEnd(r.span)):"";if(0===r.newLength)o=a&&l?a+l:a||l;else{var c=n.getText(r.span.start,r.span.start+r.newLength);o=a&&l?a+c+l:a?a+c:c+l}var u=e.updateSourceFile(t,o,r,s);return _(u,n,i),u.nameTable=void 0,t!==u&&t.scriptSnapshot&&(t.scriptSnapshot.dispose&&t.scriptSnapshot.dispose(),t.scriptSnapshot=void 0),u}return y(t.fileName,n,t.languageVersion,i,!0,t.scriptKind)}e.createLanguageServiceSourceFile=y,e.disableIncrementalParsing=!1,e.updateLanguageServiceSourceFile=b;var v=function(){function t(e){this.cancellationToken=e}return t.prototype.isCancellationRequested=function(){return this.cancellationToken&&this.cancellationToken.isCancellationRequested()},t.prototype.throwIfCancellationRequested=function(){if(this.isCancellationRequested())throw new e.OperationCanceledException},t}(),T=function(){function t(e,t){void 0===t&&(t=20),this.hostCancellationToken=e,this.throttleWaitMilliseconds=t,this.lastCancellationCheckTime=0}return t.prototype.isCancellationRequested=function(){var t=e.timestamp();return Math.abs(t-this.lastCancellationCheckTime)>=this.throttleWaitMilliseconds&&(this.lastCancellationCheckTime=t,this.hostCancellationToken.isCancellationRequested())},t.prototype.throwIfCancellationRequested=function(){if(this.isCancellationRequested())throw new e.OperationCanceledException},t}();function k(e){switch(e.kind){case 253:case 255:case 261:case 262:case 151:case 153:case 154:return!0}return!1}function x(t,n){var i=e.unescapeLeadingUnderscores(e.getTextOfPropertyName(n));if(i&&t){var r=[],s=t.getProperty(i);if(65536&t.flags)return e.forEach(t.types,function(e){var t=e.getProperty(i);t&&r.push(t)}),r;if(s)return r.push(s),r}}e.ThrottledCancellationToken=T,e.createLanguageService=function(n,i){void 0===i&&(i=e.createDocumentRegistry(n.useCaseSensitiveFileNames&&n.useCaseSensitiveFileNames(),n.getCurrentDirectory()));var r,s,o=new g(n);t=t||new e.formatting.RulesProvider;var a=0,l=n.useCaseSensitiveFileNames&&n.useCaseSensitiveFileNames(),c=new v(n.getCancellationToken&&n.getCancellationToken()),u=n.getCurrentDirectory();function d(e){n.log&&n.log(e)}!e.localizedDiagnosticMessages&&n.getLocalizedDiagnosticMessages&&(e.localizedDiagnosticMessages=n.getLocalizedDiagnosticMessages());var h=e.createGetCanonicalFileName(l);function f(e){var t=r.getSourceFile(e);if(!t)throw new Error("Could not find file: '"+e+"'.");return t}function _(e){return t.ensureUpToDate(e),t}function y(){if(n.getProjectVersion){var t=n.getProjectVersion();if(t){if(s===t&&!n.hasChangedAutomaticTypeDirectiveNames)return;s=t}}var o=n.getTypeRootsVersion?n.getTypeRootsVersion():0;a!==o&&(d("TypeRoots version has changed; provide new program"),r=void 0,a=o);var p=new m(n,h),f=p.getRootFileNames(),g=n.hasInvalidatedResolution||e.returnFalse;if(!e.isProgramUptoDate(r,f,p.compilationSettings(),function(e){return p.getVersion(e)},v,g,n.hasChangedAutomaticTypeDirectiveNames)){var _=p.compilationSettings(),y={getSourceFile:function(t,n,i,r){return T(t,e.toPath(t,u,h),n,i,r)},getSourceFileByPath:T,getCancellationToken:function(){return c},getCanonicalFileName:h,useCaseSensitiveFileNames:function(){return l},getNewLine:function(){return e.getNewLineCharacter(_,{newLine:e.getNewLineOrDefaultFromHost(n)})},getDefaultLibFileName:function(e){return n.getDefaultLibFileName(e)},writeFile:e.noop,getCurrentDirectory:function(){return u},fileExists:v,readFile:function(t){var i=e.toPath(t,u,h),r=p.getEntryByPath(i);return r?e.isString(r)?void 0:r.scriptSnapshot.getText(0,r.scriptSnapshot.getLength()):n.readFile&&n.readFile(t)},directoryExists:function(t){return e.directoryProbablyExists(t,n)},getDirectories:function(e){return n.getDirectories?n.getDirectories(e):[]},onReleaseOldSourceFile:function(e,t){var n=i.getKeyForCompilationSettings(t);i.releaseDocumentWithKey(e.path,n)},hasInvalidatedResolution:g,hasChangedAutomaticTypeDirectiveNames:n.hasChangedAutomaticTypeDirectiveNames};n.trace&&(y.trace=function(e){return n.trace(e)}),n.resolveModuleNames&&(y.resolveModuleNames=function(e,t,i){return n.resolveModuleNames(e,t,i)}),n.resolveTypeReferenceDirectives&&(y.resolveTypeReferenceDirectives=function(e,t){return n.resolveTypeReferenceDirectives(e,t)});var b=i.getKeyForCompilationSettings(_);return r=e.createProgram(f,_,y,r),p=void 0,void r.getTypeChecker()}function v(t){var i=e.toPath(t,u,h),r=p.getEntryByPath(i);return r?!e.isString(r):n.fileExists&&n.fileExists(t)}function T(t,n,s,o,a){e.Debug.assert(void 0!==p);var l=p.getOrCreateEntryByPath(t,n);if(l){if(!a){var c=r&&r.getSourceFileByPath(n);if(c)return e.Debug.assertEqual(l.scriptKind,c.scriptKind,"Registered script kind should match new script kind.",n),i.updateDocumentWithKey(t,n,_,b,l.scriptSnapshot,l.version,l.scriptKind)}return i.acquireDocumentWithKey(t,n,_,b,l.scriptSnapshot,l.version,l.scriptKind)}}}function b(){return y(),r}function T(t,n,i){y();var s=e.map(i,function(e){return r.getSourceFile(e)}),o=f(t);return e.DocumentHighlights.getDocumentHighlights(r,c,o,n,s)}function k(t,n,i){y();var s=[];if(i&&i.isForRename)for(var o=0,a=r.getSourceFiles();o<a.length;o++){var l=a[o];r.isSourceFileDefaultLibrary(l)||s.push(l)}else s=r.getSourceFiles().slice();return e.FindAllReferences.findReferencedEntries(r,c,s,f(t),n,i)}function x(e){return o.getCurrentSourceFile(e)}function E(t){var i=e.getScriptKind(t,n);return 3===i||4===i}function S(e,t,i){var r="number"==typeof t?[t,void 0]:[t.pos,t.end];return{file:e,startPosition:r[0],endPosition:r[1],program:b(),newLineCharacter:i?i.newLineCharacter:n.getNewLine(),host:n,rulesProvider:_(i),cancellationToken:c}}return{dispose:function(){r&&(e.forEach(r.getSourceFiles(),function(e){return i.releaseDocument(e.fileName,r.getCompilerOptions())}),r=void 0),n=void 0},cleanupSemanticCache:function(){r=void 0},getSyntacticDiagnostics:function(e){return y(),r.getSyntacticDiagnostics(f(e),c).slice()},getSemanticDiagnostics:function(e){y();var t=f(e),n=r.getSemanticDiagnostics(t,c);if(!r.getCompilerOptions().declaration)return n.slice();var i=r.getDeclarationDiagnostics(t,c);return n.concat(i)},getCompilerOptionsDiagnostics:function(){return y(),r.getOptionsDiagnostics(c).concat(r.getGlobalDiagnostics(c))},getSyntacticClassifications:function(t,n){return e.getSyntacticClassifications(c,o.getCurrentSourceFile(t),n)},getSemanticClassifications:function(t,n){return E(t)?(y(),e.getSemanticClassifications(r.getTypeChecker(),c,f(t),r.getClassifiableNames(),n)):[]},getEncodedSyntacticClassifications:function(t,n){return e.getEncodedSyntacticClassifications(c,o.getCurrentSourceFile(t),n)},getEncodedSemanticClassifications:function(t,n){return E(t)?(y(),e.getEncodedSemanticClassifications(r.getTypeChecker(),c,f(t),r.getClassifiableNames(),n)):{spans:[],endOfLineState:0}},getCompletionsAtPosition:function(t,i){return y(),e.Completions.getCompletionsAtPosition(n,r.getTypeChecker(),d,r.getCompilerOptions(),f(t),i,r.getSourceFiles())},getCompletionEntryDetails:function(t,i,s,o,a){y();var l=o?_(o):void 0;return e.Completions.getCompletionEntryDetails(r.getTypeChecker(),d,r.getCompilerOptions(),f(t),i,{name:s,source:a},r.getSourceFiles(),n,l)},getCompletionEntrySymbol:function(t,n,i,s){return y(),e.Completions.getCompletionEntrySymbol(r.getTypeChecker(),d,r.getCompilerOptions(),f(t),n,{name:i,source:s},r.getSourceFiles())},getSignatureHelpItems:function(t,n){y();var i=f(t);return e.SignatureHelp.getSignatureHelpItems(r,i,n,c)},getQuickInfoAtPosition:function(t,n){y();var i=f(t),s=e.getTouchingPropertyName(i,n,!0);if(s!==i&&!e.isLabelName(s)){var o=r.getTypeChecker(),a=function(t,n){if((e.isIdentifier(t)||e.isStringLiteral(t))&&e.isPropertyAssignment(t.parent)&&t.parent.name===t){var i=n.getContextualType(t.parent.parent);if(i){var r=n.getPropertyOfType(i,e.getTextOfIdentifierOrLiteral(t));if(r)return r}}return n.getSymbolAtLocation(t)}(s,o);if(a&&!o.isUnknownSymbol(a)){var l=e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(o,a,i,e.getContainerNode(s),s);return{kind:l.symbolKind,kindModifiers:e.SymbolDisplay.getSymbolModifiers(a),textSpan:e.createTextSpan(s.getStart(),s.getWidth()),displayParts:l.displayParts,documentation:l.documentation,tags:l.tags}}switch(s.kind){case 71:case 179:case 143:case 99:case 169:case 97:var c=o.getTypeAtLocation(s);if(c)return{kind:"",kindModifiers:"",textSpan:e.createTextSpan(s.getStart(),s.getWidth()),displayParts:e.typeToDisplayParts(o,c,e.getContainerNode(s)),documentation:c.symbol?c.symbol.getDocumentationComment():void 0,tags:c.symbol?c.symbol.getJsDocTags():void 0}}}},getDefinitionAtPosition:function(t,n){return y(),e.GoToDefinition.getDefinitionAtPosition(r,f(t),n)},getImplementationAtPosition:function(t,n){return y(),e.FindAllReferences.getImplementationsAtPosition(r,c,r.getSourceFiles(),f(t),n)},getTypeDefinitionAtPosition:function(t,n){return y(),e.GoToDefinition.getTypeDefinitionAtPosition(r.getTypeChecker(),f(t),n)},getReferencesAtPosition:function(e,t){return k(e,t)},findReferences:function(t,n){return y(),e.FindAllReferences.findReferencedSymbols(r,c,r.getSourceFiles(),f(t),n)},getOccurrencesAtPosition:function(t,n){var i=function(e,t){return n(T(e,t,[e]));function n(e){if(e){for(var t=[],n=0,i=e;n<i.length;n++)for(var r=i[n],s=0,o=r.highlightSpans;s<o.length;s++){var a=o[s];t.push({fileName:r.fileName,textSpan:a.textSpan,isWriteAccess:"writtenReference"===a.kind,isDefinition:!1,isInString:a.isInString})}return t}}}(t,n);if(i){var r=h(e.normalizeSlashes(t));i=e.filter(i,function(t){return h(e.normalizeSlashes(t.fileName))===r})}return i},getDocumentHighlights:T,getNameOrDottedNameSpan:function(t,n,i){var r=o.getCurrentSourceFile(t),s=e.getTouchingPropertyName(r,n,!1);if(s!==r){switch(s.kind){case 179:case 143:case 9:case 86:case 101:case 95:case 97:case 99:case 169:case 71:break;default:return}for(var a=s;;)if(e.isRightSideOfPropertyAccess(a)||e.isRightSideOfQualifiedName(a))a=a.parent;else{if(!e.isNameOfModuleDeclaration(a))break;if(233!==a.parent.parent.kind||a.parent.parent.body!==a.parent)break;a=a.parent.parent.name}return e.createTextSpanFromBounds(a.getStart(),s.getEnd())}},getBreakpointStatementAtPosition:function(t,n){var i=o.getCurrentSourceFile(t);return e.BreakpointResolver.spanInSourceFileAtLocation(i,n)},getNavigateToItems:function(t,n,i,s){y();var o=i?[f(i)]:r.getSourceFiles();return e.NavigateTo.getNavigateToItems(o,r.getTypeChecker(),c,t,n,s)},getRenameInfo:function(t,i){y();var s=n.getDefaultLibFileName(n.getCompilationSettings());return e.Rename.getRenameInfo(r.getTypeChecker(),s,h,f(t),i)},findRenameLocations:function(e,t,n,i){return k(e,t,{findInStrings:n,findInComments:i,isForRename:!0})},getNavigationBarItems:function(t){return e.NavigationBar.getNavigationBarItems(o.getCurrentSourceFile(t),c)},getNavigationTree:function(t){return e.NavigationBar.getNavigationTree(o.getCurrentSourceFile(t),c)},getOutliningSpans:function(t){var n=o.getCurrentSourceFile(t);return e.OutliningElementsCollector.collectElements(n,c)},getTodoComments:function(t,n){y();var i=f(t);c.throwIfCancellationRequested();var r,s=i.text,o=[];if(n.length>0&&(r=i.fileName,!e.stringContains(r,"/node_modules/")))for(var a=function(){var t="("+/(?:^(?:\s|\*)*)/.source+"|"+/(?:\/\/+\s*)/.source+"|"+/(?:\/\*+\s*)/.source+")",i="(?:"+e.map(n,function(e){return"("+(e.text.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")")}).join("|")+")",r=t+"("+i+/(?:.*?)/.source+")"+/(?:$|\*\/)/.source;return new RegExp(r,"gim")}(),l=void 0;l=a.exec(s);){c.throwIfCancellationRequested();e.Debug.assert(l.length===n.length+3);var u=l[1],d=l.index+u.length;if(e.isInComment(i,d)){for(var p=void 0,h=0;h<n.length;h++)l[h+3]&&(p=n[h]);if(e.Debug.assert(void 0!==p),!g(s.charCodeAt(d+p.text.length))){var m=l[2];o.push({descriptor:p,message:m,position:d})}}}return o;function g(e){return e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57}},getBraceMatchingAtPosition:function(t,n){var i=o.getCurrentSourceFile(t),r=[],s=e.getTouchingToken(i,n,!1);if(s.getStart(i)===n){var a=function(e){switch(e.kind){case 17:return 18;case 19:return 20;case 21:return 22;case 27:return 29;case 18:return 17;case 20:return 19;case 22:return 21;case 29:return 27}return}(s);if(a)for(var l=0,c=s.parent.getChildren(i);l<c.length;l++){var u=c[l];if(u.kind===a){var d=e.createTextSpan(s.getStart(i),s.getWidth(i)),p=e.createTextSpan(u.getStart(i),u.getWidth(i));d.start<p.start?r.push(d,p):r.push(p,d);break}}}return r},getIndentationAtPosition:function(t,n,i){var r=e.timestamp(),s=p(i),a=o.getCurrentSourceFile(t);d("getIndentationAtPosition: getCurrentSourceFile: "+(e.timestamp()-r)),r=e.timestamp();var l=e.formatting.SmartIndenter.getIndentation(n,a,s);return d("getIndentationAtPosition: computeIndentation  : "+(e.timestamp()-r)),l},getFormattingEditsForRange:function(t,n,i,r){var s=o.getCurrentSourceFile(t),a=p(r);return e.formatting.formatSelection(n,i,s,_(a),a)},getFormattingEditsForDocument:function(t,n){var i=o.getCurrentSourceFile(t),r=p(n);return e.formatting.formatDocument(i,_(r),r)},getFormattingEditsAfterKeystroke:function(t,n,i,r){var s=o.getCurrentSourceFile(t),a=p(r);if(!e.isInComment(s,n)){if("{"===i)return e.formatting.formatOnOpeningCurly(n,s,_(a),a);if("}"===i)return e.formatting.formatOnClosingCurly(n,s,_(a),a);if(";"===i)return e.formatting.formatOnSemicolon(n,s,_(a),a);if("\n"===i)return e.formatting.formatOnEnter(n,s,_(a),a)}return[]},getDocCommentTemplateAtPosition:function(t,i){return e.JsDoc.getDocCommentTemplateAtPosition(e.getNewLineOrDefaultFromHost(n),o.getCurrentSourceFile(t),i)},isValidBraceCompletionAtPosition:function(t,n,i){if(60===i)return!1;var r=o.getCurrentSourceFile(t);if(e.isInString(r,n))return!1;if(e.isInsideJsxElementOrAttribute(r,n))return 123===i;if(e.isInTemplateString(r,n))return!1;switch(i){case 39:case 34:case 96:return!e.isInComment(r,n)}return!0},getSpanOfEnclosingComment:function(t,n,i){var r=o.getCurrentSourceFile(t),s=e.formatting.getRangeOfEnclosingComment(r,n,i);return s&&e.createTextSpanFromRange(s)},getCodeFixesAtPosition:function(t,i,s,o,a){y();var l=f(t),u=e.createTextSpanFromBounds(i,s),d=e.getNewLineOrDefaultFromHost(n),p=_(a);return e.flatMap(e.deduplicate(o),function(t){return c.throwIfCancellationRequested(),e.codefix.getFixes({errorCode:t,sourceFile:l,span:u,program:r,newLineCharacter:d,host:n,cancellationToken:c,rulesProvider:p})})},applyCodeActionCommand:function(t,i){if(t=e.toPath(t,u,h),"install package"===i.type)return n.installPackage?n.installPackage({fileName:t,packageName:i.packageName}):Promise.reject("Host does not implement `installPackage`");e.Debug.fail()},getEmitOutput:function(t,i){y();var s=f(t),o=n.getCustomTransformers&&n.getCustomTransformers();return e.getFileEmitOutput(r,s,i,c,o)},getNonBoundSourceFile:x,getSourceFile:function(e){return x(e)},getProgram:b,getApplicableRefactors:function(t,n){y();var i=f(t);return e.refactor.getApplicableRefactors(S(i,n))},getEditsForRefactor:function(t,n,i,r,s){y();var o=f(t);return e.refactor.getEditsForRefactor(S(o,i,n),r,s)}}},e.getNameTable=function(t){return t.nameTable||function(t){var n=t.nameTable=e.createUnderscoreEscapedMap();t.forEachChild(function t(i){if(e.isIdentifier(i)&&i.escapedText||e.isStringOrNumericLiteral(i)&&function(t){return e.isDeclarationName(t)||248===t.parent.kind||function(e){return e&&e.parent&&180===e.parent.kind&&e.parent.argumentExpression===e}(t)||e.isLiteralComputedPropertyDeclarationName(t)}(i)){var r=e.getEscapedTextOfIdentifierOrLiteral(i);n.set(r,void 0===n.get(r)?i.pos:-1)}if(e.forEachChild(i,t),e.hasJSDocNodes(i))for(var s=0,o=i.jsDoc;s<o.length;s++){var a=o[s];e.forEachChild(a,t)}})}(t),t.nameTable},e.getContainingObjectLiteralElement=function(e){switch(e.kind){case 9:case 8:if(144===e.parent.kind)return k(e.parent.parent)?e.parent.parent:void 0;case 71:return!k(e.parent)||178!==e.parent.parent.kind&&254!==e.parent.parent.kind||e.parent.name!==e?void 0:e.parent}},e.getPropertySymbolsFromContextualType=function(e,t){var n=t.parent;return x(e.getContextualType(n),t.name)},e.getPropertySymbolsFromType=x,e.getDefaultLibFilePath=function(t){if("undefined"!=typeof __dirname)return __dirname+e.directorySeparator+e.getDefaultLibFileName(t);throw new Error("getDefaultLibFilePath is only supported when consumed as a node module. ")},e.objectAllocator={getNodeConstructor:function(){return i},getTokenConstructor:function(){return o},getIdentifierConstructor:function(){return a},getSourceFileConstructor:function(){return u},getSymbolConstructor:function(){return s},getTypeConstructor:function(){return l},getSignatureConstructor:function(){return c},getSourceMapSourceConstructor:function(){return d}}}(ts||(ts={})),function(e){!function(t){t.spanInSourceFileAtLocation=function(t,n){if(!t.isDeclarationFile){var i=e.getTokenAtPosition(t,n,!1),r=t.getLineAndCharacterOfPosition(n).line;if((!(t.getLineAndCharacterOfPosition(i.getStart(t)).line>r)||(i=e.findPrecedingToken(i.pos,t))&&t.getLineAndCharacterOfPosition(i.getEnd()).line===r)&&!e.isInAmbientContext(i))return u(i)}function s(n,i){var r=n.decorators?e.skipTrivia(t.text,n.decorators.end):n.getStart(t);return e.createTextSpanFromBounds(r,(i||n).getEnd())}function o(t,n){return s(t,e.findNextToken(n,n.parent))}function a(e,n){return e&&r===t.getLineAndCharacterOfPosition(e.getStart(t)).line?u(e):u(n)}function l(n){return u(e.findPrecedingToken(n.pos,t))}function c(t){return u(e.findNextToken(t,t.parent))}function u(n){if(n)switch(n.kind){case 208:return h(n.declarationList.declarations[0]);case 226:case 149:case 148:return h(n);case 146:return function t(n){if(e.isBindingPattern(n.name))return _(n.name);if(function(t){return!!t.initializer||void 0!==t.dotDotDotToken||e.hasModifier(t,12)}(n))return s(n);var i=n.parent,r=e.indexOf(i.parameters,n);return r?t(i.parameters[r-1]):u(i.body)}(n);case 228:case 151:case 150:case 153:case 154:case 152:case 186:case 187:return function(e){if(!e.body)return;if(f(e))return s(e);return u(e.body)}(n);case 207:if(e.isFunctionBlock(n))return function(e){var t=e.statements.length?e.statements[0]:e.getLastToken();if(f(e.parent))return a(e.parent,t);return u(t)}(n);case 234:return m(n);case 260:return m(n.block);case 210:return s(n.expression);case 219:return s(n.getChildAt(0),n.expression);case 213:return o(n,n.expression);case 212:return u(n.statement);case 225:return s(n.getChildAt(0));case 211:return o(n,n.expression);case 222:return u(n.statement);case 218:case 217:return s(n.getChildAt(0),n.label);case 214:return function(e){if(e.initializer)return g(e);if(e.condition)return s(e.condition);if(e.incrementor)return s(e.incrementor)}(n);case 215:return o(n,n.expression);case 216:return g(n);case 221:return o(n,n.expression);case 257:case 258:return u(n.statements[0]);case 224:return m(n.tryBlock);case 223:case 243:return s(n,n.expression);case 237:return s(n,n.moduleReference);case 238:case 244:return s(n,n.moduleSpecifier);case 233:if(1!==e.getModuleInstanceState(n))return;case 229:case 232:case 264:case 176:return s(n);case 220:return u(n.statement);case 147:return d=n.parent.decorators,e.createTextSpanFromBounds(e.skipTrivia(t.text,d.pos),d.end);case 174:case 175:return _(n);case 230:case 231:return;case 25:case 1:return a(e.findPrecedingToken(n.pos,t));case 26:return l(n);case 17:return function(n){switch(n.parent.kind){case 232:var i=n.parent;return a(e.findPrecedingToken(n.pos,t,n.parent),i.members.length?i.members[0]:i.getLastToken(t));case 229:var r=n.parent;return a(e.findPrecedingToken(n.pos,t,n.parent),r.members.length?r.members[0]:r.getLastToken(t));case 235:return a(n.parent.parent,n.parent.clauses[0])}return u(n.parent)}(n);case 18:return function(t){switch(t.parent.kind){case 234:if(1!==e.getModuleInstanceState(t.parent.parent))return;case 232:case 229:return s(t);case 207:if(e.isFunctionBlock(t.parent))return s(t);case 260:return u(e.lastOrUndefined(t.parent.statements));case 235:var n=t.parent,i=e.lastOrUndefined(n.clauses);return i?u(e.lastOrUndefined(i.statements)):void 0;case 174:var r=t.parent;return u(e.lastOrUndefined(r.elements)||r);default:if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(t.parent)){var o=t.parent;return s(e.lastOrUndefined(o.properties)||o)}return u(t.parent)}}(n);case 22:return function(t){if(175===t.parent.kind){var n=t.parent;return s(e.lastOrUndefined(n.elements)||n)}if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(t.parent)){var i=t.parent;return s(e.lastOrUndefined(i.elements)||i)}return u(t.parent)}(n);case 19:return function(e){if(212===e.parent.kind||181===e.parent.kind||182===e.parent.kind)return l(e);if(185===e.parent.kind)return c(e);return u(e.parent)}(n);case 20:return function(e){switch(e.parent.kind){case 186:case 228:case 187:case 151:case 150:case 153:case 154:case 152:case 213:case 212:case 214:case 216:case 181:case 182:case 185:return l(e);default:return u(e.parent)}}(n);case 56:return function(t){if(e.isFunctionLike(t.parent)||261===t.parent.kind||146===t.parent.kind)return l(t);return u(t.parent)}(n);case 29:case 27:return function(e){if(184===e.parent.kind)return c(e);return u(e.parent)}(n);case 106:return function(e){if(212===e.parent.kind)return o(e,e.parent.expression);return u(e.parent)}(n);case 82:case 74:case 87:return c(n);case 142:return function(e){if(216===e.parent.kind)return c(e);return u(e.parent)}(n);default:if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(n))return y(n);if((71===n.kind||198===n.kind||261===n.kind||262===n.kind)&&e.isArrayLiteralOrObjectLiteralDestructuringPattern(n.parent))return s(n);if(194===n.kind){var i=n;if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(i.left))return y(i.left);if(58===i.operatorToken.kind&&e.isArrayLiteralOrObjectLiteralDestructuringPattern(i.parent))return s(n);if(26===i.operatorToken.kind)return u(i.left)}if(e.isPartOfExpression(n))switch(n.parent.kind){case 212:return l(n);case 147:return u(n.parent);case 214:case 216:return s(n);case 194:if(26===n.parent.operatorToken.kind)return s(n);break;case 187:if(n.parent.body===n)return s(n)}if(261===n.parent.kind&&n.parent.name===n&&!e.isArrayLiteralOrObjectLiteralDestructuringPattern(n.parent.parent))return u(n.parent.initializer);if(184===n.parent.kind&&n.parent.type===n)return c(n.parent.type);if(e.isFunctionLike(n.parent)&&n.parent.type===n)return l(n);if(226===n.parent.kind||146===n.parent.kind){var r=n.parent;if(r.initializer===n||r.type===n||e.isAssignmentOperator(n.kind))return l(n)}if(194===n.parent.kind){i=n.parent;if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(i.left)&&(i.right===n||i.operatorToken===n))return l(n)}return u(n.parent)}var d;function p(n){return 227===n.parent.kind&&n.parent.declarations[0]===n?s(e.findPrecedingToken(n.pos,t,n.parent),n):s(n)}function h(n){return 215===n.parent.parent.kind?u(n.parent.parent):e.isBindingPattern(n.name)?_(n.name):n.initializer||e.hasModifier(n,1)||216===n.parent.parent.kind?p(n):227===n.parent.kind&&n.parent.declarations[0]!==n?u(e.findPrecedingToken(n.pos,t,n.parent)):void 0}function f(t){return e.hasModifier(t,1)||229===t.parent.kind&&152!==t.kind}function m(n){switch(n.parent.kind){case 233:if(1!==e.getModuleInstanceState(n.parent))return;case 213:case 211:case 215:return a(n.parent,n.statements[0]);case 214:case 216:return a(e.findPrecedingToken(n.pos,t,n.parent),n.statements[0])}return u(n.statements[0])}function g(e){if(227!==e.initializer.kind)return u(e.initializer);var t=e.initializer;return t.declarations.length>0?u(t.declarations[0]):void 0}function _(t){var n=e.forEach(t.elements,function(e){return 200!==e.kind?e:void 0});return n?u(n):176===t.parent.kind?s(t.parent):p(t.parent)}function y(t){e.Debug.assert(175!==t.kind&&174!==t.kind);var n=177===t.kind?t.elements:t.properties,i=e.forEach(n,function(e){return 200!==e.kind?e:void 0});return i?u(i):s(194===t.parent.kind?t.parent:t)}}}}(e.BreakpointResolver||(e.BreakpointResolver={}))}(ts||(ts={})),function(e){e.transform=function(t,n,i){var r=[];i=e.fixupCompilerOptions(i,r);var s=e.isArray(t)?t:[t],o=e.transformNodes(void 0,void 0,i,s,n,!0);return o.diagnostics=e.concatenate(o.diagnostics,r),o}}(ts||(ts={}));var debugObjectHost=function(){return this}(),ts,TypeScript;!function(e){function t(e,t){e&&e.log("*INTERNAL ERROR* - Exception in typescript services: "+t.message)}var n=function(){function t(e){this.scriptSnapshotShim=e}return t.prototype.getText=function(e,t){return this.scriptSnapshotShim.getText(e,t)},t.prototype.getLength=function(){return this.scriptSnapshotShim.getLength()},t.prototype.getChangeRange=function(t){var n=t,i=this.scriptSnapshotShim.getChangeRange(n.scriptSnapshotShim);if(null===i)return null;var r=JSON.parse(i);return e.createTextChangeRange(e.createTextSpan(r.span.start,r.span.length),r.newLength)},t.prototype.dispose=function(){"dispose"in this.scriptSnapshotShim&&this.scriptSnapshotShim.dispose()},t}(),i=function(){function t(t){var n=this;this.shimHost=t,this.loggingEnabled=!1,this.tracingEnabled=!1,"getModuleResolutionsForFile"in this.shimHost&&(this.resolveModuleNames=function(t,i){var r=JSON.parse(n.shimHost.getModuleResolutionsForFile(i));return e.map(t,function(t){var n=e.getProperty(r,t);return n?{resolvedFileName:n,extension:e.extensionFromPath(n),isExternalLibraryImport:!1}:void 0})}),"directoryExists"in this.shimHost&&(this.directoryExists=function(e){return n.shimHost.directoryExists(e)}),"getTypeReferenceDirectiveResolutionsForFile"in this.shimHost&&(this.resolveTypeReferenceDirectives=function(t,i){var r=JSON.parse(n.shimHost.getTypeReferenceDirectiveResolutionsForFile(i));return e.map(t,function(t){return e.getProperty(r,t)})})}return t.prototype.log=function(e){this.loggingEnabled&&this.shimHost.log(e)},t.prototype.trace=function(e){this.tracingEnabled&&this.shimHost.trace(e)},t.prototype.error=function(e){this.shimHost.error(e)},t.prototype.getProjectVersion=function(){if(this.shimHost.getProjectVersion)return this.shimHost.getProjectVersion()},t.prototype.getTypeRootsVersion=function(){return this.shimHost.getTypeRootsVersion?this.shimHost.getTypeRootsVersion():0},t.prototype.useCaseSensitiveFileNames=function(){return!!this.shimHost.useCaseSensitiveFileNames&&this.shimHost.useCaseSensitiveFileNames()},t.prototype.getCompilationSettings=function(){var e=this.shimHost.getCompilationSettings();if(null===e||""===e)throw Error("LanguageServiceShimHostAdapter.getCompilationSettings: empty compilationSettings");var t=JSON.parse(e);return t.allowNonTsExtensions=!0,t},t.prototype.getScriptFileNames=function(){var e=this.shimHost.getScriptFileNames();return this.files=JSON.parse(e)},t.prototype.getScriptSnapshot=function(e){var t=this.shimHost.getScriptSnapshot(e);return t&&new n(t)},t.prototype.getScriptKind=function(e){return"getScriptKind"in this.shimHost?this.shimHost.getScriptKind(e):0},t.prototype.getScriptVersion=function(e){return this.shimHost.getScriptVersion(e)},t.prototype.getLocalizedDiagnosticMessages=function(){var e=this.shimHost.getLocalizedDiagnosticMessages();if(null===e||""===e)return null;try{return JSON.parse(e)}catch(e){return this.log(e.description||"diagnosticMessages.generated.json has invalid JSON format"),null}},t.prototype.getCancellationToken=function(){var t=this.shimHost.getCancellationToken();return new e.ThrottledCancellationToken(t)},t.prototype.getCurrentDirectory=function(){return this.shimHost.getCurrentDirectory()},t.prototype.getDirectories=function(e){return JSON.parse(this.shimHost.getDirectories(e))},t.prototype.getDefaultLibFileName=function(e){return this.shimHost.getDefaultLibFileName(JSON.stringify(e))},t.prototype.readDirectory=function(t,n,i,r,s){var o=e.getFileMatcherPatterns(t,i,r,this.shimHost.useCaseSensitiveFileNames(),this.shimHost.getCurrentDirectory());return JSON.parse(this.shimHost.readDirectory(t,JSON.stringify(n),JSON.stringify(o.basePaths),o.excludePattern,o.includeFilePattern,o.includeDirectoryPattern,s))},t.prototype.readFile=function(e,t){return this.shimHost.readFile(e,t)},t.prototype.fileExists=function(e){return this.shimHost.fileExists(e)},t}();e.LanguageServiceShimHostAdapter=i;var r=function(){function t(e){var t=this;this.shimHost=e,this.useCaseSensitiveFileNames=!!this.shimHost.useCaseSensitiveFileNames&&this.shimHost.useCaseSensitiveFileNames(),"directoryExists"in this.shimHost&&(this.directoryExists=function(e){return t.shimHost.directoryExists(e)}),"realpath"in this.shimHost&&(this.realpath=function(e){return t.shimHost.realpath(e)})}return t.prototype.readDirectory=function(t,n,i,r,s){var o=e.getFileMatcherPatterns(t,i,r,this.shimHost.useCaseSensitiveFileNames(),this.shimHost.getCurrentDirectory());return JSON.parse(this.shimHost.readDirectory(t,JSON.stringify(n),JSON.stringify(o.basePaths),o.excludePattern,o.includeFilePattern,o.includeDirectoryPattern,s))},t.prototype.fileExists=function(e){return this.shimHost.fileExists(e)},t.prototype.readFile=function(e){return this.shimHost.readFile(e)},t.prototype.getDirectories=function(e){return JSON.parse(this.shimHost.getDirectories(e))},t}();function s(e,t,n,i){return o(e,t,!0,n,i)}function o(n,i,r,s,o){try{var a=function(t,n,i,r){var s;r&&(t.log(n),s=e.timestamp());var o=i();if(r){var a=e.timestamp();if(t.log(n+" completed in "+(a-s)+" msec"),e.isString(o)){var l=o;l.length>128&&(l=l.substring(0,128)+"..."),t.log("  result.length="+l.length+", result='"+JSON.stringify(l)+"'")}}return o}(n,i,s,o);return r?JSON.stringify({result:a}):a}catch(r){return r instanceof e.OperationCanceledException?JSON.stringify({canceled:!0}):(t(n,r),r.description=i,JSON.stringify({error:r}))}}e.CoreServicesShimHostAdapter=r;var a=function(){function e(e){this.factory=e,e.registerShim(this)}return e.prototype.dispose=function(e){this.factory.unregisterShim(this)},e}();function l(t,n){return t.map(function(t){return function(t,n){return{message:e.flattenDiagnosticMessageText(t.messageText,n),start:t.start,length:t.length,category:e.DiagnosticCategory[t.category].toLowerCase(),code:t.code}}(t,n)})}e.realizeDiagnostics=l;var c=function(t){function n(e,n,i){var r=t.call(this,e)||this;return r.host=n,r.languageService=i,r.logPerformance=!1,r.logger=r.host,r}return __extends(n,t),n.prototype.forwardJSONCall=function(e,t){return s(this.logger,e,t,this.logPerformance)},n.prototype.dispose=function(e){this.logger.log("dispose()"),this.languageService.dispose(),this.languageService=null,debugObjectHost&&debugObjectHost.CollectGarbage&&(debugObjectHost.CollectGarbage(),this.logger.log("CollectGarbage()")),this.logger=null,t.prototype.dispose.call(this,e)},n.prototype.refresh=function(e){this.forwardJSONCall("refresh("+e+")",function(){return null})},n.prototype.cleanupSemanticCache=function(){var e=this;this.forwardJSONCall("cleanupSemanticCache()",function(){return e.languageService.cleanupSemanticCache(),null})},n.prototype.realizeDiagnostics=function(t){var n=e.getNewLineOrDefaultFromHost(this.host);return e.realizeDiagnostics(t,n)},n.prototype.getSyntacticClassifications=function(t,n,i){var r=this;return this.forwardJSONCall("getSyntacticClassifications('"+t+"', "+n+", "+i+")",function(){return r.languageService.getSyntacticClassifications(t,e.createTextSpan(n,i))})},n.prototype.getSemanticClassifications=function(t,n,i){var r=this;return this.forwardJSONCall("getSemanticClassifications('"+t+"', "+n+", "+i+")",function(){return r.languageService.getSemanticClassifications(t,e.createTextSpan(n,i))})},n.prototype.getEncodedSyntacticClassifications=function(t,n,i){var r=this;return this.forwardJSONCall("getEncodedSyntacticClassifications('"+t+"', "+n+", "+i+")",function(){return u(r.languageService.getEncodedSyntacticClassifications(t,e.createTextSpan(n,i)))})},n.prototype.getEncodedSemanticClassifications=function(t,n,i){var r=this;return this.forwardJSONCall("getEncodedSemanticClassifications('"+t+"', "+n+", "+i+")",function(){return u(r.languageService.getEncodedSemanticClassifications(t,e.createTextSpan(n,i)))})},n.prototype.getSyntacticDiagnostics=function(e){var t=this;return this.forwardJSONCall("getSyntacticDiagnostics('"+e+"')",function(){var n=t.languageService.getSyntacticDiagnostics(e);return t.realizeDiagnostics(n)})},n.prototype.getSemanticDiagnostics=function(e){var t=this;return this.forwardJSONCall("getSemanticDiagnostics('"+e+"')",function(){var n=t.languageService.getSemanticDiagnostics(e);return t.realizeDiagnostics(n)})},n.prototype.getCompilerOptionsDiagnostics=function(){var e=this;return this.forwardJSONCall("getCompilerOptionsDiagnostics()",function(){var t=e.languageService.getCompilerOptionsDiagnostics();return e.realizeDiagnostics(t)})},n.prototype.getQuickInfoAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getQuickInfoAtPosition('"+e+"', "+t+")",function(){return n.languageService.getQuickInfoAtPosition(e,t)})},n.prototype.getNameOrDottedNameSpan=function(e,t,n){var i=this;return this.forwardJSONCall("getNameOrDottedNameSpan('"+e+"', "+t+", "+n+")",function(){return i.languageService.getNameOrDottedNameSpan(e,t,n)})},n.prototype.getBreakpointStatementAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getBreakpointStatementAtPosition('"+e+"', "+t+")",function(){return n.languageService.getBreakpointStatementAtPosition(e,t)})},n.prototype.getSignatureHelpItems=function(e,t){var n=this;return this.forwardJSONCall("getSignatureHelpItems('"+e+"', "+t+")",function(){return n.languageService.getSignatureHelpItems(e,t)})},n.prototype.getDefinitionAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getDefinitionAtPosition('"+e+"', "+t+")",function(){return n.languageService.getDefinitionAtPosition(e,t)})},n.prototype.getTypeDefinitionAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getTypeDefinitionAtPosition('"+e+"', "+t+")",function(){return n.languageService.getTypeDefinitionAtPosition(e,t)})},n.prototype.getImplementationAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getImplementationAtPosition('"+e+"', "+t+")",function(){return n.languageService.getImplementationAtPosition(e,t)})},n.prototype.getRenameInfo=function(e,t){var n=this;return this.forwardJSONCall("getRenameInfo('"+e+"', "+t+")",function(){return n.languageService.getRenameInfo(e,t)})},n.prototype.findRenameLocations=function(e,t,n,i){var r=this;return this.forwardJSONCall("findRenameLocations('"+e+"', "+t+", "+n+", "+i+")",function(){return r.languageService.findRenameLocations(e,t,n,i)})},n.prototype.getBraceMatchingAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getBraceMatchingAtPosition('"+e+"', "+t+")",function(){return n.languageService.getBraceMatchingAtPosition(e,t)})},n.prototype.isValidBraceCompletionAtPosition=function(e,t,n){var i=this;return this.forwardJSONCall("isValidBraceCompletionAtPosition('"+e+"', "+t+", "+n+")",function(){return i.languageService.isValidBraceCompletionAtPosition(e,t,n)})},n.prototype.getSpanOfEnclosingComment=function(e,t,n){var i=this;return this.forwardJSONCall("getSpanOfEnclosingComment('"+e+"', "+t+")",function(){return i.languageService.getSpanOfEnclosingComment(e,t,n)})},n.prototype.getIndentationAtPosition=function(e,t,n){var i=this;return this.forwardJSONCall("getIndentationAtPosition('"+e+"', "+t+")",function(){var r=JSON.parse(n);return i.languageService.getIndentationAtPosition(e,t,r)})},n.prototype.getReferencesAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getReferencesAtPosition('"+e+"', "+t+")",function(){return n.languageService.getReferencesAtPosition(e,t)})},n.prototype.findReferences=function(e,t){var n=this;return this.forwardJSONCall("findReferences('"+e+"', "+t+")",function(){return n.languageService.findReferences(e,t)})},n.prototype.getOccurrencesAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getOccurrencesAtPosition('"+e+"', "+t+")",function(){return n.languageService.getOccurrencesAtPosition(e,t)})},n.prototype.getDocumentHighlights=function(t,n,i){var r=this;return this.forwardJSONCall("getDocumentHighlights('"+t+"', "+n+")",function(){var s=r.languageService.getDocumentHighlights(t,n,JSON.parse(i)),o=e.normalizeSlashes(t).toLowerCase();return e.filter(s,function(t){return e.normalizeSlashes(t.fileName).toLowerCase()===o})})},n.prototype.getCompletionsAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getCompletionsAtPosition('"+e+"', "+t+")",function(){return n.languageService.getCompletionsAtPosition(e,t)})},n.prototype.getCompletionEntryDetails=function(e,t,n,i,r){var s=this;return this.forwardJSONCall("getCompletionEntryDetails('"+e+"', "+t+", '"+n+"')",function(){var o=JSON.parse(i);return s.languageService.getCompletionEntryDetails(e,t,n,o,r)})},n.prototype.getFormattingEditsForRange=function(e,t,n,i){var r=this;return this.forwardJSONCall("getFormattingEditsForRange('"+e+"', "+t+", "+n+")",function(){var s=JSON.parse(i);return r.languageService.getFormattingEditsForRange(e,t,n,s)})},n.prototype.getFormattingEditsForDocument=function(e,t){var n=this;return this.forwardJSONCall("getFormattingEditsForDocument('"+e+"')",function(){var i=JSON.parse(t);return n.languageService.getFormattingEditsForDocument(e,i)})},n.prototype.getFormattingEditsAfterKeystroke=function(e,t,n,i){var r=this;return this.forwardJSONCall("getFormattingEditsAfterKeystroke('"+e+"', "+t+", '"+n+"')",function(){var s=JSON.parse(i);return r.languageService.getFormattingEditsAfterKeystroke(e,t,n,s)})},n.prototype.getDocCommentTemplateAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getDocCommentTemplateAtPosition('"+e+"', "+t+")",function(){return n.languageService.getDocCommentTemplateAtPosition(e,t)})},n.prototype.getNavigateToItems=function(e,t,n){var i=this;return this.forwardJSONCall("getNavigateToItems('"+e+"', "+t+", "+n+")",function(){return i.languageService.getNavigateToItems(e,t,n)})},n.prototype.getNavigationBarItems=function(e){var t=this;return this.forwardJSONCall("getNavigationBarItems('"+e+"')",function(){return t.languageService.getNavigationBarItems(e)})},n.prototype.getNavigationTree=function(e){var t=this;return this.forwardJSONCall("getNavigationTree('"+e+"')",function(){return t.languageService.getNavigationTree(e)})},n.prototype.getOutliningSpans=function(e){var t=this;return this.forwardJSONCall("getOutliningSpans('"+e+"')",function(){return t.languageService.getOutliningSpans(e)})},n.prototype.getTodoComments=function(e,t){var n=this;return this.forwardJSONCall("getTodoComments('"+e+"')",function(){return n.languageService.getTodoComments(e,JSON.parse(t))})},n.prototype.getEmitOutput=function(e){var t=this;return this.forwardJSONCall("getEmitOutput('"+e+"')",function(){return t.languageService.getEmitOutput(e)})},n.prototype.getEmitOutputObject=function(e){var t=this;return o(this.logger,"getEmitOutput('"+e+"')",!1,function(){return t.languageService.getEmitOutput(e)},this.logPerformance)},n}(a);function u(e){return{spans:e.spans.join(","),endOfLineState:e.endOfLineState}}var d=function(t){function n(n,i){var r=t.call(this,n)||this;return r.logger=i,r.logPerformance=!1,r.classifier=e.createClassifier(),r}return __extends(n,t),n.prototype.getEncodedLexicalClassifications=function(e,t,n){var i=this;return s(this.logger,"getEncodedLexicalClassifications",function(){return u(i.classifier.getEncodedLexicalClassifications(e,t,n))},this.logPerformance)},n.prototype.getClassificationsForLine=function(e,t,n){for(var i=this.classifier.getClassificationsForLine(e,t,n),r="",s=0,o=i.entries;s<o.length;s++){var a=o[s];r+=a.length+"\n",r+=a.classification+"\n"}return r+=i.finalLexState},n}(a),p=function(t){function n(e,n,i){var r=t.call(this,e)||this;return r.logger=n,r.host=i,r.logPerformance=!1,r}return __extends(n,t),n.prototype.forwardJSONCall=function(e,t){return s(this.logger,e,t,this.logPerformance)},n.prototype.resolveModuleName=function(t,n,i){var r=this;return this.forwardJSONCall("resolveModuleName('"+t+"')",function(){var s=JSON.parse(i),o=e.resolveModuleName(n,e.normalizeSlashes(t),s,r.host),a=o.resolvedModule?o.resolvedModule.resolvedFileName:void 0;return o.resolvedModule&&".ts"!==o.resolvedModule.extension&&".tsx"!==o.resolvedModule.extension&&".d.ts"!==o.resolvedModule.extension&&(a=void 0),{resolvedFileName:a,failedLookupLocations:o.failedLookupLocations}})},n.prototype.resolveTypeReferenceDirective=function(t,n,i){var r=this;return this.forwardJSONCall("resolveTypeReferenceDirective("+t+")",function(){var s=JSON.parse(i),o=e.resolveTypeReferenceDirective(n,e.normalizeSlashes(t),s,r.host);return{resolvedFileName:o.resolvedTypeReferenceDirective?o.resolvedTypeReferenceDirective.resolvedFileName:void 0,primary:!o.resolvedTypeReferenceDirective||o.resolvedTypeReferenceDirective.primary,failedLookupLocations:o.failedLookupLocations}})},n.prototype.getPreProcessedFileInfo=function(t,n){var i=this;return this.forwardJSONCall("getPreProcessedFileInfo('"+t+"')",function(){var t=e.preProcessFile(n.getText(0,n.getLength()),!0,!0);return{referencedFiles:i.convertFileReferences(t.referencedFiles),importedFiles:i.convertFileReferences(t.importedFiles),ambientExternalModules:t.ambientExternalModules,isLibFile:t.isLibFile,typeReferenceDirectives:i.convertFileReferences(t.typeReferenceDirectives)}})},n.prototype.getAutomaticTypeDirectiveNames=function(t){var n=this;return this.forwardJSONCall("getAutomaticTypeDirectiveNames('"+t+"')",function(){var i=JSON.parse(t);return e.getAutomaticTypeDirectiveNames(i,n.host)})},n.prototype.convertFileReferences=function(t){if(t){for(var n=[],i=0,r=t;i<r.length;i++){var s=r[i];n.push({path:e.normalizeSlashes(s.fileName),position:s.pos,length:s.end-s.pos})}return n}},n.prototype.getTSConfigFileInfo=function(t,n){var i=this;return this.forwardJSONCall("getTSConfigFileInfo('"+t+"')",function(){var r=n.getText(0,n.getLength()),s=e.parseJsonText(t,r),o=e.normalizeSlashes(t),a=e.parseJsonSourceFileConfigFileContent(s,i.host,e.getDirectoryPath(o),{},o);return{options:a.options,typeAcquisition:a.typeAcquisition,files:a.fileNames,raw:a.raw,errors:l(s.parseDiagnostics.concat(a.errors),"\r\n")}})},n.prototype.getDefaultCompilationSettings=function(){return this.forwardJSONCall("getDefaultCompilationSettings()",function(){return e.getDefaultCompilerOptions()})},n.prototype.discoverTypings=function(t){var n=this,i=e.createGetCanonicalFileName(!1);return this.forwardJSONCall("discoverTypings()",function(){var r=JSON.parse(t);return void 0===n.safeList&&(n.safeList=e.JsTyping.loadSafeList(n.host,e.toPath(r.safeListPath,r.safeListPath,i))),e.JsTyping.discoverTypings(n.host,function(e){return n.logger.log(e)},r.fileNames,e.toPath(r.projectRootPath,r.projectRootPath,i),n.safeList,r.packageNameToTypingLocation,r.typeAcquisition,r.unresolvedImports)})},n}(a),h=function(){function n(){this._shims=[]}return n.prototype.getServicesVersion=function(){return e.servicesVersion},n.prototype.createLanguageServiceShim=function(n){try{void 0===this.documentRegistry&&(this.documentRegistry=e.createDocumentRegistry(n.useCaseSensitiveFileNames&&n.useCaseSensitiveFileNames(),n.getCurrentDirectory()));var r=new i(n),s=e.createLanguageService(r,this.documentRegistry);return new c(this,n,s)}catch(e){throw t(n,e),e}},n.prototype.createClassifierShim=function(e){try{return new d(this,e)}catch(n){throw t(e,n),n}},n.prototype.createCoreServicesShim=function(e){try{var n=new r(e);return new p(this,e,n)}catch(n){throw t(e,n),n}},n.prototype.close=function(){e.clear(this._shims),this.documentRegistry=void 0},n.prototype.registerShim=function(e){this._shims.push(e)},n.prototype.unregisterShim=function(e){for(var t=0;t<this._shims.length;t++)if(this._shims[t]===e)return void delete this._shims[t];throw new Error("Invalid operation")},n}();e.TypeScriptServicesFactory=h,"undefined"!=typeof module&&module.exports&&(module.exports=e)}(ts||(ts={})),function(e){!function(e){e.TypeScriptServicesFactory=ts.TypeScriptServicesFactory}(e.Services||(e.Services={}))}(TypeScript||(TypeScript={}));var toolsVersion="2.6",e=function(){function t(e,t){postMessage({action:Ue,cbn:t,result:e})}function n(e){var t=[];return t[e-1]=void 0,t}function i(e,t){return o(e[0]+t[0],e[1]+t[1])}function r(e,t){return function(e,t){var n,i;return n=e*He,i=t,0>t&&(i+=He),[i,n]}(Math.max(Math.min(e[1]/He,2147483647),-2147483648)&Math.max(Math.min(t[1]/He,2147483647),-2147483648),c(e)&c(t))}function s(e,t){var n,i;return e[0]==t[0]&&e[1]==t[1]?0:(n=0>e[1],i=0>t[1],n&&!i?-1:!n&&i?1:h(e,t)[1]<0?-1:1)}function o(e,t){var n,i;for(e%=0x10000000000000000,t=(t%=0x10000000000000000)-(n=t%He)+(i=Math.floor(e/He)*He),e=e-i+n;0>e;)e+=He,t-=He;for(;e>4294967295;)e-=He,t+=He;for(t%=0x10000000000000000;t>0x7fffffff00000000;)t-=0x10000000000000000;for(;-0x8000000000000000>t;)t+=0x10000000000000000;return[e,t]}function a(e,t){return e[0]==t[0]&&e[1]==t[1]}function l(e){return e>=0?[e,0]:[e+He,-He]}function c(e){return e[0]>=2147483648?~~Math.max(Math.min(e[0]-He,2147483647),-2147483648):~~Math.max(Math.min(e[0],2147483647),-2147483648)}function u(e){return 30>=e?1<<e:u(30)*u(e-30)}function d(e,t){var n,i,r,s;if(t&=63,a(e,je))return t?Ke:e;if(0>e[1])throw Error("Neg");return s=u(t),i=e[1]*s%0x10000000000000000,(i+=n=(r=e[0]*s)-r%He)>=0x8000000000000000&&(i-=0x10000000000000000),[r-=n,i]}function p(e,t){var n;return n=u(t&=63),o(Math.floor(e[0]/n),e[1]/n)}function h(e,t){return o(e[0]-t[0],e[1]-t[1])}function f(e,t){return e.Mc=t,e.Lc=0,e.Yb=t.length,e}function m(e){return e.Lc>=e.Yb?-1:255&e.Mc[e.Lc++]}function g(e,t,n,i){return e.Lc>=e.Yb?-1:(i=Math.min(i,e.Yb-e.Lc),T(e.Mc,e.Lc,t,n,i),e.Lc+=i,i)}function _(e){return e.Mc=n(32),e.Yb=0,e}function y(e){var t=e.Mc;return t.length=e.Yb,t}function b(e,t){e.Mc[e.Yb++]=t<<24>>24}function v(e,t,n,i){T(t,n,e.Mc,e.Yb,i),e.Yb+=i}function T(e,t,n,i,r){for(var s=0;r>s;++s)n[i+s]=e[t+s]}function k(t,n,i,r,o){var a,l;if(s(r,Ge)<0)throw Error("invalid length "+r);for(t.Tb=r,function(e,t){(function(e,t){e.ab=t;for(var n=0;t>1<<n;++n);e.$b=2*n})(t,1<<e.s),t.n=e.f,function(e,t){var n=e.X;e.X=t,e.b&&n!=e.X&&(e.wb=-1,e.b=null)}(t,e.m),t.eb=0,t.fb=3,t.Y=2,t.y=3}(o,a=J({})),a.Gc=void 0===e.disableEndMark,function(e,t){e.fc[0]=9*(5*e.Y+e.eb)+e.fb<<24>>24;for(var n=0;4>n;++n)e.fc[1+n]=e.ab>>8*n<<24>>24;v(t,e.fc,0,5)}(a,i),l=0;64>l;l+=8)b(i,255&c(p(r,l)));t.yb=(a.W=0,a.oc=n,a.pc=0,function(e){var t,n;e.b||(t={},n=4,e.X||(n=2),function(e,t){e.qb=t>2,e.qb?(e.w=0,e.xb=4,e.R=66560):(e.w=2,e.xb=3,e.R=0)}(t,n),e.b=t),pe(e.A,e.eb,e.fb),(e.ab!=e.wb||e.Hb!=e.n)&&(D(e.b,e.ab,4096,e.n,274),e.wb=e.ab,e.Hb=e.n)}(a),a.d.Ab=i,function(e){(function(e){e.l=0,e.J=0;for(var t=0;4>t;++t)e.v[t]=0})(e),function(e){e.mc=Ke,e.xc=Ke,e.E=-1,e.Jb=1,e.Oc=0}(e.d),Ae(e.C),Ae(e._),Ae(e.bb),Ae(e.hb),Ae(e.Ub),Ae(e.vc),Ae(e.Sb),function(e){var t,n=1<<e.u+e.I;for(t=0;n>t;++t)Ae(e.V[t].tb)}(e.A);for(var t=0;4>t;++t)Ae(e.K[t].G);oe(e.$,1<<e.Y),oe(e.i,1<<e.Y),Ae(e.S.G),e.N=0,e.jb=0,e.q=0,e.s=0}(a),X(a),Y(a),a.$.rb=a.n+1-2,de(a.$,1<<a.Y),a.i.rb=a.n+1-2,de(a.i,1<<a.Y),a.g=Ke,function(e,t){return e.cb=t,e.Z=null,e.zc=1,e}({},a))}function x(e,t,n){return e.Nb=_({}),k(e,f({},t),e.Nb,l(t.length),n),e}function E(e,t,n){var i,r,s,o,a="",c=[];for(r=0;5>r;++r){if(-1==(s=m(t)))throw Error("truncated input");c[r]=s<<24>>24}if(!function(e,t){var n,i,r,s,o,a,l;if(5>t.length)return 0;for(l=255&t[0],r=l%9,s=(a=~~(l/9))%5,o=~~(a/5),n=0,i=0;4>i;++i)n+=(255&t[1+i])<<8*i;return n>99999999||!function(e,t,n,i){if(t>8||n>4||i>4)return 0;z(e.gb,n,t);var r=1<<i;return H(e.Rb,r),H(e.sb,r),e.Dc=r-1,1}(e,r,s,o)?0:function(e,t){return 0>t?0:(e.Ob!=t&&(e.Ob=t,e.nb=Math.max(e.Ob,1),L(e.B,Math.max(e.nb,4096))),1)}(e,n)}(i=V({}),c))throw Error("corrupted input");for(r=0;64>r;r+=8){if(-1==(s=m(t)))throw Error("truncated input");1==(s=s.toString(16)).length&&(s="0"+s),a=s+""+a}/^0+$|^f+$/i.test(a)?e.Tb=Ge:(o=parseInt(a,16),e.Tb=o>4294967295?Ge:l(o)),e.yb=function(e,t,n,i){return e.e.Ab=t,F(e.B),e.B.cc=n,function(e){e.B.h=0,e.B.o=0,Ae(e.Gb),Ae(e.pb),Ae(e.Zb),Ae(e.Cb),Ae(e.Db),Ae(e.Eb),Ae(e.kc),function(e){var t,n;for(n=1<<e.u+e.I,t=0;n>t;++t)Ae(e.V[t].Ib)}(e.gb);for(var t=0;4>t;++t)Ae(e.kb[t].G);K(e.Rb),K(e.sb),Ae(e.Fb.G),function(e){e.Bb=0,e.E=-1;for(var t=0;5>t;++t)e.Bb=e.Bb<<8|m(e.Ab)}(e.e)}(e),e.U=0,e.ib=0,e.Jc=0,e.Ic=0,e.Qc=0,e.Nc=i,e.g=Ke,e.jc=0,function(e,t){return e.Z=t,e.cb=null,e.zc=1,e}({},e)}(i,t,n,e.Tb)}function S(e,t){return e.Nb=_({}),E(e,f({},t),e.Nb),e}function C(e,t){return e.c[e.f+e.o+t]}function w(e,t,n,i){var r,s;for(e.T&&e.o+t+i>e.h&&(i=e.h-(e.o+t)),++n,s=e.f+e.o+t,r=0;i>r&&e.c[s+r]==e.c[s+r-n];++r);return r}function I(e){return e.h-e.o}function A(e){var t,n;if(!e.T)for(;;){if(!(n=-e.f+e.Kb-e.h))return;if(-1==(t=g(e.cc,e.c,e.f+e.h,n)))return e.zb=e.h,e.f+e.zb>e.H&&(e.zb=e.H-e.f),void(e.T=1);e.h+=t,e.h>=e.o+e._b&&(e.zb=e.h-e._b)}}function N(e,t){e.f+=t,e.zb-=t,e.o-=t,e.h-=t}function D(e,t,i,r,s){var o,a;1073741567>t&&(e.Fc=16+(r>>1),function(e,t,i,r){var s;e.Bc=t,e._b=i,s=t+i+r,(null==e.c||e.Kb!=s)&&(e.c=null,e.Kb=s,e.c=n(e.Kb)),e.H=e.Kb-i}(e,t+i,r+s,256+~~((t+i+r+s)/2)),e.ob=r,o=t+1,e.p!=o&&(e.L=n(2*(e.p=o))),a=65536,e.qb&&(a=t-1,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a>>=1,(a|=65535)>16777216&&(a>>=1),e.Ec=a,++a,a+=e.R),a!=e.rc&&(e.ub=n(e.rc=a)))}function O(e){var t;++e.k>=e.p&&(e.k=0),function(e){++e.o,e.o>e.zb&&(e.f+e.o>e.H&&function(e){var t,n,i;for((i=e.f+e.o-e.Bc)>0&&--i,n=e.f+e.h-i,t=0;n>t;++t)e.c[t]=e.c[i+t];e.f-=i}(e),A(e))}(e),1073741823==e.o&&(t=e.o-e.p,R(e.L,2*e.p,t),R(e.ub,e.rc,t),N(e,t))}function R(e,t,n){var i,r;for(i=0;t>i;++i)n>=(r=e[i]||0)?r=0:r-=n,e[i]=r}function L(e,t){(null==e.Lb||e.M!=t)&&(e.Lb=n(t)),e.M=t,e.o=0,e.h=0}function P(e){var t=e.o-e.h;t&&(v(e.cc,e.Lb,e.h,t),e.o>=e.M&&(e.o=0),e.h=e.o)}function M(e,t){var n=e.o-t-1;return 0>n&&(n+=e.M),e.Lb[n]}function F(e){P(e),e.cc=null}function B(e){return 4>(e-=2)?e:3}function $(e){return 4>e?0:10>e?e-3:e-6}function U(e){if(!e.zc)throw Error("bad state");return e.cb?function(e){(function(e,t,n,r){var o,u,d,p,f,m,g,_,y,b,v,T,k,x,E;if(t[0]=Ke,n[0]=Ke,r[0]=1,e.oc&&(e.b.cc=e.oc,function(e){e.f=0,e.o=0,e.h=0,e.T=0,A(e),e.k=0,N(e,-1)}(e.b),e.W=1,e.oc=null),!e.pc){if(e.pc=1,x=e.g,a(e.g,Ke)){if(!I(e.b))return void Z(e,c(e.g));ie(e),k=c(e.g)&e.y,Ne(e.d,e.C,(e.l<<4)+k,0),e.l=$(e.l),d=C(e.b,-e.s),fe(he(e.A,c(e.g),e.J),e.d,d),e.J=d,--e.s,e.g=i(e.g,ze)}if(!I(e.b))return void Z(e,c(e.g));for(;;){if(g=Q(e,c(e.g)),b=e.mb,k=c(e.g)&e.y,u=(e.l<<4)+k,1==g&&-1==b)Ne(e.d,e.C,u,0),d=C(e.b,-e.s),E=he(e.A,c(e.g),e.J),7>e.l?fe(E,e.d,d):(y=C(e.b,-e.v[0]-1-e.s),me(E,e.d,y,d)),e.J=d,e.l=$(e.l);else{if(Ne(e.d,e.C,u,1),4>b){if(Ne(e.d,e.bb,e.l,1),b?(Ne(e.d,e.hb,e.l,1),1==b?Ne(e.d,e.Ub,e.l,0):(Ne(e.d,e.Ub,e.l,1),Ne(e.d,e.vc,e.l,b-2))):(Ne(e.d,e.hb,e.l,0),Ne(e.d,e._,u,1==g?0:1)),1==g?e.l=7>e.l?9:11:(le(e.i,e.d,g-2,k),e.l=7>e.l?8:11),p=e.v[b],0!=b){for(m=b;m>=1;--m)e.v[m]=e.v[m-1];e.v[0]=p}}else{for(Ne(e.d,e.bb,e.l,0),e.l=7>e.l?7:10,le(e.$,e.d,g-2,k),T=se(b-=4),_=B(g),ke(e.K[_],e.d,T),T>=4&&(v=b-(o=(2|1&T)<<(f=(T>>1)-1)),14>T?Ce(e.Sb,o-T-1,e.d,f,v):(De(e.d,v>>4,f-4),Ee(e.S,e.d,15&v),++e.Qb)),p=b,m=3;m>=1;--m)e.v[m]=e.v[m-1];e.v[0]=p,++e.Mb}e.J=C(e.b,g-1-e.s)}if(e.s-=g,e.g=i(e.g,l(g)),!e.s){if(e.Mb>=128&&X(e),e.Qb>=16&&Y(e),t[0]=e.g,n[0]=Oe(e.d),!I(e.b))return void Z(e,c(e.g));if(s(h(e.g,x),[4096,0])>=0)return e.pc=0,void(r[0]=0)}}}})(e.cb,e.cb.Xb,e.cb.uc,e.cb.Kc),e.Pb=e.cb.Xb[0],e.cb.Kc[0]&&(function(e){re(e),e.d.Ab=null}(e.cb),e.zc=0)}(e):function(e){var t=function(e){var t,n,r,o,a,u;if(u=c(e.g)&e.Dc,Ie(e.e,e.Gb,(e.U<<4)+u)){if(Ie(e.e,e.Zb,e.U))r=0,Ie(e.e,e.Cb,e.U)?(Ie(e.e,e.Db,e.U)?(Ie(e.e,e.Eb,e.U)?(n=e.Qc,e.Qc=e.Ic):n=e.Ic,e.Ic=e.Jc):n=e.Jc,e.Jc=e.ib,e.ib=n):Ie(e.e,e.pb,(e.U<<4)+u)||(e.U=7>e.U?9:11,r=1),r||(r=G(e.sb,e.e,u)+2,e.U=7>e.U?8:11);else if(e.Qc=e.Ic,e.Ic=e.Jc,e.Jc=e.ib,r=2+G(e.Rb,e.e,u),e.U=7>e.U?7:10,(a=ve(e.kb[B(r)],e.e))>=4){if(o=(a>>1)-1,e.ib=(2|1&a)<<o,14>a)e.ib+=function(e,t,n,i){var r,s,o=1,a=0;for(s=0;i>s;++s)r=Ie(n,e,t+o),o<<=1,o+=r,a|=r<<s;return a}(e.kc,e.ib-a-1,e.e,o);else if(e.ib+=function(e,t){var n,i,r=0;for(n=t;0!=n;--n)e.E>>>=1,i=e.Bb-e.E>>>31,e.Bb-=e.E&i-1,r=r<<1|1-i,-16777216&e.E||(e.Bb=e.Bb<<8|m(e.Ab),e.E<<=8);return r}(e.e,o-4)<<4,e.ib+=function(e,t){var n,i,r=1,s=0;for(i=0;e.F>i;++i)n=Ie(t,e.G,r),r<<=1,r+=n,s|=n<<i;return s}(e.Fb,e.e),0>e.ib)return-1==e.ib?1:-1}else e.ib=a;if(s(l(e.ib),e.g)>=0||e.ib>=e.nb)return-1;(function(e,t,n){var i=e.o-t-1;for(0>i&&(i+=e.M);0!=n;--n)i>=e.M&&(i=0),e.Lb[e.o++]=e.Lb[i++],e.o>=e.M&&P(e)})(e.B,e.ib,r),e.g=i(e.g,l(r)),e.jc=M(e.B,0)}else t=function(e,t,n){return e.V[((t&e.qc)<<e.u)+((255&n)>>>8-e.u)]}(e.gb,c(e.g),e.jc),e.jc=7>e.U?function(e,t){var n=1;do{n=n<<1|Ie(t,e.Ib,n)}while(256>n);return n<<24>>24}(t,e.e):function(e,t,n){var i,r,s=1;do{if(r=n>>7&1,n<<=1,i=Ie(t,e.Ib,(1+r<<8)+s),s=s<<1|i,r!=i){for(;256>s;)s=s<<1|Ie(t,e.Ib,s);break}}while(256>s);return s<<24>>24}(t,e.e,M(e.B,e.ib)),function(e,t){e.Lb[e.o++]=t,e.o>=e.M&&P(e)}(e.B,e.jc),e.U=$(e.U),e.g=i(e.g,ze);return 0}(e.Z);if(-1==t)throw Error("corrupted input");e.Pb=Ge,e.Pc=e.Z.g,(t||s(e.Z.Nc,Ke)>=0&&s(e.Z.g,e.Z.Nc)>=0)&&(P(e.Z.B),F(e.Z.B),e.Z.e.Ab=null,e.zc=0)}(e),e.zc}function V(e){e.B={},e.e={},e.Gb=n(192),e.Zb=n(12),e.Cb=n(12),e.Db=n(12),e.Eb=n(12),e.pb=n(192),e.kb=n(4),e.kc=n(114),e.Fb=be({},4),e.Rb=j({}),e.sb=j({}),e.gb={};for(var t=0;4>t;++t)e.kb[t]=be({},6);return e}function H(e,t){for(;t>e.O;++e.O)e.ec[e.O]=be({},3),e.hc[e.O]=be({},3)}function G(e,t,n){return Ie(t,e.wc,0)?8+(Ie(t,e.wc,1)?8+ve(e.tc,t):ve(e.hc[n],t)):ve(e.ec[n],t)}function j(e){return e.wc=n(2),e.ec=n(16),e.hc=n(16),e.tc=be({},8),e.O=0,e}function K(e){Ae(e.wc);for(var t=0;e.O>t;++t)Ae(e.ec[t].G),Ae(e.hc[t].G);Ae(e.tc.G)}function z(e,t,i){var r,s;if(null==e.V||e.u!=i||e.I!=t)for(e.I=t,e.qc=(1<<t)-1,e.u=i,s=1<<e.u+e.I,e.V=n(s),r=0;s>r;++r)e.V[r]=W({})}function W(e){return e.Ib=n(768),e}function q(e,t){var n,i,r,s;e.jb=t,r=e.a[t].r,i=e.a[t].j;do{e.a[t].t&&(ye(e.a[r]),e.a[r].r=r-1,e.a[t].Ac&&(e.a[r-1].t=0,e.a[r-1].r=e.a[t].r2,e.a[r-1].j=e.a[t].j2)),s=r,n=i,i=e.a[s].j,r=e.a[s].r,e.a[s].j=n,e.a[s].r=t,t=s}while(t>0);return e.mb=e.a[0].j,e.q=e.a[0].r}function J(e){var t;for(e.v=n(4),e.a=[],e.d={},e.C=n(192),e.bb=n(12),e.hb=n(12),e.Ub=n(12),e.vc=n(12),e._=n(192),e.K=[],e.Sb=n(114),e.S=Te({},4),e.$=ce({}),e.i=ce({}),e.A={},e.m=[],e.P=[],e.lb=[],e.nc=n(16),e.x=n(4),e.Q=n(4),e.Xb=[Ke],e.uc=[Ke],e.Kc=[0],e.fc=n(5),e.yc=n(128),e.vb=0,e.X=1,e.D=0,e.Hb=-1,e.mb=0,t=0;4096>t;++t)e.a[t]={};for(t=0;4>t;++t)e.K[t]=Te({},6);return e}function Y(e){for(var t=0;16>t;++t)e.nc[t]=Se(e.S,t);e.Qb=0}function X(e){var t,n,i,r,s,o,a,l;for(r=4;128>r;++r)t=(2|1&(o=se(r)))<<(i=(o>>1)-1),e.yc[r]=we(e.Sb,t-o-1,i,r-t);for(s=0;4>s;++s){for(n=e.K[s],a=s<<6,o=0;e.$b>o;++o)e.P[a+o]=xe(n,o);for(o=14;e.$b>o;++o)e.P[a+o]+=(o>>1)-1-4<<6;for(l=128*s,r=0;4>r;++r)e.lb[l+r]=e.P[a+r];for(;128>r;++r)e.lb[l+r]=e.P[a+se(r)]+e.yc[r]}e.Mb=0}function Z(e,t){re(e),function(e,t){if(e.Gc){Ne(e.d,e.C,(e.l<<4)+t,1),Ne(e.d,e.bb,e.l,0),e.l=7>e.l?7:10,le(e.$,e.d,0,t);var n=B(2);ke(e.K[n],e.d,63),De(e.d,67108863,26),Ee(e.S,e.d,15)}}(e,t&e.y);for(var n=0;5>n;++n)Re(e.d)}function Q(e,t){var n,i,r,s,o,a,l,c,u,d,p,h,f,m,g,_,y,b,v,T,k,x,E,S,A,N,D,O,R,L,P,M,F,B,U,V,H,G,j,K,z,W,J,Y;if(e.jb!=e.q)return f=e.a[e.q].r-e.q,e.mb=e.a[e.q].j,e.q=e.a[e.q].r,f;if(e.q=e.jb=0,e.N?(h=e.vb,e.N=0):h=ie(e),N=e.D,2>(S=I(e.b)+1))return e.mb=-1,1;for(S>273&&(S=273),j=0,u=0;4>u;++u)e.x[u]=e.v[u],e.Q[u]=w(e.b,-1,e.x[u],273),e.Q[u]>e.Q[j]&&(j=u);if(e.Q[j]>=e.n)return e.mb=j,ne(e,(f=e.Q[j])-1),f;if(h>=e.n)return e.mb=e.m[N-1]+4,ne(e,h-1),h;if(l=C(e.b,-1),y=C(e.b,-e.v[0]-1-1),2>h&&l!=y&&2>e.Q[j])return e.mb=-1,1;if(e.a[0].Hc=e.l,F=t&e.y,e.a[1].z=Je[e.C[(e.l<<4)+F]>>>2]+_e(he(e.A,t,e.J),e.l>=7,y,l),ye(e.a[1]),G=(b=Je[2048-e.C[(e.l<<4)+F]>>>2])+Je[2048-e.bb[e.l]>>>2],y==l&&(K=G+function(e,t,n){return Je[e.hb[t]>>>2]+Je[e._[(t<<4)+n]>>>2]}(e,e.l,F),e.a[1].z>K&&(e.a[1].z=K,function(e){e.j=0,e.t=0}(e.a[1]))),2>(p=h>=e.Q[j]?h:e.Q[j]))return e.mb=e.a[1].j,1;e.a[1].r=0,e.a[0].bc=e.x[0],e.a[0].ac=e.x[1],e.a[0].dc=e.x[2],e.a[0].lc=e.x[3],d=p;do{e.a[d--].z=268435455}while(d>=2);for(u=0;4>u;++u)if(!(2>(H=e.Q[u]))){U=G+te(e,u,e.l,F);do{s=U+ue(e.i,H-2,F),(L=e.a[H]).z>s&&(L.z=s,L.r=0,L.j=u,L.t=0)}while(--H>=2)}if(E=b+Je[e.bb[e.l]>>>2],h>=(d=e.Q[0]>=2?e.Q[0]+1:2)){for(D=0;d>e.m[D];)D+=2;for(;s=E+ee(e,c=e.m[D+1],d,F),(L=e.a[d]).z>s&&(L.z=s,L.r=0,L.j=c+4,L.t=0),d!=e.m[D]||(D+=2)!=N;++d);}for(n=0;;){if(++n==p)return q(e,n);if(v=ie(e),N=e.D,v>=e.n)return e.vb=v,e.N=1,q(e,n);if(++t,M=e.a[n].r,e.a[n].t?(--M,e.a[n].Ac?(W=e.a[e.a[n].r2].Hc,W=4>e.a[n].j2?7>W?8:11:7>W?7:10):W=e.a[M].Hc,W=$(W)):W=e.a[M].Hc,M==n-1?W=e.a[n].j?$(W):7>W?9:11:(e.a[n].t&&e.a[n].Ac?(M=e.a[n].r2,P=e.a[n].j2,W=7>W?8:11):W=4>(P=e.a[n].j)?7>W?8:11:7>W?7:10,R=e.a[M],4>P?P?1==P?(e.x[0]=R.ac,e.x[1]=R.bc,e.x[2]=R.dc,e.x[3]=R.lc):2==P?(e.x[0]=R.dc,e.x[1]=R.bc,e.x[2]=R.ac,e.x[3]=R.lc):(e.x[0]=R.lc,e.x[1]=R.bc,e.x[2]=R.ac,e.x[3]=R.dc):(e.x[0]=R.bc,e.x[1]=R.ac,e.x[2]=R.dc,e.x[3]=R.lc):(e.x[0]=P-4,e.x[1]=R.bc,e.x[2]=R.ac,e.x[3]=R.dc)),e.a[n].Hc=W,e.a[n].bc=e.x[0],e.a[n].ac=e.x[1],e.a[n].dc=e.x[2],e.a[n].lc=e.x[3],a=e.a[n].z,l=C(e.b,-1),y=C(e.b,-e.x[0]-1-1),F=t&e.y,i=a+Je[e.C[(W<<4)+F]>>>2]+_e(he(e.A,t,C(e.b,-2)),W>=7,y,l),T=0,(k=e.a[n+1]).z>i&&(k.z=i,k.r=n,k.j=-1,k.t=0,T=1),G=(b=a+Je[2048-e.C[(W<<4)+F]>>>2])+Je[2048-e.bb[W]>>>2],y!=l||n>k.r&&!k.j||(K=G+(Je[e.hb[W]>>>2]+Je[e._[(W<<4)+F]>>>2]),k.z>=K&&(k.z=K,k.r=n,k.j=0,k.t=0,T=1)),!(2>(S=A=(A=I(e.b)+1)>4095-n?4095-n:A))){if(S>e.n&&(S=e.n),!T&&y!=l&&(Y=Math.min(A-1,e.n),(g=w(e.b,0,e.x[0],Y))>=2)){for(J=$(W),B=t+1&e.y,x=i+Je[2048-e.C[(J<<4)+B]>>>2]+Je[2048-e.bb[J]>>>2],O=n+1+g;O>p;)e.a[++p].z=268435455;s=x+(ue(e.i,g-2,B)+te(e,0,J,B)),(L=e.a[O]).z>s&&(L.z=s,L.r=n+1,L.j=0,L.t=1,L.Ac=0)}for(z=2,V=0;4>V;++V)if(!(2>(m=w(e.b,-1,e.x[V],S)))){_=m;do{for(;n+m>p;)e.a[++p].z=268435455;s=G+(ue(e.i,m-2,F)+te(e,V,W,F)),(L=e.a[n+m]).z>s&&(L.z=s,L.r=n,L.j=V,L.t=0)}while(--m>=2);if(m=_,V||(z=m+1),A>m&&(Y=Math.min(A-1-m,e.n),(g=w(e.b,m,e.x[V],Y))>=2)){for(J=7>W?8:11,B=t+m&e.y,r=G+(ue(e.i,m-2,F)+te(e,V,W,F))+Je[e.C[(J<<4)+B]>>>2]+_e(he(e.A,t+m,C(e.b,m-1-1)),1,C(e.b,m-1-(e.x[V]+1)),C(e.b,m-1)),J=$(J),B=t+m+1&e.y,x=r+Je[2048-e.C[(J<<4)+B]>>>2]+Je[2048-e.bb[J]>>>2],O=m+1+g;n+O>p;)e.a[++p].z=268435455;s=x+(ue(e.i,g-2,B)+te(e,0,J,B)),(L=e.a[n+O]).z>s&&(L.z=s,L.r=n+m+1,L.j=0,L.t=1,L.Ac=1,L.r2=n,L.j2=V)}}if(v>S){for(v=S,N=0;v>e.m[N];N+=2);e.m[N]=v,N+=2}if(v>=z){for(E=b+Je[e.bb[W]>>>2];n+v>p;)e.a[++p].z=268435455;for(D=0;z>e.m[D];)D+=2;for(m=z;;++m)if(s=E+ee(e,o=e.m[D+1],m,F),(L=e.a[n+m]).z>s&&(L.z=s,L.r=n,L.j=o+4,L.t=0),m==e.m[D]){if(A>m&&(Y=Math.min(A-1-m,e.n),(g=w(e.b,m,o,Y))>=2)){for(J=7>W?7:10,B=t+m&e.y,r=s+Je[e.C[(J<<4)+B]>>>2]+_e(he(e.A,t+m,C(e.b,m-1-1)),1,C(e.b,m-(o+1)-1),C(e.b,m-1)),J=$(J),B=t+m+1&e.y,x=r+Je[2048-e.C[(J<<4)+B]>>>2]+Je[2048-e.bb[J]>>>2],O=m+1+g;n+O>p;)e.a[++p].z=268435455;s=x+(ue(e.i,g-2,B)+te(e,0,J,B)),(L=e.a[n+O]).z>s&&(L.z=s,L.r=n+m+1,L.j=0,L.t=1,L.Ac=1,L.r2=n,L.j2=o+4)}if((D+=2)==N)break}}}}}function ee(e,t,n,i){var r=B(n);return(128>t?e.lb[128*r+t]:e.P[(r<<6)+function(e){return 131072>e?qe[e>>6]+12:134217728>e?qe[e>>16]+32:qe[e>>26]+52}(t)]+e.nc[15&t])+ue(e.$,n-2,i)}function te(e,t,n,i){var r;return t?(r=Je[2048-e.hb[n]>>>2],1==t?r+=Je[e.Ub[n]>>>2]:(r+=Je[2048-e.Ub[n]>>>2],r+=Le(e.vc[n],t-2))):(r=Je[e.hb[n]>>>2],r+=Je[2048-e._[(n<<4)+i]>>>2]),r}function ne(e,t){t>0&&(function(e,t){var n,i,r,s,o,a,l,c,u,d,p,h,f,m,g,_,y;do{if(e.h>=e.o+e.ob)h=e.ob;else if(h=e.h-e.o,e.xb>h){O(e);continue}for(f=e.o>e.p?e.o-e.p:0,i=e.f+e.o,e.qb?(a=1023&(y=We[255&e.c[i]]^255&e.c[i+1]),e.ub[a]=e.o,l=65535&(y^=(255&e.c[i+2])<<8),e.ub[1024+l]=e.o,c=(y^We[255&e.c[i+3]]<<5)&e.Ec):c=255&e.c[i]^(255&e.c[i+1])<<8,r=e.ub[e.R+c],e.ub[e.R+c]=e.o,g=1+(e.k<<1),_=e.k<<1,d=p=e.w,n=e.Fc;;){if(f>=r||0==n--){e.L[g]=e.L[_]=0;break}if(o=e.o-r,s=(e.k>=o?e.k-o:e.k-o+e.p)<<1,m=e.f+r,u=p>d?d:p,e.c[m+u]==e.c[i+u]){for(;++u!=h&&e.c[m+u]==e.c[i+u];);if(u==h){e.L[_]=e.L[s],e.L[g]=e.L[s+1];break}}(255&e.c[i+u])>(255&e.c[m+u])?(e.L[_]=r,_=s+1,r=e.L[_],p=u):(e.L[g]=r,g=s,r=e.L[g],d=u)}O(e)}while(0!=--t)}(e.b,t),e.s+=t)}function ie(e){var t=0;return e.D=function(e,t){var n,i,r,s,o,a,l,c,u,d,p,h,f,m,g,_,y,b,v,T,k;if(e.h>=e.o+e.ob)m=e.ob;else if(m=e.h-e.o,e.xb>m)return O(e),0;for(y=0,g=e.o>e.p?e.o-e.p:0,i=e.f+e.o,_=1,c=0,u=0,e.qb?(c=1023&(k=We[255&e.c[i]]^255&e.c[i+1]),u=65535&(k^=(255&e.c[i+2])<<8),d=(k^We[255&e.c[i+3]]<<5)&e.Ec):d=255&e.c[i]^(255&e.c[i+1])<<8,r=e.ub[e.R+d]||0,e.qb&&(s=e.ub[c]||0,o=e.ub[1024+u]||0,e.ub[c]=e.o,e.ub[1024+u]=e.o,s>g&&e.c[e.f+s]==e.c[i]&&(t[y++]=_=2,t[y++]=e.o-s-1),o>g&&e.c[e.f+o]==e.c[i]&&(o==s&&(y-=2),t[y++]=_=3,t[y++]=e.o-o-1,s=o),0!=y&&s==r&&(y-=2,_=1)),e.ub[e.R+d]=e.o,v=1+(e.k<<1),T=e.k<<1,h=f=e.w,0!=e.w&&r>g&&e.c[e.f+r+e.w]!=e.c[i+e.w]&&(t[y++]=_=e.w,t[y++]=e.o-r-1),n=e.Fc;;){if(g>=r||0==n--){e.L[v]=e.L[T]=0;break}if(l=e.o-r,a=(e.k>=l?e.k-l:e.k-l+e.p)<<1,b=e.f+r,p=f>h?h:f,e.c[b+p]==e.c[i+p]){for(;++p!=m&&e.c[b+p]==e.c[i+p];);if(p>_&&(t[y++]=_=p,t[y++]=l-1,p==m)){e.L[T]=e.L[a],e.L[v]=e.L[a+1];break}}(255&e.c[i+p])>(255&e.c[b+p])?(e.L[T]=r,T=a+1,r=e.L[T],f=p):(e.L[v]=r,v=a,r=e.L[v],h=p)}return O(e),y}(e.b,e.m),e.D>0&&((t=e.m[e.D-2])==e.n&&(t+=w(e.b,t-1,e.m[e.D-1],273-t))),++e.s,t}function re(e){e.b&&e.W&&(e.b.cc=null,e.W=0)}function se(e){return 2048>e?qe[e]:2097152>e?qe[e>>10]+20:qe[e>>20]+40}function oe(e,t){Ae(e.db);for(var n=0;t>n;++n)Ae(e.Vb[n].G),Ae(e.Wb[n].G);Ae(e.ic.G)}function ae(e,t,n,i,r){var s,o,a,l,c;for(s=Je[e.db[0]>>>2],a=(o=Je[2048-e.db[0]>>>2])+Je[e.db[1]>>>2],l=o+Je[2048-e.db[1]>>>2],c=0,c=0;8>c;++c){if(c>=n)return;i[r+c]=s+xe(e.Vb[t],c)}for(;16>c;++c){if(c>=n)return;i[r+c]=a+xe(e.Wb[t],c-8)}for(;n>c;++c)i[r+c]=l+xe(e.ic,c-8-8)}function le(e,t,n,i){(function(e,t,n,i){8>n?(Ne(t,e.db,0,0),ke(e.Vb[i],t,n)):(n-=8,Ne(t,e.db,0,1),8>n?(Ne(t,e.db,1,0),ke(e.Wb[i],t,n)):(Ne(t,e.db,1,1),ke(e.ic,t,n-8)))})(e,t,n,i),0==--e.sc[i]&&(ae(e,i,e.rb,e.Cc,272*i),e.sc[i]=e.rb)}function ce(e){return function(e){e.db=n(2),e.Vb=n(16),e.Wb=n(16),e.ic=Te({},8);for(var t=0;16>t;++t)e.Vb[t]=Te({},3),e.Wb[t]=Te({},3)}(e),e.Cc=[],e.sc=[],e}function ue(e,t,n){return e.Cc[272*n+t]}function de(e,t){for(var n=0;t>n;++n)ae(e,n,e.rb,e.Cc,272*n),e.sc[n]=e.rb}function pe(e,t,i){var r,s;if(null==e.V||e.u!=i||e.I!=t)for(e.I=t,e.qc=(1<<t)-1,e.u=i,s=1<<e.u+e.I,e.V=n(s),r=0;s>r;++r)e.V[r]=ge({})}function he(e,t,n){return e.V[((t&e.qc)<<e.u)+((255&n)>>>8-e.u)]}function fe(e,t,n){var i,r,s=1;for(r=7;r>=0;--r)i=n>>r&1,Ne(t,e.tb,s,i),s=s<<1|i}function me(e,t,n,i){var r,s,o,a,l=1,c=1;for(s=7;s>=0;--s)r=i>>s&1,a=c,l&&(a+=1+(o=n>>s&1)<<8,l=o==r),Ne(t,e.tb,a,r),c=c<<1|r}function ge(e){return e.tb=n(768),e}function _e(e,t,n,i){var r,s,o=1,a=7,l=0;if(t)for(;a>=0;--a)if(s=n>>a&1,r=i>>a&1,l+=Le(e.tb[(1+s<<8)+o],r),o=o<<1|r,s!=r){--a;break}for(;a>=0;--a)r=i>>a&1,l+=Le(e.tb[o],r),o=o<<1|r;return l}function ye(e){e.j=-1,e.t=0}function be(e,t){return e.F=t,e.G=n(1<<t),e}function ve(e,t){var n,i=1;for(n=e.F;0!=n;--n)i=(i<<1)+Ie(t,e.G,i);return i-(1<<e.F)}function Te(e,t){return e.F=t,e.G=n(1<<t),e}function ke(e,t,n){var i,r,s=1;for(r=e.F;0!=r;)i=n>>>--r&1,Ne(t,e.G,s,i),s=s<<1|i}function xe(e,t){var n,i,r=1,s=0;for(i=e.F;0!=i;)n=t>>>--i&1,s+=Le(e.G[r],n),r=(r<<1)+n;return s}function Ee(e,t,n){var i,r,s=1;for(r=0;e.F>r;++r)i=1&n,Ne(t,e.G,s,i),s=s<<1|i,n>>=1}function Se(e,t){var n,i,r=1,s=0;for(i=e.F;0!=i;--i)n=1&t,t>>>=1,s+=Le(e.G[r],n),r=r<<1|n;return s}function Ce(e,t,n,i,r){var s,o,a=1;for(o=0;i>o;++o)Ne(n,e,t+a,s=1&r),a=a<<1|s,r>>=1}function we(e,t,n,i){var r,s,o=1,a=0;for(s=n;0!=s;--s)r=1&i,i>>>=1,a+=Je[(2047&(e[t+o]-r^-r))>>>2],o=o<<1|r;return a}function Ie(e,t,n){var i,r=t[n];return(-2147483648^(i=(e.E>>>11)*r))>(-2147483648^e.Bb)?(e.E=i,t[n]=r+(2048-r>>>5)<<16>>16,-16777216&e.E||(e.Bb=e.Bb<<8|m(e.Ab),e.E<<=8),0):(e.E-=i,e.Bb-=i,t[n]=r-(r>>>5)<<16>>16,-16777216&e.E||(e.Bb=e.Bb<<8|m(e.Ab),e.E<<=8),1)}function Ae(e){for(var t=e.length-1;t>=0;--t)e[t]=1024}function Ne(e,t,n,s){var o,a=t[n];o=(e.E>>>11)*a,s?(e.xc=i(e.xc,r(l(o),[4294967295,0])),e.E-=o,t[n]=a-(a>>>5)<<16>>16):(e.E=o,t[n]=a+(2048-a>>>5)<<16>>16),-16777216&e.E||(e.E<<=8,Re(e))}function De(e,t,n){for(var r=n-1;r>=0;--r)e.E>>>=1,1==(t>>>r&1)&&(e.xc=i(e.xc,l(e.E))),-16777216&e.E||(e.E<<=8,Re(e))}function Oe(e){return i(i(l(e.Jb),e.mc),[4,0])}function Re(e){var t,n=c(function(e,t){var n;return n=p(e,t&=63),0>e[1]&&(n=i(n,d([2,0],63-t))),n}(e.xc,32));if(0!=n||s(e.xc,[4278190080,0])<0){e.mc=i(e.mc,l(e.Jb)),t=e.Oc;do{b(e.Ab,t+n),t=255}while(0!=--e.Jb);e.Oc=c(e.xc)>>>24}++e.Jb,e.xc=d(r(e.xc,[16777215,0]),8)}function Le(e,t){return Je[(2047&(e-t^-t))>>>2]}function Pe(e){for(var t,n,i,r=0,s=0,o=e.length,a=[],l=[];o>r;++r,++s){if(128&(t=255&e[r]))if(192==(224&t)){if(r+1>=o)return e;if(128!=(192&(n=255&e[++r])))return e;l[s]=(31&t)<<6|63&n}else{if(224!=(240&t))return e;if(r+2>=o)return e;if(128!=(192&(n=255&e[++r])))return e;if(128!=(192&(i=255&e[++r])))return e;l[s]=(15&t)<<12|(63&n)<<6|63&i}else{if(!t)return e;l[s]=t}16383==s&&(a.push(String.fromCharCode.apply(String,l)),s=-1)}return s>0&&(l.length=s,a.push(String.fromCharCode.apply(String,l))),a.join("")}function Me(e){var t,n,i,r=[],s=0,o=e.length;if("object"==typeof e)return e;for(function(e,t,n,i,r){var s;for(s=t;n>s;++s)i[r++]=e.charCodeAt(s)}(e,0,o,r,0),i=0;o>i;++i)(t=r[i])>=1&&127>=t?++s:s+=!t||t>=128&&2047>=t?2:3;for(n=[],s=0,i=0;o>i;++i)(t=r[i])>=1&&127>=t?n[s++]=t<<24>>24:!t||t>=128&&2047>=t?(n[s++]=(192|t>>6&31)<<24>>24,n[s++]=(128|63&t)<<24>>24):(n[s++]=(224|t>>12&15)<<24>>24,n[s++]=(128|t>>6&63)<<24>>24,n[s++]=(128|63&t)<<24>>24);return n}function Fe(e){return e[1]+e[0]}var Be=1,$e=2,Ue=3,Ve="function"==typeof setImmediate?setImmediate:setTimeout,He=4294967296,Ge=[4294967295,-He],je=[0,-0x8000000000000000],Ke=[0,0],ze=[1,0],We=function(){var e,t,n,i=[];for(e=0;256>e;++e){for(n=e,t=0;8>t;++t)1&n?n=n>>>1^-306674912:n>>>=1;i[e]=n}return i}(),qe=function(){var e,t,n,i=2,r=[0,1];for(n=2;22>n;++n)for(t=1<<(n>>1)-1,e=0;t>e;++e,++i)r[i]=n<<24>>24;return r}(),Je=function(){var e,t,n,i=[];for(t=8;t>=0;--t)for(e=1<<9-t,n=1<<9-t-1;e>n;++n)i[n]=(t<<6)+(e-n<<6>>>9-t-1);return i}(),Ye=function(){var e=[{s:16,f:64,m:0},{s:20,f:64,m:0},{s:19,f:64,m:1},{s:20,f:64,m:1},{s:21,f:128,m:1},{s:22,f:128,m:1},{s:23,f:128,m:1},{s:24,f:255,m:1},{s:25,f:255,m:1}];return function(t){return e[t-1]||e[6]}}();return"undefined"==typeof onmessage||"undefined"!=typeof window&&void 0!==window.document||(onmessage=function(t){t&&t.gc&&(t.gc.action==$e?e.decompress(t.gc.gc,t.gc.cbn):t.gc.action==Be&&e.compress(t.gc.gc,t.gc.Rc,t.gc.cbn))}),{compress:function(e,n,i,r){var s,o,a={},l=void 0===i&&void 0===r;if("function"!=typeof i&&(o=i,i=r=0),r=r||function(e){return void 0!==o?t(e,o):void 0},i=i||function(e,t){return void 0!==o?postMessage({action:Be,cbn:o,result:e,error:t}):void 0},l){for(a.c=x({},Me(e),Ye(n));U(a.c.yb););return y(a.c.Nb)}try{a.c=x({},Me(e),Ye(n)),r(0)}catch(e){return i(null,e)}Ve(function e(){try{for(var t,n=(new Date).getTime();U(a.c.yb);)if(s=Fe(a.c.yb.Pb)/Fe(a.c.Tb),(new Date).getTime()-n>200)return r(s),Ve(e,0),0;r(1),t=y(a.c.Nb),Ve(i.bind(null,t),0)}catch(e){i(null,e)}},0)},decompress:function(e,n,i){var r,s,o,a,l={},c=void 0===n&&void 0===i;if("function"!=typeof n&&(s=n,n=i=0),i=i||function(e){return void 0!==s?t(o?e:-1,s):void 0},n=n||function(e,t){return void 0!==s?postMessage({action:$e,cbn:s,result:e,error:t}):void 0},c){for(l.d=S({},e);U(l.d.yb););return Pe(y(l.d.Nb))}try{l.d=S({},e),a=Fe(l.d.Tb),o=a>-1,i(0)}catch(e){return n(null,e)}Ve(function e(){try{for(var t,s=0,c=(new Date).getTime();U(l.d.yb);)if(++s%1e3==0&&(new Date).getTime()-c>200)return o&&(r=Fe(l.d.yb.Z.g)/a,i(r)),Ve(e,0),0;i(1),t=Pe(y(l.d.Nb)),Ve(n.bind(null,t),0)}catch(e){n(null,e)}},0)}}}(),pxt,pxt,pxt,pxt,pxt,pxt,ts;this.LZMA=this.LZMA_WORKER=e,function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).DOMPurify=t()}(this,function(){const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:i,getOwnPropertyDescriptor:r}=Object;let{freeze:s,seal:o,create:a}=Object,{apply:l,construct:c}="undefined"!=typeof Reflect&&Reflect;s||(s=function(e){return e}),o||(o=function(e){return e}),l||(l=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return e.apply(t,i)}),c||(c=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new e(...n)});const u=S(Array.prototype.forEach),d=S(Array.prototype.lastIndexOf),p=S(Array.prototype.pop),h=S(Array.prototype.push),f=S(Array.prototype.splice),m=S(String.prototype.toLowerCase),g=S(String.prototype.toString),_=S(String.prototype.match),y=S(String.prototype.replace),b=S(String.prototype.indexOf),v=S(String.prototype.trim),T=S(Object.prototype.hasOwnProperty),k=S(RegExp.prototype.test),x=(E=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c(E,t)});var E;function S(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return l(e,t,i)}}function C(e,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m;t&&t(e,null);let s=i.length;for(;s--;){let t=i[s];if("string"==typeof t){const e=r(t);e!==t&&(n(i)||(i[s]=e),t=e)}e[t]=!0}return e}function w(e){for(let t=0;t<e.length;t++)T(e,t)||(e[t]=null);return e}function I(t){const n=a(null);for(const[i,r]of e(t))T(t,i)&&(Array.isArray(r)?n[i]=w(r):r&&"object"==typeof r&&r.constructor===Object?n[i]=I(r):n[i]=r);return n}function A(e,t){for(;null!==e;){const n=r(e,t);if(n){if(n.get)return S(n.get);if("function"==typeof n.value)return S(n.value)}e=i(e)}return function(){return null}}const N=s(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),D=s(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),O=s(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),R=s(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),L=s(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),P=s(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),M=s(["#text"]),F=s(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),B=s(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$=s(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=s(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),V=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),H=o(/<%[\w\W]*|[\w\W]*%>/gm),G=o(/\$\{[\w\W]*/gm),j=o(/^data-[\-\w.\u00B7-\uFFFF]+$/),K=o(/^aria-[\-\w]+$/),z=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=o(/^(?:\w+script|data):/i),q=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),J=o(/^html$/i),Y=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var X=Object.freeze({__proto__:null,ARIA_ATTR:K,ATTR_WHITESPACE:q,CUSTOM_ELEMENT:Y,DATA_ATTR:j,DOCTYPE_NAME:J,ERB_EXPR:H,IS_ALLOWED_URI:z,IS_SCRIPT_OR_DATA:W,MUSTACHE_EXPR:V,TMPLIT_EXPR:G});var Z=function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window;const i=e=>t(e);if(i.version="3.3.0",i.removed=[],!n||!n.document||9!==n.document.nodeType||!n.Element)return i.isSupported=!1,i;let{document:r}=n;const o=r,l=o.currentScript,{DocumentFragment:c,HTMLTemplateElement:E,Node:S,Element:w,NodeFilter:V,NamedNodeMap:H=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:G,DOMParser:j,trustedTypes:K}=n,W=w.prototype,q=A(W,"cloneNode"),Y=A(W,"remove"),Z=A(W,"nextSibling"),Q=A(W,"childNodes"),ee=A(W,"parentNode");if("function"==typeof E){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let te,ne="";const{implementation:ie,createNodeIterator:re,createDocumentFragment:se,getElementsByTagName:oe}=r,{importNode:ae}=o;let le={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};i.isSupported="function"==typeof e&&"function"==typeof ee&&ie&&void 0!==ie.createHTMLDocument;const{MUSTACHE_EXPR:ce,ERB_EXPR:ue,TMPLIT_EXPR:de,DATA_ATTR:pe,ARIA_ATTR:he,IS_SCRIPT_OR_DATA:fe,ATTR_WHITESPACE:me,CUSTOM_ELEMENT:ge}=X;let{IS_ALLOWED_URI:_e}=X,ye=null;const be=C({},[...N,...D,...O,...L,...M]);let ve=null;const Te=C({},[...F,...B,...$,...U]);let ke=Object.seal(a(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),xe=null,Ee=null;const Se=Object.seal(a(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ce=!0,we=!0,Ie=!1,Ae=!0,Ne=!1,De=!0,Oe=!1,Re=!1,Le=!1,Pe=!1,Me=!1,Fe=!1,Be=!0,$e=!1,Ue=!0,Ve=!1,He={},Ge=null;const je=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ke=null;const ze=C({},["audio","video","img","source","image","track"]);let We=null;const qe=C({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Je="http://www.w3.org/1998/Math/MathML",Ye="http://www.w3.org/2000/svg",Xe="http://www.w3.org/1999/xhtml";let Ze=Xe,Qe=!1,et=null;const tt=C({},[Je,Ye,Xe],g);let nt=C({},["mi","mo","mn","ms","mtext"]),it=C({},["annotation-xml"]);const rt=C({},["title","style","font","a","script"]);let st=null;const ot=["application/xhtml+xml","text/html"];let at=null,lt=null;const ct=r.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},dt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!lt||lt!==e){if(e&&"object"==typeof e||(e={}),e=I(e),st=-1===ot.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,at="application/xhtml+xml"===st?g:m,ye=T(e,"ALLOWED_TAGS")?C({},e.ALLOWED_TAGS,at):be,ve=T(e,"ALLOWED_ATTR")?C({},e.ALLOWED_ATTR,at):Te,et=T(e,"ALLOWED_NAMESPACES")?C({},e.ALLOWED_NAMESPACES,g):tt,We=T(e,"ADD_URI_SAFE_ATTR")?C(I(qe),e.ADD_URI_SAFE_ATTR,at):qe,Ke=T(e,"ADD_DATA_URI_TAGS")?C(I(ze),e.ADD_DATA_URI_TAGS,at):ze,Ge=T(e,"FORBID_CONTENTS")?C({},e.FORBID_CONTENTS,at):je,xe=T(e,"FORBID_TAGS")?C({},e.FORBID_TAGS,at):I({}),Ee=T(e,"FORBID_ATTR")?C({},e.FORBID_ATTR,at):I({}),He=!!T(e,"USE_PROFILES")&&e.USE_PROFILES,Ce=!1!==e.ALLOW_ARIA_ATTR,we=!1!==e.ALLOW_DATA_ATTR,Ie=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ae=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ne=e.SAFE_FOR_TEMPLATES||!1,De=!1!==e.SAFE_FOR_XML,Oe=e.WHOLE_DOCUMENT||!1,Pe=e.RETURN_DOM||!1,Me=e.RETURN_DOM_FRAGMENT||!1,Fe=e.RETURN_TRUSTED_TYPE||!1,Le=e.FORCE_BODY||!1,Be=!1!==e.SANITIZE_DOM,$e=e.SANITIZE_NAMED_PROPS||!1,Ue=!1!==e.KEEP_CONTENT,Ve=e.IN_PLACE||!1,_e=e.ALLOWED_URI_REGEXP||z,Ze=e.NAMESPACE||Xe,nt=e.MATHML_TEXT_INTEGRATION_POINTS||nt,it=e.HTML_INTEGRATION_POINTS||it,ke=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ke.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ke.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ke.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ne&&(we=!1),Me&&(Pe=!0),He&&(ye=C({},M),ve=[],!0===He.html&&(C(ye,N),C(ve,F)),!0===He.svg&&(C(ye,D),C(ve,B),C(ve,U)),!0===He.svgFilters&&(C(ye,O),C(ve,B),C(ve,U)),!0===He.mathMl&&(C(ye,L),C(ve,$),C(ve,U))),e.ADD_TAGS&&("function"==typeof e.ADD_TAGS?Se.tagCheck=e.ADD_TAGS:(ye===be&&(ye=I(ye)),C(ye,e.ADD_TAGS,at))),e.ADD_ATTR&&("function"==typeof e.ADD_ATTR?Se.attributeCheck=e.ADD_ATTR:(ve===Te&&(ve=I(ve)),C(ve,e.ADD_ATTR,at))),e.ADD_URI_SAFE_ATTR&&C(We,e.ADD_URI_SAFE_ATTR,at),e.FORBID_CONTENTS&&(Ge===je&&(Ge=I(Ge)),C(Ge,e.FORBID_CONTENTS,at)),Ue&&(ye["#text"]=!0),Oe&&C(ye,["html","head","body"]),ye.table&&(C(ye,["tbody"]),delete xe.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw x('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw x('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');te=e.TRUSTED_TYPES_POLICY,ne=te.createHTML("")}else void 0===te&&(te=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}}(K,l)),null!==te&&"string"==typeof ne&&(ne=te.createHTML(""));s&&s(e),lt=e}},pt=C({},[...D,...O,...R]),ht=C({},[...L,...P]),ft=function(e){h(i.removed,{element:e});try{ee(e).removeChild(e)}catch(t){Y(e)}},mt=function(e,t){try{h(i.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){h(i.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Pe||Me)try{ft(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},gt=function(e){let t=null,n=null;if(Le)e="<remove></remove>"+e;else{const t=_(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===st&&Ze===Xe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=te?te.createHTML(e):e;if(Ze===Xe)try{t=(new j).parseFromString(i,st)}catch(e){}if(!t||!t.documentElement){t=ie.createDocument(Ze,"template",null);try{t.documentElement.innerHTML=Qe?ne:i}catch(e){}}const s=t.body||t.documentElement;return e&&n&&s.insertBefore(r.createTextNode(n),s.childNodes[0]||null),Ze===Xe?oe.call(t,Oe?"html":"body")[0]:Oe?t.documentElement:s},_t=function(e){return re.call(e.ownerDocument||e,e,V.SHOW_ELEMENT|V.SHOW_COMMENT|V.SHOW_TEXT|V.SHOW_PROCESSING_INSTRUCTION|V.SHOW_CDATA_SECTION,null)},yt=function(e){return e instanceof G&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof H)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},bt=function(e){return"function"==typeof S&&e instanceof S};function vt(e,t,n){u(e,e=>{e.call(i,t,n,lt)})}const Tt=function(e){let t=null;if(vt(le.beforeSanitizeElements,e,null),yt(e))return ft(e),!0;const n=at(e.nodeName);if(vt(le.uponSanitizeElement,e,{tagName:n,allowedTags:ye}),De&&e.hasChildNodes()&&!bt(e.firstElementChild)&&k(/<[/\w!]/g,e.innerHTML)&&k(/<[/\w!]/g,e.textContent))return ft(e),!0;if(7===e.nodeType)return ft(e),!0;if(De&&8===e.nodeType&&k(/<[/\w]/g,e.data))return ft(e),!0;if(!(Se.tagCheck instanceof Function&&Se.tagCheck(n))&&(!ye[n]||xe[n])){if(!xe[n]&&xt(n)){if(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,n))return!1;if(ke.tagNameCheck instanceof Function&&ke.tagNameCheck(n))return!1}if(Ue&&!Ge[n]){const t=ee(e)||e.parentNode,n=Q(e)||e.childNodes;if(n&&t)for(let i=n.length-1;i>=0;--i){const r=q(n[i],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,Z(e))}}return ft(e),!0}return e instanceof w&&!function(e){let t=ee(e);t&&t.tagName||(t={namespaceURI:Ze,tagName:"template"});const n=m(e.tagName),i=m(t.tagName);return!!et[e.namespaceURI]&&(e.namespaceURI===Ye?t.namespaceURI===Xe?"svg"===n:t.namespaceURI===Je?"svg"===n&&("annotation-xml"===i||nt[i]):Boolean(pt[n]):e.namespaceURI===Je?t.namespaceURI===Xe?"math"===n:t.namespaceURI===Ye?"math"===n&&it[i]:Boolean(ht[n]):e.namespaceURI===Xe?!(t.namespaceURI===Ye&&!it[i])&&!(t.namespaceURI===Je&&!nt[i])&&!ht[n]&&(rt[n]||!pt[n]):!("application/xhtml+xml"!==st||!et[e.namespaceURI]))}(e)?(ft(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!k(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ne&&3===e.nodeType&&(t=e.textContent,u([ce,ue,de],e=>{t=y(t,e," ")}),e.textContent!==t&&(h(i.removed,{element:e.cloneNode()}),e.textContent=t)),vt(le.afterSanitizeElements,e,null),!1):(ft(e),!0)},kt=function(e,t,n){if(Be&&("id"===t||"name"===t)&&(n in r||n in ct))return!1;if(we&&!Ee[t]&&k(pe,t));else if(Ce&&k(he,t));else if(Se.attributeCheck instanceof Function&&Se.attributeCheck(t,e));else if(!ve[t]||Ee[t]){if(!(xt(e)&&(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,e)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(e))&&(ke.attributeNameCheck instanceof RegExp&&k(ke.attributeNameCheck,t)||ke.attributeNameCheck instanceof Function&&ke.attributeNameCheck(t,e))||"is"===t&&ke.allowCustomizedBuiltInElements&&(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,n)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(n))))return!1}else if(We[t]);else if(k(_e,y(n,me,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==b(n,"data:")||!Ke[e])if(Ie&&!k(fe,y(n,me,"")));else if(n)return!1;return!0},xt=function(e){return"annotation-xml"!==e&&_(e,ge)},Et=function(e){vt(le.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||yt(e))return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ve,forceKeepAttr:void 0};let r=t.length;for(;r--;){const s=t[r],{name:o,namespaceURI:a,value:l}=s,c=at(o),d=l;let h="value"===o?d:v(d);if(n.attrName=c,n.attrValue=h,n.keepAttr=!0,n.forceKeepAttr=void 0,vt(le.uponSanitizeAttribute,e,n),h=n.attrValue,!$e||"id"!==c&&"name"!==c||(mt(o,e),h="user-content-"+h),De&&k(/((--!?|])>)|<\/(style|title|textarea)/i,h)){mt(o,e);continue}if("attributename"===c&&_(h,"href")){mt(o,e);continue}if(n.forceKeepAttr)continue;if(!n.keepAttr){mt(o,e);continue}if(!Ae&&k(/\/>/i,h)){mt(o,e);continue}Ne&&u([ce,ue,de],e=>{h=y(h,e," ")});const f=at(e.nodeName);if(kt(f,c,h)){if(te&&"object"==typeof K&&"function"==typeof K.getAttributeType)if(a);else switch(K.getAttributeType(f,c)){case"TrustedHTML":h=te.createHTML(h);break;case"TrustedScriptURL":h=te.createScriptURL(h)}if(h!==d)try{a?e.setAttributeNS(a,o,h):e.setAttribute(o,h),yt(e)?ft(e):p(i.removed)}catch(t){mt(o,e)}}else mt(o,e)}vt(le.afterSanitizeAttributes,e,null)},St=function e(t){let n=null;const i=_t(t);for(vt(le.beforeSanitizeShadowDOM,t,null);n=i.nextNode();)vt(le.uponSanitizeShadowNode,n,null),Tt(n),Et(n),n.content instanceof c&&e(n.content);vt(le.afterSanitizeShadowDOM,t,null)};return i.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=null,s=null,a=null;if(Qe=!e,Qe&&(e="\x3c!--\x3e"),"string"!=typeof e&&!bt(e)){if("function"!=typeof e.toString)throw x("toString is not a function");if("string"!=typeof(e=e.toString()))throw x("dirty is not a string, aborting")}if(!i.isSupported)return e;if(Re||dt(t),i.removed=[],"string"==typeof e&&(Ve=!1),Ve){if(e.nodeName){const t=at(e.nodeName);if(!ye[t]||xe[t])throw x("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof S)n=gt("\x3c!----\x3e"),r=n.ownerDocument.importNode(e,!0),1===r.nodeType&&"BODY"===r.nodeName||"HTML"===r.nodeName?n=r:n.appendChild(r);else{if(!Pe&&!Ne&&!Oe&&-1===e.indexOf("<"))return te&&Fe?te.createHTML(e):e;if(n=gt(e),!n)return Pe?null:Fe?ne:""}n&&Le&&ft(n.firstChild);const l=_t(Ve?e:n);for(;s=l.nextNode();)Tt(s),Et(s),s.content instanceof c&&St(s.content);if(Ve)return e;if(Pe){if(Me)for(a=se.call(n.ownerDocument);n.firstChild;)a.appendChild(n.firstChild);else a=n;return(ve.shadowroot||ve.shadowrootmode)&&(a=ae.call(o,a,!0)),a}let d=Oe?n.outerHTML:n.innerHTML;return Oe&&ye["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&k(J,n.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+d),Ne&&u([ce,ue,de],e=>{d=y(d,e," ")}),te&&Fe?te.createHTML(d):d},i.setConfig=function(){dt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Re=!0},i.clearConfig=function(){lt=null,Re=!1},i.isValidAttribute=function(e,t,n){lt||dt({});const i=at(e),r=at(t);return kt(i,r,n)},i.addHook=function(e,t){"function"==typeof t&&h(le[e],t)},i.removeHook=function(e,t){if(void 0!==t){const n=d(le[e],t);return-1===n?void 0:f(le[e],n,1)[0]}return p(le[e])},i.removeHooks=function(e){le[e]=[]},i.removeAllHooks=function(){le={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},i}();return Z}),pxt||(pxt={}),function(e){!function(t){const n={},i={};let r,s=!1;function o(e){Object.keys(e).forEach(t=>{"string"==typeof e[t]?n[t]=e[t]:i[t]=e[t]})}!function(e){e[e.Off=0]="Off",e[e.Short=1]="Short",e[e.Verbose=2]="Verbose"}(r=t.ConsoleTickOptions||(t.ConsoleTickOptions={})),t.consoleTicks=r.Off,t.addDefaultProperties=o,t.enable=function(a){if(!e.aiTrackException||!e.aiTrackEvent||s)return;s=!0,"string"==typeof a&&0!=a.length||(a="en"),o({lang:a}),e.debug("setting up app insights");const l=e.tickEvent;e.tickEvent=function(s,o,a){if(o=e.Util.cleanData(o),t.consoleTicks!=r.Off){const n=t.consoleTicks==r.Short?"":`${(new Date).toLocaleTimeString(void 0,{hour12:!1})} - Tick - `,i=`${s} ${o?JSON.stringify(o):"<no data>"} ${a?JSON.stringify(a):"<no opts>"}`;e.log(n+i)}if(l&&l(s,o,a),(null==a?void 0:a.interactiveConsent)&&e.setInteractiveConsent(!0),o){const t=Object.assign({},n),r=Object.assign({},i);Object.keys(o).forEach(e=>{"string"==typeof o[e]?t[e]=o[e]:"number"==typeof o[e]?r[e]=o[e]:t[e]=JSON.stringify(o[e]||"")}),e.aiTrackEvent(s,t,r)}else e.aiTrackEvent(s)};const c=e.reportException;e.reportException=function(t,n){n=e.Util.cleanData(n),c&&c(t,n);const i={target:e.appTarget.id,version:e.appTarget.versions.target};n&&e.Util.jsonMergeFrom(i,n),e.aiTrackException(t,"exception",i)};const u=e.reportError;e.reportError=function(t,n,i){i=e.Util.cleanData(i),u&&u(t,n,i);try{throw n}catch(r){const s={target:e.appTarget.id,version:e.appTarget.versions.target,category:t,message:n};i&&e.Util.jsonMergeFrom(s,i),e.aiTrackException(r,"error",s)}}},t.trackPerformanceReport=function(){if(e.perf.perfReportLogged)return;const t=e.perf.report();if(t){const{durations:n,milestones:i}=t;e.tickEvent("performance.milestones",i),e.tickEvent("performance.durations",n)}}}(e.analytics||(e.analytics={}))}(pxt||(pxt={})),pxt||(pxt={}),function(e){!function(e){let t,n,i,r=0,s=!1;function o(){return t||(t=function(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(e){}return}()),t}function a(){t&&(i.gain.setTargetAtTime(0,t.currentTime,.015),r=0)}e.mute=function(e){t&&(s=e,a(),e&&n&&(n.disconnect(),i.disconnect(),n=void 0,i=void 0))},e.stop=a,e.frequency=function(){return r},e.tone=function(e){if(s)return;if(isNaN(e)||e<0)return;r=e;let a=o();if(a)try{n||(n=a.createOscillator(),n.type="triangle",i=a.createGain(),i.gain.value=0,i.connect(a.destination),n.connect(i),n.start(0)),n.frequency.linearRampToValueAtTime(e,t.currentTime),i.gain.setTargetAtTime(.2,t.currentTime,.015)}catch(e){return void(n=void 0)}}}(e.AudioContextManager||(e.AudioContextManager={}))}(pxt||(pxt={})),function(e){!function(t){const n="auth",i="csrf-token",r="login-state",s="user-state",o="interactive-login-until";let a,l=!1;t.DEFAULT_USER_PREFERENCES=()=>({language:e.appTarget.appTheme.defaultLocale,highContrast:!1,accessibleBlocks:!1,colorThemeIds:{},reader:"",skillmap:{mapProgress:{},completedTags:{}},email:!1}),t.client=function(){if(!l)return a};let c=0,u=0;async function d(t,i){return i?await e.storage.shared.setAsync(n,t,i):await e.storage.shared.delAsync(n,t)}async function p(t){try{return await e.storage.shared.getAsync(n,t)}catch(e){return}}async function h(){const e=await p(i);return t.cachedHasAuthToken=!!e,e}async function f(e){return t.cachedHasAuthToken=!!e,await d(i,e)}async function m(){return!!await h()}async function g(){return t.cachedHasAuthToken=!1,await d(i,void 0)}async function _(){let i;try{i=await e.storage.shared.getAsync(n,s)}catch(e){i={}}return t.cachedUserState=i,i}async function y(i){return t.cachedUserState=Object.assign({},i),await e.storage.shared.setAsync(n,s,i)}async function b(){return t.cachedUserState=void 0,await e.storage.shared.delAsync(n,s)}async function v(t){var n;const i={};return(t=t||await h())&&(i.authorization=`mkcd ${t}`),i["x-pxt-target"]=null===(n=e.appTarget)||void 0===n?void 0:n.id,i}t.cachedHasAuthToken=!1,t.getAuthTokenAsync=h,t.hasAuthTokenAsync=m,t.getUserStateAsync=_,t.getAuthHeadersAsync=v;class T{constructor(){this.initialUserPreferences_=void 0,this.initialAuthCheck_=void 0,this.patchQueue=[],a=this}async initAsync(){const e=await _();this.setUserProfileAsync(null==e?void 0:e.profile),this.setUserPreferencesAsync(null==e?void 0:e.preferences)}async loginAsync(t,i,s=void 0){if(!E()||!function(e){return x().filter(t=>t.id===e).length>0}(t))return;s=null!=s?s:k,this.clearAuthStateAsync();const a={key:(Math.PI*Math.random()).toString(36).slice(2),callbackState:s,callbackPathname:window.location.pathname,idp:t,persistent:i},l=(parseInt(await p(o))||0)>Date.now(),c=e.Util.stringifyQueryString("/api/auth/login",{response_type:"token",provider:t,persistent:i,redirect_uri:`${window.location.origin}${window.location.pathname}?authcallback=1&state=${a.key}`,prompt:l?"select_account":"silent"}),u=await this.apiAsync(c);if(u.success)a.authCodeVerifier=u.resp.authCodeVerifier,await e.storage.shared.setAsync(n,r,a),e.tickEvent("auth.login.start",{provider:t}),window.location.href=u.resp.loginUrl;else try{await this.onSignInFailed()}catch(e){}}async logoutAsync(e){if(E()){await T.staticLogoutAsync(e);try{await this.onStateCleared()}catch(e){}try{await this.onSignedOut()}catch(e){}}}static async staticLogoutAsync(t){if(!E())return;e.tickEvent("auth.logout"),await d(o,(Date.now()+6e4).toString()),t=t?t.startsWith("#")?t:`#${t}`:"";const n=`${window.location.origin}${window.location.pathname}${window.location.search}${t}`;let i="";try{const t=e.Util.stringifyQueryString("/api/auth/logout",{redirect_uri:n,authcallback:"1"}),r=await T.staticApiAsync(t);r.success&&(i=r.resp.logoutUrl)}catch(e){}await g(),await b(),e.BrowserUtils.hasWindow()&&(i?window.location.href=i:(window.location.href=n,location.reload()))}async deleteProfileAsync(){var t;if(!await this.loggedInAsync())return;const n=await _(),i=null===(t=null==n?void 0:n.profile)||void 0===t?void 0:t.id,r=await this.apiAsync("/api/user",null,"DELETE");if(r.err)try{await this.onApiError(r.err)}catch(e){}else try{await this.clearAuthStateAsync();try{await this.onProfileDeleted(i)}catch(e){}}finally{e.tickEvent("auth.profile.deleted")}}async initialUserPreferencesAsync(){if(await this.loggedInAsync())return this.initialUserPreferences_||(this.initialUserPreferences_=this.fetchUserPreferencesAsync()),this.initialUserPreferences_}async userProfileAsync(){if(!await this.loggedInAsync())return;const e=await _();return Object.assign({},e.profile)}async userPreferencesAsync(){const e=await _();return Object.assign({},e.preferences)}async authCheckAsync(){var e;if(!E())return;if(!await m())return;const t=await _();return(null===(e=null==t?void 0:t.profile)||void 0===e?void 0:e.id)?this.initialAuthCheck_||(this.initialAuthCheck_=Promise.resolve(t.profile)):this.initialAuthCheck_||(this.initialAuthCheck_=this.fetchUserAsync()),this.initialAuthCheck_}async loggedInAsync(){return!!await this.authCheckAsync()&&await this.hasUserIdAsync()}async updateUserProfileAsync(e){if(!await this.loggedInAsync())return!1;const t=await _(),n=await this.apiAsync("/api/user/profile",{id:t.profile.id,username:e.username,avatarUrl:e.avatarUrl});return n.success&&await this.setUserProfileAsync(n.resp),n.success}async patchUserPreferencesAsync(n,i={}){const r=async()=>({success:!0,res:await this.userPreferencesAsync()});if(!(n=(n=Array.isArray(n)?n:[n]).filter(e=>!!e)).length)return await r();const s=(t,n,i)=>{const r=e.U.deepCopy(t);ts.pxtc.jsonPatch.patchInPlace(r,n);let s=ts.pxtc.jsonPatch.diff(t,r);return s.length&&i&&(s=s.filter(i)),s},o=await this.userPreferencesAsync(),a=s(o,n,i.filter);if(!a.length)return await r();if(ts.pxtc.jsonPatch.patchInPlace(o,a),await this.setUserPreferencesAsync(o),!await this.loggedInAsync())return await r();this.patchQueue.push({ops:n,filter:i.filter}),clearTimeout(c);const l=async()=>{if(u=0,!this.patchQueue.length)return await r();const n=await this.apiAsync("/api/user/preferences");if(!n.success)return e.reportError("identity","failed to fetch preferences for patch",n),{success:!1,res:void 0};const i=e.U.deepCopy(n.resp)||t.DEFAULT_USER_PREFERENCES(),o=this.patchQueue;this.patchQueue=[],o.forEach(e=>{const t=s(i,e.ops,e.filter);ts.pxtc.jsonPatch.patchInPlace(i,t)});const a=pxtc.jsonPatch.diff(n.resp,i),l=await this.apiAsync("/api/user/preferences",a,"PATCH");return l.success?this.setUserPreferencesAsync(l.resp):e.reportError("identity","failed to patch preferences",l),{success:l.success,res:l.resp}};return i.immediate?await l():(u||(u=e.U.now()),1e4<e.U.now()-u?await l():(c=setTimeout(l,1e3),{success:!1,res:void 0}))}async hasUserIdAsync(){var e;if(!E())return!1;if(!await m())return;const t=await _();return!!(null===(e=null==t?void 0:t.profile)||void 0===e?void 0:e.id)}async fetchUserAsync(){var e;if(!E())return;if(!await m())return;const t=await _();if(null===(e=null==t?void 0:t.profile)||void 0===e?void 0:e.id)return t.profile;const n=await this.apiAsync("/api/user/profile");if(n.success){const e=n.resp;return await this.setUserProfileAsync(e),e}}async setUserProfileAsync(e){const t=await this.hasUserIdAsync();await this.transformUserProfileAsync(e);const n=await this.hasUserIdAsync();try{await this.onUserProfileChanged()}catch(e){}if(n&&!t)try{await this.onSignedIn()}catch(e){}else if(!n&&t)try{await this.onSignedOut()}catch(e){}}async setUserPreferencesAsync(e){var n;const i=await _(),r=null!==(n=null==i?void 0:i.preferences)&&void 0!==n?n:t.DEFAULT_USER_PREFERENCES(),s=ts.pxtc.jsonPatch.diff(r,e),o=await this.transformUserPreferencesAsync(Object.assign(Object.assign({},r),e));try{await this.onUserPreferencesChanged(s)}catch(e){}return o}async fetchUserPreferencesAsync(){if(!await this.loggedInAsync())return;await _();const e=await this.apiAsync("/api/user/preferences");if(e.success&&e.resp){return this.setUserPreferencesAsync(e.resp)}}async transformUserProfileAsync(e){let t=await _();return t=Object.assign(Object.assign({},t),{profile:Object.assign({},e)}),await y(t),t.profile}async transformUserPreferencesAsync(e){let t=await _();return t=Object.assign(Object.assign({},t),{preferences:Object.assign({},e)}),await y(t),t.preferences}async clearAuthStateAsync(){await g(),await b();try{await this.onStateCleared()}catch(e){}}async apiAsync(e,t,n,i){return await T.staticApiAsync(e,t,n,i)}static async staticApiAsync(t,n,i,r){const s=await v(r);return t=e.BrowserUtils.isLocalHostDev()?`${e.cloud.DEV_BACKEND}${t}`:t,e.Util.requestAsync({url:t,headers:s,data:n,method:i||(n?"POST":"GET"),withCredentials:!0}).then(e=>({statusCode:e.statusCode,resp:e.json,success:2===Math.floor(e.statusCode/100),err:null})).catch(async e=>(/logout/.test(t)||401!=e.statusCode||await T.staticLogoutAsync(),{statusCode:e.statusCode,err:e,resp:null,success:!1}))}}t.AuthClient=T;const k={hash:"",params:{}};function x(){var t,n;return Object.keys((null===(n=null===(t=e.appTarget)||void 0===t?void 0:t.cloud)||void 0===n?void 0:n.cloudProviders)||{}).map(t=>e.appTarget.cloud.cloudProviders[t]).filter(e=>e.identity).sort((e,t)=>e.order-t.order)}function E(){return!l&&!e.BrowserUtils.isPxtElectron()&&x().length>0}function S(e,t){return e.id===t.id&&e.sourceURL===t.sourceURL}t.loginCallbackAsync=async function(t){let i,s=Object.assign({},k);do{if(i=await e.storage.shared.getAsync(n,r),!i)return void e.debug("Auth state not found in storge.");await e.storage.shared.delAsync(n,r);const a=t.state;if(!a||i.key!==a)return void e.debug("Failed to get auth state for key");s=Object.assign(Object.assign({},k),i.callbackState);const l=t.error;if(l){const n=t.error_description;e.tickEvent("auth.login.error",{error:l,provider:i.idp}),e.log(`Auth failed: ${l}:${n}`),s=Object.assign({},k);break}const c=t.token;if(!c){e.debug("Missing authToken in auth callback.");break}if(i.authCodeVerifier){const t=e.Util.stringifyQueryString("/api/otac/check",{persistent:i.persistent});await T.staticApiAsync(t,null,null,i.authCodeVerifier)}await f(c),await d(o,void 0),e.tickEvent("auth.login.success",{provider:i.idp})}while(0);const a=s.hash.startsWith("#")?s.hash:`#${s.hash}`,l=e.Util.stringifyQueryString("",s.params),c=`${i.callbackPathname.startsWith("/")?i.callbackPathname:`/${i.callbackPathname}`}${l}${a}`;window.location.href=c},t.identityProviders=x,t.identityProvider=function(e){return x().filter(t=>t.id===e).shift()},t.hasIdentity=E,t.enableAuth=function(e=!0){l=!e},t.userName=function(e){var t,n,i,r;return null!==(r=null!==(n=null===(t=null==e?void 0:e.idp)||void 0===t?void 0:t.displayName)&&void 0!==n?n:null===(i=null==e?void 0:e.idp)||void 0===i?void 0:i.username)&&void 0!==r?r:"??"},t.identityProviderId=function(e){var t;return null===(t=null==e?void 0:e.idp)||void 0===t?void 0:t.provider},t.firstName=function(t){const n=e.auth.userName(t);return(null==n?void 0:n.split(" ").shift())||n},t.userInitials=function(t){const n=e.auth.userName(t);return ts.pxtc.Util.initials(n)},t.generateUserProfilePicDataUrl=function(t){var n,i;if(null===(i=null===(n=null==t?void 0:t.idp)||void 0===n?void 0:n.picture)||void 0===i?void 0:i.encoded){const n=window.URL||window.webkitURL;try{const i=e.Util.stringToUint8Array(atob(t.idp.picture.encoded)),r=new Blob([i],{type:t.idp.picture.mimeType});t.idp.picture.dataUrl=n.createObjectURL(r)}catch(e){}}},t.badgeEquals=S,t.hasBadge=function(e,t){return e.badges.some(e=>S(e,t))}}(e.auth||(e.auth={}))}(pxt||(pxt={})),function(e){e.tickEvent=function(e){}}(pxt||(pxt={})),function(e){let t;!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Log=1]="Log",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t=e.LogLevel||(e.LogLevel={}));class n{constructor(){this.setLogLevel(t.Info)}setLogLevel(e){this.logLevel=e}getLogLevel(){return this.logLevel}info(...e){this.shouldLog(t.Info)&&(null===console||void 0===console?void 0:console.info)&&console.info.call(null,...e)}log(...e){this.shouldLog(t.Log)&&(null===console||void 0===console?void 0:console.log)&&console.log.call(null,...e)}debug(...e){this.shouldLog(t.Debug)&&(null===console||void 0===console?void 0:console.debug)&&console.debug.call(null,...e)}error(...e){this.shouldLog(t.Error)&&(null===console||void 0===console?void 0:console.error)&&console.error.call(null,...e)}warn(...e){this.shouldLog(t.Warning)&&(null===console||void 0===console?void 0:console.warn)&&console.warn.call(null,...e)}shouldLog(e){return e>=this.logLevel}}e.ConsoleLogger=n;let i=new n;e.info=function(...e){i.info(...e)},e.log=function(...e){i.log(...e)},e.debug=function(...e){i.debug(...e)},e.error=function(...e){i.error(...e)},e.warn=function(...e){i.warn(...e)},e.setLogger=function(e){const t=null==i?void 0:i.getLogLevel();i=e,void 0!==t&&i.setLogLevel(t)},e.setLogLevel=function(e){i.setLogLevel(e)}}(pxt||(pxt={})),function(e){!function(e){e.__dummy=42}(e.pxtc||(e.pxtc={}))}(ts||(ts={}));var pxtc=ts.pxtc;!function(e){!function(e){!function(e){function t(e){return e.replace(/[^\w .!?\-$]/g,e=>{let t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substr(0,4-t.length)+t})}e.assert=function(e,t="Assertion failed"){if(!e)throw new Error(t)},e.flatClone=function(e){if(null==e)return null;let t={};return Object.keys(e).forEach(n=>{t[n]=e[n]}),t},e.clone=function(e){return null==e?null:JSON.parse(JSON.stringify(e))},e.htmlEscape=function(e){return e?e.replace(/([^\w .!?\-$])/gu,e=>"&#"+e.codePointAt(0)+";"):e},e.htmlUnescape=function(e){return e?e.replace(/(&#\d+;)/g,e=>String.fromCodePoint(Number(e.substr(2,e.length-3)))):e},e.jsStringQuote=t,e.jsStringLiteral=function(e){return'"'+t(e)+'"'},e.initials=function(e){if(/^\w+@/.test(e)){return e.match(/^\w\w/).shift().toUpperCase()}{const t=e.match(/\b\w/g)||[];return((t.shift()||"")+(t.pop()||"")).toUpperCase()}};let n="en",i={},r={},s=!1;function o(){return n}function a(e){const t=/^(\w{2,3})-(\w{2,4}$)/i.exec(e);return t&&t[1]&&t[2]?[`${t[1].toLowerCase()}-${t[2].toUpperCase()}`,t[1].toLowerCase(),`${t[1].toLowerCase()}-${t[2].toLowerCase()}`]:[(e||"en").toLowerCase()]}function l(t,n){return 0==n.length?t:t.replace(/\{([0-9]+)(\:[^\}]+)?\}/g,function(t,i,r){let s=n[parseInt(i)],o="",a=/^:f(\d*)\.(\d+)/.exec(r);if(a){let e=parseInt(a[2]),t=parseInt(a[1])||0,n=/^0/.test(a[1])?"0":" ",i=s.toFixed(e);if(t>0&&e>0&&(t+=e+1),t>0)for(;i.length<t;)i=n+i;o=i}else o=":x"==r?"0x"+s.toString(16):void 0===s?"(undef)":null===s?"(null)":s.toString?s.toString():s+"";return":a"==r?/^\s*[euioah]/.test(o.toLowerCase())?o="an "+o:/^\s*[bcdfgjklmnpqrstvwxz]/.test(o.toLowerCase())&&(o="a "+o):":s"==r?o=1==s?"":"s":":q"==r?o=e.htmlEscape(o):":jq"==r?o=e.jsStringQuote(o):":uri"==r?o=encodeURIComponent(o).replace(/'/g,"%27").replace(/"/g,"%22"):":url"==r?o=encodeURI(o).replace(/'/g,"%27").replace(/"/g,"%22"):":%"==r&&(o=(100*s).toFixed(1).toString()+"%"),o})}e.enableLiveLocalizationUpdates=function(){s=!0},e.liveLocalizationEnabled=function(){return s},e.localeInfo=function(){return`${s?"live-":""}${o()}`},e.userLanguage=o,e.normalizeLanguageCode=a,e.setUserLanguage=function(e){n=a(e)[0]},e.isUserLanguageRtl=function(){return/^ar|dv|fa|ha|he|ks|ku|ps|ur|yi/i.test(n)},e.TRANSLATION_LOCALE="pxt",e.isTranslationMode=function(){return o()==e.TRANSLATION_LOCALE},e._localize=function(e){return i[e]||e},e.getLocalizedStrings=function(){return i},e.setLocalizedStrings=function(e){i=e},e.translationsCache=function(){return r},e.fmt_va=l,e.fmt=function(e,...t){return l(e,t)};const c={};e.dumpLocStats=function(){const e={};Object.keys(c).sort((e,t)=>c[t]-c[e]).forEach(t=>e[t]=t),pxt.log("prioritized list of strings:"),pxt.log(JSON.stringify(e,null,2))};function u(t,n){if(!t)return t;c[t]=(c[t]||0)+1;let i=e._localize(t);return i=i.replace(/^\{(id|loc):[^\}]+\}/g,""),l(i,n)}e.lf_va=u,e.lf=function(e,...t){return u(e,t)},e.rlf=function(e,...t){return u(e,t)},e.lookup=function(e,t){return e.hasOwnProperty(t)?e[t]:null},e.isoTime=function(t){let n=new Date(1e3*t);return e.fmt("{0}-{1:f02.0}-{2:f02.0} {3:f02.0}:{4:f02.0}:{5:f02.0}",n.getFullYear(),n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())},e.userError=function(e){let t=new Error(e);throw t.isUserError=!0,t},e.deq=function e(t,n){if(t===n)return null;if(!t||!n)return"Null value";if("object"==typeof t&&"object"==typeof n){if(Array.isArray(t)){if(!Array.isArray(n))return"Expected array";if(t.length!=n.length)return"Expected array of length "+t.length+", got "+n.length;for(let i=0;i<t.length;i++)if(null!=e(t[i],n[i]))return"Expected array value "+t[i]+" got "+n[i];return null}let i=Object.keys(t),r=Object.keys(t);if(i.length!=r.length)return"Expected "+i.length+" keys, got "+r.length;for(let r=0;r<i.length;r++){if(!Object.prototype.hasOwnProperty.call(n,i[r]))return"Missing key "+i[r];if(null!=e(t[i[r]],n[i[r]]))return"Expected value of "+i[r]+" to be "+t[i[r]]+", got "+n[i[r]]}return null}return"Unable to compare "+t+", "+n},e.deepEqual=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){const i=Array.isArray(t),r=Array.isArray(n);if(i&&r){if(t.length!==n.length)return!1;for(let i=0;i<t.length;++i)if(!e(t[i],n[i]))return!1;return!0}if(i!==r)return!1;const s=Object.keys(t);if(s.length!==Object.keys(n).length)return!1;for(const i of s){if(!n.hasOwnProperty(i))return!1;if(!e(t[i],n[i]))return!1}return!0}return t!=t&&n!=n}}(e.Util||(e.Util={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={}));const lf=ts.pxtc.Util.lf;var ts,pxt,pxt,pxt,pxt,pxt,pxt,Measurements,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,ts,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,ts,pxt,pxt,pxt,pxt,ts,pxt,ts,pxtmelody,pxtmelody;!function(e){!function(e){e.decodeBase64=function(e){return atob(e)},e.encodeBase64=function(e){return btoa(e)}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){function i(e,t){if(t)for(let n=0;n<t.length;++n)e.push(t[n])}function r(e){let t=[];for(let n=0;n<e.length;++n)i(t,e[n]);return t}function s(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function o(e,t,n,i,r){void 0===i&&(i=0),void 0===r&&(r=n.length-i);for(let s=0;s<r;++s)e[t+s]=n[i+s]}function a(e,t){return e==t?0:e<t?-1:1}n.CancellationToken=class{constructor(){this.pending=!1,this.cancelled=!1}startOperation(){this.pending=!0}isRunning(){return this.pending}onProgress(e){this.progressHandler=e}reportProgress(e,t){this.progressHandler&&this.progressHandler(e,t)}cancel(){this.cancelled=!0,this.pending=!1}cancelAsync(){return this.cancelled||!this.pending?(this.cancelled=!0,this.pending=!1,Promise.resolve()):(this.cancelled=!0,this.deferred=new Promise(e=>{this.resolve=e}),this.deferred)}isCancelled(){return this.cancelled}throwIfCancelled(){if(this.isCancelled())throw new Error}resolveCancel(){this.pending=!1,this.deferred&&(this.resolve(),this.deferred=void 0,this.resolve=void 0)}},n.codalHash16=function(e){const t=[251,175,119,215,81,14,79,191,103,49,181,143,186,157,0,232,31,32,55,60,152,58,17,237,174,70,160,144,220,90,57,223,59,3,18,140,111,166,203,196,134,243,124,95,222,179,197,65,180,48,36,15,107,46,233,130,165,30,123,161,209,23,97,16,40,91,219,61,100,10,210,109,250,127,22,138,29,108,244,67,207,9,178,204,74,98,126,249,167,116,34,77,193,200,121,5,20,113,71,35,128,13,182,94,25,226,227,199,75,27,41,245,230,224,43,225,177,26,155,150,212,142,218,115,241,73,88,105,39,114,62,255,192,201,145,214,168,158,221,148,154,122,12,84,82,163,44,139,228,236,205,242,217,11,187,146,159,64,86,239,195,42,106,198,118,112,184,172,87,2,173,117,176,229,247,253,137,185,99,164,102,147,45,66,231,52,141,211,194,206,246,238,56,110,78,248,63,240,189,93,92,51,53,183,19,171,72,50,33,104,101,69,8,252,83,120,76,135,85,54,202,125,188,213,96,235,136,208,162,129,190,132,156,38,47,1,7,254,24,4,216,131,89,21,28,133,37,153,149,80,170,68,6,169,234,151];function n(e){let n=0;for(let i=0;i<e.length;i++){let r=e[i];n=t[n^r]}return n}return e?function(e,t){let i;const r=new Uint8Array(e.length);for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);r[t]=255&n}let s=0;for(let e=0;e<t;++e)i=n(r),s|=i<<8*e,r[0]=(r[0]+1)%255;return s}(e,2):0},n.bufferSerial=function(e,t="",n="?",i=255){for(let r=0;r<t.length;++r){const s=t[r];if(e[n]=(e[n]||"")+s,"\n"===s||e[n].length>i){let t=e[n];e[n]="",window.postMessage({type:"serial",id:n,data:t},"*")}}},n.blobReadAsDataURL=function(e){return e?new Promise((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=e=>n(e),i.readAsDataURL(e)}):Promise.resolve(void 0)},n.fileReadAsBufferAsync=function(e){return e?new Promise((t,n)=>{let i=new FileReader;i.onerror=e=>t(null),i.onload=e=>t(new Uint8Array(i.result)),i.readAsArrayBuffer(e)}):Promise.resolve(null)},n.fileReadAsTextAsync=function(e){return e?new Promise((t,n)=>{let i=new FileReader;i.onerror=e=>t(null),i.onload=e=>t(i.result),i.readAsText(e)}):Promise.resolve(null)},n.sanitizeFileName=function(e){return e.replace(/[()\\\/.,?*^:<>!;'#$%^&|"@+={}\[\]~`\x00-\x1F]/g,"").trim().replace(/\s+/g,"-")},n.repeatMap=function(e,t){e=e||0;let n=[];for(let i=0;i<e;++i)n.push(t(i));return n},n.listsEqual=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},n.oops=function(e="OOPS"){throw new Error(e)},n.reversed=function(e){return(e=e.slice(0)).reverse(),e},n.arrayEquals=function(e,t,n=(e,t)=>e===t){if(e==t)return!0;if(!e&&t||!t&&e||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0},n.iterMap=function(e,t){Object.keys(e).forEach(n=>t(n,e[n]))},n.mapMap=function(e,t){let n={};return Object.keys(e).forEach(i=>n[i]=t(i,e[i])),n},n.values=function(e){return Object.keys(e||{}).map(t=>e[t])},n.pushRange=i,n.concatArrayLike=function(e){return r(e)},n.concat=r,n.memcpy=o,n.uint8ArrayConcat=function(e){let t=0;for(let n of e)t+=n.length;let n=new Uint8Array(t),i=0;for(let t of e)o(n,i,t),i+=t.length;return n},n.jsonTryParse=function(e){try{return JSON.parse(e)}catch(e){return}},n.jsonMergeFrom=function e(t,i){i&&Object.keys(i).forEach(r=>{s(t[r])&&s(i[r])?e(t[r],i[r]):t[r]=n.clone(i[r])})},n.jsonCopyFrom=function(e,t){let i=n.clone(t);for(let n of Object.keys(t))e[n]=i[n]},n.jsonFlatten=function(e){let t={},i=(e,r)=>{if(null!==r&&"object"==typeof r){n.assert(!Array.isArray(r)),e&&(e+=".");for(let t of Object.keys(r))i(e+t,r[t])}else t[e]=r};return i("",e),t},n.jsonUnFlatten=function(e){let t={};for(let n of Object.keys(e)){let i=t,r=n.split(".");for(let t=0;t<r.length;++t){let s=r[t];t==r.length-1?i[s]=e[n]:("object"!=typeof i[s]&&(i[s]={}),i=i[s])}}return t},n.strcmp=a,n.stringMapEq=function(e,t){let n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let i of n){if(!t.hasOwnProperty(i))return!1;if(e[i]!==t[i])return!1}return!0},n.endsWith=function(e,t){return!(e.length<t.length)&&(0==t.length||e.slice(-t.length)==t)},n.startsWith=function(e,t){return!(e.length<t.length)&&(0==t.length||e.slice(0,t.length)==t)},n.contains=function(e,t){return!(e.length<t.length)&&(0==t.length||e.indexOf(t)>-1)},n.replaceAll=function(e,t,n){return t?e.split(t).join(n):e},n.snakify=function(e){const t=e.toUpperCase(),n=e.toLowerCase();if(e==t||e==n)return e;if(e.lastIndexOf("_")>0)return e;const i=t=>e[t]!=n[t],r=n=>e[n]!=t[n];let s="",o=0;for(;o<e.length;){let t=i(o),n=o;for(;n<e.length;){if(t&&r(n)){if(n-o>2){n--;break}t=!1}if(!t&&i(n))break;n++}s&&(s+="_"),s+=e.slice(o,n),o=n}return s.toUpperCase()===s?s:s.toLowerCase()},n.sortObjectFields=function(e){let t=Object.keys(e);t.sort(a);let n={};return t.forEach(t=>n[t]=e[t]),n},n.chopArray=function(e,t){let n=[];for(let i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},n.unique=function(e,t){let n=[],i={};return e.forEach(e=>{let r=t(e);i.hasOwnProperty(r)||(i[r]=null,n.push(e))}),n},n.groupBy=function(e,t){let n={};return e.forEach(e=>{let i=t(e);n.hasOwnProperty(i)||(n[i]=[]),n[i].push(e)}),n},n.toDictionary=function(e,t){let n={};return e.forEach(e=>{n[t(e)]=e}),n},n.toSet=function(e,t){let n={};return e.forEach(e=>{n[t(e)]=!0}),n},n.deepCopy=function e(t){if("object"!=typeof t||null===t)return t;const n=Array.isArray(t)?[]:{};for(const i in t){const r=t[i];n[i]=e(r)}return n},n.toArray=function(e){if(Array.isArray(e))return e;let t=[];if(!e)return t;for(let n=0;n<e.length;++n)t.push(e[n]);return t},n.indexOfMatching=function(e,t){for(let n=0;n<e.length;++n)if(t(e[n]))return n;return-1};const l=Promise.resolve();async function c(e,t,n){let i=0;const r=[],s=[];for(let o=0;o<e;o++){const e=(async()=>{for(;i<t.length;){const e=i++,r=t[e];s[e]=await n(r)}})();r.push(e)}try{await Promise.all(r)}catch(e){throw i=t.length,e}return s}function u(e,t){const n={};return i=>{const r=e(i);return n.hasOwnProperty(r)?n[r]:n[r]=t(i)}}n.nextTick=function(e){l.then(e)},n.delay=async function(e,t){const n=await t;return await new Promise(t=>setTimeout(()=>t(),e)),n},n.promiseMapAll=function(e,t){return Promise.all(e.map(e=>t(e)))},n.promiseMapAllSeries=function(e,t){return c(1,e,t)},n.promisePoolAsync=c,n.memoizeString=function(e){return u(e=>e,e)},n.promiseTimeout=async function(e,t,n){let i,r;const s=new Promise((t,s)=>{r=t,i=setTimeout(()=>{r=void 0,clearTimeout(i),s(n||`Promise timed out after ${e}ms`)},e)});return Promise.race([t,s]).then(e=>(r&&(clearTimeout(i),r()),e))},n.defer=function(){let e,t,n,i=!1;return{resolve:function(n){i?pxt.debug("Deferred promise already resolved"):(t?t(n):e=e||new Promise(function(e){e(n)}),i=!0)},reject:function(t){i?pxt.debug("Deferred promise already resolved"):(n?n(t):e=e||new Promise(function(e,n){n(t)}),i=!0)},promise:new Promise(function(i,r){e?i(e):(t=i,n=r)})}},n.memoize=u,n.debounce=function(e,t,n){let i;return function(){let r=this,s=arguments,o=n&&!i;return clearTimeout(i),i=setTimeout(function(){i=null,n||e.apply(r,s)},t),o&&e.apply(r,s),i}};function d(e){return e&&(e=e.replace(/\\/g,"/")),e}function p(e){const i={url:`${encodeURI(e.url.replace(/[?#].*/,"..."))}`,method:`${e.method||"GET"}`};return pxt.perf.measureStart(Measurements.NetworkRequest),n.httpRequestCoreAsync(e).then(i=>{const r=i.statusCode;if((e.successCodes||[304,200,201,202]).indexOf(r)<0&&!e.allowHttpErrors){const t=n.lf("Bad HTTP status code: {0} at {1}; message: {2}",i.statusCode,e.url,(i.text||"").slice(0,500)),r=new Error(t);return r.statusCode=i.statusCode,Promise.reject(r)}return i.text&&/application\/json/.test(i.headers["content-type"])&&(i.json=t.U.jsonTryParse(i.text)),i}).then(e=>{const t=e.headers["content-length"];if(t)i.sizeInBytes=`${t}`;else if(e.text&&pxt.perf.isEnabled()){const t=(new TextEncoder).encode(e.text);i.sizeInBytes=t.length+""}return i.statusCode=`${e.statusCode}`,e}).finally(()=>{pxt.perf.measureEnd(Measurements.NetworkRequest,i)})}function h(e,t){let n="";if(!e)return n;for(let i=0;i<e.length;++i){let r=e.charCodeAt(i);if(r<=127)n+=e.charAt(i);else if(r<=2047)n+=String.fromCharCode(192|r>>6,128|63&r);else{if(!t&&55296<=r&&r<=56319){let t=e.charCodeAt(++i);isNaN(t)||(r=65536+(r-55296<<10)+(t-56320))}n+=r<=65535?String.fromCharCode(224|r>>12,128|r>>6&63,128|63&r):String.fromCharCode(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}}return n}n.AdaptiveDebouncer=class{constructor(e,t=300,n=2e3,i=2){this.func=e,this.minDelay=t,this.maxDelay=n,this.slowdownFactor=i,this.lastPoke=0,this.recentGaps=[],this.wrapped=()=>{this.timeout=null,this.func()}}poke(){const e=Date.now();if(this.lastPoke){const t=e-this.lastPoke;if(t<10)return;for(t<4e3&&this.recentGaps.push(t);this.recentGaps.length>10;)this.recentGaps.shift()}this.lastPoke=e}trigger(){let e=this.maxDelay;if(this.lastPoke){const t=this.recentGaps.slice();t.sort();const n=t[t.length>>1]||1;e=Math.min(Math.max(n*this.slowdownFactor|0,this.minDelay),this.maxDelay);e-=Date.now()-this.lastPoke,e<0&&(e=0),this.lastPoke=null}clearTimeout(this.timeout),this.timeout=setTimeout(this.wrapped,e)}},n.throttle=function(e,t,n){let i;return function(){let r=this,s=arguments,o=n&&!i;i||(i=setTimeout(function(){i=null,n||e.apply(r,s)},t)),o&&e.apply(r,s)}},n.randomPermute=function(e){for(let t=0;t<e.length;++t){let n=m()%e.length,i=e[t];e[t]=e[n],e[n]=i}},n.randomPick=function(e){return 0==e.length?null:e[m()%e.length]},n.timeSince=function(e){let t=(Date.now()-(e*=1e3))/1e3;return isNaN(t)?"":t<-30?(t=-t,t<60?n.lf("in a few seconds"):t<120?n.lf("in a minute"):t<3600?n.lf("in {0} minute{0:s}",Math.floor(t/60)):t<7200?n.lf("in an hour"):t<86400?n.lf("in {0} hour{0:s}",Math.floor(t/60/60)):t<2592e3?n.lf("in {0} day{0:s}",Math.floor(t/60/60/24)):t<31536e3?n.lf("in {0} month{0:s}",Math.floor(t/60/60/24/30)):n.lf("in {0} year{0:s}",Math.floor(t/60/60/24/365))):t<0?n.lf("now"):t<10?n.lf("a few seconds ago"):t<60?n.lf("{0} second{0:s} ago",Math.floor(t)):t<120?n.lf("a minute ago"):t<3600?n.lf("{0} minute{0:s} ago",Math.floor(t/60)):t<7200?n.lf("an hour ago"):t<86400?n.lf("{0} hour{0:s} ago",Math.floor(t/60/60)):t<2592e3?n.lf("{0} day{0:s} ago",Math.floor(t/60/60/24)):t<31536e3?n.lf("{0} month{0:s} ago",Math.floor(t/60/60/24/30)):n.lf("{0} year{0:s} ago",Math.floor(t/60/60/24/365))},n.unicodeToChar=function(e){return e.replace(/\\u([\d\w]{4})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})},n.escapeForRegex=function(e){return null==e?void 0:e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},n.stripUrlProtocol=function(e){return null==e?void 0:e.replace(/.*?:\/\//g,"")},n.normalizePath=d,n.pathJoin=function(e,t){if(d(e),d(t),e||t)return e?t?("/"!==e.charAt(e.length-1)&&(e+="/"),"/"==t.charAt(0)&&(t=t.substring(1)),e+t):e:t},n.isNodeJS="undefined"==typeof window,n.requestAsync=p,n.httpGetTextAsync=function(e){return p({url:e}).then(e=>e.text)},n.httpGetJsonAsync=function(e){return p({url:e}).then(e=>e.json)},n.httpPostJsonAsync=function(e,t){return p({url:e,data:t||{}}).then(e=>e.json)},n.stringToUint8Array=function(e){let t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n},n.uint8ArrayToString=function(e){let t=e.length,n="";for(let i=0;i<t;++i)n+=String.fromCharCode(e[i]);return n},n.fromUTF8=function(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){let i=255&e.charCodeAt(n);t+=37==i||i>127?"%"+i.toString(16):e.charAt(n)}return decodeURIComponent(t)},n.toUTF8=h,n.toHex=function(e){let t="";for(let n=0;n<e.length;++n)t+=("0"+e[n].toString(16)).slice(-2);return t},n.fromHex=function(e){let t=new Uint8Array(e.length>>1);for(let n=0;n<e.length;n+=2)t[n>>1]=parseInt(e.slice(n,n+2),16);return t};n.PromiseQueue=class{constructor(){this.promises={}}enqueue(e,t){return new Promise((n,i)=>{let r=this.promises[e];r||(r=this.promises[e]=[]),r.push(()=>t().finally(()=>{r.shift(),0==r.length?delete this.promises[e]:r[0]()}).then(n,i)),1==r.length&&r[0]()})}};function f(){return Date.now()}function m(){let e=new Uint8Array(4);return n.getRandomBuf(e),new Uint32Array(e.buffer)[0]}function g(e,t,n){function i(i){pxt.debug(`downloading translations for ${e} ${t}`);let r=pxt.BrowserUtils.isLocalHost()||pxt.webConfig.isStatic?"https://makecode.com/api/":"",s=`${r}translations?lang=${encodeURIComponent(e)}&filename=${encodeURIComponent(t)}&approved=true`;const o={};return n&&!pxt.Cloud.useCdnApi()&&(o["If-None-Match"]=n),(r?p:pxt.Cloud.apiRequestWithCdnAsync)({url:s,headers:o}).then(r=>304==r.statusCode||200==r.statusCode?(n=r.headers.etag||"",pxt.BrowserUtils.translationDbAsync().then(s=>s.setAsync(e,t,n,r.json||i)).then(()=>r.json||i)):r.json,e=>{pxt.log(`failed to load translations from ${s}`)})}return pxt.BrowserUtils.translationDbAsync().then(n=>n.getAsync(e,t)).then(e=>{if(e){n=e.etag;return(Date.now()-e.time)/1e3>300&&i(e.strings),e.strings}return i()})}function _(e){let[t,i]=n.normalizeLanguageCode(e),r=pxt.appTarget.appTheme;if(r&&r.availableLocales){if(r.availableLocales.indexOf(t)>-1)return!0;if(i&&r.availableLocales.indexOf(i)>-1)return!0}return!1}let y;function b(e,i,r,s,o){if(o=o||y.Editor,"en-US"===(r=n.normalizeLanguageCode(r)[0])||"en"===r)return Promise.resolve(void 0);let a,l,c=`${r}/${s}/${o}`;if(n.translationsCache()[c])return Promise.resolve(n.translationsCache()[c]);switch(o){case y.Editor:a=[{staticName:"strings.json",path:"strings.json"},{staticName:"target-strings.json",path:e+"/target-strings.json"}];break;case y.Sim:a=[{staticName:"sim-strings.json",path:e+"/sim-strings.json"}];break;case y.Apis:a=[{staticName:"bundled-strings.json",path:e+"/bundled-strings.json"}];break;case y.SkillMap:a=[{staticName:"skillmap-strings.json",path:"/skillmap-strings.json"}]}function u(e){e&&(l||(l={}),Object.keys(e).filter(t=>!!e[t]).forEach(t=>l[t]=e[t]))}if(s){let s=0;const d=t.U.promiseMapAllSeries(a,e=>g(r,e.path).then(u,e=>{pxt.log(e.message),++s}));return d.then(()=>(s&&(n.translationsCache()[c]=l),s!==a.length&&l?Promise.resolve(l):(pxt.tickEvent("translations.livetranslationsfailed"),b(e,i,r,!1,o))))}return Promise.all(a.map(e=>n.httpGetJsonAsync(`${i}locales/${r}/${e.staticName}`).catch(e=>{}))).then(e=>{let t={};e.forEach(e=>pxt.Util.jsonMergeFrom(t,e)),Object.keys(t).length&&(l=t,n.translationsCache()[c]=l)},e=>{pxt.error("failed to load localizations")}).then(()=>l)}function v(e){const t={};for(const n of Object.keys(e))t[n]=T(e[n]);return t}function T(e){var t;return{attributes:Object.assign({},e.attributes),parameters:null===(t=e.parameters)||void 0===t?void 0:t.map(k),extendsTypes:e.extendsTypes?[...e.extendsTypes]:void 0,pkgs:e.pkgs?[...e.pkgs]:void 0,combinedProperties:e.combinedProperties?[...e.combinedProperties]:void 0,name:e.name,namespace:e.namespace,fileName:e.fileName,kind:e.kind,retType:e.retType,isInstance:e.isInstance,isContextual:e.isContextual,qName:e.qName,pkg:e.pkg,snippet:e.snippet,snippetName:e.snippetName,snippetWithMarkers:e.snippetWithMarkers,pySnippet:e.pySnippet,pySnippetName:e.pySnippetName,pySnippetWithMarkers:e.pySnippetWithMarkers,blockFields:e.blockFields,isReadOnly:e.isReadOnly,pyName:e.pyName,pyQName:e.pyQName,snippetAddsDefinitions:e.snippetAddsDefinitions}}function k(e){var n,i;return{name:e.name,description:e.description,type:e.type,pyTypeString:e.pyTypeString,initializer:e.initializer,default:e.default,properties:null===(n=e.properties)||void 0===n?void 0:n.map(x),handlerParameters:null===(i=e.handlerParameters)||void 0===i?void 0:i.map(x),options:e.options?t.U.clone(e.options):void 0,isEnum:e.isEnum}}function x(e){return{name:e.name,type:e.type}}function E(e){if(!e)return e;const t=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/\b(token|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]{0,200}/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"JWT Token",regex:/\beyJ[A-Za-z0-9_\-]+?\.[A-Za-z0-9_\-]+?\.[A-Za-z0-9_\-]+?\b/},{label:"Email",regex:/\b[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,63}\b/i}];for(const n of t)if(n.regex.test(e))return`<REDACTED: ${n.label}>`;return e}n.PromiseBuffer=class{constructor(){this.waiting=[],this.available=[]}drain(){for(let e of this.waiting)e(new Error("Promise Buffer Reset"));this.waiting=[],this.available=[]}pushError(e){this.push(e)}push(e){let t=this.waiting.shift();t?t(e):this.available.push(e)}shiftAsync(e=0){if(this.available.length>0){let e=this.available.shift();return e instanceof Error?Promise.reject(e):Promise.resolve(e)}return new Promise((n,i)=>{let r=e=>{e instanceof Error?i(e):n(e)};this.waiting.push(r),e>0&&t.U.delay(e).then(()=>{let e=this.waiting.indexOf(r);e>=0&&(this.waiting.splice(e,1),i(new Error("Timeout")))})})}},n.now=f,n.nowSeconds=function(){return Math.round(f()/1e3)},n.timeout=function(e){return new Promise(t=>setTimeout(()=>t(),e))},n.runWithBackoffAsync=async function(e,t,n,i,r,s,o=1.5){let a=n;const l=Date.now();for(;Date.now()-l<r;){const n=await e();if(t(n))return n;await pxt.Util.timeout(a),a=Math.min(a*o,i)}throw new Error(s)},n.cpuUs=()=>{const e="undefined"!=typeof performance?performance.now.bind(performance)||performance.moznow.bind(performance)||performance.msNow.bind(performance)||performance.webkitNow.bind(performance)||performance.oNow.bind(performance):Date.now;return n.cpuUs=()=>1e3*e(),n.cpuUs()},n.getMime=function(e){let t=/\.([a-zA-Z0-9]+)$/.exec(e);if(!t)return"application/octet-stream";switch(t[1].toLowerCase()){case"txt":return"text/plain";case"html":case"htm":return"text/html";case"css":return"text/css";case"js":return"application/javascript";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"ico":return"image/x-icon";case"manifest":return"text/cache-manifest";case"webmanifest":return"application/manifest+json";case"json":return"application/json";case"svg":return"image/svg+xml";case"eot":return"application/vnd.ms-fontobject";case"ttf":return"font/ttf";case"woff":return"application/font-woff";case"woff2":return"application/font-woff2";case"md":return"text/markdown";case"xml":return"application/xml";case"m4a":return"audio/m4a";case"mp3":return"audio/mp3";case"wasm":return"application/wasm";default:return"application/octet-stream"}},n.randomUint32=m,n.guidGen=function(){function e(){return(65536|m()).toString(16).slice(-4)}return e()+e()+"-"+e()+"-4"+e().slice(-3)+"-"+e()+"-"+e()+e()+e()},n.downloadLiveTranslationsAsync=g,n.pxtLangCookieId="PXT_LANG",n.langCookieExpirationDays=30,n.allLanguages={af:{englishName:"Afrikaans",localizedName:"Afrikaans"},ar:{englishName:"Arabic",localizedName:""},az:{englishName:"Azerbaijani",localizedName:" "},bg:{englishName:"Bulgarian",localizedName:""},bi:{englishName:"Bislama",localizedName:"Bislama"},bn:{englishName:"Bengali",localizedName:""},ca:{englishName:"Catalan",localizedName:"Catal"},cs:{englishName:"Czech",localizedName:"etina"},cy:{englishName:"Welsh",localizedName:"Cymraeg"},da:{englishName:"Danish",localizedName:"Dansk"},de:{englishName:"German",localizedName:"Deutsch"},el:{englishName:"Greek",localizedName:""},en:{englishName:"English",localizedName:"English"},"es-ES":{englishName:"Spanish (Spain)",localizedName:"Espaol (Espaa)"},"es-MX":{englishName:"Spanish (Mexico)",localizedName:"Espaol (Mxico)"},et:{englishName:"Estonian",localizedName:"Eesti"},eu:{englishName:"Basque",localizedName:"Euskara"},fa:{englishName:"Persian",localizedName:""},fi:{englishName:"Finnish",localizedName:"Suomi"},fil:{englishName:"Filipino",localizedName:"Filipino"},fo:{englishName:"Faroese",localizedName:"froyskt"},fr:{englishName:"French",localizedName:"Franais"},"fr-CA":{englishName:"French (Canada)",localizedName:"Franais (Canada)"},"ga-IE":{englishName:"Irish",localizedName:"Gaeilge"},gl:{englishName:"Galician",localizedName:"galego"},gn:{englishName:"Guarani",localizedName:"Avae'"},"gu-IN":{englishName:"Gujarati",localizedName:""},haw:{englishName:"Hawaiian",localizedName:"lelo Hawaii"},hi:{englishName:"Hindi",localizedName:""},he:{englishName:"Hebrew",localizedName:""},hr:{englishName:"Croatian",localizedName:"Hrvatski"},hu:{englishName:"Hungarian",localizedName:"Magyar"},"hy-AM":{englishName:"Armenian (Armenia)",localizedName:" ()"},id:{englishName:"Indonesian",localizedName:"Bahasa Indonesia"},is:{englishName:"Icelandic",localizedName:"slenska"},it:{englishName:"Italian",localizedName:"Italiano"},ja:{englishName:"Japanese",localizedName:""},"ja-HIRA":{englishName:"Hiragana",localizedName:""},ka:{englishName:"Georgian",localizedName:""},kab:{englishName:"Kabyle",localizedName:""},kk:{englishName:"Kazakh",localizedName:" "},km:{englishName:"Khmer",localizedName:""},kmr:{englishName:"Kurmanji (Kurdish)",localizedName:""},kn:{englishName:"Kannada",localizedName:""},ko:{englishName:"Korean",localizedName:""},lt:{englishName:"Lithuanian",localizedName:"Lietuvi"},lv:{englishName:"Latvian",localizedName:"Latvieu"},"ml-IN":{englishName:"Malayalam",localizedName:""},mr:{englishName:"Marathi",localizedName:""},ms:{englishName:"Malay",localizedName:"Melayu"},nl:{englishName:"Dutch",localizedName:"Nederlands"},no:{englishName:"Norwegian",localizedName:"Norsk"},nb:{englishName:"Norwegian Bokmal",localizedName:"Norsk bokml"},"nn-NO":{englishName:"Norwegian Nynorsk",localizedName:"Norsk nynorsk"},"pa-IN":{englishName:"Punjabi",localizedName:""},pl:{englishName:"Polish",localizedName:"Polski"},ps:{englishName:"Pashto",localizedName:""},"pt-BR":{englishName:"Portuguese (Brazil)",localizedName:"Portugus (Brasil)"},"pt-PT":{englishName:"Portuguese (Portugal)",localizedName:"Portugus (Portugal)"},ro:{englishName:"Romanian",localizedName:"Romn"},ru:{englishName:"Russian",localizedName:""},sat:{englishName:"Santali",localizedName:""},"si-LK":{englishName:"Sinhala",localizedName:""},sk:{englishName:"Slovak",localizedName:"Slovenina"},sl:{englishName:"Slovenian",localizedName:"Slovenski"},sq:{englishName:"Albanian",localizedName:"shqip"},sr:{englishName:"Serbian (Cyrillic)",localizedName:"Srpski"},su:{englishName:"Sundanese",localizedName:" "},"sv-SE":{englishName:"Swedish",localizedName:"Svenska"},sw:{englishName:"Swahili",localizedName:"Kiswahili"},"sw-TZ":{englishName:"Swahili (Tanzania)",localizedName:"Kiswahili (Tanzania)"},ta:{englishName:"Tamil",localizedName:""},te:{englishName:"Telugu",localizedName:""},th:{englishName:"Thai",localizedName:""},tl:{englishName:"Tagalog",localizedName:" "},tr:{englishName:"Turkish",localizedName:"Trke"},uk:{englishName:"Ukrainian",localizedName:""},"ur-IN":{englishName:"Urdu (India)",localizedName:" ()"},"ur-PK":{englishName:"Urdu (Pakistan)",localizedName:" ()"},vi:{englishName:"Vietnamese",localizedName:"Ting vit"},"zh-CN":{englishName:"Chinese (Simplified)",localizedName:"()"},"zh-TW":{englishName:"Chinese (Traditional)",localizedName:"()"}},n.isLocaleEnabled=_,n.updateLocalizationAsync=function(t){const{targetId:i,baseUrl:r,force:s}=t;let{code:o}=t;if(o=n.normalizeLanguageCode(o)[0],"en-US"===o&&(o="en"),o===n.userLanguage()||!_(o)&&!s)return pxt.debug(`loc: ${o} (using built-in)`),Promise.resolve();pxt.debug(`loc: ${o}`);const a=pxt.Util.liveLocalizationEnabled();return b(i,r,o,a,e.pxtc.Util.TranslationsKind.Editor).then(t=>{var s;return t&&(n.setUserLanguage(o),null===(s=pxt.analytics)||void 0===s||s.addDefaultProperties({lang:o}),n.setLocalizedStrings(t)),e.pxtc.Util.downloadTranslationsAsync(i,r,o,a,e.pxtc.Util.TranslationsKind.Apis).then(t=>{t&&(e.pxtc.apiLocalizationStrings=t)})})},function(e){e[e.Editor=0]="Editor",e[e.Sim=1]="Sim",e[e.Apis=2]="Apis",e[e.SkillMap=3]="SkillMap"}(y=n.TranslationsKind||(n.TranslationsKind={})),n.downloadTranslationsAsync=b,n.capitalize=function(e){return e?e[0].toLocaleUpperCase()+e.slice(1):e},n.uncapitalize=function(e){return(e||"").split(/(?=[A-Z])/g).join(" ").toLowerCase()},n.camelCaseToLowercaseWithSpaces=function(e){return e.replace(/([A-Z])/gm," $1").toLocaleLowerCase().trim()},n.snakeCaseToLowercaseWithSpaces=function(e){return e.replace(/_/g," ").toLocaleLowerCase().trim()},n.range=function(e){let t=[];for(let n=0;n<e;++n)t.push(n);return t},n.multipartPostAsync=function(e,t={},i=null,r=null){const s="--------------------------0461489f461126c5";let o="";Object.keys(t).forEach(e=>function(e,t){o+=s+"\r\n",o+='Content-Disposition: form-data; name="'+e+'"\r\n\r\n',o+=t+"\r\n"}(e,t[e])),i&&function(e,t){const n=e.split("/").reverse()[0];o+=s+"\r\n",o+='Content-Disposition: form-data; name="files['+e+']"; filename="'+n+'"\r\n',o+="\r\n",o+=t+"\r\n"}(i,r),o+=s+"--\r\n";const a={url:e,method:"POST",headers:{"Content-Type":"multipart/form-data; boundary="+s.slice(2)},data:o};return n.httpRequestCoreAsync(a)},n.toDataUri=function(e,n){return/^https?:/i.test(e)||/^data:/i.test(e)?e:(n||/^<svg/i.test(e)&&(n="image/svg+xml"),/xml|svg/.test(n)?`data:${n},${encodeURIComponent(e)}`:`data:${n||"image/png"};base64,${t.encodeBase64(h(e))}`)},n.imageMagic=1496611453,n.imageHeaderSize=36,n.encodeBlobAsync=function(e,t){const i=n.imageHeaderSize+t.length,r=3*(e.width*e.height-1);let s=1;for(;s<4&&!(r*s>=8*i);)s++;let o=r*s>>3,a=i-o,l=0,c=e.width*e.height*4;if(a>0){const t=3*e.width;l=Math.ceil(a/t);const n=document.createElement("canvas");n.width=e.width,n.height=e.height+l;n.getContext("2d").drawImage(e,0,0),e=n}let u=pxt.HF2.encodeU32LE([n.imageMagic,t.length,l,0,0,0,0,0,0]);function d(e,t,n,i){let r=0,s=0,o=i[s++];const a=(1<<n)-1;let l=!0;for(;l;){let c=o>>r&a,u=8-r;if(u<=n){if(s>=i.length){if(0==u)break;l=!1}o=i[s++],c|=o<<u&a,r=n-u}else r+=n;e[t]=255&(e[t]&~a|c),3&~++t||(e[t++]=255)}return t}pxt.Util.assert(u.length==n.imageHeaderSize);const p=e.getContext("2d"),h=p.getImageData(0,0,e.width,e.height);d(h.data,0,1,[s]);let f=4;if(f=d(h.data,f,s,u),pxt.Util.assert(!(3&f)),0==l)f=d(h.data,f,s,t);else{let e=o-u.length;f=d(h.data,f,s,t.slice(0,e)),f=d(h.data,c,8,t.slice(e))}for(f|=3;f<h.data.length;)h.data[f]=255,f+=4;return p.putImageData(h,0,0),e},n.decodeBlobAsync=function(e){return pxt.BrowserUtils.loadCanvasAsync(e).then(e=>{const t=e.getContext("2d").getImageData(0,0,e.width,e.height).data,i=1&t[0]|(1&t[1])<<1|(1&t[2])<<2;if(i>5||0==i)return Promise.reject(new Error(n.lf("Invalid encoded PNG format")));function r(e,n,i){let r=0,s=0,o=0;const a=(1<<n)-1;for(;s<i.length;)o|=(t[e++]&a)<<r,3&~e||e++,r+=n,r>=8&&(i[s++]=255&o,o>>=8,r-=8);return e}const s=new Uint8Array(pxt.Util.imageHeaderSize);let o=r(4,i,s);const a=pxt.HF2.decodeU32LE(s);if(a[0]!=pxt.Util.imageMagic)return Promise.reject(new Error(n.lf("Invalid magic in encoded PNG")));const l=new Uint8Array(a[1]),c=a[2];if(c>0){const t=(e.height-c)*e.width,n=new Uint8Array((3*(t-1)*i>>3)-pxt.Util.imageHeaderSize);r(o,i,n),l.set(n);const s=new Uint8Array(l.length-n.length);r(4*t,8,s),l.set(s,n.length)}else r(o,i,l);return l})},n.parseQueryString=function(e){let t={};return e.replace(/\+/g," ").replace(/([^#?&=]+)=([^#?&=]*)/g,(e,n,i)=>(t[decodeURIComponent(n)]=decodeURIComponent(i),"")),t},n.stringifyQueryString=function(e,t){for(let n of Object.keys(t))e.indexOf("?")>=0?e+="&":e+="?",e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]);return e},n.cloneTargetBundle=function(e){const t=(e=Object.assign({},e)).apiInfo;delete e.apiInfo;const i=e.bundleddirs;delete e.bundleddirs;const r=e.bundledpkgs;delete e.bundledpkgs;const s=e.tutorialInfo;delete e.tutorialInfo;const o=n.clone(e);if(t){o.apiInfo={};for(const e of Object.keys(t)){const n=t[e].apis;o.apiInfo[e]={sha:t[e].sha,apis:{jres:Object.assign({},n.jres),byQName:v(n.byQName)}}}}if(i&&(o.bundleddirs=[...i]),r){o.bundledpkgs={};for(const e of Object.keys(r))o.bundledpkgs[e]=Object.assign({},r[e])}if(s){o.tutorialInfo={};for(const e of Object.keys(s)){const t=s[e];o.tutorialInfo[e]={hash:t.hash,usedBlocks:Object.assign({},t.usedBlocks),snippetBlocks:Object.assign({},t.snippetBlocks),highlightBlocks:Object.assign({},t.highlightBlocks),validateBlocks:Object.assign({},t.validateBlocks)}}}return o},n.cloneApis=v,n.cloneSymbolInfo=T,n.toUTF8Array=function(e){return(new TextEncoder).encode(e)},n.fromUTF8Array=function(e){return(new TextDecoder).decode(e)},n.getHomeUrl=function(){var e,t,n;let i=null===(e=pxt.webConfig)||void 0===e?void 0:e.relprefix.substr(0,pxt.webConfig.relprefix.length-3);return pxt.appTarget.appTheme.homeUrl&&i?((null===(t=pxt.appTarget.appTheme.homeUrl)||void 0===t?void 0:t.lastIndexOf("/"))===(null===(n=pxt.appTarget.appTheme.homeUrl)||void 0===n?void 0:n.length)-1&&(i=i.substr(1)),pxt.appTarget.appTheme.homeUrl+i):pxt.appTarget.appTheme.homeUrl},n.isExperienceSupported=function(e){var t,n,i,r;const s=null===(i=null===(n=null===(t=pxt.appTarget)||void 0===t?void 0:t.appTheme)||void 0===n?void 0:n.supportedExperiences)||void 0===i?void 0:i.map(e=>e.toLocaleLowerCase()),o=e.toLocaleLowerCase();return null!==(r=null==s?void 0:s.includes(o))&&void 0!==r&&r},n.ocvEnabled=function(){var e,t,n,i;return(null===(t=null===(e=pxt.webConfig)||void 0===e?void 0:e.ocv)||void 0===t?void 0:t.appId)&&(null===(i=null===(n=pxt.webConfig)||void 0===n?void 0:n.ocv)||void 0===i?void 0:i.iframeEndpoint)},n.bresenhamLine=function(e,t,n,i,r){const s=n-e,o=i-t;if(0===s){const n=o>=0?i:t;for(let s=o>=0?t:i;s<=n;s++)r(e,s);return}const a=s>0?1:-1,l=o>0?1:-1,c=Math.abs(o/s);let u=0,d=t;for(let t=e;a>0?t<=n:t>=n;t+=a)for(r(t,d),u+=c;u>=.5;)(l>0?d<=i:d>=i)&&r(t,d),d+=l,u-=1},n.isFeatureEnabled=function(e){var t,n;const i=null===(n=null===(t=pxt.appTarget.appTheme)||void 0===t?void 0:t.enabledFeatures)||void 0===n?void 0:n[e];if(!i)return!1;let r=!0;const s=pxt.Cloud.getRegion()?pxt.Cloud.getRegion().toUpperCase():void 0;return i.includeRegions&&(r=s&&i.includeRegions.some(e=>e.toUpperCase()==s)),r&&i.excludeRegions&&(r=s&&!i.excludeRegions.some(e=>e.toUpperCase()==s)),r},n.cleanData=function(e){if(!e)return e;let t;if("string"==typeof e)t=E(e);else if("object"==typeof e){t={};for(const[n,i]of Object.entries(e))t[n]="string"==typeof i?E(i):i}else t=e;return t}}(t.Util||(t.Util={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){e.Util.httpRequestCoreAsync=function(t){return new Promise((n,i)=>{let r,s=!1,o=e.Util.clone(t.headers)||{};r=new XMLHttpRequest,t.responseArrayBuffer&&(r.responseType="arraybuffer"),t.withCredentials&&(r.withCredentials=!0),r.onreadystatechange=()=>{if(!s&&4==r.readyState){s=!0;let e={statusCode:r.status,headers:{},buffer:r.responseBody||r.response,text:t.responseArrayBuffer?void 0:r.responseText};r.getAllResponseHeaders().split(/\r?\n/).forEach(t=>{let n=/^\s*([^:]+): (.*)/.exec(t);n&&(e.headers[n[1].toLowerCase()]=n[2])}),n(e)}};let a,l=t.data,c=t.method||(null==l?"GET":"POST");null==l?a=null:l instanceof Uint8Array?a=l:"object"==typeof l?(a=JSON.stringify(l),o["content-type"]="application/json; charset=utf8"):"string"==typeof l?a=l:e.Util.oops("bad data"),r.open(c,t.url),Object.keys(o).forEach(e=>{r.setRequestHeader(e,o[e])}),null==a?r.send():r.send(a)})},e.Util.sha256=o,e.Util.getRandomBuf=e=>{if(window.crypto)window.crypto.getRandomValues(e);else for(let t=0;t<e.length;++t)e[t]=Math.floor(255*Math.random())};const n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function i(e,t){return e>>>t|e<<32-t}function r(t,r){e.Util.assert(8==t.length),e.Util.assert(64==r.length);for(let e=16;e<64;++e){let t=i(r[e-15],7)^i(r[e-15],18)^r[e-15]>>>3,n=i(r[e-2],17)^i(r[e-2],19)^r[e-2]>>>10;r[e]=r[e-16]+t+r[e-7]+n|0}let s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=t[6],p=t[7];for(let e=0;e<64;++e){let t=p+(i(c,6)^i(c,11)^i(c,25))+(c&u^~c&d)+n[e]+r[e]|0,h=s&o^s&a^o&a;p=d,d=u,u=c,c=l+t|0,l=a,a=o,o=s,s=t+((i(s,2)^i(s,13)^i(s,22))+h|0)|0}t[0]+=s,t[1]+=o,t[2]+=a,t[3]+=l,t[4]+=c,t[5]+=u,t[6]+=d,t[7]+=p}function s(e){let t=new Uint32Array(8);t[0]=1779033703,t[1]=3144134277,t[2]=1013904242,t[3]=2773480762,t[4]=1359893119,t[5]=2600822924,t[6]=528734635,t[7]=1541459225;let n=new Uint32Array(64);function i(e){let i=e.length-63;for(let s=0;s<i;s+=64){for(let t=0;t<16;t++){let i=(t<<2)+s;n[t]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]}r(t,n)}}i(e);let s=64-(e.length+9)%64;64==s&&(s=0);let o=e.length-e.length%64,a=new Uint8Array(e.length-o+1+s+8),l=0;for(;o<e.length;)a[l++]=e[o++];for(a[l++]=128;s-- >0;)a[l++]=0;let c=8*e.length;for(l=a.length;c>0;)a[--l]=255&c,c>>=8;i(a);let u="";for(let e=0;e<t.length;++e)u+=("000000000"+t[e].toString(16)).slice(-8);return u.toLowerCase()}function o(t){pxt.perf.measureStart(Measurements.Sha256Buffer);const n=s(e.Util.toUTF8Array(t));return pxt.perf.measureEnd(Measurements.Sha256Buffer),n}t.sha256buffer=s,t.sha256string=o}(e.BrowserImpl||(e.BrowserImpl={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){const n={add:(e,t,n)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");if(t in e)throw new Error(`jsonPatch: object already contains key ${t}`);e[t]=n},replace:(e,t,n)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");e[t]=n},remove:(e,t)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");delete e[t]}},i={add:(e,t,n)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");if(t in e)throw new Error(`jsonPatch: key ${t} already exists in array`);"number"!=typeof t||t!==Math.floor(t)?e[t]=n:e.splice(t,0,n)},replace:(e,t,n)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");"number"!=typeof t||t!==Math.floor(t)?e[t]=n:e.splice(t,1,n)},remove:(e,t)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");"number"!=typeof t||t!==Math.floor(t)?delete e[t]:e.splice(t,1)}};t.diff=function(e,t){const n={add:[],remove:[],replace:[]};function i(e,t){if(!Array.isArray(e))return t;const n=Number.parseFloat(t);return Number.isNaN(n)?t:n}return function e(t,r,s){if(!Object.is(t,r)){r=r||{},t=t||{};for(let e of Object.keys(t))if(!(e in r)){const r=i(t,e);n.remove.push({op:"remove",path:s.concat(r)})}for(const o of Object.keys(r)){const a=t[o],l=r[o],c=i(r,o);c in t?"object"!=typeof a&&"object"!=typeof l&&a!==l||typeof a!=typeof l||Array.isArray(a)!==Array.isArray(l)?n.replace.push({op:"replace",path:s.concat(c),value:l}):e(a,l,s.concat(c)):void 0!==r[c]&&(s.length&&n.add.push({op:"add",path:s,value:Array.isArray(r)?[]:{}}),n.add.push({op:"add",path:s.concat(c),value:l}))}}}(e,t,[]),[...n.remove.reverse(),...n.replace,...n.add.sort((e,t)=>e.path.length-t.path.length)]},t.patchInPlace=function(e,t){if(!e||"object"!=typeof e)throw new Error("jsonPatch: Must be an object or an array.");for(const r of t){const t=r.path.slice(),s=t.pop();if(null==s)throw new Error("jsonPatch: missing last key");let o=e,a=t.shift();for(;null!=a;){if(!(a in o))throw new Error(`jsonPatch: missing parent element ${a}`);o=o[a],a=t.shift()}if(Array.isArray(o)&&"number"!=typeof s)throw new Error("jsonPatch: expected numeric index for array object");const l=Array.isArray(o)?i:n;"remove"===r.op?l.remove(o,s):"add"!==r.op||s in o?"replace"===r.op&&l.replace(o,s,r.value):l.add(o,s,r.value)}},t.opsAreEqual=function(t,n){return t.op===n.op&&e.U.arrayEquals(t.path,n.path)}}(e.jsonPatch||(e.jsonPatch={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){var i;(i=n.tests||(n.tests={})).diffTests=function(){const n=[{comment:"test 1",obja:{a:4,b:5},objb:{a:3,b:5},expected:[{op:"replace",path:["a"],value:3}]},{comment:"test 2",obja:{a:3,b:5},objb:{a:4,c:5},expected:[{op:"remove",path:["b"]},{op:"replace",path:["a"],value:4},{op:"add",path:["c"],value:5}]},{comment:"test 3",obja:{a:4,b:[1,2,3]},objb:{a:3,b:[1,2,4]},expected:[{op:"replace",path:["a"],value:3},{op:"replace",path:["b",2],value:4}]},{comment:"test 4",obja:{a:3,b:[1,2,4]},objb:{a:3,b:[1,2,4,5]},expected:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",3],value:5}]},{comment:"test 5",obja:{a:4,b:{c:3}},objb:{a:4,b:{c:4}},expected:[{op:"replace",path:["b","c"],value:4}]},{comment:"test 6",obja:{a:4,b:{c:4}},objb:{a:5,b:{d:4}},expected:[{op:"remove",path:["b","c"]},{op:"replace",path:["a"],value:5},{op:"add",path:["b"],value:{}},{op:"add",path:["b","d"],value:4}]},{comment:"test 7",obja:{a:4,b:[2,"foo"]},objb:{a:4,b:[2,"foo",["this","that"]]},expected:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",2],value:["this","that"]}]}];for(const i of n){pxt.log(i.comment);const n=e.pxtc.jsonPatch.diff(i.obja,i.objb);t.U.deepEqual(n,i.expected)?pxt.log("succeeded"):(pxt.error("FAILED"),pxt.log("got",n),pxt.log("exp",i.expected))}},i.patchTests=function(){const n=[{comment:"test 1",obj:{a:"foo",b:[4,11]},patches:[{op:"remove",path:["b"]},{op:"replace",path:["a"],value:4},{op:"add",path:["c"],value:5}],expected:{a:4,c:5}},{comment:"test 2",obj:{a:4,b:[1,2,3]},patches:[{op:"replace",path:["a"],value:3},{op:"replace",path:["b",2],value:4},{op:"add",path:["b",3],value:9}],expected:{a:3,b:[1,2,4,9]}},{comment:"test 3",obj:{a:4,b:{c:3}},patches:[{op:"replace",path:["a"],value:5},{op:"remove",path:["b","c"]},{op:"add",path:["b","d"],value:4}],expected:{a:5,b:{d:4}}},{comment:"test 4",obj:{a:4},patches:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",0],value:"foo"},{op:"add",path:["b",1],value:"bar"}],expected:{a:4,b:["foo","bar"]},validate:e=>e.b&&e.b.forEach}];for(const i of n)pxt.log(i.comment),e.pxtc.jsonPatch.patchInPlace(i.obj,i.patches),t.U.deepEqual(i.obj,i.expected)&&i.validate&&!i.validate(i.obj)?i.expected&&(pxt.error("FAILED"),pxt.log("got",i.obj),pxt.log("exp",i.expected)):pxt.log("succeeded")}}(t.jsonPatch||(t.jsonPatch={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){e.perf||(e.perf={})}(pxt||(pxt={})),pxt.perf.isEnabled||(pxt.perf.isEnabled=()=>!1),pxt.perf.report||(pxt.perf.report=()=>{}),pxt.perf.recordMilestone||(pxt.perf.recordMilestone=()=>{}),pxt.perf.measureStart||(pxt.perf.measureStart=()=>{}),pxt.perf.measureEnd||(pxt.perf.measureEnd=()=>{}),function(e){let t;e.U=pxtc.Util,e.Util=pxtc.Util;let n,i,r,s={};function o(n,i){/^csv-/.test(n)?e.setAppTargetVariant(n.replace(/^csv-*/,"")):e.appTarget&&(s[n]=i,e.U.jsonCopyFrom(e.appTarget.compile.switches,s),e.U.jsonCopyFrom(t.compile.switches,s))}function a(e,t,n){if(Array.isArray(e))return e.map(e=>a(e,t,n));if(e&&"object"==typeof e){for(const i of Object.keys(e))e[i]=a(e[i],t,n);return e}return"string"==typeof e&&t.test(e)?n(e):e}function l(){let t=e.appTarget.compile;t||(t=e.appTarget.compile={isNative:!1,hasHex:!1,switches:{}}),t.hasHex&&(t.nativeType||(t.nativeType=pxtc.NATIVE_TYPE_THUMB)),t.switches||(t.switches={}),t.nativeType==pxtc.NATIVE_TYPE_VM&&(t.sourceMap=!0),e.U.jsonCopyFrom(t.switches,s),t.jsRefCounting=!1,t.useUF2||t.useELF||null!=t.noSourceInFlash||(t.noSourceInFlash=!0),void 0===t.utf8&&(t.utf8=!0),e.appTarget.appTheme||(e.appTarget.appTheme={}),e.appTarget.appTheme.embedUrl||(e.appTarget.appTheme.embedUrl=e.appTarget.appTheme.homeUrl);let n=e.appTarget.compileService;if(n&&n.yottaTarget&&!n.yottaBinary&&(n.yottaBinary="pxt-microbit-app-combined.hex"),e.appTarget=a(e.appTarget,/^@cdnUrl@/i,t=>e.BrowserUtils.patchCdn(t)),e.appTarget.bundledpkgs&&Object.keys(e.appTarget.bundledpkgs).forEach(t=>{const n=e.appTarget.bundledpkgs[t],i=JSON.parse(n[e.CONFIG_NAME]);i.icon&&(i.icon=e.BrowserUtils.patchCdn(i.icon)),n[e.CONFIG_NAME]=e.Package.stringifyConfig(i)}),"undefined"!=typeof window){const t={"lockededitor=1":{appTheme:{lockedEditor:!0}},"hidemenu=1":{appTheme:{hideMenuBar:!0}}};e.appTarget.queryVariants&&e.Util.jsonCopyFrom(t,e.appTarget.queryVariants);const n=window.location.href;Object.keys(t).forEach(i=>{if(new RegExp(i,"i").exec(n)){let n=t[i];n&&e.U.jsonMergeFrom(e.appTarget,n)}})}}function c(n=!1){e.perf.measureStart(Measurements.ReloadAppTargetVariant);const i=n?"":JSON.stringify(e.appTarget);if(e.appTarget=e.U.cloneTargetBundle(t),e.appTargetVariant){const t=e.appTarget.variants&&e.appTarget.variants[e.appTargetVariant];t?e.U.jsonMergeFrom(e.appTarget,t):e.U.userError(lf("Variant '{0}' not defined in pxtarget.json",e.appTargetVariant))}l(),!n&&e.onAppTargetChanged&&i!=JSON.stringify(e.appTarget)&&e.onAppTargetChanged(),e.perf.measureEnd(Measurements.ReloadAppTargetVariant)}function u(){return{relprefix:"/--",workerjs:"/worker.js",monacoworkerjs:"/monacoworker.js",gifworkerjs:"/gifjs/gif.worker.js",serviceworkerjs:"/serviceworker.js",typeScriptWorkerJs:"/tsworker.js",pxtVersion:"local",pxtRelId:"localRelId",pxtCdnUrl:"/cdn/",commitCdnUrl:"/cdn/",blobCdnUrl:"/blb/",cdnUrl:"/cdn/",targetUrl:"",targetVersion:"local",targetRelId:"",targetId:e.appTarget?e.appTarget.id:"",simUrl:"/sim/simulator.html",simserviceworkerUrl:"/simulatorserviceworker.js",simworkerconfigUrl:"/sim/workerConfig.js",partsUrl:"/sim/siminstructions.html"}}function d(){return r||(r=e.Cloud.downloadTargetConfigAsync().then(e=>e||{},e=>({}))),r}function p(t=null){return t||(t=e.appTarget.compile),t.nativeType==ts.pxtc.NATIVE_TYPE_VM?t.useESP?t.useUF2?ts.pxtc.BINARY_UF2:ts.pxtc.BINARY_ESP:ts.pxtc.BINARY_PXT64:t.useUF2&&!t.switches.rawELF?ts.pxtc.BINARY_UF2:t.useELF?ts.pxtc.BINARY_ELF:ts.pxtc.BINARY_HEX}e.setAppTarget=function(n){e.appTarget=n||{},l(),t=e.U.cloneTargetBundle(e.appTarget)},e.setBundledApiInfo=function(e){for(const t of Object.keys(e)){const n=e[t].apis.byQName;for(const e of Object.keys(n)){const t=n[e],i=e.lastIndexOf("."),r=t.pyQName,s=n[e]={kind:Math.abs(t.kind||7),qName:e,namespace:e.slice(0,i<0?0:i),name:e.slice(i+1),pyQName:r,pyName:r?r.slice(r.lastIndexOf(".")+1):void 0,fileName:"",attributes:t.attributes||{},retType:t.retType||"void",parameters:t.parameters?t.parameters.map(e=>({name:e.name,description:e.description||"",type:e.type||"number",initializer:e.initializer,default:e.default,options:e.options||{},isEnum:!!e.isEnum,handlerParameters:e.handlerParameters})):null,extendsTypes:t.extendsTypes,snippet:t.kind&&t.kind<0?null:void 0,isInstance:!!t.isInstance,isReadOnly:!!t.isReadOnly},o=s.attributes;o.paramDefl||(o.paramDefl={}),o.callingConvention||(o.callingConvention=0),o.paramHelp||(o.paramHelp={}),o.jsDoc||(o.jsDoc=""),o._name=s.name.replace(/@.*/,"")}}n=e},e.getBundledApiInfo=function(){return n},e.savedAppTheme=function(){return t?t.appTheme:void 0},e.setCompileSwitch=o,e.setCompileSwitches=function(e){if(e)for(let t of e.split(/[\s,;:]+/))t&&("-"==t[0]?o(t.slice(1),!1):o(t,!0))},e.bundledSvg=function(t){if(!t)return;let n=i&&i[t];if(n)return n;if(!e.appTarget.simulator||!e.appTarget.simulator.dynamicBoardDefinition)return;i||(i={});const r=e.appTarget.bundledpkgs[t];if(!r)return;if(JSON.parse(r["pxt.json"]).core&&r["board.json"]){const n=JSON.parse(r["board.json"]);if(n&&n.visual&&n.visual.image){let s=n.visual.image;/^pkg:\/\//.test(s)&&(s=r[s.slice(6)]),i[t]=`data:image/svg+xml;base64,${ts.pxtc.encodeBase64(e.Util.toUTF8(s))}`}}return i[t]},e.replaceStringsInJsonBlob=a,e.reloadAppTargetVariant=c,e.setAppTargetVariant=function(t,n={}){e.debug(`app variant: ${t}`),(n.force||e.appTargetVariant!==t&&(e.appTargetVariant||t))&&(e.appTargetVariant=t,c(n.temporary))},e.setHwVariant=function(t,n){t=t.replace(/.*---/,""),/^[\w\-]+$/.test(t)?(e.hwVariant=t,e.hwName=n||t):(e.hwVariant=null,e.hwName=null),e.debug(`hwVariant: ${e.hwVariant} (${e.hwName})`)},e.hasHwVariants=function(){return!!e.appTarget.variants&&Object.keys(e.appTarget.bundledpkgs).some(e=>/^hw---/.test(e))},e.getHwVariants=function(){return e.appTarget.variants?Object.keys(e.appTarget.bundledpkgs).filter(e=>/^hw---/.test(e)).map(t=>JSON.parse(e.appTarget.bundledpkgs[t][e.CONFIG_NAME])).filter(t=>!!e.appTarget.appTheme.experimentalHw||!t.experimentalHw):[]},e.getActiveHwVariant=function(){return e.hwVariant},e.options={},e.reportException=function(t,n){if(e.error(t),n)try{e.error(n)}catch(t){}},e.reportError=function(t,n,i){if(e.error(`${t}: ${n}`),i)try{e.log(JSON.stringify(i,null,2))}catch(e){}},e.localWebConfig=u,e.getOnlineCdnUrl=function(){if(!e.webConfig)return null;let t=/^(https:\/\/[^\/]+)/.exec(e.webConfig.commitCdnUrl);return t?t[1]:null},e.setupWebConfig=function(t){t?e.webConfig=t:e.webConfig||(e.webConfig=u())},e.getEmbeddedScript=function(t){return e.U.lookup(e.appTarget.bundledpkgs||{},t)},e.targetConfigAsync=d,e.packagesConfigAsync=function(){return d().then(e=>e?e.packages:void 0)},e.CONFIG_NAME="pxt.json",e.SIMSTATE_JSON=".simstate.json",e.SERIAL_EDITOR_FILE="serial.txt",e.README_FILE="README.md",e.GITIGNORE_FILE=".gitignore",e.ASSETS_FILE="assets.json",e.CLOUD_ID="pxt/",e.BLOCKS_PROJECT_NAME="blocksprj",e.JAVASCRIPT_PROJECT_NAME="tsprj",e.PYTHON_PROJECT_NAME="pyprj",e.MAIN_BLOCKS="main.blocks",e.MAIN_TS="main.ts",e.MAIN_PY="main.py",e.DEFAULT_GROUP_NAME="other",e.TILEMAP_CODE="tilemap.g.ts",e.TILEMAP_JRES="tilemap.g.jres",e.IMAGES_CODE="images.g.ts",e.IMAGES_JRES="images.g.jres",e.TUTORIAL_CODE_START="_onCodeStart.ts",e.TUTORIAL_CODE_STOP="_onCodeStop.ts",e.TUTORIAL_INFO_FILE="tutorial-info-cache.json",e.TUTORIAL_CUSTOM_TS="tutorial.custom.ts",e.BREAKPOINT_TABLET=991,e.PALETTES_FILE="_palettes.json",e.HISTORY_FILE="_history",e.outputName=p,e.isOutputText=function(e=null){return p(e)==ts.pxtc.BINARY_HEX}}(pxt||(pxt={})),function(e){!function(t){const n="this";let i;function r(){if(i={device_while:{name:e.Util.lf("a loop that repeats while the condition is true"),tooltip:e.Util.lf("Run the same sequence of actions while the condition is met."),url:"/blocks/loops/while",category:"loops",block:{message0:e.Util.lf("while %1"),appendField:e.Util.lf("{id:while}do")}},pxt_controls_for:{name:e.Util.lf("a loop that repeats the number of times you say"),tooltip:e.Util.lf("Have the variable '{0}' take on the values from 0 to the end number, counting by 1, and do the specified blocks."),url:"/blocks/loops/for",category:"loops",block:{message0:e.Util.lf("for %1 from 0 to %2"),variable:e.Util.lf("{id:var}index"),appendField:e.Util.lf("{id:for}do")}},controls_simple_for:{name:e.Util.lf("a loop that repeats the number of times you say"),tooltip:e.Util.lf("Have the variable '{0}' take on the values from 0 to the end number, counting by 1, and do the specified blocks."),url:"/blocks/loops/for",category:"loops",block:{message0:e.Util.lf("for %1 from 0 to %2"),variable:e.Util.lf("{id:var}index"),appendField:e.Util.lf("{id:for}do")}},pxt_controls_for_of:{name:e.Util.lf("a loop that repeats for each value in an array"),tooltip:e.Util.lf("Have the variable '{0}' take the value of each item in the array one by one, and do the specified blocks."),url:"/blocks/loops/for-of",category:"loops",block:{message0:e.Util.lf("for element %1 of %2"),variable:e.Util.lf("{id:var}value"),appendField:e.Util.lf("{id:for_of}do")}},controls_for_of:{name:e.Util.lf("a loop that repeats for each value in an array"),tooltip:e.Util.lf("Have the variable '{0}' take the value of each item in the array one by one, and do the specified blocks."),url:"/blocks/loops/for-of",category:"loops",block:{message0:e.Util.lf("for element %1 of %2"),variable:e.Util.lf("{id:var}value"),appendField:e.Util.lf("{id:for_of}do")}},math_op2:{name:e.Util.lf("minimum or maximum of 2 numbers"),tooltip:{min:e.Util.lf("smaller value of 2 numbers"),max:e.Util.lf("larger value of 2 numbers")},url:"/blocks/math",operators:{op:["min","max"]},category:"math"},math_op3:{name:e.Util.lf("absolute number"),tooltip:e.Util.lf("absolute value of a number"),url:"/reference/math",category:"math",block:{message0:e.Util.lf("absolute of %1")}},math_number:{name:e.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:e.appTarget&&e.appTarget.compile?e.Util.lf("a decimal number"):e.Util.lf("an integer number")},math_integer:{name:e.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:e.Util.lf("an integer number")},math_whole_number:{name:e.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:e.Util.lf("a whole number")},math_number_minmax:{name:e.Util.lf("{id:block}number"),url:"/blocks/math",category:"math"},math_arithmetic:{name:e.Util.lf("arithmetic operation"),url:"/blocks/math",tooltip:{ADD:e.Util.lf("Return the sum of the two numbers."),MINUS:e.Util.lf("Return the difference of the two numbers."),MULTIPLY:e.Util.lf("Return the product of the two numbers."),DIVIDE:e.Util.lf("Return the quotient of the two numbers."),POWER:e.Util.lf("Return the first number raised to the power of the second number.")},operators:{OP:["ADD","MINUS","MULTIPLY","DIVIDE","POWER"]},category:"math",block:{MATH_ADDITION_SYMBOL:e.Util.lf("{id:op}+"),MATH_SUBTRACTION_SYMBOL:e.Util.lf("{id:op}-"),MATH_MULTIPLICATION_SYMBOL:e.Util.lf("{id:op}"),MATH_DIVISION_SYMBOL:e.Util.lf("{id:op}/"),MATH_POWER_SYMBOL:e.Util.lf("{id:op}**")}},math_modulo:{name:e.Util.lf("division remainder"),tooltip:e.Util.lf("Return the remainder from dividing the two numbers."),url:"/blocks/math",category:"math",block:{MATH_MODULO_TITLE:e.Util.lf("remainder of %1 / %2")}},math_js_op:{name:e.Util.lf("math function"),tooltip:{sqrt:e.Util.lf("Returns the square root of the argument"),sin:e.Util.lf("Returns the sine of the argument"),cos:e.Util.lf("Returns the cosine of the argument"),acos:e.Util.lf("Returns the arccosine of the argument"),asine:e.Util.lf("Returns the arcsine of the argument"),tan:e.Util.lf("Returns the tangent of the argument"),atan2:e.Util.lf("Returns the arctangent of the quotient of the two arguments"),idiv:e.Util.lf("Returns the integer portion of the division operation on the two arguments"),imul:e.Util.lf("Returns the integer portion of the multiplication operation on the two arguments")},url:"/blocks/math",operators:{OP:["sqrt","sin","cos","tan","atan2","idiv","imul"]},category:"math",block:{sqrt:e.Util.lf("{id:op}square root"),sin:e.Util.lf("{id:op}sin"),cos:e.Util.lf("{id:op}cos"),asin:e.Util.lf("{id:op}asin"),acos:e.Util.lf("{id:op}acos"),tan:e.Util.lf("{id:op}tan"),atan2:e.Util.lf("{id:op}atan2"),idiv:e.Util.lf("{id:op}integer /"),imul:e.Util.lf("{id:op}integer ")}},math_js_round:{name:e.Util.lf("rounding functions"),tooltip:{round:e.Util.lf("Increases the argument to the next higher whole number if its fractional part is more than one half"),ceil:e.Util.lf("Increases the argument to the next higher whole number"),floor:e.Util.lf("Decreases the argument to the next lower whole number"),trunc:e.Util.lf("Removes the fractional part of the argument")},url:"/blocks/math",operators:{OP:["round","ceil","floor","trunc"]},category:"math",block:{round:e.Util.lf("{id:op}round"),ceil:e.Util.lf("{id:op}ceiling"),floor:e.Util.lf("{id:op}floor"),trunc:e.Util.lf("{id:op}truncate")}},variables_change:{name:e.Util.lf("update the value of a number variable"),tooltip:e.Util.lf("Changes the value of the variable by this amount"),url:"/blocks/variables/change",category:"variables",block:{message0:e.Util.lf("change %1 by %2")}},controls_repeat_ext:{name:e.Util.lf("a loop that repeats and increments an index"),tooltip:e.Util.lf("Do some statements several times."),url:"/blocks/loops/repeat",category:"loops",block:{CONTROLS_REPEAT_TITLE:e.Util.lf("repeat %1 times"),CONTROLS_REPEAT_INPUT_DO:e.Util.lf("{id:repeat}do")}},variables_get:{name:e.Util.lf("get the value of a variable"),tooltip:e.Util.lf("Returns the value of this variable."),url:"/blocks/variables",category:"variables",block:{VARIABLES_GET_CREATE_SET:e.Util.lf("Create 'set %1'")}},variables_get_reporter:{name:e.Util.lf("get the value of a variable"),tooltip:e.Util.lf("Returns the value of this variable."),url:"/blocks/variables",category:"variables",block:{VARIABLES_GET_CREATE_SET:e.Util.lf("Create 'set %1'")}},variables_set:{name:e.Util.lf("assign the value of a variable"),tooltip:e.Util.lf("Sets this variable to be equal to the input."),url:"/blocks/variables/assign",category:"variables",block:{VARIABLES_SET:e.Util.lf("set %1 to %2")}},controls_if:{name:e.Util.lf("a conditional statement"),tooltip:{CONTROLS_IF_TOOLTIP_1:e.Util.lf("If a value is true, then do some statements."),CONTROLS_IF_TOOLTIP_2:e.Util.lf("If a value is true, then do the first block of statements. Otherwise, do the second block of statements."),CONTROLS_IF_TOOLTIP_3:e.Util.lf("If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements."),CONTROLS_IF_TOOLTIP_4:e.Util.lf("If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.")},tooltipSearch:"CONTROLS_IF_TOOLTIP_2",url:"/blocks/logic/if",category:"logic",block:{CONTROLS_IF_MSG_IF:e.Util.lf("{id:logic}if"),CONTROLS_IF_MSG_THEN:e.Util.lf("{id:logic}then"),CONTROLS_IF_MSG_ELSE:e.Util.lf("{id:logic}else"),CONTROLS_IF_MSG_ELSEIF:e.Util.lf("{id:logic}else if")}},lists_create_with:{name:e.Util.lf("create an array"),tooltip:e.Util.lf("Creates a new array."),url:"/reference/arrays/create",category:"arrays",blockTextSearch:"LISTS_CREATE_WITH_INPUT_WITH",block:{LISTS_CREATE_EMPTY_TITLE:e.Util.lf("empty array"),LISTS_CREATE_WITH_INPUT_WITH:e.Util.lf("array of"),LISTS_CREATE_WITH_CONTAINER_TITLE_ADD:e.Util.lf("array"),LISTS_CREATE_WITH_ITEM_TITLE:e.Util.lf("value")}},lists_length:{name:e.Util.lf("array length"),tooltip:e.Util.lf("Returns the number of items in an array."),url:"/reference/arrays/length",category:"arrays",block:{LISTS_LENGTH_TITLE:e.Util.lf("length of array %1")}},lists_index_get:{name:e.Util.lf("get a value in an array"),tooltip:e.Util.lf("Returns the value at the given index in an array."),url:"/reference/arrays/get",category:"arrays",block:{message0:e.Util.lf("%1 get value at %2")}},lists_index_set:{name:e.Util.lf("set a value in an array"),tooltip:e.Util.lf("Sets the value at the given index in an array"),url:"/reference/arrays/set",category:"arrays",block:{message0:e.Util.lf("%1 set value at %2 to %3")}},logic_compare:{name:e.Util.lf("comparing two numbers"),tooltip:{LOGIC_COMPARE_TOOLTIP_EQ:e.Util.lf("Return true if both inputs equal each other."),LOGIC_COMPARE_TOOLTIP_NEQ:e.Util.lf("Return true if both inputs are not equal to each other."),LOGIC_COMPARE_TOOLTIP_LT:e.Util.lf("Return true if the first input is smaller than the second input."),LOGIC_COMPARE_TOOLTIP_LTE:e.Util.lf("Return true if the first input is smaller than or equal to the second input."),LOGIC_COMPARE_TOOLTIP_GT:e.Util.lf("Return true if the first input is greater than the second input."),LOGIC_COMPARE_TOOLTIP_GTE:e.Util.lf("Return true if the first input is greater than or equal to the second input.")},url:"/blocks/logic/boolean",category:"logic",block:{search:"=  <  > "}},logic_operation:{name:e.Util.lf("boolean operation"),tooltip:{LOGIC_OPERATION_TOOLTIP_AND:e.Util.lf("Return true if both inputs are true."),LOGIC_OPERATION_TOOLTIP_OR:e.Util.lf("Return true if at least one of the inputs is true.")},url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_OPERATION_AND:e.Util.lf("{id:op}and"),LOGIC_OPERATION_OR:e.Util.lf("{id:op}or")}},logic_negate:{name:e.Util.lf("logical negation"),tooltip:e.Util.lf("Returns true if the input is false. Returns false if the input is true."),url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_NEGATE_TITLE:e.Util.lf("not %1")}},logic_boolean:{name:e.Util.lf("a `true` or `false` value"),tooltip:e.Util.lf("Returns either true or false."),url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_BOOLEAN_TRUE:e.Util.lf("{id:boolean}true"),LOGIC_BOOLEAN_FALSE:e.Util.lf("{id:boolean}false")}},text:{name:e.Util.lf("a piece of text"),tooltip:e.Util.lf("A letter, word, or line of text."),url:"/types/string",category:"text",block:{search:e.Util.lf("a piece of text")}},text_length:{name:e.Util.lf("number of characters in the string"),tooltip:e.Util.lf("Returns the number of letters (including spaces) in the provided text."),url:"/reference/text/length",category:"text",block:{TEXT_LENGTH_TITLE:e.Util.lf("length of %1")}},text_join:{name:e.Util.lf("join items to create text"),tooltip:e.Util.lf("Create a piece of text by joining together any number of items."),url:"/reference/text/join",category:"text",block:{TEXT_JOIN_TITLE_CREATEWITH:e.Util.lf("join")}},procedures_defnoreturn:{name:e.Util.lf("define the function"),tooltip:e.Util.lf("Create a function."),url:"/types/function/define",category:"functions",block:{PROCEDURES_DEFNORETURN_TITLE:e.Util.lf("function"),PROCEDURE_ALREADY_EXISTS:e.Util.lf("A function named '%1' already exists.")}},procedures_callnoreturn:{name:e.Util.lf("call the function"),tooltip:e.Util.lf("Call the user-defined function."),url:"/types/function/call",category:"functions",block:{PROCEDURES_CALLNORETURN_TITLE:e.Util.lf("call function")}},function_return:{name:e.Util.lf("return a value from within a function"),tooltip:e.Util.lf("Return a value from within a user-defined function."),url:"/types/function/return",category:"functions",block:{message_with_value:e.Util.lf("return %1"),message_no_value:e.Util.lf("return")}},function_definition:{name:e.Util.lf("define the function"),tooltip:e.Util.lf("Create a function."),url:"/types/function/define",category:"functions",block:{FUNCTIONS_EDIT_OPTION:e.Util.lf("Edit Function")}},function_call:{name:e.Util.lf("call the function"),tooltip:e.Util.lf("Call the user-defined function."),url:"/types/function/call",category:"functions",block:{FUNCTIONS_CALL_TITLE:e.Util.lf("call"),FUNCTIONS_GO_TO_DEFINITION_OPTION:e.Util.lf("Go to Definition")}},function_call_output:{name:e.Util.lf("call the function with a return value"),tooltip:e.Util.lf("Call the user-defined function with a return value."),url:"/types/function/call",category:"functions",block:{}}},i[pxtc.ON_START_TYPE]={name:e.Util.lf("on start event"),tooltip:e.Util.lf("Run code when the program starts"),url:"/blocks/on-start",category:"loops",block:{message0:e.Util.lf("on start %1 %2")}},i[pxtc.PAUSE_UNTIL_TYPE]={name:e.Util.lf("pause until"),tooltip:e.Util.lf("Pause execution of code until the given boolean expression is true"),url:"/blocks/pause-until",category:"loops",block:{message0:e.Util.lf("pause until %1")}},i[pxtc.TS_BREAK_TYPE]={name:e.Util.lf("break"),tooltip:e.Util.lf("Break out of the current loop or switch"),url:"/blocks/loops/break",category:"loops",block:{message0:e.Util.lf("break")}},i[pxtc.TS_CONTINUE_TYPE]={name:e.Util.lf("continue"),tooltip:e.Util.lf("Skip current iteration and continues with the next iteration in the loop"),url:"/blocks/loops/continue",category:"loops",block:{message0:e.Util.lf("continue")}},e.blocks.showBlockIdInTooltip)for(const e of Object.keys(i)){const t=i[e].tooltip;if("object"==typeof t&&null!==t)for(const n in t)t.hasOwnProperty(n)&&(i[e].tooltip[n]=`${t[n]} (id: ${e})`);else i[e].tooltip=`${i[e].tooltip} (id: ${e})`}}t.showBlockIdInTooltip=!1,t.requirePxtBlockly=()=>{},t.requireBlockly=()=>{},t.registerFieldEditor=()=>{},t.MATH_FUNCTIONS={unary:["sqrt","sin","cos","tan","asin","acos"],binary:["atan2"],infix:["idiv","imul"]},t.ROUNDING_FUNCTIONS=["round","ceil","floor","trunc"],t.builtinFunctionInfo={"Math.abs":{blockId:"math_op3",params:["x"]},"Math.min":{blockId:"math_op2",params:["x","y"]},"Math.max":{blockId:"math_op2",params:["x","y"]}},t.normalizeBlock=function(t,n=e.log){if(!t)return t;let i=t.replace(/(?:^|[^\\])([%$])\s+/g,"$1");return i!=t&&(n(`block has extra spaces: ${t}`),t=i),i=(t=i).replace(/([%$]\w+)\s*=\s*(\w+)/,"$1=$2"),i!=t&&(n(`block has space between %name and = : ${t}`),t=i),i=i.replace(/\s*\|\s*/g,"|"),i},t.compileInfo=function(e){var i;const r={parameters:[],actualNameToParam:{},definitionNameToParam:{},handlerArgs:[]};let s=!(1!=e.kind&&2!=e.kind||e.attributes.defaultInstance||e.isStatic);"boolean"!=typeof e.isInstance||(null===(i=e.attributes)||void 0===i?void 0:i.defaultInstance)||(s=e.isInstance);const o=!!e.attributes._def,a=o?e.attributes._def.parameters.slice(0):void 0,l=o?a.length:e.parameters?e.parameters.length:0,c=t.builtinFunctionInfo[e.qName];o&&e.attributes._expandedDef&&a.push(...e.attributes._expandedDef.parameters);const u={},d=a?a.filter(e=>!e.ref||(u[e.name]=e,!1)):[];if(s&&o&&a.length){const t=u[n]||a[0],i=t.name,s=!t.shadowBlockId||"variables_get"===t.shadowBlockId;let o=e.attributes.paramDefl[i]||e.attributes.paramDefl.this;s&&(o=t.varName||o),r.thisParameter={actualName:n,definitionName:i,shadowBlockId:t.shadowBlockId,type:e.namespace,defaultValue:o,definitionIndex:a.indexOf(t),fieldEditor:p(i,n),fieldOptions:h(i,n),shadowOptions:f(i,n)}}if(e.parameters){let t=s&&!u[n]?1:0;e.parameters.forEach((n,i)=>{let s;if(u[n.name]?s=u[n.name]:t<d.length&&(s=d[t],++t),s||!o){let e;n.options&&n.options.min&&n.options.max&&(e={min:n.options.min.value,max:n.options.max.value});const o=s?s.name:c?c.params[t++]:n.name,u=s&&("variables_get"===s.shadowBlockId||"lists_create_with"==s.shadowBlockId);r.parameters.push({actualName:n.name,type:n.type,defaultValue:u&&s.varName||n.default,definitionName:o,definitionIndex:s?a.indexOf(s):i,shadowBlockId:s&&s.shadowBlockId,isOptional:!!a&&a.indexOf(s)>=l,fieldEditor:p(o,n.name),fieldOptions:h(o,n.name),shadowOptions:f(o,n.name),range:e})}n.handlerParameters&&n.handlerParameters.forEach(t=>{r.handlerArgs.push({name:t.name,type:t.type,inBlockDef:!!a&&a.some(e=>e.ref&&e.name===t.name),localizationKey:`${e.qName}|handlerParam|${t.name}`})})})}return r.parameters.forEach(e=>{r.actualNameToParam[e.actualName]=e,r.definitionNameToParam[e.definitionName]=e}),r;function p(t,n){return e.attributes.paramFieldEditor&&(e.attributes.paramFieldEditor[t]||e.attributes.paramFieldEditor[n])}function h(t,n){return e.attributes.paramFieldEditorOptions&&(e.attributes.paramFieldEditorOptions[t]||e.attributes.paramFieldEditorOptions[n])}function f(t,n){return e.attributes.paramShadowOptions&&(e.attributes.paramShadowOptions[t]||e.attributes.paramShadowOptions[n])}},t.hasHandler=function(e){return e.parameters&&e.parameters.some(e=>{var t,n;return"() => void"==e.type||"Action"==e.type||!!(null===(t=e.properties)||void 0===t?void 0:t.length)||!!(null===(n=e.handlerParameters)||void 0===n?void 0:n.length)})},t.getHelpUrl=function(t){var n,i,r;let s=t.attributes.help;if((null===(n=t.attributes.blockId)||void 0===n?void 0:n.endsWith("_blockCombine_get"))?s=t.attributes.blockCombineGetHelp||s:(null===(i=t.attributes.blockId)||void 0===i?void 0:i.endsWith("_blockCombine_set"))?s=t.attributes.blockCombineSetHelp||s:(null===(r=t.attributes.blockId)||void 0===r?void 0:r.endsWith("_blockCombine_change"))&&(s=t.attributes.blockCombineChangeHelp||s),s){const e=s.replace(/^\//,"");if(/^github:/.test(e))return e;if("none"!==e)return"/reference/"+e}else if(t.pkg&&!e.appTarget.bundledpkgs[t.pkg]){let e=t.qName.toLowerCase().split(".");return e[0]==t.pkg&&e.shift(),`/pkg/${t.pkg}#${encodeURIComponent(e.join("-"))}`}},t.reporterTypeForArgType=function(e){let t="argument_reporter_custom";return"boolean"!==e&&"number"!==e&&"string"!==e||(t=`argument_reporter_${e}`),/^(?:Array<(?:.+)>)|(?:(?:.+)\[\])$/.test(e)&&(t="argument_reporter_array"),t},t.defaultIconForArgType=function(e=""){switch(e){case"number":return"calculator";case"string":return"text width";case"boolean":return"random";case"Array":return"list";default:return"align justify"}},t.parseFields=function(e){return e.split("|").map((e,t)=>{let n=/([^%]*)\s*%([a-zA-Z0-9_]+)/.exec(e);if(!n)return{n:e,ni:t};let i=n[1];return i&&(i=i.trim()),{n:e,ni:t,pre:i,p:n[2]}})},t.blockDefinitions=function(){return i||r(),i},t.getBlockDefinition=function(e){return i||r(),i[e]},t.initInContextTranslationAsync=async function(){i||r();const t={};return await Promise.all(e.Util.values(i).filter(e=>e.block).map(async n=>{const i=Object.keys(n.block);n.translationIds=e.Util.values(n.block),await Promise.all(i.map(async i=>{const r=await e.crowdin.inContextLoadAsync(n.block[i]);n.block[i]=r,/^[A-Z_]+$/.test(i)&&(t[i]=r)}))})),t}}(e.blocks||(e.blocks={}))}(pxt||(pxt={})),function(e){!function(t){function n(){return"undefined"!=typeof navigator}function i(){return n()&&/(Win32|Win64|WOW64)/i.test(navigator.platform)}function r(){return n()&&/mobi/i.test(navigator.userAgent)}function s(){return n()&&/Mac/i.test(navigator.platform)}function o(){return!!navigator&&/Linux/i.test(navigator.platform)}function a(){return n()&&/arm/i.test(navigator.platform)}function l(){return n()&&/Edge/i.test(navigator.userAgent)}function c(){return n()&&/Trident/i.test(navigator.userAgent)}function u(){return!l()&&!c()&&!!navigator&&(/Chrome/i.test(navigator.userAgent)||/Chromium/i.test(navigator.userAgent))}function d(){return!u()&&!l()&&!!navigator&&/(Macintosh|Safari|iPod|iPhone|iPad)/i.test(navigator.userAgent)}function p(){return!d()&&!!navigator&&(/Firefox/i.test(navigator.userAgent)||/Seamonkey/i.test(navigator.userAgent))}function h(){return n()&&/Opera|OPR/i.test(navigator.userAgent)}function f(){return n()&&/Midori/i.test(navigator.userAgent)}function m(){return n()&&/Epiphany/i.test(navigator.userAgent)}function g(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&navigator.maxTouchPoints>0)}function _(){return"undefined"!=typeof window&&!!window.pxtElectron}function y(){return"undefined"!=typeof window&&!!window.ipcRenderer}function b(){return _()||y()}function v(t){var n;try{return"undefined"!=typeof window&&/^https?:\/\/(?:localhost|127\.0\.0\.1|192\.168\.\d{1,3}\.\d{1,3}|[a-zA-Z0-9.-]+\.local):\d+\/?/.test(window.location.href)&&(t||!/nolocalhost=1/.test(window.location.href))&&!(null===(n=null==e?void 0:e.webConfig)||void 0===n?void 0:n.isStatic)}catch(e){return!1}}function T(){return"undefined"!=typeof window&&!!window.PointerEvent}function k(){return i()?"windows":s()?"mac":o()&&a()?"rpi":o()?"linux":"unknown"}function x(){return l()?"edge":m()?"epiphany":f()?"midori":h()?"opera":c()?"ie":u()?"chrome":d()?"safari":p()?"firefox":"unknown"}function E(){if(!n())return null;let e=[];return h()&&(e=/(Opera|OPR)\/([0-9\.]+)/i.exec(navigator.userAgent)),m()?e=/Epiphany\/([0-9\.]+)/i.exec(navigator.userAgent):f()?e=/Midori\/([0-9\.]+)/i.exec(navigator.userAgent):d()?(e=/Version\/([0-9\.]+)/i.exec(navigator.userAgent),e||(e=/(Macintosh|iPod( touch)?|iPhone|iPad); (CPU|Intel).*?OS (X )?(\d+)/i.exec(navigator.userAgent))):e=u()?/(Chrome|Chromium)\/([0-9\.]+)/i.exec(navigator.userAgent):l()?/Edge\/([0-9\.]+)/i.exec(navigator.userAgent):c()?/(MSIE |rv:)([0-9\.]+)/i.exec(navigator.userAgent):/(Firefox|Seamonkey)\/([0-9\.]+)/i.exec(navigator.userAgent),e&&0!=e.length?e[e.length-1]:null}t.isDocumentVisible=function(){return"undefined"!=typeof window&&"visible"===document.visibilityState},t.isIFrame=function(){try{return window&&window.self!==window.top}catch(e){return!0}},t.hasNavigator=n,t.hasWindow=function(){return"undefined"!=typeof window},t.isWindows=i,t.isWindows10=function(){return n()&&/(Win32|Win64|WOW64)/i.test(navigator.platform)&&/Windows NT 10/i.test(navigator.userAgent)},t.isMobile=r,t.isIOS=function(){return n()&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)},t.isAndroid=function(){return n()&&/android/i.test(navigator.userAgent)},t.isMac=s,t.isLinux=o,t.isARM=a,t.isEdge=l,t.isChromiumEdge=function(){return n()&&/Edg\//i.test(navigator.userAgent)},t.isIE=c,t.isChrome=u,t.isSafari=d,t.isFirefox=p,t.isOpera=h,t.isMidori=f,t.isEpiphany=m,t.isTouchEnabled=g,t.isPxtElectron=_,t.isIpcRenderer=y,t.isElectron=b,t.isWinRT=()=>"undefined"!=typeof Windows,t.isLocalHost=v,t.isLocalHostDev=function(){return v()&&!b()},t.isSkillmapEditor=function(){try{return/skill(?:s?)map=1/i.test(window.location.href)}catch(e){return!1}},t.isTabletSize=function(){return(null===window||void 0===window?void 0:window.innerWidth)<=e.BREAKPOINT_TABLET},t.isComputerSize=function(){return(null===window||void 0===window?void 0:window.innerWidth)>e.BREAKPOINT_TABLET},t.isInGame=function(){return!!/inGame=1/i.exec(window.location.href)},t.hasFileAccess=function(){const t=e.appTarget.appTheme.disableFileAccessinMaciOs&&(e.BrowserUtils.isMac()||e.BrowserUtils.isIOS()),n=e.appTarget.appTheme.disableFileAccessinAndroid&&e.BrowserUtils.isAndroid();return!t&&!n},t.noSharedLocalStorage=function(){try{return/nosharedlocalstorage/i.test(window.location.href)}catch(e){return!1}},t.useOldTutorialLayout=function(){var t,n;if(null===(n=null===(t=e.appTarget)||void 0===t?void 0:t.appTheme)||void 0===n?void 0:n.legacyTutorial)return!0;try{return/tutorialview=old/.test(window.location.href)}catch(e){return!1}},t.hasPointerEvents=T,t.os=k,t.browser=x,t.browserVersion=E;let S=!1;function C(){return r()&&d()&&!/downloadWindowOpen=0/i.test(window.location.href)}function w(t,n,i){const s=C(),o=E(),a=parseInt(o||"0");if(s)i?i.location.href=t:window.open(t,"_self");else if(e.BrowserUtils.isSafari()&&(a<10||0==o.indexOf("10.0")||r())){let n=document.getElementById("downloader");n||(e.debug("injecting downloader iframe"),n=document.createElement("iframe"),n.id="downloader",n.style.position="absolute",n.style.right="0",n.style.bottom="0",n.style.zIndex="-1",n.style.width="1px",n.style.height="1px",document.body.appendChild(n)),n.src=t}else if(/^data:/i.test(t)&&(e.BrowserUtils.isEdge()||e.BrowserUtils.isIE())){let i=atob(t.split(",")[1]),r=e.Util.stringToUint8Array(i),s=new Blob([r],{type:"img/png"});window.navigator.msSaveOrOpenBlob(s,n)}else{let e=window.document.createElement("a");"string"==typeof e.download?(e.href=t,e.download=n,document.body.appendChild(e),e.click(),document.body.removeChild(e)):document.location.href=t}}function I(t,n){let i="data";r()&&d()&&e.appTarget.appTheme.mobileSafariDownloadProtocol&&(i=e.appTarget.appTheme.mobileSafariDownloadProtocol);const s=/downloadProtocol=([a-z0-9:/?]+)/i.exec(window.location.href);s&&(i=s[1]);return i+":"+n+";base64,"+t}function A(t,n,i={}){var r;e.debug("trigger download");const{contentType:s="application/octet-stream",userContextWindow:o,onError:a,maintainObjectURL:l}=i,c=null===(r=window.URL)||void 0===r?void 0:r.createObjectURL,u=e.appTarget.appTheme.disableBlobObjectDownload;let d;try{if(c&&!u){const i=c(new Blob([e.Util.stringToUint8Array(atob(t))],{type:s}));w(i,n,o),l?d=i:window.setTimeout(()=>window.URL.revokeObjectURL(d),0)}else d=I(t,n),w(d,n,o)}catch(t){a&&a(t),e.debug("saving failed")}return d}function N(e){const t=document.createElement("img");return new Promise((n,i)=>{t.onload=()=>n(t),t.onerror=()=>n(void 0),t.crossOrigin="anonymous",t.src=e})}t.isBrowserSupported=function(){var t,n;if(!navigator)return!0;if(/bot|crawler|spider|crawling/i.test(navigator.userAgent))return!0;const i=(null===(t=e.appTarget)||void 0===t?void 0:t.unsupportedBrowsers)||(null===(n=window.pxtTargetBundle)||void 0===n?void 0:n.unsupportedBrowsers);if(null==i?void 0:i.some(e=>e.id==x()))return!1;const r=E(),s=parseInt(r||"0"),c=u()&&s>=38,g=p()&&s>=31,_=l(),y=d()&&s>=9,b=h()&&u()&&s>=21;let v=c||g||_||y||b;const T=f()||o()&&a()&&m();return v=v&&!T,v=v||/anybrowser=(true|1)/.test(window.location.href),S||(e.log(`Browser: ${x()} ${r} on ${k()}`),v||e.tickEvent("browser.unsupported",{useragent:navigator.userAgent}),S=!0),v},t.devicePixelRatio=function(){if("undefined"==typeof window||!window.screen)return 1;const e=window.screen.systemXDPI,t=window.screen.logicalXDPI;return void 0!==e&&void 0!==t&&e>t?e/t:window&&void 0!==window.devicePixelRatio?window.devicePixelRatio:1},t.browserDownloadBinText=function(e,t,n){return A(ts.pxtc.encodeBase64(e),t,n)},t.browserDownloadText=function(t,n,i){return A(ts.pxtc.encodeBase64(e.Util.toUTF8(t)),n,i)},t.isBrowserDownloadInSameWindow=C,t.isBrowserDownloadWithinUserContext=function(){const e=E(),t=parseInt(e||"0");return r()&&d()&&t>=11||/downloadUserContext=1/i.test(window.location.href)},t.browserDownloadDataUri=w,t.browserDownloadUInt8Array=function(t,n,i){return A(ts.pxtc.encodeBase64(e.Util.uint8ArrayToString(t)),n,i)},t.toDownloadDataUri=I,t.browserDownloadBase64=A,t.loadImageAsync=N,t.loadCanvasAsync=function(e){return N(e).then(e=>{const t=document.createElement("canvas");t.width=e.width,t.height=e.height;return t.getContext("2d").drawImage(e,0,0),t})},t.scaleImageData=function(e,t){const n=document.createElement("canvas"),i=document.createElement("canvas");n.width=e.width,n.height=e.height,i.width=e.width*t,i.height=e.height*t;const r=n.getContext("2d"),s=i.getContext("2d");return r.putImageData(e,0,0),s.imageSmoothingEnabled=!1,s.scale(t,t),s.drawImage(n,0,0),s.getImageData(0,0,e.width*t,e.height*t)},t.imageDataToPNG=function(e,t=1){if(!e)return;const n=document.createElement("canvas"),i=document.createElement("canvas");n.width=e.width,n.height=e.height,i.width=e.width*t,i.height=e.height*t;const r=n.getContext("2d"),s=i.getContext("2d");return r.putImageData(e,0,0),s.imageSmoothingEnabled=!1,s.scale(t,t),s.drawImage(n,0,0),i.toDataURL("image/png")};const D=1e7;function O(t){if(/^https?:\/\//i.test(t))return t;const n=(window.MonacoPaths||{})[t];return n||(e.U.startsWith(t,e.webConfig.commitCdnUrl)?t:e.webConfig.commitCdnUrl+t)}t.encodeToPngAsync=function(t,n){const{width:i,height:r,pixelDensity:s=4,maxSize:o=D,text:a}=n||{};return new Promise((n,l)=>{const c=new Image;c.onload=function(){const t=document.createElement("canvas"),l=t.getContext("2d");t.width=(i||c.width)*s,t.height=(r||c.height)*s,a&&(l.fillStyle="#fff",l.fillRect(0,0,t.width,t.height)),l.drawImage(c,0,0,i,r,0,0,t.width,t.height);let u=t.toDataURL("image/png");for(;u.length>o;)t.width=t.width/2|0,t.height=t.height/2|0,e.debug(`screenshot size ${u.length}b, shrinking to ${t.width}x${t.height}`),l.drawImage(c,0,0,i,r,0,0,t.width,t.height),u=t.toDataURL("image/png");if(a){e.lzmaCompressAsync(a).then(i=>{const r=e.Util.encodeBlobAsync(t,i);n(r.toDataURL("image/png"))})}else n(u)},c.onerror=t=>{e.reportError("png","png rendering failed"),n(void 0)};try{const e=new URL(t);"http:"!==e.protocol&&"https:"!==e.protocol||e.host===window.location.host||c.setAttribute("crossOrigin","anonymous")}catch(e){}c.src=t})},t.resolveCdnUrl=O,t.loadStyleAsync=function(t,n){n&&(t="rtl"+t);const i="style-"+t;if(document.getElementById(i))return Promise.resolve();const r=O(t),s=e.Util.toArray(document.head.getElementsByTagName("link")).filter(e=>e.getAttribute("href")==r)[0];return s?(s.id||(s.id=i),Promise.resolve()):new Promise((e,t)=>{const n=document.createElement("link");n.href=r,n.rel="stylesheet",n.type="text/css",n.id=i,n.addEventListener("load",()=>e()),n.addEventListener("error",e=>t(e)),document.head.appendChild(n)})};let R,L,P,M={};function F(e,t){if(!e)return t;if(!t)return e;return(e.indexOf("/")==e.length-1?e.substring(0,e.length-1):e)+"/"+(0==t.indexOf("/")?t.substring(1):t)}function B(){const e=n()&&window.navigator;return e&&e.storage&&e.storage.estimate?e.storage.estimate():Promise.resolve({})}t.loadScriptAsync=function(t){const n=O(t);let i=M[n];return i||(i=M[n]=new Promise((t,i)=>{e.debug(`script: loading ${n}`);const r=document.createElement("script");r.type="text/javascript",r.addEventListener("load",()=>t()),r.addEventListener("error",e=>{delete M[n],i(e)}),r.src=n,r.async=!0,document.body.appendChild(r)})),i},t.loadAjaxAsync=function(e){return new Promise((t,n)=>{let i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&(200==i.status?t(i.responseText):n(i.status))},i.open("GET",e,!0),i.send()})},t.loadBlocklyAsync=function(){if(!R){e.debug("blockly: delay load");let t=e.BrowserUtils.loadStyleAsync("blockly.css",ts.pxtc.Util.isUserLanguageRtl());t=t.then(()=>{e.debug("blockly: loaded")}),R=t}return R},t.patchCdn=function(t){if(!t)return t;const n=e.getOnlineCdnUrl();return n?t.replace("@cdnUrl@",n):t.replace(/@cdnUrl@\/(blob|commit)\/[a-f0-9]{40}\//,"./")},t.initTheme=function(){const t=e.appTarget.appTheme;if(t&&t.accentColor){let e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(`.ui.accent { color: ${t.accentColor}; }\n                .ui.inverted.menu .accent.active.item, .ui.inverted.accent.menu  { background-color: ${t.accentColor}; }`)),document.getElementsByTagName("head")[0].appendChild(e)}if(e.Util.isUserLanguageRtl()){e.debug("rtl layout"),e.BrowserUtils.addClass(document.body,"rtl"),document.body.style.direction="rtl";const t=e.Util.toArray(document.head.getElementsByTagName("link")),n=t.filter(t=>e.Util.endsWith(t.getAttribute("href"),"semantic.css"))[0];if(n){const t=n.getAttribute("data-rtl");t&&(e.debug(`swapping to ${t}`),n.setAttribute("href",t))}const i=t.filter(t=>e.Util.endsWith(t.getAttribute("href"),"blockly.css"))[0];if(i){const t=i.getAttribute("data-rtl");t&&(e.debug(`swapping to ${t}`),i.setAttribute("href",t),i.removeAttribute("data-rtl"))}}},t.changeHash=function(e,t){"#"!=e.charAt(0)&&(e="#"+e),t?window.location.hash=e:window.history.replaceState("","",e)},t.urlJoin=F,t.joinURLs=function(...e){let t;if(e)for(let n=0;n<e.length;n++)t=F(t,e[n]);return t},t.storageEstimateAsync=B,t.scheduleStorageCleanup=n()&&navigator.storage&&navigator.storage.estimate?ts.pxtc.Util.throttle(function(){B().then(t=>(e.debug(`storage estimate: ${t.usage/t.quota*100|0}%, ${t.usage/1e6|0}/${t.quota/1e6|0}Mb`),t.quota&&t.usage&&t.quota>1e6&&t.usage/t.quota>.9?(e.log("quota usage exceeded, clearing translations"),e.tickEvent("storage.cleanup"),j()):Promise.resolve())).catch(t=>{e.reportException(t)})},1e4,!1):()=>{},t.stressTranslationsAsync=function t(){let n="...";for(let e=0;e<16;++e)n+=n+Math.random();return e.log(`adding entry ${2*n.length} bytes`),e.U.delay(1).then(()=>G()).then(e=>e.setAsync("foobar",Math.random().toString(),null,void 0,n)).then(()=>e.BrowserUtils.storageEstimateAsync()).then(e=>!e.quota||e.usage/e.quota<.8?t():Promise.resolve())};class ${constructor(){this.translations={}}key(e,t){return`${e}|${t}|master`}get(e,t){return this.translations[this.key(e,t)]}getAsync(e,t){return Promise.resolve(this.get(e,t))}set(e,t,n,i,r,s){this.translations[this.key(e,t)]={etag:n,time:i,strings:r,md:s}}setAsync(t,n,i,r,s){return this.set(t,n,i,e.Util.now(),r),Promise.resolve()}clearAsync(){return this.translations={},Promise.resolve()}}class U{constructor(e,t,n,i,r=!1){this.name=e,this.version=t,this.upgradeHandler=n,this.quotaExceededHandler=i,this.skipErrorLog=r}throwIfNotOpened(){if(!this._db)throw new Error("Database not opened; call IDBWrapper.openAsync() first")}errorHandler(t,n,i){this.skipErrorLog?i(t):(e.error(new Error(`${this.name} IDBWrapper error for ${n}: ${t.message}`)),i(t),"QuotaExceededError"==t.name&&(e.log("storage quota exceeded..."),e.tickEvent("storage.quotaexceedederror"),this.quotaExceededHandler&&this.quotaExceededHandler()))}getObjectStore(e,t="readonly"){this.throwIfNotOpened();return this._db.transaction([e],t).objectStore(e)}static deleteDatabaseAsync(e){return new Promise((t,n)=>{const i=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).deleteDatabase(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)})}openAsync(){return new Promise((e,t)=>{const n=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open(this.name,this.version);n.onsuccess=()=>{this._db=n.result,e()},n.onerror=()=>this.errorHandler(n.error,"open",t),n.onupgradeneeded=e=>this.upgradeHandler(e,n)})}getAsync(e,t){return new Promise((n,i)=>{const r=this.getObjectStore(e).get(t);r.onsuccess=()=>n(r.result),r.onerror=()=>this.errorHandler(r.error,"get",i)})}getAllAsync(e){return new Promise((t,n)=>{const i=this.getObjectStore(e).openCursor(),r=[];i.onsuccess=()=>{i.result?(r.push(i.result.value),i.result.continue()):t(r)},i.onerror=()=>this.errorHandler(i.error,"getAll",n)})}setAsync(e,t){return new Promise((n,i)=>{const r=this.getObjectStore(e,"readwrite");let s;s=void 0!==t.id&&null!==t.id?r.put(t):r.add(t),s.onsuccess=()=>n(),s.onerror=()=>this.errorHandler(s.error,"set",i)})}deleteAsync(e,t){return new Promise((n,i)=>{const r=this.getObjectStore(e,"readwrite").delete(t);r.onsuccess=()=>n(),r.onerror=()=>this.errorHandler(r.error,"delete",i)})}deleteAllAsync(e){return new Promise((t,n)=>{const i=this.getObjectStore(e,"readwrite").clear();i.onsuccess=()=>t(),i.onerror=()=>this.errorHandler(i.error,"deleteAll",n)})}getObjectStoreWrapper(e){return new V(this,e)}}t.IDBWrapper=U;class V{constructor(e,t){this.db=e,this.storeName=t}getAsync(e){return this.db.getAsync(this.storeName,e)}getAllAsync(){return this.db.getAllAsync(this.storeName)}setAsync(e){return this.db.setAsync(this.storeName,e)}async deleteAsync(e){await this.db.deleteAsync(this.storeName,e)}async deleteAllAsync(){await this.db.deleteAllAsync(this.storeName)}}t.IDBObjectStoreWrapper=V;class H{constructor(e){this.db=e,this.mem=new $}static dbName(){return`__pxt_translations_${e.appTarget.id||""}`}static createAsync(){function t(){const e=new U(H.dbName(),2,(e,t)=>{t.result.createObjectStore(H.TABLE,{keyPath:H.KEYPATH})},()=>{j().catch(e=>{})});return e.openAsync().then(()=>new H(e))}return t().catch(n=>(e.log("db: failed to open database, try delete entire store..."),U.deleteDatabaseAsync(H.dbName()).then(()=>t())))}getAsync(e,t){e=(e||"en-US").toLowerCase();const n=this.mem.key(e,t),i=this.mem.get(e,t);return i?Promise.resolve(i):this.db.getAsync(H.TABLE,n).then(n=>n?(this.mem.set(e,t,n.etag,n.time,n.strings),Promise.resolve(n)):Promise.resolve(void 0)).catch(e=>Promise.resolve(void 0))}setAsync(n,i,r,s,o){n=(n||"en-US").toLowerCase();const a=this.mem.key(n,i);let l=e.Util.now();this.mem.set(n,i,r,l,s,o),s&&Object.keys(s).filter(e=>!s[e]).forEach(e=>delete s[e]);const c={id:a,etag:r,time:l,strings:s,md:o};return this.db.setAsync(H.TABLE,c).finally(()=>t.scheduleStorageCleanup()).catch(t=>(e.log(`db: set failed (${t.message}), recycling...`),this.clearAsync()))}clearAsync(){return this.db.deleteAllAsync(H.TABLE).then(()=>e.debug("db: all clean")).catch(t=>{e.error("db: failed to delete all")})}}function G(){return e.Util.isNodeJS?Promise.resolve(new $):(L||(L=H.createAsync().catch(()=>new $)),L)}function j(){function t(){const t=H.dbName();return U.deleteDatabaseAsync(t).then(()=>{L=void 0}).catch(n=>{e.log(`db: failed to delete ${t}`),L=void 0})}return L?L.then(e=>e.clearAsync()).catch(e=>t().then()):t()}function K(t){const n=JSON.stringify(t)+e.appTarget.versions.pxt+"_"+e.appTarget.versions.target;return pxtc.U.sha256(n)}function z(e,t){return`${e}|${t||"master"}`}H.TABLE="files",H.KEYPATH="id",t.translationDbAsync=G,t.clearTranslationDbAsync=j,t.getTutorialCodeHash=K;class W{constructor(e){this.db=e}static dbName(){return`__pxt_tutorialinfo_${e.appTarget.id||""}`}static createAsync(){function t(){const t=new e.BrowserUtils.IDBWrapper(W.dbName(),2,(e,t)=>{t.result.createObjectStore(W.TABLE,{keyPath:W.KEYPATH})},()=>{e.BrowserUtils.IDBWrapper.deleteDatabaseAsync(W.dbName())});return t.openAsync().then(()=>new W(t))}return t().catch(n=>(e.log("db: failed to open tutorial info database, try delete entire store..."),e.BrowserUtils.IDBWrapper.deleteDatabaseAsync(W.dbName()).then(()=>t())))}getAsync(t,n,i){const r=z(t,i),s=K(n);return this.db.getAsync(W.TABLE,r).then(t=>{if(t&&t.hash==s&&e.Util.now()-(t.time||0)<864e5)return t;this.db.deleteAsync(W.TABLE,r)})}setAsync(t,n,i,r,s,o){e.perf.measureStart(Measurements.TutorialInfoDbSetAsync);z(t,o);const a=K(i);return this.setWithHashAsync(t,n,a,r,s)}setWithHashAsync(t,n,i,r,s,o){e.perf.measureStart(Measurements.TutorialInfoDbSetAsync);const a=z(t,o),l={};Object.keys(n).forEach(e=>{Object.keys(n[e]).forEach(t=>{l[t]=n[e][t]})});const c={id:a,time:e.Util.now(),hash:i,snippets:n,blocks:l,highlightBlocks:r,validateBlocks:s};return this.db.setAsync(W.TABLE,c).then(()=>{e.perf.measureEnd(Measurements.TutorialInfoDbSetAsync)})}clearAsync(){return this.db.deleteAllAsync(W.TABLE).then(()=>e.debug("db: all clean")).catch(t=>{e.error("db: failed to delete all")})}}function q(e){return e.split(/\s+/).filter(e=>!!e)}function J(){const t=new RegExp(`${e.Util.escapeForRegex(e.Util.pxtLangCookieId)}=(.*?)(?:;|$)`).exec(document.cookie);return t&&t[1]||null}W.TABLE="info",W.KEYPATH="id",t.tutorialInfoDbAsync=function(){return P||(P=W.createAsync()),P},t.clearTutorialInfoDbAsync=function(){function t(){const t=W.dbName();return U.deleteDatabaseAsync(t).then(()=>{P=void 0}).catch(n=>{e.log(`db: failed to delete ${t}`),P=void 0})}return P?P.then(e=>e.clearAsync()).catch(e=>t().then()):t()},t.pointerEvents=T()?{up:"pointerup",down:["pointerdown"],move:"pointermove",enter:"pointerenter",leave:"pointerleave"}:g()?{up:"mouseup",down:["mousedown","touchstart"],move:"touchmove",enter:"touchenter",leave:"touchend"}:{up:"mouseup",down:["mousedown"],move:"mousemove",enter:"mouseenter",leave:"mouseleave"},t.getPageX=function(e){return"pageX"in e?e.pageX:e.changedTouches[0].pageX},t.getPageY=function(e){return"pageY"in e?e.pageY:e.changedTouches[0].pageY},t.getClientX=function(e){return"clientX"in e?e.clientX:e.changedTouches[0].clientX},t.getClientY=function(e){return"clientY"in e?e.clientY:e.changedTouches[0].clientY},t.popupWindow=function(t,n,i,r){try{const s=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c="width="+i+", height="+r+", top="+(l/2-r/2+o)+", left="+(a/2-i/2+s),u=window.open(t,n,e.BrowserUtils.isIpcRenderer()?void 0:c);return u.focus&&u.focus(),u}catch(t){return e.tickEvent("pxt.popupError",{msg:t.message}),null}},t.containsClass=function(e,t){return q(t).every(t=>function(e,t){if(e.classList)return e.classList.contains(t);return!((e.className+"").split(/\s+/).indexOf(t)<0)}(e,t))},t.addClass=function(e,t){q(t).forEach(t=>function(e,t){if(e.classList)e.classList.add(t);else{(e.className+"").split(/\s+/).indexOf(t)<0&&(e.className.baseVal+=" "+t)}}(e,t))},t.removeClass=function(e,t){q(t).forEach(t=>function(e,t){e.classList?e.classList.remove(t):e.className.baseVal=(e.className+"").split(/\s+/).filter(e=>e!=t).join(" ")}(e,t))},t.getCookieLang=J,t.setCookieLang=function(t,n=!1){if(e.Util.allLanguages[t]&&t!==J()){e.tickEvent("menu.lang.setcookielang",{lang:t,docs:`${n}`});const i=new Date;i.setTime(i.getTime()+24*e.Util.langCookieExpirationDays*60*60*1e3),document.cookie=`${e.Util.pxtLangCookieId}=${t}; expires=${i.toUTCString()}; path=/`}},t.cacheBustingUrl=function(e){return e?/[?&]rnd=/.test(e)?e:`${e}${e.indexOf("?")>0?"&":"?"}rnd=${Math.random()}`:e},t.appendUrlQueryParams=function(e,t){const n=[];for(const[e,i]of t.entries())n.push(`${encodeURIComponent(e)}=${encodeURIComponent(i)}`);return n.length&&(-1!==e.indexOf("?")?e+="&"+n.join("&"):e+="?"+n.join("&")),e},t.legacyCopyText=function(t){t.focus(),t.setSelectionRange(0,9999);try{const t=document.execCommand("copy");return e.debug("copy: "+t),!!t}catch(e){return!1}},t.setApplicationTheme=function(e){const t=document.body,n=t.classList;for(let e=0;e<n.length;e++)/^theme-/.test(n[e])&&t.classList.remove(n[e]);e&&t.classList.add(`theme-${e}`)},t.isElement=function(e){return e.nodeType===Node.ELEMENT_NODE}}(e.BrowserUtils||(e.BrowserUtils={}))}(pxt||(pxt={})),function(e){!function(e){const t="https://staging.pxt.io";e.DEV_BACKEND=t,e.DEV_REGION="US",e.devBackendType=function(){return"https://makecode.com"===e.DEV_BACKEND?"prod":e.DEV_BACKEND===t?"staging":"http://localhost:8080"===e.DEV_BACKEND?"localhost":"prod"},e.cloudStatus={none:{value:"none"},synced:{value:"synced",icon:"cloud-saved-b",tooltip:lf("Project saved to cloud"),shortStatus:lf("saved"),longStatus:lf("Saved to cloud"),indicator:""},justSynced:{value:"justSynced",icon:"cloud-saved-b",tooltip:lf("Project saved to cloud"),shortStatus:lf("saved!"),longStatus:lf("Saved to cloud!"),indicator:""},offline:{value:"offline",icon:"cloud-error-b",tooltip:lf("Unable to connect to cloud"),shortStatus:lf("offline"),longStatus:lf("Offline"),indicator:lf("offline")},syncing:{value:"syncing",icon:"cloud-saving-b",tooltip:lf("Saving project to cloud..."),shortStatus:lf("saving..."),longStatus:lf("Saving to cloud..."),indicator:lf("syncing...")},conflict:{value:"conflict",icon:"cloud-error-b",tooltip:lf("Project was edited in two places and the changes conflict"),shortStatus:lf("conflict!"),longStatus:lf("Project has a conflict!"),indicator:"!"},localEdits:{value:"localEdits",icon:"cloud-saving-b",tooltip:lf("Project has local changes and will save to cloud soon."),shortStatus:"",longStatus:"",indicator:"*"}}}(e.cloud||(e.cloud={}))}(pxt||(pxt={})),function(e){!function(e){let t;!function(e){e[e.Failed=0]="Failed",e[e.Success=1]="Success",e[e.UserRejected=2]="UserRejected"}(t=e.WebUSBPairResult||(e.WebUSBPairResult={})),e.deployCoreAsync=void 0,e.deployFallbackAsync=void 0,e.hasDeployFn=()=>e.deployCoreAsync||e.deployFallbackAsync,e.deployAsync=(t,n)=>(e.deployCoreAsync||e.deployFallbackAsync)(t,n),e.patchCompileResultAsync=void 0,e.browserDownloadAsync=void 0,e.saveOnlyAsync=void 0,e.renderBrowserDownloadInstructions=void 0,e.renderUsbPairDialog=void 0,e.renderIncompatibleHardwareDialog=void 0,e.showUploadInstructionsAsync=void 0,e.saveProjectAsync=void 0,e.electronDeployAsync=void 0,e.electronFileDeployAsync=void 0,e.webUsbPairDialogAsync=void 0,e.onTutorialCompleted=void 0,e.perfMeasurementThresholdMs=void 0,e.onPerfMilestone=void 0,e.onPerfMeasurement=void 0,e.workspaceLoadedAsync=void 0,e.getDownloadMenuItems=void 0,e.notifyProjectCompiled=void 0,e.notifyProjectSaved=void 0,e.onDownloadButtonClick=void 0,e.getDefaultProjectName=void 0,e.onMarkdownActivityLoad=void 0}(e.commands||(e.commands={}))}(pxt||(pxt={})),function(e){function t(t){const n=e.toolbox.convertColor(t),i=parseInt(n.slice(1,3),16)/255,r=parseInt(n.slice(3,5),16)/255,s=parseInt(n.slice(5,7),16)/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))}function n(e,n){return(t(e)+.05)/(t(n)+.05)}function i(e){const t=(1-Math.abs(2*e.l-1))*e.s,n=e.h/60,i=t*(1-Math.abs(n%2-1));let s;void 0===e.h?s=[0,0,0]:n<=1?s=[t,i,0]:n<=2?s=[i,t,0]:n<=3?s=[0,t,i]:n<=4?s=[0,i,t]:n<=5?s=[i,0,t]:n<=6&&(s=[t,0,i]);let o=e.l-.5*t;return a=Math.round(255*(s[0]+o)),l=Math.round(255*(s[1]+o)),c=Math.round(255*(s[2]+o)),"#"+r(a)+r(l)+r(c);var a,l,c}function r(e){return("0"+e.toString(16)).slice(-2)}e.getWhiteContrastingBackground=function(t){if(n("#ffffff",t)>=4.5)return t;const r=function(t){const n=e.toolbox.convertColor(t),i=parseInt(n.slice(1,3),16)/255,r=parseInt(n.slice(3,5),16)/255,s=parseInt(n.slice(5,7),16)/255,o=Math.max(Math.max(i,r),s),a=Math.min(Math.min(i,r),s),l=o-a;let c;0===l?c=0:o===i?c=((r-s)/l%6+6)%6:o===r?c=(s-i)/l+2:o===s&&(c=(i-r)/l+4);let u=(a+o)/2,d=0===l?0:l/(1-Math.abs(2*u-1));return{h:60*c,s:d,l:u}}(t);let s=r.l-.05;for(;s>0;){const e=i({h:r.h,s:r.s,l:s});if(n("#ffffff",e)>=4.5)return e;s-=.05}return e.warn(`Couldn't find a contrasting background for color ${t}`),t},e.contrastRatio=n}(pxt||(pxt={})),function(e){e.TutorialInfoDbSetAsync="tutorial info db setAsync",e.ReloadAppTargetVariant="reloadAppTargetVariant",e.Sha256Buffer="sha256buffer",e.WebworkerRecvHandler="webworker recvHandler",e.NetworkRequest="network.request"}(Measurements||(Measurements={})),function(e){function t(){let t;return t||(t=e.U.isNodeJS?Promise.resolve(require("lzma")):Promise.resolve(window.LZMA),t.then(t=>(t||e.reportError("lzma","failed to load"),t))),t}e.lzmaDecompressAsync=function(n){return t().then(t=>new Promise((i,r)=>{try{t.decompress(n,(t,n)=>{n&&e.debug("lzma decompression failed"),i(n?void 0:t)})}catch(t){t&&e.debug("lzma decompression failed"),i(void 0)}}))},e.lzmaCompressAsync=function(n){return t().then(t=>new Promise((i,r)=>{try{t.compress(n,7,(t,n)=>{n&&e.reportException(n),i(n?void 0:new Uint8Array(t))})}catch(t){e.reportException(t),i(void 0)}}))}}(pxt||(pxt={})),function(e){!function(t){var n=pxtc.Util;let i=n.lf;const r={"pxt::mkAction":1,"pxt::dumpPerfCounters":1,"pxt::deepSleep":1,"pxt::getConfig":1,"pxtrt::mkMap":1,"pxtrt::mapSet":1,"pxtrt::stclo":1,"pxtrt::mklocRef":1,"pxtrt::stlocRef":1,"pxtrt::ldlocRef":1,"pxtrt::panic":1};function s(e="namespace"){let t="",n="",i=(i,r="")=>{n!=i&&(n&&(t+="}\n"),i&&(t+=r||e+" "+i+" {\n"),n=i)},r="    ";return{setNs:i,clear:()=>{t="",n=""},write:e=>{e.trim()?(e=e.trim().replace(/^\s*/gm,r).replace(/^(\s*)\*/gm,(e,t)=>t+" *"),t+=e+"\n"):t+="\n"},incrIndent:()=>{r+="    "},decrIndent:()=>{r=r.slice(4)},finish:()=>(i(""),t)}}function o(e){if(!e)return null;e=e.trim();let t=/^\((.*)\)/.exec(e);return t&&(e=t[1]),/^-?(\d+|0[xX][0-9a-fA-F]+)$/.test(e)?parseInt(e):null}t.nsWriter=s,t.parseCppInt=o;let a={};class l extends Error{constructor(e){super(e),this.isUserError=!0,this.message=e}}function c(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){let i=255&e[n];t+=37==i||i>127?"%"+i.toString(16):String.fromCharCode(i)}return decodeURIComponent(t)}function u(t){let n="",i=0;for(;i<t.length;i+=2)n=t[i]+t[i+1]+n;return e.Util.assert(i==t.length),n}function d(e){let t=[65,20,14,47,184,47,162,187];e:for(let n=0;n<e.length;n+=16){if(e[n]!=t[0])continue;for(let i=0;i<t.length;++i)if(e[n+i]!=t[i])continue e;let i=e[n+8]|e[n+9]<<8,r=e[n+10]|e[n+11]<<8|e[n+12]<<16|e[n+13]<<24;n+=16;let s=n+i+r;if(s>e.length)continue;let o=e.slice(n,n+i),a=e.slice(n+i,s);return{meta:c(o),text:a}}return null}function p(t){function n(t){return e.debug(t),Promise.reject(new Error(t))}let i;if(e.HF2.read32(t,0)==ts.pxtc.UF2.UF2_MAGIC_START0){let e=ts.pxtc.UF2.toBin(t);e&&(i=d(e.buf))}if(1179403647==e.HF2.read32(t,0)&&(i=d(t)),58==t[0]){i=function(e){if(!e)return;let t,n=0,i=0,r=0,s=0;if(e.split(/\r?\n/).forEach(e=>{let o=/^:10....0[0E]41140E2FB82FA2BB(....)(....)(....)(....)(..)/.exec(e);if(o)n=parseInt(u(o[1]),16),i=parseInt(u(o[2]),16),r=n+i,t=new Uint8Array(r);else if(r>0){if(o=/^:10....0[0E](.*)(..)$/.exec(e),!o)return;let n=o[1];for(;r>0&&n.length>0;)t[s++]=parseInt(n[0]+n[1],16),n=n.slice(2),r--}}),!t||0!=r||s!=t.length)return;let o=new Uint8Array(n),a=new Uint8Array(i);for(let e=0;e<n;++e)o[e]=t[e];for(let e=0;e<i;++e)a[e]=t[n+e];return{meta:c(o),text:a}}(c(t)||"")}if(!i||!i.meta||!i.text)return n("This .hex file doesn't contain source.");let r=JSON.parse(i.meta);return r?"LZMA"==r.compression?e.lzmaDecompressAsync(i.text).then(t=>{if(!t)return null;let n=t.slice(0,r.headerSize||r.metaSize||0),i=t.slice(n.length);return n&&e.Util.jsonCopyFrom(r,JSON.parse(n)),{meta:r,source:i}}):r.compression?n(`Compression type ${r.compression} not supported.`):Promise.resolve({source:c(i.text)}):n("This .hex file is not valid.")}t.PkgConflictError=l,t.getExtensionInfo=function(t){const c={__appVariant:e.appTargetVariant||""},u="dal.d.ts";let d="/source/",p="",h=[];const f=t.sortedDeps(!0).sort((e,t)=>"this"==e.id?1:"this"==t.id?-1:n.strcmp(e.id,t.id));for(let t of f)t.disablesVariant(e.appTargetVariant)||t.resolvedDependencies().some(t=>t.disablesVariant(e.appTargetVariant))?(p&&(p+=", "),p+=t.id,e.debug(`disable variant ${e.appTargetVariant} due to ${t.id}`)):(h.push(t),t.addSnapshot(c,[u,".h",".cpp"]));const m=JSON.stringify(c),g=a[m];if(g){e.debug("Using cached extinfo");const t=n.flatClone(g);return t.disabledDeps=p,t}e.debug("Generating new extinfo");const _=pxtc.emptyExtInfo();_.disabledDeps=p;let y=e.appTarget.compileService;y||(y={gittag:"none",serviceId:"nocompile"}),y=n.clone(y);let b=t.getTargetOptions();b||(b={isNative:!1,hasHex:!1,switches:{}});const v=!!y.platformioIni,T="codal"==y.buildEngine||"dockercodal"==y.buildEngine,k="dockermake"==y.buildEngine||"dockercross"==y.buildEngine,x="dockerespidf"==y.buildEngine,E=!(v||T||k||x),S=b.nativeType==pxtc.NATIVE_TYPE_VM;v?d="/src/":T||k?d="/pxtapp/":x&&(d="/main/");let C="// Configuration defines\n",w="\nPXT_SHIMS_BEGIN\n",I="",A="",N='#include "pxt.h"\n',D="",O=e=>D+=`   ${L}(${R}): ${e}\n`,R=0,L="",P=s("namespace"),M=s("declare namespace"),F=s("declare namespace"),B="",$={},U={};const V={true:"1",false:"0",null:"0",NULL:"0"};function H(e){return e.trim().replace(/[\_\*]$/,"")}for(const t of h){if(t.getFiles().indexOf(u)>=0){const n=t.host().readFile(t,u);e.Util.assert(!!n,`${u} not found in ${t.id}`),n.split(/\r?\n/).forEach(e=>{let t=/^\s*(\w+) = (.*),/.exec(e);t&&(V[t[1]]=t[2])})}for(const e of t.getFiles())(["Makefile","sdkconfig.defaults","CMakeLists.txt"].indexOf(e)>=0||n.endsWith(e,".mk"))&&(_.generatedFiles["/"+e]=t.host().readFile(t,e))}let G=["0","false","PXT_UTF8"],j={};function K(e){return e.replace(/\/\/.*/,"").replace(/\/\*/,"")}b.switches.boxDebug&&(j.PXT_BOX_DEBUG=1),b.utf8&&(j.PXT_UTF8=1),b.switches.profile&&(j.PXT_PROFILE=1),b.switches.gcDebug&&(j.PXT_GC_DEBUG=1),b.switches.numFloat&&(j.PXT_USE_FLOAT=1),b.nativeType==pxtc.NATIVE_TYPE_VM&&(j.PXT_VM=1);let z=0,W=!1,q="",J="",Y="",X=!1;function Z(){M.setNs(""),M.write(""),M.write(""),(Y||J)&&(M.write(J),M.write(Y),Y="",J="")}function Q(e,t){let s;q="",J="",Y="",X=!1;let a=-1;function l(){let e=q.replace(/Methods$/,"");return e==q?null:e}function c(e){switch(e.replace(/\s+/g,"")){case"void":return"void";case"int32_t":case"int":return"int32";case"uint32_t":case"unsigned":return"uint32";case"TNumber":case"float":case"double":return"number";case"uint16_t":return"uint16";case"int16_t":case"short":return"int16";case"uint8_t":case"byte":return"uint8";case"int8_t":case"sbyte":return"int8";case"bool":return b.shortPointers&&O("use 'boolean' not 'bool' on 8 bit targets"),"boolean";case"StringData*":case"String":case"ImageLiteral_":case"ImageLiteral":return"string";case"Action":return"() => void";case"TValue":return"any";default:return H(e)}}function u(e){switch(e=e.replace(/\s+/g,"")){case"int32_t":case"uint32_t":case"unsigned":case"uint16_t":case"int16_t":case"short":case"uint8_t":case"byte":case"int8_t":case"sbyte":case"int":case"ramint_t":return"I";case"void":return"V";case"float":return"F";case"TNumber":return"N";case"TValue":case"ImageLiteral_":return"T";case"bool":return"B";case"double":return"D";case"String":return"S";default:return n.lookup($,e)?"I":"_"+e.replace(/[\*_]+$/,"")}}e=e.replace(/^(\s*#\s*if\s+(\w+)\s*$)([^]*?)(^\s*#\s*(elif|else|endif)\s*$)/gm,(e,t,n,i,r)=>G.indexOf(n)>=0&&!j[n]?t+i.replace(/[^\n]/g,"")+r:e),R=0,W=!1,z=0,F.setNs(""),M.setNs(""),e.split(/\r?\n/).forEach(e=>{++R;let d=K(e);!function(e){let t=K(e);if(W&&t.indexOf("}")>=0&&(W=!1,F.write("}")),!W)return;let i=/^\s*(\w+)\s*(=\s*(.*?))?,?\s*$/.exec(t);if(i){let e=i[1],r=i[3],s="";if(r){r=r.trim();let e=n.lookup(V,r);null!=e&&(s="  // "+r,r=e),z=o(r),null==z&&O("cannot determine value of "+t)}else z++,r=z+"";F.write(`    ${H(e)} = ${r},${s}`)}else F.write(e)}(e);let p=/^\s*enum\s+(|class\s+|struct\s+)(\w+)\s*({|$)/.exec(d);var h,f;if(p&&(h=p[2],f=p[3],W=!0,z=-1,F.write(""),F.write(""),(Y||J)&&(F.write(J),F.write(Y),Y="",J=""),F.write(`declare const enum ${H(h)} ${f}`),$[h]=!0,t||(P.setNs(q),P.write(`enum ${p[2]} : int;`))),function(e){return!(!W&&(/^\s*\/\*\*/.test(e)?(X=!0,J=e+"\n",/\*\//.test(e)&&(X=!1),0):X?(J+=e+"\n",/\*\//.test(e)&&(X=!1),0):!/^\s*\/\/%/.test(e)||(Y+=e+"\n",0)))}(e))return;/^typedef.*;\s*$/.test(e)&&(P.setNs(q),P.write(e));let m=/^\s*namespace\s+(\w+)/.exec(e);if(!m){if(m=/^PXT_ABI\((\w+)\)/.exec(e),m&&!S&&(w+=`PXT_FNPTR(::${m[1]}),\n`,A+=`extern "C" void ${m[1]}();\n`,_.functions.push({name:m[1],argsFmt:[],value:0})),m=/^\s*PXT_EXPORT\(([:\&\w]+)\)/.exec(e),m&&(_.vmPointers||(_.vmPointers=[]),_.vmPointers.push(m[1])),m=/^#define\s+PXT_COMM_BASE\s+([0-9a-fx]+)/.exec(e),m&&(_.commBase=parseInt(m[1])),m=/^\s*(\w+)([\*\&]*\s+[\*\&]*)(\w+)\s*\(([^\(\)]*)\)\s*(;\s*$|\{|$)/.exec(e),Y&&m){s=null;let e=pxtc.parseCommentString(Y);q||O("missing namespace declaration");let a=(m[1]+m[2]).replace(/\s+/g,""),d=m[3],p=m[4];Y=Y.trim().replace(/ \w+\.defl=\w+/g,"");let h=[u(a)],f=[],g=p.split(/,/).filter(e=>!!e).map(t=>{let i=function(e,t){t=t.trim();let i=/(.*)=\s*(-?\w+)$/.exec(t),r="",s="";if(i&&(r=i[2],s="?",t=i[1].trim()),i=/^(.*?)(\w+)$/.exec(t),!i)return O("invalid argument: "+t),{name:"???",type:"int"};let a=i[2];e.paramDefl[a]&&(r=e.paramDefl[a],s="?");let l=r?n.lookup(V,r):null;return null!=l&&(r=l),r&&(null==o(r)&&O("Invalid default value (non-integer): "+r),Y+=` ${a}.defl=${r}`),{name:a+s,type:i[1]}}(e,t);return h.push(u(i.type)),f.push(i.type.replace(/ /g,"")),`${i.name}: ${c(i.type)}`}),y={name:q+"::"+d,argsFmt:h,value:null};if(J)if(M.setNs(H(q)),M.write(""),M.write(J),/ImageLiteral/.test(m[4])&&!/imageLiteral=/.test(Y)&&(Y+=" imageLiteral=1"),Y+=` shim=${y.name}`,M.write(Y),d=H(d),l()){let e=(g[0]||"").replace(/^.*:\s*/,"").trim();e.toLowerCase()!=l().toLowerCase()&&O(i("Invalid first argument; should be of type '{0}', but is '{1}'",l(),e)),g.shift(),0==g.length&&/\bproperty\b/.test(Y)?M.write(`${d}: ${c(a)};`):M.write(`${d}(${g.join(", ")}): ${c(a)};`)}else M.write(`function ${d}(${g.join(", ")}): ${c(a)};`);if(J="",Y="",t||(P.setNs(q),P.write(`${a} ${d}(${p});`)),_.functions.push(y),E)w+="(uint32_t)(void*)::"+y.name+",\n";else if(S){if(n.startsWith(y.name,"pxt::op_")||r[y.name]||e.expose||!n.startsWith(y.name,"pxt::")&&!n.startsWith(y.name,"pxtrt::")){const e=function(e,t){if("FiberContext*"==t[0])return"::"+e.name;let n="_wrp_"+e.name.replace(/:/g,"_");if(U[e.name])return n;U[e.name]=!0,I+=`\nvoid ${n}(FiberContext *ctx) {\n`;const i=t.length;let r=[],s=!1,o="";for(let n=0;n<i;++n){const a=e.argsFmt[n+1],l=t[n];let c="I"==a?"toInt":"B"==a?"numops::toBool":"";const u=n==i-1?"ctx->r0":`ctx->sp[${i-n-2}]`;let d="";switch(l){case"TValue":case"TNumber":break;case"Action":c="asRefAction";break;case"String":c="convertToString",d="ctx, ",s=!0;break;default:c||(c="as"+l.replace(/\*/g,""))}o+=`  ${l} a${n} = (${l}) ${c}(${d}${u});\n`,r.push("a"+n)}s&&(I+="  auto prevSP = ctx->sp;\n"),I+=o,s&&(I+="  if (panicCode) { ctx->sp = prevSP; return; }\n");const a=`::${e.name}(${r.join(", ")})`;return"V"==e.argsFmt[0]?(I+=`  ${a};\n`,I+="  ctx->r0 = NULL;\n"):"I"==e.argsFmt[0]?I+=`  ctx->r0 = fromInt(${a});\n`:"B"==e.argsFmt[0]?I+=`  ctx->r0 = fromBool(${a});\n`:I+=`  ctx->r0 = (TValue)${a};\n`,s&&(I+="  ctx->sp = prevSP;\n"),i>1&&(I+=`  ctx->sp += ${i-1};\n`),I+="}\n",n}(y,f),t=y.argsFmt.length-1;w+=`{ "${y.name}", (OpFun)(void*)${e}, ${t} },\n`}}else w+="PXT_FNPTR(::"+y.name+"),\n";return}if(m=/^\s*extern const (\w+) (\w+);/.exec(e),Y&&m){let e={name:q+"::"+m[2],argsFmt:[],value:null};return _.functions.push(e),S||(w+="PXT_FNPTR(&::"+e.name+"),\n"),void(Y="")}if(m=/^\s*(\w+)\s+(\w+)\s*;/.exec(e),Y&&m){let e=pxtc.parseCommentString(Y);e.indexedInstanceNS&&(s=e,M.setNs(e.indexedInstanceNS),a=0);let t=m[1],n=m[2];if(s)return Y=Y.trim(),Y+=` fixedInstance shim=${s.indexedInstanceShim}(${a++})`,M.write(""),M.write(J),M.write(Y),M.write(`const ${n}: ${c(t)};`),J="",void(Y="")}return Y&&e.trim()?(O("declaration not understood: "+e),Y="",void(J="")):void 0}if(q=m[1],l()){Z();let e=l();M.setNs(q,`declare interface ${e} {`)}else(Y||J)&&(Z(),M.setNs(H(q)),F.setNs(H(q)))})}const ee=n.clone(y.yottaConfig||{}),te={},ne={},ie={};function re(t){const r=t.config.platformio;r&&r.dependencies&&n.jsonCopyFrom(_.platformio.dependencies,r.dependencies),_.npmDependencies&&t.config.npmDependencies&&n.jsonCopyFrom(_.npmDependencies,t.config.npmDependencies);const s=t.config.codal;if(T&&s)for(const t of s.libraries||[]){const r=e.github.parseRepoId(t);r||n.userError(i("codal library {0} doesn't look like github repo",t));const s=e.github.stringifyRepo(r),o=n.lookup(ie,r.project);o?e.github.stringifyRepo(o)!=s&&n.userError(i("conflict between codal libraries: {0} and {1}",e.github.stringifyRepo(o),s)):ie[r.project]=r}const o=t.config.yotta;if(o){if(o.dependencies&&n.jsonCopyFrom(_.yotta.dependencies,o.dependencies),o.config){const e=n.jsonFlatten(o.config);for(const r of Object.keys(e)){const s=n.lookup(ne,r),o=e[r];if(!s||s.config.yotta.configIsJustDefaults)ne[r]=t,ee[r]=o;else if(ee[r]===o);else if(!t.parent.config.yotta||!t.parent.config.yotta.ignoreConflicts){let e=new l(i("conflict on yotta setting {0} between extensions {1} and {2}",r,t.id,s.id));throw e.pkg0=s,e.pkg1=t,e.settingName=r,e}}}if(o.optionalConfig){const e=n.jsonFlatten(o.optionalConfig);for(const t of Object.keys(e)){const n=e[t];te[t]=n}}}}if(E&&b.hasHex){let e=y;n.assert(!!e.yottaCorePackage),n.assert(!!e.githubCorePackage),n.assert(!!e.gittag);let t=e.githubCorePackage+"#"+y.gittag;_.yotta.dependencies[e.yottaCorePackage]=t}if(t){let e=!1;for(let r of h){D="",re(r),r==t?(e=!0,M.clear(),F.clear()):n.assert(!e);const s=e=>n.endsWith(e,".h"),o=".cpp",a=r.getFiles().filter(s).concat(r.getFiles().filter(e=>!s(e)));for(let e of a){const t=s(e);if(t||n.endsWith(e,o)){let s=r.config.name+"/"+e;("base"==r.config.name||/^core($|---)/.test(r.config.name))&&t&&(s=e),t&&(N+=`#include "${E?d.slice(1):""}${s}"\n`);let o=r.readFile(e);null==o&&n.userError(i("C++ file {0} is missing in extension {1}.",e,r.config.name)),L=s,Q(o,t),_.extensionFiles[d+s]=o,0==r.level&&(_.onlyPublic=!1),r.verProtocol()&&"pub"!=r.verProtocol()&&"embed"!=r.verProtocol()&&(_.onlyPublic=!1)}if(n.endsWith(e,".c")||n.endsWith(e,".S")||n.endsWith(e,".s")){let t=r.readFile(e);_.extensionFiles[d+r.config.name+"/"+e.replace(/\.S$/,".s")]=t}}D&&(B+=i("Extension {0}:\n",r.id)+D)}e||(M.clear(),F.clear())}function se(e){return Object.keys(_.extensionFiles).concat(Object.keys(_.generatedFiles)).filter(t=>n.endsWith(t,e)).map(e=>e.slice(1))}B&&n.userError(B),n.jsonCopyFrom(te,ee),n.iterMap(te,(e,t)=>{null===t&&delete te[e]}),Object.keys(te).filter(e=>/-/.test(e)).forEach(e=>{const t=te[e];delete te[e],te[e.replace(/-/g,"_")]=t}),!E&&y.yottaConfigCompatibility&&Object.keys(te).forEach(e=>te["YOTTA_CFG_"+e]=te[e]),te.PXT_TARGET=JSON.stringify(e.appTarget.id);const oe=n.jsonUnFlatten(te);if(k){let e={name:"pxt-app",private:!0,dependencies:_.npmDependencies};_.generatedFiles["/package.json"]=JSON.stringify(e,null,4)+"\n"}else if(x){const e=n.concatArrayLike([se(".c"),se(".cpp"),se(".s")]).map(e=>e.slice(d.length-1)).concat(["main.cpp"]);e.push("pointers.cpp"),_.generatedFiles[d+"CMakeLists.txt"]="idf_component_register(\n  SRCS\n"+e.map(e=>`    "${e}"\n`).join("")+'  INCLUDE_DIRS\n    "."\n)\n'}else if(T){let t=y,i=n.clone(t.codalDefinitions)||{},r=t.codalTarget;"string"==typeof r&&(r+=".json");let s={target:r,definitions:i,config:i,application:"pxtapp",output_folder:"build",pxt_gitrepo:t.githubCorePackage,pxt_gittag:t.gittag,libraries:n.values(ie).map(e=>({name:e.project,url:"https://github.com/"+e.fullName,branch:e.tag||"master",type:"git"}))};0==s.libraries.length&&delete s.libraries,n.iterMap(n.jsonFlatten(oe),(e,t)=>{e=e.replace(/^codal\./,"device.").toUpperCase().replace(/\./g,"_"),i[e]=t}),_.generatedFiles["/codal.json"]=JSON.stringify(s,null,4)+"\n",e.debug(`codal.json: ${_.generatedFiles["/codal.json"]}`),_.codal=s}else if(v){const e=y.platformioIni.slice();e.push("lib_deps ="),n.iterMap(_.platformio.dependencies,(t,n)=>{let i=/[@#\/]/.test(n)?n:t+"@"+n;e.push("  "+i)}),_.generatedFiles["/platformio.ini"]=e.join("\n")+"\n"}else{_.yotta.config=oe;let t="pxt-app";y.yottaBinary&&(t=y.yottaBinary.replace(/-combined/,"").replace(/\.hex$/,""));let n={name:t,version:"0.0.0",description:"Auto-generated. Do not edit.",license:"n/a",dependencies:_.yotta.dependencies,targetDependencies:{},bin:"./source"};_.generatedFiles["/module.json"]=JSON.stringify(n,null,4)+"\n",e.debug(`module.json: ${_.generatedFiles["/module.json"]}`)}for(let e of Object.keys(j))C+=`#define ${e} ${j[e]}\n`;if(b.uf2Family&&(C+=`#define PXT_UF2_FAMILY ${b.uf2Family}\n`),_.generatedFiles[d+"pointers.cpp"]=N+P.finish()+A+I+w+"\nPXT_SHIMS_END\n",_.generatedFiles[d+"pxtconfig.h"]=C,e.debug(`pxtconfig.h: ${_.generatedFiles[d+"pxtconfig.h"]}`),E&&(_.generatedFiles["/config.json"]=JSON.stringify(oe,null,4)+"\n",e.debug(`yotta config.json: ${_.generatedFiles["/config.json"]}`)),_.generatedFiles[d+"main.cpp"]='\n#include "pxt.h"\n#ifdef PXT_MAIN\nPXT_MAIN\n#else\nint main() {\n    uBit.init();\n    pxt::start();\n    release_fiber();\n    return 0;   // your program will never reach this line.\n}\n#endif\n',_.generatedFiles["/Makefile"]){let e="",t=(t,n)=>{e+=`${t} = ${se(n).join(" ")}\n`};t("PXT_C",".c"),t("PXT_CPP",".cpp"),t("PXT_S",".s"),t("PXT_HEADERS",".h"),e+="PXT_SOURCES := $(PXT_C) $(PXT_S) $(PXT_CPP)\n",e+="PXT_OBJS := $(addprefix bld/, $(PXT_C:.c=.o) $(PXT_S:.s=.o) $(PXT_CPP:.cpp=.o))\n",_.generatedFiles["/Makefile.inc"]=e}_.generatedFiles["/functions.json"]=JSON.stringify(_.functions,null,1);let ae=_.extensionFiles;n.jsonCopyFrom(ae,_.generatedFiles);let le={config:y.serviceId,tag:y.gittag,replaceFiles:ae,dependencies:E?_.yotta.dependencies:null},ce=JSON.stringify(le);return _.sha=n.sha256(ce),_.skipCloudBuild=!!y.skipCloudBuild,_.compileData=ts.pxtc.encodeBase64(n.toUTF8(ce)),_.shimsDTS=M.finish(),_.enumsDTS=F.finish(),Object.keys(a).length>10&&(a={}),a[m]=_,_},t.unpackSourceFromHexFileAsync=function(t){if(t)return e.Util.fileReadAsBufferAsync(t).then(e=>p(new Uint8Array(e)))},t.unpackSourceFromHexAsync=p}(e.cpp||(e.cpp={}))}(pxt||(pxt={})),function(e){!function(t){const n={};let i,r={};function s(r){return n.hasOwnProperty(r.sha)||(n[r.sha]=function(n){let r="";return t.showLoading(e.U.lf("Compiling (this may take a minute)...")),e.tickEvent("cppcompile.start"),function(t){if(t.skipCloudBuild)return Promise.resolve({hex:["SKIP"]});if(e.webConfig&&e.webConfig.isStatic)return e.Util.requestAsync({url:`${e.webConfig.cdnUrl}hexcache/${t.sha}.hex`}).then(t=>{if(t.text){const e={enums:[],functions:[],hex:t.text.split(/\r?\n/)};return Promise.resolve(e)}return e.log("Hex info not found in bundled hex cache"),Promise.resolve()}).catch(t=>(e.log("Error fetching hex info from bundled hex cache"),Promise.resolve()));if(!e.Cloud.localToken||!window||!e.BrowserUtils.isLocalHost())return Promise.resolve(void 0);return(n="compile/"+t.sha,e.Cloud.localRequestAsync(n,i).then(e=>e.json)).then(e=>e&&!e.notInOfflineCache&&e.hex?(e.hex=e.hex.split(/\r?\n/),e):Promise.resolve(void 0)).catch(e=>Promise.resolve(void 0));var n,i}(n).then(s=>s?(e.tickEvent("cppcompile.cachehit"),s):function(){if(i)return i;{let t=e.getOnlineCdnUrl();if(t)return i=Promise.resolve(t);const n=e.webConfig&&e.webConfig.isStatic;return i=e.Cloud.privateGetAsync("clientconfig",n).then(e=>e.primaryCdnUrl)}}().then(t=>(r=t+"/compile/"+n.sha,e.U.httpGetTextAsync(r+".hex"))).then(e=>e,t=>e.Cloud.privatePostAsync("compile/extension",{data:n.compileData},!0).then(t=>new Promise((n,i)=>{let s=0;const o=8e3,a=3e5,l=e.U.now(),c=()=>{if(s++,e.U.now()-l>a)return e.log("abandoning C++ build"),e.tickEvent("cppcompile.cancel",{retry:s}),n(null),null;let i=t.hex.replace(/\.hex/,".json");return e.log(`polling C++ build ${i} (attempt #${s})`),e.tickEvent("cppcompile.poll",{retry:s}),e.Util.httpGetJsonAsync(i).then(t=>{e.log(`build log ${i.replace(/\.json$/,".log")}`),e.tickEvent("cppcompile.done",{success:(null==t?void 0:t.success)?1:0,retry:s,duration:e.U.now()-l}),t.success?(e.log("fetching "+r+".hex"),n(e.U.httpGetTextAsync(r+".hex"))):(e.log("build failed"),t.mbedresponse&&t.mbedresponse.result&&t.mbedresponse.result.exception&&e.log(t.mbedresponse.result.exception),n(null))},t=>(e.log(`waiting ${o/1e3|0}s for C++ build...`),setTimeout(c,o),null))};c()}))).then(e=>(t.hideLoading(),{hex:e&&e.split(/\r?\n/)}))).finally(()=>{t.hideLoading()})}(r)),n[r.sha]}function o(t,n,i,r,s=10){return t.cacheStoreAsync(i,r).then(()=>t.cacheGetAsync(n)).then(r=>{let o;try{o=JSON.parse(r||"[]")}catch(t){e.error("invalid cache entry, clearing entry"),o=[]}o=o.filter(e=>e!=i),o.unshift(i);let a=o.slice(s);return o=o.slice(0,s),e.U.promiseMapAll(a,e=>t.cacheStoreAsync(e,"[]")).then(()=>t.cacheStoreAsync(n,JSON.stringify(o)))})}function a(t,n,i){return t.cacheGetAsync(n).then(r=>{let s;try{s=JSON.parse(r||"[]")}catch(i){return e.error("invalid cache entry, clearing entry"),t.cacheStoreAsync(n,"[]")}return s[0]!=i?(s=s.filter(e=>e!=i),s.unshift(i),t.cacheStoreAsync(n,JSON.stringify(s))):null})}t.showLoading=e=>{},t.hideLoading=()=>{},t.storeWithLimitAsync=o,t.recordGetAsync=a,t.getHexInfoAsync=function(t,n,i){if(!n.sha)return Promise.resolve(null);const l=r[n.sha];if(l)return Promise.resolve(l);e.debug("get hex info: "+n.sha);let c="hex-"+n.sha;return t.cacheGetAsync(c).then(i=>{let r;try{r=i?JSON.parse(i):null}catch(t){e.log("invalid cache entry, clearing entry"),r=null}return r&&r.hex?(e.debug("cache hit, size="+i.length),r.hex=function(t){let n=[];for(let i=0;i<t.length;i++){let r=/^([@!])(....)$/.exec(t[i]);if(!r){n.push(t[i]);continue}let s=parseInt(r[2],16),o=t[++i],a="";if("@"==r[1]){a="";let e=parseInt(o,16);for(;e-- >0;)a+="\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"}else a=ts.pxtc.decodeBase64(o);e.Util.assert(a.length>0),e.Util.assert(a.length%16==0);for(let e=0;e<a.length;){let t=[16,s>>8&255,255&s,0];s+=16;for(let n=0;n<16;++n)t.push(a.charCodeAt(e++));let i=0;for(let e=0;e<t.length;++e)i+=t[e];t.push(255&-i);let r=":";for(let e=0;e<t.length;++e){let n=255&t[e];n<=15&&(r+="0"),r+=n.toString(16)}n.push(r.toUpperCase())}}return n}(r.hex),a(t,"hex-keys",c).then(()=>r)):s(n).then(e=>{let n=e.hex;e.hex=function(e){let t=[],n=0;for(let i=0;i<e.length;i+=n){let r=-1,s="";n=0;let o=!1;for(;n<500;){let a=/^:10(....)00(.{32})(..)$/.exec(e[i+n]);if(!a)break;let l=a[2],c=/^0+$/.test(l),u=parseInt(a[1],16);if(-1==r)o=c,t.push((o?"@":"!")+a[1]),r=u-16;else{if(c!=o)break;if(r+16!=u)break}o||(s+=l),r=u,n++}if(0==n)t.push(e[i]),n=1;else if(o)t.push(n.toString(16));else{let e="";for(let t=0;t<s.length;t+=2)e+=String.fromCharCode(parseInt(s.slice(t,t+2),16));t.push(ts.pxtc.encodeBase64(e))}}return t}(e.hex);let i=JSON.stringify(e);return e.hex=n,o(t,"hex-keys",c,i).then(()=>e)}).catch(t=>(e.reportException(t,{sha:n.sha}),Promise.resolve(null)))}).then(e=>(e&&(Object.keys(r).length>20&&(r={}),r[n.sha]=e),e))}}(e.hexloader||(e.hexloader={}))}(pxt||(pxt={})),function(e){!function(t){t.KEY_VARIABLE="CROWDIN_KEY",t.testMode=!1,t.setTestMode=function(){e.crowdin.testMode=!0,e.log("CROWDIN TEST MODE - files will NOT be uploaded")},t.inContextLoadAsync=function(t){const n=document.createElement("input");n.type="text",n.setAttribute("class","hidden"),n.value=t;let i=new Promise((i,r)=>{const s=new MutationObserver(()=>{if(t==n.value)return;const r=e.Util.rlf(n.value);n.remove(),s.disconnect(),i(r)});s.observe(n,{attributes:!0})});return document.body.appendChild(n),i}}(e.crowdin||(e.crowdin={}))}(pxt||(pxt={})),function(e){!function(t){function n(e,t){if(!e)return[];if(t){const t=[];let n=0;for(let i=0;i<e.length;i++){"\n"===e.charAt(i)&&(t.push(e.substring(n,i+1)),n=i+1)}return t.push(e.substring(n)),t}return e.split(/\r?\n/)}let i;function r(e,t,r={}){r.ignoreWhitespace&&(e=e.replace(/[\r\n]+$/,""),t=t.replace(/[\r\n]+$/,""));const s=n(e,!0),o=n(t,!0),a=Math.min(r.maxDiffSize||1024,s.length+o.length);if(0==a)return[];const l=s.length>65520?Uint32Array:Uint16Array,c={};let u=0;const d=h(s),p=h(o);function h(e){const t=new l(e.length);let n=0;for(let i of e)r.ignoreWhitespace&&(i=i.replace(/\s+$/g,"").replace(/^\s+/g,"")),c.hasOwnProperty(i)?t[n]=c[i]:(++u,t[n]=u,c[i]=u),n++;return t}const f=new l(2*a+1);let m=-1;for(let e=0;e<=a;e++)null!=v(e,f)&&(m=e);if(-1==m)return null;const g=[];let _=null;for(let e=0;e<=m;e++){const t=g.length?g[g.length-1].slice(0):new l(2*m+1);if(g.push(t),_=v(e,t),null!=_)break}const y=[];let b=_;for(let e=g.length-1;e>=0;e--){const t=g[e];let n=0,r=0;b==-e||b!=e&&t[a+b-1]<t[a+b+1]?(r=b+1,n=t[a+r]):(r=b-1,n=t[a+r]+1);let l=n-b;for(let e=t[a+b]-n-1;e>=0;--e)y.push([i.Unchanged,o[l+e]]);r==b-1?y.push([i.Deleted,s[n-1]]):l>0&&y.push([i.Added,o[l-1]]),b=r}return y.reverse(),y;function v(e,t){for(let n=-e;n<=e;n+=2){let i=0;i=n==-e||n!=e&&t[a+n-1]<t[a+n+1]?t[a+n+1]:t[a+n-1]+1;let r=i-n;for(;i<d.length&&r<p.length&&d[i]==p[r];)i++,r++;if(t[a+n]=i,i>=d.length&&r>=p.length)return n}return null}}function s(e,t,n={}){const s=r(e,t,n);if(n.context==1/0||n.full)return s.map(o);let a=1,l=1,c=0;const u=[],d=n.context||3;for(;c<s.length;){let e=c;for(;e<s.length&&s[e][0]===i.Unchanged;)e++;if(e==s.length)break;const t=e-d,n=t-c;n>0&&(a+=n,l+=n,c=t);const r=u.length,p=a,h=l;u.push("@@");let f=c,m=0;for(;f<s.length;){if(s[f][0]===i.Unchanged){if(m++,m>2*d+2){f-=d+2;break}}else m=0;f++}for(;c<f;){u.push(o(s[c]));switch(s[c][0]){case i.Deleted:a++;break;case i.Added:l++;break;case i.Unchanged:a++,l++}c++}u[r]=`@@ -${p},${a-p} +${h},${l-h} @@`}return u}function o([e,t]){let n;return n=e===i.Added?"+ ":e===i.Deleted?"- ":"  ",n+t.replace(/\r?\n/,"")}function a(e){return n(e).map(e=>e.replace(/;\s*$/,"")).join("\n")}function l(e){const t=/^@@ -(\d+),(\d+) \+(\d+),(\d+)/.exec(e);return t&&{oldStart:parseInt(t[1])-1,oldLength:parseInt(t[2]),newStart:parseInt(t[3])-1,newLength:parseInt(t[4])}}t.toLines=n,function(e){e[e.Added=1]="Added",e[e.Deleted=-1]="Deleted",e[e.Unchanged=0]="Unchanged"}(i||(i={})),t.compute=r,t.computeFormattedDiff=s,t.computePatch=function(e,t){const n=r(e,t,{full:!0,maxDiffSize:2048});if(!n)return[{start1:0,length1:e.length,diffs:[[i.Added,t]]}];const s=function(e){const t=[];let n="",r="",s="",o=i.Unchanged;const a=()=>{t.push({start1:n.length,length1:s.length,diffs:[[i.Added,r]]}),n+=r,r="",s=""};for(let t=0;t<e.length;t++){const[l,c]=e[t];l==i.Unchanged?(o!==i.Unchanged&&a(),n+=c):l===i.Added?r+=c:l===i.Deleted&&(o===i.Added&&a(),s+=c),o=l}return o!==i.Unchanged&&a(),t}(n);return s},t.applyPatch=function(e,t){let n=e;for(const e of t){const t=e.diffs.filter(e=>e[0]!==i.Deleted).map(e=>e[1]).join("");n=n.substring(0,e.start1)+t+n.substring(e.start1+e.length1)}return n},t.diff3=function(t,s,o,a,l){const c=_(t),u=_(o);if(!c||!u)return;const d=n(t),p=n(o);let h=0,f=[],m=0,g=0;for(let t=0;t<c.length-1;)if(c[t]==m&&u[t]==g)f.push(d[m]),m++,g++,t++;else{let n=!0,i=!0,r=t;for(;r<c.length&&(c[r]!=m+r-t&&(n=!1),u[r]!=g+r-t&&(i=!1),null==c[r]||null==u[r]);)r++;if(e.U.assert(r<c.length),n)for(;g<u[r];)f.push(p[g++]);else if(i)for(;m<c[r];)f.push(d[m++]);else if(d.slice(m,c[r]).join("\n")==p.slice(g,u[r]).join("\n"))for(;m<c[r];)f.push(d[m++]);else{for(h++,f.push("<<<<<<< "+a);m<c[r];)f.push(d[m++]);for(f.push("=======");g<u[r];)f.push(p[g++]);f.push(">>>>>>> "+l)}t=r,m=c[r],g=u[r]}return{merged:f.join("\n"),numConflicts:h};function _(t){const n=r(s,t,{context:1/0});if(!n)return;const o=[];let a=0,l=0;for(let t of n)t[0]==i.Added?a++:t[0]==i.Deleted?(o[l]=null,l++):t[0]==i.Unchanged?(o[l]=a,a++,l++):e.U.oops();return o.push(a+1),o}},t.removeTrailingSemiColumns=a,t.split=function(e,t){const n=e.split(/-{10,}/,2);if(n.length<2)return{fileA:e,fileB:void 0};let i=n[0].replace(/\n$/,""),r=n[1].replace(/^\n/,"");return t&&t.removeTrailingSemiColumns&&(i=a(i),r=a(r)),{fileA:i,fileB:r}},t.parseDiffMarker=l,t.render=function(t,n,i={}){const r=s(t,n,i);if(!r)return e.dom.el("div",null,pxtc.Util.lf("Too many differences to render diff."));const o={"@":"diff-marker"," ":"diff-unchanged","+":"diff-added","-":"diff-removed"};let a=0,c=0,u="";const d=e.dom.el("tbody"),p=e.dom.el("table",{class:"diffview "+(i.update?"update":"")},d);let h=null;return r.forEach((t,n)=>{const p=l(t);p?(a=p.oldStart,c=p.newStart):("+"!=t[0]&&a++,"-"!=t[0]&&c++);const f=r[n+1]?r[n+1][0]:"",m=r[n+2]?r[n+2][0]:"",g=t.slice(2);let _=e.dom.el("code",null,g);if(h)_=h,h=null;else if(!("-"!=t[0]||" "!=u&&"@"!=u||"+"!=f||" "!=m&&"@"!=m&&""!=m)){const i=function(t,n){const i=s(t.split("").join("\n"),n.split("").join("\n"),{context:1/0});if(!i)return{a:e.dom.el("div",{class:"inline-diff"},e.dom.el("code",null,t)),b:e.dom.el("div",{class:"inline-diff"},e.dom.el("code",null,n))};const r=[],o=[];for(let t=0;t<i.length;){let n=t;const s=i[t][0];for(;i[n]&&i[n][0]==s;)n++;const a=i.slice(t,n).map(e=>e.slice(2)).join("");" "==s?(r.push(e.dom.el("code",{class:"ch-common"},a)),o.push(e.dom.el("code",{class:"ch-common"},a))):"-"==s?r.push(e.dom.el("code",{class:"ch-removed"},a)):"+"==s?o.push(e.dom.el("code",{class:"ch-added"},a)):e.Util.oops(),t=n}return{a:e.dom.el("div",{class:"inline-diff"},r),b:e.dom.el("div",{class:"inline-diff"},o)}}(t.slice(2),r[n+1].slice(2));_=i.a,h=i.b}if(u=t[0],i.hideMarkerLine&&"@"==u||i.hideRemoved&&"-"==u)return;const y="@"==u,b=`${o[u]}`;d.appendChild(e.dom.el("tr",{class:b},[!i.hideLineNumbers&&e.dom.el("td",{class:"line-a","data-content":a}),!i.hideLineNumbers&&e.dom.el("td",{class:"line-b","data-content":c}),y&&e.dom.el("td",{colspan:2,class:"change"},e.dom.el("code",null,t)),!i.hideMarker&&!y&&e.dom.el("td",{class:"marker","data-content":u}),!y&&e.dom.el("td",{class:"change"},_)]))}),p},t.resolveMergeConflictMarker=function(t,n,i,r){let s=e.diff.toLines(t),o=n;for(;o<s.length&&!/^<<<<<<<[^<]/.test(s[o]);)o++;let a=o+1;for(;a<s.length&&!/^=======$/.test(s[a]);)a++;let l=a+1;for(;l<s.length&&!/^>>>>>>>[^>]/.test(s[l]);)l++;if(l>=s.length)return e.debug(`diff marker mistmatch: ${s.length} -> ${o} ${a} ${l}`),t;if(s[o]=void 0,s[a]=void 0,s[l]=void 0,!i)for(let e=o;e<=a;++e)s[e]=void 0;if(!r)for(let e=a;e<=l;++e)s[e]=void 0;return s.filter(e=>void 0!==e).join("\n")},t.mergeDiff3Config=function(t,n,i){let r=e.Util.jsonTryParse(t),s=e.Util.jsonTryParse(n),o=e.Util.jsonTryParse(i);if(r&&!o)return t;if(!r)return i||n;if(!s&&o&&(s=o),!r||!s||!o)return;delete r.installedVersion,delete s.installedVersion,delete o.installedVersion;const a={},l=e.U.unique(Object.keys(s).concat(Object.keys(r)).concat(Object.keys(o)),e=>e);for(const t of l){const n=r[t],i=s[t],l=o[t];if(JSON.stringify(n)==JSON.stringify(l))void 0!==n&&(a[t]=n);else switch(t){case"name":a[t]=c(n,i,l);break;case"version":a[t]=e.semver.strcmp(n,l)>0?n:l;break;case"languageRestriction":case"preferredEditor":case"targetVersion":a[t]=n;break;case"public":a[t]=n&&l;break;case"files":case"testFiles":{const e=u(n||[],i||[],l||[]);if(!e)return;a[t]=e.length?e:void 0;break}case"dependencies":case"testDependencies":{const e=d(n||{},i||{},l||{});if(Object.keys(e).length)return;a[t]=e;break}case"description":if(n&&!l)a[t]=n;else{if(n||!l)return;a[t]=l}break;default:return}}return e.Package.stringifyConfig(a);function c(e,t,n){return e==t?n:n==t?e:e==lf("Untitled")?n:e}function u(t,n,i){const r=[],s=e.U.unique(n.concat(t).concat(i),e=>e);for(const e of s){const s=t.indexOf(e)>-1,o=i.indexOf(e)>-1,a=n.indexOf(e)>-1;s==o||o==a?s&&r.push(e):o&&r.push(e)}return r}function d(t,n,i){const r={},s=e.U.unique(Object.keys(n).concat(Object.keys(t)).concat(Object.keys(i)),e=>e);for(const o of s){const s=t[o],a=i[o],l=n[o];if(s==a)s&&(r[o]=s);else{const t=e.github.parseRepoId(s),n=e.github.parseRepoId(a);if(t&&n&&e.semver.tryParse(t.tag)&&e.semver.tryParse(n.tag)&&t.owner&&t.project&&t.owner==n.owner&&t.project==n.project){const i=e.semver.strcmp(t.tag,n.tag)>0?t.tag:n.tag;r[o]=`github:${t.owner}/${t.project}#${i}`}else a==l?s&&(r[o]=s):a&&(r[o]=a)}}return r}},t.hasMergeConflictMarker=function(e){return e&&/^(<<<<<<<[^<]|>>>>>>>[^>])/m.test(e)},t.reconstructConfig=function(t,n,i,r){let s={},o=i.tree.tree.map(e=>e.path).filter(e=>/\.(ts|blocks|md|jres|asm|json)$/.test(e)).filter(t=>t!=e.CONFIG_NAME);return t.fileName&&(o=o.filter(e=>0===e.indexOf(t.fileName)).map(e=>e.slice(t.fileName.length+1))),o.find(e=>/\.ts$/.test(e))||(r.config.files.filter(e=>o.indexOf(e)<0).forEach(e=>{o.push(e),n[e]=r.files[e]}),e.Util.jsonCopyFrom(s,r.config.dependencies)),Object.keys(s).length||(s[e.appTarget.corepkg]="*"),{name:"",files:o,dependencies:s,preferredEditor:o.find(e=>/.blocks$/.test(e))?e.BLOCKS_PROJECT_NAME:e.JAVASCRIPT_PROJECT_NAME}}}(e.diff||(e.diff={}))}(pxt||(pxt={})),function(e){!function(t){t.extractSharedIdFromPostUrl=function(t){return e.Util.httpGetJsonAsync(t+".json").then(t=>t.post_stream&&t.post_stream.posts&&t.post_stream.posts[0]&&t.post_stream.posts[0].link_counts.map(t=>e.Cloud.parseScriptId(t.url)).filter(e=>!!e)[0])},t.topicsByTag=function(t,n){const i=`${t=t.replace(/\/$/,"")}/tag/${n}.json`;return e.Util.httpGetJsonAsync(i).then(n=>{const i=e.Util.toDictionary(n.users,e=>e.id.toString());return n.topic_list.topics.map(e=>({id:e.id,title:e.title,url:`${t}/t/${e.slug}/${e.id}`,imageUrl:e.image_url,author:i[e.posters[0].user_id].username,cardType:"forumUrl"}))})}}(e.discourse||(e.discourse={}))}(pxt||(pxt={})),function(e){!function(t){var n=pxtc.Util;let i,r={},s={};const o="\x3c!-- @CMD@ @ARGS@ --\x3e";let a={parent:o,short:o,description:"\x3c!-- desc --\x3e",activities:"\x3c!-- activities --\x3e",explicitHints:"\x3c!-- hints --\x3e",flyoutOnly:"\x3c!-- flyout --\x3e",hideToolbox:"\x3c!-- hideToolbox --\x3e",hideIteration:"\x3c!-- iter --\x3e",codeStart:"\x3c!-- start --\x3e",codeStop:"\x3c!-- stop --\x3e",autoOpen:"\x3c!-- autoOpen --\x3e",autoexpandOff:"\x3c!-- autoexpandOff --\x3e",preferredEditor:"\x3c!-- preferredEditor --\x3e"};function l(e,t,n){return e.split(t).join(n)}function c(e){return e=l(e,"&","&amp;"),e=l(e,"<","&lt;"),e=l(e,">","&gt;"),e=l(e,'"',"&quot;"),e=l(e,"'","&#39;")}function u(e){return e?c(e.replace(/\&([#a-z0-9A-Z]+);/g,(e,t)=>{switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:return"#"==t[0]?String.fromCharCode(parseInt(t.slice(1))):e}})):e}t.htmlQuote=c,t.html2Quote=u;const d=[{rx:/^vimeo\.com\/(\d+)/i,cmd:"### @vimeo $1"},{rx:/^(www\.youtube\.com\/watch\?v=|youtu\.be\/)([\w\-]+(\#t=([0-9]+m[0-9]+s|[0-9]+m|[0-9]+s))?)/i,cmd:"### @youtube $2"}];t.requireMarked=()=>{const e=null===globalThis||void 0===globalThis?void 0:globalThis.marked;if(e)return e;if("undefined"==typeof require)return;const t=e=>{var t;try{const n=require(e);return(null==n?void 0:n.marked)?n.marked:(null===(t=null==n?void 0:n.default)||void 0===t?void 0:t.marked)?n.default.marked:(null==n?void 0:n.default)?n.default:n}catch(e){return}};return t("marked/lib/marked.umd.js")||t("marked")},t.requireDOMSanitizer=()=>"undefined"!=typeof DOMPurify?DOMPurify.sanitize:"undefined"!=typeof require?require("dompurify").sanitize:void 0;const p=e=>`<div class='ui negative message'>${c(e)}</div>`;function h(e){let t=n.clone(r),i=n.clone(s),o=n.clone(a),l={},c={},d=e.params,h=e.theme;e.boxes=t,e.macros=i,e.settings=o,e.html=e.html.replace(/<aside\s+([^<>]+)>([^]*?)<\/aside>/g,(e,n,r)=>{let s=function(e){let t={};for(;e.trim();){let n=/\s*([^=\s]+)=("([^"]*)"|'([^']*)'|(\S*))/.exec(e);if(n){let e=n[3]||n[4]||n[5]||"";t[n[1].toLowerCase()]=e}else n=/^\s*(\S+)/.exec(e),t[n[1]]="true";e=e.slice(n[0].length)}return t}(n),a=s["data-name"]||s.id;return a?(/box/.test(s.class)?t[a]=r:/aside/.test(s.class)?t[a]=`\x3c!-- BEGIN-ASIDE ${a} --\x3e${r}\x3c!-- END-ASIDE --\x3e`:/setting/.test(s.class)?o[a]=r:/menu/.test(s.class)?l[a]=r:/toc/.test(s.class)?c[a]=r:i[a]=r,`\x3c!-- macro ${a} --\x3e`):p("id or data-name missing on macro")});let f=(e,t)=>{let n=l.item,i={NAME:e.name};if(e.subitems)n=l["toc-dropdown"]?l["toc-dropdown"]:0==t?l["top-dropdown"]:l["inner-dropdown"],i.ITEMS=e.subitems.map(e=>f(e,t+1)).join("\n");else{if(/^-+$/.test(e.name)&&(n=l.divider),e.path&&!/^(https?:|\/)/.test(e.path))return p("Invalid link: "+e.path);i.LINK=e.path}return g(n,i,["ITEMS"])},m=[{name:lf("Docs"),href:"/docs"}];const _=e.TOC||h.TOC||[];let y=[],b=t=>{for(let e of t.subitems||[])if(b(e))return y.push(t),!0;return!(!e.filepath||!t.path||e.filepath!=t.path)&&(y.push(t),!0)};_.forEach(b);let v=(t,n)=>{let i=c.item,r={NAME:t.name};return t.path&&!/^(https?:|\/)/.test(t.path)?p("Invalid link: "+t.path):(/^\//.test(t.path)&&e.versionPath&&(t.path=`/${e.versionPath}${t.path}`),r.LINK=t.path,y.indexOf(t)>=0?(r.ACTIVE="active",r.EXPANDED="true",m.push({name:t.name,href:t.path})):r.EXPANDED="false",t.subitems&&t.subitems.length>0?(i=c["toc-dropdown"]?""!==t.name?c["toc-dropdown"]:c["toc-dropdown-noLink"]:0==n?""!==t.name?c["top-dropdown"]:c["top-dropdown-noHeading"]:1==n?c["inner-dropdown"]:c["nested-dropdown"],r.ITEMS=t.subitems.map(e=>v(e,n+1)).join("\n")):/^-+$/.test(t.name)&&(i=c.divider),g(i,r,["ITEMS"]))};d.menu=(h.docMenu||[]).map(e=>f(e,0)).join("\n"),d.TOC=_.map(e=>v(e,0)).join("\n"),h.appStoreID&&(d.appstoremeta=`<meta name="apple-itunes-app" content="app-id=${n.htmlEscape(h.appStoreID)}"/>`);let T="";m.length>1&&(T=`\n            <nav class="ui breadcrumb" aria-label="${lf("Breadcrumb")}">\n                ${m.map((e,t)=>`<a class="${t==m.length-1?"active":""} section"\n                        href="${u(e.href)}" aria-current="${t==m.length-1?"page":""}">${u(e.name)}</a>`).join('<i class="right chevron icon divider"></i>')}\n            </nav>`),d.breadcrumb=T,h.boardName&&(d.boardname=u(h.boardName)),h.boardNickname&&(d.boardnickname=u(h.boardNickname)),h.driveDisplayName&&(d.drivename=u(h.driveDisplayName)),h.homeUrl&&(d.homeurl=u(h.homeUrl)),d.targetid=h.id||"???",d.targetname=h.name||"Microsoft MakeCode",d.docsheader=h.docsHeader||"Documentation",d.orgtitle="MakeCode";const k=h.docsLogo&&n.htmlEscape(h.docsLogo),x=(h.organizationWideLogo||h.organizationLogo)&&n.htmlEscape(h.organizationWideLogo||h.organizationLogo),E=h.organizationLogo&&n.htmlEscape(h.organizationLogo);d.targetlogo=k?`<img aria-hidden="true" role="presentation" class="ui ${h.logoWide?"small":"mini"} image" src="${k}" />`:"",d.orglogo=x?`<img aria-hidden="true" role="presentation" class="ui image" src="${x}" />`:"",d.orglogomobile=E?`<img aria-hidden="true" role="presentation" class="ui image" src="${E}" />`:"";let S=e.ghEditURLs||[];if(S.length){let e='<p style="margin-top:1em">\n',t=lf("Edit this page on GitHub");for(let n of S)e+=`<a href="${n}"><i class="write icon"></i>${t}</a><br>\n`,t=lf("Edit template of this page on GitHub");e+="</p>\n",d.github=e}else d.github="";const C=`\n            <a href="#maincontent" class="ui item link" tabindex="0" role="menuitem">${lf("Skip to main content")}</a>\n        `;d.accMenu=C;const w=lf("Print this page"),I=`\n            <button id="printbtn" class="circular ui icon right floated button hideprint" title="${w}" aria-label="${w}">\n                <i class="icon print"></i>\n            </button>\n        `;d.printBtn=I;const A=`\n            <a id="togglesidebar" class="launch icon item" tabindex="0" title="Side menu" aria-label="${lf("Side menu")}" role="menuitem" aria-expanded="false">\n                <i class="content icon"></i>\n            </a>\n        `;d.sidebarToggle=A;const N=["tocsearch1","tocsearch2"].map(e=>`\n                <input type="search" name="q" placeholder="${lf("Search...")}" aria-label="${lf("Search Documentation")}">\n                <i onclick="document.getElementById('${e}').submit();" tabindex="0" class="search link icon" aria-label="${lf("Search")}" role="button"></i>\n            `);d.searchBar1=N[0],d.searchBar2=N[1];let D="";h.accentColor&&(D+=`\n.ui.accent { color: ${h.accentColor}; }\n.ui.inverted.accent { background: ${h.accentColor}; }\n`),d.targetstyle=D,d.tocclass=h.lightToc?"lighttoc":"inverted";for(let e of Object.keys(h)){let t=h[e];void 0===d[e]&&"string"==typeof t&&(d[e]=t)}e.finish=()=>g(e.html,d,["body","menu","accMenu","TOC","prev","next","printBtn","breadcrumb","targetlogo","orglogo","orglogomobile","github","JSON","appstoremeta","sidebarToggle","searchBar1","searchBar2"])}function f(e,t={}){e.image=function(e){var t;const n=e.href||"",i=e.title||"",r=e.text||"";if(n.startsWith("youtube:")){return`<div class="tutorial-video-embed"><iframe class="yt-embed" src="https://www.youtube.com/embed/${n.split(":").pop()}" title="${r}" frameborder="0" allowFullScreen allow="autoplay; picture-in-picture"></iframe></div>`}{let e=`<img class="ui image" src="${n}" alt="${r}"`;return i&&(e+=` title="${i}"`),e+=' loading="lazy"',e+=(null===(t=this.options)||void 0===t?void 0:t.xhtml)?"/>":">",e}},e.listitem=function(e){const t=this.parser.parse(e.tokens,!!e.loose);return e.task?`<li class="${e.checked?"checked":"unchecked"}">${t}</li>\n`:`<li>${t}</li>\n`},e.heading=function(e){var t;let n=this.parser.parseInline(e.tokens).trim(),i="";const r=/(.*)#([\w\-]+)\s*$/.exec(e.text||"");r&&(i=r[2],n=n.replace(/#([\w\-]+)\s*$/,"").trim()),n=n.replace(/@(fullscreen|unplugged|showdialog|showhint)/gi,"").trim();const s=n.match(/\{([\s\S]+)\}/);if(s&&(n=s[1].trim()),!i){i=(e=>{let t;do{t=e,e=e.replace(/<[^>]+>/g,"")}while(e!==t);return e})(n).toLowerCase().replace(/[^\w]+/g,"-")}const o=(null===(t=this.options)||void 0===t?void 0:t.headerPrefix)||"";return`<h${e.depth} id="${o}${i}">${n}</h${e.depth}>`},e.code=function(e){const t=c(("string"==typeof(null==e?void 0:e.lang)?e.lang.trim():"").toLowerCase()),n="string"==typeof(null==e?void 0:e.text)?e.text:"";return`<pre><code${t?` class="lang-${t}"`:""}>${!1!==(null==e?void 0:e.escaped)?n:c(n)}</code></pre>`};const n=null==t?void 0:t.versionPath,i=e.link?e.link.bind(e):void 0;e.link=function(e){const t=e.href||"",r=/^[/#]/.test(t),s=r&&n?`/${n}${t}`:t,o=Object.assign(Object.assign({},e),{href:s}),a=i?i(o):`<a href="${o.href}">${this.parser.parseInline(o.tokens||[])}</a>`,l=[];r||l.push('target="_blank"'),l.push('rel="nofollow noopener"');const c=l.join(" ");return a.replace(/^<a /,`<a ${c} `)}}function m(e,t){return e.replace(/<!--\s*@(ifn?def)\s+(\w+)\s*-->([^]*?)<!--\s*@endif\s*-->/g,(e,n,i,r)=>"ifdef"==n&&t[i]||"ifndef"==n&&!t[i]?`\x3c!-- ${n} ${i} --\x3e${r}\x3c!-- endif --\x3e`:`\x3c!-- ${n} ${i} endif --\x3e`)}function g(e,t,i=[]){return e?e.replace(/@(\w+)@/g,(e,r)=>{let s=n.lookup(t,r)||"";return s+="",i.indexOf(r)<0&&(s=u(s)),s}):""}t.prepTemplate=h,t.setupRenderer=f,t.renderConditionalMacros=m,t.renderMarkdown=function(e){let r=!0;e.pubinfo||(r=!1,e.pubinfo={});let s=e.pubinfo;if(e.theme||(e.theme={}),delete e.pubinfo.private,s.time){let e=parseInt(s.time);s.timems||(s.timems=1e3*e+""),s.humantime||(s.humantime=n.isoTime(e))}s.name&&(s.dirname=s.name.replace(/[^A-Za-z0-9_]/g,"-"),s.title=s.name),r&&(s.JSON=JSON.stringify(s,null,4).replace(/</g,"\\u003c"));let o=e.template;o=o.replace(/<!--\s*@include\s+(\S+)\s*-->/g,(t,n)=>"\x3c!-- include "+n+" --\x3e\n"+((e.theme.htmlDocIncludes||{})[n]||"")+"\n\x3c!-- end include --\x3e\n"),o=m(o,s),e.locale&&(o=y(o,e.locale).text);let a={html:o,theme:e.theme,filepath:e.filepath,versionPath:e.versionPath,ghEditURLs:e.ghEditURLs,params:s,TOC:e.TOC};if(h(a),i||(i=t.requireMarked()),!i)return a.finish?a.finish():a.html;const l=new i.Renderer;f(l,{versionPath:a.versionPath});let c=t.requireDOMSanitizer();i.setOptions({renderer:l,async:!1,gfm:!0,tables:!0,breaks:!1,pedantic:!1});let _=e.markdown;e.repo&&(_+=`\n\`\`\`package\n${e.repo.name.replace(/^pxt-/,"")}=github:${e.repo.fullName}#${e.repo.tag||"master"}\n\`\`\`\n`),_=_.replace(/^\s*https?:\/\/(\S+)\s*$/gm,(e,t)=>{for(let e of d){let n=e.rx.exec(t);if(n)return e.cmd.replace(/\$(\d+)/g,(e,t)=>n[parseInt(t)]||"")+"\n"}return e}),_=_.replace(/@([a-z]+)@/gi,(t,i)=>{let r=s[i];return!r&&e.throwOnError&&n.userError(`unknown macro ${i}`),r||"unknown macro"});let b=i(_);const v=(e,t="")=>"string"==typeof e?e:e&&"function"==typeof e.toString?e.toString():t;let T=b;c&&(T=c(b)),b=v(T,v(b,"")),b=b.replace(/&lt;br\s*\/&gt;/gi,"<br/>"),b=b.replace(/(<img [^>]* src=")\/docs\/static\/([^">]+)"/g,(e,t,n)=>t+"/static/"+n+'"');let k="",x=0;function E(e,t,n){let i=n;return e<=x&&(i=k+i,k="",x=0),i}if(b=b.replace(/<h(\d)[^>]+>\s*([~@])?\s*(.*?)<\/h\d>/g,(t,i,r,o)=>{let l=/^(\w+)\s+(.*)/.exec(o),c=l?l[1]:o,d=l?l[2]:"";d=u(d),c=u(c);const h=parseInt(i,10);if(r){if("@"==r){let t=n.lookup(a.settings,c);if(null!=t)s[c]=d;else if(t=n.lookup(a.macros,c),null==t)return e.throwOnError&&n.userError(`Unknown command: @${c}`),p(`Unknown command: @${c}`);return E(h,0,g(t,{ARGS:d,CMD:c},["ARGS","CMD"]))}{if(!c){let e=k;return k="",e}let t=n.lookup(a.boxes,c);if(t){let e=t.split("@BODY@"),n=E(h,0,e[0].replace("@ARGS@",d));k=e[1];let i=t.match(/data-[^>\s]+/gi);return i&&i.indexOf("data-inferred")>=0&&(x=h),n}return e.throwOnError&&n.userError(`Unknown box: ~ ${c}`),p(`Unknown box: ~ ${c}`)}}return E(h,0,t)}),k&&(b+=k),!s.title){let e=/<h1[^<>]*>([^<>]+)<\/h1>/.exec(b);e&&(s.title=u(e[1]))}if(!s.description){let e=/<p>([^]+?)<\/p>/.exec(b);e&&(s.description=u(e[1]))}const S=/<div class="ui embed mdvid"[^<>]+?data-placeholder="([^"]+)"[^>]*\/?>/i.exec(b)||/<img class="ui [^"]*image" src="([^"]+)"[^>]*\/?>/i.exec(b);S&&(s.cardLogo=u(S[1])),s.twitter=u(e.theme.twitter||"@msmakecode");let C={main:""};b=b.replace(/<!-- BEGIN-ASIDE (\S+) -->([^]*?)<!-- END-ASIDE -->/g,(e,t,i)=>{let r=n.lookup(C,t);return C[t]=(r||"")+i,"\x3c!-- aside --\x3e"}),b=b.replace(/\n<\/code>/g,"</code>"),C.main=b;let w=(e,t)=>g(a.boxes[e]||"@BODY@",{BODY:t},["BODY"]);b="";for(let e of Object.keys(C))b+=w(e+"-container",C[e]);s.body=b,s.name=s.title||"";for(let t of Object.keys(e.theme)){let n=e.theme[t];"string"==typeof n&&(s["theme_"+t]=n)}return a.finish()},t.embedUrl=function(e,t,n,i){return`<div style="position:relative;height:0;padding-bottom:70%;overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${`${e}#${t}:${n}`}" frameborder="0" sandbox="allow-popups allow-forms allow-scripts allow-same-origin"></iframe></div>`},t.runUrl=function(e,t,n){return`<div style="position:relative;height:0;padding-bottom:${t};overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${e}?id=${encodeURIComponent(n)}" allowfullscreen="allowfullscreen" sandbox="allow-popups allow-forms allow-scripts allow-same-origin" frameborder="0"></iframe></div>`},t.codeEmbedUrl=function(e,t,n){const i=`${e}---codeembed#pub:${t}`;return`<div style="position:relative;height:calc(${n=Math.ceil(n||300)}px + 5em);width:100%;overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${i}" allowfullscreen="allowfullscreen" frameborder="0" sandbox="allow-scripts allow-same-origin"></iframe></div>`};const _={b:1,strong:1,em:1};function y(e,t){const i={};function r(e){let r=/^(\s*)([^]*?)(\s*)$/.exec(e),s=r[2].replace(/\s+/g," ");if(""==s||/^((IE=edge,.*|width=device-width.*|(https?:\/\/|\/)[\w@\/\.]+|@[\-\w]+@|\{[^\{\}]+\}|[^a-zA-Z]*|(&nbsp;)+)\s*)+$/.test(s))return null;let o=n.lookup(t,s);return o?s=o:i[s]="",r[1]+s+r[3]}function s(e){return e.replace(/&llt;/g,"<").replace(/&ggt;/g,">")}return{text:e=(e=(e=(e="<start>"+(e=e.replace(/<([\/\w]+)([^<>]*)>/g,(e,t,n)=>{let i=t.replace(/^\//,"").toLowerCase();return 1===_[i]?"&llt;"+t+n+"&ggt;":e}))).replace(/(<([\/\w]+)([^<>]*)>)([^<>]+)/g,(e,t,n,i,o)=>{if("script"==n||"style"==n)return s(e);let a=r(s(o));return null==a?s(e):t+a})).replace(/(<[^<>]*)(content|placeholder|alt|title)="([^"]+)"/g,(e,t,n,i)=>null==r(i)?e:t+n+'="'+i.replace(/"/g,"''")+'"')).replace(/^<start>/g,""),missing:i}}function b(e,t){if(e.id==t)return e;for(let n of e.children){let e=b(n,t);if(e)return e}return null}function v(e,t){let n=0,i=[{level:0,id:"",title:"",start:n,text:"",children:[]}],r=(e=e.replace(/\r/g,"")).split(/\n/),s={};for(let e of r){let r=/^\s*(#+)\s*(.*?)(#(\S+)\s*)?$/.exec(e),o=null;if(t&&r)if(r[4])if(s[r[4]])r=null;else{o=b(t,r[4]);let e=t=>{t.id&&(s[t.id]=!0),t.children.forEach(e)};o&&e(o)}else r=null;if(r){let s={level:t?1:r[1].length,title:r[2].trim(),id:r[4]||"",start:n,text:"",children:[]};if(o){e="";for(let t=0;t<o.level;++t)e+="#";e+=" ",e+=s.title||o.title,e+=" #"+s.id}for(;i[i.length-1].level>=s.level;)i.pop();i[i.length-1].children.push(s),i.push(s)}i[i.length-1].text+=e+"\n",n++}return i[0]}t.translate=y,t.buildTOC=function(t){if(!t)return null;const n=e.docs.requireMarked();if(!n)return null;const i={renderer:new n.Renderer,gfm:!0,tables:!1,breaks:!1,pedantic:!1,smartLists:!1,smartypants:!1},r=n.lexer(t,i),s=e=>(e||"").replace(/\.md$/i,""),o=e=>{if(!e)return"";if("string"==typeof e.text)return e.text.trim();if(e.tokens&&e.tokens.length)for(const t of e.tokens){const e=o(t);if(e)return e}return""},a=e=>{const t={name:"",path:"",subitems:[]};let n="";const i=e=>{if(e)for(const r of e)if(r)switch(r.type){case"link":t.name||(t.name=(r.text||"").trim()),t.path||(t.path=s(r.href));break;case"text":case"codespan":case"strong":case"em":case"paragraph":r.tokens&&r.tokens.length?i(r.tokens):n||"string"!=typeof r.text||(n=r.text.trim());break;default:r.tokens&&r.tokens.length&&i(r.tokens)}};return i(null==e?void 0:e.tokens),t.name||(n=n||o(e),n||"string"!=typeof(null==e?void 0:e.text)||(n=e.text.split(/\n/)[0].trim()),t.name=n||""),t.path=s(t.path),t},l=(e,t)=>{if(e&&e.length)for(const n of e){const e=a(n),i=((null==n?void 0:n.tokens)||[]).filter(e=>"list"===(null==e?void 0:e.type));for(const t of i)l((null==t?void 0:t.items)||[],e.subitems);(e.name||e.subitems.length)&&t.push(e)}},c=[];for(const e of r)"list"===(null==e?void 0:e.type)&&Array.isArray(e.items)&&l(e.items,c);const u=e=>e.filter(e=>!!e.name||e.subitems&&e.subitems.length).map(e=>({name:e.name,path:e.path,subitems:e.subitems?u(e.subitems):[]}));let d=u(c);return d.length?d:null},t.visitTOC=function(e,t){e.forEach(function(e){t(e),e.subitems&&e.subitems.forEach(t)})};let T=!1;function k(t,i){if(T||function(){function t(t,n,i){let r=k(t,n).trim();if(r!=(i=i.trim()))throw e.log(`*** Template:\n${t}\n*** Input:\n${n}\n*** Expected:\n${i}\n*** Output:\n${r}`),new Error("augment docs test fail")}T=!0;let n="\n# T0\n## Examples #ex\n### Example 1\nTEx1\n### Example 2 #ex2\nTEx2\n### Example 3\nTEx3\n\n## See also #also\nTAlso\n",i="\n# @extends\n# #ex2\nMy example\n## See Also These! #also\nMy links\n",r="\n# T0\n## Examples #ex\n### Example 1\nTEx1\n### Example 2 #ex2\nMy example\n### Example 3\nTEx3\n\n## See Also These! #also\nMy links\n",s="\n# @extends\n### #ex\nFoo\n#### Example 1\nEx1\n#### Example 2x #ex2\nEx2\n## See Also These! #also\nMy links\n",o="\n# T0\n## Examples #ex\nFoo\n#### Example 1\nEx1\n#### Example 2x #ex2\nEx2\n## See Also These! #also\nMy links\n";t(n,"",n),t(n," ",n),t(n,i,r),t(n,s,o)}(),!i)return t;let r=v(t,null),s=v(i,r),o={},a={};for(let e of s.children)n.assert(0==e.children.length),n.assert(!!e.id),o[e.id]=e.text;let l=e=>{e.id&&void 0!==o[e.id]&&(a[e.id]=!0,e.text=o[e.id],e.children=[]),e.children.forEach(l)};l(r);let c="",u=e=>{c+=e.text,e.children.forEach(u)};u(r);let d="",p=s.text.replace(/^\s*#+\s*@extends.*/gm,"").replace(/^\s*\n/gm,"");p.trim()&&(d+=p.trim()+"\n");for(let e of s.children)a[e.id]||(d+=e.text);return d&&(c+="## Couldn't apply replacement logic to:\n"+d),c}t.augmentDocs=k}(e.docs||(e.docs={}))}(pxt||(pxt={})),function(e){!function(e){e.el=function(e,t,n){const i=document.createElement(e);return t&&Object.keys(t).forEach(e=>i.setAttribute(e,t[e]+"")),function e(t){Array.isArray(t)?t.forEach(t=>e(t)):"string"==typeof t?i.appendChild(document.createTextNode(t)):t instanceof HTMLElement&&i.appendChild(t)}(n),i}}(e.dom||(e.dom={}))}(pxt||(pxt={})),function(e){!function(t){function n(e){const t=/```package\s+((.|\s)+?)\s*```/i.exec(e);let n;return t&&(n={},t[1].split("\n").map(e=>e.replace(/\s*/g,"")).filter(e=>!!e).map(e=>e.split("=")).forEach(e=>n[e[0]]=e[1]||"*")),n}function i(e){const t=/```config\s+((.|\s)+?)\s*```/i.exec(e);let n=[];return t&&t[1].split("\n").map(e=>e.replace(/\s*/g,"")).filter(e=>!!e).map(e=>e.split("=")).filter(e=>"feature"==e[0]&&!!e[1]).forEach(e=>n.push(e[1])),n.length?n:void 0}function r(t){const n=/```jres\s+((.|\s)+?)\s*```/i.exec(t);if(n){const t=n[1],i=JSON.parse(t);return{jres:t,ts:e.emitTilemapsFromJRes(i)}}}function s(t){const n=/```assetjson\s+((.|\s)+?)\s*```/i.exec(t);return n?e.tutorial.parseAssetJson(n[1]):{}}function o(t){const n=/```simtheme\s+([\s\S]*?)```/i.exec(t);return n?e.tutorial.parseSimThemeJson(n[1]):{}}function a(t){let n=e.Util.jsonTryParse(t);return n&&!Array.isArray(n)&&(n=[n]),(null==n?void 0:n.length)?n:(n=t.split(/^---$/gm).filter(e=>!!e).map(e=>{let t={};return e.replace(/^\s*(?:-|\*)\s+(\w+)\s*:\s*(.*)$/gm,(e,n,i)=>{if("flags"==n)t[n]=i.split(",");else if("otherAction"===n){const e=i.split(",").map(e=>null==e?void 0:e.trim());(t.otherActions||(t.otherActions=[])).push({url:e[0],editor:e[1],cardType:e[2]})}else t[n]=i;return""}),!!Object.keys(t).length&&t}).filter(e=>!!e),(null==n?void 0:n.length)?n:void 0)}function l(t){if(!t)return[];const n=[];let i,r=!1,s="";return t.split(/\r?\n/).forEach(t=>{if(/^## /.test(t))i=t.substr(2).trim();else if(/^(### ~ |```)codecard$/.test(t))r=!0;else if(/^(### ~|```)$/.test(t)){if(r=!1,i&&s){const t=a(s);(null==t?void 0:t.length)?n.push({name:i,cards:t}):e.log("invalid gallery format")}s="",i=void 0}else r&&(s+=t+"\n")}),n.forEach(t=>t.cards.forEach(t=>{if(t.otherActions&&!t.otherActions.length&&("tutorial"==t.cardType||"example"==t.cardType)){const n=["js"];e.appTarget.appTheme.python&&n.unshift("py"),t.otherActions=n.map(e=>({url:t.url,cardType:t.cardType,editor:e}))}})),n}t.parsePackagesFromMarkdown=n,t.parseFeaturesFromMarkdown=i,t.parseJResFromMarkdown=r,t.parseTemplateProjectJSON=s,t.parseSimThemeJSON=o,t.parseExampleMarkdown=function(t,a){if(!a)return;const l=/```(blocks?|typescript|python|spy|sim)\s+((.|\s)+?)\s*```/i.exec(a);if(!l)return;const c=n(a),u=l[1],d=l[2],p=i(a),h=r(a),f=o(a),m={name:t,filesOverride:{[e.MAIN_BLOCKS]:'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',["python"===l[1]?e.MAIN_PY:e.MAIN_TS]:d},dependencies:c,features:p,snippetType:u,source:d,simTheme:f};return m.filesOverride=Object.assign(Object.assign({},m.filesOverride),s(a)),h&&(m.filesOverride[e.TILEMAP_JRES]=h.jres,m.filesOverride[e.TILEMAP_CODE]=h.ts),m},t.parseCodeCards=a,t.parseCodeCardsHtml=function(t){let n,i=[];return Array.from(t.children).forEach(e=>{"UL"===e.tagName||"OL"===e.tagName?(n||(n={}),Array.from(e.querySelectorAll("li")).forEach(e=>{const t=e.innerText,i=/^\s*(\w+)\s*:\s*(.*)$/.exec(t);if(i){const e=i[1];n[e]=i[2].trim(),"flags"===e&&(n[e]=n[e].split(/,\s*/))}})):"HR"==e.tagName&&(n&&i.push(n),n=void 0)}),n&&i.push(n),0===i.length&&"CODE"===t.tagName&&(i=e.Util.jsonTryParse(t.textContent)),!!(null==i?void 0:i.length)&&i},t.parseGalleryMardown=l,t.loadGalleryAsync=function(t){return e.Cloud.markdownAsync(t).then(e=>l(e))},t.codeCardsToMarkdown=function(e){return`### ~ codecard\n\n${(e||[]).map(e=>Object.keys(e).filter(t=>!!e[t]).map(t=>"otherActions"===t?e[t].map(e=>`* otherAction: ${e.url}, ${e.editor||""}, ${e.cardType||""}`).join("\n"):`* ${t}: ${e[t]}`).join("\n")).join("\n\n---\n\n")}\n\n### ~\n`}}(e.gallery||(e.gallery={}))}(pxt||(pxt={})),function(e){e.GDBServer=class{constructor(t){this.io=t,this.q=new e.U.PromiseQueue,this.dataBuf="",this.numSent=0,this.pktSize=400,this.trace=!1,this.bmpMode=!0,this.targetInfo="",this.onEvent=e=>{},this.io.onData=e=>this.onData(e)}onData(t){for(this.dataBuf+=e.U.uint8ArrayToString(t);this.dataBuf.length>0;){let e=this.dataBuf[0];if("+"==e)this.dataBuf=this.dataBuf.slice(1);else if("$"==e||"%"==e){let t=this.decodeResp(this.dataBuf.slice(1));if(null==t)break;"$"==e?(this.io.sendPacketAsync(this.buildCmd("+")),this.onResponse?this.onResponse(t):this.numSent>0&&this.io.error("unexpected response: "+t)):this.onEvent(t)}else this.io.error("invalid character: "+e)}}buildCmd(t){if("+"==t)return e.U.stringToUint8Array(t);let n="";for(let e=0;e<t.length;++e){let i=t.charAt(e);"}"==i||"#"==i||"$"==i?(n+="}",n+=String.fromCharCode(32^i.charCodeAt(0))):n+=i}let i=0;t=n;for(let e=0;e<t.length;++e)i=i+t.charCodeAt(e)&255;return n="$"+t+"#"+("0"+i.toString(16)).slice(-2),e.U.stringToUint8Array(n)}decodeResp(e){let t="";for(let n=0;n<e.length;++n){let i=e[n];if("}"==i)++n,t+=String.fromCharCode(32^e.charCodeAt(n));else if("*"==i){++n;let i=e.charCodeAt(n)-29,r=t.charAt(t.length-1);for(;i-- >0;)t+=r}else{if("#"==i){return 2==e.slice(n+1,n+3).length?(this.dataBuf=e.slice(n+3),t):null}t+=i}}return null}sendCmdOKAsync(e){return this.sendCmdAsync(e,e=>"OK"==e)}error(e){this.io.error(e),this.io.disconnectAsync()}sendCmdAsync(t,n){this.numSent++;const i=this.buildCmd(t);return this.q.enqueue("one",()=>null===n?this.io.sendPacketAsync(i).then(()=>null):new Promise(r=>{this.onResponse=i=>{this.onResponse=null,this.trace&&e.log(`GDB: '${t}' -> '${i}'`),void 0===n||n(i)||this.error(`Invalid GDB command response: '${t}' -> '${i}'`),r(i)},this.io.sendPacketAsync(i)}))}sendRCmdAsync(t){return this.sendMCmdAsync("qRcmd,"+(n=t,e.U.toHex(e.U.stringToUint8Array(n))));var n}sendMCmdAsync(t){this.numSent++;const n=this.buildCmd(t);let i="";return this.q.enqueue("one",()=>new Promise(r=>{this.onResponse=n=>{var s;"OK"!=n&&"O"==n[0]?i+=(s=n.slice(1),e.U.uint8ArrayToString(e.U.fromHex(s))):("OK"!=n&&(i+=" - "+n),this.onResponse=null,this.trace&&e.log(`Final GDB: '${t}' -> '${i}'`),r(i))},this.io.sendPacketAsync(n)}))}write32Async(t,n){let i=new Uint8Array(4);return e.HF2.write32(i,0,n),this.writeMemAsync(t,i)}writeMemAsync(t,n){const i=this.pktSize/2-10;return e.U.assert(n.length<i),this.sendCmdOKAsync("M"+t.toString(16)+","+n.length.toString(16)+":"+e.U.toHex(n)).then(t=>{e.log(t)})}readMemAsync(t,n){const i=this.pktSize/2-6;if(n>i){const r=new Uint8Array(n),s=o=>{const a=Math.min(n-o,i);return 0==a?Promise.resolve(r):this.readMemAsync(t+o,a).then(t=>(e.U.memcpy(r,o,t),s(o+a)))};return s(0)}return this.sendCmdAsync("m"+t.toString(16)+","+n.toString(16)).then(t=>e.U.fromHex(t))}initBMPAsync(){return Promise.resolve().then(()=>this.sendRCmdAsync("swdp_scan")).then(e=>(this.targetInfo=e,this.sendCmdAsync("vAttach;1",e=>"T"==e[0]))).then(()=>{})}initAsync(){return e.U.delay(1e3).then(()=>this.sendCmdAsync("!")).then(()=>this.sendCmdAsync("qSupported")).then(t=>{let n={};return t=(t=";"+t+";").replace(/;([^;]+)[=:]([^:;]+)/g,(e,t,i)=>(n[t]=i,";")),this.pktSize=parseInt(n.PacketSize)||1024,e.log("GDB-server caps: "+JSON.stringify(n)+" "+t.replace(/;+/g,";")),this.bmpMode?this.initBMPAsync():this.sendCmdAsync("c").then(()=>{})})}}}(pxt||(pxt={})),function(e){!function(t){function n(){var n,i;return!!t.forceProxy||!e.U.isNodeJS&&!(null===(i=null===(n=null==e?void 0:e.appTarget)||void 0===n?void 0:n.cloud)||void 0===i?void 0:i.noGithubProxy)}t.token=null,t.forceProxy=!1;const i={};function r(n){var i;return n.method=null!==(i=n.method)&&void 0!==i?i:"GET",function i(r){var s;const o=e.U.clone(n);t.token&&(o.headers||(o.headers={}),o.url==R?o.headers.Authorization=`bearer ${t.token}`:(o.url=e.BrowserUtils.cacheBustingUrl(o.url),o.headers.Authorization=`token ${t.token}`));return o.allowHttpErrors=null!==(s=o.allowHttpErrors)&&void 0!==s&&s,e.U.requestAsync(o).catch(n=>{if(e.tickEvent("github.error",{statusCode:n.statusCode}),t.handleGithubNetworkError){if(t.handleGithubNetworkError(o,n))return i(!1)}throw n})}(t.token)}function s(e){return r({url:e,method:"GET"}).then(e=>e.json)}function o(t){return e.Cloud.apiRequestWithCdnAsync({url:"gh/"+t,forceLiveEndpoint:!0}).then(e=>e.json)}function a(t){e.log(`github proxy error: ${t.message}`),e.debug(t)}t.isOrgAsync=function(e){return r({url:`https://api.github.com/orgs/${e}`,method:"GET",allowHttpErrors:!0}).then(e=>200==e.statusCode)};class l{constructor(){this.latestVersions={},this.configs={},this.packages={}}proxyWithCdnLoadPackageAsync(t,n){const i=`${t}/${n}`;let r=this.packages[i];if(r)return e.debug(`github cache ${t}/${n}/text`),Promise.resolve(r);const s=C(t);return o(A(s.slug,n,s.fileName,"text")).then(e=>this.packages[i]={files:e})}cacheConfig(t,n){const i=e.Package.parseAndValidConfig(n);return this.configs[t]=i,e.U.clone(i)}async loadConfigAsync(t,i){i||(e.debug("dep: default to master branch"),i="master");const r=`${t}/${i}`;let s=this.configs[r];if(s)return e.debug(`github cache ${t}/${i}/config`),e.U.clone(s);if(n())try{const n=await this.proxyWithCdnLoadPackageAsync(t,i);return this.cacheConfig(r,n.files[e.CONFIG_NAME])}catch(e){a(e)}const o=await u(t,i,e.CONFIG_NAME);return this.cacheConfig(r,o)}async latestVersionAsync(t,n){let i=this.latestVersions[t];return i||(e.debug(`dep: resolve latest version of ${t}`),this.latestVersions[t]=i=await e.github.latestVersionAsync(t,n,!0,!1)),i}async loadPackageAsync(t,i){if(i||(e.debug("load pkg: default to master branch"),i="master"),n())try{return await this.proxyWithCdnLoadPackageAsync(t,i).then(t=>e.U.clone(t))}catch(e){a(e)}return await this.githubLoadPackageAsync(t,i)}githubLoadPackageAsync(t,n){return _(t,n).then(i=>{const r=`${t}/${i}`;let s=this.packages[r];return s?(e.debug(`github cache ${t}/${n}/text`),Promise.resolve(e.U.clone(s))):(e.log(`Downloading ${t}/${n} -> ${i}`),u(t,i,e.CONFIG_NAME).then(n=>{const s={files:{}};s.files[e.CONFIG_NAME]=n;const o=JSON.parse(n);return e.U.promiseMapAll(e.allPkgFiles(o).slice(1),e=>u(t,i,e).then(t=>{s.files[e]=t})).then(()=>(this.packages[r]=s,e.U.clone(s)))}))})}async loadTutorialMarkdown(t,n){t=P(t);const i=(await d(t,n)).resp,r=i.markdown;return e.Util.assert("object"==typeof r),await this.cacheReposAsync(i),r.repo}async cacheReposAsync(e){if("object"==typeof e.markdown){const t=e.markdown;this.cacheRepo(t.repo)}for(const t of e.dependencies)this.cacheRepo(t)}cacheRepo(e){let t=e.repo;e.subPath&&(t+="/"+e.subPath);let n=t;n+="/"+e.sha,this.packages[n]={files:e.files},e.latestVersion&&this.cacheLatestVersion(t,e.latestVersion);const i=e.files["pxt.json"];if(i){const t=n+"/"+(e.version||"master");this.cacheConfig(n,i),this.cacheConfig(t,i)}}cacheLatestVersion(e,t){this.latestVersions[e]=t}}function c(t,n,s){return r({url:"https://api.github.com/repos/"+A(t.slug,"contents",t.fileName,s+"?ref="+n),method:"GET"}).then(n=>{const r=n.json;return i[t.slug]=!0,r&&"base64"==r.encoding&&null!=r.content?e.Util.fromUTF8(atob(r.content)):e.U.httpGetTextAsync(r.download_url)})}function u(t,n,r){const s=C(t);return i[s.slug]?c(s,n,r):e.U.requestAsync({url:"https://raw.githubusercontent.com/"+A(s.slug,n,s.fileName,r),allowHttpErrors:!0}).then(e=>200==e.statusCode?e.text:c(s,n,r))}async function d(t,n,i,r){let s=e.Cloud.apiRequestWithCdnAsync;const o=new URLSearchParams;n&&o.set("ref",n),i&&(o.set("noCache","1"),s=e.Cloud.privateRequestAsync);let a=`ghtutorial/${t}`;a=e.BrowserUtils.appendUrlQueryParams(a,o);const l=r?{"If-None-Match":r}:void 0,c=await s({url:a,method:"GET",headers:l});let u;return u=304===c.statusCode?void 0:c.json,{resp:u,etag:c.headers.etag}}function p(e,t,n,i){return r({url:/^https:/.test(e)?e:"https://api.github.com/repos/"+e,headers:n,method:i||"POST",data:t,successCodes:[200,201,202,204]}).then(e=>e.json)}function h(e,t){let n=1;for(;e.refs[t+n];)n++;return t+n}async function f(e,t,n){return await p(e+"/git/refs",{ref:"refs/heads/"+t,sha:n}),t}function m(i,r="tags",o,a){const l=C(i),c=(u=o,!!t.forceProxy||!(t.token&&!u)&&n());var u;let d=null;const p=c?e.U.httpGetJsonAsync(e.BrowserUtils.cacheBustingUrl(`${e.Cloud.apiRoot}gh/${l.slug}/refs${a?"?nocache=1":""}`)).then(t=>{let n=Object.keys(t.refs).filter(t=>e.U.startsWith(t,"refs/"+r+"/")).map(e=>({ref:e,object:{sha:t.refs[e]}}));return d=t.refs.HEAD,n}):s(`https://api.github.com/repos/${l.slug}/git/refs/${r}/?per_page=100`);let h=e=>e.replace(/^refs\/[^\/]+\//,"");return p.then(t=>{t.sort((t,n)=>e.semver.strcmp(h(t.ref),h(n.ref)));let n={};for(let e of t)n[h(e.ref)]=e.object.sha;return{refs:n,head:d}},e=>404==e.statusCode?{refs:{}}:Promise.reject(e))}function g(e){return"commit"==e.object.type?Promise.resolve(e.object.sha):"tag"==e.object.type?s(e.object.url).then(e=>"commit"==e.object.type?e.object.sha:Promise.reject(new Error("Bad type (2nd order) "+e.object.type))):Promise.reject(new Error("Bad type "+e.object.type))}function _(e,t){if(/^[a-f0-9]{40}$/.test(t))return Promise.resolve(t);const n=C(e);return s(`https://api.github.com/repos/${n.slug}/git/refs/tags/${t}`).then(g,e=>s(`https://api.github.com/repos/${n.slug}/git/refs/heads/${t}`).then(g))}async function y(e,n,i){return n||(n=await t.db.latestVersionAsync(e,i)),await t.db.loadConfigAsync(e,n)}async function b(n,i){const r=C(n);if(!r)return void e.log("Unknown GitHub syntax");if(E(r,i))return e.tickEvent("github.download.banned"),void e.log("Github repo is banned");r.tag||(r.tag=await t.db.latestVersionAsync(r.slug,i));const s=await t.db.loadPackageAsync(r.fullName,r.tag),o=D(i,n);if(o){const t=e.Package.parseAndValidConfig(s.files[e.CONFIG_NAME]);t&&(e.log(`auto-disable ${o.join(",")} due to targetconfig entry for ${n}`),t.disablesVariants=o,s.files[e.CONFIG_NAME]=e.Package.stringifyConfig(t))}return s}let v;function T(t){return e.Cloud.cdnApiUrl(`gh/${t.fullName}/icon`)}function k(e,t){var n;if(!e)return;const i={owner:e.owner.login.toLowerCase(),slug:e.full_name.toLowerCase(),fullName:((null==t?void 0:t.fullName)||e.full_name).toLowerCase(),fileName:null===(n=null==t?void 0:t.fileName)||void 0===n?void 0:n.toLocaleLowerCase(),name:e.name,description:e.description,defaultBranch:e.default_branch,tag:null==t?void 0:t.tag,updatedAt:Math.round(new Date(e.updated_at).getTime()/1e3),fork:e.fork,private:e.private};return i.status=x(i,null==t?void 0:t.config),i}function x(e,t){return e?E(e,t)?v.Banned:function(e,t){var n,i;if(function(e,t){return!(!e||!t)&&!!(e.owner&&t.approvedOrgs&&t.approvedOrgs.some(t=>t.toLowerCase()==e.owner.toLowerCase()))}(e,t))return!0;const r=null===(n=null==e?void 0:e.fullName)||void 0===n?void 0:n.toLowerCase(),s=null===(i=null==e?void 0:e.slug)||void 0===i?void 0:i.toLowerCase();return!(!(null==t?void 0:t.approvedRepoLib)||!r&&!s)&&!(!t.approvedRepoLib[r]&&!t.approvedRepoLib[s])}(e,t)?v.Approved:v.Unknown:v.Unknown}function E(e,t){var n,i;if(function(e,t){return!(!t||e&&e.owner&&(!t.bannedOrgs||!t.bannedOrgs.some(t=>t.toLowerCase()==e.owner.toLowerCase())))}(e,t))return!0;if(!t)return!1;if(!e)return!0;const r=null===(n=e.fullName)||void 0===n?void 0:n.toLowerCase(),s=null===(i=e.slug)||void 0===i?void 0:i.toLowerCase();return!(!t.bannedRepos||!t.bannedRepos.some(e=>e&&(e.toLowerCase()==r||e.toLowerCase()==s)))}async function S(t,i){const r=C(t);if(!r)return;const l=x(r,i);if(l==v.Banned)return;if(n())try{return await function(t,n){return o(t.slug).then(e=>{if(e)return{github:!0,owner:t.owner,fullName:t.fullName,fileName:t.fileName,slug:t.slug,name:t.fileName?`${e.name}-${t.fileName}`:e.name,displayName:e.displayName,description:e.description,defaultBranch:e.defaultBranch||"master",tag:t.tag,status:n}}).catch(t=>{e.reportException(t)})}(r,l)}catch(e){a(e)}return k(await s("https://api.github.com/repos/"+r.slug),{config:i,fullName:r.fullName,fileName:r.fileName,tag:r.tag})}function C(e){if(!e)return;e=(e=e.trim()).replace(/\/$/,"");const t=/^https:\/\/([^./#]+)\.github\.io\/([^/#]+)\/?$/i.exec(e);t&&(e=`github:${t[1]}/${t[2]}`),e=(e=(e=e.replace(/^github:/i,"")).replace(/^https:\/\/github\.com\//i,"")).replace(/\.git\b/i,"");const n=/^([^#\/:]+)\/([^#\/:]+)(\/([^#]+))?(#([^\/:]*))?$/.exec(e);if(!n)return;const i=n[1],r=n[2];let s=n[4];const o=n[6],a=s&&/^tree\/([^\/]+\/)/.exec(s);return a&&(s=s.slice(a[0].length)),{owner:i,project:r,slug:A(i,r),fullName:A(i,r,s),tag:o,fileName:s}}function w(e){return!!e&&"github:"==e.slice(0,7)}function I(e,t=!1){return e?"github:"+(t?e.fullName:e.fullName.toLowerCase())+(e.tag?`#${e.tag}`:""):void 0}function A(...e){return e.filter(e=>!!e).join("/")}function N(t,n){var i;if(!t)return null;const r=C(n);if(!r)return null;t.approvedRepoLib;return t.approvedRepoLib&&(null===(i=e.U.lookup(t.approvedRepoLib,r.slug.toLowerCase()))||void 0===i?void 0:i.upgrades)}function D(e,t){const n=N(e,t)||[];if(!n)return null;for(const e of n){const t=/^dv:(.*)/.exec(e);if(t){const e=t[1].split(/,/);return e.some(e=>!/^\w+$/.test(e))?null:e}}return null}function O(t,n,i,r){const s=C(t);return s?S(s.slug,n).then(t=>{if(t)return m(t.slug,"tags",i,r).then(i=>{let r=Object.keys(i.refs);r=e.semver.sortLatestTags(r);const o=e.appTarget.versions&&e.semver.tryParse(e.appTarget.versions.target);if(o&&n.releases&&n.releases["v"+o.major]){const i=n.releases["v"+o.major].map(t=>e.github.parseRepoId(t)).filter(e=>e&&e.fullName.toLowerCase()==s.fullName.toLowerCase())[0];if(i){if(r.some(e=>e==i.tag))return e.debug(`approved release ${i.fullName}#${i.tag} for v${o.major}`),Promise.resolve(i.tag);e.reportError("packages",`approved release ${i.fullName}#${i.tag} for v${o.major} not found anymore`,{repo:t.fullName})}}return r[0]?Promise.resolve(r[0]):i.head||_(t.slug,t.defaultBranch)})}):Promise.resolve(null)}t.MemoryGithubDb=l,t.downloadTextAsync=u,t.downloadMarkdownTutorialInfoAsync=d,t.downloadTutorialMarkdownAsync=async function(e,n){return t.db.loadTutorialMarkdown(e,n)},t.db=new l,t.authenticatedUserAsync=function(){return t.token?s("https://api.github.com/user"):Promise.resolve(void 0)},t.getCommitsAsync=function(e,t){return s("https://api.github.com/repos/"+C(e).slug+"/commits?sha="+t).then(e=>e.map(e=>{const t=e.commit;return t.url=e.url,t.sha=e.sha,t}))},t.getCommitAsync=function(e,t){return s("https://api.github.com/repos/"+C(e).slug+"/git/commits/"+t).then(e=>s(e.tree.url+"?recursive=1").then(t=>(e.tree=t,e)))},t.createObjectAsync=function(e,t,n){return p(C(e).slug+"/git/"+t+"s",n).then(e=>e.sha)},t.postCommitComment=function(e,t,n,i,r){return p(`${C(e).slug}/commits/${t}/comments`,{body:n,path:i,position:r}).then(e=>e.id)},t.fastForwardAsync=async function(e,t,n){const i=C(e);return 200==(await r({url:`https://api.github.com/repos/${i.slug}/git/refs/heads/${t}`,method:"PATCH",allowHttpErrors:!0,data:{sha:n,force:!1}})).statusCode},t.putFileAsync=async function(t,n,i){const s=C(t);await r({url:`https://api.github.com/repos/${e.github.join(s.slug,"contents",s.fileName,n)}`,method:"PUT",allowHttpErrors:!0,data:{message:lf("Initialize empty repo"),content:btoa(e.U.toUTF8(i)),branch:"master"},successCodes:[201]})},t.createTagAsync=async function(e,t,n){await p(e+"/git/refs",{ref:"refs/tags/"+t,sha:n})},t.createReleaseAsync=async function(e,t,n){await p(e+"/releases",{tag_name:t,target_commitish:n,name:t,draft:!1,prerelease:!1})},t.createPRFromBranchAsync=async function(e,t,n,i,r){const s=await p(e+"/pulls",{title:i,body:r||lf("Automatically created from MakeCode."),head:n,base:t,maintainer_can_modify:!0});return null==s?void 0:s.html_url},t.mergeAsync=function(t,n,i,s){return r({url:`https://api.github.com/repos/${C(t).slug}/merges`,method:"POST",successCodes:[201,204,409],data:{base:n,head:i,commit_message:s}}).then(n=>{if(201==n.statusCode||204==n.statusCode)return n.json.sha;if(409==n.statusCode)return null;throw e.U.userError(lf("Cannot merge in github.com/{1}; code: {2}",t,n.statusCode))})},t.getRefAsync=function(e,t){return s("https://api.github.com/repos/"+e+"/git/refs/heads/"+(t=t||"master")).then(g).catch(e=>{404!=e.statusCode&&Promise.reject(e)})},t.getNewBranchNameAsync=async function(e,t="patch-"){return h(await m(e,"heads"),t)},t.createNewBranchAsync=f,t.forkRepoAsync=async function(t,n,i="pr-"){const r=C(t),s=k(await p(`${r.slug}/forks`,{}),{fullName:r.fullName,fileName:r.fileName}),o=Date.now()+3e5;let a=null;for(;!a&&Date.now()<o;){await e.U.delay(1e3);try{a=await m(s.slug,"heads")}catch(e){}}if(!a)throw new Error(lf("Timeout waiting for fork"));const l=h(a,i);return await f(s.slug,l,n),s.fullName+"#"+l},t.listRefsAsync=function(e,t="tags",n,i){return m(e,t,n,i).then(e=>Object.keys(e.refs))},t.listRefsExtAsync=m,t.pkgConfigAsync=y,t.downloadPackageAsync=b,t.downloadLatestPackageAsync=async function(t,n,i){const r=await e.packagesConfigAsync(),s=await e.github.latestVersionAsync(t.slug,r,n,i),o=`${t.fullName}#${s}`;return await e.github.downloadPackageAsync(o,r),{version:`github:${o}`,config:await y(t.fullName,s,r)}},t.cacheProjectDependenciesAsync=async function(t){var n;const i=null===(n=Object.keys(t.dependencies))||void 0===n?void 0:n.filter(e=>w(t.dependencies[e]));if(i.length){const n=await e.packagesConfigAsync();await Promise.all(i.map(async e=>{const i=t.dependencies[e];if(!await b(i,n))throw new Error(lf("Cannot load extension {0} from {1}",e,i))}))}},function(e){e[e.Unknown=0]="Unknown",e[e.Approved=1]="Approved",e[e.Banned=2]="Banned"}(v=t.GitRepoStatus||(t.GitRepoStatus={})),t.isDefaultBranch=function(e,t){return t&&t.defaultBranch?e===t.defaultBranch:/^(main|master)$/.test(e)},t.listUserReposAsync=function(){return L('{\n  viewer {\n    repositories(first: 100, affiliations: [OWNER, COLLABORATOR], orderBy: {field: PUSHED_AT, direction: DESC}) {\n      nodes {\n        name\n        description\n        full_name: nameWithOwner\n        private: isPrivate\n        fork: isFork\n        updated_at: updatedAt\n        owner {\n          login\n        }\n        defaultBranchRef {\n          name\n        }\n        pxtjson: object(expression: "HEAD:pxt.json") {\n          ... on Blob {\n            text\n          }\n        }\n        readme: object(expression: "HEAD:README.md") {\n          ... on Blob {\n            text\n          }\n        }\n      }\n    }\n  }\n}').then(t=>t.data.viewer.repositories.nodes.filter(e=>e.pxtjson).filter(t=>{t.default_branch=t.defaultBranchRef.name;const n=e.Package.parseAndValidConfig(t.pxtjson&&t.pxtjson.text),i=t.readme&&t.readme.text;return!!n&&(n.supportedTargets?n.supportedTargets.indexOf(e.appTarget.id)>-1:i&&i.indexOf("PXT/"+e.appTarget.id)>-1)}).map(e=>k(e,{fullName:e.full_name})))},t.createRepoAsync=function(e,t,n){return p("https://api.github.com/user/repos",{name:e,description:t,private:!!n,has_issues:!0,has_projects:!1,has_wiki:!1,allow_rebase_merge:!1,allow_merge_commit:!0,delete_branch_on_merge:!1}).then(e=>k(e))},t.enablePagesAsync=async function(t){const n=C(t);let i;try{const e=await s(`https://api.github.com/repos/${n.slug}/pages`);e&&(i=e.html_url)}catch(e){}if(!i)try{i=(await p(`https://api.github.com/repos/${n.slug}/pages`,{source:{branch:"master",path:"/"}},{Accept:"application/vnd.github.switcheroo-preview+json"})).html_url}catch(t){e.tickEvent("github.pages.error"),e.reportException(t)}if(i){const n=await s(`https://api.github.com/repos/${t}`);if(n&&!n.homepage)try{await p(`https://api.github.com/repos/${t}`,{homepage:i},void 0,"PATCH")}catch(t){e.tickEvent("github.homepage.error")}}},t.repoIconUrl=function(e){if(e.status==v.Approved)return T(e)},t.mkRepoIconUrl=T,t.repoStatus=x,t.isRepoHidden=function(e,t){var n,i;if(!e||!t)return!0;const r=null===(n=e.fullName)||void 0===n?void 0:n.toLowerCase(),s=null===(i=e.slug)||void 0===i?void 0:i.toLowerCase(),o=t.approvedRepoLib[r]||t.approvedRepoLib[s];return!(!o||!o.hidden)},t.repoAsync=S,t.searchAsync=function(t,n){if(!n)return Promise.resolve([]);let i=t.split("|").map(C).filter(e=>!!e);return i.length>0?Promise.all(i.map(e=>S(e.fullName,n))).then(e=>e.filter(e=>e&&e.status!=v.Banned)):e.U.httpGetJsonAsync(`${e.Cloud.apiRoot}ghsearch/${e.appTarget.id}/${e.appTarget.platformid||e.appTarget.id}?q=${encodeURIComponent(t)}`).then(t=>t.items.map(e=>k(e,{config:n,fullName:e.full_name})).filter(e=>e.status==v.Approved||n.allowUnapproved&&e.status==v.Unknown).filter(t=>!e.appTarget.appTheme.githubUrl||`https://github.com/${t.fullName}`!=e.appTarget.appTheme.githubUrl.toLowerCase())).catch(e=>[])},t.parseRepoId=C,t.toGithubDependencyPath=function(e,t){let n="github:"+e;return t&&(n+="#"+t),n},t.isGithubId=w,t.stringifyRepo=I,t.normalizeRepoId=function(e,t){const n=C(e);if(n)return!n.tag&&t&&(n.tag=t),I(n)},t.join=A,t.upgradedPackageReferenceAsync=async function t(n,i){const r=N(n,i);if(!r)return null;for(const s of r){const r=/^move:(.*)$/.exec(s);if(r){const s=C(r[1]);if(s){s.tag||(s.tag=await O(r[1],n));const o=C(i);!s.fileName&&o.fileName&&(s.fileName=o.fileName,s.fullName=A(s.owner,s.project,s.fileName));const a=I(s);e.debug(`upgrading ${i} to ${a}}`);const l=await t(n,a);return l||a}e.log(`cannot parse move target: ${r[1]}`)}const o=/^min:(.*)/.exec(s),a=o&&e.semver.tryParse(o[1]);if(a){const t=C(i),n=e.semver.tryParse(t.tag);return n&&e.semver.cmp(n,a)<0?(t.tag=o[1],e.debug(`upgrading ${i} to ${o[1]}`),I(t)):(n||e.log(`not upgrading ${i} - cannot parse version`),null)}D(n,i)||e.log(`invalid upgrade rule: ${i} -> ${s}`)}return i},t.upgradedPackageId=function(e,t){const n=D(e,t);return n?t+"?dv="+n.join(","):t},t.latestVersionAsync=O,t.resolveMonoRepoVersions=function(n){n=e.Util.clone(n);const i={};return Object.keys(n).map(e=>({id:e,ghid:t.parseRepoId(n[e])})).filter(e=>{var t;return null===(t=e.ghid)||void 0===t?void 0:t.tag}).forEach(t=>{const{id:n,ghid:r}=t;let s=i[r.slug];s||(s=i[r.slug]={tag:r.tag,deps:[]}),s.deps.push(t),e.semver.strcmp(s.tag,r.tag)<0&&(e.debug(`dep: resolve later monorepo tag to ${e.github.stringifyRepo(r)}`),s.tag=r.tag)}),e.U.values(i).forEach(t=>t.deps.forEach(i=>{i.ghid.tag!==t.tag&&(e.debug(`dep: ${e.github.stringifyRepo(i.ghid)} -> ${t.tag}`),i.ghid.tag=t.tag,n[i.id]=e.github.stringifyRepo(i.ghid))})),n},t.GIT_JSON=".git.json";const R="https://api.github.com/graphql";function L(e){const t=JSON.stringify({query:e});return p(R,t)}function P(e){if(/^github\:/i.test(e)&&(e=e.slice(7)),/^https?\:/i.test(e)){e=new URL(e).pathname.slice(1);const t=/^((?:[^\/]+\/){2})blob\/[^\/]+\/(.*)\.md$/.exec(e);t&&(e=t[1]+t[2])}return e}t.lookupFile=function(e,t,n){if(!t)return null;const i=A(e.fileName,n);return t.tree.tree.find(e=>e.path==i)},t.ghGraphQLQueryAsync=L,t.findPRNumberforBranchAsync=function(e,t){const n=C(e);return L(`\n{\n    repository(owner: ${JSON.stringify(n.owner)}, name: ${JSON.stringify(n.project)}) {\n        pullRequests(last: 1, states: [OPEN, MERGED], headRefName: ${JSON.stringify(t)}) {\n            edges {\n                node {\n                    number\n                    state\n                    mergeable\n                    baseRefName\n                    url\n                    isDraft\n                }\n            }\n        }\n    }\n}\n`).then(e=>{const t=e.data.repository.pullRequests.edges[0];if(t&&t.node){const e=t.node;return{number:e.number,mergeable:e.mergeable,state:e.state,title:e.title,url:e.url,base:e.baseRefName}}return{number:-1}})},t.getPagesStatusAsync=function(e){return s(`https://api.github.com/repos/${e}/pages`).catch(e=>({status:null}))},t.normalizeTutorialPath=P}(e.github||(e.github={}))}(pxt||(pxt={})),function(e){let t;e.REFCNT_FLASH="0xfffe",e.VTABLE_MAGIC=249,e.ValTypeObject=4,function(e){e[e.BoxedString=1]="BoxedString",e[e.BoxedNumber=2]="BoxedNumber",e[e.BoxedBuffer=3]="BoxedBuffer",e[e.RefAction=4]="RefAction",e[e.RefImage=5]="RefImage",e[e.RefCollection=6]="RefCollection",e[e.RefRefLocal=7]="RefRefLocal",e[e.RefMap=8]="RefMap",e[e.RefMImage=9]="RefMImage",e[e.MMap=10]="MMap",e[e.BoxedString_SkipList=11]="BoxedString_SkipList",e[e.BoxedString_ASCII=12]="BoxedString_ASCII",e[e.ZPin=13]="ZPin",e[e.User0=16]="User0"}(t=e.BuiltInType||(e.BuiltInType={}))}(pxt||(pxt={})),function(e){!function(t){function n(e,t,n){e[t+0]=255&n,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255}function i(e,t,n){e[t+0]=255&n,e[t+1]=n>>8&255}function r(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return e[t]|e[t+1]<<8}function o(e){let t=new Uint8Array(4*e.length);for(let i=0;i<e.length;++i)n(t,4*i,e[i]);return t}t.HF2_CMD_BININFO=1,t.HF2_MODE_BOOTLOADER=1,t.HF2_MODE_USERSPACE=2,t.HF2_CMD_INFO=2,t.HF2_CMD_RESET_INTO_APP=3,t.HF2_CMD_RESET_INTO_BOOTLOADER=4,t.HF2_CMD_START_FLASH=5,t.HF2_CMD_WRITE_FLASH_PAGE=6,t.HF2_CMD_CHKSUM_PAGES=7,t.HF2_CMD_READ_WORDS=8,t.HF2_CMD_WRITE_WORDS=9,t.HF2_CMD_DMESG=16,t.HF2_FLAG_SERIAL_OUT=128,t.HF2_FLAG_SERIAL_ERR=192,t.HF2_FLAG_CMDPKT_LAST=64,t.HF2_FLAG_CMDPKT_BODY=0,t.HF2_FLAG_MASK=192,t.HF2_SIZE_MASK=63,t.HF2_STATUS_OK=0,t.HF2_STATUS_INVALID_CMD=1,t.HF2_STATUS_EXEC_ERR=2,t.HF2_STATUS_EVENT=128,t.HF2_CMD_JDS_CONFIG=32,t.HF2_CMD_JDS_SEND=33,t.HF2_EV_JDS_PACKET=8388640,t.CUSTOM_EV_JACDAC="jacdac",t.HF2_EV_MASK=8388608,t.write32=n,t.write16=i,t.read32=r,t.read16=s,t.encodeU32LE=o,t.decodeU32LE=function(e){let t=[];for(let n=0;n<e.length;n+=4)t.push(r(e,n));return t};let a=!1;function l(t){a?e.log("HF2: "+t):e.debug("HF2: "+t)}t.enableLog=function(){a=!0};class c{constructor(n){var i;this.io=n,this.initialized=!1,this.cmdSeq=e.U.randomUint32(),this.lock=new e.U.PromiseQueue,this.flashing=!1,this.rawMode=!1,this.maxMsgSize=63,this.bootloaderMode=!1,this.reconnectTries=0,this.autoReconnect=!1,this.icon=(null===(i=e.appTarget.appTheme.downloadDialogTheme)||void 0===i?void 0:i.deviceIcon)||"usb",this.msgs=new e.U.PromiseBuffer,this.eventHandlers={},this.jacdacAvailable=!1,this.onSerial=(e,t)=>{},this.onCustomEvent=(e,t)=>{},this.onConnectionChanged=()=>{};let s=[];n.onDeviceConnectionChanged=e=>this.disconnectAsync().then(()=>e&&this.reconnectAsync()),n.onSerial=(e,t)=>this.onSerial(e,t),n.onData=i=>{let r=i[0]&t.HF2_FLAG_MASK,o=63&i[0],a=new Uint8Array(o);if(e.U.memcpy(a,0,i,1,o),r&t.HF2_FLAG_SERIAL_OUT)this.onSerial(a,r==t.HF2_FLAG_SERIAL_ERR);else if(s.push(a),r!=t.HF2_FLAG_CMDPKT_BODY){e.U.assert(r==t.HF2_FLAG_CMDPKT_LAST);let i=0;for(let e of s)i+=e.length;let o=new Uint8Array(i),a=0;for(let t of s)e.U.memcpy(o,a,t),a+=t.length;s=[],o[2]&t.HF2_STATUS_EVENT?n.onEvent(o):this.msgs.push(o)}},n.onEvent=t=>{let n=r(t,0),i=e.U.lookup(this.eventHandlers,n+"");i?i(t.slice(4)):l("unhandled event: "+n.toString(16))},n.onError=e=>{l("recv error: "+e.message),this.autoReconnect&&(this.autoReconnect=!1,this.reconnectAsync().then(()=>{this.autoReconnect=!0},e=>{l("reconnect error: "+e.message)}))},this.onEvent(t.HF2_EV_JDS_PACKET,e=>{this.onCustomEvent(t.CUSTOM_EV_JACDAC,e)})}resetState(){this.initialized=!1,this.lock=new e.U.PromiseQueue,this.info=null,this.infoRaw=null,this.pageSize=null,this.flashSize=null,this.maxMsgSize=63,this.bootloaderMode=!1,this.msgs.drain()}onEvent(n,i){e.U.assert(!!(n&t.HF2_EV_MASK)),this.eventHandlers[n+""]=i}sendCustomEventAsync(e,n){return e==t.CUSTOM_EV_JACDAC?this.jacdacAvailable?this.talkAsync(t.HF2_CMD_JDS_SEND,n).then(()=>{}):Promise.resolve():Promise.reject(new Error("invalid custom event type"))}isConnected(){return this.io.isConnected()&&this.initialized}isConnecting(){return this.io.isConnecting()||this.io.isConnected()&&!this.initialized}reconnectAsync(){return this.resetState(),l(`reconnect raw=${this.rawMode}`),this.io.reconnectAsync().then(()=>this.initAsync()).catch(t=>{if(this.reconnectTries<5)return this.reconnectTries++,l(`error ${t.message}; reconnecting attempt #${this.reconnectTries}`),e.U.delay(500).then(()=>this.reconnectAsync());throw t})}disconnectAsync(){return l("disconnect"),this.io.disconnectAsync()}error(e){return this.io.error(e)}talkAsync(r,o){if(this.io.talksAsync)return this.io.talksAsync([{cmd:r,data:o}]).then(e=>e[0]);let a=8;o&&(a+=o.length);let c=new Uint8Array(a),u=65535&++this.cmdSeq;n(c,0,r),i(c,4,u),i(c,6,0),o&&e.U.memcpy(c,8,o,0,o.length);let d=0,p=()=>this.msgs.shiftAsync(1e3).then(e=>{if(s(e,0)!=u){if(d<3)return d++,l(`message out of sync, (${u} vs ${s(e,0)}); will re-try`),p();this.error("out of sync")}let n="";switch(e[3]&&(n="; info="+e[3]),e[2]){case t.HF2_STATUS_OK:return e.slice(4);case t.HF2_STATUS_INVALID_CMD:this.error("invalid command"+n);break;case t.HF2_STATUS_EXEC_ERR:this.error("execution error"+n);break;default:this.error("error "+e[2]+n)}return null});return this.sendMsgAsync(c).then(p)}sendMsgAsync(e){return this.sendMsgCoreAsync(e)}sendSerialAsync(e,t=!1){return this.io.sendSerialAsync?this.io.sendSerialAsync(e,t):this.sendMsgCoreAsync(e,t?2:1)}sendMsgCoreAsync(e,n=0){let i=new Uint8Array(64),r=s=>{let o=e.length-s;if(o<=0)return Promise.resolve();o>63?(o=63,i[0]=t.HF2_FLAG_CMDPKT_BODY):i[0]=t.HF2_FLAG_CMDPKT_LAST,n&&(i[0]=1==n?t.HF2_FLAG_SERIAL_OUT:t.HF2_FLAG_SERIAL_ERR),i[0]|=o;for(let t=0;t<o;++t)i[t+1]=e[s+t];return this.io.sendPacketAsync(i).then(()=>r(s+o))};return this.lock.enqueue("out",()=>r(0))}switchToBootloaderAsync(){return this.bootloaderMode?Promise.resolve():(l("Switching into bootloader mode"),this.io.isSwitchingToBootloader&&this.io.isSwitchingToBootloader(),this.maybeReconnectAsync().then(()=>this.talkAsync(t.HF2_CMD_START_FLASH).then(()=>{},e=>this.talkAsync(t.HF2_CMD_RESET_INTO_BOOTLOADER).then(()=>{},e=>{}).then(()=>this.reconnectAsync().catch(e=>{throw"devicenotfound"===e.type&&(e.type="repairbootloader"),e})))).then(()=>this.initAsync()).then(()=>{this.bootloaderMode||this.error("cannot switch into bootloader mode")}))}isFlashing(){return!!this.flashing}reflashAsync(t){l("reflash"),e.U.assert(e.appTarget.compile.useUF2);const n=t.outfiles[pxtc.BINARY_UF2],i=pxtc.UF2.parseFile(e.Util.stringToUint8Array(atob(n)));return this.flashing=!0,this.io.reconnectAsync().then(()=>this.flashAsync(i)).then(()=>e.U.delay(100)).finally(()=>this.flashing=!1).then(()=>this.reconnectAsync())}writeWordsAsync(n,i){return e.U.assert(i.length<=64),this.talkAsync(t.HF2_CMD_WRITE_WORDS,o([n,i.length].concat(i))).then(()=>{})}readWordsAsync(i,r){let s=new Uint8Array(8);return n(s,0,i),n(s,4,r),e.U.assert(r<=64),this.talkAsync(t.HF2_CMD_READ_WORDS,s)}pingAsync(){return this.rawMode?Promise.resolve():this.talkAsync(t.HF2_CMD_BININFO).then(e=>{})}maybeReconnectAsync(){return this.pingAsync().catch(e=>this.reconnectAsync().then(()=>this.pingAsync()))}flashAsync(i){let r=Date.now(),s=0,o=r=>{if(r>=i.length)return Promise.resolve();let s=i[r],a=new Uint8Array(4+s.payloadSize);return n(a,0,s.targetAddr),e.U.memcpy(a,4,s.data,0,s.payloadSize),this.talkAsync(t.HF2_CMD_WRITE_FLASH_PAGE,a).then(()=>o(r+1))};return this.switchToBootloaderAsync().then(()=>{let e=256*i.length;return l(`Starting flash (${Math.round(e/1024)}kB).`),s=Date.now(),this.pageSize>16384?i:u(i,(e,t)=>this.readWordsAsync(e,t))}).then(e=>{if(e.length!=i.length){let t=256*(i=e).length;l(`Performing partial flash (${Math.round(t/1024)}kB).`)}}).then(()=>o(0)).then(()=>{let e=Date.now(),t=e-r,n=e-s;l(`Flashing done at ${Math.round(256*i.length/n*1e3/1024)} kB/s in ${t}ms (reset ${t-n}ms). Resetting.`)}).then(()=>this.talkAsync(t.HF2_CMD_RESET_INTO_APP).catch(e=>{})).then(()=>{})}initAsync(){return this.rawMode?(this.initialized=!0,Promise.resolve()):Promise.resolve().then(()=>this.talkAsync(t.HF2_CMD_BININFO)).then(e=>(this.bootloaderMode=e[0]==t.HF2_MODE_BOOTLOADER,this.pageSize=r(e,4),this.flashSize=r(e,8)*this.pageSize,this.maxMsgSize=r(e,12),this.familyID=r(e,16),l(`Connected; msgSize ${this.maxMsgSize}B; flash ${this.flashSize/1024}kB; ${this.bootloaderMode?"bootloader":"application"} mode; family=0x${this.familyID.toString(16)}`),this.talkAsync(t.HF2_CMD_INFO))).then(t=>{this.infoRaw=e.Util.fromUTF8Array(t),e.debug("Info: "+this.infoRaw);let n={};("Header: "+this.infoRaw).replace(/^([\w\-]+):\s*([^\n\r]*)/gm,(e,t,i)=>(n[t.replace(/-/g,"")]=i,"")),this.info=n;let i=/v(\d\S+)(\s+(\S+))?/.exec(this.info.Header);this.info.Parsed=i?{Version:i[1],Features:i[3]||""}:{Version:"?",Features:""},l(`Board-ID: ${this.info.BoardID} v${this.info.Parsed.Version} f${this.info.Parsed.Features}`)}).then(()=>this.talkAsync(t.HF2_CMD_JDS_CONFIG,new Uint8Array([1])).then(()=>{this.jacdacAvailable=!0},e=>{this.jacdacAvailable=!1})).then(()=>{this.reconnectTries=0,this.initialized=!0,this.io.onConnectionChanged()})}}function u(t,n){if(!e.appTarget.compile.flashChecksumAddr)return Promise.resolve(t);let i=pxtc.UF2.readBytes(t,e.appTarget.compile.flashChecksumAddr,48),s=pxtc.parseChecksumBlock(i);return s?function(t){return e.appTarget.compile.flashChecksumAddr?t(e.appTarget.compile.flashChecksumAddr,12).then(n=>{let i=pxtc.parseChecksumBlock(n);return i?t(i.endMarkerPos,1).then(t=>r(t,0)!=i.endMarker?(e.log("end-marker mismatch"),null):i):null}):Promise.resolve(null)}(n).then(e=>{if(!e)return t;let n=e.regions.filter(e=>s.regions.some(t=>e.checksum==t.checksum&&e.length==t.length&&e.start==t.start));if(0==n.length)return t;l("skipping flash at: "+n.map(e=>`${pxtc.assembler.tohex(e.start)} (${e.length/1024}kB)`).join(", "));let i=e=>n.some(t=>t.start<=e&&e<t.start+t.length);return t.filter(e=>!(i(e.targetAddr)&&i(e.targetAddr+e.payloadSize-1)))}):Promise.resolve(t)}t.Wrapper=c,t.mkHF2PacketIOWrapper=function(t){return e.debug("packetio: wrapper hf2"),new c(t)},t.onlyChangedBlocksAsync=u}(e.HF2||(e.HF2={}))}(pxt||(pxt={})),function(e){!function(t){var n=e.Util,i=e.HF2;const r=i.read32;let s,o,a,l,c,u,d,p,h=!1;function f(e){return e<<2|2}function m(e){return 1&e?e>>1:0!=e?2&e?e==t.taggedNull?null:e!=t.taggedFalse&&(e==t.taggedTrue||{tagged:e>>2}):{ptr:e}:void 0}function g(e,t){if(n.assert(!(3&e)),n.assert(e>=0),e<2097152){let i=new Uint8Array(t);return e-=d.start,n.memcpy(i,0,d.buf,e,t),Promise.resolve(i)}let i=p.maxMsgSize-32;if(t>i){let r=[];for(;t>0;){let n=Math.min(i,t);r.push(g(e,n)),t-=n,e+=n}return Promise.all(r).then(n.uint8ArrayConcat)}return p.readWordsAsync(e,Math.ceil(t/4)).then(e=>e.length>t?e.slice(0,t):e)}function _(t){if("object"!=typeof t||!t)return Promise.resolve(t);if("number"==typeof t.ptr){if(3&t.ptr)return Promise.resolve({unalignedPtr:t.ptr});let r=0;return g(t.ptr,56).then(s=>{r=i.read16(s,2);let o=s.length;return r==e.BuiltInType.BoxedString||r==e.BuiltInType.BoxedBuffer?o=i.read16(s,4)+6:r==e.BuiltInType.BoxedNumber&&(o=12),o>s.length?g(t.ptr+s.length,o-s.length).then(e=>n.uint8ArrayConcat([s,e])):o<s.length?s.slice(0,o):s}).then(t=>r==e.BuiltInType.BoxedString?n.uint8ArrayToString(t.slice(6)):r==e.BuiltInType.BoxedBuffer?{type:"buffer",data:t.slice(6)}:r==e.BuiltInType.BoxedNumber?new Float64Array(t.buffer.slice(4))[0]:{type:"unknown",tag:r,refcnt:i.read16(t,0),data:t.slice(4)})}return Promise.resolve(t)}function y(e){let t=[];for(let n of Object.keys(e))t.push(_(e[n]).then(t=>{e[n]=t}));return Promise.all(t).then(()=>{})}function b(e){let t=s.breakpoints,n=t[0],i=1/0;for(let r of t){let t=e-r.binAddr;t>=0&&t<i&&(i=t,n=r)}return n}function v(e){if(h)return Promise.resolve();let r;return h=!0,E().then(t=>{let o=i.decodeU32LE(e)[0],l={};for(let e of s.procDebugInfo[0].locals){let r=t.globals,s=(()=>{switch(e.type){case"uint32":return i.read32(r,e.index);case"int32":return 0|i.read32(r,e.index);case"uint16":return i.read16(r,e.index);case"int16":return i.read16(r,e.index)<<16>>16;case"uint8":return r[e.index];case"int8":return r[e.index]<<24>>24;default:return null}})();null===s&&(n.assert(!(3&e.index)),s=m(i.read32(r,e.index))),l[e.name]=s}return c=b(o),r={type:"debugger",subtype:"breakpoint",breakpointId:c.id,globals:l,stackframes:[]},a(),p.talkAsync(1888490768)}).then(e=>{!function(e,t){let i=c.binAddr,r=0,o=s.procDebugInfo.filter(e=>e.codeStartLoc<=i&&i<=e.codeEndLoc)[0];for(;o&&o!=s.procDebugInfo[0];){let s=b(i),a=n.clone(s);a.functionName=o.name,a.argumentNames=o.args&&o.args.map(e=>e.name),t.stackframes.push({locals:{},funcInfo:a,breakpointId:s.id});let l=t.stackframes[t.stackframes.length-1],c=0;for(let t of o.locals)n.assert(t.index==c++),l.locals[t.name]=m(e[r++]);i=2147483646&e[r++];let d=u[i+""];for(let t of o.args)l.locals[t.name]=m(e[r+(o.args.length-1-t.index)]);if(!d)break;o=d.from,r+=d.stack-o.localsMark}}(i.decodeU32LE(e),r);let t=[r.globals].concat(r.stackframes.map(e=>e.locals));return n.promiseMapAll(t,y)}).then(()=>t.postMessage(r))}function T(){h=!1,o=new Promise((e,t)=>{a=e})}function k(e=!1){return Promise.resolve().then(()=>p.talkAsync(665147697,i.encodeU32LE([e?1:3]))).then(T)}function x(){return o||(o=Promise.resolve()),o}function E(){return(l?Promise.resolve(l):p.talkAsync(1409050336).then(e=>l={numGlobals:r(e,0),globalsPtr:r(e,4)})).then(e=>p.readWordsAsync(e.globalsPtr,e.numGlobals)).then(e=>({staticState:l,globals:e}))}t.taggedUndefined=0,t.taggedNull=f(1),t.taggedFalse=f(2),t.taggedTrue=f(16),t.postMessage=t=>e.log(t),t.decodeValue=m,t.heapExpandAsync=_,t.heapExpandMapAsync=y,t.startDebugAsync=function(e,t){return p=t,p.onEvent(915601917,v),(h=!1,s=null,l=null,Promise.resolve()).then(()=>{s=e,u={};let t=[];for(let n of e.procDebugInfo)t[n.idx]=n;for(let n of e.procDebugInfo)for(let e of n.calls)u[e.addr+""]={from:n,to:t[e.procIndex],stack:e.stack}}).then(()=>{let e=s.outfiles[pxtc.BINARY_UF2],t=n.stringToUint8Array(atob(e));return d=pxtc.UF2.toBin(t),p.reflashAsync(s).then(()=>p.reconnectAsync())}).then(()=>p.talkAsync(287358355).catch(e=>{})).then(()=>n.delay(200)).then(()=>p.reconnectAsync()).then(T).then(x)},t.handleMessage=function(t){if(e.log("HWDBGMSG",t),"debugger"!=t.type)return;let n=!1;switch(t.subtype){case"stepinto":n=!0;case"stepover":k(n)}},t.resumeAsync=k,t.waitForHaltAsync=x,t.getHwStateAsync=E}(e.HWDBG||(e.HWDBG={}))}(pxt||(pxt={})),function(e){e.ImageConverter=class{logTime(){if(this.start){let t=Date.now()-this.start;e.debug("Icon creation: "+t+"ms")}}convert(t){this.start||(this.start=Date.now());let n=atob(t.slice(t.indexOf(",")+1)),i=n.charCodeAt(0),r=n.charCodeAt(1),s=n.charCodeAt(2);if(135===i&&(i=224|n.charCodeAt(1),r=n.charCodeAt(2)|n.charCodeAt(3)<<8,s=n.charCodeAt(4)|n.charCodeAt(5)<<8,n=n.slice(4)),225!=i&&228!=i)return null;if(this.palette||this.setPalette(e.appTarget.runtime.palette.map(function(e){const t=parseInt(e.replace(/#/,""),16);return[255&t,t>>8&255,t>>16&255,255]})),225==i)return this.genMonochrome(n,r,s);const o=(e.BrowserUtils.isEdge()||e.BrowserUtils.isIE())&&r<100&&s<100?3:1;return this.genColor(n,r,s,o)}setPalette(e){e[0][3]=0,this.palette=new Uint8Array(4*e.length);for(let t=0;t<e.length;++t)this.palette[4*t+0]=e[t][0],this.palette[4*t+1]=e[t][1],this.palette[4*t+2]=e[t][2],this.palette[4*t+3]=e[t][3]}genMonochrome(t,n,i){let r=n+3&-4,s=54+this.palette.length,o=s+r*i,a=new Uint8Array(o);a[0]=66,a[1]=77,e.HF2.write32(a,2,o),e.HF2.write32(a,10,s),e.HF2.write32(a,14,40),e.HF2.write32(a,18,n),e.HF2.write32(a,22,-i),e.HF2.write16(a,26,1),e.HF2.write16(a,28,8),e.HF2.write32(a,38,2835),e.HF2.write32(a,42,2835),e.HF2.write32(a,46,this.palette.length>>2),a.set(this.palette,54);let l=4,c=s,u=1,d=t.charCodeAt(l++);for(let e=0;e<n;++e){c=s+e;for(let e=0;e<i;++e)a[c]=d&u?1:0,c+=r,u<<=1,256==u&&(u=1,d=t.charCodeAt(l++))}return"data:image/bmp;base64,"+btoa(e.U.uint8ArrayToString(a))}genColor(t,n,i,r){const s=n*(r=Math.max(1,0|r)),o=i*r;let a=s<<2,l=138,c=l+a*o,u=new Uint8Array(c);u[0]=66,u[1]=77,e.HF2.write32(u,2,c),e.HF2.write32(u,10,l),e.HF2.write32(u,14,124),e.HF2.write32(u,18,s),e.HF2.write32(u,22,-o),e.HF2.write16(u,26,1),e.HF2.write16(u,28,32),e.HF2.write16(u,30,3),e.HF2.write32(u,38,2835),e.HF2.write32(u,42,2835),e.HF2.write32(u,54,16711680),e.HF2.write32(u,58,65280),e.HF2.write32(u,62,255),e.HF2.write32(u,66,4278190080),u[70]=66,u[71]=71,u[72]=82,u[73]=115;let d=4,p=l,h=!0;for(let e=0;e<s;e++){let n=!1;p=l+(e<<2);let s=d,c=t.charCodeAt(d++),f=n?(c>>4&15)<<2:(15&c)<<2;for(let e=0;e<o;e++)c&&(h=!1),u[p]=this.palette[f],u[p+1]=this.palette[f+1],u[p+2]=this.palette[f+2],u[p+3]=this.palette[f+3],p+=a,e%r===r-1&&(n&&(c=t.charCodeAt(d++)),n=!n,f=n?(c>>4&15)<<2:(15&c)<<2);if(h&&(u[141]=1),e%r===r-1)for(i%2||--d;3&d;)d++;else d=s}return"data:image/bmp;base64,"+btoa(e.U.uint8ArrayToString(u))}},e.convertUint8BufferToPngUri=function(t,n){const i=new e.ImageConverter,r=[];for(let e=0;e<16;e++)r.push([t[3*e+2],t[3*e+1],t[3*e+0],255]);i.setPalette(r);const s=String.fromCharCode.apply(null,n),o=`data:image/x-mkcd-f4;base64,${btoa(s)}`;return i.convert(o)}}(pxt||(pxt={})),function(e){!function(t){function n(){const e={"tsconfig.json":t.TS_CONFIG,"test.ts":`// ${lf("tests go here; this will not be compiled when this package is used as an extension.")}\n`,"_config.yml":"makecode:\n  target: @TARGET@\n  platform: @PLATFORM@\n  home_url: @HOMEURL@\ntheme: jekyll-theme-slate\ninclude:\n  - assets\n  - README.md\n",Makefile:"all: deploy\n\nbuild:\n\tpxt build\n\ndeploy:\n\tpxt deploy\n\ntest:\n\tpxt test\n",Gemfile:"source 'https://rubygems.org'\ngem 'github-pages', group: :jekyll_plugins","README.md":`\n> ${lf("Open this page at {0}","[https://@REPOOWNER@.github.io/@REPONAME@/](https://@REPOOWNER@.github.io/@REPONAME@/)")}\n\n## ${lf("Use as Extension")}\n\n${lf("This repository can be added as an **extension** in MakeCode.")}\n\n* ${lf("open [@HOMEURL@](@HOMEURL@)")}\n* ${lf("click on **New Project**")}\n* ${lf("click on **Extensions** under the gearwheel menu")}\n* ${lf("search for **https://github.com/@REPO@** and import")}\n\n## ${lf("Edit this project")}\n\n${lf("To edit this repository in MakeCode.")}\n\n* ${lf("open [@HOMEURL@](@HOMEURL@)")}\n* ${lf("click on **Import** then click on **Import URL**")}\n* ${lf("paste **https://github.com/@REPO@** and click import")}\n\n#### ${lf("Metadata (used for search, rendering)")}\n\n* for PXT/@TARGET@\n<script src="https://makecode.com/gh-pages-embed.js"><\/script><script>makeCodeRender("{{ site.makecode.home_url }}", "{{ site.github.owner_name }}/{{ site.github.repository_name }}");<\/script>\n`,".gitignore":"# MakeCode\nbuilt\nnode_modules\nyotta_modules\nyotta_targets\npxt_modules\n.pxt\n_site\n*.db\n*.tgz\n.header.json\n.simstate.json\n",".vscode/settings.json":'{\n    "editor.formatOnType": true,\n    "files.autoSave": "afterDelay",\n    "files.watcherExclude": {\n        "**/.git/objects/**": true,\n        "**/built/**": true,\n        "**/node_modules/**": true,\n        "**/yotta_modules/**": true,\n        "**/yotta_targets": true,\n        "**/pxt_modules/**": true,\n        "**/.pxt/**": true\n    },\n    "files.associations": {\n        "*.blocks": "html",\n        "*.jres": "json"\n    },\n    "search.exclude": {\n        "**/built": true,\n        "**/node_modules": true,\n        "**/yotta_modules": true,\n        "**/yotta_targets": true,\n        "**/pxt_modules": true,\n        "**/.pxt": true\n    },\n    "files.exclude": {\n        "**/pxt_modules": true,\n        "**/.pxt": true\n    }\n}',".vscode/extensions.json":'{\n    "recommendations": ["ms-edu.pxt-vscode-web"]\n}'},n=i();return n&&Object.keys(n).forEach(t=>e[t]=n[t]),e}function i(){const t=e.appTarget.bundledpkgs[e.template.TEMPLATE_PRJ];if(t){const n=e.Util.clone(t);return delete n[e.CONFIG_NAME],n}}t.TS_CONFIG='{\n    "compilerOptions": {\n        "target": "ES5",\n        "noImplicitAny": true,\n        "outDir": "built",\n        "rootDir": "."\n    },\n    "exclude": ["pxt_modules/**/*test.ts"]\n}\n',t.defaultFiles=n,t.targetTemplateFiles=i,t.TEMPLATE_PRJ="template",t.packageFiles=function(t){const i=e.appTarget.blocksprj||e.appTarget.tsprj,r=e.U.clone(i.config);delete r.installedVersion,delete r.additionalFilePath,delete r.additionalFilePaths,r.preferredEditor=r.files.find(e=>/\.blocks$/.test(e))?e.BLOCKS_PROJECT_NAME:e.JAVASCRIPT_PROJECT_NAME,r.name=t,r.public=!0,r.version||(r.version="0.0.0");const s={},o=n();for(const e in o)s[e]=o[e];for(const e in i.files)"README.md"!=e&&(s[e]=i.files[e]);const a=Object.keys(s).filter(e=>/\.(blocks|md|ts|asm|cpp|h|py)$/.test(e));return r.files=a.filter(e=>!/test/.test(e)),r.testFiles=a.filter(e=>/test/.test(e)),r.supportedTargets=[e.appTarget.id],s[e.CONFIG_NAME]=e.Package.stringifyConfig(r),s},t.packageFilesFixup=function(t,n){const i=JSON.parse(t[e.CONFIG_NAME]);n&&e.Util.jsonMergeFrom(i,n),e.webConfig&&(Object.keys(e.webConfig).forEach(t=>i[t.toLowerCase()]=e.webConfig[t]),i.platform=e.appTarget.platformid||e.appTarget.id,i.target=e.appTarget.id,i.docs=e.appTarget.appTheme.homeUrl||"./",i.homeurl=e.appTarget.appTheme.homeUrl||"???"),e.U.iterMap(t,(e,n)=>{n=n.replace(/@([A-Z]+)@/g,(e,t)=>i[t.toLowerCase()]||""),t[e]=n})}}(e.template||(e.template={}))}(pxt||(pxt={})),function(e){!function(t){let n,i;!function(e){e[e.Prefix=0]="Prefix",e[e.Postfix=1]="Postfix",e[e.Infix=2]="Infix",e[e.Block=3]="Block",e[e.NewLine=4]="NewLine"}(n=t.NT||(t.NT={})),function(e){e[e.None=0]="None",e[e.WithSpace=1]="WithSpace",e[e.NoSpace=2]="NoSpace"}(i=t.GlueMode||(t.GlueMode={}));const r=["break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with"];function s(e){return"`"+e.replace(/[\\`${}]/g,e=>"\\"+e)+"`"}function o(e){return e.length>20&&/\n/.test(e)?s(e):JSON.stringify(e)}function a(e,t,n){return{type:e,op:t,children:n}}function l(){return a(n.NewLine,"",[])}function c(e,t){return a(n.Prefix,e,t)}function u(e,t,i){return a(n.Infix,t,null==e?[i]:[e,i])}function d(e){return c(e,[])}function p(e){return a(n.Block,"",e)}function h(e){return c("",e)}function f(e,t=!1){const n=[];for(const i of e)t?(n.length>0&&n.push(d(",")),n.push(l())):n.length>0&&n.push(d(", ")),n.push(i);return t&&n.push(l()),h(n)}let m;t.backtickLit=s,t.stringLit=o,t.mkNode=a,t.mkNewLine=l,t.mkPrefix=c,t.mkPostfix=function(e,t){return a(n.Postfix,t,e)},t.mkInfix=u,t.mkText=d,t.mkBlock=p,t.mkGroup=h,t.mkStmt=function(...e){let t=e[e.length-1];return t&&t.type==n.Block||e.push(l()),h(e)},t.mkCommaSep=f,function(t){function n(e,t,n=!1,i=!1){return h(i?[u(t[0],".",d(e)),d("("),f(t.slice(1),n),d(")")]:[d(e),d("("),f(t,n),d(")")])}function i(e,t,i,r){return n(e+"."+t,i,r)}function r(t,n){return e.U.assert(2==n.length),u(n[0],t,n[1])}t.mkArrayLiteral=function(e,t){return h([d("["),f(e,t),d("]")])},t.mkNumberLiteral=function(e){return d(e.toString())},t.mkBooleanLiteral=function(e){return d(e?"true":"false")},t.mkStringLiteral=function(e){return d(o(e))},t.mkPropertyAccess=function(e,t){return h([u(t,".",d(e))])},t.mkCall=n,t.stdCall=function(e,t,i){return n(e,t,i)},t.extensionCall=function(e,t,i){return n(e,t,i,!0)},t.namespaceCall=i,t.mathCall=function(e,t){return i("Math",e,t,!1)},t.mkGlobalRef=function(e){return d(e)},t.mkSimpleCall=r,t.mkWhile=function(e,t){return h([d("while ("),e,d(")"),p(t)])},t.mkComment=function(e){return d("// "+e)},t.mkMultiComment=function(e){let t=[d("/**"),l()];return e.split("\n").forEach((e,n,i)=>{e&&(t.push(d(" * "+e)),t.push(l()),n<i.length-1&&(t.push(d(" * ")),t.push(l())))}),h(t.concat([d(" */"),l()]))},t.mkAssign=function(e,t){return r("=",[e,t])},t.mkParenthesizedExpression=function(e){return y(_([e]).output)?e:h([d("("),e,d(")")])}}(m=t.Helpers||(t.Helpers={})),t.H=m;const g={"=":3,"+=":3,"-=":3,"?":4,":":4,"||":5,"&&":6,"|":7,"^":8,"&":9,"==":10,"!=":10,"===":10,"!==":10,"<":11,">":11,"<=":11,">=":11,">>":12,">>>":12,"<<":12,"+":13,"-":13,"*":14,"/":14,"%":14,"**":15,"!":16,"~":16,"P-":16,"P+":16,"++":16,"--":16,".":18};function _(t){let r=[],s={},o="",a="",l=[{}],c=0;function u(e){"string"==typeof e&&(c+=(e.match(/\n/g)||[]).length),o+=e}let p=h(t);return function t(i,r){if(i.type!=n.Infix){for(let e of i.children)t(e,-1);return}let s=[];function o(e){"P"==e[0]&&(e=e.slice(1)),s.push(d(e))}let a=e.U.lookup(g,i.op);if(null==a&&e.U.oops("bad infix op: "+i.op),a<r&&o("("),1==i.children.length)o(i.op),t(i.children[0],a),s.push(i.children[0]);else{let e,n=3!=a&&"**"!=i.op;t(i.children[0],n?a:a+.1),s.push(i.children[0]),e&&"number"!=e&&(o(": "),o(e)),"."==i.op?o("."):o(" "+i.op+" "),t(i.children[1],n?a+.1:a),s.push(i.children[1])}a<r&&o(")"),i.type=n.Prefix,i.op="",i.children=s}(p,-1),f(p),o||u("\n"),{output:o,sourceMap:r};function f(t){t.glueToBlock&&(_(),t.glueToBlock==i.WithSpace&&u(" "));let d=c,p=o.length;switch(t.type){case n.Infix:e.U.oops("no infix should be left");break;case n.NewLine:u("\n"+a);break;case n.Block:!function(t){let n=t.noFinalNewline?"":"\n";if(0==t.children.length)return void m(" {\n\t\n}"+n);let i=e.U.clone(l[l.length-1]||{});l.push(i),a+="    "," "!=o[o.length-1]&&m(" ");m("{\n");for(let e of t.children)f(e);a=a.slice(4),_(),m("\n}"+n),l.pop()}(t);break;case n.Prefix:t.canIndentInside?u(t.op.replace(/\n/g,"\n"+a+"    ")):u(t.op),t.children.forEach(f);break;case n.Postfix:t.children.forEach(f),t.canIndentInside?u(t.op.replace(/\n/g,"\n"+a+"    ")):u(t.op)}let h=c,g=Math.max(o.length,1);if(t.id)if(s[t.id]){const e=s[t.id];e.startLine=Math.min(e.startLine,d),e.endLine=Math.max(e.endLine,h),e.startPos=Math.min(e.startPos,p),e.endPos=Math.max(e.endPos,g)}else{const e={id:t.id,startLine:d,startPos:p,endLine:h,endPos:g};s[t.id]=e,r.push(e)}}function m(e){u(e.replace(/\n/g,"\n"+a))}function _(){o=o.replace(/\n *$/,function(){return c--,""})}}function y(e){if("("!==e[0]||")"!==e[e.length-1])return!1;let t=1;for(let n=1;n<e.length;n++){const i=e[n];if("("===i)t++;else if(")"===i&&(t--,0===t))return n===e.length-1}return!1}t.flattenNode=_,t.isReservedWord=function(e){return-1!==r.indexOf(e)},t.isParenthesized=y}(e.blocks||(e.blocks={}))}(pxt||(pxt={})),function(e){var t;!function(n){const i=[".","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];n.BLOCKLY_TILESET_TYPE="BLOCKLY_TILESET_TYPE",n.TILE_PREFIX="tile",n.TILE_NAMESPACE="myTiles",n.IMAGES_NAMESPACE="myImages",n.IMAGE_PREFIX="image",n.ANIMATION_NAMESPACE="myAnimations",n.ANIMATION_PREFIX="anim",n.SONG_NAMESPACE="mySongs",n.JSON_NAMESPACE="myFiles",n.SONG_PREFIX="song",n.JSON_PREFIX="file";class r{constructor(e,t,n=0,i=0,r){this.width=e,this.height=t,this.x0=n,this.y0=i,this.width||(this.width=16),this.height||(this.height=16),this.buf=r||new Uint8ClampedArray(this.dataLength())}static fromData(e){return new r(e.width,e.height,e.x0,e.y0,e.data)}set(e,t,n){if(e<this.width&&t<this.height&&e>=0&&t>=0){const i=this.coordToIndex(e,t);this.setCore(i,n)}}get(e,t){if(e<this.width&&t<this.height&&e>=0&&t>=0){const n=this.coordToIndex(e,t);return this.getCore(n)}return 0}copy(e=0,t=0,n=this.width,i=this.height){const s=new r(n,i);s.x0=e,s.y0=t;for(let r=0;r<n;r++)for(let n=0;n<i;n++)s.set(r,n,this.get(e+r,t+n));return s}apply(e,t=!1){let n;for(let i=0;i<e.width;i++)for(let r=0;r<e.height;r++)n=e.get(i,r),!n&&t||this.set(e.x0+i,e.y0+r,n)}equals(e){if(this.width===e.width&&this.height===e.height&&this.x0===e.x0&&this.y0===e.y0&&this.buf.length===e.buf.length){for(let t=0;t<this.buf.length;t++)if(this.buf[t]!==e.buf[t])return!1;return!0}return!1}data(){return{width:this.width,height:this.height,x0:this.x0,y0:this.y0,data:this.buf}}resize(e,t){return h(this,e,t)}coordToIndex(e,t){return e+t*this.width}getCore(e){const t=Math.floor(e/2);return e%2==0?15&this.buf[t]:(240&this.buf[t])>>4}setCore(e,t){const n=Math.floor(e/2);this.buf[n]=e%2==0?240&this.buf[n]|15&t:15&this.buf[n]|(15&t)<<4}dataLength(){return Math.ceil(this.width*this.height/2)}}n.Bitmap=r;class s extends r{static fromData(e){return new s(e.width,e.height,e.x0,e.y0,e.data)}copy(e=0,t=0,n=this.width,i=this.height){const r=new s(n,i);r.x0=e,r.y0=t;for(let s=0;s<n;s++)for(let n=0;n<i;n++)r.set(s,n,this.get(e+s,t+n));return r}resize(e,t){return f(this,e,t)}getCore(e){return this.buf[e]}setCore(e,t){this.buf[e]=t}dataLength(){return this.width*this.height}}n.Tilemap=s;class o{constructor(e,t,n){this.tilemap=e,this.tileset=t,this.layers=n,this.nextId=0}cloneData(e=!1){var t,n,i,s;const a=this.tilemap.copy(),l={tileWidth:this.tileset.tileWidth,tiles:this.tileset.tiles.map(e=>Object.assign(Object.assign({},e),{bitmap:r.fromData(e.bitmap).copy().data()}))},c=r.fromData(this.layers).copy().data(),u=new o(a,l,c);return e&&(u.nextId=this.nextId,u.projectReferences=null===(t=this.projectReferences)||void 0===t?void 0:t.slice(),u.tileOrder=null===(n=this.tileOrder)||void 0===n?void 0:n.slice(),u.editedTiles=null===(i=this.editedTiles)||void 0===i?void 0:i.slice(),u.deletedTiles=null===(s=this.deletedTiles)||void 0===s?void 0:s.slice()),u}equals(e){return this.tilemap.equals(e.tilemap)&&v(this.tileset,e.tileset)&&b(this.layers,e.layers)}}n.TilemapData=o;function a(e){return l(atob(e.slice(e.indexOf(",")+1)))}function l(t){let n=t.charCodeAt(0),i=t.charCodeAt(1),r=t.charCodeAt(2);135===n&&(n=224|t.charCodeAt(1),i=t.charCodeAt(2)|t.charCodeAt(3)<<8,r=t.charCodeAt(4)|t.charCodeAt(5)<<8,t=t.slice(4));const s=new e.sprite.Bitmap(i,r);let o=4;if(225===n){let e=1,n=t.charCodeAt(o++);for(let a=0;a<i;++a)for(let i=0;i<r;++i)s.set(a,i,n&e?1:0),e<<=1,256==e&&(e=1,n=t.charCodeAt(o++))}else for(let e=0;e<i;e++){for(let n=0;n<r;n+=2){let i=t.charCodeAt(o++);s.set(e,n,15&i),n!=r-1&&s.set(e,n+1,i>>4&15)}for(;3&o;)o++}return s}function c(e,t){!(e=(e=(e=e.replace(/[ `]|(?:&#96;)|(?:&#9;)|(?:hex)/g,"").trim()).replace(/^["`\(\)]*/,"").replace(/["`\(\)]*$/,"")).replace(/&#10;/g,"\n"))&&t&&(e=t);const n=parseInt(e.substr(0,2),16)|parseInt(e.substr(2,2),16)<<8,i=parseInt(e.substr(4,2),16)|parseInt(e.substr(6,2),16)<<8,r=x(e.substring(8));return s.fromData({width:n,height:i,x0:0,y0:0,data:r})}function u(e){return`${p(e.width,2)}${p(e.height,2)}${E(e.data().data)}`}function d(e,t){return(e=e.replace(/[\[\]]/g,""))?e.split(",").filter(e=>!!e.trim()).map(e=>function(e,t){if(0===(e=e.trim()).indexOf("img")){const n=m(e);return t.createNewTile(n.data())}switch(e){case"myTiles.tile0":case"myTiles.transparency16":return t.getTransparency(16);case"myTiles.transparency8":return t.getTransparency(8);case"myTiles.transparency4":return t.getTransparency(4);case"myTiles.transparency32":return t.getTransparency(32);default:return t.resolveTile(e)}}(e,t)):[]}function p(e,t){let n=e.toString(16);const i=t<<1;for(1&n.length&&(n="0"+n);n.length<i;)n+="0";return n}function h(e,t,n){const i=new r(t,n);return i.apply(e),i}function f(e,t,n){const i=new s(t,n);return i.apply(e),i}function m(e,t="img"){const n=(e=(e=(e=(e=e.replace(/[ `]|(?:&#96;)|(?:&#9;)|(?:img)/g,"").trim()).replaceAll(t,"")).replace(/^["`\(\)]*/,"").replace(/["`\(\)]*$/,"")).replace(/&#10;/g,"\n")).split("\n"),i=[];let s=0;for(let e=0;e<n.length;e++){const t=n[e],r=[];for(let e=0;e<t.length;e++)switch(t[e]){case"0":case".":r.push(0);break;case"1":case"#":r.push(1);break;case"2":case"T":r.push(2);break;case"3":case"t":r.push(3);break;case"4":case"N":r.push(4);break;case"5":case"n":r.push(5);break;case"6":case"G":r.push(6);break;case"7":case"g":r.push(7);break;case"8":r.push(8);break;case"9":r.push(9);break;case"a":case"A":case"R":r.push(10);break;case"b":case"B":case"P":r.push(11);break;case"c":case"C":case"p":r.push(12);break;case"d":case"D":case"O":r.push(13);break;case"e":case"E":case"Y":r.push(14);break;case"f":case"F":case"W":r.push(15);break;default:if(!/\s/.test(t[e]))return}r.length&&(i.push(r),s=Math.max(s,r.length))}const o=i.length,a=new r(s,o);for(let e=0;e<o;e++){const t=i[e];for(let n=0;n<s;n++)n<t.length?a.set(n,e,t[n]):a.set(n,e,0)}return a}function g(e,t="img"){let n="";if("python"===e)n=`${t}("""`;else n=`${t}\``;return n}function _(e){let t="";if("python"===e)t+='""")';else t+="`";return t}function y(e,t,n="img"){if(!e||0===e.height||0===e.width)return"";let r=g(t,n);if(e){const t=e.width*e.height>300?"":" ";for(let n=0;n<e.height;n++){r+="\n";for(let s=0;s<e.width;s++)r+=i[e.get(s,n)]+t}}return r+="\n",r+=_(t),r}function b(t,n){return t===n||!(!t&&n||!n&&t)&&e.sprite.Bitmap.fromData(t).equals(e.sprite.Bitmap.fromData(n))}function v(t,n){return t.tileWidth===n.tileWidth&&e.U.arrayEquals(t.tiles,n.tiles,e.assetEquals)}function T(e){switch(e){case 4:return"TileScale.Four";case 8:return"TileScale.Eight";case 16:return"TileScale.Sixteen";case 32:return"TileScale.ThirtyTwo";default:return Math.floor(Math.log2(e)).toString()}}function k(e){switch(e=e.replace(/\s/g,"")){case"TileScale.Four":return 4;case"TileScale.Eight":return 8;case"TileScale.Sixteen":return 16;case"TileScale.ThirtyTwo":return 32;default:return Math.pow(2,parseInt(e))}}function x(e){let t=new Uint8ClampedArray(e.length>>1);for(let n=0;n<e.length;n+=2)t[n>>1]=parseInt(e.slice(n,n+2),16);return t}function E(e){const t="0123456789abcdef";let n="";for(let i=0;i<e.length;++i)n+=t[e[i]>>4],n+=t[15&e[i]];return n}function S(e,t,n){e[t]=255&n,e[t+1]=n>>8&255}function C(e){const t=function(e){if(e){if(6===e.length)return parseInt("0x"+e);if(7===e.length)return parseInt("0x"+e.substr(1))}return 0}(e);return[w(t),I(t),A(t)]}function w(e){return e>>16&255}function I(e){return e>>8&255}function A(e){return 255&e}n.Bitmask=class{constructor(e,t){this.width=e,this.height=t,this.mask=new Uint8Array(Math.ceil(e*t/8))}set(e,t){const n=e+this.width*t,i=n>>3,r=7&n;this.mask[i]|=1<<r}get(e,t){const n=e+this.width*t,i=n>>3,r=7&n;return this.mask[i]>>r&1}},n.encodeTilemap=function(e,t,n){return e?`tiles.createTilemap(${function(e){return e?`hex\`${u(e)}\``:"hex``"}(e.tilemap)}, ${y(r.fromData(e.layers),t)}, [${e.tileset.tiles.map(e=>function(e,t,n){if(n&&n[e.id])return n[e.id];return e.id}(e,0,n))}], ${T(e.tileset.tileWidth)})`:"null"},n.decodeTilemap=function(t,n,i){if(!(t=e.Util.htmlUnescape(t).trim()).trim()||-1===t.indexOf("("))return null;const r=(t=(t=t.substr(t.indexOf("(")+1)).substr(0,t.lastIndexOf(")"))).substr(0,t.indexOf(",")),s=(t=t.substr(r.length+1)).substr(0,t.indexOf(",")),a=(t=t.substr(s.length+1)).substr(0,t.lastIndexOf("]")+1),l=t=t.substr(a.length+1);return new o(c(r),{tiles:d(a,i),tileWidth:k(l)},m(s).data())},n.trimTilemapTileset=function(e){const t=e.tileset.tiles.slice(),n=e.tilemap,i={};i[t[0].id]=!0;for(let e=0;e<n.width;e++)for(let r=0;r<n.height;r++)i[t[n.get(e,r)].id]=!0;const r=e.editedTiles||[],s=t.filter(e=>i[e.id]||"*"===e.id.charAt(0)||-1!==r.indexOf(e.id));if(s.length===t.length)return;const o=[];for(let e=0;e<t.length;e++)o.push(s.indexOf(t[e]));for(let e=0;e<n.width;e++)for(let t=0;t<n.height;t++)n.set(e,t,o[n.get(e,t)]);e.tileset.tiles=s},n.isEmptyTilemap=function(e){const t=e.tileset.tiles,n=e.tilemap,i=t[0].id;for(let e=0;e<n.width;e++)for(let r=0;r<n.height;r++)if(t[n.get(e,r)].id!==i)return!1;return!0},n.computeAverageColor=function(e,t){const n=t.map(C),i=[0,0,0];let r=0;for(let t=0;t<e.width;t++)for(let s=0;s<e.height;s++){const o=e.get(t,s);if(o){++r;const e=n[o];i[0]+=e[0],i[1]+=e[1],i[2]+=e[2]}}return r?"#"+function(e){let t="";for(let n=0;n<e.length;++n)t+=("0"+e[n].toString(16)).slice(-2);return t}(i.map(e=>Math.floor(e/r))):"#00000000"},n.getBitmap=function(e,t){const n=e.apis.byQName[t];return n?a(n.attributes.jresURL):null},n.getBitmapFromJResURL=a,n.hexToBitmap=l,n.filterItems=function(e,t){const n=(t=t.filter(e=>!!e).map(e=>e.toLowerCase())).filter(e=>0!==e.indexOf("!")),i=t.filter(e=>0===e.indexOf("!")&&e.length>1).map(e=>e.substring(1));return e.filter(e=>{return t=e,n.every(e=>{const n=`?${e}`;return t.tags.some(t=>t===e||t===n)})&&function(e){return i.every(t=>!e.tags.some(e=>e===t))}(e);var t})},n.getGalleryItems=function(t,i){let r=function(t,n){return e.Util.values(t.byQName).filter(e=>4===e.kind&&e.attributes.fixedInstance&&function(e,t,n){if(t==n)return!0;let i=e.byQName[t];return!(!i||!i.extendsTypes)&&i.extendsTypes.indexOf(n)>=0}(t,e.retType,n))}(t.apis,i);return r=r.filter(e=>e.namespace!=n.TILE_NAMESPACE),function(t){const n=new e.ImageConverter;t.forEach(e=>{e.attributes.jresURL&&!e.attributes.iconURL&&0==e.attributes.jresURL.indexOf("data:image/x-mkcd-f")&&(e.attributes.iconURL=n.convert(e.attributes.jresURL))})}(r),r.map(t=>{const n=(t.attributes.tags||"").split(" ").filter(e=>!!e).map(t=>e.Util.startsWith(t,"category-")?t:t.toLowerCase());return{qName:t.qName,src:t.attributes.iconURL,alt:t.qName,tags:n}})},n.base64EncodeBitmap=function(t){const n=r.fromData(t),i=pxtc.f4EncodeImg(t.width,t.height,4,(e,t)=>n.get(e,t));return btoa(e.U.uint8ArrayToString(x(i)))},n.tilemapLiteralToTilemap=c,n.hexEncodeTilemap=u,n.formatByte=p,n.resizeBitmap=h,n.resizeTilemap=f,n.imageLiteralToBitmap=m,n.encodeAnimationString=function(t,n){const i=t.map(e=>e.data),r=new Uint8ClampedArray(8+i[0].length*i.length);S(r,0,n),S(r,2,t[0].width),S(r,4,t[0].height),S(r,6,t.length);let s=8;return i.forEach(e=>{r.set(e,s),s+=e.length}),btoa(e.sprite.uint8ArrayToHex(r))},n.addMissingTilemapTilesAndReferences=function(e,t){const n=e.getProjectTiles(t.data.tileset.tileWidth,!0);t.data.projectReferences=[];for(const i of n.tiles)t.data.tileset.tiles.some(e=>e.id===i.id)||t.data.tileset.tiles.push(i),e.isAssetUsed(i,null,[t.id])&&t.data.projectReferences.push(i.id)},n.updateTilemapReferencesFromResult=function(t,n){const i=n.data;if(i.deletedTiles)for(const e of i.deletedTiles)t.deleteTile(e);if(i.editedTiles)for(const e of i.editedTiles){const n=i.tileset.tiles.findIndex(t=>t.id===e),r=i.tileset.tiles[n];r&&(i.tileset.tiles[n]=t.updateTile(r))}for(let e=0;e<i.tileset.tiles.length;e++){const n=i.tileset.tiles[e];n.jresData||(i.tileset.tiles[e]=t.resolveTile(n.id))}e.sprite.trimTilemapTileset(i)},n.isTilemapEmptyOrUnused=function(e,n,i){const r=t.Bitmap.fromData(e.data.layers);for(let t=0;t<e.data.tilemap.width;t++)for(let n=0;n<e.data.tilemap.height;n++)if(e.data.tilemap.get(t,n)||r.get(t,n))return!1;return!n.isAssetUsed(e,i)},n.imageLiteralFromDimensions=function(e,t,n,r){let s=g(r);const o=e*t>300?"":" ";for(let r=0;r<t;r++){s+="\n";for(let t=0;t<e;t++)s+=i[n]+o}return s+="\n",s+=_(r),s},n.bitmapToImageLiteral=y,n.bitmapEquals=b,n.tilesetEquals=v,n.tileWidthToTileScale=T,n.tileScaleToTileWidth=k,n.hexToUint8Array=x,n.uint8ArrayToHex=E,n.colorStringToRGB=C}(t=e.sprite||(e.sprite={}))}(pxt||(pxt={})),function(e){!function(t){!function(n){const i=new RegExp(`^\\s*${t.TILE_NAMESPACE}\\s*\\.\\s*${t.TILE_PREFIX}(\\d+)\\s*$`);class r{constructor(e,t,n){this.tilemap=e,this.tileset=t,this.layers=n,this.nextId=0}}function s(e){return(e=e.replace(/[\[\]]/g,""))?e.split(",").filter(e=>!!e.trim()).map(e=>function(e){if(0===(e=e.trim()).indexOf("img")){return{data:t.imageLiteralToBitmap(e).data()}}const n=i.exec(e);if(n)return{data:null,projectId:Number(n[1])};return{data:null,qualifiedName:e}}(e)):[]}n.LegacyTilemapData=r,n.decodeTilemap=function(n,i){var o;if(!(null==(n=null===(o=e.Util.htmlUnescape(n))||void 0===o?void 0:o.trim())?void 0:n.trim()))return new r(new t.Tilemap(16,16),{tileWidth:16,tiles:[]},new t.Bitmap(16,16).data());const a=(n=(n=n.substr(n.indexOf("(")+1)).substr(0,n.lastIndexOf(")"))).substr(0,n.indexOf(",")),l=(n=n.substr(a.length+1)).substr(0,n.indexOf(",")),c=(n=n.substr(l.length+1)).substr(0,n.lastIndexOf("]")+1),u=n=n.substr(c.length+1);return new r(t.tilemapLiteralToTilemap(a),{tiles:s(c),tileWidth:t.tileScaleToTileWidth(u)},t.imageLiteralToBitmap(l).data())},n.tileToBlocklyVariable=function(e){return`${e.projectId};${e.data.width};${e.data.height};${pxtc.Util.toHex(e.data.data)}`},n.blocklyVariableToTile=function(e){const t=e.split(";");return 4!==t.length?null:{projectId:parseInt(t[0]),data:{width:parseInt(t[1]),height:parseInt(t[2]),data:new Uint8ClampedArray(pxtc.Util.fromHex(t[3])),x0:0,y0:0}}}}(t.legacy||(t.legacy={}))}(e.sprite||(e.sprite={}))}(pxt||(pxt={})),function(e){!function(t){class n{constructor(){this.items={}}removeItem(e){delete this.items[e]}getItem(e){return this.items[e]}setItem(e,t){this.items[e]=t}clear(){this.items={}}}class i{constructor(e){this.storageId=e,this.type="localstorage"}targetKey(e){return this.storageId+"/"+e}removeItem(e){window.localStorage.removeItem(this.targetKey(e))}getItem(e){return window.localStorage[this.targetKey(e)]}setItem(e,t){window.localStorage[this.targetKey(e)]=t}clear(){let e=this.targetKey(""),t=[];for(let n=0;n<window.localStorage.length;++n){let i=window.localStorage.key(n);0==i.indexOf(e)&&t.push(i)}t.forEach(e=>window.localStorage.removeItem(e))}}function r(){if(e.appTarget)return e.appTarget.id;const t=window.pxtConfig;if(t)return t.targetId;const n=window.pxtTargetBundle;return n?n.id:""}let s;function o(){if(s)return;const t=r();let o=!1;if(!e.shell.isSandboxMode())try{const n=e.Util.guidGen();window.localStorage[t]=n;o=window.localStorage[t]===n}catch(e){}o?(s=new i(t),e.debug(`storage: local under ${t}`)):(s=new n,e.debug("storage: in memory"))}t.storageId=r,t.setLocal=function(e,t){o(),s.setItem(e,t)},t.getLocal=function(e){return o(),s.getItem(e)},t.removeLocal=function(e){o(),s.removeItem(e)},t.clearLocal=function(){o(),s.clear()}}(e.storage||(e.storage={}))}(pxt||(pxt={})),function(e){!function(t){!function(t){const n="http://localhost:3232/api/store/";function i(){return e.BrowserUtils.isLocalHostDev()&&!e.BrowserUtils.noSharedLocalStorage()}function r(){return e.BrowserUtils.isChromiumEdge()?"chromium-edge":e.BrowserUtils.browser()}t.getAsync=async function(t,s){if(i()){t+="-"+r();const i=await e.Util.requestAsync({url:`${n}${encodeURIComponent(t)}/${encodeURIComponent(s)}`,method:"GET",allowHttpErrors:!0});if(204===i.statusCode)throw new Error(`Missing ${s} not available in ${t}`);return i.json?i.json:i.text?i.text:void 0}{const n=e.storage.getLocal(`${t}:${s}`),i=e.Util.jsonTryParse(n);return i||n}},t.setAsync=async function(t,s,o){if(void 0===o)return void await e.storage.shared.delAsync(t,s);let a="";if(a="object"==typeof o?JSON.stringify(o):o.toString(),i()){t+="-"+r();const i={type:"object"==typeof o?"json":"text",val:a},l=JSON.stringify(i);await e.Util.requestAsync({url:`${n}${encodeURIComponent(t)}/${encodeURIComponent(s)}`,method:"POST",data:l})}else e.storage.setLocal(`${t}:${s}`,a)},t.delAsync=async function(t,s){i()?(t+="-"+r(),await e.Util.requestAsync({url:`${n}${encodeURIComponent(t)}/${encodeURIComponent(s)}`,method:"DELETE",allowHttpErrors:!0})):e.storage.removeLocal(`${t}:${s}`)}}(t.shared||(t.shared={}))}(e.storage||(e.storage={}))}(pxt||(pxt={})),function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)if(" "===e.charAt(n))t++;else{if("\t"!==e.charAt(n))return t;t+=4}return 0}e.getSectionsFromMarkdownMetadata=function(e){const n=e.split(/\r?\n/);let i=[],r=null,s=null,o=null,a=[],l=0,c=null;for(const e of n)if(e.trim()){if(e.startsWith("```")){if(c){r&&(r.codeBlocks?r.codeBlocks.push(c):r.codeBlocks=[c]),c=null;continue}{const t=/^```([a-zA-Z_\-]*)$/.exec(e);if(t){c={content:"",languageCode:t[1]};continue}}}else c&&(c.content+=e+"\n");if(e.startsWith("#")){const t=/^(#+)\s*(.+)$/.exec(e);if(t){u(),r={headerKind:1===t[1].length?"single":2===t[1].length?"double":"triple",header:t[2],attributes:{}},s=null,o=null,l=0;continue}}if(r){const n=t(e),i=e.trim(),c=/^[*-]\s+(?:([^:]+):)?(.*)$/.exec(i);if(!c)continue;if(Math.abs(n-l)>1&&s){if(n>l){const e={key:s,items:[]};a.length?a[a.length-1].items.push(e):(r.listAttributes||(r.listAttributes={}),r.listAttributes[s]=e),s=null,a.push(e)}else{const e=a.pop();s&&o&&(null==e||e.items.push((s+":"+o).trim()),o=null)}l=n}c&&(c[1]?(s&&o&&(a.length?a[a.length-1].items.push((s+":"+o).trim()):r.attributes[s]=o.trim()),s=c[1].trim().toLowerCase(),o=c[2]):s&&(o+=c[2]))}}else o&&(o+="\n");return u(),i;function u(){r&&(s&&o&&(a.length?a[a.length-1].items.push((s+":"+o).trim()):r.attributes[s]=o.trim()),i.push(r)),a=[]}}}(pxt||(pxt={})),function(e){!function(t){let n;!function(e){e[e.PROD=0]="PROD",e[e.STAGING=1]="STAGING",e[e.LOCAL=2]="LOCAL"}(n||(n={}));let i=n.STAGING;t.ABSOLUTE_LINKS={PROD_BETA:"https://arcade.makecode.com/beta--multiplayer",STAGING_BETA:"https://arcade.staging.pxt.io/beta--multiplayer",LOCAL:"http://localhost:3000"},t.RELATIVE_LINKS={PROD:"/--multiplayer",BETA:"/beta--multiplayer"},t.SHORT_LINKS={PROD:"https://aka.ms/a9",PROD_BETA:"https://aka.ms/a9b",STAGING:"https://aka.ms/a9s",STAGING_BETA:"https://aka.ms/a9sb"},t.RELATIVE_LINK=()=>{if(e.BrowserUtils.isLocalHostDev())switch(i){case n.PROD:return t.ABSOLUTE_LINKS.PROD_BETA;case n.STAGING:return t.ABSOLUTE_LINKS.STAGING_BETA;case n.LOCAL:return t.ABSOLUTE_LINKS.LOCAL}return window.location.pathname.startsWith("/beta")?t.RELATIVE_LINKS.BETA:t.RELATIVE_LINKS.PROD},t.SHORT_LINK=()=>{if(e.BrowserUtils.isLocalHostDev())switch(i){case n.PROD:return t.SHORT_LINKS.PROD_BETA;case n.STAGING:return t.SHORT_LINKS.STAGING_BETA;case n.LOCAL:return t.ABSOLUTE_LINKS.LOCAL}return window.location.host.endsWith(".staging.pxt.io")?window.location.pathname.startsWith("/beta")?t.SHORT_LINKS.STAGING_BETA:t.SHORT_LINKS.STAGING:window.location.pathname.startsWith("/beta")?t.SHORT_LINKS.PROD_BETA:t.SHORT_LINKS.PROD},t.makeHostLink=function(e,n){return`${n?t.SHORT_LINK():t.RELATIVE_LINK()}?host=${encodeURIComponent(e)}`},t.makeJoinLink=function(e,n){return`${n?t.SHORT_LINK():t.RELATIVE_LINK()}?join=${encodeURIComponent(e)}`}}(e.multiplayer||(e.multiplayer={}))}(pxt||(pxt={})),function(e){!function(t){!function(t){function n(e,t,n){const i=new Uint8Array(2);new Uint16Array(i.buffer)[0]=0|n,e[t]=i[0],e[t+1]=i[1]}function i(e,t){const n=new Uint8Array(2);return n[0]=e[t],n[1]=e[t+1],new Uint16Array(n.buffer)[0]}function r(e){const t=new Uint8Array(5+7*e.steps.length);t[0]=e.steps.length,n(t,1,e.startFrequency),n(t,3,e.startVolume);for(let i=0;i<e.steps.length;i++){const r=5+7*i;t[r]=e.steps[i].waveform,n(t,r+1,e.steps[i].frequency),n(t,r+3,e.steps[i].volume),n(t,r+5,e.steps[i].duration)}return t}function s(e,t,i){const r=new Uint8Array(5+e.notes.length);n(r,0,e.startTick),n(r,2,e.endTick),r[4]=e.notes.length;for(let n=0;n<e.notes.length;n++)r[5+n]=o(e.notes[n],t,i);return r}function o(e,t,n){if(n)return e.note;let i=0;return"flat"===e.enharmonicSpelling?i=1:"sharp"===e.enharmonicSpelling&&(i=2),e.note-12*(t-2)|i<<6}function a(e){return e.drums?function(e){const t=e.drums.map(r),i=t.reduce((e,t)=>t.length+e,0),o=e.notes.map(e=>s(e,0,!0)),a=o.reduce((e,t)=>t.length+e,0),l=new Uint8Array(6+i+a);l[0]=e.id,l[1]=1,n(l,2,i);let c=4;for(const e of t)l.set(e,c),c+=e.length;n(l,c,a),c+=2;for(const e of o)l.set(e,c),c+=e.length;return l}(e):function(e){const t=function(e){var t,i,r,s,o,a,l,c,u;const d=new Uint8Array(28);return d[0]=e.waveform,n(d,1,e.ampEnvelope.attack),n(d,3,e.ampEnvelope.decay),n(d,5,e.ampEnvelope.sustain),n(d,7,e.ampEnvelope.release),n(d,9,e.ampEnvelope.amplitude),n(d,11,(null===(t=e.pitchEnvelope)||void 0===t?void 0:t.attack)||0),n(d,13,(null===(i=e.pitchEnvelope)||void 0===i?void 0:i.decay)||0),n(d,15,(null===(r=e.pitchEnvelope)||void 0===r?void 0:r.sustain)||0),n(d,17,(null===(s=e.pitchEnvelope)||void 0===s?void 0:s.release)||0),n(d,19,(null===(o=e.pitchEnvelope)||void 0===o?void 0:o.amplitude)||0),d[21]=(null===(a=e.ampLFO)||void 0===a?void 0:a.frequency)||0,n(d,22,(null===(l=e.ampLFO)||void 0===l?void 0:l.amplitude)||0),d[24]=(null===(c=e.pitchLFO)||void 0===c?void 0:c.frequency)||0,n(d,25,(null===(u=e.pitchLFO)||void 0===u?void 0:u.amplitude)||0),d[27]=e.octave,d}(e.instrument),i=e.notes.map(t=>s(t,e.instrument.octave,!1)),r=i.reduce((e,t)=>t.length+e,0),o=new Uint8Array(6+t.length+r);o[0]=e.id,o[1]=0,n(o,2,t.length);let a=4;o.set(t,a),a+=t.length,n(o,a,r),a+=2;for(const e of i)o.set(e,a),a+=e.length;return o}(e)}function l(e,t){return{waveform:e[t],ampEnvelope:{attack:i(e,t+1),decay:i(e,t+3),sustain:i(e,t+5),release:i(e,t+7),amplitude:i(e,t+9)},pitchEnvelope:{attack:i(e,t+11),decay:i(e,t+13),sustain:i(e,t+15),release:i(e,t+17),amplitude:i(e,t+19)},ampLFO:{frequency:e[t+21],amplitude:i(e,22)},pitchLFO:{frequency:e[t+24],amplitude:i(e,25)},octave:e[t+27]}}function c(e,t){return e[t+1]?function(e,t){const n={id:e[t],instrument:{ampEnvelope:{attack:0,decay:0,sustain:0,release:0,amplitude:0},waveform:0},notes:[],drums:[]},r=i(e,t+2);let s=t+4;for(;s<t+4+r;)n.drums.push(u(e,s)),s+=5+7*n.drums[n.drums.length-1].steps.length;const o=i(e,s);s+=2;for(;s<t+4+r+o;)n.notes.push(d(e,s,0,!0)),s+=5+n.notes[n.notes.length-1].notes.length;return[n,s]}(e,t):function(e,t){const n={id:e[t],instrument:l(e,t+4),notes:[]},r=t+4+i(e,t+2),s=i(e,r);let o=r+2;for(;o<r+2+s;)n.notes.push(d(e,o,n.instrument.octave,!1)),o+=5+n.notes[n.notes.length-1].notes.length;return[n,o]}(e,t)}function u(e,t){const n={startFrequency:i(e,t+1),startVolume:i(e,t+3),steps:[]};for(let r=0;r<e[t];r++){const s=t+5+7*r;n.steps.push({waveform:e[s],frequency:i(e,s+1),volume:i(e,s+3),duration:i(e,s+5)})}return n}function d(e,t,n,r){const s={startTick:i(e,t),endTick:i(e,t+2),notes:[]};for(let i=0;i<e[t+4];i++)s.notes.push(p(e[t+5+i],n,r));return s}function p(e,t,n){const i=e>>6,r={note:n?e:(63&e)+12*(t-2),enharmonicSpelling:"normal"};return 1===i?r.enharmonicSpelling="flat":2===i&&(r.enharmonicSpelling="sharp"),r}function h(e,t){if(typeof e!=typeof t)return!1;if("object"!=typeof e)return e===t;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!h(e[n],t[n]))return!1;return!0}const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const r of n){if(-1===i.indexOf(r))return!1;if(!h(e[r],t[r]))return!1}return!0}function f(e){return{ticksPerBeat:8,beatsPerMeasure:4,beatsPerMinute:120,measures:e,tracks:[{id:0,name:lf("Dog"),notes:[],iconURI:"music-editor/dog.png",instrument:{waveform:1,octave:4,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024},pitchLFO:{frequency:5,amplitude:0}}},{id:1,name:lf("Duck"),notes:[],iconURI:"music-editor/duck.png",instrument:{waveform:15,octave:4,ampEnvelope:{attack:5,decay:530,sustain:705,release:450,amplitude:1024},pitchEnvelope:{attack:5,decay:40,sustain:0,release:100,amplitude:40},ampLFO:{frequency:3,amplitude:20},pitchLFO:{frequency:6,amplitude:2}}},{id:2,name:lf("Cat"),notes:[],iconURI:"music-editor/cat.png",instrument:{waveform:12,octave:5,ampEnvelope:{attack:150,decay:100,sustain:365,release:400,amplitude:1024},pitchEnvelope:{attack:120,decay:300,sustain:0,release:100,amplitude:50},pitchLFO:{frequency:10,amplitude:6}}},{id:3,name:lf("Fish"),notes:[],iconURI:"music-editor/fish.png",instrument:{waveform:1,octave:3,ampEnvelope:{attack:220,decay:105,sustain:1024,release:350,amplitude:1024},ampLFO:{frequency:5,amplitude:100},pitchLFO:{frequency:1,amplitude:4}}},{id:4,name:lf("Car"),notes:[],iconURI:"music-editor/car.png",instrument:{waveform:16,octave:4,ampEnvelope:{attack:5,decay:100,sustain:1024,release:30,amplitude:1024},pitchLFO:{frequency:10,amplitude:4}}},{id:5,name:lf("Computer"),notes:[],iconURI:"music-editor/computer.png",instrument:{waveform:15,octave:2,ampEnvelope:{attack:10,decay:100,sustain:500,release:10,amplitude:1024}}},{id:6,name:lf("Burger"),notes:[],iconURI:"music-editor/burger.png",instrument:{waveform:1,octave:2,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}}},{id:7,name:lf("Cherry"),notes:[],iconURI:"music-editor/cherry.png",instrument:{waveform:2,octave:3,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}}},{id:8,name:lf("Lemon"),notes:[],iconURI:"music-editor/lemon.png",instrument:{waveform:14,octave:2,ampEnvelope:{attack:5,decay:70,sustain:870,release:50,amplitude:1024},pitchEnvelope:{attack:10,decay:45,sustain:0,release:100,amplitude:20},ampLFO:{frequency:1,amplitude:50},pitchLFO:{frequency:2,amplitude:1}}},{id:9,name:lf("Drums"),notes:[],iconURI:"music-editor/explosion.png",instrument:{waveform:11,octave:4,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}},drums:[{startFrequency:100,startVolume:1024,steps:[{waveform:3,frequency:120,duration:10,volume:1024},{waveform:3,frequency:1,duration:100,volume:0}]},{startFrequency:200,startVolume:1024,steps:[{frequency:0,volume:0,duration:100,waveform:1}]},{startFrequency:100,startVolume:1024,steps:[{frequency:0,volume:0,duration:250,waveform:1}]},{startFrequency:175,startVolume:1024,steps:[{waveform:1,frequency:200,duration:10,volume:1024},{waveform:1,frequency:150,duration:20,volume:1024},{waveform:5,frequency:1,duration:20,volume:100},{waveform:5,frequency:1,duration:300,volume:0}]},{startFrequency:220,startVolume:1024,steps:[{waveform:1,frequency:250,duration:10,volume:1024},{waveform:1,frequency:200,duration:20,volume:1024},{waveform:5,frequency:2e3,duration:20,volume:100},{waveform:5,frequency:2e3,duration:200,volume:0}]},{startFrequency:400,startVolume:500,steps:[{frequency:450,volume:500,duration:10,waveform:5},{frequency:400,volume:20,duration:20,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:5,duration:50,waveform:5},{frequency:900,volume:0,duration:250,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:200,duration:50,waveform:5},{frequency:900,volume:5,duration:100,waveform:5},{frequency:900,volume:0,duration:400,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:200,duration:100,waveform:5},{frequency:900,volume:5,duration:200,waveform:5},{frequency:900,volume:0,duration:500,waveform:5}]},{startFrequency:3500,startVolume:1024,steps:[{frequency:4e3,volume:0,duration:10,waveform:4},{frequency:3500,volume:800,duration:1,waveform:4},{frequency:4e3,volume:0,duration:40,waveform:4},{frequency:3500,volume:400,duration:1,waveform:4},{frequency:4e3,volume:0,duration:40,waveform:4}]},{startFrequency:2e3,startVolume:1024,steps:[{frequency:1800,volume:15,duration:100,waveform:4},{frequency:1800,volume:0,duration:200,waveform:4}]},{startFrequency:200,startVolume:200,steps:[{frequency:125,volume:200,duration:25,waveform:14},{frequency:100,volume:15,duration:50,waveform:14},{frequency:120,volume:0,duration:250,waveform:14}]},{startFrequency:300,startVolume:200,steps:[{frequency:225,volume:200,duration:25,waveform:14},{frequency:200,volume:15,duration:50,waveform:14},{frequency:220,volume:0,duration:250,waveform:14}]},{startFrequency:500,startVolume:200,steps:[{frequency:425,volume:200,duration:25,waveform:14},{frequency:400,volume:15,duration:50,waveform:14},{frequency:420,volume:0,duration:250,waveform:14}]},{startFrequency:200,startVolume:1024,steps:[{frequency:75,volume:0,duration:200,waveform:1}]},{startFrequency:300,startVolume:1024,steps:[{frequency:200,volume:0,duration:200,waveform:1}]},{startFrequency:400,startVolume:1024,steps:[{frequency:300,volume:0,duration:200,waveform:1}]},{startFrequency:200,startVolume:1024,steps:[{frequency:200,volume:15,duration:100,waveform:4},{frequency:150,volume:0,duration:200,waveform:4}]},{startFrequency:450,startVolume:1024,steps:[{frequency:350,volume:15,duration:100,waveform:4},{frequency:300,volume:0,duration:100,waveform:4}]},{startFrequency:2500,startVolume:1024,steps:[{frequency:2500,volume:100,duration:150,waveform:4},{frequency:2550,volume:0,duration:500,waveform:4}]},{startFrequency:3e3,startVolume:1024,steps:[{frequency:3e3,volume:100,duration:300,waveform:4},{frequency:3060,volume:0,duration:500,waveform:4}]},{startFrequency:800,startVolume:0,steps:[{frequency:800,volume:1024,duration:10,waveform:4},{frequency:800,volume:0,duration:490,waveform:4}]},{startFrequency:400,startVolume:0,steps:[{frequency:400,volume:1024,duration:10,waveform:4},{frequency:400,volume:0,duration:400,waveform:4}]},{startFrequency:2e3,startVolume:1024,steps:[{frequency:2e3,volume:100,duration:150,waveform:16},{frequency:2e3,volume:0,duration:200,waveform:16}]}]}]}}t.encodeSongToHex=function(t){const i=function(e){const t=e.tracks.filter(e=>e.notes.length>0).map(a),i=t.reduce((e,t)=>t.length+e,0),r=new Uint8Array(7+i);r[0]=0,n(r,1,e.beatsPerMinute),r[3]=e.beatsPerMeasure,r[4]=e.ticksPerBeat,r[5]=e.measures,r[6]=t.length;let s=7;for(const e of t)r.set(e,s),s+=e.length;return r}(t);return e.U.toHex(i)},t.decodeSongFromHex=function(t){return function(e){const t={beatsPerMinute:i(e,1),beatsPerMeasure:e[3],ticksPerBeat:e[4],measures:e[5],tracks:[]};let n=7;for(;n<e.length;){const[i,r]=c(e,n);n=r,t.tracks.push(i)}return t}(e.U.fromHex(t))},t.cloneSong=function(e){return Object.assign(Object.assign({},e),{tracks:e.tracks.map(e=>Object.assign(Object.assign({},e),{instrument:e.instrument&&Object.assign(Object.assign({},e.instrument),{ampEnvelope:Object.assign({},e.instrument.ampEnvelope),pitchEnvelope:e.instrument.pitchEnvelope&&Object.assign({},e.instrument.pitchEnvelope),ampLFO:e.instrument.ampLFO&&Object.assign({},e.instrument.ampLFO),pitchLFO:e.instrument.pitchLFO&&Object.assign({},e.instrument.pitchLFO)}),drums:e.drums&&e.drums.map(e=>Object.assign(Object.assign({},e),{steps:e.steps.map(e=>Object.assign({},e))})),notes:e.notes.map(e=>Object.assign(Object.assign({},e),{notes:e.notes.slice()}))}))})},t.songEquals=function(e,t){return h(e,t)},t.inflateSong=function(e){const t=f(1);e.tracks=t.tracks.map((t,n)=>{const i=e.tracks.find(e=>e.id===n);return i&&(t.notes=i.notes),t})},t.getSongInfo=function(e){return{ticksPerBeat:e.ticksPerBeat,beatsPerMeasure:e.beatsPerMeasure,beatsPerMinute:e.beatsPerMinute,measures:e.measures}},t.getEmptySong=f}(t.music||(t.music={}))}(e.assets||(e.assets={}))}(pxt||(pxt={})),function(e){const t=["name","version","description","license","dependencies","files","testFiles","testDependencies","fileDependencies","public","targetVersions","supportedTargets","preferredEditor","languageRestriction","additionalFilePath","additionalFilePaths"];class n{constructor(e,t,n,i,r){this.id=e,this._verspec=t,this.parent=n,this.depName=r,this.level=-1,this.isLoaded=!1,this.ignoreTests=!1,this.cppOnly=!1,i&&(this.level=i.level+1),this.addedBy=[i]}static stringifyConfig(e){const n=e,i={};for(const e of t)n.hasOwnProperty(e)&&(i[e]=n[e]);for(const e of Object.keys(n))i.hasOwnProperty(e)||(i[e]=n[e]);return JSON.stringify(i,null,4)+"\n"}static parseAndValidConfig(t){const n=e.Util.jsonTryParse(t);return n&&void 0!==n.name&&"string"==typeof n.name&&n.files&&Array.isArray(n.files)&&n.files.every(e=>"string"==typeof e)&&n.dependencies&&Object.keys(n.dependencies).every(e=>"string"==typeof n.dependencies[e])&&n}static async getConfigAsync(t,n,i){if(e.github.isGithubId(i)){const t=e.github.parseRepoId(i),n=await e.packagesConfigAsync();return await e.github.repoAsync(t.fullName,n)?await e.github.pkgConfigAsync(t.fullName,t.tag,n):null}if(i.startsWith("workspace:")){i.slice(10);return null}if(!i.startsWith("pub:")){const r=e.patching.upgradePackageReference(t,n,i),s=e.appTarget.bundledpkgs[r];return JSON.parse(s[e.CONFIG_NAME])}{const t=i.slice(4);try{const n=await e.Cloud.downloadScriptFilesAsync(t);return JSON.parse(n[e.CONFIG_NAME])}catch(t){return e.log(`Unable to fetch files for published script '${i}'`),null}}}static corePackages(){const t=e.appTarget.bundledpkgs;return Object.keys(t).map(n=>JSON.parse(t[n][e.CONFIG_NAME])).filter(e=>!!e)}disablesVariant(e){return this.config&&this.config.disablesVariants&&this.config.disablesVariants.indexOf(e)>=0}invalid(){return/^invalid:/.test(this.version())}version(){return this.resolvedVersion||this._verspec}verProtocol(){let e=this.version().split(":");return e.length>1?e[0]:""}verArgument(){let e=this.verProtocol();return e?this.version().slice(e.length+1):this.version()}targetVersion(){return this.parent&&this.parent!=this?this.parent.targetVersion():this.config.targetVersions?this.config.targetVersions.target:void 0}async commonDownloadAsync(){const t=this.verProtocol();let n;if("pub"==t)n=await e.Cloud.downloadScriptFilesAsync(this.verArgument());else if("github"==t){const t=await e.packagesConfigAsync();n=(await e.github.downloadPackageAsync(this.verArgument(),t)).files}else if("embed"==t)n=e.getEmbeddedScript(this.verArgument());else if("pkg"==t){const t=(this.parent||this).readFile(this.verArgument()),i=e.U.jsonTryParse(t);i||e.log(`unable to find ${this.verArgument()}`),n=i}return n}writeAssetPackFiles(){const t=JSON.parse(JSON.stringify(this.config));t.files=t.files.filter(e=>e.endsWith(".jres")),t.files.push("gallery.ts"),t.dependencies={},t.assetPack=!0,this.config=t,this.saveConfig();let n="";for(const i of t.files){const t=this.readFile(i),r=e.U.jsonTryParse(t);if(r){const[t,s]=e.emitGalleryDeclarations(r,this.getNamespaceName());this.writeFile(i,JSON.stringify(t,null,4)),n+=s}}this.writeFile("gallery.ts",n)}getNamespaceName(){let e=this,t=e.addedBy[0];const n=[];for(;t&&t!==e;)e.depName&&n.push(e.depName),e=t,t=e.addedBy[0];return n.reverse().map(e=>ts.pxtc.escapeIdentifier(e)).join(".")}host(){return this.parent._host}readFile(e){return this.host().readFile(this,e)}writeFile(e,t){this.host().writeFile(this,e,t,!0)}readGitJson(){const t=this.readFile(e.github.GIT_JSON);return e.Util.jsonTryParse(t)}resolveDep(e){return this.parent.deps.hasOwnProperty(e)?this.parent.deps[e]:null}saveConfig(){const t=e.U.clone(this.config);delete t.additionalFilePaths;const n=e.Package.stringifyConfig(t);this.host().writeFile(this,e.CONFIG_NAME,n)}setPreferredEditor(e){this.config.preferredEditor!=e&&(this.config.preferredEditor=e,this.saveConfig())}getPreferredEditor(){let t=this.config.preferredEditor;if(!t){if(!(this.getFiles().indexOf(e.MAIN_BLOCKS)>=0))return e.JAVASCRIPT_PROJECT_NAME;const t=this.readFile(e.MAIN_BLOCKS),n=this.readFile(e.MAIN_TS);return!t&&n?e.JAVASCRIPT_PROJECT_NAME:e.BLOCKS_PROJECT_NAME}return t}parseJRes(t={}){for(const n of this.getFiles())e.U.endsWith(n,".jres")&&i(JSON.parse(this.readFile(n)),t);return t}isAssetPack(){var e;return this.level>0&&!!(null===(e=this.config)||void 0===e?void 0:e.assetPack)}resolveVersionAsync(){var t;let n=this._verspec;if(e.getEmbeddedScript(this.id))this.resolvedVersion=n="embed:"+this.id;else if(n&&"*"!=n){if("github"==this.verProtocol()){const i=e.github.parseRepoId(this._verspec);if(i&&!i.tag&&this.parent){e.debug("dep: unbound github extensions, trying to resolve tag");const r=e.semver.sortLatestTags(e.Util.values((null===(t=this.parent)||void 0===t?void 0:t.deps)||{}).map(t=>e.github.parseRepoId(t.version())).filter(e=>(null==e?void 0:e.slug)===i.slug).map(e=>e.tag)),s=r[0];s&&(i.tag=s,this.resolvedVersion=n=e.github.stringifyRepo(i),e.debug(`dep: github patched ${this._verspec} to ${n}`))}}}else this.configureAsInvalidPackage(lf("version not specified for {0}",this.id)),n=this._verspec;return Promise.resolve(n)}downloadAsync(){return this.resolveVersionAsync().then(t=>{if(this.invalid())e.debug(`skip download of invalid package ${this.id}`);else if(/^embed:/.test(t)||this.installedVersion!=t)return e.debug("downloading "+t),this.host().downloadPackageAsync(this).then(()=>{this.loadConfig(),this.isAssetPack()&&this.writeAssetPackFiles(),e.debug(`installed ${this.id} /${t}`)})})}loadConfig(){if(0!=this.level&&this.invalid())return;const t=this.readFile(e.CONFIG_NAME);t||e.U.userError(`extension ${this.id} is missing ${e.CONFIG_NAME}`),this.parseConfig(t),0!=this.level&&(this.installedVersion=this.version()),this.saveConfig()}validateConfig(){this.config.dependencies||e.U.userError("Missing dependencies in config of: "+this.id),Array.isArray(this.config.files)||e.U.userError("Missing files in config of: "+this.id),"string"==typeof this.config.name&&this.config.name||(this.config.name=lf("Untitled")),this.config.targetVersions&&this.config.targetVersions.target&&this.config.targetVersions.targetId===e.appTarget.id&&e.appTarget.versions&&e.semver.majorCmp(this.config.targetVersions.target,e.appTarget.versions.target)>0&&e.U.userError(lf("{0} requires target version {1} (you are running {2})",this.config.name,this.config.targetVersions.target,e.appTarget.versions.target))}isPackageInUse(t,n=this.readFile(e.MAIN_TS)){let i=null;const r=e.patching.computePatches(this.targetVersion(),"missingPackage");return r&&r.forEach(e=>{Object.keys(e.map).forEach(n=>{e.map[n]===t&&(i=new RegExp(n,"g"))})}),i||(i=new RegExp(t+"\\.","g")),i.test(n)}upgradePackagesAsync(){return this.config||this.loadConfig(),e.packagesConfigAsync().then(async t=>{let n=0,i={};const r=[];return e.U.iterMap(this.config.dependencies,(s,o)=>{r.push((async()=>{if(e.github.isGithubId(o)){const r=await e.github.upgradedPackageReferenceAsync(t,o);r&&r!=o&&(e.log(`upgrading dep ${s}: ${o} -> ${r}`),i[o]=r,this.config.dependencies[s]=r,n++)}})())}),await Promise.all(r),n&&this.saveConfig(),n&&i})}getMissingPackages(t,n){const i=e.patching.computePatches(this.targetVersion(),"missingPackage"),r={};return n&&i&&i.forEach(e=>{Object.keys(e.map).forEach(i=>{const s=new RegExp(i,"g"),o=e.map[i];n.replace(s,e=>(t.dependencies[o]||(r[o]="*"),""))})}),r}findConflictsAsync(t,i){let r,s=[];return Promise.resolve().then(()=>"string"==typeof t?n.getConfigAsync(this.targetVersion(),t,i):Promise.resolve(t)).then(t=>{var n;if(r=t,r){const t=r.yotta?e.U.jsonFlatten(r.yotta.config):null;this.parent.sortedDeps().forEach(n=>{if(r.core&&n.config.core&&r.name!=n.config.name){const t=new e.cpp.PkgConflictError(lf("conflict between core extensions {0} and {1}",r.name,n.id));return t.pkg0=n,void s.push(t)}let o=!1;if(t){const i=n.config||JSON.parse(n.readFile(e.CONFIG_NAME));if(!!i&&!!i.yotta&&!!n.config.yotta.config){const a=e.U.jsonFlatten(i.yotta.config);for(const l of Object.keys(t)){const c=a[l],u=r.yotta.configIsJustDefaults||i.yotta.configIsJustDefaults;if(a.hasOwnProperty(l)&&c!==t[l]&&!u&&(!n.parent.config.yotta||!n.parent.config.yotta.ignoreConflicts)){const t=new e.cpp.PkgConflictError(lf("conflict on yotta setting {0} between extensions {1} and {2}",l,r.name,n.id));t.pkg0=n,t.settingName=l,s.push(t),o=!0}}}}if(!o&&r.name===n.id&&n._verspec!==i&&!/^file:/.test(n._verspec)&&!/^file:/.test(i)){const t=/^github:/.test(n._verspec)&&e.github.parseRepoId(n._verspec),r=/^github:/.test(i)&&e.github.parseRepoId(i);if(!t||!r||t.fullName!==r.fullName||r.tag&&e.semver.strcmp(t.tag,r.tag)<0){const t=new e.cpp.PkgConflictError(lf("version mismatch for extension {0} (added: {1}, adding: {2})",n.id,n._verspec,i));t.pkg0=n,t.isVersionConflict=!0,s.push(t)}}})}return Object.keys(null!==(n=null==r?void 0:r.dependencies)&&void 0!==n?n:{}).reduce((e,t)=>e.then(()=>this.findConflictsAsync(t,r.dependencies[t])).then(e=>s.push.apply(s,e)),Promise.resolve())}).then(()=>{const t=e=>{const n=[];return e.addedBy.forEach(e=>{e.id!==this.id&&(n.push.apply(t(e)),n.push(e))}),n},n=[];return s.forEach(s=>{n.push.apply(n,t(s.pkg0).map(t=>{const n=new e.cpp.PkgConflictError(s.isVersionConflict?lf("a dependency of {0} has a version mismatch with extension {1} (added: {1}, adding: {2})",t.id,r.name,s.pkg0._verspec,i):lf("conflict on yotta setting {0} between extensions {1} and {2}",s.settingName,r.name,s.pkg0.id));return n.pkg0=t,n}))}),s.push.apply(s,n),s=s.filter((e,t)=>{for(let n=0;n<t;++n)if(e.pkg0.id===s[n].pkg0.id)return!1;return!0}),s})}configureAsInvalidPackage(t){e.log(`invalid package ${this.id}: ${t}`),this._verspec="invalid:"+this.id,this.config={name:this.id,description:t,dependencies:{},files:[]}}parseConfig(t,n){var i;try{const e=JSON.parse(t);this.config=e}catch(t){this.configureAsInvalidPackage(lf("Syntax error in pxt.json")),e.tickEvent("package.invalidConfigEncountered")}const r=JSON.stringify(this.config);(null===(i=this.config)||void 0===i?void 0:i.files)&&(this.config.files=this.config.files.filter(t=>t!==e.HISTORY_FILE&&t!==e.CONFIG_NAME&&"undefined"!==t&&"null"!==t&&!!t));for(const t in this.config.dependencies){const n=e.patching.upgradePackageReference(this.targetVersion(),t,this.config.dependencies[t]);n!=t&&(delete this.config.dependencies[t],n&&(this.config.dependencies[n]="*"))}n&&(this.config.targetVersions={target:n}),JSON.stringify(this.config)!=r&&this.saveConfig(),this.validateConfig()}patchCorePackage(){e.Util.assert(e.appTarget.simulator&&e.appTarget.simulator.dynamicBoardDefinition),e.Util.assert(0==this.level);const t=Object.keys(this.config.dependencies).filter(t=>!!t&&(t==e.BLOCKS_PROJECT_NAME||t==e.JAVASCRIPT_PROJECT_NAME||JSON.parse((e.appTarget.bundledpkgs[t]||{})[e.CONFIG_NAME]||"{}").core));if(0==t.length){const t=e.Package.corePackages();t.length&&this.config.dependencies[t[0].name]}else t.length>1&&(t.pop(),t.forEach(t=>{e.log(`removing core package ${t}`),delete this.config.dependencies[t]}))}resolvedDependencies(){return Object.keys(this.dependencies()).map(e=>this.resolveDep(e))}dependencies(t=!1){if(!this.config)return{};const n=e.Util.clone(this.config.dependencies||{});return 0==this.level&&this.config.testDependencies&&e.Util.iterMap(this.config.testDependencies,(t,i)=>{("*"!=i||e.appTarget.bundledpkgs[t])&&(n[t]=i)}),t&&this.config.cppDependencies&&e.Util.jsonMergeFrom(n,this.config.cppDependencies),n}async loadAsync(t=!1,i){var r;if(this.isLoaded)return;0!=this.level||e.appTarget.multiVariants||e.setAppTargetVariant(null),this.isLoaded=!0;const s=this.readFile(e.CONFIG_NAME);if(null==s?t||e.U.userError("Package not installed: "+this.id+", did you forget to run `pxt install`?"):this.parseConfig(s),t||await this.upgradePackagesAsync(),t&&(await this.downloadAsync(),0!==this.level&&!this.isAssetPack()))for(const e of this.addedBy)if(null===(r=e.config.assetPacks)||void 0===r?void 0:r[this.id]){this.writeAssetPackFiles();break}if(t){const t=await this.upgradePackagesAsync();t&&(Object.keys(t).forEach(t=>e.tickEvent("package.doubleload",{extension:t})),e.log("upgraded, downloading again"),e.debug(t),await this.downloadAsync())}if(e.appTarget.simulator&&e.appTarget.simulator.dynamicBoardDefinition&&(0==this.level&&this.patchCorePackage(),this.config.compileServiceVariant&&e.setAppTargetVariant(this.config.compileServiceVariant),this.config.files.indexOf("board.json")>=0)){const t=e.appTarget.simulator.boardDefinition=JSON.parse(this.readFile("board.json"));t.id=this.config.name,e.appTarget.appTheme.boardName=t.boardName||lf("board"),e.appTarget.appTheme.driveDisplayName=t.driveDisplayName||lf("DRIVE");let n=t=>{let n=/^pkg:\/\/(.*)/.exec(t);if(n){let t=n[1],i=this.readFile(t);return e.U.toDataUri(i,e.U.getMime(t))}return t},i=e.appTarget.simulator.boardDefinition;if("object"==typeof i.visual){let e=i.visual;e.image=n(e.image),e.outlineImage=n(e.outlineImage)}}const o=(t,n)=>{var i;if(e.debug(`version spec mismatch: ${t._verspec} != ${n}`),/^github:/.test(t._verspec)&&/^github:/.test(n)){const r=e.github.parseRepoId(t._verspec),s=e.github.parseRepoId(n);if((null==r?void 0:r.slug)&&(null==r?void 0:r.slug)===(null==s?void 0:s.slug)){const o=(null==r?void 0:r.tag)||(null===(i=t.config)||void 0===i?void 0:i.version),a=s.tag;if(o&&!a)return void e.debug(`unversioned ${n}, using ${o}`);const l=e.semver.strcmp(o,s.tag);if(0==l)return void e.debug(`resolved version are ${o}`);if(l>0)return void e.debug(`auto-upgraded ${n} to ${o}`)}}/^file:/.test(t._verspec)||/^file:/.test(n)?e.debug("ignore file: mismatch issues"):t.configureAsInvalidPackage(lf("version mismatch"))},a=async(i,r,s=!1)=>{i||(i=r.dependencies(s)),e.debug(`deps: ${r.id}->${Object.keys(i).join(", ")}`),i=e.github.resolveMonoRepoVersions(i),e.debug(`deps: resolved ${r.id}->${Object.keys(i).join(", ")}`);for(let a of Object.keys(i)){let l=i[a]||"*";e.debug(`dep: load ${r.id}.${a}${s?"++":""}: ${l}`),"hw"==a&&e.hwVariant&&(a="hw---"+e.hwVariant);const c=e.github.parseRepoId(l);if(null==c?void 0:c.slug){const t=Object.values(r.parent.deps).map(t=>e.github.parseRepoId(t._verspec)).filter(e=>(null==e?void 0:e.slug)===c.slug).map(e=>e.tag).reduce((t,n)=>e.semver.strcmp(t,n)>0?t:n,"0.0.0");e.debug(`dep: common repo ${c.slug} version found ${t}`),e.semver.strcmp(t,"0.0.0")>0&&(!c.tag||e.semver.strcmp(t,c.tag)>0)&&(e.debug(`dep: upgrade from ${c.tag} to ${t}`),c.tag=t,l=e.github.stringifyRepo(c,!0))}let u=r.resolveDep(a);if(u){if(u.invalid()||u._verspec===l||o(u,l),u.invalid()){u.level=Math.min(u.level,r.level+1),u.addedBy.push(r);continue}s||(u.level=Math.min(u.level,r.level+1),u.addedBy.push(r))}else u=new n(a,l,r.parent,r,a),s&&(u.cppOnly=!0),r.parent.deps[a]=u,r.parent.deps[a.replace(/---.*/,"")]=u,await u.loadAsync(t)}};if(await a(null,this),this.patchAppTargetPalette(),this.config.screenSize&&e.appTarget.runtime&&(e.appTarget.runtime.screenSize=e.U.clone(this.config.screenSize)),0===this.level){const t=this.readFile(e.MAIN_TS);if(t){const n=this.getMissingPackages(this.config,t);let i=!1;for(const t of Object.keys(n)){const r=await this.findConflictsAsync(t,n[t]);if(r.length){const n=r.map(e=>e.pkg0.id).join(", "),i=r.map(e=>e.settingName).filter(e=>!!e).join(", ");e.log(`skipping missing package ${t} because it conflicts with the following packages: ${n} (conflicting settings: ${i})`)}else{e.log(`adding missing package ${t}`),i=!0,this.config.dependencies[t]="*";const r={};r[t]=n[t],await a(r,this)}}i&&(this.saveConfig(),this.validateConfig())}await Promise.all(e.U.values(this.parent.deps).map(e=>a(null,e,!0)))}e.debug(`  installed ${this.id}`)}getFiles(){let t;t=0!=this.level||this.ignoreTests?this.config.files.slice(0):this.config.files.concat(this.config.testFiles||[]);const i=this.config.fileDependencies;return this.config.fileDependencies&&(t=t.filter(t=>{const r=i=>{if("!"==(i=i.trim())[0])return!r(i.slice(1));if(/^[\w-]+$/.test(i)){const e=this.parent.resolveDep(i);return!(!e||e.cppOnly)}const s=/^target:(\w+)$/.exec(i);return s?s[1]==e.appTarget.id||s[1]==e.appTarget.platformid:(n.depWarnings[i]||(n.depWarnings[i]=!0,e.log(`invalid dependency expression: ${i} in ${this.id}/${t}`)),!1)},s=e.U.lookup(i,t);return!s||!s.trim()||s.split("||").some(e=>e.split("&&").every(r))})),t}addSnapshot(t,n=[""]){for(let i of this.getFiles())n.some(t=>e.U.endsWith(i,t))&&(t[this.id+"/"+i]=this.readFile(i));t[this.id+"/"+e.CONFIG_NAME]=this.readFile(e.CONFIG_NAME)}packageLocalizationStringsAsync(t){const n=e.appTarget.id,i=[this.config.name+"-jsdoc",this.config.name],r={};e.appTarget.appTheme;return this.config.skipLocalization?Promise.resolve(r):e.Util.liveLocalizationEnabled()&&"this"!=this.id&&e.appTarget.bundledpkgs[this.id]?(e.debug(`loading live translations for ${this.id}`),Promise.all(i.map(i=>e.Util.downloadLiveTranslationsAsync(t,`${n}/${i}-strings.json`).then(n=>{n&&Object.keys(n).length?e.Util.jsonMergeFrom(r,n):(e.tickEvent("translations.livetranslationsfailed",{filename:i}),e.Util.jsonMergeFrom(r,this.bundledStringsForFile(t,i)))}).catch(s=>{e.tickEvent("translations.livetranslationsfailed",{filename:i}),e.log(`error while downloading ${n}/${i}-strings.json`),e.Util.jsonMergeFrom(r,this.bundledStringsForFile(t,i))}))).then(()=>r)):(i.map(e=>this.bundledStringsForFile(t,e)).filter(e=>!!e).forEach(t=>e.Util.jsonMergeFrom(r,t)),Promise.resolve(r))}bundledStringsForFile(t,n){let i={},[r,s,o]=e.Util.normalizeLanguageCode(t);const a=this.config.files;let l=`_locales/${r}/${n}-strings.json`;if(o&&-1===a.indexOf(l)&&(l=`_locales/${o}/${n}-strings.json`),s&&-1===a.indexOf(l)&&(l=`_locales/${s}/${n}-strings.json`),a.indexOf(l)>-1)try{i=JSON.parse(this.readFile(l))}catch(n){e.reportError("extension","Extension localization JSON failed to parse",{fileName:l,lang:t,extension:this.verArgument()});"github"===this.verProtocol()&&e.tickEvent("loc.errors.json",{repo:this.verArgument(),file:l})}return i}patchAppTargetPalette(){this.config.palette&&e.appTarget.runtime&&(e.appTarget.runtime.palette=e.U.clone(this.config.palette),this.config.paletteNames&&(e.appTarget.runtime.paletteNames=this.config.paletteNames))}}n.depWarnings={},e.Package=n;function i(e,t={}){let n=e["*"]||{};for(let i of Object.keys(e)){if("*"==i)continue;let r=e[i];"string"==typeof r&&(r={data:r});let s=r.namespace||n.namespace||"";s&&!s.endsWith(".")&&(s+=".");let o=r.id||s+i,a=r.icon,l=r.mimeType||n.mimeType,c=r.dataEncoding||n.dataEncoding||"base64";a||"base64"!=c||"image/png"!=l&&"image/jpeg"!=l||(a="data:"+l+";base64,"+r.data),t[o]={id:o,data:r.data,dataEncoding:c,icon:a,namespace:s,mimeType:l,tilemapTile:r.tilemapTile,displayName:r.displayName,tileset:r.tileset,tags:r.tags}}return t}e.MainPackage=class extends n{constructor(e){super("this","file:.",null,null,null),this._host=e,this.deps={},this.parent=this,this.addedBy=[this],this.level=0,this.deps[this.id]=this}installAllAsync(e){return this.loadAsync(!0,e)}sortedDeps(t=!1){let n={},i=[];const r=e=>e.config?Object.keys(e.config.cppDependencies||{}).length:0,s=o=>{if(!o||e.U.lookup(n,o.id))return;n[o.id]=!0;const a=Object.keys(o.dependencies(t)).map(e=>this.resolveDep(e));a.sort((t,n)=>r(n)-r(t)||e.U.strcmp(t.id,n.id)),a.forEach(s),i.push(o.id)};return s(this),i.map(e=>this.resolveDep(e))}localizationStringsAsync(t){const n={};return Promise.all(e.Util.values(this.deps).map(e=>e.packageLocalizationStringsAsync(t).then(e=>{e&&Object.keys(e).forEach(t=>{n[t]||(n[t]=e[t])})}))).then(()=>{const t=e.U.getLocalizedStrings();return Object.keys(n).forEach(i=>{(e.U.startsWith(i,"{id:subcategory}")||e.U.startsWith(i,"{id:group}"))&&(t[i]||(t[i]=n[i]))}),e.U.setLocalizedStrings(t),Promise.resolve(n)})}getTargetOptions(){let t=e.U.clone(e.appTarget.compile);return e.U.assert(!!t),t.utf8||this.sortedDeps(!0).forEach(n=>{n.config&&n.config.utf8&&(e.debug("forcing utf8 mode: pkg="+n.id),t.utf8=!0)}),t}getJRes(){if(!this._jres){this._jres={};for(const e of this.sortedDeps())e.parseJRes(this._jres);const t=(e.appTarget.runtime&&e.appTarget.runtime.palette?e.appTarget.runtime.palette:["#000000","#ffffff"]).map(e=>("000000"+parseInt(e.replace(/#/,""),16).toString(16)).slice(-6)).join("");this._jres.__palette={id:"__palette",data:t,dataEncoding:"hex",mimeType:"application/x-palette"}}return this._jres}updateJRes(){this._jres&&this.parseJRes(this._jres)}resolveBannedCategories(){if(void 0!==this._resolvedBannedCategories)return this._resolvedBannedCategories;let t=[];return e.appTarget&&e.appTarget.runtime&&e.appTarget.runtime.bannedCategories&&e.appTarget.runtime.bannedCategories.length&&(t=e.appTarget.runtime.bannedCategories.slice(),Object.keys(this.deps).map(e=>this.deps[e]).filter(e=>!!e).map(t=>e.Util.jsonTryParse(t.readFile(e.CONFIG_NAME))).filter(e=>e&&e.requiredCategories).forEach(e=>e.requiredCategories.forEach(e=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)})),this._resolvedBannedCategories=t),this._resolvedBannedCategories=t,this._resolvedBannedCategories.length||(this._resolvedBannedCategories=null),this._resolvedBannedCategories}async getCompileOptionsAsync(t=this.getTargetOptions()){var n;let i={sourceFiles:[],fileSystem:{},target:t,name:this.config?this.config.name:""};const r=(t,n)=>{this.config.files.indexOf(t)<0&&e.U.userError(lf("please add '{0}' to \"files\" in {1}",t,e.CONFIG_NAME)),n="// Auto-generated. Do not edit.\n"+n+"\n// Auto-generated. Do not edit. Really.\n",this.host().readFile(this,t,!0)!==n&&(e.debug(`updating ${t} (size=${n.length})...`),this.host().writeFile(this,t,n,!0))},s=e.appTarget.disabledVariants;let o=!1;const a=async n=>{const i={extinfo:null,target:null},s=e.appTargetVariant;let a;n&&e.setAppTargetVariant(n,{temporary:!0});try{i.target=e.appTarget.compile,a=e.cpp.getExtensionInfo(this),o||!a.shimsDTS&&!a.enumsDTS||(o=!0,a.shimsDTS&&r("shims.d.ts",a.shimsDTS),a.enumsDTS&&r("enums.d.ts",a.enumsDTS))}finally{n&&e.setAppTargetVariant(s,{temporary:!0})}a.appVariant=n;const l=t.isNative?await this.host().getHexInfoAsync(a):null;return a=e.U.flatClone(a),t.keepCppFiles||(delete a.compileData,delete a.generatedFiles,delete a.extensionFiles),a.hexinfo=l,i.extinfo=a,i};let l;await this.loadAsync(),i.bannedCategories=this.resolveBannedCategories(),e.debug(`building: ${this.sortedDeps().map(e=>{var t;return null===(t=e.config)||void 0===t?void 0:t.name}).join(", ")}`),e.appTarget.multiVariants?(l=e.appTargetVariant?[e.appTargetVariant]:e.appTarget.alwaysMultiVariant||e.appTarget.compile.switches.multiVariant?e.appTarget.multiVariants:[e.appTarget.multiVariants[0]],!e.appTarget.alwaysMultiVariant&&s&&(l=l.filter(e=>!s.includes(e)))):l=[null];let c=null;await Promise.all(l.map(async t=>{c&&e.debug(`building for ${t}`);const n=await a(t),r=n.extinfo;r.appVariant=t,r.outputPrefix=1!=l.length&&t?t+"-":"",(null==s?void 0:s.indexOf(t))>-1&&(r.disabledDeps=r.disabledDeps||"user-disabled"),c?i.otherMultiVariants.push(n):(n.target.isNative=i.target.isNative,i.target=n.target,c=r,i.otherMultiVariants=[])})),i.extinfo=c,i.target.preferredEditor=this.getPreferredEditor();if(!(e.appTarget.compile.shortPointers||"vm"==e.appTarget.compile.nativeType||this.config.binaryonly||!i.target.isNative)){const t=await this.filesToBePublishedAsync(!0),n=JSON.stringify({name:this.config.name,comment:this.config.description,status:"unpublished",scriptId:this.installedVersion,cloudId:e.CLOUD_ID+e.appTarget.id,editor:this.getPreferredEditor(),targetVersions:e.appTarget.versions}),r=JSON.stringify(t),s=await e.lzmaCompressAsync(n+r);s&&(i.embedMeta=JSON.stringify({compression:"LZMA",headerSize:n.length,textSize:r.length,name:this.config.name,eURL:e.appTarget.appTheme.embedUrl,eVER:e.appTarget.versions?e.appTarget.versions.target:"",pxtTarget:e.appTarget.id}),i.embedBlob=ts.pxtc.encodeBase64(e.U.uint8ArrayToString(s)))}for(const e of this.sortedDeps())for(const t of e.getFiles())if(/\.(ts|asm|py)$/.test(t)){let n=t;e.level>0&&(n="pxt_modules/"+e.id+"/"+t),i.sourceFiles.push(n),i.fileSystem[n]=e.readFile(t)}i.jres=this.getJRes();const u=e.appTarget.runtime&&e.appTarget.runtime.functionsOptions;i.allowedArgumentTypes=u&&u.extraFunctionEditorTypes&&u.extraFunctionEditorTypes.map(e=>e.typeName).concat("number","boolean","string"),i.unfetteredInitializers=null===(n=e.appTarget.compile)||void 0===n?void 0:n.unfetteredInitializers;for(const e of this.sortedDeps())e.patchAppTargetPalette();return this.patchAppTargetPalette(),i}prepareConfigToBePublished(){const t=e.U.clone(this.config);return delete t.installedVersion,delete t.additionalFilePath,delete t.additionalFilePaths,t.targetVersions||(t.targetVersions=e.Util.clone(e.appTarget.versions)),e.U.iterMap(t.dependencies,(n,i)=>{if(!i||/^(file|workspace):/.test(i)){i="*";try{const t=this.resolveDep(n).readGitJson();if(t&&t.repo){let n=e.github.parseRepoId(t.repo);n.tag=t.commit.tag||t.commit.sha,i=e.github.stringifyRepo(n)}}catch(e){}t.dependencies[n]=i}}),t.files=t.files.filter(t=>t!==e.HISTORY_FILE),t}filesToBePublishedAsync(t=!1){const n={};return this.loadAsync().then(()=>{t||this.config.public||e.U.userError('Only packages with "public":true can be published');const i=this.prepareConfigToBePublished();n[e.CONFIG_NAME]=e.Package.stringifyConfig(i);for(let t of this.getFiles()){if(t===e.CONFIG_NAME||t===e.HISTORY_FILE)continue;let i=this.readFile(t);null==i&&e.U.userError("referenced file missing: "+t),n[t]=i}return e.U.sortObjectFields(n)})}saveToJsonAsync(){return this.filesToBePublishedAsync(!0).then(t=>({meta:{cloudId:e.CLOUD_ID+e.appTarget.id,targetVersions:e.appTarget.versions,editor:this.getPreferredEditor(),name:this.config.name},source:JSON.stringify(t,null,2)}))}compressToFileAsync(){return this.saveToJsonAsync().then(t=>e.lzmaCompressAsync(JSON.stringify(t,null,2)))}computePartDefinitions(t){if(!t||!t.length)return{};let n={};return this.sortedDeps().forEach(i=>{let r=i.readFile("pxtparts.json");if(r)try{let s=JSON.parse(r);Object.keys(s).forEach(r=>{if(t.indexOf(r)>=0){let t=n[r]=s[r];if("string"==typeof t.visual.image&&/\.svg$/i.test(t.visual.image)){let n=i.readFile(t.visual.image);n||e.reportError("parts","invalid part definition",{error:`missing visual ${t.visual.image}`}),/^data:image\/svg\+xml/.test(n)||(n="data:image/svg+xml,"+encodeURIComponent(n)),t.visual.image=n}}})}catch(t){e.reportError("parts","invalid pxtparts.json file")}}),n}},e.inflateJRes=i,e.allPkgFiles=function(t){return[e.CONFIG_NAME].concat(t.files||[]).concat(t.testFiles||[])},e.isPkgBeta=function(e){return e&&/\bbeta\b/.test(e.description)}}(pxt||(pxt={})),function(e){!function(t){let n,i,r,s,o,a=()=>{};function l(){if(o)return o;let t=Promise.resolve();if(n){e.debug("packetio: disconnect");const r=n;t=t.then(()=>r.disconnectAsync()).then(()=>r.io.disposeAsync()).catch(t=>{e.reportException(t)}).finally(()=>{i=void 0,n=void 0,o=void 0}),a&&(t=t.then(()=>a())),o=t}return t}t.isActive=function(){return!!n},t.isConnected=function(){return!!(null==n?void 0:n.isConnected())},t.isConnecting=function(){return!!(null==n?void 0:n.isConnecting())},t.icon=function(){var t;return!!n&&(n.icon||(null===(t=e.appTarget.appTheme.downloadDialogTheme)||void 0===t?void 0:t.deviceIcon)||"usb")},t.unsupportedParts=function(){return(null==n?void 0:n.unsupportedParts)?n.unsupportedParts():[]},t.deviceVariant=function(){return null==n?void 0:n.devVariant},t.disconnectAsync=l,t.configureEvents=function(e,t,i){a=e,r=t,s=i,n&&(n.io.onConnectionChanged=a,n.onSerial=r,n.onCustomEvent=i)},t.sendCustomEventAsync=function(e,t){return n?n.sendCustomEventAsync(e,t):Promise.resolve()},t.initAsync=function(o=!1){if(e.debug("packetio: init "+(o?"(force)":"")),!i){let c=Promise.resolve();o&&(c=c.then(()=>l())),i=c.then(()=>n?Promise.resolve(n):t.mkPacketIOAsync?(e.debug("packetio: new wrapper"),t.mkPacketIOAsync().then(e=>(e.onConnectionChanged=a,n=t.mkPacketIOWrapper(e),r&&(n.onSerial=r),s&&(n.onCustomEvent=s),a&&a(),n))):(e.debug("packetio: not defined, skipping"),Promise.resolve(void 0))).finally(()=>{i=void 0})}return i}}(e.packetio||(e.packetio={}))}(pxt||(pxt={})),function(e){!function(t){function n(t,n,i){const r=e.semver.tryParse(t||"0.0.0")||e.semver.tryParse("0.0.0");let s=[];return Object.keys(n).filter(t=>e.semver.inRange(t,r)).forEach(e=>s=s.concat(n[e])),i&&(s=s.filter(e=>e.type==i)),s.length?s:void 0}function i(e,t,n){let i=t;return n&&(n.filter(e=>"api"===e.type).forEach(e=>{Object.keys(e.map).forEach(t=>{const n=new RegExp(t,"g");i=i.replace(n,e.map[t])})}),n.filter(e=>"userenum"===e.type).forEach(e=>{Object.keys(e.map).forEach(t=>{const n=new RegExp("enum\\s+"+t+"\\s*{","gm");i=i.replace(n,`enum ${e.map[t]} {`);const r=new RegExp(`(^|[^_a-zA-Z0-9])${t}(\\s*\\.)`,"g");i=i.replace(r,`$1${e.map[t]}$2`)})})),i}t.computePatches=function(t,i){const r=e.appTarget.compile?e.appTarget.compile.patches:void 0;if(r)return n(t,r,i)},t.computePyPatches=function(t,i){const r=e.appTarget.compile?e.appTarget.compile.pyPatches:void 0;if(r)return n(t,r,i)},t.upgradePackageReference=function(t,n,i){if("*"!=i)return n;const r=e.patching.computePatches(t,"package");let s=n;return r&&r.forEach(e=>{Object.keys(e.map).forEach(t=>{s==t&&(s=e.map[t])})}),s},t.patchJavaScript=function(t,n){return i(t,n,e.patching.computePatches(t))},t.patchPython=function(t,n){return i(t,n,e.patching.computePyPatches(t))}}(e.patching||(e.patching={}))}(pxt||(pxt={})),function(e){e.react||(e.react={})}(pxt||(pxt={})),function(e){!function(t){function n(t,n){if(t){if(n){let i=t.major-n.major||t.minor-n.minor||t.patch-n.patch;if(i)return i;if(0==t.pre.length&&n.pre.length>0)return 1;if(t.pre.length>0&&0==n.pre.length)return-1;for(let r=0;r<t.pre.length+1;++r){let s=t.pre[r],o=n.pre[r];if(!s)return o?-1:0;if(!o)return 1;if(/^\d+$/.test(s)){if(!/^\d+$/.test(o))return-1;if(i=parseInt(s)-parseInt(o),i)return i}else{if(/^\d+$/.test(o))return 1;if(i=e.U.strcmp(s,o),i)return i}}return 0}return-1}return n?1:0}function i(t,n){let i=r(t)||r(n);return i||e.U.userError(e.U.lf("'{0}' doesn't look like a semantic version number",t)),i}function r(e){if(!e)return null;if("*"===e)return{major:Number.MAX_SAFE_INTEGER,minor:Number.MAX_SAFE_INTEGER,patch:Number.MAX_SAFE_INTEGER,pre:[],build:[]};/^v\d/i.test(e)&&(e=e.slice(1));let t=/^(\d+)\.(\d+)\.(\d+)(-([0-9a-zA-Z\-\.]+))?(\+([0-9a-zA-Z\-\.]+))?$/.exec(e);return t?{major:parseInt(t[1]),minor:parseInt(t[2]),patch:parseInt(t[3]),pre:t[5]?t[5].split("."):[],build:t[7]?t[7].split("."):[]}:null}function s(e){let t=e.major+"."+e.minor+"."+e.patch;return e.pre.length&&(t+="-"+e.pre.join(".")),e.build.length&&(t+="+"+e.build.join(".")),t}function o(t,i){let s=r(t),o=r(i);return s||o?n(s,o):e.U.strcmp(t,i)}function a(e,t){let i=e.split(" - ");if(2!=i.length)return!1;let s=r(i[0]),o=r(i[1]);if(!s||!o)return!1;if(!t)return!0;const a=n(s,t),l=n(t,o);return a<=0&&l<0}t.cmp=n,t.parse=i,t.tryParse=r,t.normalize=function(e){return s(i(e))},t.stringify=s,t.majorCmp=function(e,t){let n=r(e),i=r(t);return n.major-i.major},t.strcmp=o,t.inRange=a,t.sortLatestTags=function(e){const n=e.filter(e=>!!t.tryParse(e));return n.sort(o),n.reverse(),n},t.bump=function(t,n){let r=i(s(t));switch(n){case"major":r.major++,r.minor=0,r.patch=0;break;case"minor":r.minor++,r.patch=0;break;case"patch":r.patch++;break;default:r=e.semver.parse(n)}return r},t.test=function(){e.log("Test semver");let t=["0.9.0","1.0.0-0.3.7","1.0.0-alpha","1.0.0-alpha.1","1.0.0-alpha.beta","1.0.0-beta","1.0.0-beta.2","1.0.0-beta.11","1.0.0-rc.1","1.0.0-x.7.z.92","1.0.0","1.0.1","1.9.0","1.10.0","1.11.0"];for(let r=0;r<t.length;++r){let o=i(t[r]);e.log(t[r],o),e.U.assert(s(o)==t[r]);for(let s=0;s<t.length;++s){let a=n(o,i(t[s]));e.log(t[r],t[s],a),r<s?e.U.assert(a<0):r>s?e.U.assert(a>0):e.U.assert(0==a)}}const o=r("1.2.3");e.U.assert(a("0.1.2 - 2.2.3",o)),e.U.assert(a("1.2.3 - 2.2.3",o)),e.U.assert(!a("0.0.0 - 1.2.3",o)),e.U.assert(!a("1.2.4 - 4.2.3",o)),e.U.assert(!a("0.0.0 - 0.0.1",o))}}(e.semver||(e.semver={}))}(pxt||(pxt={})),function(e){!function(e){function t(t){return e.Util.values(t.byQName).filter(e=>e.attributes.block&&/^{[^:]+:[^}]+}/.test(e.attributes.block)).forEach(e=>{e.attributes.block=e.attributes.block.replace(/^{[^:]+:[^}]+}/,"")}),t}function n(t,n){const i=pxt.Util.translationsCache();i[e.BLOCK_TRANSLATION_CACHE_KEY]||(i[e.BLOCK_TRANSLATION_CACHE_KEY]={}),i[e.BLOCK_TRANSLATION_CACHE_KEY][t]=n}function i(t){const n=pxt.Util.translationsCache();n[e.BLOCK_TRANSLATION_CACHE_KEY]&&delete n[e.BLOCK_TRANSLATION_CACHE_KEY][t]}e.assert=e.Util.assert,e.oops=e.Util.oops,e.U=e.Util,e.ON_START_TYPE="pxt-on-start",e.ON_START_COMMENT="on start",e.HANDLER_COMMENT="code goes here",e.TS_STATEMENT_TYPE="typescript_statement",e.TS_DEBUGGER_TYPE="debugger_keyword",e.TS_BREAK_TYPE="break_keyword",e.TS_CONTINUE_TYPE="continue_keyword",e.TS_OUTPUT_TYPE="typescript_expression",e.TS_RETURN_STATEMENT_TYPE="function_return",e.PAUSE_UNTIL_TYPE="pxt_pause_until",e.COLLAPSED_BLOCK="pxt_collapsed_block",e.FUNCTION_DEFINITION_TYPE="function_definition",e.BINARY_JS="binary.js",e.BINARY_ASM="binary.asm",e.BINARY_HEX="binary.hex",e.BINARY_UF2="binary.uf2",e.BINARY_ELF="binary.elf",e.BINARY_PXT64="binary.pxt64",e.BINARY_ESP="binary.bin",e.BINARY_SRCMAP="binary.srcmap",e.NATIVE_TYPE_THUMB="thumb",e.NATIVE_TYPE_VM="vm",e.BLOCK_TRANSLATION_CACHE_KEY="_blocks",e.BuildSourceMapHelpers=function(e,t,n){const i=e=>{const t=e.split("\n").map(e=>e.length),n=t.reduce(({lens:e,sum:t},n)=>({lens:[...e,t+n+1],sum:t+n+1}),{lens:[],sum:0}).lens;return{posToLineCol:e=>{const i=n.reduce((t,n,i)=>e<n?t:i+1,0);return[i,t[i]-(n[i]-e)+1]},lineColToPos:(e,t)=>(n[e-1]||0)+t}},r={ts:i(t),py:i(n)},s=e=>e.endPos-e.startPos,o=(t,n)=>{const{startPos:i,endPos:r}=t;return e.filter(e=>e[n].startPos<=i&&r<=e[n].endPos)},a=(e,t)=>{const n=o(e,t);return n.reduce((e,n)=>s(n[t])<s(e[t])?n:e,n[0])},l={ts:{allOverlaps:e=>o(e,"ts"),smallestOverlap:e=>a(e,"ts")},py:{allOverlaps:e=>o(e,"py"),smallestOverlap:e=>a(e,"py")}},c=(e,t)=>n=>{const[i,o]=(t=>[r[e].lineColToPos(t.line,t.column),t.length])(n),l=a({startPos:i,endPos:i+o},e);if(!l)return;const[c,u]=r[t].posToLineCol(l[t].startPos);return{fileName:`main.${t}`,start:l[t].startPos,length:s(l[t]),line:c,column:u}},u=c("ts","py"),d=c("py","ts");return{ts:Object.assign(Object.assign(Object.assign({},r.ts),l.ts),{locToLoc:u,getText:e=>t.substring(e.startPos,e.endPos)}),py:Object.assign(Object.assign(Object.assign({},r.py),l.py),{locToLoc:d,getText:e=>n.substring(e.startPos,e.endPos)})}},e.computeUsedParts=function(e,t,n=!1){if(!e.usedSymbols||!pxt.appTarget.simulator||!n&&!pxt.appTarget.simulator.parts)return[];const i=(e,t)=>{if(e){const n=e.split(/[ ,]+/g);t.push(...n.filter(e=>!!e&&t.indexOf(e)<0))}};let r=[],s=[];if(Object.keys(e.usedSymbols).forEach(t=>{const n=e.usedSymbols[t];i(null==n?void 0:n.attributes.parts,r),i(null==n?void 0:n.attributes.hiddenParts,s)}),t){const e=pxt.appTarget.simulator.boardDefinition.onboardComponents;e&&("ignorebuiltin"===t?r=r.filter(t=>-1===e.indexOf(t)):"onlybuiltin"===t&&(r=r.filter(t=>e.indexOf(t)>=0)))}return r=r.filter(e=>s.indexOf(e)<0),r.sort(),r=r.reverse(),r},e.buildSimJsInfo=function(t){var n;return{js:t.outfiles[e.BINARY_JS],targetVersion:pxt.appTarget.versions.target,fnArgs:t.usedArguments,parts:e.computeUsedParts(t,"ignorebuiltin"),usedBuiltinParts:e.computeUsedParts(t,"onlybuiltin"),allParts:e.computeUsedParts(t,void 0,!0),breakpoints:null===(n=t.breakpoints)||void 0===n?void 0:n.map(e=>e.id)}},e.blocksCategory=function(t){const n=t?t.attributes.blockNamespace||t.namespace:void 0;return n?e.Util.capitalize(n.split(".")[0]):void 0},e.getBlocksInfo=function(t,n){var i,r;let s=[];const l={},c={},u={},d={},p={};function h(t,n){const i="get"==t,r="set"==t,o="number"==n.retType,d=i?c:r?l:u,p=`${n.namespace}.${n.retType}`;let h=e.U.lookup(d,p);if(!h){const l=`@${t}@`;let c,u;if(n.attributes.blockCombineShadow){const t=n.attributes.blockCombineShadow,i=t.match(/^([^,.]*),?([^,.]*)$/);i&&3==i.length&&(c=i[1].trim(),u=i[2].trim(),0!=u.length||e.Util.endsWith(t,",")||(u=c,c=""))}const f=`${n.attributes.blockSetVariable||n.namespace.toLocaleLowerCase()}=${c||""}`,m=`value=${u||""}`;h=d[p]={attributes:{blockId:`${o?n.namespace:p}_blockCombine_${t}`,callingConvention:0,group:n.attributes.group,paramDefl:{},jsDoc:i?e.U.lf("Read value of a property on an object"):e.U.lf("Update value of property on an object")},name:l,namespace:n.namespace,fileName:n.fileName,qName:`${p}.${l}`,pkg:n.pkg,kind:2,parameters:[{name:"property",description:i?e.U.lf("the name of the property to read"):e.U.lf("the name of the property to change"),isEnum:!0,type:"@combined@"},{name:"value",description:r?e.U.lf("the new value of the property"):e.U.lf("the amount by which to change the property"),type:n.retType}].slice(0,i?1:2),retType:i?n.retType:"void",combinedProperties:[]},h.attributes.block=i?`%${f} %property`:r?e.U.lf("set %{0} %property to %{1}",f,m):e.U.lf("change %{0} %property by %{1}",f,m),a(h.attributes),pxt.Util.isTranslationMode()&&(h.attributes.translationId=h.attributes.block,h.attributes.block=i?`%${f} %property`:r?`set %${f} %property to %${m}`:`change %${f} %property by %${m}`,a(h.attributes),pxt.crowdin.inContextLoadAsync(h.attributes.translationId).then(e=>{h.attributes.block=e,a(h.attributes)})),s.push(h)}function f(e){n.attributes[e]&&(h.attributes[e]?h.attributes[e]!==n.attributes[e]&&console.warn(`Ignoring duplicate ${e} for get/set/change block: ${n.attributes[e]}`):h.attributes[e]=n.attributes[e])}f("blockCombineChangeHelp"),f("blockCombineGetHelp"),f("blockCombineSetHelp"),f("help"),h.combinedProperties.push(n.qName)}for(let n of e.Util.values(t.byQName)){if("ENUM_GET"===n.attributes.shim&&n.attributes.enumName&&n.attributes.blockId){let e=!1;if(d[n.attributes.enumName]&&(pxt.warn(`Enum block ${n.attributes.blockId} trying to overwrite enum ${n.attributes.enumName}`),e=!0),n.attributes.enumMemberName||(pxt.warn(`Enum block ${n.attributes.blockId} should specify enumMemberName`),e=!0),n.attributes.enumPromptHint||(pxt.warn(`Enum block ${n.attributes.blockId} should specify enumPromptHint`),e=!0),n.attributes.enumInitialMembers&&n.attributes.enumInitialMembers.length||(pxt.warn(`Enum block ${n.attributes.blockId} should specify enumInitialMembers`),e=!0),e)continue;const t=parseInt(n.attributes.enumStartValue);d[n.attributes.enumName]={blockId:n.attributes.blockId,name:n.attributes.enumName,memberName:n.attributes.enumMemberName,firstValue:isNaN(t)?void 0:t,isBitMask:n.attributes.enumIsBitMask,isHash:n.attributes.enumIsHash,initialMembers:n.attributes.enumInitialMembers,promptHint:n.attributes.enumPromptHint}}if("KIND_GET"===n.attributes.shim&&n.attributes.blockId){const i=n.attributes.kindNamespace||n.attributes.blockNamespace||n.namespace;if(p[i]){pxt.warn(`More than one block defined for kind ${i}`);continue}const r=[];if(t.byQName[i])for(const n of e.Util.values(t.byQName))n.namespace===i&&n.attributes.isKind&&r.push(n.name);p[i]={blockId:n.attributes.blockId,name:i,memberName:n.attributes.kindMemberName||i,initialMembers:r,promptHint:n.attributes.enumPromptHint||e.Util.lf("Create a new kind..."),createFunctionName:n.attributes.kindCreateFunction||"create"}}if(n.attributes.blockCombine)/@set/.test(n.name)||h("get",n),n.isReadOnly||("number"==n.retType&&h("change",n),h("set",n));else if(n.attributes.block&&!n.attributes.fixedInstance&&7!=n.kind&&5!=n.kind&&9!=n.kind&&8!=n.kind&&!n.attributes.blockIdentity){if(n.attributes.blockId||(n.attributes.blockId=n.qName.replace(/\./g,"_")),"true"==n.attributes.block){let t=e.U.uncapitalize(n.name);1!=n.kind&&2!=n.kind||(t+=" %"+n.namespace.toLowerCase());const s=null!==(r=null===(i=n.parameters)||void 0===i?void 0:i.filter(e=>!o(e)))&&void 0!==r?r:[];for(let e of s)t+=" %"+e.name;n.attributes.block=t,a(n.attributes)}s.push(n)}}for(let n of s){let i=e.U.lookup(t.byQName,n.namespace);if(!i)continue;let r=i.attributes,s=n.attributes;for(let e of["blockNamespace","color","blockGap"])void 0===s[e]&&r[e]&&(s[e]=r[e])}var f;return n&&((f=n).length&&(s=s.filter(e=>{let t=(e.attributes.blockNamespace||e.namespace).split(".")[0];return-1===f.indexOf(t)}))),{apis:t,blocks:s,blocksById:pxt.Util.toDictionary(s,e=>e.attributes.blockId),enumsByName:d,kindsByName:p}},e.tsSnippetToPySnippet=function(t,n){const i={true:"True",false:"False",null:"None"}[t];if(i)return i;if(n&&6==n.kind||!n&&t.includes(".")){const n=t.lastIndexOf("."),i=t.substr(0,n);let r=t.substr(n+1);return r=e.U.snakify(r).toUpperCase(),i?`${i}.${r}`:r}return t},e.apiLocalizationStrings={},e.localizeApisAsync=async function(r,s){const o=e.Util.userLanguage();if("en"==o)return Promise.resolve(t(r));const l=o.toLowerCase(),c=l+"|jsdoc",u=l+"|block",d=await s.localizationStringsAsync(o);e.apiLocalizationStrings&&e.Util.jsonMergeFrom(d,e.apiLocalizationStrings);const p=e.Util.values(r.byQName).filter(e=>e.attributes._translatedLanguageCode!==o);return await e.Util.promiseMapAll(p,async t=>{var s,p,h;const f=t.attributes.useLoc||t.attributes.blockAliasFor,m=f&&r.byQName[f];t.attributes._untranslatedJsDoc&&(t.attributes.jsDoc=t.attributes._untranslatedJsDoc),t.attributes._untranslatedBlock&&(t.attributes.jsDoc=t.attributes._untranslatedBlock);const g=(e,n)=>{var i,r;return d[t.qName+e]||(null===(i=t.attributes.locs)||void 0===i?void 0:i[n])||m&&(d[m.qName+e]||(null===(r=m.attributes.locs)||void 0===r?void 0:r[n]))},_=g("",c);_&&(t.attributes._untranslatedJsDoc||(t.attributes._untranslatedJsDoc=t.attributes.jsDoc),t.attributes.jsDoc=_),null===(s=t.parameters)||void 0===s||s.forEach(e=>{const t=`|param|${e.name}`,n=g(t,l+t);n&&(e.description=n)});const y=d["{id:category}"+e.Util.capitalize(t.qName)];let b=d[`${t.qName}|block`]||(null===(p=t.attributes.locs)||void 0===p?void 0:p[u]);if(t.attributes.block){const e=pxt.blocks.compileInfo(t);if(e.handlerArgs)for(const t of e.handlerArgs)d[t.localizationKey]?n(t.localizationKey,d[t.localizationKey]):i(t.localizationKey)}if(!b&&m){const e=d[`${m.qName}|block`]||(null===(h=m.attributes.locs)||void 0===h?void 0:h[u]);t.attributes.block===(m.attributes._untranslatedBlock||m.attributes.block)&&e&&(b=e)}if(b&&pxt.Util.isTranslationMode()&&(t.attributes.translationId=b,b=await pxt.crowdin.inContextLoadAsync(b)),y)t.attributes.block?t.attributes.block=b||t.attributes.block:t.attributes.block=y,a(t.attributes);else if(t.attributes.block&&b){const e=pxt.blocks.compileInfo(t),n=t.attributes.block;if(t.attributes.block=pxt.blocks.normalizeBlock(b,e=>{pxt.tickEvent("loc.normalized",{block:t.attributes.block,lang:o,error:e})}),t.attributes._untranslatedBlock||(t.attributes._untranslatedBlock=n),n!=t.attributes.block){a(t.attributes);(function(e,t){if(e.parameters.length!=t.parameters.length)return pxt.debug("Localized block has extra or missing parameters"),!1;for(const n of e.parameters){const e=t.actualNameToParam[n.actualName];if(!e||n.type!=e.type||n.shadowBlockId!=e.shadowBlockId||n.definitionName!=e.definitionName)return pxt.debug(`Parameter ${n.actualName} type, shadow block, or definition name does not match after localization`),!1}return!0})(e,pxt.blocks.compileInfo(t))||(pxt.reportError("loc.errors","block has non matching arguments",{block:t.attributes.blockId,lang:o,originalDefinition:n,translatedBlock:t.attributes.block}),pxt.tickEvent("loc.errors",{block:t.attributes.blockId,lang:o}),t.attributes.block=n,a(t.attributes))}}else a(t.attributes);t.attributes._translatedLanguageCode=o}),t(r)},e.getBlockTranslationsCacheKey=function(t){const n=pxt.Util.translationsCache();if(n[e.BLOCK_TRANSLATION_CACHE_KEY])return n[e.BLOCK_TRANSLATION_CACHE_KEY][t]},e.emptyExtInfo=function(){let e=pxt.appTarget.compileService;e||(e={});const t=!!e.platformioIni,n="dockermake"==e.buildEngine||"dockercross"==e.buildEngine||"dockerespidf"==e.buildEngine,i={functions:[],generatedFiles:{},extensionFiles:{},sha:"",compileData:"",shimsDTS:"",enumsDTS:"",onlyPublic:!0};return t?i.platformio={dependencies:{}}:n?i.npmDependencies={}:i.yotta={config:{},dependencies:{}},i};const r=["weight","imageLiteral","gridLiteral","topblockWeight","inlineInputModeLimit"],s=["advanced","handlerStatement","forceStatement","afterOnStart","optionalVariableArgs","blockHidden","constantShim","blockCombine","enumIsBitMask","enumIsHash","decompileIndirectFixedInstances","topblock","callInDebugger","duplicateShadowOnDrag","argsNullable","compileHiddenArguments","expandArgumentsInToolbox"];function o(e){return"Action"===e.type||/^\([^\)]*\)\s*=>/.test(e.type)}function a(e){if(e.block){const n=e.block.split("||");e._def=t(l(n[0])),e._def||pxt.debug("Unable to parse block def for id: "+e.blockId),n[1]&&(e._expandedDef=t(l(n[1]))),n[1]&&!e._expandedDef&&pxt.debug("Unable to parse expanded block def for id: "+e.blockId)}function t(t){return e._shadowOverrides&&t.parameters.forEach(t=>{const n=e._shadowOverrides[t.name];"unset"===n?delete t.shadowBlockId:null!=n&&(t.shadowBlockId=n)}),t}}function l(e){const t=[];let n,i=0;for(;i<e.length;i++){const r=e[i],s=i;let o;switch(r){case"*":case"_":const t=d(e=>e==r),n="_"===r?2:0;1===t.length?o={kind:1<<n,content:t}:2===t.length?o={kind:2<<n,content:t}:3===t.length?o={kind:3<<n,content:t}:i=s;break;case"`":const a=p("`");if(void 0===a){i=s;break}o={kind:256,content:a};break;case"|":o={kind:32};break;case"\\":i<e.length-1&&(o={kind:16,content:e[1+i++]});break;case"[":const l=p("]");if(void 0!==l&&"("===e[1+i++]){const e=p(")");if(void 0!==e){o={kind:512,content:l,type:e};break}}i=s;break;case"$":case"%":const c=d(e=>/[a-zA-Z0-9_=]/.test(e),!0).split("=");if(c.length>2){i=s;break}let u;if("("===e[i+1]){const e=i;++i,u=p(")"),u||(i=e)}o={kind:"$"===r?1024:64,content:c[0],type:c[1],name:u}}o?(n&&t.push({kind:128,content:n}),n=void 0,t.push(o)):n?n+=r:n=r}n&&t.push({kind:128,content:n});const r=[],s=[];let o=[],a=0,l="",u=[];for(let e=0;e<t.length;e++){const n=t[e].kind,i=o[o.length-1];if(15&n)if(m(t[e].content),n&a)if(i&n){o.pop(),a^=n;const e=i&a|n&a;e&&o.push(e)}else h();else a|=n,o.push(n);else 144&n?l+=t[e].content:1120&n&&f();if(64==n){const n={kind:"param",name:t[e].content,shadowBlockId:t[e].type,ref:!1};t[e].name&&(n.varName=t[e].name),r.push(n),s.push(n)}else if(1024==n){const n={kind:"param",name:t[e].content,shadowBlockId:t[e].type,ref:!0};t[e].name&&(n.varName=t[e].name),r.push(n),s.push(n)}else 256==n?(m(),u.push({kind:"image",uri:t[e].content})):512==n?(m(),u.push({kind:"label",text:t[e].content,cssClass:t[e].type})):32==n&&r.push({kind:"break"})}return f(),{parts:r,parameters:s};function d(t,n=!1){let r="";for(n&&i++;i<e.length&&t(e[i]);)r+=e[i],++i;return r&&i--,r}function p(t){const n=d(e=>e!==t,!0);if(e[i+1]===t)return++i,n}function h(){let e="",t=[];for(const n of u)c(n)?(t.push({content:e,styles:0}),t.push(n),e=""):(e+=n.content,n.endingToken&&(e+=n.endingToken));u=t,e&&u.push({content:e,styles:0}),o=[],a=0}function f(){for(m(),a&&h();u.length;){const e=u.shift();if(c(e))r.push(e);else{if(!e.content)continue;const t=[];10&e.styles&&t.push("bold"),5&e.styles&&t.push("italics"),r.push({kind:"label",text:e.content,style:t})}}}function m(e){u.push({content:l,styles:a,endingToken:e}),l=""}}function c(e){return!!e.kind}let u;e.parseCommentString=function(t){let n={paramDefl:{},callingConvention:0,_source:t},i=!0;for(;i;)i=!1,t=t.replace(/\/\/%[ \t]*([\w\.-]+)(=(("[^"\n]*")|'([^'\n]*)'|([^\s]*)))?/,(t,r,s,o,a,l,c)=>{let u=a?JSON.parse(a):s?a||l||c:"true";if(u||(u=""),e.U.startsWith(r,"block.loc."))n.locs||(n.locs={}),n.locs[r.slice(10).toLowerCase()+"|block"]=u;else if(e.U.startsWith(r,"jsdoc.loc."))n.locs||(n.locs={}),n.locs[r.slice(10).toLowerCase()+"|jsdoc"]=u;else if(e.U.contains(r,".loc.")){n.locs||(n.locs={});const e=r.slice(0,r.indexOf(".loc.")),t=r.slice(r.indexOf(".loc.")+5);n.locs[t+"|param|"+e]=u}else if(e.U.endsWith(r,".defl"))u.indexOf(" ")>-1?n.paramDefl[r.slice(0,r.length-5)]=`"${u}"`:n.paramDefl[r.slice(0,r.length-5)]=u,n.explicitDefaults||(n.explicitDefaults=[]),n.explicitDefaults.push(r.slice(0,r.length-5));else if(e.U.endsWith(r,".shadow"))n._shadowOverrides||(n._shadowOverrides={}),n._shadowOverrides[r.slice(0,r.length-7)]=u;else if(e.U.endsWith(r,".snippet")){n.paramSnippets||(n.paramSnippets={});const e=r.slice(0,r.length-8);n.paramSnippets[e]||(n.paramSnippets[e]={}),n.paramSnippets[e].ts=u}else if(e.U.endsWith(r,".pySnippet")){n.paramSnippets||(n.paramSnippets={});const e=r.slice(0,r.length-10);n.paramSnippets[e]||(n.paramSnippets[e]={}),n.paramSnippets[e].python=u}else if(e.U.endsWith(r,".fieldEditor"))n.paramFieldEditor||(n.paramFieldEditor={}),n.paramFieldEditor[r.slice(0,r.length-12)]=u;else if(e.U.contains(r,".fieldOptions.")){n.paramFieldEditorOptions||(n.paramFieldEditorOptions={});const e=r.slice(0,r.indexOf(".fieldOptions.")),t=r.slice(r.indexOf(".fieldOptions.")+14,r.length);n.paramFieldEditorOptions[e]||(n.paramFieldEditorOptions[e]={}),n.paramFieldEditorOptions[e][t]=u}else if(e.U.contains(r,".shadowOptions.")){n.paramShadowOptions||(n.paramShadowOptions={});const e=r.slice(0,r.indexOf(".shadowOptions.")),t=r.slice(r.indexOf(".shadowOptions.")+15,r.length);n.paramShadowOptions[e]||(n.paramShadowOptions[e]={}),n.paramShadowOptions[e][t]=u}else e.U.endsWith(r,".min")?(n.paramMin||(n.paramMin={}),n.paramMin[r.slice(0,r.length-4)]=u):e.U.endsWith(r,".max")?(n.paramMax||(n.paramMax={}),n.paramMax[r.slice(0,r.length-4)]=u):n[r]=u;return i=!0,"//% "});for(let e of r)"string"==typeof n[e]&&(n[e]=parseInt(n[e]));for(let e of s)"string"==typeof n[e]&&(n[e]="true"==n[e]||"1"==n[e]);if(n.trackArgs&&(n.trackArgs=n.trackArgs.split(/[ ,]+/).map(e=>parseInt(e)||0)),n.enumInitialMembers&&(n.enumInitialMembers=n.enumInitialMembers.split(/[ ,]+/)),n.blockExternalInputs&&!n.inlineInputMode&&(n.inlineInputMode="external"),n.paramHelp={},n.jsDoc="",t=t.replace(/\/\*\*([^]*?)\*\//g,(e,t)=>(t=(t=t.replace(/\n\s*(\*\s*)?/g,"\n")).replace(/^\s*@param\s+(\w+)\s+(.*)$/gm,(e,t,i)=>{if(n.paramHelp[t]=i,!n.paramDefl[t]){let e=/\beg\.?:\s*(.+)/.exec(i);if(e&&e[1]){let i=/(?:"([^"]*)")|(?:'([^']*)')|(?:([^\s,]+))/g.exec(e[1]);if(i){let e=i[1]||i[2]||i[3];e||(e=""),e.indexOf(" ")>-1?n.paramDefl[t]=`"${e}"`:n.paramDefl[t]=e}}}return""}),n.jsDoc+=t,"")),n.jsDoc=n.jsDoc.trim(),n.async&&(n.callingConvention=1),n.promise&&(n.callingConvention=2),n.jres&&(n.whenUsed=!0),n.subcategories)try{n.subcategories=JSON.parse(n.subcategories)}catch(e){n.subcategories=void 0}if(n.groups)try{n.groups=JSON.parse(n.groups)}catch(e){n.groups=void 0}if(n.groupIcons)try{n.groupIcons=JSON.parse(n.groupIcons)}catch(e){n.groupIcons=void 0}if(n.groupHelp)try{n.groupHelp=JSON.parse(n.groupHelp)}catch(e){n.groupHelp=void 0}return a(n),n},e.parameterTypeIsArrowFunction=o,e.updateBlockDef=a,e.parseBlockDefinition=l,e.parseChecksumBlock=function(e,t=0){let n=pxt.HF2.read32(e,t);if(133083260!=(2147483647&n))return pxt.log("no checksum block magic"),null;let i=pxt.HF2.read32(e,t+4),r=pxt.HF2.read32(e,t+8);if(3&i)return pxt.log("invalid end marker position"),null;let s=1<<(255&r);if(s!=pxt.appTarget.compile.flashCodeAlign)return pxt.log("invalid page size: "+s),null;let o={magic:n,endMarkerPos:i,endMarker:r,regions:[]};for(let n=t+12;n<e.length-7;n+=8){let t={start:s*pxt.HF2.read16(e,n),length:s*pxt.HF2.read16(e,n+2),checksum:pxt.HF2.read32(e,n+4)};if(!t.length||!t.checksum)break;o.regions.push(t)}return o},function(t){function n(n){let i=e=>n[e]+(n[e+1]<<8)+(n[e+2]<<16)+(n[e+3]<<24)>>>0;if(!n||512!=n.length||i(0)!=t.UF2_MAGIC_START0||i(4)!=t.UF2_MAGIC_START1||i(n.length-4)!=t.UF2_MAGIC_END)return null;let r=i(8),s=i(16);s>476&&(s=256);let o=null,a=0,l=0;if(r&t.UF2_FLAG_FILE){let t=n.slice(32+s),r=t.indexOf(0);r>=0&&(t=t.slice(0,r)),o=e.U.fromUTF8Array(t),l=i(28)}return r&t.UF2_FLAG_FAMILY_ID_PRESENT&&(a=i(28)),{flags:r,targetAddr:i(12),payloadSize:s,blockNo:i(20),numBlocks:i(24),fileSize:l,familyId:a,data:n.slice(32,32+s),filename:o}}function i(e,t){return!!e&&(e.targetAddr<=t&&t<e.targetAddr+e.payloadSize)}function r(e,t,n){e[t]=255&n,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255}function s(e){return"string"==typeof e&&(e=parseInt(e)),{currBlock:null,currPtr:-1,blocks:[],ptrs:[],filesize:0,familyId:e||0}}function o(e){for(let t=0;t<e.blocks.length;++t)r(e.blocks[t],20,t),r(e.blocks[t],24,e.blocks.length),e.filename&&r(e.blocks[t],28,e.filesize)}function a(n,i,s,o=0){let l=n.currBlock,c=i>>8,u=256-(255&i);if(s.length>u){let e=new Uint8Array(s);for(a(n,i,e.slice(0,u));u<s.length;){let t=Math.min(u+256,s.length);a(n,i+u,e.slice(u,t)),u=t}return}if(c!=n.currPtr){l=null;for(let e=0;e<n.ptrs.length;++e)if(n.ptrs[e]==c){l=n.blocks[e];break}if(!l){l=new Uint8Array(512),n.filename?o|=t.UF2_FLAG_FILE:n.familyId&&(o|=t.UF2_FLAG_FAMILY_ID_PRESENT),r(l,0,t.UF2_MAGIC_START0),r(l,4,t.UF2_MAGIC_START1),r(l,8,o),r(l,12,c<<8),r(l,16,256),r(l,20,n.blocks.length),r(l,28,n.familyId),r(l,508,t.UF2_MAGIC_END);for(let e=32;e<288;++e)l[e]=255;n.filename&&e.U.memcpy(l,288,e.U.toUTF8Array(n.filename)),n.blocks.push(l),n.ptrs.push(c)}n.currPtr=c,n.currBlock=l}let d=32+(255&i);for(let e=0;e<s.length;++e)l[d+e]=s[e];n.filesize=Math.max(n.filesize,s.length+i)}t.UF2_MAGIC_START0=171066965,t.UF2_MAGIC_START1=2656915799,t.UF2_MAGIC_END=179400496,t.UF2_FLAG_NONE=0,t.UF2_FLAG_NOFLASH=1,t.UF2_FLAG_FILE=4096,t.UF2_FLAG_FAMILY_ID_PRESENT=8192,t.parseBlock=n,t.parseFile=function(e){let t=[];for(let i=0;i<e.length;i+=512){let r=n(e.slice(i,i+512));r&&t.push(r)}return t},t.toBin=function(e,t=void 0){if(e.length<512)return null;let i=-1,r=-1,s=[];for(let o=0;o<e.length;++o){let a=512*o,l=n(e.slice(a,a+512));if(!l)continue;if(t&&l.targetAddr+256>t)break;-1==i&&(i=l.targetAddr,r=i);let c=l.targetAddr-i;c<0||c%4||c>1048576||(c>0&&s.push(new Uint8Array(c)),s.push(e.slice(a+32,a+32+l.payloadSize)),i=l.targetAddr+l.payloadSize)}let o=0;for(let e of s)o+=e.length;if(0==o)return null;let a=new Uint8Array(o),l=0;for(let e of s)for(let t=0;t<e.length;++t)a[l++]=e[t];return{buf:a,start:r}},t.readBytes=function(e,t,n){let r,s=new Uint8Array(n);for(let o=0;o<n;++o,++t)i(r,t)||(r=e.filter(e=>i(e,t))[0]),r&&(s[o]=r.data[t-r.targetAddr]);return s},t.newBlockFile=s,t.finalizeFile=o,t.concatFiles=function(t){for(let e of t)o(e),e.filename=null;let n=s();n.blocks=e.U.concat(t.map(e=>e.blocks));for(let e of t)e.blocks=[];return n},t.serializeFile=function(t){o(t);let n="";for(let i of t.blocks)n+=e.Util.uint8ArrayToString(i);return n},t.readBytesFromFile=function t(n,i,r){let s,o=i>>8;if(o==n.currPtr)s=n.currBlock;else{for(let e=0;e<n.ptrs.length;++e)if(n.ptrs[e]==o){s=n.blocks[e];break}s&&(n.currPtr=o,n.currBlock=s)}if(!s)return null;let a=new Uint8Array(r),l=Math.min(r,256-(255&i));e.U.memcpy(a,0,s,32+(255&i),l);let c=r-l;if(c>0){let r=t(n,i+l,c);e.U.memcpy(a,l,r)}return a},t.writeBytes=a,t.writeHex=function(e,t){let n="0000";for(let i=0;i<t.length;++i){let r=/:02000004(....)/.exec(t[i]);if(r&&(n=r[1]),r=/^:..(....)00(.*)[0-9A-F][0-9A-F]$/.exec(t[i]),r){let t=parseInt(n+r[1],16),i=r[2],s=[];for(let e=0;e<i.length;e+=2)s.push(parseInt(i[e]+i[e+1],16));a(e,t,s)}}}}(u=e.UF2||(e.UF2={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(e){let t;!function(e){e[e.Bundled=1]="Bundled",e[e.Github=2]="Github",e[e.ShareScript=3]="ShareScript"}(t=e.ExtensionType||(e.ExtensionType={}))}(e.service||(e.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n,i,r;!function(e){e[e.IDE=0]="IDE",e[e.Sandbox=1]="Sandbox",e[e.Widget=2]="Widget",e[e.Controller=3]="Controller"}(n=t.EditorLayoutType||(t.EditorLayoutType={})),function(e){e[e.None=0]="None",e[e.Basic=1]="Basic",e[e.App=2]="App"}(i=t.ControllerMode||(t.ControllerMode={}));let s=i.None,o=!1,a=!1;function l(){if(void 0===r){if(e.BrowserUtils.hasWindow()){const t=/sandbox=1|#sandbox|#sandboxproject/i.test(window.location.href)||e.BrowserUtils.isIFrame(),l=/nosandbox=1/i.test(window.location.href),c=/controller=(0|1|2)/i.exec(window.location.href);c&&e.BrowserUtils.isIFrame()&&(s=parseInt(c[1]));const u=s!==i.None,d=/readonly=1/i.test(window.location.href),p=/editorlayout=(widget|sandbox|ide)/i.exec(window.location.href),h=/noproject=1/i.test(window.location.href);if(r=n.IDE,l?r=n.Widget:u?r=n.Controller:t&&(r=n.Sandbox),u&&d&&(o=!0),u&&h&&(a=!0),p)switch(p[1].toLowerCase()){case"widget":r=n.Widget;break;case"sandbox":r=n.Sandbox;break;case"ide":r=n.IDE}}else r=n.Sandbox;e.debug(`shell: layout type ${n[r]}, readonly ${d()}`)}}function c(){return l(),r==n.Sandbox}function u(){return/[?&]timeMachine=1/i.test(window.location.href)}function d(){return!e.BrowserUtils.hasWindow()||u()||c()&&!/[?&]edit=1/i.test(window.location.href)||p()&&o}function p(){return l(),r==n.Controller}t.layoutTypeClass=function(){return l(),e.shell.EditorLayoutType[r].toLowerCase()},t.isSandboxMode=c,t.isTimeMachineEmbed=u,t.isReadOnly=d,t.isNoProject=function(){return a},t.isControllerMode=p,t.getControllerMode=function(){return l(),s},t.isPyLangPref=function(){return"py"==e.storage.getLocal("editorlangpref")},t.getEditorLanguagePref=function(){return e.storage.getLocal("editorlangpref")},t.setEditorLanguagePref=function(t){t.match(/prj$/)&&(t=t.replace(/prj$/,"")),e.storage.setLocal("editorlangpref",t)},t.getToolboxAnimation=function(){return e.storage.getLocal("toolboxanimation")},t.setToolboxAnimation=function(){e.storage.setLocal("toolboxanimation","1")},t.hasHomeScreen=function(){return!e.shell.isControllerMode()&&!e.appTarget.appTheme.lockedEditor}}(e.shell||(e.shell={}))}(pxt||(pxt={})),function(e){!function(t){t.USER_VERSION="0.0.1";class n{constructor(){this.db=new e.BrowserUtils.IDBWrapper(n.databaseName,n.version,(e,t)=>{const i=t.result;e.oldVersion<1&&(i.createObjectStore(n.projectTable,{keyPath:n.projectKey}),i.createObjectStore(n.userTable,{keyPath:n.userKey}))})}initAsync(){return this.db.openAsync()}getAllProjectsAsync(){return this.db.getAllAsync(n.projectTable).then(e=>e.map(e=>e.project).filter(e=>!e.deleted))}deleteProjectAsync(e){return this.getProjectAsync(e).then(e=>{e.deleted=!0,this.saveProjectAsync(e)})}getProjectAsync(e){return this.db.getAsync(n.projectTable,e).then(e=>null==e?void 0:e.project)}saveProjectAsync(e){return this.db.setAsync(n.projectTable,{id:e.header.id,project:e})}getUserStateAsync(){return this.db.getAsync(n.userTable,"local-user").then(e=>null==e?void 0:e.user)}saveUserStateAsync(e){return this.db.setAsync(n.userTable,{id:"local-user",user:e})}}n.version=6,n.databaseName="local-skill-map",n.projectTable="projects",n.projectKey="id",n.userTable="users",n.userKey="id",t.IndexedDBWorkspace=n}(e.skillmap||(e.skillmap={}))}(pxt||(pxt={})),function(e){!function(e){e.MAX_FREQUENCY=5e3,e.MAX_VOLUME=255,e.renderSoundPath=function(i,r,s){let{startFrequency:o,endFrequency:a,startVolume:l,endVolume:c,wave:u,interpolation:d}=i;o=Math.max(Math.min(o,e.MAX_FREQUENCY),1),a=Math.max(Math.min(a,e.MAX_FREQUENCY),1),l=Math.max(Math.min(l,e.MAX_VOLUME),0),c=Math.max(Math.min(c,e.MAX_VOLUME),0);const p=new t(o+a+1);let h;switch(d){case"linear":h=e=>o+e*(a-o)/r;break;case"curve":h=e=>o+(a-o)*Math.sin(e/r*(Math.PI/2));break;case"logarithmic":h=e=>o+Math.log10(1+e/r*9)*(a-o)}"noise"===u&&(h=()=>p.randomRange(500,5e3));const f=t=>Math.max(Math.min((c-l)/r*t+l,e.MAX_VOLUME),0),m=r/2,g=t=>t/e.MAX_VOLUME*(s-2)/2,_=t=>(1-t/e.MAX_FREQUENCY)*(m-10)+10,y=["M 2 "+s/2];let b=0;for(;b<r;)y.push(n(g(f(b)),_(h(b))/2,u,!1,p)),b+=_(h(b))/2,y.push(n(g(f(b)),_(h(b))/2,u,!0,p)),b+=_(h(b))/2;return y.join(" ")},e.renderWaveSnapshot=function(i,r,s,o,a,l){const c=new t(i);"noise"===s&&(i=c.randomRange(500,5e3)),i=Math.max(Math.min(i,e.MAX_FREQUENCY),1);const u=r/e.MAX_VOLUME*(a-2)/2,d=o/(i*l/1e3)/2;let p=Math.ceil(o/(2*d));p%2==1&&p++;const h=[`M ${o/2-p*d} ${a/2}`];let f=0;for(let e=0;e<p;e++)h.push(n(u,d,s,!1,c)),f+=d,h.push(n(u,d,s,!0,c)),f+=d;return h.join(" ")};class t{constructor(e){this.seed=e,this.lfsr=e}next(){return(this.lfsr=this.lfsr>>1^46080&-(1&this.lfsr))/65535}randomRange(e,t){return e+(t-e)*this.next()}}function n(e,t,n,i,r){switch(n){case"triangle":return`l ${t/2} ${i?e:-e} l ${t/2} ${i?-e:e}`;case"square":return`v ${i?e:-e} h ${t} v ${i?-e:e}`;case"sawtooth":return i?`l ${t} ${e} v ${-e}`:`v ${-e} l ${t} ${e}`;case"sine":return`q ${t/2} ${1.9*(i?e:-e)} ${t} 0`;case"noise":const n=[],s=[],o=Math.min(4,t/4);let a=i;for(let n=0;n<t;n+=o)s.push(r.randomRange(0,e)*(a?1:-1)),a=!a;s[0]=i?e:-e,s[s.length-1]=0;let l=0,c=0;for(const e of s){let i=Math.min(o,t-c);if(n.push(`v ${e-l} h ${i}`),l=e,c+=i,c>=t)break}return n.join(" ")}}function i(e){switch(e){case"square":return 15;case"sine":return 3;case"triangle":return 1;case"noise":return 18;case"sawtooth":return 2}}function r(e,t,n){const i=new Uint8Array(2);new Uint16Array(i.buffer)[0]=0|n,e[t]=i[0],e[t+1]=i[1]}e.soundToInstructionBuffer=function(t,n,s){const{startFrequency:o,endFrequency:a,startVolume:l,endVolume:c,interpolation:u,duration:d}=t,p=[];if("linear"===t.interpolation&&"none"===t.effect)p.push({frequency:o,volume:l/e.MAX_VOLUME*1024}),p.push({frequency:a,volume:c/e.MAX_VOLUME*1024});else{n=Math.min(n,Math.floor(d/5));const i=t=>(l+t*(c-l)/d)/e.MAX_VOLUME*1024;let r;switch(u){case"linear":r=e=>o+e*(a-o)/d;break;case"curve":r=e=>o+(a-o)*Math.sin(e/d*(Math.PI/2));break;case"logarithmic":r=e=>o+Math.log10(1+e/d*9)*(a-o)}const h=d/n;for(let e=0;e<n;e++){const n={frequency:Math.max(r(e*h),1),volume:i(e*h)};"tremolo"===t.effect?n.volume=e%2==0?Math.max(n.volume-500*s,0):Math.min(n.volume+500*s,1023):"vibrato"===t.effect?n.frequency=e%2==0?Math.max(n.frequency-100*s,1):n.frequency+100*s:"warble"===t.effect&&(n.frequency=e%2==0?Math.max(n.frequency-1e3*s,1):n.frequency+1e3*s),p.push(n)}}const h=new Uint8Array(12*(p.length-1)),f=Math.floor(d/(p.length-1));for(let e=0;e<p.length-1;e++){const n=12*e;h[n]=i(t.wave),r(h,n+2,p[e].frequency),r(h,n+4,f),r(h,n+6,p[e].volume),r(h,n+8,p[e+1].volume),r(h,n+10,p[e+1].frequency)}return h}}(e.assets||(e.assets={}))}(pxt||(pxt={})),function(e){!function(t){t.createStreamAsync=function(t,n){return e.Cloud.privatePostAsync("streams",{target:t,name:n||"data"}).then(e=>e)},t.postPayloadAsync=function(t,n){return e.Util.assert(!!t.privatekey),e.Cloud.privatePostAsync(`${t.id}/data?privatekey=${t.privatekey}`,n)}}(e.streams||(e.streams={}))}(pxt||(pxt={})),function(e){!function(t){let n,i;!function(e){e[e.userSpaceOnUse=0]="userSpaceOnUse",e[e.objectBoundingBox=1]="objectBoundingBox"}(n=t.PatternUnits||(t.PatternUnits={})),function(e){e[e.em=0]="em",e[e.ex=1]="ex",e[e.px=2]="px",e[e.in=3]="in",e[e.cm=4]="cm",e[e.mm=5]="mm",e[e.pt=6]="pt",e[e.pc=7]="pc",e[e.percent=8]="percent"}(i=t.LengthUnit||(t.LengthUnit={}));class r{constructor(e){this.el=x(e)}attr(e){return Object.keys(e).forEach(t=>{this.setAttribute(t,e[t])}),this}setAttribute(e,t){return this.el.setAttribute(e,t.toString()),this}setAttributeNS(e,t,n){return this.el.setAttributeNS(e,t,n.toString()),this}id(e){return this.setAttribute("id",e)}setClass(...e){return this.setAttribute("class",e.join(" "))}appendClass(t){return e.BrowserUtils.addClass(this.el,t),this}removeClass(t){e.BrowserUtils.removeClass(this.el,t)}title(e){this.titleElement||(this.titleElement=x("title"),this.el.firstChild?this.el.insertBefore(this.titleElement,this.el.firstChild):this.el.appendChild(this.titleElement)),this.titleElement.textContent=e}setVisible(e){return this.setAttribute("visibility",e?"visible":"hidden")}}t.BaseElement=r;class s extends r{draw(e){const t=function(e){switch(e){case"text":return new d;case"circle":return new h;case"rect":return new p;case"line":return new f;case"polygon":return new _;case"polyline":return new g;case"path":return new y;default:return new u(e)}}(e);return this.el.appendChild(t.el),t}element(e,t){return t(this.draw(e)),this}group(){const e=new o;return this.el.appendChild(e.el),e}appendChild(e){this.el.appendChild(e.el)}onDown(e){return t.events.down(this.el,e),this}onUp(e){return t.events.up(this.el,e),this}onMove(e){return t.events.move(this.el,e),this}onEnter(e){return t.events.enter(this.el,e),this}onLeave(e){return t.events.leave(this.el,e),this}onClick(e){return t.events.click(this.el,e),this}}t.DrawContext=s;t.SVG=class extends s{constructor(e){super("svg"),e&&e.appendChild(this.el)}define(e){return this.defs||(this.defs=new l(this.el)),e(this.defs),this}};class o extends s{constructor(e){super("g"),e&&e.appendChild(this.el)}translate(e,t){return this.left=e,this.top=t,this.updateTransform()}scale(e){return this.scaleFactor=e,this.updateTransform()}def(){return new l(this.el)}style(){return new c(this.el)}updateTransform(){let e="";return null!=this.left&&(e+=`translate(${this.left} ${this.top})`),null!=this.scaleFactor&&(e+=` scale(${this.scaleFactor})`),this.setAttribute("transform",e),this}}t.Group=o;class a extends s{constructor(){super("pattern")}units(e){return this.setAttribute("patternUnits",e===n.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}contentUnits(e){return this.setAttribute("patternContentUnits",e===n.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}size(e,t){return this.setAttribute("width",e),this.setAttribute("height",t),this}}t.Pattern=a;class l extends r{constructor(e){super("defs"),e.appendChild(this.el)}create(e,t){let n;switch(e){case"path":n=new y;break;case"pattern":n=new a;break;case"radialGradient":n=new T;break;case"linearGradient":n=new v;break;case"clipPath":n=new k;break;default:n=new r(e)}return n.id(t),this.el.appendChild(n.el),n}}t.DefsElement=l;class c extends r{constructor(e){super("style"),e.appendChild(this.el)}content(e){this.el.textContent=e}}t.StyleElement=c;class u extends s{at(e,t){return this.setAttribute("x",e),this.setAttribute("y",t),this}moveTo(e,t){return this.at(e,t)}fill(e,t){return this.setAttribute("fill",e),null!=t&&this.opacity(t),this}opacity(e){return this.setAttribute("fill-opacity",e)}stroke(e,t){return this.setAttribute("stroke",e),null!=t&&this.strokeWidth(t),this}strokeWidth(e){return this.setAttribute("stroke-width",e)}strokeOpacity(e){return this.setAttribute("stroke-opacity",e)}clipPath(e){return this.setAttribute("clip-path",e)}}t.Drawable=u;class d extends u{constructor(e){super("text"),null!=e&&this.text(e)}text(e){return this.el.textContent=e,this}fontFamily(e){return this.setAttribute("font-family",e)}fontSize(e,t){return this.setAttribute("font-size",S(e,t))}offset(e,t,n){return 0!==e&&this.setAttribute("dx",S(e,n)),0!==t&&this.setAttribute("dy",S(t,n)),this}anchor(e){return this.setAttribute("text-anchor",e)}}t.Text=d;class p extends u{constructor(){super("rect")}width(e,t=i.px){return this.setAttribute("width",S(e,t))}height(e,t=i.px){return this.setAttribute("height",S(e,t))}corner(e){return this.corners(e,e)}corners(e,t){return this.setAttribute("rx",e),this.setAttribute("ry",t),this}size(e,t,n=i.px){return this.width(e,n),this.height(t,n),this}}t.Rect=p;class h extends u{constructor(){super("circle")}at(e,t){return this.setAttribute("cx",e),this.setAttribute("cy",t),this}radius(e){return this.setAttribute("r",e)}}t.Circle=h;class f extends u{constructor(){super("line")}at(e,t,n,i){return this.from(e,t),null!=n&&null!=i&&this.to(n,i),this}from(e,t){return this.setAttribute("x1",e),this.setAttribute("y1",t),this}to(e,t){return this.setAttribute("x2",e),this.setAttribute("y2",t),this}}t.Line=f;class m extends u{points(e){return this.setAttribute("points",e)}with(e){return this.points(e.map(({x:e,y:t})=>e+" "+t).join(","))}}t.PolyElement=m;class g extends m{constructor(){super("polyline")}}t.Polyline=g;class _ extends m{constructor(){super("polygon")}}t.Polygon=_;class y extends u{constructor(){super("path"),this.d=new E}update(){return this.setAttribute("d",this.d.toAttribute())}path(e){return e(this.d),this.update()}setD(e){return this.setAttribute("d",e),this}}t.Path=y;t.Image=class extends u{constructor(){super("image")}src(e){return this.setAttributeNS("http://www.w3.org/1999/xlink","href",e)}width(e,t=i.px){return this.setAttribute("width",S(e,t))}height(e,t=i.px){return this.setAttribute("height",S(e,t))}size(e,t,n=i.px){return this.width(e,n),this.height(t,n),this}};class b extends r{units(e){return this.setAttribute("gradientUnits",e===n.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}stop(e,t,n){const i=x("stop");return i.setAttribute("offset",e+"%"),null!=t&&i.setAttribute("stop-color",t),null!=n&&i.setAttribute("stop-opacity",n),this.el.appendChild(i),this}}t.Gradient=b;class v extends b{constructor(){super("linearGradient")}start(e,t){return this.setAttribute("x1",e),this.setAttribute("y1",t),this}end(e,t){return this.setAttribute("x2",e),this.setAttribute("y2",t),this}}t.LinearGradient=v;class T extends b{constructor(){super("radialGradient")}center(e,t){return this.setAttribute("cx",e),this.setAttribute("cy",t),this}focus(e,t,n){return this.setAttribute("fx",e),this.setAttribute("fy",t),this.setAttribute("fr",n),this}radius(e){return this.setAttribute("r",e)}}t.RadialGradient=T;class k extends s{constructor(){super("clipPath")}clipPathUnits(e){return e?this.setAttribute("clipPathUnits","objectBoundingBox"):this.setAttribute("clipPathUnits","userSpaceOnUse")}}function x(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}t.ClipPath=k;class E{constructor(){this.ops=[]}clear(){this.ops=[]}moveTo(e,t){return this.op("M",e,t)}moveBy(e,t){return this.op("m",e,t)}lineTo(e,t){return this.op("L",e,t)}lineBy(e,t){return this.op("l",e,t)}cCurveTo(e,t,n,i,r,s){return this.op("C",e,t,n,i,r,s)}cCurveBy(e,t,n,i,r,s){return this.op("c",e,t,n,i,r,s)}qCurveTo(e,t,n,i){return this.op("Q",e,t,n,i)}qCurveBy(e,t,n,i){return this.op("q",e,t,n,i)}sCurveTo(e,t,n,i){return this.op("S",e,t,n,i)}sCurveBy(e,t,n,i){return this.op("s",e,t,n,i)}tCurveTo(e,t){return this.op("T",e,t)}tCurveBy(e,t){return this.op("t",e,t)}arcTo(e,t,n,i,r,s,o){return this.op("A",e,t,n,i?1:0,r?1:0,s,o)}arcBy(e,t,n,i,r,s,o){return this.op("a",e,t,n,i?1:0,r?1:0,s,o)}close(){return this.op("z")}toAttribute(){return this.ops.map(e=>e.op+" "+e.args.join(" ")).join(" ")}op(e,...t){return this.ops.push({op:e,args:t}),this}}function S(e,t){switch(t){case i.em:return e+"em";case i.ex:return e+"ex";case i.px:return e+"px";case i.in:return e+"in";case i.cm:return e+"cm";case i.mm:return e+"mm";case i.pt:return e+"pt";case i.pc:return e+"pc";case i.percent:return e+"%";default:return e.toString()}}t.PathContext=E}(e.svgUtil||(e.svgUtil={}))}(pxt||(pxt={})),function(e){!function(e){!function(e){function t(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&navigator.maxTouchPoints>0)}function n(){return"undefined"!=typeof window&&!!window.PointerEvent}e.isTouchEnabled=t,e.hasPointerEvents=n,e.down=function(e,i){n()?e.addEventListener("pointerdown",i):t()?(e.addEventListener("mousedown",i),e.addEventListener("touchstart",i)):e.addEventListener("mousedown",i)},e.up=function(e,i){n()?e.addEventListener("pointerup",i):(t(),e.addEventListener("mouseup",i))},e.enter=function(e,i){n()?e.addEventListener("pointerover",e=>{i(!!(1&e.buttons))}):t()?e.addEventListener("touchstart",e=>{i(!0)}):e.addEventListener("mouseover",e=>{i(!!(1&e.buttons))})},e.leave=function(e,i){n()?e.addEventListener("pointerleave",i):t()?e.addEventListener("touchend",i):e.addEventListener("mouseleave",i)},e.move=function(e,i){n()?e.addEventListener("pointermove",i):t()?e.addEventListener("touchmove",i):e.addEventListener("mousemove",i)},e.click=function(e,t){e.addEventListener("click",t)}}(e.events||(e.events={}))}(e.svgUtil||(e.svgUtil={}))}(pxt||(pxt={})),function(e){!function(e){!function(t){class n extends e.Text{at(e,t){return this.cx=e,this.cy=t,this.rePosition(),this}text(e,t=12){return super.text(e),this.fontSizePixels=t,this.setAttribute("font-size",t+"px"),this.rePosition(),this}rePosition(){null!=this.cx&&null!=this.cy&&null!=this.fontSizePixels&&(this.setAttribute("x",this.cx),this.setAttribute("y",this.cy),this.setAttribute("text-anchor","middle"),this.setAttribute("alignment-baseline","middle"))}}t.CenteredText=n}(e.helpers||(e.helpers={}))}(e.svgUtil||(e.svgUtil={}))}(pxt||(pxt={})),function(e){!function(e){e.initExtensionsAsync=e=>Promise.resolve({}),e.initFieldExtensionsAsync=e=>Promise.resolve({})}(e.editor||(e.editor={}))}(pxt||(pxt={})),function(e){e.IMAGE_MIME_TYPE="image/x-mkcd-f4",e.TILEMAP_MIME_TYPE="application/mkcd-tilemap",e.ANIMATION_MIME_TYPE="application/mkcd-animation",e.SONG_MIME_TYPE="application/mkcd-song",e.JSON_MIME_TYPE="application/json";class t{constructor(e){this.type=e,this.assets=[],this.takenNames={},this.listeners=[]}add(e){if(this.takenNames[e.id])return this.update(e.id,e);{const t=a(e);return this.takenNames[t.id]=!0,this.takenNames[f(t)]=!0,t.meta.displayName&&t.meta.displayName!==t.id&&(this.takenNames[t.meta.displayName]&&(t.meta.displayName=this.generateNewDisplayName(t.meta.displayName)),this.takenNames[t.meta.displayName]=!0),this.assets.push(t),a(t)}}getSnapshot(e){return e?this.assets.filter(t=>e(t)).map(e=>a(e)):this.assets.map(e=>a(e))}update(t,n){let i;if(this.takenNames[t]){const r=this.lookupByID(t);if(p(r,n))i=n;else{if(!m(n)&&m(r))return e.warn("Refusing to overwrite asset with invalid version"),e.tickEvent("assets.invalidAssetOverwrite",{assetType:n.type}),r;this.removeByID(t),i=this.add(n),this.notifyListener(n.internalID)}}else i=this.add(n);return i}removeByID(e){const t=this.lookupByID(e);this.assets=this.assets.filter(t=>t.id!==e),delete this.takenNames[e],t&&delete this.takenNames[f(t)],(null==t?void 0:t.meta.displayName)&&delete this.takenNames[null==t?void 0:t.meta.displayName]}getByID(e){const t=this.lookupByID(e);return t&&a(t)}getByDisplayName(e){if(this.takenNames[e])for(const t of this.assets)if(t.meta.displayName===e||f(t)===e)return a(t)}getByValue(e){for(const t of this.assets)if(p(e,t,!0))return t}isIDTaken(e){return!!this.takenNames[e]}clone(){const e=new t(this.type);return e.assets=this.getSnapshot(),e.takenNames=Object.assign({},this.takenNames),e}serializeToJRes(e={},t){for(const n of this.assets)t&&!t(n)||d(n,e);return e}addListener(e,t){this.listeners.push({internalID:e,callback:t})}removeListener(e){this.listeners=this.listeners.filter(t=>t.callback!==e)}diff(e){let t={before:[],after:[]},n={};for(const i of e.assets){n[i.internalID]=!0;const e=this.lookupByInternalID(i.internalID);e&&p(i,e)||(t.before.push(i),t.after.push(e))}for(const e of this.assets.filter(e=>!n[e.internalID]))t.before.push(null),t.after.push(e);return t}applyDiff(t,n=!1){const i=n?t.after:t.before,r=n?t.before:t.after;e.Util.assert(i.length===r.length);for(let e=0;e<i.length;e++)i[e]?(this.removeByInternalID(i[e].internalID),r[e]&&this.assets.push(r[e]),this.notifyListener(i[e].internalID)):(this.assets.push(r[e]),this.notifyListener(r[e].internalID));this.takenNames={};for(const t of this.assets)e.Util.assert(!this.takenNames[t.id]),this.takenNames[t.id]=!0,this.takenNames[f(t)]=!0,t.meta.displayName&&(t.meta.displayName!==t.id&&e.Util.assert(!this.takenNames[t.meta.displayName]),this.takenNames[t.meta.displayName]=!0)}lookupByID(e){for(const t of this.assets)if(t.id===e)return t;return null}lookupByInternalID(e){for(const t of this.assets)if(t.internalID===e)return t;return null}removeByInternalID(e){this.assets=this.assets.filter(t=>t.internalID!==e)}notifyListener(e){for(const t of this.listeners)t.internalID===e&&t.callback()}generateNewDisplayName(e){e=e.replace(/\d+$/,"");let t=0;for(;this.takenNames[e+t];)++t;return e+t}}class n{constructor(){this.needsRebuild=!0,this.nextID=0,this.nextInternalID=0,this.committedState={revision:n.nextRevision++,assets:{image:new t("image"),tile:new t("tile"),tilemap:new t("tilemap"),animation:new t("animation"),song:new t("song"),json:new t("json")}},this.state={revision:n.nextRevision++,assets:{image:new t("image"),tile:new t("tile"),tilemap:new t("tilemap"),animation:new t("animation"),song:new t("song"),json:new t("json")}},this.gallery={revision:0,assets:{image:new t("image"),tile:new t("tile"),tilemap:new t("tilemap"),animation:new t("animation"),song:new t("song"),json:new t("json")}},this.undoStack=[],this.redoStack=[]}getNewInternalId(){return this.nextInternalID++}createNewImage(t=16,n=16){this.onChange();const i=this.generateNewID("image"),r=new e.sprite.Bitmap(t,n).data(),s={internalID:this.getNewInternalId(),id:i,type:"image",bitmap:r,meta:{},jresData:e.sprite.base64EncodeBitmap(r)};return this.getAssetCollection("image").add(s)}createNewAnimation(t=16,n=16){this.onChange();const i=this.generateNewID("animation"),r=new e.sprite.Bitmap(t,n).data(),s={internalID:this.getNewInternalId(),id:i,type:"animation",frames:[r],interval:500,meta:{}};return this.getAssetCollection("animation").add(s)}createNewAnimationFromData(e,t=500,n){this.onChange();const i=this.generateNewID("animation"),r={internalID:this.getNewInternalId(),id:i,type:"animation",frames:e,interval:t,meta:{displayName:n}};return this.getAssetCollection("animation").add(r)}getGalleryTiles(e){return this.extensionTileSets?this.extensionTileSets.map(t=>t.tileSets.find(t=>t.tileWidth===e)).filter(e=>null==e?void 0:e.tiles.length):null}getProjectImages(){return this.getAssetCollection("image").getSnapshot()}getProjectTiles(t,n){const i=this.getAssetCollection("tile").getSnapshot(e=>e.bitmap.width===t);return 0===i.length?n?(this.createNewTile(new e.sprite.Bitmap(t,t).data()),this.getProjectTiles(t,!1)):null:{tileWidth:t,tiles:i}}createNewTile(t,n,i){this.onChange(),n&&!this.isNameTaken("tile",n)||(n=this.generateNewID("tile"));const r={internalID:this.getNewInternalId(),id:n,type:"tile",jresData:e.sprite.base64EncodeBitmap(t),bitmap:t,meta:{displayName:i},isProjectTile:!0};return this.getAssetCollection("tile").add(r)}createNewProjectImage(t,n){this.onChange();const i={internalID:this.getNewInternalId(),id:this.generateNewID("image"),type:"image",jresData:e.sprite.base64EncodeBitmap(t),meta:{displayName:n},bitmap:t};return this.getAssetCollection("image").add(i)}createNewSong(t,n){this.onChange();const i={internalID:this.getNewInternalId(),id:this.generateNewID("song"),type:"song",song:e.assets.music.cloneSong(t),meta:{displayName:n}};return this.getAssetCollection("song").add(i)}createNewJsonAsset(e,t,n){this.onChange();const i={internalID:this.getNewInternalId(),id:this.generateNewID("json"),type:"json",data:e,fileName:t,meta:{displayName:n}};return this.getAssetCollection("json").add(i)}updateTile(t){this.onChange();const n=this.resolveProjectTileByInternalID(t.internalID);if(n){if(this.getAssetCollection("tile").update(n.id,t),n.id!==t.id||!e.sprite.bitmapEquals(n.bitmap,t.bitmap))for(const e of this.getAssets("tilemap"))e.data.tileset.tiles.some(e=>e.internalID===t.internalID)&&(e.data.tileset.tiles=e.data.tileset.tiles.map(e=>e.internalID===t.internalID?t:e),this.updateTilemap(e.id,e.data));return t}return null}deleteTile(e){this.onChange(),this.getAssetCollection("tile").removeByID(e)}getProjectTilesetJRes(t){const n={};return this.getAssetCollection("tile").serializeToJRes(n),this.getAssetCollection("tilemap").serializeToJRes(n,n=>!t||!e.sprite.isTilemapEmptyOrUnused(n,this,t)),n["*"]={mimeType:"image/x-mkcd-f4",dataEncoding:"base64",namespace:e.sprite.TILE_NAMESPACE},n}getProjectAssetsJRes(){const t={};for(const e of Object.keys(this.state.assets))"tilemap"!==e&&"tile"!==e&&this.state.assets[e].serializeToJRes(t);return t["*"]={mimeType:"image/x-mkcd-f4",dataEncoding:"base64",namespace:e.sprite.IMAGES_NAMESPACE},t}getTilemap(e){return this.getAssetCollection("tilemap").getByID(e)}updateTilemap(e,t){const n=this.getAssetCollection("tilemap").getByID(e);if(n){this.onChange();const i=Object.assign(Object.assign({},n),{data:t});return this.getAssetCollection("tilemap").update(e,i),i}return null}createNewTilemap(e,t,n=16,i=16){return this.createNewTilemapFromData(this.blankTilemap(t,n,i),e)}blankTilemap(t,n=16,i=16){const r=new e.sprite.Tilemap(n,i),s=new e.sprite.Bitmap(n,i),o={tileWidth:t,tiles:[this.getTransparency(t)]};return new e.sprite.TilemapData(r,o,s.data())}resolveTile(e){return this.lookupAsset("tile",e)}resolveProjectTileByInternalID(e){return this.getAssetCollection("tile").getSnapshot(t=>t.internalID===e)[0]}resolveTileByBitmap(t){const n=e.sprite.base64EncodeBitmap(t);return this.getAssetCollection("tile").getSnapshot(e=>e.jresData===n)[0]}getTransparency(t){const n=e.sprite.TILE_NAMESPACE+".transparency"+t;let i=this.getAssetCollection("tile").getByID(n);if(!i){const r=new e.sprite.Bitmap(t,t).data();return i={internalID:this.getNewInternalId(),id:n,type:"tile",bitmap:r,jresData:e.sprite.base64EncodeBitmap(r),meta:{},isProjectTile:!0},this.getAssetCollection("tile").add(i)}return i}createNewTilemapFromData(e,t){this.onChange();const n=this.generateNewIDInternal("tilemap",t||lf("level"));return this.getAssetCollection("tilemap").add({internalID:this.getNewInternalId(),id:n,type:"tilemap",meta:{displayName:t||n},data:e}),[n,e]}cloneState(){const e={revision:this.state.revision,assets:{}};for(const t of Object.keys(this.state.assets))e.assets[t]=this.state.assets[t].clone();return e}undo(){if(this.state.revision!==this.committedState.revision&&this.pushUndo(),this.undoStack.length){const e=this.undoStack.pop();for(const t of Object.keys(e.assetDiffs))this.getAssetCollection(t).applyDiff(e.assetDiffs[t],!0);this.state.revision=e.beforeRevision,this.redoStack.push(e),this.committedState=this.cloneState(),this.needsRebuild=!0}}redo(){if(this.redoStack.length){const e=this.redoStack.pop();for(const t of Object.keys(e.assetDiffs))this.getAssetCollection(t).applyDiff(e.assetDiffs[t]);this.state.revision=e.afterRevision,this.undoStack.push(e),this.committedState=this.cloneState(),this.needsRebuild=!0}}pushUndo(){if(this.undoStack.length&&this.committedState.revision===this.state.revision)return;this.redoStack=[],this.undoStack.push({beforeRevision:this.committedState.revision,afterRevision:this.state.revision,assetDiffs:{}});const e=this.undoStack[this.undoStack.length-1];for(const t of Object.keys(this.state.assets))e.assetDiffs[t]=this.state.assets[t].diff(this.committedState.assets[t]);this.committedState=this.cloneState(),this.cleanupTemporaryAssets()}revision(){return this.state.revision}encodeTilemap(t,n){const i=t.tilemap.data(),r=new Uint8ClampedArray(5+i.data.length+t.layers.data.length);return r[0]=t.tileset.tileWidth,r[1]=255&i.width,r[2]=i.width>>8&255,r[3]=255&i.height,r[4]=i.height>>8&255,r.set(i.data,5),r.set(t.layers.data,5+i.data.length),{id:n,mimeType:e.TILEMAP_MIME_TYPE,data:btoa(e.sprite.uint8ArrayToHex(r)),tileset:t.tileset.tiles.map(e=>e.id)}}forceUpdate(){this.onChange()}isNameTaken(e,t){const n=t=>this.getAssetCollection(e).isIDTaken(t)||this.getAssetCollection(e,!0).isIDTaken(t),i=_(e,t),r=i&&i!==t;return n(t)||r&&n(i)}isAssetUsed(t,n,i){var r,s,o;if(((null===(s=null===(r=t.meta)||void 0===r?void 0:r.blockIDs)||void 0===s?void 0:s.filter(e=>!i||(null==i?void 0:i.indexOf(e))<0))||[]).length>0)return!0;if("tile"==t.type)for(const e of this.getAssets("tilemap"))if(!((null==i?void 0:i.indexOf(e.id))>=0)&&e.data.tileset.tiles.some(e=>e.id===t.id))return!0;if(n){const r=e.Util.escapeForRegex(f(t)),s=e.Util.escapeForRegex(null===(o=t.meta)||void 0===o?void 0:o.displayName)||"";let a;switch(t.type){case"tile":a=`myTiles.${r}|assets.tile\`${r}\``,s&&(a+=`|assets.tile\`${s}\``);break;case"tilemap":a=`tilemap\`${r}\``;break;case"animation":a=`assets.animation\`${r}\``,s&&(a+=`|assets.animation\`${s}\``);break;case"song":a=`assets.song\`${r}\``,s&&(a+=`|assets.song\`${s}\``);break;case"json":a=`assets.json\`${r}\``,s&&(a+=`|assets.json\`${s}\``);break;default:a=`assets.image\`${r}\``,s&&(a+=`|assets.image\`${s}\``)}const l=new RegExp(a,"gm");let c;switch(t.type){case"tile":c=`myTiles.${r}|assets.tile("""${r}""")`,s&&(c+=`|assets.tile("""${s}""")`);break;case"tilemap":c=`assets.tilemap("""${r}""")`;break;case"animation":c=`assets.animation("""${r}""")`,s&&(c+=`|assets.animation("""${s}""")`);break;case"song":c=`assets.song("""${r}""")`,s&&(c+=`|assets.song("""${s}""")`);break;case"json":c=`assets.json("""${r}""")`,s&&(c+=`|assets.json("""${s}""")`);break;default:c=`assets.image("""${r}""")`,s&&(c+=`|assets.image("""${s}""")`)}const u=new RegExp(c,"gm");for(let e of Object.keys(n)){if((null==i?void 0:i.indexOf(e))>=0)continue;const t=n[e];if(e.match(/((?!\.g).{2}|^.{0,1})\.ts$/i)){if(t.content.match(l))return!0}else if(e.endsWith(".py")&&t.content.match(u))return!0}}return!1}lookupAsset(e,t){return this.getAssetCollection(e).getByID(t)||this.getAssetCollection(e,!0).getByID(t)}lookupAssetByName(e,t){return this.getAssetCollection(e).getByDisplayName(t)}lookupAssetByValue(e,t){return this.getAssetCollection(e).getByValue(t)}getAssets(e){return this.getAssetCollection(e).getSnapshot()}getGalleryAssets(e){return this.getAssetCollection(e,!0).getSnapshot()}lookupBlockAsset(e,t){return this.getAssetCollection(e).getSnapshot(e=>{var n,i;return-1!==(null===(i=null===(n=e.meta)||void 0===n?void 0:n.blockIDs)||void 0===i?void 0:i.indexOf(t))})[0]}updateAsset(e){return this.onChange(),"tile"===e.type?this.updateTile(e):this.getAssetCollection(e.type).update(e.id,e)}duplicateAsset(e,t){var n;this.onChange();const i=a(e),r=t||(null===(n=i.meta)||void 0===n?void 0:n.displayName);let s;switch(e.type){case"image":s=this.createNewProjectImage(i.bitmap,r);break;case"tile":s=this.createNewTile(i.bitmap,null,r);break;case"tilemap":const[t,n]=this.createNewTilemapFromData(i.data,r);s=this.getTilemap(t);break;case"animation":s=this.createNewAnimationFromData(i.frames,i.interval,r);break;case"song":s=this.createNewSong(i.song,r);break;case"json":s=this.createNewJsonAsset(i.data,e.fileName,r)}return s}removeAsset(e){this.onChange(),this.getAssetCollection(e.type).removeByID(e.id)}addChangeListener(e,t){this.getAssetCollection(e.type).addListener(e.internalID,t)}removeChangeListener(e,t){this.getAssetCollection(e).removeListener(t)}loadPackage(t){const n=t.sortedDeps();this.extensionTileSets=[];for(const t of n){const n="this"===t.id,i=this.readImages(t.parseJRes(),n);for(const r of i)if(r.meta.package=t.id,"tile"===r.type)this.getAssetCollection("tile",!n).add(r);else if("image"===r.type)this.getAssetCollection("image",!n).add(r);else if("animation"===r.type)this.getAssetCollection("animation",!n).add(r);else if("json"===r.type)this.getAssetCollection("json",!n).add(r);else if(n){const t=e.sprite.IMAGES_NAMESPACE+".";r.id.startsWith(t)&&(r.id=r.id.replace(t,e.sprite.SONG_NAMESPACE+".")),this.getAssetCollection("song").add(r)}else this.getAssetCollection("song",!0).add(r)}for(const e of n){const n="this"===e.id;for(const r of i(e.parseJRes()))n?this.getAssetCollection("tilemap").add({internalID:this.getNewInternalId(),type:"tilemap",id:r.id,meta:{displayName:r.displayName||r.id,package:t.id},data:o(r,e=>this.resolveTile(e))}):this.getAssetCollection("tilemap",!0).add({internalID:this.getNewInternalId(),type:"tilemap",id:r.id,meta:{displayName:r.displayName||r.id,package:t.id},data:o(r,e=>this.getAssetCollection("tile",!0).getByID(e))})}this.committedState=this.cloneState(),this.undoStack=[],this.redoStack=[]}loadTilemapJRes(t,n=!1,r=!1){t=e.inflateJRes(t);const s=this.readImages(t,!r).filter(e=>"tile"===e.type);let a={};if(r)for(const e of s)this.getAssetCollection("tile",!0).add(e);else for(const e of s){if(n){const t=this.resolveTileByBitmap(e.bitmap);if(t){a[e.id]=t.id;continue}}const t=this.createNewTile(e.bitmap,e.id,e.meta.displayName);t.id!==e.id&&(a[e.id]=t.id)}for(const e of i(t))this.getAssetCollection("tilemap",r).add({internalID:this.getNewInternalId(),type:"tilemap",id:e.id,meta:{displayName:e.displayName||e.id},data:o(e,e=>(a[e]&&(e=a[e]),this.resolveTile(e)))})}loadAssetsJRes(t,n=!1){t=e.inflateJRes(t);const i=[];for(const r of Object.keys(t)){const s=t[r];if(s.tilemapTile)this.getAssetCollection("tile",n).add(this.generateImage(s,"tile"));else if(s.mimeType===e.IMAGE_MIME_TYPE)this.getAssetCollection("image",n).add(this.generateImage(s,"image"));else if(s.mimeType===e.ANIMATION_MIME_TYPE){const[e,t]=this.generateAnimation(s);t?i.push(e):this.getAssetCollection("animation",n).add(e)}else s.mimeType===e.SONG_MIME_TYPE?this.getAssetCollection("song",n).add(this.generateSong(s)):s.mimeType===e.JSON_MIME_TYPE&&this.getAssetCollection("json",n).add(this.generateJsonAsset(s))}for(const e of i)this.getAssetCollection("animation",n).add(this.inflateAnimation(e,this.getAssetCollection("image",n).getSnapshot()))}removeInactiveBlockAssets(e){for(const e of Object.keys(this.state.assets))t(this.state.assets[e]);function t(t){const n=t.getSnapshot(t=>{var n;return!t.meta.displayName&&(null===(n=t.meta.blockIDs)||void 0===n?void 0:n.some(t=>-1===e.indexOf(t)))}),i=[];for(const t of n)1===t.meta.blockIDs.length?i.push(t):(t.meta.blockIDs=t.meta.blockIDs.filter(t=>-1!==e.indexOf(t)),0===t.meta.blockIDs.length&&i.push(t));for(const e of i)t.removeByID(e.id)}}clone(){var e;const t=new n;return t.committedState=l(this.committedState),t.state=l(this.state),t.gallery=l(this.gallery),t.extensionTileSets=null===(e=this.extensionTileSets)||void 0===e?void 0:e.map(e=>Object.assign(Object.assign({},e),{tileSets:e.tileSets.map(e=>Object.assign(Object.assign({},e),{tiles:e.tiles.map(e=>a(e))}))})),t.needsRebuild=this.needsRebuild,t.nextID=this.nextID,t.nextInternalID=this.nextInternalID,t.undoStack=this.undoStack.map(e=>c(e)),t.redoStack=this.undoStack.map(e=>c(e)),t}saveGallerySnapshot(){return this.gallery}loadGallerySnapshot(e){this.gallery=e}generateImage(t,n){return{internalID:this.getNewInternalId(),type:n,id:t.id,meta:{displayName:t.displayName,tags:t.tags},jresData:t.data,bitmap:e.sprite.getBitmapFromJResURL(`data:${e.IMAGE_MIME_TYPE};base64,${t.data}`).data()}}generateSong(t){return{internalID:this.getNewInternalId(),type:"song",id:t.id,meta:{displayName:t.displayName,tags:t.tags},song:e.assets.music.decodeSongFromHex(t.data)}}generateJsonAsset(e){const t=JSON.parse(e.data);return{internalID:this.getNewInternalId(),type:"json",id:e.id,meta:{displayName:e.displayName,tags:e.tags},data:t.data,fileName:t.fileName}}generateAnimation(t){if("json"===t.dataEncoding){let n;try{n=JSON.parse(t.data)}catch(n){e.warn("could not parse json data of '"+t.id+"'")}return[{internalID:this.getNewInternalId(),type:"animation",meta:{displayName:t.displayName,tags:t.tags},id:t.id,frames:[],frameIds:n.frames,interval:100,flippedHorizontal:n.flippedHorizontal},!0]}return[Object.assign(Object.assign({},y(t)),{internalID:this.getNewInternalId()}),!1]}inflateAnimation(t,n){return t.frames=t.frameIds.map(e=>n.find(t=>t.id===e).bitmap),t.flippedHorizontal&&(t.frames=t.frames.map(t=>{const n=e.sprite.Bitmap.fromData(t),i=new e.sprite.Bitmap(t.width,t.height);for(let e=0;e<i.width;e++)for(let t=0;t<i.height;t++)i.set(e,t,n.get(n.width-e-1,t));return i.data()})),t}generateNewID(t){switch(t){case"animation":return this.generateNewIDInternal("animation",e.sprite.ANIMATION_PREFIX,e.sprite.ANIMATION_NAMESPACE);case"image":return this.generateNewIDInternal("image",e.sprite.IMAGE_PREFIX,e.sprite.IMAGES_NAMESPACE);case"tile":return this.generateNewIDInternal("tile",e.sprite.TILE_PREFIX,e.sprite.TILE_NAMESPACE);case"tilemap":return this.generateNewIDInternal("tilemap",lf("level"));case"song":return this.generateNewIDInternal("song",e.sprite.SONG_PREFIX,e.sprite.SONG_NAMESPACE);case"json":return this.generateNewIDInternal("json",e.sprite.JSON_PREFIX,e.sprite.JSON_NAMESPACE)}}generateNewIDInternal(e,t,n){t=t.replace(/\d+$/,"");const i=n?n+"."+t:t;let r=1;for(;this.isNameTaken(e,i+r);)++r;return i+r}onChange(){this.needsRebuild=!0,this.state.revision=n.nextRevision++}readImages(t,n=!1){const i=[],r=[];for(const s of Object.keys(t)){const o=t[s];if(o.tilemapTile){const e=this.generateImage(o,"tile");e.isProjectTile=n,i.push(e)}else if(o.mimeType===e.IMAGE_MIME_TYPE)i.push(this.generateImage(o,"image"));else if(o.mimeType===e.ANIMATION_MIME_TYPE){const[e,t]=this.generateAnimation(o);t?r.push(e):i.push(e)}else o.mimeType===e.SONG_MIME_TYPE?i.push(this.generateSong(o)):o.mimeType===e.JSON_MIME_TYPE&&i.push(this.generateJsonAsset(o))}for(const e of r)i.push(this.inflateAnimation(e,i));return i}cleanupTemporaryAssets(){const e=this.getAssetCollection("image"),t=e.getSnapshot(e=>{var t;return!e.meta.displayName&&!(null===(t=e.meta.blockIDs)||void 0===t?void 0:t.length)});for(const n of t)e.removeByID(n.id)}getAssetCollection(e,t=!1){return v(t?this.gallery:this.state,e,!0)}}function i(t){const n=[];for(const i of Object.keys(t)){const r=t[i];r.mimeType===e.TILEMAP_MIME_TYPE&&n.push(r)}return n}function r(e,t){const n="    ";return`\n${n}helpers._registerFactory("${e}", function(name: string) {\n${n}${n}switch(helpers.stringTrim(name)) {\n`+t.map(e=>e.keys.filter(e=>!!e).map(e=>`${n}${n}${n}case "${e}":`).join("\n")+`return ${e.expression};`).join("\n")+"\n"+`${n}${n}}\n`+`${n}${n}return null;\n`+`${n}})\n`}function s(t){return e.sprite.Bitmap.fromData(t).copy().data()}function o(t,n){var i;const r=atob(t.data),s=e.U.fromHex(r),o=s[1]|s[2]<<8,a=s[3]|s[4]<<8,l=t.tileset.map(e=>n&&n(e)||{id:e});let c=s[0];c||(c=l.length&&(null===(i=l.find(e=>{var t;return null===(t=e.bitmap)||void 0===t?void 0:t.width}))||void 0===i?void 0:i.bitmap.width)),c=c||16;const u={tileWidth:c,tiles:l},d=s.slice(5,5+o*a),p=new e.sprite.Tilemap(o,a,0,0,new Uint8ClampedArray(d)),h=s.slice(5+d.length),f=new e.sprite.Bitmap(o,a,0,0,new Uint8ClampedArray(h)).data();return new e.sprite.TilemapData(p,u,f)}function a(t,n=!1){switch(t.meta=Object.assign({},t.meta),t.meta.temporaryInfo&&(t.meta.temporaryInfo=Object.assign({},t.meta.temporaryInfo)),t.type){case"tile":case"image":return Object.assign(Object.assign({},t),{bitmap:s(t.bitmap)});case"animation":return Object.assign(Object.assign({},t),{frames:t.frames.map(e=>s(e))});case"tilemap":return Object.assign(Object.assign({},t),{data:t.data.cloneData(n)});case"song":return Object.assign(Object.assign({},t),{song:e.assets.music.cloneSong(t.song)});case"json":return Object.assign(Object.assign({},t),{data:e.U.clone(t.data)})}}function l(e){const t={revision:e.revision,assets:{}};for(const n of Object.keys(e.assets)){const i=e.assets[n];t.assets[n]=i.clone()}return t}function c(e){const t=Object.assign(Object.assign({},e),{assetDiffs:{}});for(const n of Object.keys(e.assetDiffs)){const i=e.assetDiffs[n];t.assetDiffs[n]=u(i)}return t}function u(e){return Object.assign(Object.assign({},e),{before:e.before.map(e=>a(e)),after:e.after.map(e=>a(e))})}function d(t,n){const i=t.id.substr(t.id.lastIndexOf(".")+1),r=t.meta.tags;switch(t.type){case"image":if(n[i]=t.jresData,t.meta.displayName||(null==r?void 0:r.length)){const s={data:t.jresData,mimeType:e.IMAGE_MIME_TYPE};t.meta.displayName&&(s.displayName=t.meta.displayName),(null==r?void 0:r.length)&&(s.tags=r),n[i]=s}break;case"tile":const s={data:t.jresData,mimeType:e.IMAGE_MIME_TYPE,tilemapTile:!0,displayName:t.meta.displayName};(null==r?void 0:r.length)&&(s.tags=r),n[i]=s;break;case"tilemap":const o=function(t,n,i){const r=t.tilemap.data(),s=new Uint8ClampedArray(5+r.data.length+t.layers.data.length);return s[0]=t.tileset.tileWidth,s[1]=255&r.width,s[2]=r.width>>8&255,s[3]=255&r.height,s[4]=r.height>>8&255,s.set(r.data,5),s.set(t.layers.data,5+r.data.length),{id:n,mimeType:e.TILEMAP_MIME_TYPE,data:btoa(e.sprite.uint8ArrayToHex(s)),tileset:t.tileset.tiles.map(e=>e.id),displayName:i}}(t.data,t.id,t.meta.displayName);n[o.id]=o;break;case"animation":n[i]=function(t){var n;const i={namespace:t.id.substr(0,t.id.lastIndexOf(".")),id:t.id.substr(t.id.lastIndexOf(".")+1),mimeType:e.ANIMATION_MIME_TYPE,data:e.sprite.encodeAnimationString(t.frames,t.interval),displayName:t.meta.displayName};(null===(n=t.meta.tags)||void 0===n?void 0:n.length)&&(i.tags=t.meta.tags);return i}(t);break;case"song":const a={data:e.assets.music.encodeSongToHex(t.song),mimeType:e.SONG_MIME_TYPE,displayName:t.meta.displayName,namespace:e.sprite.SONG_NAMESPACE+"."};(null==r?void 0:r.length)&&(a.tags=r),n[i]=a;break;case"json":const l={data:JSON.stringify({data:t.data,fileName:t.fileName}),mimeType:e.JSON_MIME_TYPE,displayName:t.meta.displayName,namespace:e.sprite.JSON_NAMESPACE+"."};(null==r?void 0:r.length)&&(l.tags=r),n[i]=l}}function p(t,n,i=!1){if(t==n)return!0;if(!t&&n||!n&&t||t.type!==n.type)return!1;if(!(i||t.id===n.id&&e.U.arrayEquals(t.meta.tags,n.meta.tags)&&e.U.arrayEquals(t.meta.blockIDs,n.meta.blockIDs)&&t.meta.displayName===n.meta.displayName))return!1;switch(t.type){case"image":case"tile":return e.sprite.bitmapEquals(t.bitmap,n.bitmap);case"animation":const i=n;return t.interval===i.interval&&e.U.arrayEquals(t.frames,i.frames,e.sprite.bitmapEquals);case"tilemap":return t.data.equals(n.data);case"song":return e.assets.music.songEquals(t.song,n.song);case"json":return t.fileName===n.fileName&&e.U.deepEqual(t.data,n.data)}}function h(e){const t=/^\s*(?:(?:assets\s*\.\s*(image|tile|animation|tilemap|song))|(tilemap))\s*(?:`|\(""")([^`"]+)(?:`|"""\))\s*$/m.exec(e);if(t){return{type:t[1]||t[2],name:t[3].trim()}}}function f(e){return _(e.type,e.id)}function m(t){if(!t)return!1;switch(t.type){case"image":case"tile":return function(t){return!!t.bitmap&&g(e.sprite.Bitmap.fromData(t.bitmap))}(t);case"tilemap":return function(t){var n;if(!(t.data&&t.data.tilemap&&t.data.tileset&&t.data.tileset.tileWidth&&(null===(n=t.data.tileset.tiles)||void 0===n?void 0:n.length)&&t.data.layers))return!1;return g(e.sprite.Bitmap.fromData(t.data.layers))&&g(t.data.tilemap)}(t);case"animation":return function(t){var n;if(!(null===(n=t.frames)||void 0===n?void 0:n.length)||t.interval<=0)return!1;return!t.frames.some(t=>!g(e.sprite.Bitmap.fromData(t)))}(t);case"song":return(n=t).song&&n.song.ticksPerBeat>0&&n.song.beatsPerMeasure>0&&n.song.measures>0&&n.song.beatsPerMinute>0&&!!n.song.tracks;case"json":return!!t.data}var n}function g(e){return e.width>0&&e.height>0&&!Number.isNaN(e.x0)&&!Number.isNaN(e.y0)&&e.data().data.length===e.dataLength()}function _(t,n,i=!1){let r;switch(t){case"image":r=e.sprite.IMAGES_NAMESPACE+".";break;case"tile":r=e.sprite.TILE_NAMESPACE+".";break;case"tilemap":r="";break;case"animation":r=e.sprite.ANIMATION_NAMESPACE+".";break;case"song":r=e.sprite.SONG_NAMESPACE+".";break;case"json":r=e.sprite.JSON_NAMESPACE+"."}if(r)if(n.startsWith(r)){const e=n.substr(r.length);if(-1===e.indexOf("."))return e}else if(!i)return null;return n}function y(t){const n=atob(t.data),i=new Uint8ClampedArray(e.U.fromHex(n)),r=b(i,0),s=b(i,2),o=b(i,4),a=b(i,6),l=Math.ceil(s*o/2);let c=8;const u=[];for(let e=0;e<a;e++){const e=i.slice(c,c+l);u.push({x0:0,y0:0,width:s,height:o,data:e}),c+=l}let d=t.id;return d.startsWith(t.namespace)||(d=t.namespace+"."+d,d=d.replace(/\.\./g,".")),{type:"animation",internalID:0,id:d,interval:r,frames:u,meta:{displayName:t.displayName,tags:t.tags}}}function b(e,t){return e[t]|e[t+1]<<8}function v(e,n,i=!1){if(!e.assets[n]){if(!i)return;e.assets[n]=new t(n)}return e.assets[n]}n.nextRevision=0,e.TilemapProject=n,e.emitGalleryDeclarations=function(t,n){var i;const r=Object.keys(t),s="    ";let a="";const l={},c={},u={},d=e=>{let n=t[e].namespace||t["*"].namespace;const i=t[e].id||e;return n&&(n.endsWith(".")&&(n=n.slice(0,n.length-1)),!i.startsWith(n+"."))?n+"."+i:i};t["*"]&&(u["*"]=Object.assign(Object.assign({},t["*"]),{namespace:n}));for(const e of r){if("*"===e)continue;const i=t[e],r=d(e);let s=ts.pxtc.escapeIdentifier(i.displayName||r.split(".").pop());if(l[s]){const e=s;let t=2;for(;l[s];)s=e+t,t++}l[s]=!0,c[r]=n+"."+s}for(const l of r){if("*"===l)continue;const r=t[l];let p,h,f=r.mimeType||(null===(i=t["*"])||void 0===i?void 0:i.mimeType);const m=c[d(l)].split(".").pop();let g=r.tags;if(g||(g=[],-1!==m.toLowerCase().indexOf("background")&&g.push("background"),-1!==m.toLowerCase().indexOf("dialog")&&g.push("dialog"),r.tilemapTile&&g.push("tile")),f===e.IMAGE_MIME_TYPE)h="image.ofBuffer(hex``)",p=r.tilemapTile?"images._tile":"images._image";else if(f===e.ANIMATION_MIME_TYPE){h=`[${y(r).frames.map(t=>e.sprite.bitmapToImageLiteral(e.sprite.Bitmap.fromData(t),"typescript")).join(",")}]`}else if(f===e.TILEMAP_MIME_TYPE){const t=o(r);h=e.sprite.encodeTilemap(t,"typescript",c)}else f===e.SONG_MIME_TYPE?h=`hex\`${r.data}\``:f===e.JSON_MIME_TYPE&&(h=r.data);a+=`${s}//% fixedInstance jres whenUsed\n`,p&&(a+=`${s}//% blockIdentity=${p}\n`),g.length&&(a+=`${s}//% tags="${g.join(" ")}"\n`),a+=`${s}export const ${m} = ${h};\n`,"string"==typeof r?u[m]=r:(u[m]=Object.assign(Object.assign({},r),{id:c[d(l)],tags:g}),r.namespace&&(u[m].namespace=n,r.namespace.endsWith(".")&&(u[m].namespace+=".")),u[m].tileset&&(u[m].tileset=r.tileset.map(e=>c[e]||e)))}const p=lf("Auto-generated code. Do not edit.");return[u,`// ${p}\nnamespace ${n} {\n${a}\n}\n// ${p}\n`]},e.emitTilemapsFromJRes=function(t){const n=Object.keys(t),i="    ";let s="";const a=[],l=[];for(const r of n){if("*"===r)continue;const n=t[r];if(n.tilemapTile){let e=r;-1!==e.indexOf(".")&&(e=e.split(".").slice(-1)[0]),s+=`${i}//% fixedInstance jres blockIdentity=images._tile\n`,s+=`${i}export const ${e} = image.ofBuffer(hex\`\`);\n`,l.push({keys:[n.displayName,_("tile",r,!0)],expression:r})}if(n.mimeType===e.TILEMAP_MIME_TYPE){const t=o(n);a.push({keys:[n.displayName,_("tilemap",n.id)],expression:e.sprite.encodeTilemap(t,"typescript")})}}a.length&&(s+=r("tilemap",a)),l.length&&(s+=r("tile",l));const c=lf("Auto-generated code. Do not edit.");return`// ${c}\nnamespace ${e.sprite.TILE_NAMESPACE} {\n${s}\n}\n// ${c}\n`},e.emitProjectImages=function(t){const n=Object.keys(t);let i="";const s=[],o=[],a=[],l=[];for(const i of n){if("*"===i)continue;const n=t[i];if("string"==typeof n||n.mimeType===e.IMAGE_MIME_TYPE){let t,r=[_("image",i,!0)];"string"==typeof n?t=e.sprite.bitmapToImageLiteral(e.sprite.getBitmapFromJResURL(n),"typescript"):(t=e.sprite.bitmapToImageLiteral(e.sprite.getBitmapFromJResURL(n.data),"typescript"),r.push(n.displayName)),s.push({keys:r,expression:t})}else if(n.mimeType===e.ANIMATION_MIME_TYPE){const t=y(n);o.push({keys:[n.displayName,_("animation",i,!0)],expression:`[${t.frames.map(t=>e.sprite.bitmapToImageLiteral(e.sprite.Bitmap.fromData(t),"typescript")).join(", ")}]`})}else n.mimeType===e.SONG_MIME_TYPE?a.push({keys:[_("song",i,!0),n.displayName],expression:`hex\`${n.data}\``}):n.mimeType===e.JSON_MIME_TYPE&&l.push({keys:[_("json",i,!0),n.displayName],expression:n.data})}const c=lf("Auto-generated code. Do not edit.");return i+=r("image",s),i+=r("animation",o),i+=r("song",a),i+=r("json",l),`// ${c}\nnamespace ${e.sprite.IMAGES_NAMESPACE} {\n${i}\n}\n// ${c}\n`},e.cloneAsset=a,e.assetEquals=p,e.validateAssetName=function(e){return!!e&&!/[\u0000-\u001f\u0021-\u002c\u002e\u002f\u003a-\u0040\u005b-\u005e\u0060\u007b-\u007f]/.test(e)},e.getTSReferenceForAsset=function(e,t=!1){var n;let i;if(i=(null===(n=e.meta)||void 0===n?void 0:n.displayName)?e.meta.displayName:f(e),!i)return"image"===e.type||"tile"===e.type?e.id:void 0;const r=t?'("""':"`",s=t?'""")':"`";switch(e.type){case"tile":return`assets.tile${r}${i}${s}`;case"image":return`assets.image${r}${i}${s}`;case"animation":return`assets.animation${r}${i}${s}`;case"tilemap":return`tilemap${r}${i}${s}`;case"song":return`assets.song${r}${i}${s}`;case"json":return`assets.json${r}${i}${s}`}},e.parseAssetTSReference=h,e.lookupProjectAssetByTSReference=function(e,t){const n=h(e);if(n){const{type:e,name:i}=n;switch(e){case"tile":return t.lookupAssetByName("tile",i);case"image":return t.lookupAssetByName("image",i);case"tilemap":return t.lookupAssetByName("tilemap",i)||t.lookupAsset("tilemap",i);case"animation":return t.lookupAssetByName("animation",i);case"song":return t.lookupAssetByName("song",i);case"json":return t.lookupAssetByName("json",i)}}},e.getDefaultAssetDisplayName=function(e){switch(e){case"image":return lf("myImage");case"tile":return lf("myTile");case"tilemap":return lf("level");case"animation":return lf("myAnim");case"song":return lf("mySong");case"json":return lf("myFile");default:return lf("asset")}},e.getShortIDForAsset=f,e.validateAsset=m,e.patchTemporaryAsset=function(e,t,n){if(!e||p(e,t))return t;t=a(t,!0);const i=-1===e.internalID,r=-1===t.internalID;return i&&!r&&(t.id=n.generateNewID(t.type),t.internalID=n.getNewInternalId()),t}}(pxt||(pxt={})),function(e){!function(t){const n={};t.blockColors={loops:"#107c10",logic:"#006970",math:"#712672",variables:"#A80000",functions:"#005a9e",text:"#996600",arrays:"#A94400",advanced:"#3c3c3c",addpackage:"#717171",search:"#000",debug:"#e03030",default:"#dddddd",topblocks:"#aa8f00",recipes:"#717171"},t.blockIcons={loops:"",logic:"",math:"",variables:"",functions:"",text:"",arrays:"",advancedcollapsed:"",advancedexpanded:"",more:"",addpackage:"",search:"",debug:"",default:"",topblocks:"",recipes:""};let i="";function r(e){const t=function(e,t,n){let i=0,r=0,s=0;if(0==t)i=n,r=n,s=n;else{let o=Math.floor(e/60),a=e/60-o,l=n*(1-t),c=n*(1-t*a),u=n*(1-t*(1-a));switch(o){case 1:i=c,r=n,s=l;break;case 2:i=l,r=n,s=u;break;case 3:i=l,r=c,s=n;break;case 4:i=u,r=l,s=n;break;case 5:i=n,r=l,s=c;break;case 6:case 0:i=n,r=u,s=l}}return[Math.floor(i),Math.floor(r),Math.floor(s)]}(e,.45,165.75);return`#${s(t[0])}${s(t[1])}${s(t[2])}`}function s(e){const t=e.toString(16);return 1==t.length?"0"+t:t}function o(t){var i,r;return(null===(r=null===(i=e.appTarget)||void 0===i?void 0:i.appTheme)||void 0===r?void 0:r.adjustBlockContrast)?(n[t]||(n[t]=e.getWhiteContrastingBackground(t)),n[t]):t}t.appendToolboxIconCss=function(t,n){if(!(i.indexOf(t)>-1))if(1===n.length){const r=e.Util.unicodeToChar(n);i+=`\n                .blocklyTreeIcon.${t}::before {\n                    content: "${r}";\n                }\n            `}else i+=`\n                .blocklyTreeIcon.${t} {\n                    background-image: url("${e.Util.pathJoin(e.webConfig.commitCdnUrl,encodeURI(n))}")!important;\n                    width: 30px;\n                    height: 100%;\n                    background-size: 20px !important;\n                    background-repeat: no-repeat !important;\n                    background-position: 50% 50% !important;\n                }\n            `},t.getNamespaceColor=function(t){let n;return t=t.toLowerCase(),e.appTarget.appTheme.blockColors&&e.appTarget.appTheme.blockColors[t]?n=e.appTarget.appTheme.blockColors[t]:e.toolbox.blockColors[t]&&(n=e.toolbox.blockColors[t]),n?o(n):""},t.getNamespaceIcon=function(t){return t=t.toLowerCase(),e.appTarget.appTheme.blockIcons&&e.appTarget.appTheme.blockIcons[t]?e.appTarget.appTheme.blockIcons[t]:e.toolbox.blockIcons[t]?e.toolbox.blockIcons[t]:""},t.advancedTitle=function(){return e.Util.lf("{id:category}Advanced")},t.addPackageTitle=function(){return e.Util.lf("{id:category}Extensions")},t.recipesTitle=function(){return e.Util.lf("{id:category}Tutorials")},t.convertColor=function(e){var t;e=(t=e)?"0x"==t.substring(0,2)?"#"+t.substring(2):t:"#000000";const n=parseInt(e);return isNaN(n)?e:r(n)},t.hueToRgb=r,t.fadeColor=function(e,t,n){(e=e.replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);let i="#";for(let r=0;r<3;r++){let s=parseInt(e.substr(2*r,2),16);s=Math.round(Math.min(Math.max(0,n?s+s*t:s-s*t),255));let o=s.toString(16);i+=("00"+o).substr(o.length)}return i},t.getAccessibleBackground=o}(e.toolbox||(e.toolbox={}))}(pxt||(pxt={})),function(e){!function(t){const n=/^##[^#](.*)$([\s\S]*?)(?=^##[^#]|$(?![\r\n]))/gim,i=/^###[^#](.*)$([\s\S]*?)(?=^###[^#]|$(?![\r\n]))/gim;function r(){return/``` *(sim|block|blocks|filterblocks|spy|ghost|typescript|ts|js|javascript|template|python|jres|assetjson|customts|simtheme|python-template|ts-template|typescript-template|js-template|javascript-template|hiddennamespaces)\s*\n([\s\S]*?)\n```/gim}function s(t,i,r){let s=i||n,c=[];if(t.replace(s,function(e,t,n){n=n.trim();let{header:i,hint:s}=function(e,t){e=l(e);let n,i=e;if(t){const t=/#+ ~ tutorialhint([\s\S]*)/i;i=e.replace(t,function(e,t){return n=t,""})}else{const t=/(^[\s\S]*?\S)\s*((```|\[?\!\[[\s\S]+?\]\(\S+?\)\]?)[\s\S]*)/im;let r=e.match(t);r&&r.length>2&&(i=r[1].trim(),n=r[2].trim())}return{header:i,hint:n}}(n,r&&r.explicitHints);const u=o("local",n),d=a("local",n);let p={title:t.match(/^\{.*\}$/)?void 0:t.replace(/@(fullscreen|unplugged|showdialog|showhint|tutorialCompleted|resetDiff)/gi,"").trim(),contentMd:n,headerContentMd:i,localBlockConfig:u,localValidationConfig:d};return/@(fullscreen|unplugged|showdialog|showhint)/i.test(t)&&(p.showHint=!0),/@(unplugged|showdialog)/i.test(t)&&(p.showDialog=!0),/@tutorialCompleted/.test(t)&&(p.tutorialCompleted=!0),/@resetDiff/.test(t)&&(p.resetDiff=!0),s&&(p.hintContentMd=s),c.push(p),""}),0!=t.indexOf("# Not found"))return c;e.debug("tutorial not found")}function o(e,t){let n={md:"",blocks:[]};const i=new RegExp(`\`\`\`\\s*blockconfig\\.${e}\\s*\\n([\\s\\S]*?)\\n\`\`\``,"gmi");return t.replace(i,(e,t)=>(n.md+=`${t}\n`,"")),n}function a(t,n){let i;const r=new RegExp(`\`\`\`\\s*validation\\.${t}\\s*\\n([\\s\\S]*?)\\n\`\`\``,"gmi");if(n.replace(r,(e,t)=>(i=t,"")),!i||""==i)return null;return{validatorsMetadata:e.getSectionsFromMarkdownMetadata(i).map(e=>({validatorType:e.header,properties:e.attributes}))}}function l(e){if(!e)return e;return e.replace(/```(filterblocks|package|ghost|config|template|jres|assetjson|simtheme|customts|hiddennamespaces|blockconfig\.local|blockconfig\.global|validation\.local|validation\.global)\s*\n([\s\S]*?)\n```/gim,"").trim()}function c(t){if(!t)return;const n=JSON.parse(t);return{[e.TILEMAP_JRES]:n[e.TILEMAP_JRES],[e.TILEMAP_CODE]:n[e.TILEMAP_CODE],[e.IMAGES_JRES]:n[e.IMAGES_JRES],[e.IMAGES_CODE]:n[e.IMAGES_CODE]}}function u(t){const n=e.Util.jsonTryParse(t);if(!n)return;const i={};return n.theme&&(i.theme=n.theme),n.palette&&(i.palette=n.palette),i}t.parseTutorial=function(t){const{metadata:r,body:d}=function(t){const n=/### @(\S+) ([ \S]+)/gi,i={},r=t.replace(n,function(e,t,n){try{i[t]=JSON.parse(n)}catch(e){i[t]=n}return""}),s=i;void 0!==s.explicitHints&&e.appTarget.appTheme&&e.appTarget.appTheme.tutorialExplicitHints&&(s.explicitHints=!0);return{metadata:s,body:r}}(t),{steps:p,activities:h}=function(e,t){if(t&&t.activities)return function(e,t){let r=[],o=[];return e.replace(n,function(e,n,a){let l=o.length;o.push({name:n||lf("Activity {0}",l),step:r.length});let c=s(a,i,t);return c=c.map(e=>(e.activity=l,e)),r=r.concat(c),""}),{steps:r,activities:o}}(e,t);{let n=s(e,null,t);return(!n||n.length<1)&&(n=s(e,i,t)),{steps:n,activities:null}}}(d,r),f=function(e){let t=e.match(/^#[^#](.*)$/im);return t&&t.length>1?t[1].trim():null}(d);if(!p)return;const{code:m,templateCode:g,templateLanguage:_,editor:y,language:b,jres:v,assetJson:T,customTs:k,simThemeJson:x,hiddenNamespaces:E}=function(t){let n;const i=/``` *(sim|block|blocks|filterblocks|spy|ghost|typescript|ts|js|javascript|template|python|jres|assetjson|customts|simtheme|python-template|ts-template|typescript-template|js-template|javascript-template|hiddennamespaces)\s*\n([\s\S]*?)\n```/gim;let r,s,o,a,l,c,u,d,p=[];return t.replace(/((?!.)\s)+/g,"\n").replace(i,function(t,n,i){switch(n){case"block":case"blocks":case"blockconfig.local":case"blockconfig.global":case"filterblocks":if(!h(e.BLOCKS_PROJECT_NAME))return;break;case"spy":case"python":if(!h(e.PYTHON_PROJECT_NAME))return;"python"==n&&(a=n);break;case"typescript":case"ts":case"javascript":case"js":if(!h(e.JAVASCRIPT_PROJECT_NAME))return;break;case"template":s=i;break;case"python-template":if(!h(e.PYTHON_PROJECT_NAME))return;s=i,o="python",a="python";break;case"ts-template":case"typescript-template":case"js-template":case"javascript-template":if(!h(e.JAVASCRIPT_PROJECT_NAME))return;s=i,o="typescript";break;case"jres":r=i;break;case"assetjson":l=i;break;case"simtheme":u=i;break;case"customts":c=i,i="";break;case"hiddennamespaces":d=i.split(/\s/m).map(e=>e.trim()).filter(e=>!!e),i=""}return p.push("python"===a?`\n${i}\n`:`{\n${i}\n}`),""}),n=n||e.BLOCKS_PROJECT_NAME,{code:p,templateCode:s,templateLanguage:o,editor:n,language:a,jres:r,assetJson:l,customTs:c,simThemeJson:u,hiddenNamespaces:d};function h(t){return n&&n!=t?(e.debug("tutorial ambiguous: contains snippets of different types"),!1):(n=t,!0)}}(d);e.BrowserUtils.useOldTutorialLayout()&&"python"===b&&r.flyoutOnly&&(r.flyoutOnly=!1,r.hideToolbox=!0),(!0===r.diffs||!1!==r.diffs&&!0!==r.noDiffs&&(y==e.BLOCKS_PROJECT_NAME&&e.appTarget.appTheme.tutorialBlocksDiff||y!=e.BLOCKS_PROJECT_NAME&&e.appTarget.appTheme.tutorialTextDiff))&&function(e,t){let n;function i(e){const t={typescript:"diff",spy:"diffspy",blocks:"diffblocks",python:"diff"},i=/\s*(\/\/|#)\s*@highlight/gm;return e?e.replace(/```(typescript|spy|python|blocks|ghost|template)((?:.|[\r\n])+)```/,function(e,r,s){const o=n,a=/^(template|ghost)$/.test(r),l=i.test(s);return s=s.replace(/^\n+/,"").replace(/\n+$/,""),l&&(s=s.replace(i,"")),n=s,!o||l||a?e:`\`\`\`${t[r]}\n${o}\n----------\n${s}\n\`\`\``}):e}e.forEach((e,r)=>{if((e.resetDiff||t&&t.find(e=>e.step==r))&&(n=void 0),e.hintContentMd){const t=i(e.hintContentMd);if(t&&t!=e.hintContentMd)return void(e.hintContentMd=t)}if(e.headerContentMd){const t=i(e.headerContentMd);if(t&&t!=e.headerContentMd)return void(e.headerContentMd=t)}})}(p,h);const S=c(T),C=u(x),w=o("global",t),I=a("global",t);return p.forEach(e=>{e.contentMd=l(e.contentMd),e.headerContentMd=l(e.headerContentMd),e.hintContentMd=l(e.hintContentMd)}),{editor:y,title:f,steps:p,activities:h,code:m,templateCode:g,templateLanguage:_,metadata:r,language:b,jres:v,assetFiles:S,customTs:k,globalBlockConfig:w,globalValidationConfig:I,simTheme:C,hiddenNamespaces:E}},t.getMetadataRegex=r,t.highlight=function(e){let t=e.textContent;if(t=t.replace(/img\s*\(\s*"{3}[\s\da-f.#tngrpoyw]*"{3}\s*\)/g,'img(""" """)'),t=t.replace(/img\s*`[\s\da-f.#tngrpoyw]*`\s*/g,"img` `"),!/@highlight/.test(t))return void(e.textContent=t);e.textContent="";const n=t.split("\n");for(let t=0;t<n.length;++t){t>0&&t<n.length&&e.appendChild(document.createTextNode("\n"));let i=n[t];if(/@highlight/.test(i)){if(i=n[++t],void 0!==i){const t=document.createElement("span");t.className="highlight-line",t.textContent=i,e.appendChild(t)}}else e.appendChild(document.createTextNode(i))}},t.getTutorialOptions=function(t,n,i,r,s){var o;const a=e.tutorial.parseTutorial(t);if(!a)throw new Error(lf("Invalid tutorial format"));return{options:{tutorial:n,tutorialName:a.title||i,tutorialReportId:r,tutorialStep:0,tutorialReady:!0,tutorialHintCounter:0,tutorialStepInfo:a.steps,tutorialActivityInfo:a.activities,tutorialMd:t,tutorialCode:a.code,tutorialRecipe:!!s,templateCode:a.templateCode,templateLanguage:a.templateLanguage,autoexpandStep:!(null===(o=a.metadata)||void 0===o?void 0:o.autoexpandOff),metadata:a.metadata,language:a.language,jres:a.jres,assetFiles:a.assetFiles,customTs:a.customTs,globalBlockConfig:a.globalBlockConfig,globalValidationConfig:a.globalValidationConfig,simTheme:a.simTheme,hiddenNamespaces:a.hiddenNamespaces},editor:a.editor}},t.parseCachedTutorialInfo=function(t,n){let i=e.Util.jsonTryParse(t);return i?e.BrowserUtils.tutorialInfoDbAsync().then(e=>{if(n&&i[n]){const t=i[n];t.usedBlocks&&t.hash&&e.setWithHashAsync(n,t.snippetBlocks,t.hash,t.highlightBlocks,t.validateBlocks)}else for(let t of Object.keys(i)){const n=i[t];n.usedBlocks&&n.hash&&e.setWithHashAsync(t,n.snippetBlocks,n.hash,n.highlightBlocks,n.validateBlocks)}}).catch(e=>{}):Promise.resolve()},t.resolveLocalizedMarkdown=function(t,n,i){let r,s=i||t.fileName||"README";s.endsWith(".md")||(s+=".md");const[o,a,l]=e.Util.normalizeLanguageCode(e.Util.userLanguage());return r=o&&a&&l?n[`_locales/${o}/${s}`]||n[`_locales/${l}/${s}`]||n[`_locales/${a}/${s}`]:n[`_locales/${o}/${s}`],r=r||n[s],r},t.parseAssetJson=c,t.parseSimThemeJson=u,t.getTutorialHighlightedBlocks=async function(t){const n=await e.BrowserUtils.tutorialInfoDbAsync(),i=await n.getAsync(t.tutorial,t.tutorialCode);return null==i?void 0:i.highlightBlocks},t.getTutorialValidateBlocks=async function(t){const n=await e.BrowserUtils.tutorialInfoDbAsync(),i=await n.getAsync(t.tutorial,t.tutorialCode);return null==i?void 0:i.validateBlocks},t.getRequiredBlockCounts=function(e){if(!e)return;const t={},n=e["validate-exists"];return n&&n.forEach(e=>{t[e]=(t[e]||0)+1}),t},t.getTutorialStepHash=function(t){const{tutorialStepInfo:n,tutorialStep:i}=t,r=function(e){let t=[];return null==e||e.replace(/((?!.)\s)+/g,"\n").replace(/``` *(block|blocks)\s*\n([\s\S]*?)\n```/gim,function(e,n,i){return t.push(`{\n${i}\n}`),""}),t}(n[i].hintContentMd);return e.BrowserUtils.getTutorialCodeHash(r)},t.shouldFilterProject=function(e){return!!e&&!(!e.hideFromProjects&&!e.hideIteration)}}(e.tutorial||(e.tutorial={}))}(pxt||(pxt={})),function(e){!function(t){let n;t.flattenDiagnosticMessageText=function(e,t){if("string"==typeof e)return e;{let n=e,i="",r=0;for(;n;){if(r){i+=t;for(let e=0;e<r;e++)i+="  "}i+=n.messageText,r++,n=n.next}return i}},function(e){e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES6=2]="ES6",e[e.ES2015=2]="ES2015",e[e.Latest=2]="Latest"}(n=t.ScriptTarget||(t.ScriptTarget={})),t.isIdentifierStart=function(e,t){return e>=65&&e<=90||e>=97&&e<=122||36===e||95===e||e>127&&a(e,t)},t.isIdentifierPart=function(e,t){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||36===e||95===e||e>127&&function(e,t){return t>=n.ES5?l(e,r):l(e,o)}(e,t)},t.reservedWords=["abstract","any","as","break","case","catch","class","continue","const","constructor","debugger","declare","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","implements","import","in","instanceof","interface","is","let","module","namespace","new","null","package","private","protected","public","require","global","return","set","static","super","switch","symbol","this","throw","true","try","type","typeof","var","void","while","with","yield","async","await","of","Math"],t.keywordTypes=["boolean","number","string"],t.escapeIdentifier=function(n){if(!n)return"_";let i=n.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_$]/g,t=>e.pxtc.isIdentifierPart(t.charCodeAt(0),e.pxtc.ScriptTarget.ES5)?t:"");return i&&e.pxtc.isIdentifierStart(i.charCodeAt(0),e.pxtc.ScriptTarget.ES5)&&-1===t.reservedWords.indexOf(i)||(i="_"+i),i};const i=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],r=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],s=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1569,1594,1600,1610,1649,1747,1749,1749,1765,1766,1786,1788,1808,1808,1810,1836,1920,1957,2309,2361,2365,2365,2384,2384,2392,2401,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2784,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2877,2877,2908,2909,2911,2913,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3294,3294,3296,3297,3333,3340,3342,3344,3346,3368,3370,3385,3424,3425,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3946,3976,3979,4096,4129,4131,4135,4137,4138,4176,4181,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6067,6176,6263,6272,6312,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8319,8319,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12329,12337,12341,12344,12346,12353,12436,12445,12446,12449,12538,12540,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65138,65140,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],o=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,768,846,864,866,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1155,1158,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1425,1441,1443,1465,1467,1469,1471,1471,1473,1474,1476,1476,1488,1514,1520,1522,1569,1594,1600,1621,1632,1641,1648,1747,1749,1756,1759,1768,1770,1773,1776,1788,1808,1836,1840,1866,1920,1968,2305,2307,2309,2361,2364,2381,2384,2388,2392,2403,2406,2415,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2492,2494,2500,2503,2504,2507,2509,2519,2519,2524,2525,2527,2531,2534,2545,2562,2562,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2649,2652,2654,2654,2662,2676,2689,2691,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2784,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2876,2883,2887,2888,2891,2893,2902,2903,2908,2909,2911,2913,2918,2927,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3006,3010,3014,3016,3018,3021,3031,3031,3047,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3134,3140,3142,3144,3146,3149,3157,3158,3168,3169,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3262,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3297,3302,3311,3330,3331,3333,3340,3342,3344,3346,3368,3370,3385,3390,3395,3398,3400,3402,3405,3415,3415,3424,3425,3430,3439,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3805,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3946,3953,3972,3974,3979,3984,3991,3993,4028,4038,4038,4096,4129,4131,4135,4137,4138,4140,4146,4150,4153,4160,4169,4176,4185,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,4969,4977,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6099,6112,6121,6160,6169,6176,6263,6272,6313,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8255,8256,8319,8319,8400,8412,8417,8417,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12335,12337,12341,12344,12346,12353,12436,12441,12442,12445,12446,12449,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65056,65059,65075,65076,65101,65103,65136,65138,65140,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65381,65470,65474,65479,65482,65487,65490,65495,65498,65500];function a(e,t){return t>=n.ES5?l(e,i):l(e,s)}function l(e,t){if(e<t[0])return!1;let n,i=0,r=t.length;for(;i+1<r;){if(n=i+(r-i)/2,n-=n%2,t[n]<=e&&e<=t[n+1])return!0;e<t[n]?r=n:i=n+2}return!1}let c;t.isUnicodeIdentifierStart=a,function(e){e[e.Warning=0]="Warning",e[e.Error=1]="Error",e[e.Message=2]="Message"}(c=t.DiagnosticCategory||(t.DiagnosticCategory={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){function n(){return!!navigator&&!!navigator.bluetooth&&"TextDecoder"in window&&e.appTarget.appTheme.bluetoothUartConsole&&e.appTarget.appTheme.bluetoothUartFilters&&e.appTarget.appTheme.bluetoothUartFilters.length>0}function i(){return!!navigator&&!!navigator.bluetooth&&!!e.appTarget.appTheme.bluetoothPartialFlashing}t.isAvailable=function(){return n()||i()},t.hasConsole=n,t.hasPartialFlash=i,t.isValidUUID=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/.test(e)};class r{constructor(e,t){this.connectionTimeout=2e4,this.connectPromise=void 0,this.id=e,this.aliveToken=t}debug(t){e.debug(`${this.id}: ${t}`)}alivePromise(e){return new Promise((t,n)=>{this.aliveToken.isCancelled()&&n(new Error),e.then(e=>t(e),e=>n(e))})}cancelConnect(){this.connectPromise=void 0}createConnectPromise(){return Promise.resolve()}connectAsync(){return this.connectPromise||(this.connectPromise=this.alivePromise(this.createConnectPromise())),e.Util.promiseTimeout(this.connectionTimeout,this.connectPromise,"connection timeout").then(()=>this.aliveToken.throwIfCancelled()).catch(e=>{throw this.connectPromise=void 0,e})}disconnect(){this.cancelConnect()}kill(){this.disconnect(),this.aliveToken.cancel()}}t.BLERemote=r;class s extends r{constructor(e,t,n){super(e,t.aliveToken),this.device=t,this.autoReconnect=n,this.autoReconnectDelay=1e3,this.disconnectOnAutoReconnect=!1,this.reconnectPromise=void 0,this.failedConnectionServicesVersion=-1,this.handleDisconnected=this.handleDisconnected.bind(this),this.device.device.addEventListener("gattserverdisconnected",this.handleDisconnected)}handleDisconnected(t){this.aliveToken.isCancelled()||(this.disconnect(),this.autoReconnect&&!this.reconnectPromise&&(this.reconnectPromise=e.U.delay(this.autoReconnectDelay).then(()=>this.exponentialBackoffConnectAsync(8,500)).finally(()=>this.reconnectPromise=void 0)))}exponentialBackoffConnectAsync(t,n){return this.debug("retry connect"),this.aliveToken.throwIfCancelled(),this.connectAsync().then(()=>{this.aliveToken.throwIfCancelled(),this.debug("reconnect success"),this.reconnectPromise=void 0}).catch(i=>(this.debug(`reconnect error ${i.message}`),this.aliveToken.throwIfCancelled(),this.device.isPaired?this.autoReconnect?0==t?(this.debug("give up, max tries"),void(this.reconnectPromise=void 0)):this.failedConnectionServicesVersion==this.device.servicesVersion?(this.debug("services haven't changed, giving up"),void(this.reconnectPromise=void 0)):(this.debug(`retry connect ${n}ms... (${t} tries left)`),this.device.connected&&(this.failedConnectionServicesVersion=this.device.servicesVersion),this.disconnectOnAutoReconnect&&this.device.disconnect(),e.U.delay(n).then(()=>this.exponentialBackoffConnectAsync(--t,1.8*n))):(this.debug("autoreconnect disabled"),void(this.reconnectPromise=void 0)):(this.debug("give up, device unpaired"),void(this.reconnectPromise=void 0))))}}t.BLEService=s;class o extends s{constructor(e,t,n,i){super(e,t,!0),this.device=t,this.serviceUUID=n,this.txCharacteristicUUID=i,this.handleValueChanged=this.handleValueChanged.bind(this)}createConnectPromise(){return this.debug("connecting"),this.device.connectAsync().then(()=>this.alivePromise(this.device.gatt.getPrimaryService(this.serviceUUID))).then(e=>(this.debug("service connected"),this.service=e,this.alivePromise(this.service.getCharacteristic(this.txCharacteristicUUID)))).then(e=>(this.debug("tx characteristic connected"),this.txCharacteristic=e,this.txCharacteristic.addEventListener("characteristicvaluechanged",this.handleValueChanged),this.txCharacteristic.startNotifications())).then(()=>{e.tickEvent("webble.connected",{id:this.id})})}handlePacket(e){}handleValueChanged(e){const t=e.target.value;this.handlePacket(t)}disconnect(){if(super.disconnect(),this.txCharacteristic&&this.device&&this.device.connected)try{this.txCharacteristic.stopNotifications(),this.txCharacteristic.removeEventListener("characteristicvaluechanged",this.handleValueChanged)}catch(t){e.log(`${this.id}: error ${t.message}`)}this.service=void 0,this.txCharacteristic=void 0}}t.BLETXService=o;class a extends o{constructor(e){super("hf2",e,a.SERVICE_UUID,a.CHARACTERISTIC_TX_UUID),this.device=e}handlePacket(e){const t=e.getUint8(0);switch(192&t){case a.BLEHF2_FLAG_SERIAL_OUT:case a.BLEHF2_FLAG_SERIAL_ERR:const n=Math.min(e.byteLength-1,-193&t);let i="";for(let t=0;t<n;++t)i+=String.fromCharCode(e.getUint8(t+1));i&&window.postMessage({type:"serial",id:this.device.name||"hf2",data:i},"*")}}}a.SERVICE_UUID="b112f5e6-2679-30da-a26e-0273b6043849",a.CHARACTERISTIC_TX_UUID="b112f5e6-2679-30da-a26e-0273b604384a",a.BLEHF2_FLAG_SERIAL_OUT=128,a.BLEHF2_FLAG_SERIAL_ERR=192,t.HF2Service=a;class l extends o{constructor(e){super("uart",e,l.SERVICE_UUID,l.CHARACTERISTIC_TX_UUID),this.device=e}handlePacket(e){const t=(new window.TextDecoder).decode(e);t&&window.postMessage({type:"serial",id:this.device.name||"uart",data:t},"*")}}let c;l.SERVICE_UUID="6e400001-b5a3-f393-e0a9-e50e24dcca9e",l.CHARACTERISTIC_TX_UUID="6e400002-b5a3-f393-e0a9-e50e24dcca9e",t.UARTService=l,function(e){e[e.Idle=1]="Idle",e[e.StatusRequested=2]="StatusRequested",e[e.PairingModeRequested=4]="PairingModeRequested",e[e.RegionDALRequested=8]="RegionDALRequested",e[e.RegionMakeCodeRequested=16]="RegionMakeCodeRequested",e[e.Flash=32]="Flash",e[e.EndOfTransmision=64]="EndOfTransmision",e[e.USBFlashRequired=128]="USBFlashRequired"}(c||(c={}));class u extends s{constructor(e){super("partial flashing",e,!1),this.device=e,this.state=c.Idle,this.disconnectOnAutoReconnect=!0,this.handleCharacteristic=this.handleCharacteristic.bind(this)}clearFlashData(){this.version=0,this.mode=0,this.regions=[],this.chunkDelay=u.CHUNK_MIN_DELAY,this.hex=void 0,this.bin=void 0,this.magicOffset=void 0,this.dalHash=void 0,this.makeCodeHash=void 0,this.flashReject=void 0,this.flashResolve=void 0,this.flashOffset=void 0}createConnectPromise(){return this.debug("connecting to partial flash service"),this.device.connectAsync().then(()=>this.alivePromise(this.device.gatt.getPrimaryService(u.SERVICE_UUID))).then(e=>(this.debug("connecting to characteristic"),this.alivePromise(e.getCharacteristic(u.CHARACTERISTIC_UUID)))).then(e=>(this.debug("starting notifications"),this.pfCharacteristic=e,this.pfCharacteristic.startNotifications(),this.pfCharacteristic.addEventListener("characteristicvaluechanged",this.handleCharacteristic),this.state==c.PairingModeRequested?(this.debug("checking pairing mode"),this.autoReconnect=!1,this.pfCharacteristic.writeValue(new Uint8Array([u.STATUS]))):Promise.resolve()))}disconnect(){if(super.disconnect(),this.flashPacketToken&&this.flashPacketToken.cancel(),this.pfCharacteristic&&this.device.connected)try{this.pfCharacteristic.stopNotifications(),this.pfCharacteristic.removeEventListener("characteristicvaluechanged",this.handleCharacteristic)}catch(t){e.log(`ble: partial flash disconnect error ${t.message}`)}this.pfCharacteristic=void 0}findMarker(e,t){if(!this.bin)return-1;for(;e+t.length<this.bin.length;e+=16){let n=!0;for(let i=0;i<t.length;++i)if(t[i]!=this.bin[e+i]){n=!1;break}if(n)return e}return-1}flashAsync(e){return this.hex?(this.debug("flashing already in progress"),Promise.resolve()):(this.device.pauseLog(),this.createFlashPromise(e).finally(()=>this.device.resumeLogOnDisconnection()))}createFlashPromise(t){if(this.hex)return this.debug("flashing already in progress"),Promise.resolve();this.clearFlashData(),this.hex=t;const n=ts.pxtc.UF2.newBlockFile();ts.pxtc.UF2.writeHex(n,this.hex.split(/\r?\n/));const i=e.appTarget.compile.flashUsableEnd;this.bin=ts.pxtc.UF2.toBin(e.U.stringToUint8Array(ts.pxtc.UF2.serializeFile(n)),i).buf,this.debug(`bin bytes ${this.bin.length}`),this.magicOffset=this.findMarker(0,u.MAGIC_MARKER),this.debug(`magic block ${this.magicOffset.toString(16)}`),this.magicOffset<0&&(this.debug("magic block not found, not a valid HEX file"),e.U.userError(lf("Invalid file"))),this.debug("bytes to flash "+(this.bin.length-this.magicOffset));const r=this.magicOffset+u.MAGIC_MARKER.length;return this.dalHash=e.Util.toHex(this.bin.slice(r,r+8)),this.makeCodeHash=e.Util.toHex(this.bin.slice(r+8,r+16)),this.debug(`DAL hash ${this.dalHash}`),this.debug(`MakeCode hash ${this.makeCodeHash}`),this.connectAsync().then(()=>new Promise((e,t)=>(this.flashResolve=e,this.flashReject=t,this.debug("check service version"),this.state=c.StatusRequested,this.pfCharacteristic.writeValue(new Uint8Array([u.STATUS]))))).then(()=>{},t=>{e.log(`pf: error ${t.message}`),this.clearFlashData()})}checkStateTransition(e,t){return!!(this.state&t)||(this.debug(`flash cmd ${e} in state ${this.state.toString(16)} `),this.flashReject(new Error),this.clearFlashData(),!1)}handleCharacteristic(t){this.aliveToken.isCancelled()&&(this.flashReject(new Error),this.clearFlashData());const n=event.target.value,i=new Uint8Array(n.buffer),r=i[0];if(this.state!=c.Idle)switch(r){case u.STATUS:if(!this.checkStateTransition(r,c.StatusRequested|c.PairingModeRequested))return;this.version=i[1],this.mode=i[2],this.debug(`flash service version ${this.version} mode ${this.mode}`),this.debug("reading DAL region"),this.state=c.RegionDALRequested,this.pfCharacteristic.writeValue(new Uint8Array([u.REGION_INFO,u.REGION_DAL])).then(()=>{});break;case u.REGION_INFO:if(!this.checkStateTransition(r,c.RegionDALRequested|c.RegionMakeCodeRequested))return;const t=this.regions[i[1]]={start:i[2]<<24|i[3]<<16|i[4]<<8|i[5],end:i[6]<<24|i[7]<<16|i[8]<<8|i[9],hash:e.Util.toHex(i.slice(10))};if(this.debug(`read region ${i[1]} start ${t.start.toString(16)} end ${t.end.toString(16)} hash ${t.hash}`),i[1]==u.REGION_DAL){if(t.hash!=this.dalHash)return e.tickEvent("webble.flash.DALrequired"),this.debug("DAL hash does not match, partial flashing not possible"),this.state=c.USBFlashRequired,this.flashReject(new Error("USB flashing required")),void this.clearFlashData();this.debug("DAL hash match, reading makecode region"),this.state=c.RegionMakeCodeRequested,this.pfCharacteristic.writeValue(new Uint8Array([u.REGION_INFO,u.REGION_MAKECODE])).then(()=>{})}else if(i[1]==u.REGION_MAKECODE)if(t.start!=this.magicOffset&&(this.debug("magic offset and MakeCode region.start not matching"),e.U.userError(lf("Invalid file"))),t.hash==this.makeCodeHash)e.tickEvent("webble.flash.noop"),this.debug("MakeCode hash matches, same code!"),this.debug("restart application mode"),this.pfCharacteristic.writeValue(new Uint8Array([u.RESET,u.MODE_APPLICATION])).then(()=>{this.state=c.Idle,this.flashResolve(),this.clearFlashData()});else{if(this.mode!=u.MODE_PAIRING)return this.debug("application mode, reset into pairing mode"),this.state=c.PairingModeRequested,this.autoReconnect=!0,void this.pfCharacteristic.writeValue(new Uint8Array([u.RESET,u.MODE_PAIRING])).then(()=>{});this.flashOffset=t.start,this.flashPacketNumber=0,this.debug(`starting to flash from address ${this.flashOffset.toString(16)}`),this.flashNextPacket()}break;case u.FLASH_DATA:if(!this.checkStateTransition(r,c.Flash))return;switch(i[1]){case u.PACKET_OUT_OF_ORDER:this.debug("packet out of order"),this.flashPacketToken.cancel(),this.flashPacketNumber+=4,this.chunkDelay=Math.min(this.chunkDelay+10,u.CHUNK_MAX_DELAY),this.flashNextPacket();break;case u.PACKET_WRITTEN:this.chunkDelay=Math.max(this.chunkDelay-1,u.CHUNK_MIN_DELAY),this.flashOffset+=64,this.flashPacketNumber+=4,this.flashOffset>=this.bin.length?(this.debug("end transmission"),this.state=c.EndOfTransmision,this.pfCharacteristic.writeValue(new Uint8Array([u.END_OF_TRANSMISSION])).finally(()=>{this.flashResolve&&this.flashResolve(),this.clearFlashData()})):this.flashNextPacket()}break;default:this.debug(`unknown message ${e.Util.toHex(i)}`),this.disconnect()}}flashNextPacket(){this.state=c.Flash,this.flashPacketToken=new e.Util.CancellationToken,this.flashPacketToken.startOperation();const t=this.bin.slice(this.flashOffset,this.flashOffset+64);this.debug(`flashing ${this.flashOffset.toString(16)} / ${this.bin.length.toString(16)} ${(this.flashOffset-this.magicOffset)/(this.bin.length-this.magicOffset)*100|0}%`);let n=new Uint8Array(20);e.U.delay(this.chunkDelay).then(()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=this.flashOffset>>8&255,n[2]=255&this.flashOffset,n[3]=this.flashPacketNumber;for(let e=0;e<16;e++)n[4+e]=t[e];return this.pfCharacteristic.writeValue(n)}).then(()=>e.U.delay(this.chunkDelay)).then(()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=this.flashOffset>>24&255,n[2]=this.flashOffset>>16&255,n[3]=this.flashPacketNumber+1;for(let e=0;e<16;e++)n[4+e]=t[16+e]||0;return this.pfCharacteristic.writeValue(n)}).then(()=>e.U.delay(this.chunkDelay)).then(()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=0,n[2]=0,n[3]=this.flashPacketNumber+2;for(let e=0;e<16;e++)n[4+e]=t[32+e]||0;return this.pfCharacteristic.writeValue(n)}).then(()=>e.U.delay(this.chunkDelay)).then(()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=0,n[2]=0,n[3]=this.flashPacketNumber+3;for(let e=0;e<16;e++)n[4+e]=t[48+e]||0;return this.pfCharacteristic.writeValue(n)}).then(()=>{const t=this.flashOffset,i=()=>e.U.delay(500).then(()=>{if(t!=this.flashOffset||this.flashPacketToken.isCancelled()||this.aliveToken.isCancelled()||this.state!=c.Flash)return Promise.resolve();this.debug("packet transfer deadlock, force restart"),n[0]=u.FLASH_DATA,n[1]=0,n[2]=0,n[3]=-1;for(let e=0;e<16;e++)n[4+e]=0;return this.pfCharacteristic.writeValue(n).then(()=>i())});i().catch(e=>{this.flashReject&&(this.flashReject(new Error("failed packet transfer")),this.clearFlashData())})}).catch(()=>{this.flashPacketToken.resolveCancel()})}}u.SERVICE_UUID="e97dd91d-251d-470a-a062-fa1922dfa9a8",u.CHARACTERISTIC_UUID="e97d3b10-251d-470a-a062-fa1922dfa9a8",u.REGION_INFO=0,u.FLASH_DATA=1,u.PACKET_OUT_OF_ORDER=170,u.PACKET_WRITTEN=255,u.END_OF_TRANSMISSION=2,u.STATUS=238,u.RESET=255,u.MODE_PAIRING=0,u.MODE_APPLICATION=1,u.REGION_SOFTDEVICE=0,u.REGION_DAL=1,u.REGION_MAKECODE=2,u.MAGIC_MARKER=e.Util.fromHex("708E3B92C615A841C49866C975EE5197"),u.CHUNK_MIN_DELAY=0,u.CHUNK_MAX_DELAY=75,t.PartialFlashingService=u;class d extends r{constructor(t){super("ble",new e.Util.CancellationToken),this.device=void 0,this.services=[],this.pendingResumeLogOnDisconnection=!1,this.servicesVersion=0,this.device=t,this.handleDisconnected=this.handleDisconnected.bind(this),this.handleServiceAdded=this.handleServiceAdded.bind(this),this.handleServiceChanged=this.handleServiceChanged.bind(this),this.handleServiceRemoved=this.handleServiceRemoved.bind(this),this.device.addEventListener("gattserverdisconnected",this.handleDisconnected),this.device.addEventListener("serviceadded",this.handleServiceAdded),this.device.addEventListener("servicechanged",this.handleServiceChanged),this.device.addEventListener("serviceremoved",this.handleServiceRemoved),n()&&(this.services.push(this.uartService=new l(this)),this.services.push(this.hf2Service=new a(this))),i()&&this.services.push(this.partialFlashingService=new u(this)),this.aliveToken.startOperation()}startServices(){this.services.filter(e=>e.autoReconnect).forEach(e=>e.connectAsync().catch(()=>{}))}pauseLog(){this.uartService&&(this.uartService.autoReconnect=!1,this.uartService.disconnect()),this.hf2Service&&(this.hf2Service.autoReconnect=!1,this.hf2Service.disconnect())}resumeLogOnDisconnection(){this.pendingResumeLogOnDisconnection=!0}resumeLog(){this.uartService&&(this.uartService.autoReconnect=!0,this.uartService.connectAsync().catch(()=>{})),this.hf2Service&&(this.hf2Service.autoReconnect=!0,this.hf2Service.connectAsync().catch(()=>{}))}get isPaired(){return this===t.bleDevice}get name(){return this.device.name||"?"}get connected(){return this.device&&this.device.gatt&&this.device.gatt.connected}get gatt(){return this.device.gatt}createConnectPromise(){return this.debug("connecting gatt server"),this.alivePromise(this.device.gatt.connect().then(()=>this.debug("gatt server connected")))}handleServiceAdded(e){this.debug("service added"),this.servicesVersion++}handleServiceRemoved(e){this.debug("service removed"),this.servicesVersion++}handleServiceChanged(e){this.debug("service changed"),this.servicesVersion++}handleDisconnected(t){this.debug("disconnected"),this.disconnect(),this.pendingResumeLogOnDisconnection&&(this.pendingResumeLogOnDisconnection=!1,e.U.delay(500).then(()=>this.resumeLog()))}disconnect(){if(super.disconnect(),this.services.forEach(e=>e.disconnect()),this.connected){this.debug("disconnect");try{this.device.gatt&&this.device.gatt.connected&&this.device.gatt.disconnect()}catch(e){this.debug(`gatt disconnect error ${e.message}`)}}}}function p(){if(t.bleDevice)return Promise.resolve();e.log("ble: requesting device");const r=[];return n()&&(r.push(l.SERVICE_UUID),r.push(a.SERVICE_UUID)),i()&&r.push(u.SERVICE_UUID),navigator.bluetooth.requestDevice({filters:e.appTarget.appTheme.bluetoothUartFilters,optionalServices:r}).then(n=>(e.log(`ble: received device ${n.name}`),t.bleDevice=new d(n),t.bleDevice.startServices(),t.bleDevice.connectAsync()))}t.BLEDevice=d,t.bleDevice=void 0,t.isPaired=function(){return!!t.bleDevice},t.pairAsync=function(){return t.bleDevice&&(t.bleDevice.kill(),t.bleDevice=void 0),p().catch(n=>{t.bleDevice&&t.bleDevice.aliveToken&&t.bleDevice.aliveToken.resolveCancel(),e.log(`ble: error ${n.message}`)})},t.flashAsync=function(n,i){e.tickEvent("webble.flash");const r=n.outfiles[ts.pxtc.BINARY_HEX];return p().then(()=>t.bleDevice.partialFlashingService.flashAsync(r)).then(()=>e.tickEvent("webble.flash.success")).catch(t=>{throw e.tickEvent("webble.fail.fail",{message:t.message}),t})}}(e.webBluetooth||(e.webBluetooth={}))}(pxt||(pxt={})),function(e){!function(t){class n extends Error{constructor(e){super(e),this.message=e}}t.USBError=n;t.filters=[{classCode:255,subclassCode:42}];let i,r,s=!0;t.setFilters=function(e){s=!1,t.filters=e};class o{constructor(){this.ready=!1,this.connecting=!1,this.readLoopStarted=!1,this.onDeviceConnectionChanged=e=>{},this.onConnectionChanged=()=>{},this.onData=e=>{},this.onError=e=>{},this.onEvent=e=>{},this.enabled=!1,this.handleUSBConnected=this.handleUSBConnected.bind(this),this.handleUSBDisconnected=this.handleUSBDisconnected.bind(this)}enable(){var e,t;this.enabled||(this.enabled=!0,this.log("registering webusb events"),null===(e=navigator.usb)||void 0===e||e.addEventListener("disconnect",this.handleUSBDisconnected,!1),null===(t=navigator.usb)||void 0===t||t.addEventListener("connect",this.handleUSBConnected,!1))}disable(){var e,t;this.enabled&&(this.enabled=!1,this.log("unregistering webusb events"),null===(e=navigator.usb)||void 0===e||e.removeEventListener("disconnect",this.handleUSBDisconnected),null===(t=navigator.usb)||void 0===t||t.removeEventListener("connect",this.handleUSBConnected))}async disposeAsync(){this.disable()}handleUSBDisconnected(e){var t;this.log("device disconnected"),e.device==this.dev&&(this.log("clear device"),this.clearDev(),null===(t=this.onDeviceConnectionChanged)||void 0===t||t.call(this,!1))}handleUSBConnected(e){var t;const n=e.device;this.log(`device connected ${n.serialNumber}`),this.dev||this.connecting||(this.log("attach device"),null===(t=this.onDeviceConnectionChanged)||void 0===t||t.call(this,!0))}clearDev(){var e;this.dev&&(this.dev=null,this.epIn=null,this.epOut=null,null===(e=this.onConnectionChanged)||void 0===e||e.call(this))}error(t){throw new n(e.U.lf("USB error on device {0} ({1})",this.dev.productName,t))}log(t){e.debug("webusb: "+t)}async disconnectAsync(){if(this.ready=!1,this.dev){this.log("close device");try{await this.dev.close()}catch(e){}this.clearDev(),await e.U.delay(500)}}async forgetAsync(){var e;if(!(null===(e=this.dev)||void 0===e?void 0:e.forget))return!1;try{const e=this.dev;return await this.disconnectAsync(),await e.forget(),!0}catch(e){return!1}}async reconnectAsync(){this.log("reconnect"),this.setConnecting(!0);try{await this.disconnectAsync();const e=await a();await this.connectAsync(e)}finally{this.setConnecting(!1)}}setConnecting(e){var t;e!=this.connecting&&(this.connecting=e,null===(t=this.onConnectionChanged)||void 0===t||t.call(this))}isConnecting(){return this.connecting}isConnected(){return!!this.dev&&this.ready}async connectAsync(t){if(this.log(`trying to connect (${t.length} devices)`),0==t.length){const e=new Error("Device not found.");throw e.type="devicenotfound",e}this.setConnecting(!0);try{if(this.lastKnownDeviceSerialNumber){const n=t.find(e=>e.serialNumber===this.lastKnownDeviceSerialNumber);n?(this.log("last known device spotted"),t.splice(t.indexOf(n),1),t.unshift(n)):(this.log("delay for last known device"),await e.U.delay(2e3))}for(let e=0;e<t.length;++e){const n=t[e];this.dev=n,this.log(`connect device: ${n.manufacturerName} ${n.productName}`),this.log(`serial number: ${n.serialNumber} ${this.lastKnownDeviceSerialNumber===n.serialNumber?"(last known device)":""} `);try{return void await this.initAsync()}catch(e){this.dev=void 0,this.log(`connection failed, ${e.message}`)}}const n=new Error(e.U.lf("Device in use or not found."));throw n.type="devicelocked",n}finally{this.setConnecting(!1)}}async sendPacketAsync(t){if(!this.dev)throw new Error("Disconnected");if(e.Util.assert(t.length<=64),this.epOut){"ok"!=(await this.dev.transferOut(this.epOut.endpointNumber,t)).status&&this.error("USB OUT transfer failed")}else{"ok"!=(await this.dev.controlTransferOut({requestType:"class",recipient:"interface",request:9,value:512,index:this.iface.interfaceNumber},t)).status&&this.error("USB CTRL OUT transfer failed")}}async readLoop(){if(!this.readLoopStarted)for(this.readLoopStarted=!0,this.log("start read loop");;)if(this.ready)try{const t=await this.recvPacketAsync();t[0]?this.onData(t):await e.U.delay(500)}catch(t){this.dev&&this.onError(t),await e.U.delay(300)}else await e.U.delay(300)}async recvPacketAsync(e){const t=Date.now();for(;!e||Date.now()<t+e;){if(!this.dev)throw new Error("Disconnected");const e=await(this.epIn?this.dev.transferIn(this.epIn.endpointNumber,64):this.dev.controlTransferIn({requestType:"class",recipient:"interface",request:1,value:256,index:this.iface.interfaceNumber},64));"ok"!=e.status&&this.error("USB IN transfer failed");let t=new Uint8Array(e.data.buffer);if(0!=t.length)return t}this.error("USB IN timed out")}async initAsync(){var n;if(!this.dev)throw new Error("Disconnected");const i=this.dev;this.log("open device"),await i.open(),this.log("select configuration"),await i.selectConfiguration(1);this.log("got "+i.configurations[0].interfaces.length+" interfaces");const r=i.configurations[0].interfaces.filter(e=>{let n=e.alternates[0];for(let e of t.filters)if((null==e.classCode||n.interfaceClass===e.classCode)&&!(null!=e.subclassCode&&n.interfaceSubclass!==e.subclassCode||null!=e.protocolCode&&n.interfaceProtocol!==e.protocolCode)){if(0==n.endpoints.length)return!0;if(2==n.endpoints.length&&n.endpoints.every(e=>64==e.packetSize))return!0}return!1});let o=r[r.length-1];this.log(`${r.length} matching interfaces; picking ${o?"#"+o.interfaceNumber:"n/a"}`),o||this.error("cannot find supported USB interface"),this.altIface=o.alternates[0],this.iface=o,this.altIface.endpoints.length?(this.log("using dedicated endpoints"),this.epIn=this.altIface.endpoints.filter(e=>"in"==e.direction)[0],this.epOut=this.altIface.endpoints.filter(e=>"out"==e.direction)[0],e.Util.assert(64==this.epIn.packetSize),e.Util.assert(64==this.epOut.packetSize)):this.log("using ctrl pipe"),this.log("claim interface"),await i.claimInterface(o.interfaceNumber),this.log("device ready"),this.lastKnownDeviceSerialNumber=this.dev.serialNumber,this.ready=!0,s&&this.readLoop(),null===(n=this.onConnectionChanged)||void 0===n||n.call(this)}}async function a(){var t;e.log("webusb: get devices");try{return await(null===(t=navigator.usb)||void 0===t?void 0:t.getDevices())||[]}catch(t){return e.reportException(t),[]}}async function l(){var t,n;if(void 0!==r)return;if(e.debug("webusb: checking availability"),!(null===(n=null===(t=e.appTarget)||void 0===t?void 0:t.compile)||void 0===n?void 0:n.webUSB))return void(r=!1);const i=await c();if(i)switch(r=!1,e.tickEvent("webusb.off",{reason:i}),i){case"electron":e.debug("webusb: off, electron");break;case"notimpl":e.debug("webusb: off, not implemented by browser");break;case"oldwindows":e.debug("webusb: off, older windows version");break;case"security":e.debug("webusb: off, security exception")}else r=!0}async function c(){if(e.BrowserUtils.isElectron())return"electron";const t=navigator.usb;if(!t)return"notimpl";let n=/Windows NT (\d+\.\d+)/.exec(navigator.userAgent);if(n&&parseFloat(n[1])<6.3)return"oldwindows";try{await t.getDevices()}catch(e){return"security"}}function u(){return void 0===r&&(e.error("checkAvailableAsync not called"),l()),!!r}t.pairAsync=async function(){var e;try{return!!await(null===(e=navigator.usb)||void 0===e?void 0:e.requestDevice({filters:t.filters}))}catch(e){if("NotFoundError"==e.name)return;throw e}},t.tryGetDevicesAsync=a,t.mkWebUSBHIDPacketIOAsync=function(){return e.debug("packetio: mk webusb io"),i||(i=new o),i.enable(),Promise.resolve(i)},t.forgetDeviceAsync=async function(){return e.debug("packetio: forget webusb io"),!!i&&i.forgetAsync()},t.isEnabled=!1,t.setEnabled=function(e){u()||(e=!1),t.isEnabled=e},t.checkAvailableAsync=l,t.getReasonUnavailable=c,t.isAvailable=u}(e.usb||(e.usb={}))}(pxt||(pxt={})),function(e){!function(t){var n=e.Util;let i={};function r(e){let t={},i=0,r=new n.PromiseQueue,s=new Promise((e,n)=>{t.ready=e});r.enqueue("main",()=>s);return{opAsync:function(n,s){return r.enqueue("main",()=>new Promise((r,o)=>{let a=""+i++;t[a]=e=>{e?e.errorMessage?o(new Error(e.errorMessage)):r(e):o(new Error("no response"))},e({id:a,op:n,arg:s})}))},recvHandler:e=>{if(t.hasOwnProperty(e.id)){let n=t[e.id];delete t[e.id],n(e.result)}}}}function s(t){let n=new Worker(t),i=r(e=>n.postMessage(e));return n.onmessage=t=>{e.perf.measureStart(Measurements.WebworkerRecvHandler),i.recvHandler(t.data),e.perf.measureEnd(Measurements.WebworkerRecvHandler)},i}t.getWorker=function(e){let t=i[e];return t||(t=i[e]=s(e)),t},t.wrap=r,t.makeWebWorker=s,t.makeWebSocket=function(t,n=null){let i=new WebSocket(t),s=[],o=r(e=>{let t=JSON.stringify(e);s?s.push(t):i.send(t)});return i.onmessage=e=>{let t=JSON.parse(e.data);n&&null==t.id?n(t):o.recvHandler(t)},i.onopen=t=>{e.debug("socket opened");for(let e of s)i.send(e);s=null},i.onclose=t=>{e.debug("socket closed")},i.onerror=t=>{e.debug("socket errored")},o}}(e.worker||(e.worker={}))}(pxt||(pxt={})),function(e){!function(t){function n(){t.apiKey||e.U.userError("YouTube API key missing")}function i(e){if(!e)return"";const t=e.medium||e.high||e.standard||e.default;return(null==t?void 0:t.url)||""}t.apiKey=void 0,t.playlistItemToCodeCard=function(e){return{name:e.snippet.title.replace(/[^-]*-/,"").trim(),description:(t=e.snippet.description,t.split(/\n\s+/,1)[0].trim()),youTubeId:e.snippet.resourceId.videoId,youTubePlaylistId:e.snippet.playlistId,imageUrl:i(e.snippet.thumbnails)};var t},t.playlistInfoAsync=function(i){n();const r=`https://www.googleapis.com/youtube/v3/playlists?part=snippet&id=${i}&key=${t.apiKey}`;return e.Util.httpGetJsonAsync(r).then(e=>e.items[0])},t.listPlaylistVideosAsync=async function(i){n();let r,s=[];do{let n=`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${i}&key=${t.apiKey}`;r&&(n+=`&pageToken=${r}`);const o=await e.Util.httpGetJsonAsync(n);s=s.concat(o.items),r=o.nextPageToken}while(r);return e.options.debug&&e.debug(JSON.stringify(s,null,2)),s},t.watchUrl=function(e,t){let n;return e?(n=`https://www.youtube.com/watch?v=${e}`,t&&(n+=`&list=${t}`)):t&&(n=`https://www.youtube.com/playlist?list=${t}`),n}}(e.youtube||(e.youtube={}))}(pxt||(pxt={})),function(e){!function(e){!function(t){function n(e,...t){return e.replace(/{(\d+)}/g,(e,n)=>t[+n])}t.debug=!1,t.lf=n;let i=u("opcode name doesn't match","<name>");class r{constructor(t,n,i,r,s){this.opcode=i,this.mask=r,this.is32bit=s,this.canBeShared=!1,e.assert((i&r)==i),this.ei=t,this.code=n.replace(/\s+/g," "),this.friendlyFmt=n.replace(/\$\w+/g,e=>this.ei.encoders[e]?this.ei.encoders[e].pretty:e);let o=l(n);this.name=o[0],this.args=o.slice(1)}emit(t){let n=t.words;if(n[0]!=this.name)return i;let r=this.opcode,s=1,o=0,a=[],l=null,c=null,d=null;for(let i=0;i<this.args.length;++i){let p=this.args[i],h=n[s++];if("$"==p[0]){let i=this.ei.encoders[p],f=null;if(i.isRegister){if(f=this.ei.registerNo(h),null==f)return u("expecting register name",h);this.ei.isPush(this.opcode)?o++:this.ei.isPop(this.opcode)&&o--}else if(i.isImmediate){if(h=h.replace(/^#/,""),f=t.bin.parseOneInt(h),null==f)return u("expecting number",h);this.ei.isAddSP(this.opcode)?o=-f/this.ei.wordSize():this.ei.isSubSP(this.opcode)&&(o=f/this.ei.wordSize())}else if(i.isRegList){if("{"!=h)return u("expecting {",h);for(f=0;"}"!=n[s];){if(h=n[s++],!h)return u("expecting }",n[s-2]);let e=this.ei.registerNo(h);if(null==e)return u("expecting register name",h);if(f&1<<e)return u("duplicate register name",h);f|=1<<e,this.ei.isPush(this.opcode)?o++:this.ei.isPop(this.opcode)&&o--,","==n[s]&&s++}h=n[s++]}else if(i.isLabel){if(h=h.replace(/^#/,""),/^[+-]?\d+$/.test(h))f=parseInt(h,10),l="rel"+f;else if(/^0x[0-9a-fA-F]+$/.test(h))f=parseInt(h,16),l="abs"+f;else if(l=h,f=this.ei.getAddressFromLabel(t.bin,this,h,i.isWordAligned),null==f){if(t.bin.finalEmit)return u("unknown label",h);f=8}if(this.ei.is32bit(this)){c=f,d=h;continue}}else e.oops();if(null==f)return u("didn't understand it",h);if(a.push(f),f=i.encode(f),null==f)return u("argument out of range or mis-aligned",h);e.assert(0==(r&f)),r|=f}else if(p!=h)return u("expecting "+p,h)}return n[s]?u("trailing tokens",n[s]):this.ei.is32bit(this)?this.ei.emit32(r,c,t.bin.normalizeExternalLabel(d)):{stack:o,opcode:r,numArgs:a,labelName:t.bin.normalizeExternalLabel(l)}}toString(){return this.friendlyFmt}}t.Instruction=r;class s{constructor(e,t){this.bin=e,this.text=t}getOpExt(){return this.instruction?this.instruction.code:""}getOp(){return this.instruction?this.instruction.name:""}update(e){this.bin.peepOps++,(e=e.replace(/^\s*/,""))||this.bin.peepDel++,e&&(e+="      "),e="    "+e,this.text=e+"; WAS: "+this.text.trim(),this.instruction=null,this.numArgs=null,this.words=l(e)||[],0==this.words.length?this.type="empty":"@"==this.words[0][0]&&(this.type="directive")}}t.Line=s;class o{constructor(e,t){this.id=e,this.description=t,this.sizeAdj=0,this.users=[]}get size(){return this.endLocation-this.startLocation-this.sizeAdj}}class a{constructor(e){this.baseOffset=0,this.checkStack=!0,this.inlineMode=!1,this.normalizeExternalLabel=e=>e,this.currLineNo=0,this.scope="",this.scopeId=0,this.errors=[],this.labels={},this.equs={},this.stackpointers={},this.stack=0,this.commPtr=0,this.peepOps=0,this.peepDel=0,this.peepCounts={},this.stats="",this.throwOnError=!1,this.disablePeepHole=!1,this.stackAtLabel={},this.codeSizeStats=!1,this.labelToObject={},this.idToObject={},this.objSuspendStart=0,this.labelsToObjectDone=!1,this.currLine=new s(this,"<start>"),this.currLine.lineNo=0,this.ei=e,this.ei.file=this}emitShort(t){e.assert(0<=t&&t<=65535),this.buf.push(t)}emitOpCode(e){this.emitShort(e)}location(){return 2*this.buf.length}pc(){return this.location()+this.baseOffset}useLabel(t){if(!this.currObject||"."==t[0]||this.objSuspendStart)return;const n=e.U.lookup(this.labelToObject,t);n&&n!=this.currObject&&n.users.length<5&&n.users.indexOf(this.currObject)<0&&n.users.push(this.currObject)}parseOneInt(t){if(!t)return null;if(/^\d+$/.test(t))return parseInt(t,10);const i=t.indexOf("-");if(i>0)return this.parseOneInt(t.slice(0,i))-this.parseOneInt(t.slice(i+1));let r=1;if(t.indexOf("*")>=0){let e=null;for(;null!=(e=/^([^\*]*)\*(.*)$/.exec(t));){let n=this.parseOneInt(e[1]);if(null==n)return null;r*=n,t=e[2]}}if("-"==t[0]?(r*=-1,t=t.slice(1)):"+"==t[0]&&(t=t.slice(1)),/^\d+$/.test(t))return r*parseInt(t,10);if(e.U.endsWith(t,"|1"))return 1|this.parseOneInt(t.slice(0,t.length-2));if(e.U.endsWith(t,"-1"))return this.parseOneInt(t.slice(0,t.length-2))-1;if(e.U.endsWith(t,"+1"))return this.parseOneInt(t.slice(0,t.length-2))+1;let s=/(.*)>>(\d+)$/.exec(t);if(s){let e=this.parseOneInt(s[1]);return e&=~(-16777216&this.baseOffset),e>>parseInt(s[2])}let o=null;if("0"==t[0])if("x"==t[1]||"X"==t[1]){let e=/^0x([a-f0-9]+)$/i.exec(t);e&&(o=parseInt(e[1],16))}else if("b"==t[1]||"B"==t[1]){let e=/^0b([01]+)$/i.exec(t);e&&(o=parseInt(e[1],2))}if(t.indexOf("@")>=0){let i=/^(\w+)@(-?\d+)$/.exec(t);i&&(1!=r&&this.directiveError(n("multiplication not supported with saved stacks")),this.stackpointers.hasOwnProperty(i[1])?o=this.ei.wordSize()*this.ei.computeStackOffset(i[1],this.stack-this.stackpointers[i[1]]+parseInt(i[2])):this.directiveError(n("saved stack not found"))),i=/^(.*)@(hi|lo|fn)$/.exec(t),i&&this.looksLikeLabel(i[1])&&(o=this.lookupLabel(i[1],!0),null!=o&&("fn"==i[2]?o=this.ei.toFnPtr(o,this.baseOffset,i[1]):(o>>=1,0<=o&&o<=65535?"hi"==i[2]?o=o>>8&255:"lo"==i[2]?o&=255:e.oops():(this.directiveError(n("@hi/lo out of range")),o=null))))}return null==o&&this.looksLikeLabel(t)&&(o=this.lookupLabel(t,!0),null!=o&&1==this.ei.postProcessRelAddress(this,1)&&(o+=this.baseOffset)),null==o||isNaN(o)?null:o*r}looksLikeLabel(e){return!/^(r\d|pc|sp|lr)$/i.test(e)&&/^[\.a-zA-Z_][\.:\w+]*$/.test(e)}scopedName(e){return"."==e[0]&&this.scope?this.scope+"$"+e:e}lookupLabel(e,t=!1){this.useLabel(e);let i=null,r=this.scopedName(e);return this.labels.hasOwnProperty(r)?(i=this.labels[r],i=this.ei.postProcessRelAddress(this,i)):this.lookupExternalLabel&&(i=this.lookupExternalLabel(e),null!=i&&(i=this.ei.postProcessAbsAddress(this,i))),null==i&&this.equs.hasOwnProperty(r)&&(i=this.equs[r]),null==i&&t&&(this.finalEmit?this.directiveError(n("unknown label: {0}",e)):i=11111),i}align(t){for(e.assert(2==t||4==t||8==t||16==t);this.location()%t!=0;)this.emitOpCode(0)}pushError(e,t=""){let i={scope:this.scope,message:n("  -> Line {2} ('{1}'), error: {0}\n{3}",e,this.currLine.text,this.currLine.lineNo,t),lineNo:this.currLine.lineNo,line:this.currLine.text,coremsg:e,hints:t};if(this.errors.push(i),this.throwOnError)throw new Error(i.message)}directiveError(e){this.pushError(e)}emitString(e,t=!1){function i(e,t){return 255&(e.charCodeAt(t)||0)}let r,s=/^\s*([\w\.]+\s*:\s*)?.\w+\s+(".*")\s*$/.exec(e);if(s&&null!=(r=c(s[2])))if(this.align(2),t)for(let e=0;e<r.length;e++)this.emitShort(r.charCodeAt(e));else for(let e=0;e<r.length+1;e+=2)this.emitShort(i(r,e+1)<<8|i(r,e));else this.directiveError(n("expecting string"))}parseNumber(e){let t=this.parseOneInt(e.shift());return null==t?null:t}parseNumbers(e){e=e.slice(1);let t=[];for(;;){let i=this.parseNumber(e);if(null==i){this.directiveError(n("cannot parse number at '{0}'",e[0]));break}if(t.push(i),","!=e[0]){if(null==e[0])break;this.directiveError(n("expecting number, got '{0}'",e[0]));break}if(e.shift(),null==e[0])break}return t}emitSpace(e){let t=this.parseNumbers(e);if(1==t.length&&t.push(0),2!=t.length)this.directiveError(n("expecting one or two numbers"));else if(t[0]%2!=0)this.directiveError(n("only even space supported"));else{let e=255&t[1];e|=e<<8;for(let n=0;n<t[0];n+=2)this.emitShort(e)}}emitBytes(e){let t=this.parseNumbers(e);t.length%2!=0&&(this.directiveError(".bytes needs an even number of arguments"),t.push(0));for(let e=0;e<t.length;e+=2){let i=t[e],r=t[e+1];0<=i&&r<=255&&0<=r&&i<=255?this.emitShort(255&i|(255&r)<<8):this.directiveError(n("expecting uint8"))}}emitHex(e){e.slice(1).forEach(e=>{if(","!=e)if(e.length%4!=0)this.directiveError(".hex needs an even number of bytes");else if(/^[a-f0-9]+$/i.test(e))for(let t=0;t<e.length;t+=4){let n=parseInt(e.slice(t,t+4),16);n=(255&n)<<8|n>>8&255,this.emitShort(n)}else this.directiveError(".hex needs a hex number")})}handleDirective(t){let i,r=t.words,s=()=>{2!=r.length&&this.directiveError(n("expecting one argument"))};switch(r[0]){case".object":if(this.codeSizeStats)if("PUSH"==r[1])this.objSuspendStart=this.location();else if("POP"==r[1])this.objSuspendStart&&(this.currObject.sizeAdj+=this.location()-this.objSuspendStart),this.objSuspendStart=0;else{if(this.currObject&&(this.currObject.endLocation=this.location()),this.currObject=e.U.lookup(this.idToObject,r[1]),!this.currObject){const e=t.text.replace(/^[^"]*/,"");let i=r[1];r.length>2&&(i=c(e.trim()),null==i&&this.directiveError(n("expecting string in .object"))),this.currObject=new o(r[1],i),this.idToObject[r[1]]=this.currObject}this.currObject.sizeAdj=0,this.currObject.startLocation=this.location()}else;break;case".ascii":case".asciz":case".string":this.emitString(t.text);break;case".utf16":this.emitString(t.text,!0);break;case".align":if(s(),i=this.parseOneInt(r[1]),null!=i){if(0==i)return;i<=4?this.align(1<<i):this.directiveError(n("expecting 1, 2, 3 or 4 (for 2, 4, 8, or 16 byte alignment)"))}else this.directiveError(n("expecting number"));break;case".balign":if(s(),i=this.parseOneInt(r[1]),null!=i){if(1==i)return;2==i||4==i||8==i||16==i?this.align(i):this.directiveError(n("expecting 2, 4, 8, or 16"))}else this.directiveError(n("expecting number"));break;case".p2align":s(),i=this.parseOneInt(r[1]),null!=i?this.align(1<<i):this.directiveError(n("expecting number"));break;case".byte":this.emitBytes(r);break;case".hex":this.emitHex(r);break;case".hword":case".short":case".2bytes":this.parseNumbers(r).forEach(e=>{-32768<=e&&e<=65535?this.emitShort(65535&e):this.directiveError(n("expecting int16"))});break;case".word":case".4bytes":case".long":this.parseNumbers(r).forEach(e=>{-2147483648<=e&&e<=4294967295?(this.emitShort(65535&e),this.emitShort(e>>16&65535)):this.directiveError(n("expecting int32"))});break;case".skip":case".space":this.emitSpace(r);break;case".set":case".equ":/^\w+$/.test(r[1])||this.directiveError(n("expecting name"));const a=this.parseNumbers(r.slice(","==r[2]||"="==r[2]?2:1));1!=a.length&&this.directiveError(n("expecting one value")),void 0!==this.equs[r[1]]&&this.equs[r[1]]!=a[0]&&this.directiveError(n("redefinition of {0}",r[1])),this.equs[r[1]]=a[0];break;case".startaddr":this.location()&&this.directiveError(n(".startaddr can be only be specified at the beginning of the file")),s(),this.baseOffset=this.parseOneInt(r[1]);break;case"@stackmark":s(),this.stackpointers[r[1]]=this.stack;break;case"@stackempty":this.checkStack&&(null==this.stackpointers[r[1]]?this.directiveError(n("no such saved stack")):this.stackpointers[r[1]]!=this.stack&&this.directiveError(n("stack mismatch")));break;case"@scope":this.scope=r[1]||"",this.currLineNo=this.scope?0:this.realCurrLineNo;break;case".syntax":case"@nostackcheck":this.checkStack=!1;break;case"@dummystack":s(),this.stack+=this.parseOneInt(r[1]);break;case".section":case".global":this.stackpointers={},this.stack=0,this.scope="$S"+this.scopeId++;break;case".comm":{r=r.filter(e=>","!=e),r.shift();let e=this.parseOneInt(r[1]),t=0;if(t=r[2]?this.parseOneInt(r[2]):4,null==this.lookupLabel(r[0])){for(this.commPtr||(this.commPtr=this.lookupExternalLabel("_pxt_comm_base")||0,this.commPtr||this.directiveError(n("PXT_COMM_BASE not defined")));this.commPtr&t-1;)this.commPtr++;this.labels[this.scopedName(r[0])]=this.commPtr-this.baseOffset,this.commPtr+=e}break}case".file":case".text":case".cpu":case".fpu":case".eabi_attribute":case".code":case".thumb_func":case".type":case".fnstart":case".save":case".size":case".fnend":case".pad":case".globl":case".local":case"@":break;default:/^\.cfi_/.test(r[0])||this.directiveError(n("unknown directive"))}}handleOneInstruction(e,t){this.codeSizeStats&&e.ldlitLabel&&this.useLabel(e.ldlitLabel);let i=t.emit(e);return!i.error&&(this.stack+=i.stack,this.checkStack&&this.stack<0&&this.pushError(n("stack underflow")),e.location=this.location(),e.opcode=i.opcode,e.stack=i.stack,this.emitOpCode(i.opcode),null!=i.opcode2&&this.emitOpCode(i.opcode2),null!=i.opcode3&&this.emitOpCode(i.opcode3),e.instruction=t,e.numArgs=i.numArgs,!0)}handleInstruction(e){if(e.instruction&&this.handleOneInstruction(e,e.instruction))return;let t=e=>this.ei.instructions.hasOwnProperty(e)?this.ei.instructions[e]:[];if(!e.instruction){let n=t(e.words[0]);for(let t=0;t<n.length;++t)if(this.handleOneInstruction(e,n[t]))return}let i=e.words[0].toLowerCase().replace(/s$/,"").replace(/[^a-z]/g,""),r="",s=t(i).concat(t(i+"s"));s.length>0&&s.forEach(t=>{let i=t.emit(e);r+=n("   Maybe: {0} ({1} at '{2}')\n",t.toString(),i.error,i.errorAt)}),this.pushError(n("assembly error"),r)}buildLine(e,t){let n=e=>{let n=new s(this,e);return n.scope=this.scope,n.lineNo=this.currLineNo,t.push(n),n},i=n(e),r=l(i.text)||[];i.words=r;let o=r[0]||"";if(":"==o.charAt(o.length-1)){let t=/^([\.\w]+):$/.exec(r[0]);if(t){if(i.type="label",i.text=t[1]+":",i.words=[t[1]],!(r.length>1))return;r.shift(),i=n(e.replace(/^[^:]*:/,"")),i.words=r,o=r[0]||""}}let a=o.charAt(0);"."==a||"@"==a?(i.type="directive","@scope"==i.words[0]&&this.handleDirective(i)):0==i.words.length?i.type="empty":i.type="instruction"}prepLines(e){this.currLineNo=0,this.realCurrLineNo=0,this.lines=[],e.split(/\r?\n/).forEach(e=>{this.errors.length>10||(this.currLineNo++,this.realCurrLineNo++,this.buildLine(e,this.lines))})}iterLines(){this.stack=0,this.buf=[],this.scopeId=0,this.lines.forEach(t=>{if(!(this.errors.length>10)&&(this.currLine=t,0!=t.words.length))if("label"==t.type){this.currObject&&!this.labelsToObjectDone&&"."!=t.words[0][0]&&(this.labelToObject[t.words[0]]=this.currObject);let i=this.scopedName(t.words[0]);if(this.prevLabel=i,this.finalEmit){null!=this.equs[i]&&this.directiveError(n(".equ redefined as label"));let t=this.labels[i];null==t&&e.oops(),0==this.errors.length&&t!=this.location()&&e.oops(`invalid location: ${this.location()} != ${t} at ${i}`),e.assert(this.errors.length>0||t==this.location()),this.reallyFinalEmit&&(this.stackAtLabel[i]=this.stack)}else this.labels.hasOwnProperty(i)?this.directiveError(n("label redefinition")):this.inlineMode&&/^_/.test(i)?this.directiveError(n("labels starting with '_' are reserved for the compiler")):this.labels[i]=this.location();t.location=this.location()}else"directive"==t.type?this.handleDirective(t):"instruction"==t.type?this.handleInstruction(t):"empty"==t.type||e.oops()}),this.labelsToObjectDone=!0,this.currObject=null}getSourceMap(){const e={};let t="",n=0,i=0,r=0;function s(){t&&i&&(e[t]||(e[t]=[]),e[t].push(n,i,r-i)),i=0,r=0}return this.lines.forEach((e,o)=>{const a=/^; ([\w\/\.-]+)\(([\d]+),\d+\):/.exec(e.text);a&&(s(),t=a[1],n=parseInt(a[2])),"instruction"==e.type&&(i||(i=e.location),r=e.location)}),s(),e}getCodeSizeStats(){if(!this.codeSizeStats)return"";const t=e.U.values(this.idToObject);t.sort((e,t)=>t.size-e.size);let n=";\n; Code size:\n;\n";for(const e of t)if(n+=`; ${("         "+e.size).slice(-6)} ${e.description} [${e.id}]\n`,e.users.length>=5)n+=`;        by many, including ${e.users[0].description}\n`;else for(const t of e.users)n+=`;        by ${t.description} [${t.id}]\n`;return n}getSource(e,i=1,r=0){let s=0,o=e=>{let t=this.labels[e]||s,n=t-s;return s=t,n},a=this.buf?this.location():0,l=o("_code_end"),c=o("_helpers_end"),u=o("_vtables_end"),d=o("_literals_end"),p=s,h=a+this.baseOffset&16777215;if(r&&h>r){const e=new Error(n("program too big by {0} bytes!",h-r));throw e.ksErrorCode=9283,e}let f=n("; total bytes: {0} ({1}% of {2}k flash with {3} free)",h,(100*h/(r=r||131072)).toFixed(1),(r/1024).toFixed(1),r-h),m=n("; generated code sizes (bytes): {0} (incl. {1} user, {2} helpers, {3} vtables, {4} lits); src size {5}\n",p,l,c,u,d,a-p)+n("; assembly: {0} lines; density: {1} bytes/stmt; ({2} stmts)\n",this.lines.length,Math.round(100*l/i)/100,i)+f+"\n"+this.stats+this.getCodeSizeStats()+"\n\n",g=!1;return this.lines.forEach((n,i)=>{if("_stored_program"==n.words[0])return m+='_stored_program: .string "..."\n',void(g=!0);if(g)return void(g=!1);let r=n.text;if(e){if("@stackempty"==n.words[0]&&this.lines[i-1].text==n.text)return;if(r=r.replace(/; WAS: .*/,""),!r.trim())return}t.debug&&("label"!=n.type&&"instruction"!=n.type||(r+=` \t; 0x${(n.location+this.baseOffset).toString(16)}`)),m+=r+"\n"}),m}peepHole(){let e=this.lines.filter(e=>"empty"!=e.type);for(let t=0;t<e.length;++t){let n=e[t];if(/^user/.test(n.scope))continue;let i=e[t+1];if(!i)continue;let r=e[t+2];"instruction"==n.type&&this.ei.peephole(n,i,r)}}clearLabels(){this.labels={},this.commPtr=0}peepPass(t){this.disablePeepHole||(this.peepOps=0,this.peepDel=0,this.peepCounts={},this.peepHole(),this.throwOnError=!0,this.finalEmit=!1,this.clearLabels(),this.iterLines(),e.assert(!this.checkStack||0==this.stack),this.finalEmit=!0,this.reallyFinalEmit=t||0==this.peepOps,this.iterLines(),this.stats+=n("; peep hole pass: {0} instructions removed and {1} updated\n",this.peepDel,this.peepOps-this.peepDel))}getLabels(){return this.userLabelsCache||(this.userLabelsCache=e.U.mapMap(this.labels,(e,t)=>t+this.baseOffset)),this.userLabelsCache}emit(t){if(e.assert(null==this.buf),this.prepLines(t),this.errors.length>0)return;if(this.clearLabels(),this.iterLines(),this.checkStack&&0!=this.stack&&this.directiveError(n("stack misaligned at the end of the file")),this.errors.length>0)return;if(this.ei.expandLdlit(this),this.clearLabels(),this.iterLines(),this.finalEmit=!0,this.reallyFinalEmit=this.disablePeepHole,this.iterLines(),this.errors.length>0)return;for(let e=0;e<5&&(pxt.debug(`Peephole OPT, pass ${e}`),this.peepPass(5==e),0!=this.peepOps);++e);pxt.debug("emit done")}}t.File=a;t.VMFile=class extends a{constructor(e){super(e)}};function l(e){let t=[],n="";e:for(let i=0;i<e.length;++i)switch(e[i]){case"[":case"]":case"!":case"{":case"}":case",":n&&(t.push(n),n=""),t.push(e[i]);break;case" ":case"\t":case"\r":case"\n":n&&(t.push(n),n="");break;case";":break e;default:n+=e[i]}return n&&(t.push(n),n=""),t[0]?t:null}function c(e){e=e.replace(/\\\\/g,"\\B").replace(/\\(['\?])/g,(e,t)=>t).replace(/\\[z0]/g,"\0").replace(/\\x([0-9a-f][0-9a-f])/gi,(e,t)=>"\\u00"+t).replace(/\\B/g,"\\\\");try{return JSON.parse(e)}catch(e){return null}}function u(e,t){return{stack:null,opcode:null,error:e,errorAt:t}}function d(e){return e<0||e>65535?("0x"+e.toString(16)).toLowerCase():("0x"+("000"+e.toString(16)).slice(-4)).toLowerCase()}t.AbstractProcessor=class{constructor(){this.file=null,this.addEnc=(e,t,n)=>{let i={name:e,pretty:t,encode:n,isRegister:/^\$r\d/.test(e),isImmediate:/^\$i\d/.test(e),isRegList:/^\$rl\d/.test(e),isLabel:/^\$l[a-z]/.test(e)};return this.encoders[e]=i,i},this.inrange=(e,t,n)=>Math.floor(t)!=t||t<0||t>e?null:n,this.inminmax=(e,t,n,i)=>Math.floor(n)!=n||n<e||n>t?null:i,this.inseq=(e,t)=>{let n=e.indexOf(t);return n<0?null:n},this.inrangeSigned=(e,t,n)=>{if(Math.floor(t)!=t)return null;if(t<-(e+1))return null;if(t>e)return null;return n&(e<<1|1)},this.addInst=(e,t,n,i)=>{let s=new r(this,e,t,n,i);return this.instructions.hasOwnProperty(s.name)||(this.instructions[s.name]=[]),this.instructions[s.name].push(s),s},this.encoders={},this.instructions={}}toFnPtr(e,t,n){return e}wordSize(){return-1}computeStackOffset(e,t){return t}is32bit(e){return!1}emit32(e,t,n){return null}postProcessRelAddress(e,t){return t}postProcessAbsAddress(e,t){return t}peephole(e,t,n){}registerNo(e){return null}getAddressFromLabel(e,t,n,i=!1){return null}isPop(e){return!1}isPush(e){return!1}isAddSP(e){return!1}isSubSP(e){return!1}testAssembler(){e.assert(!1)}expandLdlit(e){}},t.emitErr=u,t.expectError=function(t,n){let i=new a(t);i.emit(n),0==i.errors.length&&e.oops("ASMTEST: expecting error for: "+n)},t.tohex=d,t.expect=function(t,n){let i=[],r=n.replace(/^([0-9a-fA-F]{4,8})\s/gm,(e,t)=>(i.push(parseInt(t.slice(0,4),16)),8==t.length&&i.push(parseInt(t.slice(4,8),16)),"")),s=new a(t);s.throwOnError=!0,s.disablePeepHole=!0,s.emit(r),s.errors.length>0&&(pxt.debug(s.errors[0].message),e.oops("ASMTEST: not expecting errors")),s.buf.length!=i.length&&e.oops("ASMTEST: wrong buf len");for(let t=0;t<i.length;++t)s.buf[t]!=i[t]&&e.oops("ASMTEST: wrong buf content at "+t+" , exp:"+d(i[t])+", got: "+d(s.buf[t]))}}(e.assembler||(e.assembler={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){var n=pxtc.Util;t.apiRoot=e.BrowserUtils.isLocalHost()||n.isNodeJS?"https://www.makecode.com/api/":"/api/",t.accessToken="",t.localToken="";let i,r=!0;function s(t){let i=new Error(n.lf("Cannot access {0} while offline",t));return i.isOffline=!0,e.U.delay(1e3).then(()=>Promise.reject(i))}function o(n,i){return e.U.requestAsync({url:"/api/"+n,headers:{Authorization:t.localToken},method:i?"POST":"GET",data:i||void 0,allowHttpErrors:!0})}function a(){return e.webConfig&&!e.webConfig.isStatic&&!e.BrowserUtils.isLocalHost()&&!!e.webConfig.cdnUrl&&("undefined"==typeof window||!/nocdn=1/i.test(window.location.href))}function l(n){if(n=n.replace(/^\//,""),!a())return t.apiRoot+n;const i=new Date,r=i.getUTCFullYear()+("0"+(i.getUTCMonth()+1)).slice(-2)+("0"+i.getUTCDate()).slice(-2);return n.indexOf("?")<0?n+="?":n+="&",n+="cdn="+r,e.webConfig.cdnUrl+"/api/"+n}function c(e){return a()?(e.url=l(e.url),n.requestAsync(e).catch(t=>u(e,t))):d(e)}function u(e,n){return 0==n.statusCode?(r&&(r=!1,t.onOffline()),s(e.url)):Promise.reject(n)}function d(i){var r;return i.url=(null===(r=e.webConfig)||void 0===r?void 0:r.isStatic)&&!i.forceLiveEndpoint?e.webConfig.relprefix+i.url:t.apiRoot+i.url,i.allowGzipPost=!0,t.isOnline()||e.BrowserUtils.isPxtElectron()?(i.headers||(i.headers={}),e.BrowserUtils.isLocalHost()?t.localToken&&(i.headers.Authorization=t.localToken):t.accessToken&&(i.headers["x-td-access-token"]=t.accessToken),n.requestAsync(i).catch(e=>u(i,e))):s(i.url)}function p(){return navigator&&navigator.onLine}t.onOffline=()=>{},t.hasAccessToken=function(){return!!t.accessToken},t.localRequestAsync=o,t.useCdnApi=a,t.cdnApiUrl=l,t.apiRequestWithCdnAsync=c,t.privateRequestAsync=d,t.privateGetTextAsync=function(e,t){return d({url:e,headers:t}).then(e=>e.text)},t.privateGetAsync=function(e,t=!1){return d({url:e,forceLiveEndpoint:t}).then(e=>e.json)},t.downloadTargetConfigAsync=function(){if(!t.isOnline())return Promise.resolve(void 0);const n=e.appTarget.versions&&e.appTarget.versions.target,i=e.webConfig&&e.webConfig.isStatic?"targetconfig.json":`config/${e.appTarget.id}/targetconfig${n?`/v${n}`:""}`;return e.BrowserUtils.isLocalHost()?o(i).then(e=>e?e.json:void 0):c({url:i}).then(e=>e.json)},t.downloadScriptFilesAsync=function(e){return d({url:e+"/text"+(e.startsWith("S")?`?time=${Date.now()}`:""),forceLiveEndpoint:!0}).then(e=>JSON.parse(e.text))},t.downloadScriptMetaAsync=function(e){return d({url:e+(e.startsWith("S")?`?time=${Date.now()}`:""),forceLiveEndpoint:!0}).then(e=>JSON.parse(e.text).meta)},t.downloadBuiltSimJsInfoAsync=async function(t){const n=e.appTarget.versions&&e.appTarget.versions.target||"",i=e.U.stringifyQueryString(t+"/js",{v:"v"+n})+(t.startsWith("S")?`&time=${Date.now()}`:"");return(await d({url:i,forceLiveEndpoint:!0})).json},t.markdownAsync=async function(t,n,i,r){const s=e.BrowserUtils.isLocalHostDev()?0:36e5,l=24*s*7;n=n||e.Util.userLanguage();const u=await e.BrowserUtils.translationDbAsync(),p=await u.getAsync(n,t),h=async()=>{try{const i=await async function(t,n,i,r){var s;const l=null===(s=e.webConfig)||void 0===s?void 0:s.isStatic,u=e.appTarget.versions&&e.appTarget.versions.target||"?";let p;const h=new URLSearchParams;if(l){p=t;const e=/\/?docs\//.test(p),n=/\.\w+$/.test(p);if(!e){const e="/"===p[0];p=`docs${e?"":"/"}${p}`}n||(p=`${p}.md`)}else p=`md/${e.appTarget.id}/${t.replace(/^\//,"")}`,h.set("targetVersion",u);"en"!=n&&h.set("lang",n);if(p=e.BrowserUtils.appendUrlQueryParams(p,h),e.BrowserUtils.isLocalHost()&&!e.Util.liveLocalizationEnabled())return o(p).then(e=>404==e.statusCode?d({url:p,method:"GET"}).then(e=>({md:e.text,etag:e.headers.etag})):{md:e.text,etag:void 0});const f=i&&!a()?{"If-None-Match":i}:void 0;let m,g;if(!l&&r){p=p.replace(/^md\//,"ghtutorial/docs/"),m=await c({url:p,method:"GET",headers:f});const t=m.json;await e.github.db.cacheReposAsync(t),g=t.markdown}else m=await c({url:p,method:"GET",headers:f}),g=m.text;return{md:g,etag:m.headers.etag}}(t,n,null==p?void 0:p.etag,r);return!p||i.md&&p.md!==i.md?(await u.setAsync(n,t,i.etag,void 0,i.md),i.md):p.md}catch(e){if(i)throw e;return""}};if(p){const t=Date.now()-p.time,n=t>s;if(t>l)e.tickEvent("markdown.update.wait");else if(n&&(e.tickEvent("markdown.update.background"),h()),p.md)return p.md}return h()},t.privateDeleteAsync=function(e){return d({url:e,method:"DELETE"}).then(e=>e.json)},t.privatePostAsync=function(e,t,n=!1){return d({url:e,data:t||{},forceLiveEndpoint:n}).then(e=>e.json)},t.isLoggedIn=function(){return!!t.accessToken},t.isNavigatorOnline=p,t.isOnline=function(){return"undefined"!=typeof navigator&&p()&&(r=!0),r},t.getServiceUrl=function(){return t.apiRoot.replace(/\/api\/$/,"")},t.getUserId=function(){let e=/^0(\w+)\./.exec(t.accessToken);return e?e[1]:null},t.parseScriptId=function(t){var i;const r=e.appTarget;if(!t||!r.appTheme||!(null===(i=r.cloud)||void 0===i?void 0:i.sharing))return;let s=["makecode.com"];r.appTheme.embedUrl&&s.push(r.appTheme.embedUrl),r.appTheme.shareUrl&&s.push(r.appTheme.shareUrl),s=n.unique(s,e=>e).map(e=>n.escapeForRegex(n.stripUrlProtocol(e).replace(/\/$/,"")).toLowerCase());const o=`(?:(?:https://)?(?:${s.join("|")})/)`,a=new RegExp(`^${o}?(?:v[0-9]+/)?(?:(?:api/oembed\\?url=.*%2F([^&#]*)&.*)|(?:/?([a-z0-9\\-_]+)(?:[#?&].*)?))$`,"i").exec(t.trim()),l=(null==a?void 0:a[1])||(null==a?void 0:a[2]);return/^(_.{12}|S?[0-9\-]{23})$/.test(l)?l:void 0},t.initRegionAsync=async function(){var t;if(void 0===i)if(e.BrowserUtils.isLocalHost())i=e.cloud.DEV_REGION;else if(null===(t=e.webConfig)||void 0===t?void 0:t.cdnUrl)try{const t={url:new URL("geo",e.webConfig.cdnUrl).toString()},r=await n.requestAsync(t);200!==r.statusCode&&e.error(`Failed to get region: ${r.statusCode}`),i=r.text.trim()}catch(t){e.error("Unable to determine region",t),i="unknown"}else i="unknown"},t.getRegion=function(){return i||e.error("Accessing region before it is initialized. Call initRegionAsync first."),i}}(e.Cloud||(e.Cloud={}))}(pxt||(pxt={})),function(e){!function(e){e.f4EncodeImg=function(e,t,n,i){let r=[135,n,255&e,e>>8,255&t,t>>8,0,0].map(c).join(""),s=4,o=0,a=0,l=e=>{o|=e<<a,a==8-n?(r+=c(o),s++,o=0,a=0):a+=n};for(let r=0;r<e;++r){for(let e=0;e<t;++e)l(i(r,e));for(;0!=a;)l(0);if(n>1)for(;3&s;)l(0)}return r;function c(e){return("0"+e.toString(16)).slice(-2)}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){function t(e){let t="";switch(e){case 0:t="C5";break;case 1:t="B";break;case 2:t="A";break;case 3:t="G";break;case 4:t="F";break;case 5:t="E";break;case 6:t="D";break;case 7:t="C"}return t}function n(e){let t=-1;switch(e){case"C5":t=0;break;case"B":t=1;break;case"A":t=2;break;case"G":t=3;break;case"F":t=4;break;case"E":t=5;break;case"D":t=6;break;case"C":t=7}return t}e.MelodyArray=class{constructor(e){this.numCols=8,this.numRows=8,this.polyphonic=!1,e&&(this.tempo=e),this.resetMelody()}setTempo(e){this.tempo=e}getArray(){return this.melody}setArray(e){this.melody=e}getColor(e){return 0}getValue(e,t){return this.melody[e][t]}getWidth(){return this.numCols}getHeight(){return this.numRows}updateMelody(e,t){const n=!this.melody[e][t];if(n&&!this.polyphonic)for(let e=0;e<this.numRows;e++)this.melody[e][t]=!1;this.melody[e][t]=n}getStringRepresentation(){let e="",n=new Array(this.numCols),i=0;for(let e=0;e<this.numRows;e++){let r=0;n[e]=[];for(let i=0;i<this.numCols;i++)this.melody[i][e]&&(n[e].push(t(i)),r++);r>i&&(i=r)}if(0==i)return"- - - - - - - - ";for(let t=0;t<i;t++)for(let t=0;t<this.numCols;t++)n[t]&&n[t].length>0?e+=n[t].shift()+" ":e+="- ";return e}parseNotes(e){let t=(e=e.trim()).split(" ");for(let e=0;e<t.length;e++){for(let t=0;t<this.numRows;t++)this.melody[t][e]=!1;"-"!=t[e]&&(this.melody[n(t[e])][e]=!0)}}setPolyphonic(e){this.polyphonic=e}isPolyphonic(){return this.polyphonic}resetMelody(){this.melody=new Array(this.numCols);for(let e=0;e<this.numCols;e++)this.melody[e]=new Array(this.numRows).fill(!1)}},e.rowToNote=t,e.noteToRow=n,e.getColorClass=function(e){let t="melody-default";switch(e){case 0:t="melody-red";break;case 1:t="melody-orange";break;case 2:t="melody-yellow";break;case 3:t="melody-green";break;case 4:t="melody-teal";break;case 5:t="melody-blue";break;case 6:t="melody-purple";break;case 7:t="melody-violet"}return t}}(pxtmelody||(pxtmelody={})),function(e){function t(e,t,n){return function(e,t,n){if(t)for(const n of Object.keys(t))"className"===n?e.setAttribute("class",t[n]+""):e.setAttribute(n,t[n]+"");n&&e.addEventListener("click",n);return e}(document.createElement(e),t,n)}e.MelodyGallery=class{constructor(){this.value=null,this.visible=!1,this.timeouts=[],this.numSamples=e.SampleMelodies.length,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("id","melody-editor-gallery-outer"),this.contentDiv=document.createElement("div"),this.contentDiv.setAttribute("id","melody-editor-gallery"),this.contentDiv.setAttribute("role","menu"),this.contentDiv.setAttribute("tabindex","0"),this.keyDownHandler=this.keyDownListener.bind(this),this.contentDiv.addEventListener("keydown",this.keyDownHandler),this.focusHandler=this.focusListener.bind(this),this.contentDiv.addEventListener("focus",this.focusHandler),this.blurHandler=this.blurListener.bind(this),this.contentDiv.addEventListener("blur",this.blurHandler),this.itemBackgroundColor="#DCDCDC",this.itemBorderColor="white",this.initStyles(),this.containerDiv.appendChild(this.contentDiv),this.containerDiv.style.display="none",this.contentDiv.addEventListener("animationend",()=>{this.visible||(this.containerDiv.style.display="none")}),this.contentDiv.addEventListener("wheel",e=>{e.stopPropagation()},!0)}keyDownListener(e){if(!this.selectedColRow)return;const[t,n]=this.selectedColRow,i=pxt.Util.isUserLanguageRtl()?"ArrowRight":"ArrowLeft",r=pxt.Util.isUserLanguageRtl()?"ArrowLeft":"ArrowRight";switch(e.code){case"ArrowUp":this.selectedColRow=[t,Math.max(0,n-1)];break;case"ArrowDown":this.selectedColRow=[t,Math.min(this.selectionButtons.length-1,n+1)];break;case i:this.selectedColRow=[Math.max(0,t-1),n];break;case r:this.selectedColRow=[Math.min(1,t+1),n];break;case"Enter":case"Space":return this.selectedElement.click(),e.stopPropagation(),void e.preventDefault();default:return}this.selectedElement.classList.remove("selected");const[s,o]=this.selectedColRow;this.selectedElement=0===s?this.selectionButtons[o]:this.previewButtons[o],this.selectedElement.classList.add("selected"),this.contentDiv.setAttribute("aria-activedescendant",getCellId(s,o));const a=this.contentDiv.getBoundingClientRect(),l=this.selectedElement.getBoundingClientRect();l.bottom>a.bottom?this.selectedElement.scrollIntoView({block:"end"}):l.top<a.top&&this.selectedElement.scrollIntoView({block:"start"}),e.stopPropagation(),e.preventDefault()}focusListener(e){this.selectedElement||(this.selectedColRow=[0,0],this.selectedElement=this.selectionButtons[0]),this.selectedElement.classList.add("selected");const[t,n]=this.selectedColRow;this.contentDiv.setAttribute("aria-activedescendant",getCellId(t,n))}blurListener(e){var t;this.contentDiv.removeAttribute("aria-activedescendant"),null===(t=this.selectedElement)||void 0===t||t.classList.remove("selected")}getElement(){return this.containerDiv}getValue(){return this.value}show(e){this.pending=e,this.containerDiv.style.display="block",this.buildDom(),this.visible=!0,pxt.BrowserUtils.removeClass(this.contentDiv,"hidden-above"),pxt.BrowserUtils.addClass(this.contentDiv,"shown")}hide(){var e;this.visible=!1,pxt.BrowserUtils.removeClass(this.contentDiv,"shown"),pxt.BrowserUtils.addClass(this.contentDiv,"hidden-above"),this.value=null,this.stopMelody(),this.contentDiv.removeAttribute("aria-activedescendant"),null===(e=this.selectedElement)||void 0===e||e.classList.remove("selected"),this.selectedElement=void 0,this.selectedColRow=void 0}clearDomReferences(){this.contentDiv.removeEventListener("keydown",this.keyDownHandler),this.contentDiv.removeEventListener("focus",this.focusHandler),this.contentDiv.removeEventListener("blur",this.blurHandler),this.contentDiv=null,this.containerDiv=null}layout(e,t,n){this.containerDiv.style.left=e+"px",this.containerDiv.style.top=t+"px",this.containerDiv.style.height=n+"px"}getLastFocusableElement(){return this.contentDiv}buildDom(){for(;this.contentDiv.firstChild;)this.contentDiv.removeChild(this.contentDiv.firstChild);const t=e.SampleMelodies;this.playIcons=[],this.selectionButtons=[],this.previewButtons=[];for(let e=0;e<t.length;e++)this.mkButton(t[e],e,"255px","45px")}initStyles(){const e=document.createElement("style");e.textContent="\n            #melody-editor-gallery {\n                margin-top: -100%;\n            }\n\n            #melody-editor-gallery.hidden-above {\n                margin-top: -100%;\n                animation: slide-up 0.2s 0s ease;\n            }\n\n            #melody-editor-gallery.shown {\n                margin-top: 0px;\n                animation: slide-down 0.2s 0s ease;\n            }\n\n            @keyframes slide-down {\n                0% {\n                    margin-top: -100%;\n                }\n                100% {\n                    margin-top: 0px;\n                }\n            }\n\n            @keyframes slide-up {\n                0% {\n                    margin-top: 0px;\n                }\n                100% {\n                    margin-top: -100%;\n                }\n            }\n            ",this.containerDiv.appendChild(e)}mkButton(e,n,i,r){const s=t("div",{className:"melody-gallery-button melody-editor-card",id:`:${n}`}),o=t("i",{className:"music icon melody-icon"}),a=t("div",{className:"melody-editor-text"});a.innerText=e.name;const l=this.createColorBlock(e),c=t("div",{className:"melody-editor-button left-button",role:"menuitem",title:e.name,tabIndex:-1,id:getCellId(n,0)},()=>this.handleSelection(e));c.appendChild(o),c.appendChild(a),c.appendChild(l),s.appendChild(c),this.selectionButtons[n]=c;const u=t("div",{className:"melody-editor-button right-button",role:"menuitem",title:lf("Preview {0}",e.name),tabIndex:-1,id:getCellId(n,1)},()=>this.togglePlay(e,n)),d=t("i",{className:"play icon"});this.playIcons[n]=d,u.appendChild(d),s.appendChild(u),this.previewButtons[n]=u,this.contentDiv.appendChild(s)}handleSelection(e){if(this.pending){const t=this.pending;this.pending=void 0,t(e.notes)}}playNote(e,t,n){let i=0;switch(e){case"C5":i=523;break;case"B":i=494;break;case"A":i=440;break;case"G":i=392;break;case"F":i=349;break;case"E":i=330;break;case"D":i=294;break;case"C":i=262}this.timeouts.push(setTimeout(()=>{pxt.AudioContextManager.tone(i)},t*this.getDuration(n))),this.timeouts.push(setTimeout(()=>{pxt.AudioContextManager.stop()},(t+1)*this.getDuration(n)))}getDuration(e){return 6e4/e}previewMelody(e){this.stopMelody();let t=e.notes.split(" ");for(let n=0;n<t.length;n++)this.playNote(t[n],n,e.tempo)}togglePlay(e,t){let n=this.playIcons[t];pxt.BrowserUtils.containsClass(n,"play icon")?(this.resetPlayIcons(),pxt.BrowserUtils.removeClass(n,"play icon"),pxt.BrowserUtils.addClass(n,"stop icon"),this.previewMelody(e),this.timeouts.push(setTimeout(()=>{pxt.BrowserUtils.removeClass(n,"stop icon"),pxt.BrowserUtils.addClass(n,"play icon")},e.notes.split(" ").length*this.getDuration(e.tempo)))):(pxt.BrowserUtils.removeClass(n,"stop icon"),pxt.BrowserUtils.addClass(n,"play icon"),this.stopMelody())}stopMelody(){for(;this.timeouts.length;)clearTimeout(this.timeouts.shift());pxt.AudioContextManager.stop()}resetPlayIcons(){for(let e=0;e<this.numSamples;e++){let t=this.playIcons[e];if(pxt.BrowserUtils.containsClass(t,"stop icon")){pxt.BrowserUtils.removeClass(t,"stop icon"),pxt.BrowserUtils.addClass(t,"play icon");break}}}createColorBlock(t){let n=document.createElement("div");pxt.BrowserUtils.addClass(n,"melody-color-block");let i=t.notes.split(" ");for(let t=0;t<i.length;t++){let r=e.getColorClass(e.noteToRow(i[t])),s=document.createElement("div");0==t?pxt.BrowserUtils.addClass(s,"left-edge sliver "+r):t==i.length-1?pxt.BrowserUtils.addClass(s,"right-edge sliver "+r):pxt.BrowserUtils.addClass(s,"sliver "+r),n.appendChild(s)}return n}}}(pxtmelody||(pxtmelody={}));const getCellId=(e,t)=>`:${e}-${0===t?"selection":"preview"}`;var pxtmelody,pxt,pxt,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,pxt,pxt,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim;!function(e){class t{constructor(e,t,n){this.name=e,this.notes=t,this.tempo=n}}e.MelodyInfo=t,e.SampleMelodies=[new t(lf("Scale"),"C5 B A G F E D C",120),new t(lf("Reverse"),"C D E F G A B C5",120),new t(lf("Mystery"),"E B C5 A B G A F",120),new t(lf("Gilroy"),"A F E F D G E F",120),new t(lf("Falling"),"C5 A B G A F G E",120),new t(lf("Hopeful"),"G B A G C5 B A B",120),new t(lf("Tokyo"),"B A G A G F A C5",120),new t(lf("Paris"),"G F G A - F E D",120),new t(lf("Rising"),"E D G F B A C5 B",120),new t(lf("Sitka"),"C5 G B A F A C5 B",120)]}(pxtmelody||(pxtmelody={})),function(e){let t,n=!1;class i{constructor(e){this.db=e}loadAsync(n,i,r,s){if(!/^v\d+\.\d+\.\d+$/.test(i))return s(n,i);const o=`gh-${r}-${n}#${i}`;return t.cacheGet(o).then(r=>{if(r){const t=e.Util.jsonTryParse(r);if(t)return e.debug(`cache hit ${o}`),Promise.resolve(t)}return s(n,i).then(n=>n?(e.debug(`cached ${o}`),t.cacheSet(o,JSON.stringify(n)).then(()=>n)):n)})}latestVersionAsync(e,t){return this.db.latestVersionAsync(e,t)}loadConfigAsync(e,t){return this.loadAsync(e,t,"pxt",(e,t)=>this.db.loadConfigAsync(e,t))}loadPackageAsync(e,t){return this.loadAsync(e,t,"pkg",(e,t)=>this.db.loadPackageAsync(e,t))}loadTutorialMarkdown(e,t){return this.loadAsync(e,t,"tutorial",(e,t)=>this.db.loadTutorialMarkdown(e,t))}cacheReposAsync(e){return this.db.cacheReposAsync(e)}}class r{constructor(e){this.packageFiles=e}resolve(e,t){return""}readFile(t,n){const i="this"==t.id?n:"pxt_modules/"+t.id+"/"+n;return void 0!==this.packageFiles[i]?this.packageFiles[i]:e.appTarget.bundledpkgs[t.id]?e.appTarget.bundledpkgs[t.id][n]:null}writeFile(t,n,i){const r="this"==t.id?"":"pxt_modules/"+t.id+"/";e.debug(`write file ${r+n}`),this.packageFiles[r+n]=i}getHexInfoAsync(e){return Promise.resolve({hex:["SKIP"]})}cacheStoreAsync(e,n){return(null==t?void 0:t.cacheSet)?t.cacheSet(e,n):Promise.resolve()}cacheGetAsync(e){return(null==t?void 0:t.cacheGet)?t.cacheGet(e):Promise.resolve("")}downloadPackageAsync(i){return n?function(e){const n=null==t?void 0:t.pkgOverrideAsync;return(n?n(e.id):Promise.resolve(void 0)).then(t=>t||e.commonDownloadAsync())}(i).then(t=>{t&&e.U.iterMap(t,(e,t)=>{this.writeFile(i,e,t)})}):Promise.resolve()}resolveVersionAsync(e){return Promise.resolve("*")}}function s(t){if(t.target.preferredEditor==e.PYTHON_PROJECT_NAME){const n=e.U.clone(t);n.ast=!0,n.target.preferredEditor=e.JAVASCRIPT_PROJECT_NAME;for(let t of n.sourceFiles)e.U.endsWith(t,".py")&&(n.fileSystem[t.slice(0,-3)+".ts"]=" ");const i=pxtc.compile(n);t.apisInfo=pxtc.getApiInfo(i.ast,n.jres)}}function o(t,n){const i=new r(t),o=new e.MainPackage(i);return o.loadAsync().then(()=>{let e=o.getTargetOptions();return e.hasHex&&(e.isNative=n.native),o.getCompileOptionsAsync(e)}).then(t=>(a(o.targetVersion(),t),o.getPreferredEditor()===e.PYTHON_PROJECT_NAME&&l(o.targetVersion(),t),s(t),t))}function a(t,n){if(t){e.debug(`applying TS patches relative to ${t}`);for(let i of Object.keys(n.fileSystem))if(-1==i.indexOf("/")&&e.U.endsWith(i,".ts")){const r=n.fileSystem[i],s=e.patching.patchJavaScript(t,r);r!=s&&(e.debug(`applying TS patch to ${i}`),n.fileSystem[i]=s)}}}function l(t,n){if(t){e.debug(`applying PY patches relative to ${t}`);for(let i of Object.keys(n.fileSystem))if(-1==i.indexOf("/")&&e.U.endsWith(i,".py")){const r=n.fileSystem[i],s=e.patching.patchPython(t,r);r!=s&&(e.debug(`applying PY patch to ${i}`),n.fileSystem[i]=s)}}}e.SimpleHost=r,e.prepPythonOptions=s,e.simpleInstallPackagesAsync=function(t){const n=new r(t);return new e.MainPackage(n).loadAsync(!0)},e.simpleGetCompileOptionsAsync=o,e.simpleCompileAsync=function(e,t){return o(e,"boolean"==typeof t?{native:t}:t||{}).then(e=>pxtc.compile(e)).then(e=>(e.success||(e.errors=e.diagnostics.map(ts.pxtc.getDiagnosticString).join("")||"Unknown error."),e))},e.patchTS=a,e.patchPY=l,e.setupSimpleCompile=function(r){"undefined"==typeof global||global.btoa||(global.btoa=function(e){return Buffer.from(e,"binary").toString("base64")},global.atob=function(e){return Buffer.from(e,"base64").toString("binary")}),"undefined"!=typeof pxtTargetBundle&&(e.debug("setup app bundle"),e.setAppTarget(pxtTargetBundle)),r&&(t=r,n=!0,r.httpRequestAsync&&(e.Util.httpRequestCoreAsync=r.httpRequestAsync),e.github.forceProxy=!0,e.github.db=new i(new e.github.MemoryGithubDb)),e.debug("simple setup done")}}(pxt||(pxt={})),function(e){e.simshim=function(t,n){let i,r=ts.SyntaxKind,s=t.getTypeChecker(),o=e.cpp.nsWriter("declare namespace"),a="";for(let s of t.getSourceFiles()){if(n){let t=n(s.fileName);if(e.debug("SimShim[1]: "+t.dir),!e.U.endsWith(t.dir,"/sim")&&!e.U.startsWith(s.fileName,"sim/"))continue}else if(!e.U.startsWith(s.fileName,"sim/"))continue;e.debug("SimShim[2]: "+s.fileName);for(let e of s.statements){let t=e;e.kind==r.ModuleDeclaration&&"pxsim"==t.name.text&&(i=t,m(t.body))}}let l={};return l[e.appTarget.corepkg]=o.finish(),l;function c(e){let t;return ts.isExpression(e)&&(t=s.getContextualType(e)),t||(t=s.getTypeAtLocation(e)),t}function u(e){let t=s.typeToString(e,i,ts.TypeFormatFlags.UseFullyQualifiedType);switch(t=t.replace(/^pxsim\./,""),t){case"RefAction":return"() => void";case"RefBuffer":return"Buffer";default:return t}}function d(e){let t=pxtc.getComments(e);return/^\s*\/\/%/m.test(t)?t:null}function p(e){let t=d(e);if(!t)return;let n=e.name.getText(),i="//% shim=."+n,r=s.getTypeAtLocation(e);o.write(t),o.write(i),o.write(`public ${n}: ${u(r)};`),o.write("")}function h(e){let t=d(e);if(!t)return;s.getTypeAtLocation(e);let n=e.parameters.map(e=>e.name.getText()+": "+u(c(e)));o.write(t),o.write(`//% shim="new ${a}"`),o.write(`constructor(${n.join(", ")});`),o.write("")}function f(t,n=!1){let i=d(t);if(!i)return;let l=t.name.getText(),p=t.kind==r.MethodDeclaration||t.kind==r.GetAccessor||t.kind==r.SetAccessor,h="//% shim="+(p?"."+l:a+"::"+l),f=s.getSignatureFromDeclaration(t),m=s.getReturnTypeOfSignature(f),g=/Async$/.test(l),_=(y=m,pxtc.isObjectType(y)&&y.objectFlags&ts.ObjectFlags.Reference&&"Promise"==y.symbol.name?y.typeArguments[0]:null);var y;_?(h+=" promise",m=_,g||e.U.userError(`${a}::${l} should be called ${l}Async`)):g&&e.U.userError(`${a}::${l} doesn't return a promise`),e.debug("emitFun: "+l);let b=t.parameters.map(e=>`${e.name.getText()}${e.questionToken?"?":""}: ${u(c(e))}`),v=l.replace(/Async$/,""),T=p?"public":"function",k=`(${b.join(", ")})`;t.kind==r.GetAccessor&&(T=n?"public":"readonly",k="",h+=" property"),p||o.setNs(a),o.write(i),o.write(h),o.write(`${T} ${v}${k}: ${u(m)};`),o.write("")}function m(e){switch(e.kind){case r.ModuleDeclaration:return function(e){let t=a;a&&(a+="."),a+=e.name.text,m(e.body),a=t}(e);case r.ModuleBlock:return e.statements.forEach(m);case r.FunctionDeclaration:return f(e);case r.ClassDeclaration:return function(e){let t=d(e);if(!t)return;o.setNs(a),o.write(t);let n=a;a&&(a+="."),a+=e.name.text;let i=n?"":"declare",s="";if(e.heritageClauses)for(let t of e.heritageClauses)t.token==r.ExtendsKeyword&&(s=" extends "+u(c(t.types[0])));o.write(`${i} class ${e.name.text}${s} {`),o.incrIndent();for(let t of e.members)switch(t.kind){case r.MethodDeclaration:f(t);break;case r.PropertyDeclaration:p(t);break;case r.Constructor:h(t);break;case r.GetAccessor:let n=e.members.some(e=>e.kind==r.SetAccessor&&e.name.getText()==t.name.getText());f(t,n)}a=n,o.decrIndent(),o.write("}")}(e)}}}}(pxt||(pxt={})),function(e){!function(t){t.annotate=function(n,i,r){const s=t.target;t.target=r;let o=n.getSourceFiles().filter(e=>e.fileName===i)[0],a=n.getTypeChecker();function l(n,i,r=!1,s=null){let o=r||!(u(n).flags&e.TypeFlags.Void),l=s||c(n);if(n.expression&&l){let e=!1;switch(l.kind){case t.SK.PropertySignature:case t.SK.PropertyAssignment:case t.SK.PropertyDeclaration:t.isStatic(l)||(e=!0);break;case t.SK.Parameter:t.isCtorField(l)&&(e=!0);break;case t.SK.GetAccessor:case t.SK.SetAccessor:case t.SK.MethodDeclaration:case t.SK.MethodSignature:t.isStatic(l)||(e=!0)}if(e){const e=n.expression;e.kind===t.SK.PropertyAccessExpression?i.unshift(e.expression):i.unshift(n.expression)}}let d={decl:l,qName:l?t.getNodeFullName(a,l):"?",args:i,isExpression:o};t.pxtInfo(n).callInfo=d}function c(n){if(!n)return null;let i,r=a.getSymbolAtLocation(n);if(r&&(i=r.valueDeclaration,!i&&r.declarations)){let t=r.declarations[0];t&&t.kind==e.SyntaxKind.ImportEqualsDeclaration&&(r=a.getSymbolAtLocation(t.moduleReference),r&&(i=r.valueDeclaration))}if(!i&&n.kind==t.SK.PropertyAccessExpression){const e=n;i={kind:t.SK.PropertySignature,symbol:{isBogusSymbol:!0,name:e.name.getText()},name:e.name},t.pxtInfo(i).flags|=2}return i}function u(n){let i;const r=t.pxtInfo(n);return r.typeCache?r.typeCache:(e.isExpression(n)&&(i=a.getContextualType(n)),i||(i=a.getTypeAtLocation(n)),i?e.isStringLiteral(n)?i:t.checkType(i):i)}!function n(i){e.forEachChild(i,i=>{switch(i.kind){case e.SyntaxKind.CallExpression:l(i,i.arguments.slice(0),null,c(i.expression));break;case e.SyntaxKind.PropertyAccessExpression:l(i,[]);break;case e.SyntaxKind.TaggedTemplateExpression:l(i,[i.template],!0,c(i.tag));break;case e.SyntaxKind.BinaryExpression:!function(n){const i=n.left,r=n.right;let s=u(n.left),o=u(n.right);n.operatorToken.kind!=t.SK.PlusToken&&n.operatorToken.kind!=t.SK.PlusEqualsToken||(t.isStringType(s)||t.isStringType(o)&&n.operatorToken.kind==t.SK.PlusToken)&&(t.pxtInfo(n).exprInfo={leftType:a.typeToString(s),rightType:a.typeToString(o)});switch(n.operatorToken.kind){case e.SyntaxKind.EqualsToken:case e.SyntaxKind.PlusEqualsToken:case e.SyntaxKind.MinusEqualsToken:if(i.kind==t.SK.PropertyAccessExpression){let n=c(i);n&&n.kind==t.SK.GetAccessor?(n=e.getDeclarationOfKind(n.symbol,t.SK.SetAccessor),l(i,[r],!1,n)):n&&(n.kind==t.SK.PropertySignature||n.kind==t.SK.PropertyAssignment||t.target&&t.target.switches.slowFields)&&l(i,[r])}}}(i);break;case e.SyntaxKind.Identifier:const n=c(i);if(n&&n.getSourceFile().fileName!==pxt.MAIN_TS&&n.kind==e.SyntaxKind.VariableDeclaration){const e=t.pxtInfo(i);e.flags|=4,e.commentAttrs||(e.commentAttrs=t.parseComments(n))}}n(i)})}(o),t.target=s}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){function t(e){let t='"';for(let n=0;n<e.length;++n){let i=255&e.charCodeAt(n),r=String.fromCharCode(i);t+="\\"==r||'"'==r?"\\"+r:"\n"==r?"\\n":i<=15?"\\x0"+i.toString(16):i<32||i>127?"\\x"+i.toString(16):r}return t+'"'}e.asmStringLiteral=t;function n(n){let i="pxt::string_inline_ascii_vt",r=e.target.utf8?e.U.toUTF8(n,!0):n,s="";if(r!==n)if(n.length>16){i="pxt::string_skiplist16_packed_vt";let o=[],a=0;for(let t=0;t+16<=n.length;t+=16)a+=e.U.toUTF8(n.slice(t,t+16),!0).length,o.push(a);s=`\n    .short ${r.length}, ${n.length}\n    .short ${o.map(e=>e.toString()).join(", ")}\n    .string ${t(r)}\n`}else i="pxt::string_inline_utf8_vt";return s||(s=`\n    .short ${r.length}\n    .string ${t(r)}\n`),{vt:i,asm:s}}function i(e,t=""){return`\n                .word ${e.length>>1}${t}\n                .hex ${e}${e.length%4==0?"":"00"}\n        `}e.AssemblerSnippets=class{nop(){return"TBD(nop)"}reg_gets_imm(e,t){return"TBD(reg_gets_imm)"}proc_setup(e,t){return"TBD(proc_setup)"}push_fixed(e){return"TBD(push_fixed)"}push_local(e){return"TBD(push_local)"}push_locals(e){return"TBD(push_locals)"}pop_fixed(e){return"TBD(pop_fixed)"}pop_locals(e){return"TBD(pop_locals)"}proc_return(){return"TBD(proc_return)"}debugger_stmt(e){return""}debugger_bkpt(e){return""}debugger_proc(e){return""}unconditional_branch(e){return"TBD(unconditional_branch)"}beq(e){return"TBD(beq)"}bne(e){return"TBD(bne)"}cmp(e,t){return"TBD(cmp)"}cmp_zero(e){return"TBD(cmp_zero)"}arithmetic(){return""}load_reg_src_off(e,t,n,i,r,s){return"TBD(load_reg_src_off)"}rt_call(e,t,n){return"TBD(rt_call)"}call_lbl(e,t){return"TBD(call_lbl)"}call_reg(e){return"TBD(call_reg)"}helper_prologue(){return"TBD(lambda_prologue)"}helper_epilogue(){return"TBD(lambda_epilogue)"}pop_clean(e){return"TBD"}load_ptr_full(e,t){return"TBD(load_ptr_full)"}emit_int(e,t){return"TBD(emit_int)"}obj_header(e){return`.word ${e}`}string_literal(e,t){const i=n(t);return`\n            .balign 4\n            .object ${e}\n            ${e}: ${this.obj_header(i.vt)}\n            ${i.asm}\n`}hex_literal(e,t){return`\n.balign ${/f{16}/i.test(t)?8:4}\n.object ${e}\n${e}: ${this.obj_header("pxt::buffer_vt")}\n${i(t)}\n`}},e.utf8AsmStringLiteral=n,e.hexLiteralAsm=i,e.numBytes=function(e){let t=0;for(let n=e;n>0;n>>>=8)t++;return t||1};e.ProctoAssembler=class{constructor(t,n,i){this.resText="",this.exprStack=[],this.calls=[],this.proc=null,this.baseStackSize=0,this.labelledHelpers={},this.write=t=>{this.resText+=e.asmline(t)},this.t=t,this.bin=n,this.proc=i,this.proc&&this.work()}emitHelpers(){this.emitLambdaTrampoline(),this.emitArrayMethods(),this.emitFieldMethods(),this.emitBindHelper()}redirectOutput(t){let n=this.write,i="";this.write=t=>i+=e.asmline(t);try{t()}finally{this.write=n}return i}stackSize(){return this.baseStackSize+this.exprStack.length}stackAlignmentNeeded(t=0){if(!e.target.stackAlign)return 0;let n=e.target.stackAlign-(this.stackSize()+t&e.target.stackAlign-1);return n==e.target.stackAlign?0:n}getAssembly(){return this.resText}work(){this.write(`\n;\n; Function ${this.proc.getFullName()}\n;\n`);let t=this.proc.label();this.write(`.object ${t} ${JSON.stringify(this.proc.getFullName())}`);let n=t+"_pre",i=t+"_bkpt",r=t+"_locals",s=t+"_end";this.write(`${n}:`),this.emitLambdaWrapper(this.proc.isRoot),this.write(".section code"),this.write(`${t}:`),this.proc.classInfo&&this.proc.info.thisParameter&&!e.target.switches.skipClassCheck&&!e.target.switches.noThisCheckOpt&&(this.write("mov r7, lr"),this.write("ldr r0, [sp, #0]"),this.emitInstanceOf(this.proc.classInfo,"validate"),this.write("mov lr, r7")),this.write(`\n${t}_nochk:\n    @stackmark func\n    @stackmark args\n`),this.proc.fillDebugInfo=t=>{let o=t.getLabels();this.proc.debugInfo={locals:(1==this.proc.seqNo?this.bin.globals:this.proc.locals).map(e=>e.getDebugInfo()),args:this.proc.args.map(e=>e.getDebugInfo()),name:this.proc.getName(),codeStartLoc:e.U.lookup(o,r),codeEndLoc:e.U.lookup(o,s),bkptLoc:e.U.lookup(o,i),localsMark:e.U.lookup(t.stackAtLabel,r),idx:this.proc.seqNo,calls:this.calls,size:e.U.lookup(o,s)+2-e.U.lookup(o,n)};for(let n of this.calls)n.addr=e.U.lookup(o,n.callLabel),n.stack=e.U.lookup(t.stackAtLabel,n.callLabel),n.callLabel=void 0;for(let n=0;n<this.proc.body.length;++n){let i=this.proc.body[n].breakpointInfo;if(i){let n=e.U.lookup(t.stackAtLabel,`__brkp_${i.id}`);n!==this.proc.debugInfo.localsMark&&(pxt.log(i),pxt.log(t.stackAtLabel),e.U.oops(`offset doesn't match: ${n} != ${this.proc.debugInfo.localsMark}`))}}},this.bin.breakpoints&&this.write(this.t.debugger_proc(i)),this.baseStackSize=1;let o=this.proc.locals.length;this.write("push {lr}"),this.write(".locals:\n"),this.proc.perfCounterNo&&(this.write(this.t.emit_int(this.proc.perfCounterNo,"r0")),this.write("bl pxt::startPerfCounter")),this.write(this.t.proc_setup(o)),this.baseStackSize+=o,this.write("@stackmark locals"),this.write(`${r}:`);for(let t=0;t<this.proc.body.length;++t){let n=this.proc.body[t];switch(n.stmtKind){case e.ir.SK.Expr:this.emitExpr(n.expr);break;case e.ir.SK.StackEmpty:if(this.exprStack.length>0){for(let e of this.proc.body.slice(t-4,t+1))pxt.log(`PREVSTMT ${e.toString().trim()}`);for(let e of this.exprStack)pxt.log(`EXPRSTACK ${e.currUses}/${e.totalUses} E: ${e.toString()}`);e.oops("stack should be empty")}this.write("@stackempty locals");break;case e.ir.SK.Jmp:this.emitJmp(n);break;case e.ir.SK.Label:this.write(n.lblName+":"),this.validateJmpStack(n);break;case e.ir.SK.Comment:this.write(`; ${n.expr.data}`);break;case e.ir.SK.Breakpoint:if(this.bin.breakpoints){let e=`__brkp_${n.breakpointInfo.id}`;n.breakpointInfo.isDebuggerStmt?this.write(this.t.debugger_stmt(e)):this.write(this.t.debugger_bkpt(e))}break;default:e.oops()}}e.assert(0<=o&&o<127),o>0&&this.write(this.t.pop_locals(o)),this.proc.perfCounterNo&&(this.write("mov r4, r0"),this.write(this.t.emit_int(this.proc.perfCounterNo,"r0")),this.write("bl pxt::stopPerfCounter"),this.write("mov r0, r4")),this.write(`${s}:`),this.write(this.t.proc_return()),this.write("@stackempty func"),this.write("@stackempty args"),this.write("; endfun")}mkLbl(e){let t=e+this.bin.lblNo++;return"_"!=t[0]&&(t="."+t),t}dumpStack(){let e="[";for(let t of this.exprStack)e+=t.sharingInfo()+": "+t.toString()+"; ";return e+="]",e}terminate(t){e.assert(t.exprKind==e.ir.EK.SharedRef);let n=t.args[0];e.U.assert(n.currUses!=n.totalUses),e.U.assert(this.exprStack[0]===n,"term at top");let i=1;for(;i<this.exprStack.length;){let e=this.exprStack[i];if(e.currUses!=e.totalUses)break;i++}return this.write(`@dummystack ${i}`),this.write(this.t.pop_locals(i)),i}validateJmpStack(t,n=0){let i=this.exprStack.length-n;null==t.lblStackSize?t.lblStackSize=i:t.lblStackSize!=i&&(pxt.log(t.lblStackSize,i),pxt.log(this.dumpStack()),e.U.oops("stack misaligned at: "+t.lblName))}emitJmp(t){let n=0;if(t.jmpMode==e.ir.JmpMode.Always)t.expr&&this.emitExpr(t.expr),t.terminateExpr&&(n=this.terminate(t.terminateExpr)),this.write(this.t.unconditional_branch(t.lblName)+" ; with expression");else{let i=this.mkLbl("jmpz");this.emitExpr(t.expr),(t.expr.exprKind!=e.ir.EK.RuntimeCall||"thumb::subs"!==t.expr.data&&!e.U.startsWith(t.expr.data,"_cmp_"))&&this.write(this.t.cmp_zero("r0")),t.jmpMode==e.ir.JmpMode.IfNotZero?this.write(this.t.beq(i)):this.write(this.t.bne(i)),t.terminateExpr&&(n=this.terminate(t.terminateExpr)),this.write(this.t.unconditional_branch(t.lblName)),this.write(i+":")}this.validateJmpStack(t.lbl,n)}clearStack(e=!1){let t=0;for(;this.exprStack.length>0&&this.exprStack[0].currUses==this.exprStack[0].totalUses;)t++,this.exprStack.shift();if(t&&this.write(this.t.pop_locals(t)),!e){let e=this.exprStack.filter(e=>e.currUses==e.totalUses&&-1!=e.irCurrUses);if(e.length>0){this.write(this.t.reg_gets_imm("r7",0));for(let t of e)t.irCurrUses=-1,this.write(this.loadFromExprStack("r7",t,0,!0))}}}emitExprInto(t,n){switch(t.exprKind){case e.ir.EK.NumberLiteral:"number"==typeof t.data?this.write(this.t.emit_int(t.data,n)):e.oops();break;case e.ir.EK.PointerLiteral:this.write(this.t.load_ptr_full(t.data,n));break;case e.ir.EK.SharedRef:let i=t.args[0];e.U.assert(!!i.currUses),e.U.assert(i.currUses<i.totalUses),i.currUses++;let r=this.exprStack.indexOf(i);if(e.U.assert(r>=0),0==r&&i.totalUses==i.currUses)this.write(this.t.pop_fixed([n])+` ; tmpref @${this.exprStack.length}`),this.exprStack.shift(),this.clearStack();else{let e=r.toString()+":"+this.exprStack.length;this.write(this.t.load_reg_src_off(n,"sp",e,!0)+" ; tmpref @"+(this.exprStack.length-r))}break;case e.ir.EK.CellRef:let s=t.data;if(s.isGlobal()){let e=this.bitSizeInfo(s.bitSize),t="#"+s.index;(e.needsSignExt||s.index>=e.immLimit)&&(this.write(this.t.emit_int(s.index,n)),t=n),this.write(this.t.load_reg_src_off("r7","r6","#0")),this.write(this.t.load_reg_src_off(n,"r7",t,!1,!1,e))}else{let[e,t,i]=this.cellref(s);this.write(this.t.load_reg_src_off(n,e,t,i))}break;default:e.oops()}}bitSizeInfo(t){let n={size:e.sizeOfBitSize(t),immLimit:128};return 1==n.size?n.immLimit=32:2==n.size&&(n.immLimit=64),1!=t&&3!=t||(n.needsSignExt=!0),n}emitExpr(t){switch(t.exprKind){case e.ir.EK.JmpValue:this.write("; jmp value (already in r0)");break;case e.ir.EK.Nop:this.write(this.t.nop());break;case e.ir.EK.FieldAccess:return this.emitExpr(t.args[0]),this.emitFieldAccess(t);case e.ir.EK.Store:return this.emitStore(t.args[0],t.args[1]);case e.ir.EK.RuntimeCall:return this.emitRtCall(t);case e.ir.EK.ProcCall:return this.emitProcCall(t);case e.ir.EK.SharedDef:return this.emitSharedDef(t);case e.ir.EK.Sequence:return t.args.forEach(e=>this.emitExpr(e)),this.clearStack();case e.ir.EK.InstanceOf:return this.emitExpr(t.args[0]),this.emitInstanceOf(t.data,t.jsInfo);default:return this.emitExprInto(t,"r0")}}emitFieldAccess(t,n=!1){let i=t.data,r=(n?"st":"ld")+"fld_"+i.classInfo.id+"_"+i.name;i.needsCheck&&!e.target.switches.skipClassCheck&&(this.emitInstanceOf(i.classInfo,"validate"),r+="_chk");let s=4*i.idx+4,o="#"+s;s>124&&(this.write(this.t.emit_int(s,"r3")),o="r3"),n?this.write(`str r1, [r0, ${o}]`):this.write(`ldr r0, [r0, ${o}]`)}writeFailBranch(){this.write(".fail:"),this.write("mov r1, lr"),this.write(this.t.callCPP("pxt::failedCast"))}emitClassCall(t){let n=t.virtualIndex+e.firstMethodOffset();this.write(this.t.emit_int(4*n,"r1"));let i=t.classInfo,r="";t.isThis&&(r+="_this"),this.emitLabelledHelper("classCall_"+i.id+r,()=>{this.write("ldr r0, [sp, #0] ; ld-this"),this.loadVTable(),e.target.switches.skipClassCheck||t.isThis||this.checkSubtype(i),this.write("ldr r1, [r3, r1] ; ld-method"),this.write("bx r1 ; keep lr from caller"),this.writeFailBranch()})}helperObject(e){return`.object _pxt_helper_${e.replace(/[^\w]+/g,"_")} "helper: ${e}"`}emitBindHelper(){this.write(`\n                ${this.helperObject("bind")}\n                .section code\n                _pxt_bind_helper:\n                    push {r0, r2}\n                    movs r0, #2\n                    ldlit r1, _pxt_bind_lit\n                    ${this.t.callCPP("pxt::mkAction")}\n                    pop {r1, r2}\n                    str r1, [r0, #12]\n                    str r2, [r0, #16]\n                    bx r4 ; return\n\n                _pxt_bind_lit:\n                    ${this.t.obj_header("pxt::RefAction_vtable")}\n                    .short 0, 0 ; no captured vars\n                    .word .bindCode@fn\n                .bindCode:\n                    ; r0-bind object, r4-#args\n                    cmp r4, #12\n                    bge .fail\n                    lsls r3, r4, #2\n                    ldlit r2, _pxt_copy_list\n                    ldr r1, [r2, r3]\n\n                    ldr r3, [r0, #12]\n                    ldr r2, [r0, #16]\n                    adds r4, r4, #1\n                    bx r1\n            `),this.writeFailBranch(),this.write("_pxt_copy_list:"),this.write(e.U.range(12).map(e=>`.word _pxt_bind_${e}@fn`).join("\n"));for(let e=0;e<12;e++){this.write(`\n                _pxt_bind_${e}:\n                    sub sp, #4\n                `);for(let t=0;t<e;++t)this.write(`ldr r1, [sp, #4*${t+1}]`),this.write(`str r1, [sp, #4*${t}]`);this.write(`\n                    push {r3} ; this-ptr\n                    mov r1, lr\n                    str r1, [sp, #4*${e+1}] ; store LR\n                    blx r2\n                    ldr r1, [sp, #4*${e+1}]\n                    add sp, #8\n                    bx r1\n                `)}}ifaceCallCore(t,n,i=!1){this.write("\n                ldr r2, [r3, #12] ; load mult\n                movs r7, r2\n                beq .objlit ; built-in types have mult=0\n                muls r7, r1\n                lsrs r7, r2\n                lsls r7, r7, #1 ; r7 - hash offset\n                ldr r3, [r3, #4] ; iface table\n                adds r3, r3, r7\n                ; r0-this, r1-method idx, r2-free, r3-hash entry, r4-num args, r7-free\n                ");for(let t=0;t<e.vtLookups;++t)t>0&&this.write("    adds r3, #2"),this.write("\n                ldrh r2, [r3, #0] ; r2-offset of descriptor\n                ldrh r7, [r2, r3] ; r7-method idx\n                cmp r7, r1\n                beq .hit\n                ");"get"==n?(this.write("movs r0, #0 ; undefined"),this.write("bx lr")):this.write("b .fail2"),this.write("\n            .hit:\n                adds r3, r3, r2 ; r3-descriptor\n                ldr r2, [r3, #4]\n                lsls r7, r2, #31\n                beq .field\n            ");const r=this.t.emit_int(t,"r4")+"\n     bx r2";if("set"==n?this.write(`\n                    ; check for next descriptor\n                    ldrh r7, [r3, #8]\n                    cmp r7, r1\n                    bne .fail2 ; no setter!\n                    ldr r2, [r3, #12]\n                    ${r}\n                `):(this.write("\n                    ; check if it's getter\n                    ldrh r7, [r3, #2]\n                    cmp r7, #1\n                "),"get"==n?this.write(`\n                        bne .bind\n                        ${r}\n                    .bind:\n                        mov r4, lr\n                        bl _pxt_bind_helper\n                    `):this.write(`\n                        beq .doublecall\n                        ${r}\n                    .doublecall:\n                        ; call getter\n                        movs r4, #1\n                        push {r0, lr}\n                        blx r2\n                        pop {r1, r2}\n                        mov lr, r2\n                        b .moveArgs\n                    `)),i||(this.write(`\n                .objlit:\n                    ldrh r2, [r3, #8]\n                    cmp r2, #${pxt.BuiltInType.RefMap}\n                    bne .fail\n                    mov r4, lr\n                `),"set"==n&&this.write("ldr r2, [sp, #4] ; ld-val"),this.write(this.t.callCPP("set"==n?"pxtrt::mapSet":"pxtrt::mapGet")),n?this.write("bx r4"):(this.write("mov lr, r4"),this.write("b .moveArgs"))),this.write(".field:"),"set"==n?this.write("\n                        ldr r3, [sp, #4] ; ld-val\n                        str r3, [r0, r2] ; store field\n                        bx lr\n                    "):"get"==n?this.write("\n                        ldr r0, [r0, r2] ; load field\n                        bx lr\n                    "):this.write("\n                        ldr r0, [r0, r2] ; load field\n                    "),!n){this.write(".moveArgs:");for(let e=0;e<t;++e)e==t-1?this.write("movs r1, r0"):this.write(`ldr r1, [sp, #4*${e+1}]`),this.write(`str r1, [sp, #4*${e}]`);this.lambdaCall(t-1)}i&&this.write(".objlit:"),this.writeFailBranch(),this.write(`\n            .fail2:\n                ${this.t.callCPP("pxt::missingProperty")}\n            `)}emitIfaceCall(t,n,i=""){e.U.assert(t.ifaceIndex>0),this.write(this.t.emit_int(t.ifaceIndex,"r1")),this.emitLabelledHelper("ifacecall"+n+"_"+i,()=>{this.write("ldr r0, [sp, #0] ; ld-this"),this.loadVTable(),this.ifaceCallCore(n,i)})}checkSubtype(e,t=".fail",n="r2"){e.classNo?(this.write(`ldrh ${n}, [r3, #8]`),this.write(`cmp ${n}, #${e.classNo}`),e.classNo==e.lastSubtypeNo?this.write(`bne ${t}`):(this.write(`blt ${t}`),this.write(`cmp ${n}, #${e.lastSubtypeNo}`),this.write(`bgt ${t}`))):this.write(`b ${t} ; always fails; class never instantiated`)}loadVTable(e="r2",t=".fail",n=".fail"){this.write(`lsls ${e}, r0, #30`),this.write(`bne ${t}`),this.write("cmp r0, #0"),this.write(`beq ${n}`),this.write("ldr r3, [r0, #0]"),this.write("; vtable in R3")}emitInstanceOf(t,n){let i="inst_"+t.id+"_"+n;this.emitLabelledHelper(i,()=>{"validateNullable"==n?this.loadVTable("r2",".tagged",".undefined"):this.loadVTable("r2",".fail",".fail"),this.checkSubtype(t),"bool"==n?(this.write(`movs r0, #${e.taggedTrue}`),this.write("bx lr"),this.write(".fail:"),this.write(`movs r0, #${e.taggedFalse}`),this.write("bx lr")):"validate"==n?(this.write("bx lr"),this.writeFailBranch()):"validateNullable"==n?(this.write(".undefined:"),this.write("bx lr"),this.write(".tagged:"),this.write(`cmp r0, #${e.taggedNull} ; check for null`),this.write("bne .fail"),this.write("movs r0, #0"),this.write("bx lr"),this.writeFailBranch()):e.U.oops()})}emitSharedDef(t){let n=t.args[0];if(e.U.assert(n.totalUses>=1),e.U.assert(0===n.currUses),n.currUses=1,1==n.totalUses)return this.emitExpr(n);this.emitExpr(n),this.exprStack.unshift(n),this.write(this.t.push_local("r0")+"; tmpstore @"+this.exprStack.length)}clearArgs(t,n){t.length,n.length;let i=t.concat(n);for(let t of i)0==t.currUses&&1==t.totalUses||(pxt.log(t.toString()),pxt.log(i.map(e=>e.toString())),e.U.oops(`wrong uses: ${t.currUses} ${t.totalUses}`)),t.currUses=1;this.clearStack()}builtInClassNo(e){return{id:"builtin"+e,classNo:e,lastSubtypeNo:e}}emitBeginTry(e){this.emitExprInto(e.args[0],"r0"),this.write("bl _pxt_save_exception_state")}emitRtCall(t,n=null){let i=t.data;if("pxt::beginTry"==i)return this.emitBeginTry(t);let r=t.mask||{refMask:0},s=r.conversions||[],o=t.args.map((e,t)=>({idx:t,expr:e,isSimple:e.isLiteral(),isRef:!!(r.refMask&1<<t),conv:s.find(e=>e.argIdx==t)}));e.U.assert(o.length<=4);let a=!1;for(let t of e.U.reversed(o))t.expr.isPure()?t.isSimple||t.isRef||a&&!t.expr.isStateless()||(t.isSimple=!0):a=!0;for(let e of o)e.conv&&(e.isSimple=!1);let l=o.filter(e=>!e.isSimple);if(l.every(e=>e.expr.isPure()&&!e.isRef&&!e.conv)){for(let e of l)e.isSimple=!0;l=[]}let c=l[0],u=!0;if(1!=l.length||c.conv||c.isRef){for(let e of l)this.pushArg(e.expr);this.alignExprStack(0);let t=l.filter(e=>!!e.conv);if(t.length){const n=this.redirectOutput(()=>{let n=0;e.target.switches.inlineConversions||(this.t.stackAligned()?n+=2:n+=1);for(let i of t){if(e.isThumb()&&"pxt::toInt"==i.conv.method){this.write(this.loadFromExprStack("r0",i.expr,n)),this.write("asrs r0, r0, #1");let t=e.target.switches.inlineConversions?i.expr.getId():n;this.write("bcs .isint"+t),this.write("lsls r0, r0, #1"),this.alignedCall(i.conv.method,"",n),this.write(".isint"+t+":"),this.write(this.t.push_fixed(["r0"]))}else this.write(this.loadFromExprStack("r0",i.expr,n)),i.conv.refTag?e.target.switches.skipClassCheck||this.emitInstanceOf(this.builtInClassNo(i.conv.refTag),i.conv.refTagNullable?"validateNullable":"validate"):(this.alignedCall(i.conv.method,"",n),i.conv.returnsRef&&this.write(this.loadFromExprStack("r0",i.expr,n,!0))),this.write(this.t.push_fixed(["r0"]));n++}for(let i of e.U.reversed(t))n--,this.write(this.t.pop_fixed(["r"+i.idx]));for(let e of l)e.conv||this.write(this.loadFromExprStack("r"+e.idx,e.expr,n))});e.target.switches.inlineConversions?this.write(n):this.emitHelper(this.t.helper_prologue()+n+this.t.helper_epilogue(),"conv")}else for(let e of l)this.write(this.loadFromExprStack("r"+e.idx,e.expr))}else this.emitExpr(c.expr),0!=c.idx&&this.write(this.t.mov("r"+c.idx,"r0")),u=!1;for(let e of o)e.isSimple&&this.emitExprInto(e.expr,"r"+e.idx);n?n():"langsupp::ignore"!=i&&this.alignedCall(i,"",0,!0),u&&this.clearArgs(l.filter(e=>!e.isRef).map(e=>e.expr),l.filter(e=>e.isRef).map(e=>e.expr))}alignedCall(t,n="",i=0,r=!1){(e.U.startsWith(t,"_cmp_")||e.U.startsWith(t,"_pxt_"))&&(r=!1),this.write(this.t.call_lbl(t,r,this.stackAlignmentNeeded(i))+n)}emitLabelledHelper(e,t){if(this.labelledHelpers[e])this.write(this.t.call_lbl(this.labelledHelpers[e]));else{let n=this.redirectOutput(t);this.emitHelper(n,e),this.labelledHelpers[e]=this.bin.codeHelpers[n]}}emitHelper(e,t="hlp"){if(!this.bin.codeHelpers[e]){let n=Object.keys(this.bin.codeHelpers).length;this.bin.codeHelpers[e]=`_${t}_${n}`}this.write(this.t.call_lbl(this.bin.codeHelpers[e]))}pushToExprStack(e){e.totalUses=1,e.currUses=0,this.exprStack.unshift(e)}pushArg(e){this.clearStack(!0);this.exprStack.length;this.emitExpr(e),this.clearStack(!0),this.write(this.t.push_local("r0")+" ; proc-arg"),this.pushToExprStack(e)}loadFromExprStack(t,n,i=0,r=!1){let s=this.exprStack.indexOf(n);return e.assert(s>=0),this.t.load_reg_src_off(t,"sp",(s+i).toString(),!0,r)+" ; estack\n"}pushDummy(){let t=e.ir.numlit(0);t.totalUses=1,t.currUses=1,this.exprStack.unshift(t)}alignExprStack(e){let t=this.stackAlignmentNeeded(e);if(t)for(let e=0;e<t;++e)this.write("push {r5} ; align"),this.pushDummy()}emitFieldMethods(){for(let t of["get","set"]){this.write(`\n                ${this.helperObject(t)}\n                .section code\n                _pxt_map_${t}:\n                `),this.loadVTable("r4"),this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.RefMap),".notmap","r4"),this.write(this.t.callCPPPush("set"==t?"pxtrt::mapSetByString":"pxtrt::mapGetByString")),this.write(".notmap:");let n="set"==t?2:1,i=!1;this.write("mov r4, r3 ; save VT"),"set"==t?(e.target.stackAlign&&(i=!0,this.write("push {lr} ; align")),this.write("\n                            push {r0, r2, lr}\n                            mov r0, r1\n                        ")):this.write("\n                            push {r0, lr}\n                            mov r0, r1\n                        "),this.write("\n                    bl pxtrt::lookupMapKey\n                    mov r1, r0 ; put key index in r1\n                    ldr r0, [sp, #0] ; restore obj pointer\n                    mov r3, r4 ; restore vt\n                    bl .dowork\n                "),this.write(this.t.pop_locals(n+(i?1:0))),this.write("pop {pc}"),this.write(".dowork:"),this.ifaceCallCore(n,t,!0)}}emitArrayMethod(t,n){this.write(`\n            ${this.helperObject(t+" "+(n?"buffer":"array"))}\n            .section code\n            _pxt_${n?"buffer":"array"}_${t}:\n            `),this.loadVTable("r4");let i=this.builtInClassNo(n?pxt.BuiltInType.BoxedBuffer:pxt.BuiltInType.RefCollection);e.target.switches.skipClassCheck||this.checkSubtype(i,".fail","r4");const r=e.isStackMachine()||e.target.runtimeIsARM||n?"ldr":"ldrh";this.write(`\n                asrs r1, r1, #1\n                bcc .notint\n                ${r} r4, [r0, #${n?4:8}]\n                cmp r1, r4\n                bhs .oob\n            `);let s="r1";n?(s="#8",this.write("\n                    adds r4, r0, r1\n                ")):this.write("\n                    lsls r1, r1, #2\n                    ldr r4, [r0, #4]\n                ");let o=n?"b":"",a=n&&"get"==t?"lsls r0, r0, #1\nadds r0, #1":"";"set"==t?this.write(`\n                        str${o} r2, [r4, ${s}]\n                        bx lr\n                    `):this.write(`\n                        ldr${o} r0, [r4, ${s}]\n                        ${a}\n                        bx lr\n                    `),this.write(`\n            .notint:\n                lsls r1, r1, #1\n                ${this.t.pushLR()}\n                push {r0, r2}\n                mov r0, r1\n                ${this.t.callCPP("pxt::toInt")}\n                mov r1, r0\n                pop {r0, r2}\n            .doop:\n                ${this.t.callCPP(`Array_::${t}At`)}\n                ${a}\n                ${this.t.popPC()}\n            `),this.writeFailBranch(),"get"==t?this.write(`\n                    .oob:\n                        movs r0, #${n?1:0} ; 0 or undefined\n                        bx lr\n                `):this.write(`\n                    .oob:\n                        ${this.t.pushLR()}\n                        b .doop\n                `)}emitArrayMethods(){for(let e of["get","set"])this.emitArrayMethod(e,!0),this.emitArrayMethod(e,!1)}emitLambdaTrampoline(){let t=e.target.stackAlign?"r3,":"";this.write(`\n            ${this.helperObject("trampoline")}\n            .section code\n            _pxt_lambda_trampoline:\n                push {${t} r4, r5, r6, r7, lr}\n                mov r4, r8\n                mov r5, r9\n                mov r6, r10\n                mov r7, r11\n                push {r4, r5, r6, r7} ; save high registers\n                mov r4, r1\n                mov r5, r2\n                mov r6, r3\n                mov r7, r0\n                `),this.emitInstanceOf(this.builtInClassNo(pxt.BuiltInType.RefAction),"validate"),this.write(`\n                mov r0, sp\n                push {r4, r5, r6, r7} ; push args and the lambda\n                mov r1, sp\n                bl pxt::pushThreadContext\n                mov r6, r0          ; save ctx or globals\n                mov r5, r7          ; save lambda for closure\n                mov r0, r5          ; also save lambda pointer in r0 - needed by pxt::bindMethod\n                ldr r1, [r5, #8]    ; ld fnptr\n                movs r4, #3         ; 3 args\n                blx r1              ; execute the actual lambda\n                mov r7, r0          ; save result\n                @dummystack 4\n                add sp, #4*4        ; remove arguments and lambda\n                mov r0, r6   ; or pop the thread context\n                bl pxt::popThreadContext\n                mov r0, r7 ; restore result\n                pop {r4, r5, r6, r7} ; restore high registers\n                mov r8, r4\n                mov r9, r5\n                mov r10, r6\n                mov r11, r7\n                pop {${t} r4, r5, r6, r7, pc}`),this.write(`\n            ${this.helperObject("exn")}\n            .section code\n            ; r0 - try frame\n            ; r1 - handler PC\n            _pxt_save_exception_state:\n                push {r0, lr}\n                ${this.t.callCPP("pxt::beginTry")}\n                pop {r1, r4}\n                str r1, [r0, #1*4] ; PC\n                mov r1, sp\n                str r1, [r0, #2*4] ; SP\n                str r5, [r0, #3*4] ; lambda ptr\n                bx r4\n                `),this.write("\n            .section code\n            ; r0 - try frame\n            ; r1 - thread context\n            _pxt_restore_exception_state:\n                mov r6, r1\n                ldr r1, [r0, #2*4] ; SP\n                mov sp, r1\n                ldr r5, [r0, #3*4] ; lambda ptr\n                ldr r1, [r0, #1*4] ; PC\n                movs r0, #1\n                orrs r1, r0\n                bx r1\n                "),this.write(`\n            ${this.helperObject("stringconv")}\n            .section code\n            _pxt_stringConv:\n            `),this.loadVTable(),this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.BoxedString),".notstring"),this.write(`\n                bx lr\n\n            .notstring: ; no string, but vtable in r3\n                ldr r7, [r3, #4*${e.firstMethodOffset()-1}]\n                cmp r7, #0\n                beq .fail\n                push {r0, lr}\n                movs r4, #1\n                blx r7\n                str r0, [sp, #0]\n                b .numops\n\n            .fail: ; not an object or no toString\n                push {r0, lr}\n            .numops:\n                ${this.t.callCPP("numops::toString")}\n                pop {r1}\n                pop {pc}\n            `)}emitProcCall(t){let n=[],i=null,r="",s=t.data;if(s.proc&&s.proc.inlineBody)return this.emitExpr(s.proc.inlineSelf(t.args));let o=-1==s.virtualIndex,a=!1;for(let i of e.U.reversed(t.args)){if(i.isPure()){if(!a||i.isStateless())continue}else a=!0;n.push(i)}if(n.reverse(),n.length<=1){let e=n[0];e&&(i=e,this.clearStack(!0),this.emitExpr(e),e==t.args[t.args.length-1]?r="r0":(r="r3",this.write(this.t.mov("r3","r0")))),n=[]}else for(let e of n)this.pushArg(e);this.alignExprStack(t.args.length);let l=["r1","r2","r3","r4"],c=[];if(n.length){let e=-1;for(let t of n)e=Math.max(this.exprStack.indexOf(t),e);if(e++,e<=l.length){l=l.slice(0,e),this.write(this.t.pop_fixed(l)),c=this.exprStack.splice(0,e);let t=[];for(let i=e-1;i>=0;--i)n.indexOf(c[i])<0&&(t.push(l[i]),this.exprStack.unshift(c[i]));t.length&&this.write(this.t.push_fixed(t))}else l=null,this.write(this.t.reg_gets_imm("r7",0))}let u=e.U.reversed(t.args);o&&u.unshift(u.pop());for(let t of u)if(n.indexOf(t)>=0){if(l)this.write(this.t.push_fixed([l[c.indexOf(t)]]));else{this.write(this.loadFromExprStack("r0",t)),this.write(this.t.push_local("r0")+" ; re-push"),this.write(this.loadFromExprStack("r7",t,1,!0));let n=this.exprStack.indexOf(t),i=e.ir.numlit(0);i.currUses=1,i.totalUses=1,this.exprStack[n]=i}this.exprStack.unshift(t)}else t===i?(this.write(this.t.push_local(r)+" ; the one arg"),this.pushToExprStack(t)):this.pushArg(t);let d=this.mkLbl("_proccall"),p=-1;if(o){let e=t.args.length-1;this.write(this.loadFromExprStack("r0",t.args[0])),this.emitLabelledHelper("lambda_call"+e,()=>{this.lambdaCall(e),this.writeFailBranch()})}else if(null!=s.virtualIndex||null!=s.ifaceIndex)null!=s.ifaceIndex?s.isSet?(e.assert(2==t.args.length),this.emitIfaceCall(s,t.args.length,"set")):this.emitIfaceCall(s,t.args.length,s.noArgs?"get":""):this.emitClassCall(s),this.write(d+":");else{let e=s.proc;p=e.seqNo,this.write(this.t.call_lbl(e.label()+(s.isThis?"_nochk":""))),this.write(d+":")}this.calls.push({procIndex:p,stack:0,addr:0,callLabel:d}),o&&t.args[0].isStateless()?this.clearArgs([t.args[0]],t.args.slice(1)):this.clearArgs([],t.args)}lambdaCall(t){this.write("; lambda call"),this.loadVTable(),e.target.switches.skipClassCheck||this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.RefAction)),this.write(`\n                movs r4, #${t}\n                ldrh r1, [r0, #4]\n                cmp r1, #0\n                bne .pushR5\n                ldr r1, [r0, #8]\n                bx r1 ; keep lr from the caller\n            .pushR5:\n                sub sp, #8\n            `);for(let e=0;e<t;++e)this.write(`ldr r1, [sp, #4*${e+2}]`),this.write(`str r1, [sp, #4*${e}]`);this.write(`\n                str r5, [sp, #4*${t}]\n                mov r1, lr\n                str r1, [sp, #4*${t+1}]\n                mov r5, r0\n                ldr r7, [r5, #8]\n                blx r7 ; exec actual lambda\n                ldr r4, [sp, #4*${t+1}] ; restore what was in LR\n                ldr r5, [sp, #4*${t}] ; restore lambda ctx\n            `);for(let e=0;e<t;++e)this.write(`ldr r1, [sp, #4*${e}]`),this.write(`str r1, [sp, #4*${e+2}]`);this.write("\n                add sp, #8\n                bx r4\n            "),this.write("; end lambda call")}emitStore(t,n){switch(t.exprKind){case e.ir.EK.CellRef:let i=t.data;if(this.emitExpr(n),i.isGlobal()){let e=this.bitSizeInfo(i.bitSize),t="#"+i.index;i.index>=e.immLimit&&(this.write(this.t.emit_int(i.index,"r1")),t="r1"),this.write(this.t.load_reg_src_off("r7","r6","#0")),this.write(this.t.load_reg_src_off("r0","r7",t,!1,!0,e))}else{let[e,t,n]=this.cellref(i);this.write(this.t.load_reg_src_off("r0",e,t,n,!0))}break;case e.ir.EK.FieldAccess:this.emitRtCall(e.ir.rtcall("dummy",[t.args[0],n]),()=>this.emitFieldAccess(t,!0));break;default:e.oops()}}cellref(t){if(t.isGlobal())throw e.oops();if(t.iscap){let n=t.index+3;return e.assert(0<=n&&n<32),["r5",n.toString(),!0]}if(t.isarg){return["sp","args@"+t.index.toString()+":"+this.baseStackSize,!1]}return["sp","locals@"+t.index,!1]}emitLambdaWrapper(e){if(this.write(""),this.write(".section code"),this.write(".balign 4"),e&&(this.proc.info.usedAsValue=!0),!this.proc.info.usedAsValue&&!this.proc.info.usedAsIface)return;this.proc.info.usedAsValue&&(this.write(this.proc.label()+"_Lit:"),this.write(this.t.obj_header("pxt::RefAction_vtable")),this.write(".short 0, 0 ; no captured vars"),this.write(`.word ${this.proc.label()}_args@fn`)),this.write(`${this.proc.label()}_args:`);let t=this.proc.args.length;if(0==t)return;this.write(`cmp r4, #${t}`),this.write(`bge ${this.proc.label()}_nochk`);let n=this.stackAlignmentNeeded(t+1),i=n?t+2:t+1;this.write("push {lr}"),this.emitLabelledHelper(`expand_args_${t}`,()=>{this.write("movs r0, #0"),this.write("movs r1, #0"),n&&this.write("push {r0}");for(let e=t;e>0;e--)e!=t&&(this.write(`cmp r4, #${e}`),this.write(`blt .zero${e}`),this.write(`ldr r0, [sp, #${i-1}*4]`),this.write(`str r1, [sp, #${i-1}*4] ; clear existing`),this.write(`.zero${e}:`)),this.write("push {r0}");this.write("bx lr")}),this.write(`bl ${this.proc.label()}_nochk`);let r=t+(n?1:0);this.write(`@dummystack ${r}`),this.write(`add sp, #4*${r}`),this.write("pop {pc}")}emitCallRaw(t){let n=e.hexfile.lookupFunc(t);e.assert(!!n,"unimplemented raw function: "+t),this.alignedCall(t)}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){const t={"numops::adds":"+","numops::subs":"-","numops::div":"/","numops::mod":"%","numops::muls":"*","numops::ands":"&","numops::orrs":"|","numops::eors":"^","numops::bnot":"~","numops::lsls":"<<","numops::asrs":">>","numops::lsrs":">>>","numops::le":"<=","numops::lt":"<","numops::lt_bool":"<","numops::ge":">=","numops::gt":">","numops::eq":"==","pxt::eq_bool":"==","pxt::eqq_bool":"===","numops::eqq":"===","numops::neqq":"!==","numops::neq":"!="},n={"pxsim.Boolean_":"","pxsim.pxtcore":"","pxsim.String_":"","pxsim.ImageMethods":"","pxsim.Array_":"","pxsim.pxtrt":"","pxsim.numops":""},i={"pxsim.Array_.getAt":"","pxsim.Array_.length":"","pxsim.Array_.mk":"","pxsim.Array_.push":"","pxsim.Boolean_.bang":"","pxsim.String_.concat":"","pxsim.String_.stringConv":"","pxsim.numops.toBool":"","pxsim.numops.toBoolDecr":"","pxsim.pxtcore.mkAction":"","pxsim.pxtcore.mkClassInstance":"","pxsim.pxtrt.ldlocRef":"","pxsim.pxtrt.mapGetByString":"","pxsim.pxtrt.stclo":"","pxsim.pxtrt.stlocRef":""};function r(e){let t="";for(let n of Object.keys(e)){const i=n.replace(/\./g,"_");e[n]=i,t+=`const ${i} = ${n};\n`}return t}function s(e){"pxt."==(e=e.replace(/::/g,".")).slice(0,4)&&(e="pxtcore."+e.slice(4));const t="pxsim."+e;if(i.hasOwnProperty(t))return i[t];const r=t.lastIndexOf(".");if(r>0){const e=t.slice(0,r);if(n.hasOwnProperty(e))return n[e]+t.slice(r)}return t}e.isBuiltinSimOp=function(n){return!!e.U.lookup(t,n.replace(/\./g,"::"))},e.shimToJs=s;const o=["runtime","oops","doNothing","pxsim","globals","maybeYield","setupDebugger","isBreakFrame","breakpoint","trace","checkStack","leave","checkResumeConsumed","setupResume","setupLambda","checkSubtype","failedCast","buildResume","mkVTable","bind","leaveAccessor"];e.jsEmit=function(a,l){let c="(function (ectx) {\n'use strict';\n";for(let e of o)c+=`const ${e} = ectx.${e};\n`;c+="const __this = runtime;\n",c+="const pxtrt = pxsim.pxtrt;\n",c+="let yieldSteps = 1;\n",c+="ectx.setupYield(function() { yieldSteps = 100; })\n";let u="pxsim.setTitle("+JSON.stringify(a.getTitle())+");\n",d={},p={};for(let e of l.configData||[])d[e.key+""]=e.value,p[e.name]=e.key;u+="pxsim.setConfigData("+JSON.stringify(d,null,1)+", "+JSON.stringify(p,null,1)+");\n",u+="pxtrt.mapKeyNames = "+JSON.stringify(a.ifaceMembers,null,1)+";\n";const h=a.setPerfCounters(["SysScreen"]);u+="__this.setupPerfCounters("+JSON.stringify(h,null,1)+");\n",u+=r(i),u+=r(n);let f=0,m=0;a.procs.forEach(n=>{let i;if(n.cachedJS){i=n.cachedJS,f+=i.length;for(const e of Object.keys(n.cachedJSHexLiterals))a.hexlits[e]=n.cachedJSHexLiterals[e]}else i=function(n,i){if(i.cachedJS)return i.cachedJS;let r="",o=e=>{r+=e+"\n"},a=e=>{r+="    "+e+"\n"},l=e.ir.EK,c=[],u=0,d={};o(`\nfunction ${i.label()}(s) {\nlet r0 = s.r0, step = s.pc;\ns.pc = -1;\n`),i.perfCounterNo&&o(`if (step == 0) __this.startPerfCounter(${i.perfCounterNo});\n`);o("\nwhile (true) {\nif (yieldSteps-- < 0 && maybeYield(s, step, r0) || runtime !== pxsim.runtime) return null;\nswitch (step) {\n  case 0:\n"),i.locals.forEach(e=>{a(`${y(e)} = undefined;`)}),i.args.length&&(a("if (s.lambdaArgs) {"),i.args.forEach((e,t)=>{a(`  ${y(e)} = (s.lambdaArgs[${t}]);`)}),a("  s.lambdaArgs = null;"),a("}"));i.classInfo&&i.info.thisParameter&&(a("r0 = s.arg0;"),C(i.classInfo,"validate"));let p=0,h=[];for(let t of i.body)t.stmtKind==e.ir.SK.Label&&t.lblNumUses>0&&(t.lblId=++p);let f=0;for(let t of i.body){switch(t.stmtKind){case e.ir.SK.Expr:x(t.expr);break;case e.ir.SK.StackEmpty:O();break;case e.ir.SK.Jmp:let n=!1;for(let r=f+1;r<i.body.length&&i.body[r].stmtKind==e.ir.SK.Label;++r)if(t.lbl==i.body[r]){n=!0;break}b(t,n);break;case e.ir.SK.Label:t.lblNumUses>0&&o(`  case ${t.lblId}:`);break;case e.ir.SK.Comment:o(`// ${t.expr.data}`);break;case e.ir.SK.Breakpoint:_(t);break;default:e.oops()}f++}O(),i.perfCounterNo&&o(`__this.stopPerfCounter(${i.perfCounterNo});\n`);i.isGetter()?a("return leaveAccessor(s, r0)"):a("return leave(s, r0)");o("  default: oops()"),o("} } }");let m=e.nodeLocationInfo(i.action);m.functionName=i.getName(),m.argumentNames=i.args&&i.args.map(e=>e.getName()),o(`${i.label()}.info = ${JSON.stringify(m)}`),i.isGetter()&&o(`${i.label()}.isGetter = true;`);i.isRoot&&o(`${i.label()}.continuations = [ ${h.join(",")} ]`);return o(g(i.label()+"_mk",i.label(),u,Object.keys(d))),i.cachedJS=r,r;function g(e,t,n,i){let r="";r+=`\nfunction ${e}(s) {\n    checkStack(s.depth);\n    return {\n        parent: s, fn: ${t}, depth: s.depth + 1,\n        pc: 0, retval: undefined, r0: undefined, overwrittenPC: false, lambdaArgs: null,\n`;for(let e=0;e<n;++e)r+=`  tmp_${e}: undefined,\n`;for(let e of i)r+=`  ${e}: undefined,\n`;return r+="} }\n",r}function _(e){let t,r=e.breakpointInfo.id;if(a(`s.lastBrkId = ${r};`),n.breakpoints){t=++p;let s=`return breakpoint(s, ${t}, ${r}, r0);`;e.breakpointInfo.isDebuggerStmt?a(s):(a(`if ((breakpoints[0] && isBreakFrame(s)) || breakpoints[${r}]) ${s}`),n.trace&&a(`else return trace(${r}, s, ${t}, ${i.label()}.info);`))}else{if(!n.trace)return;t=++p,a(`return trace(${r}, s, ${t}, ${i.label()}.info);`)}o(`  case ${t}:`)}function y(e){if(e.isGlobal())return"globals."+e.uniqueName();if(e.iscap)return`s.caps[${e.index}]`;const t=e.uniqueName();return d[t]=!0,"s."+t}function b(t,n){if(t.lbl.lblNumUses==e.ir.lblNumUsesJmpNext||n)return e.assert(t.jmpMode==e.ir.JmpMode.Always),void(t.expr&&x(t.expr));e.assert(t.lbl.lblNumUses>0);let i=`{ step = ${t.lbl.lblId}; continue; }`;t.jmpMode==e.ir.JmpMode.Always?(t.expr&&x(t.expr),a(i)):(x(t.expr),t.jmpMode==e.ir.JmpMode.IfNotZero?a(`if (r0) ${i}`):a(`if (!r0) ${i}`))}function v(e){switch(e.exprKind){case l.NumberLiteral:case l.PointerLiteral:case l.SharedRef:case l.CellRef:return!0;default:return!1}}function T(e){return v(e)?k(e):(x(e),"r0")}function k(t){switch(t.exprKind){case l.NumberLiteral:if(!0===t.data)return"true";if(!1===t.data)return"false";if(null===t.data)return"null";if(void 0===t.data)return"undefined";if("number"==typeof t.data)return t.data+"";if("string"==typeof t.data)return`"${t.data}"`;throw e.oops("invalid data: "+typeof t.data);case l.PointerLiteral:if(t.ptrlabel())return t.ptrlabel().lblId+"";if(null!=t.hexlit()){const e=`const ${t.data} = pxsim.BufferMethods.createBufferFromHex("${t.hexlit()}")\n`;return i.cachedJSHexLiterals[t.data]=e,n.hexlits[t.data]=e,t.data}if("string"==typeof t.jsInfo)return t.jsInfo;e.U.oops();case l.SharedRef:let r=t.args[0];e.U.assert(!!r.currUses),e.U.assert(r.currUses<r.totalUses),r.currUses++;let s=c.indexOf(r);return e.U.assert(s>=0),"s.tmp_"+s;case l.CellRef:return y(t.data);default:throw e.oops()}}function x(e){switch(e.exprKind){case l.JmpValue:a("// jmp value (already in r0)");break;case l.Nop:a("// nop");break;case l.FieldAccess:let t=e.data,n=t.shimName,i=T(e.args[0]);return n?void a(`r0 = ${i}${n};`):void a(`r0 = ${i}.fields["${t.name}"];`);case l.Store:return D(e.args[0],e.args[1]);case l.RuntimeCall:return I(e);case l.ProcCall:return A(e);case l.SharedDef:return w(e);case l.Sequence:return e.args.forEach(x);case l.InstanceOf:return x(e.args[0]),void C(e.data,e.jsInfo);default:a(`r0 = ${k(e)};`)}}function E(e){return`${e.id}_VT`}function S(e,t="r0"){return`checkSubtype(${t}, ${E(e)})`}function C(t,n,i="r0"){"bool"==n?a(`r0 = ${S(t)};`):"validate"==n?a(`if (!${S(t,i)}) failedCast(${i}, ${E(t)});`):e.U.oops()}function w(t){let n=t.args[0];if(e.U.assert(n.totalUses>=1),e.U.assert(0===n.currUses),n.currUses=1,1==n.totalUses)return x(n);{const e=c.length;c.push(n);let t=T(n);"r0"!=t&&(t="r0 = "+t),a(`s.tmp_${e} = ${t};`)}}function I(n){let i=e.ir.flattenArgs(n.args);i.precomp.forEach(x);let r=n.data,l=i.flattened.map(k);if("langsupp::ignore"==r)return;let c="";if(c="."==r[0]?`${l[0]}${r}(${l.slice(1).join(", ")})`:"="==r[0]?`(${l[0]})${r.slice(1)} = (${l[1]})`:e.U.startsWith(r,"new ")?`new ${s(r.slice(4))}(${l.join(", ")})`:e.U.lookup(t,r)?2==l.length?`(${l[0]} ${e.U.lookup(t,r)} ${l[1]})`:`(${e.U.lookup(t,r)} ${l[0]})`:`${s(r)}(${l.join(", ")})`,0==n.callingConvention)a(`r0 = ${c};`);else{let e=++p;h.push(e),"String_::stringConv"==r&&a(`if ((${l[0]}) && (${l[0]}).vtable) {`),2==n.callingConvention?a(`(function(cb) { ${c}.then(cb) })(buildResume(s, ${e}));`):(a(`setupResume(s, ${e});`),a(`${c};`)),a("checkResumeConsumed();"),a("return;"),"String_::stringConv"==r&&a(`} else { s.retval = (${l[0]}) + ""; }`),o(`  case ${e}:`),a("r0 = s.retval;")}}function A(t){const r=t.data,s=r.proc;if(s&&s.inlineBody)return x(s.inlineSelf(t.args));const l=e.ir.rtcall("<frame>",[]);l.totalUses=1,l.currUses=0;const u=c.length;c.push(l);const d=`s.tmp_${u}`,h=++p,f=-1==r.virtualIndex;if(s)a(`${d} = ${s.label()}_mk(s);`);else{let s="generic";null!=r.ifaceIndex?s="if_"+n.ifaceMembers[r.ifaceIndex]:f?s="lambda":null!=r.virtualIndex?s=r.classInfo.id+"_v"+r.virtualIndex:e.U.oops();const o=t.args.length;s+="_"+o+"_mk",n.recordHelper(i.usingCtx,s,()=>{const t=e.U.range(o).map(e=>"arg"+e);return g(s,"null",5,t)}),a(`${d} = ${s}(s);`)}t.args.forEach((e,t)=>{let n=`arg${t}`;f&&(n=0==t?"argL":"arg"+(t-1)),a(`${d}.${n} = ${T(e)};`)});let m=`s.pc = ${h}; return ${d};`;if(null!=r.callLocationIndex&&(m=`s.callLocIdx = ${r.callLocationIndex}; ${m}`),null!=r.ifaceIndex){e.U.assert(null==s);const i=n.ifaceMembers[r.ifaceIndex];e.U.assert(!!i,`no name for ${r.ifaceIndex}`),a(`if (!${d}.arg0.vtable.iface) {`);let o=t.args.map((e,t)=>`${d}.arg${t}`);o.splice(1,0,JSON.stringify(i));const l=`pxsim_pxtrt.map${r.isSet?"Set":"Get"}ByString`;r.noArgs?a(`  s.retval = ${l}(${o.join(", ")});`):(e.U.assert(!r.isSet),a(`  setupLambda(${d}, ${l}(${o.slice(0,2).join(", ")}), ${t.args.length});`),a(`  ${m}`)),a("} else {"),a(`  ${d}.fn = ${d}.arg0.vtable.iface["${r.isSet?"set/":""}${i}"];`);let c=`${d}.arg0.fields["${i}"]`;r.isSet?(a(`  if (${d}.fn === null) { ${c} = ${d}.arg1; }`),a(`  else if (${d}.fn === undefined) { failedCast(${d}.arg0) } `)):r.noArgs?(a(`  if (${d}.fn == null) { s.retval = ${c}; }`),a(`  else if (!${d}.fn.isGetter) { s.retval = bind(${d}); }`)):(a(`  if (${d}.fn == null) { setupLambda(${d}, ${c}, ${t.args.length}); ${m} }`),a(`  else if (${d}.fn.isGetter) { ${d}.stage2Call = true; ${m}; }`)),a(` else { ${m} }`),a("}"),m=""}else if(-1==r.virtualIndex)e.U.assert(null==s),a(`setupLambda(${d}, ${d}.argL);`);else if(null!=r.virtualIndex){e.U.assert(null==s),e.assert(r.virtualIndex>=0),C(r.classInfo,"validate",d+".arg0");const t=r.classInfo.vtable[r.virtualIndex];a(`${d}.fn = ${d}.arg0.vtable.methods.${t.getName()};`)}else e.U.assert(null!=s);m&&a(m),o(`  case ${h}:`),a("r0 = s.retval;"),l.currUses=1}function N(t){switch(t){case 0:return"";case 1:return"pxtrt.toInt8";case 3:return"pxtrt.toInt16";case 5:return"pxtrt.toInt32";case 2:return"pxtrt.toUInt8";case 4:return"pxtrt.toUInt16";case 6:return"pxtrt.toUInt32";default:throw e.oops()}}function D(t,n){switch(t.exprKind){case l.CellRef:let i=t.data,r=T(n);a(`${y(i)} = ${N(i.bitSize)}(${r});`);break;case l.FieldAccess:let s=t.data,o=s.shimName;o||(o=`.fields["${s.name}"]`),x(e.ir.rtcall("="+o,[t.args[0],n]));break;default:e.oops()}}function O(){for(let t of c)t.totalUses!==t.currUses&&e.oops();u=Math.max(c.length,u),c=[]}}(a,n),m+=i.length;u+="\n"+i+"\n"}),u+=e.U.values(a.codeHelpers).join("\n")+"\n",a.usedClassInfos.forEach(t=>{u+=function(t){e.U.assert(void 0!==t.classNo),e.U.assert(void 0!==t.lastSubtypeNo);let n=parseInt(t.attrs.maxBgInstances);n||(n=null);let i=`const ${t.id}_VT = mkVTable({\n  name: ${JSON.stringify(e.getName(t.decl))},\n  numFields: ${t.allfields.length},\n  classNo: ${t.classNo},\n  lastSubtypeNo: ${t.lastSubtypeNo},\n  maxBgInstances: ${n},\n  methods: {\n`;for(let e of t.vtable)i+=`    "${e.getName()}": ${e.label()},\n`;i+="  },\n",i+="  iface: {\n";for(let e of t.itable)i+=`    "${e.name}": ${e.proc?e.proc.label():"null"},\n`,e.setProc?i+=`    "set/${e.name}": ${e.setProc.label()},\n`:e.proc||(i+=`    "set/${e.name}": null,\n`);return i+="  },\n",t.toStringMethod&&(i+="  toStringMethod: "+t.toStringMethod.label()+",\n"),i+="});\n",i}(t)}),l.breakpoints&&(u+=`\nconst breakpoints = setupDebugger(${l.breakpoints.length}, [${a.globals.filter(e=>e.isUserVariable).map(e=>`"${e.uniqueName()}"`).join(",")}])\n`),u+=`\nreturn ${a.procs[0]?a.procs[0].label():"null"}\n})\n`;for(const e of Object.keys(a.hexlits))c+=a.hexlits[e];u=c+u;const g=u.length,_=e=>(100*e/g).toFixed(2)+"%",y=`// total=${u.length} new=${_(m)} cached=${_(f)} other=${_(g-m-f)}\n`;a.writeFile(e.BINARY_JS,y+u)}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){e.thumbCmpMap={"numops::lt":"_cmp_lt","numops::gt":"_cmp_gt","numops::le":"_cmp_le","numops::ge":"_cmp_ge","numops::eq":"_cmp_eq","numops::eqq":"_cmp_eqq","numops::neq":"_cmp_neq","numops::neqq":"_cmp_neqq"};const t={"numops::adds":"_numops_adds","numops::subs":"_numops_subs","numops::orrs":"_numops_orrs","numops::eors":"_numops_eors","numops::ands":"_numops_ands","numops::lsls":"_numops_lsls","numops::asrs":"_numops_asrs","numops::lsrs":"_numops_lsrs","pxt::toInt":"_numops_toInt","pxt::fromInt":"_numops_fromInt"};class n extends e.AssemblerSnippets{stackAligned(){return e.target.stackAlign&&e.target.stackAlign>1}pushLR(){return this.stackAligned()?"push {lr, r5}  ; r5 for align":"push {lr}"}popPC(){return this.stackAligned()?"pop {pc, r5}  ; r5 for align":"pop {pc}"}nop(){return"nop"}mov(e,t){return`mov ${e}, ${t}`}helper_ret(){return"bx r4"}reg_gets_imm(e,t){return`movs ${e}, #${t}`}push_fixed(e){return"push {"+e.join(", ")+"}"}pop_fixed(e){return"pop {"+e.join(", ")+"}"}proc_setup(e,t){let n="";if(e>0){n+="    movs r0, #0\n";for(let t=0;t<e;++t)n+="    push {r0} ;loc\n"}return n}proc_return(){return"pop {pc}"}debugger_stmt(t){return e.oops(),`\n    @stackempty locals\n    ldr r0, [r6, #0] ; debugger\n    subs r0, r0, #4  ; debugger\n${t}:\n    ldr r0, [r0, #0] ; debugger\n`}debugger_bkpt(t){return e.oops(),`\n    @stackempty locals\n    ldr r0, [r6, #0] ; brk\n${t}:\n    ldr r0, [r0, #0] ; brk\n`}debugger_proc(t){return e.oops(),`\n    ldr r0, [r6, #0]  ; brk-entry\n    ldr r0, [r0, #4]  ; brk-entry\n${t}:`}push_local(e){return`push {${e}}`}push_locals(e){return`sub sp, #4*${e} ; push locals ${e} (align)`}pop_locals(e){return`add sp, #4*${e} ; pop locals ${e}`}unconditional_branch(e){return"bb "+e}beq(e){return"beq "+e}bne(e){return"bne "+e}cmp(e,t){return"cmp "+e+", "+t}cmp_zero(e){return"cmp "+e+", #0"}load_reg_src_off(e,t,n,i,r,s){n=n.replace(/:\d+$/,""),i&&(n=`#4*${n}`);let o="str",a="ldr";return s&&(32==s.immLimit?o="strb":64==s.immLimit&&(o="strh"),a=s.needsSignExt?o.replace("str","ldrs"):o.replace("str","ldr")),r?`${o} ${e}, [${t}, ${n}]`:`${a} ${e}, [${t}, ${n}]`}rt_call(e,t,n){return e+" "+t+", "+n}alignedCall(e,t){return t?`${this.push_locals(t)}\nbl ${e}\n${this.pop_locals(t)}`:"bl "+e}call_lbl(n,i,r){let s=e.U.lookup(t,n);return s&&(n=s,i=!1),!i&&n.indexOf("::")>0&&(i=!0),i?this.callCPP(n,r):this.alignedCall(n,r)}call_reg(e){return"blx "+e}helper_prologue(){return`\n    @stackmark args\n    ${this.pushLR()}\n`}helper_epilogue(){return`\n    ${this.popPC()}\n    @stackempty args\n`}load_ptr_full(t,n){return e.assert(!!t),`\n    ldlit ${n}, ${t}\n`}load_vtable(e,t){return`ldr ${e}, [${t}, #0]`}lambda_init(){return"\n    mov r5, r0\n    mov r4, lr\n    bl pxtrt::getGlobalsPtr\n    mov r6, r0\n    bx r4\n"}saveThreadStack(){return"mov r7, sp\n    str r7, [r6, #4]\n"}restoreThreadStack(){return e.target.switches.gcDebug?"movs r7, #0\n    str r7, [r6, #4]\n":""}callCPPPush(e){return this.pushLR()+"\n"+this.callCPP(e)+"\n"+this.popPC()+"\n"}callCPP(e,t){return this.saveThreadStack()+this.alignedCall(e,t)+"\n"+this.restoreThreadStack()}inline_decr(e){return`\n    lsls r1, r0, #30\n    bne .tag${e}\n    bl _pxt_decr\n.tag${e}:\n`}arithmetic(){let t="";const n=e=>{let t=".boxed:\n";return t+=`\n                    ${this.pushLR()}\n                    push {r0, r1}\n                    ${this.saveThreadStack()}\n                    ${e}\n                    ${this.restoreThreadStack()}\n                    add sp, #8\n                    ${this.popPC()}\n                `,t},i=e=>{t+=`\n_numops_${e}:\n    @scope _numops_${e}\n    lsls r2, r0, #31\n    beq .boxed\n    lsls r2, r1, #31\n    beq .boxed\n`},r=e=>{t+="    blx lr\n",t+=n(`bl numops::${e}`)};for(let e of["adds","subs"])i(e),t+=`\n    subs r2, r1, #1\n    ${e} r2, r0, r2\n    bvs .boxed\n    movs r0, r2\n`,r(e);for(let e of["ands","orrs","eors"])i(e),t+=`    ${e} r0, r1\n`,"eors"==e&&(t+="    adds r0, r0, #1\n"),r(e);for(let e of["lsls","lsrs","asrs"])i(e),t+="\n    ; r3 := (r1 >> 1) & 0x1f\n    lsls r3, r1, #26\n    lsrs r3, r3, #27\n","asrs"==e?t+="\n    asrs r0, r3\n    movs r2, #1\n    orrs r0, r2\n":(t+="lsrs"==e?"\n    asrs r2, r0, #1\n    lsrs r2, r3\n    lsrs r3, r2, #30\n    bne .boxed\n":"\n    asrs r2, r0, #1\n    lsls r2, r3\n    lsrs r3, r2, #30\n    beq .ok\n    cmp r3, #3\n    bne .boxed\n.ok:\n",t+="\n    lsls r0, r2, #1\n    adds r0, r0, #1\n"),r(e);t+=`\n@scope _numops_toInt\n_numops_toInt:\n    asrs r0, r0, #1\n    bcc .over\n    blx lr\n.over:\n    lsls r0, r0, #1\n    ${this.callCPPPush("pxt::toInt")}\n\n_numops_fromInt:\n    lsls r2, r0, #1\n    asrs r1, r2, #1\n    cmp r0, r1\n    bne .over2\n    adds r0, r2, #1\n    blx lr\n.over2:\n    ${this.callCPPPush("pxt::fromInt")}\n`;for(let i of Object.keys(e.thumbCmpMap))i=i.replace(/.*::/,""),t+=`\n.section code\n.object _pxt_helper_cmp_${i}\n_cmp_${i}:\n    lsls r2, r0, #31\n    beq .boxed\n    lsls r2, r1, #31\n    beq .boxed\n    subs r0, r1\n    b${i.replace("qq","q").replace("neq","ne")} .true\n.false:\n    movs r0, #0\n    bx lr\n.true:\n    movs r0, #1\n    bx lr\n`,t+=n(`\n                        bl numops::${i}\n                        bl numops::toBoolDecr\n                        cmp r0, #0`);return t}emit_int(t,n){let i=!1;function r(t){e.assert(0<=t&&t<=255);let r="";return i?t&&(r=`adds ${n}, #${t}\n`):r=`movs ${n}, #${t}\n`,i=!0,r}function s(e=8){return`lsls ${n}, ${n}, #${e}\n`}e.assert(null!=t);let o=Math.floor(t),a=!1;o<0&&(a=!0,o=-o);let l=0;if(o>255){let t=o;for(;!(1&t);)t>>>=1,l++;e.numBytes(t)<e.numBytes(o)?o=t:l=0}let c="";switch(e.numBytes(o)){case 4:c+=r(o>>>24&255),c+=s();case 3:c+=r(o>>>16&255),c+=s();case 2:c+=r(o>>>8&255),c+=s();case 1:c+=r(255&o);break;default:e.oops()}return l&&(c+=s(l)),a&&(c+=`negs ${n}, ${n}\n`),c.split("\n").length>4?`ldlit ${n}, ${Math.floor(t)}\n`:c}}e.ThumbSnippets=n}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){const n={"pxtrt::mapSetGeneric":"mapset","pxtrt::mapGetGeneric":"mapget"},i={};function r(e,n,i){const r=t.computeHashMultiplier(e.itable.map(e=>e.idx)),s=t.U.toArray(r.mapping);for(;3&s.length;)s.push(0);let o=`\n${l(e)}_start:\n        .short ${8*e.allfields.length+8}  ; size in bytes\n        .byte ${pxt.ValTypeObject}, ${pxt.VTABLE_MAGIC} ; magic\n        .short ${s.length} ; entries in iface hashmap\n        .short ${e.lastSubtypeNo||e.classNo} ; last sub class-id\n        .short ${e.classNo} ; class-id\n        .short 0 ; reserved\n        .word ${r.mult} ; hash-mult\n`;c()?o+="\n            .word pxt::RefRecord_destroy\n            .word pxt::RefRecord_print\n            .word pxt::RefRecord_scan\n            .word pxt::RefRecord_gcsize\n            .word 0,0,0,0 ; keep in sync with VM_NUM_CPP_METHODS\n":o+="\n            .word 0,0, 0,0, 0,0, 0,0 ; space for 4 (VM_NUM_CPP_METHODS) native methods\n",o+=`\n        .balign 4\n${e.id}_IfaceVT:\n`;const a=s.length>>2;let u="",d=a,p={};for(let t of e.itable){p[t.idx+""]=d;const e=t.proc?t.proc.isGetter()?1:2:0;u+=`  .short ${t.idx}, ${e} ; ${t.name}\n`,u+=`  .word ${t.proc?t.proc.vtLabel()+"@fn":t.info}\n`,d+=1,t.setProc&&(u+=`  .short ${t.idx}, 2 ; set ${t.name}\n`,u+=`  .word ${t.setProc.vtLabel()}@fn\n`,d+=1)}u+="  .word 0, 0, 0, 0 ; the end\n",d+=1;for(let e=0;e<s.length;++e)i.itEntries++,s[e]&&i.itFullEntries++;return o+="  .short "+t.U.toArray(s).map((e,t)=>p[e+""]||a).join(", ")+"\n",o+=u,o+="\n",o}let s;function o(e){const t=e.getTime()/1e3;return`${t>>>0}, ${t/4294967296|0}`}!function(e){e[e.Invalid=0]="Invalid",e[e.InfoHeader=1]="InfoHeader",e[e.OpCodeMap=2]="OpCodeMap",e[e.NumberLiterals=3]="NumberLiterals",e[e.ConfigData=4]="ConfigData",e[e.IfaceMemberNames=5]="IfaceMemberNames",e[e.NumberBoxes=6]="NumberBoxes",e[e.Function=32]="Function",e[e.Literal=33]="Literal",e[e.VTable=34]="VTable"}(s||(s={}));let a={};function l(e){return e.classNo||(a[e.id]=e),e.id+"_VT"}function c(){return t.target.useESP}function u(e){return c()?`0xffffffff, ${e}`:`0xffffffff, 0xffffffff ; -> ${e}`}t.vmEmit=function(d,p,h){let f=`; VM start\n_img_start:\n${t.hexfile.hexPrelude()}\n`;a={};const m={dblText:[],dblBoxText:[],dbls:{},opcodeMap:{},opcodes:t.vm.opcodes.map(e=>"pxt::op_"+e.replace(/ .*/,""))};for(m.opcodes.unshift(null);m.opcodes.length<128;)m.opcodes.push(null);let g=0;function _(e,t,n,i,r=0){if(f+=`\n; --- ${e}\n.section code\n    .set ${e} = ${g}\n`,i)for(let e of i)f+=`    .set ${e} = ${g}\n`;f+=`\n_start_${e}:\n    .byte ${t}, 0x00\n    .short ${r}\n    .word _end_${e}-_start_${e}\n`,f+=n(),f+=`\n.balign 8\n_end_${e}:\n`,g++}const y=new Date(0);let b=t.U.toUTF8(p.name,!0);b.length>100&&(b=b.slice(0,100));let v=b.length+1;1&v&&v++;const T=128-v;_("_info",s.InfoHeader,()=>`\n                ; magic - \\0 added by assembler\n                .string "\\nPXT64\\n"\n                .hex 5471fe2b5e213768 ; magic\n                .hex ${t.hexfile.hexTemplateHash()} ; hex template hash\n                .hex 0000000000000000 ; @SRCHASH@\n                .word ${d.globalsWords}   ; num. globals\n                .word ${d.nonPtrGlobals} ; non-ptr globals\n                .word 0, 0 ; last usage time\n                .word ${o(y)} ; installation time\n                .word ${o(y)} ; publication time - TODO\n                .word _img_end-_img_start ; total image size\n                .space 60 ; reserved\n                .string ${JSON.stringify(b)}\n                .space ${T} ; pad to 128 bytes\n`),d.procs.forEach(e=>{_(e.label(),s.Function,()=>function(e,r,s){let o="";const a=e=>{o+=e+"\n"},d=e=>{o+="    "+e+"\n"},p=t.ir.EK;let h=[],f=[],m=!1,g=0,_=0;const y=8388607;pxt.options.debug&&pxt.log("EMIT",s.toString());b(),o="";for(let e of h)e.reset();return m=!0,t.U.assert(0==_),b(),o;function b(){a(`;\n; ${s.getFullName()}\n;`),d(".section code"),r.procs[0]==s&&a("; main"),d(`.word ${u("pxt::RefAction_vtable")}`),d(`.short 0, ${s.args.length} ; #args`),d(`.short ${s.captured.length}, 0 ; #cap`),d(".word .fnstart-_img_start, 0  ; func+possible padding"),g=s.locals.length+f.length,d(".fnstart:"),d(`pushmany ${g} ; incl. ${f.length} tmps`);for(let e of s.body)switch(e.stmtKind){case t.ir.SK.Expr:S(e.expr);break;case t.ir.SK.StackEmpty:A();for(let e of f)e&&t.oops(`uses: ${e.currUses}/${e.totalUses} ${e.toString()}`);break;case t.ir.SK.Jmp:v(e);break;case t.ir.SK.Label:a(`${e.lblName}:`);break;case t.ir.SK.Comment:a(`; ${e.expr.data}`);break;case t.ir.SK.Breakpoint:break;default:t.oops()}d(`ret ${s.args.length}, ${g}`)}function v(e){let n=e.lbl.lblName;e.jmpMode==t.ir.JmpMode.Always?(e.expr&&S(e.expr),d(`jmp ${n}`)):(S(e.expr),e.jmpMode==t.ir.JmpMode.IfNotZero?d(`jmpnz ${n}`):e.jmpMode==t.ir.JmpMode.IfZero?d(`jmpz ${n}`):t.oops())}function T(e){if(e.isGlobal())return t.U.assert(!(3&e.index)),"glb "+(e.index>>2)+` ; ${e.getName()}`;if(e.iscap)return"cap "+e.index+` ; ${e.getName()}`;if(e.isarg){let n=s.args.length-e.index-1;return t.assert(n>=0,"arg#"+n),`loc ${_+g+2+n} ; ${e.getName()}`}{let n=e.index+f.length;return t.assert(!m||n<g,"cell#"+n),t.assert(n>=0,"cell#"+n),`loc ${_+n}`}}function k(n){const i=t.hexfile.lookupFunc(n);i||t.U.oops("missing function: "+n);let r=e.opcodeMap[i.name];null==r&&(r=e.opcodes.length,e.opcodes.push(i.name),e.opcodeMap[i.name]=r,i.value=r),d(`callrt ${n}`)}function x(e,n){"bool"==n?d(`checkinst ${l(e)}`):t.U.oops()}function E(n){switch(n.exprKind){case p.NumberLiteral:const i=t.taggedSpecial(n.data);if(null!=i)d(`ldspecial ${i} ; ${n.data}`);else{let i=n.data,r=0,s=0;const o=i<<1>>1!=i;if((0|i)==i){if(Math.abs(i)<=y)return void d(i<0?"ldintneg "+-i:`ldint ${i}`);r=(i<<1|1)>>>0,s=i<0?1:0}else{let e=new Float64Array(1);e[0]=i;let t=new Uint32Array(e.buffer);t[1]+=65536,r=t[0],s=t[1]}let a=r+","+s,l=t.U.lookup(e.dbls,a);if(null==l){if(l=e.dblText.length,e.dblText.push(`.word ${r}, ${s}  ; ${l}: ${n.data}`),o){const t="pxt::number_vt";e.dblBoxText.push(`.word ${c()?t:`0xffffffff ; ${t}`}\n`);let n=new Float64Array(1);n[0]=i;let r=new Uint32Array(n.buffer);e.dblBoxText.push(`.word ${r[0]}, ${r[1]} ; ${i}\n`)}e.dbls[a]=l}d(`ldnumber ${l} ; ${n.data}`)}return;case p.PointerLiteral:return void d(`ldlit ${n.data}`);case p.SharedRef:let r=n.args[0];(!r.currUses||r.currUses>=r.totalUses)&&(pxt.log(r.sharingInfo()),t.U.assert(!1)),r.currUses++;let s=f.indexOf(r);return s<0&&(pxt.log(f,r),t.assert(!1)),d(`ldloc ${s+_}`+(r.currUses==r.totalUses?" ; LAST":"")),void A();case p.CellRef:return void d("ld"+T(n.data));case p.InstanceOf:S(n.args[0]),x(n.data,n.jsInfo);break;default:throw t.oops("kind: "+n.exprKind)}}function S(e){switch(e.exprKind){case p.JmpValue:d("; jmp value (already in r0)");break;case p.Nop:d("; nop");break;case p.FieldAccess:let t=e.data;S(e.args[0]),d(`ldfld ${t.idx}, ${l(t.classInfo)}`);break;case p.Store:return D(e.args[0],e.args[1]);case p.RuntimeCall:return I(e);case p.ProcCall:return N(e);case p.SharedDef:return C(e);case p.Sequence:return e.args.forEach(S);default:return E(e)}}function C(e){let n=e.args[0];if(t.U.assert(n.totalUses>=1),t.U.assert(0===n.currUses),n.currUses=1,h.push(n),1==n.totalUses)return S(n);{S(n);let e=-1;for(let t=0;t<f.length;++t)if(null==f[t]){e=t;break}e<0?(m&&(pxt.log(n,f),t.assert(!1,"missed tmp")),e=f.length,f.push(n)):f[e]=n,d(`stloc ${e+_}`)}}function w(){d("push"),_++}function I(e){let r=e.data;if("pxt::beginTry"==r)return void d(`try ${e.args[0].data}`);r=t.U.lookup(i,r)||r,A();let s=t.U.lookup(n,r),o=e.args,a=0;if("pxt::mkClassInstance"!=r){for(let e=0;e<o.length;++e)S(o[e]),e<o.length-1&&(w(),a++);"langsupp::ignore"==r?a&&d(`popmany ${a} ; ignore`):s?d(s):k(r),_-=a}else d(`newobj ${o[0].data}`)}function A(){for(let e=0;e<f.length;++e){let t=f[e];t&&t.currUses==t.totalUses&&(m||h.push(t),f[e]=null)}}function N(e){let n=e.data,i=n.proc;if(i&&i.inlineBody){const t=i.inlineSelf(e.args);return pxt.options.debug&&pxt.log("INLINE",e.toString(),"->",t.toString()),S(t)}let s=0;const o=e.args.slice(),a=-1==n.virtualIndex?o.shift():null;for(let e of o)S(e),w(),s++;let l=o.length;if(a)S(a),d(`callind ${l}`);else if(null!=n.ifaceIndex){let e=n.ifaceIndex+" ; ."+r.ifaceMembers[n.ifaceIndex];n.isSet?(d(`callset ${e}`),t.U.assert(2==l)):n.noArgs?(d(`callget ${e}`),t.U.assert(1==l)):d(`calliface ${l}, ${e}`)}else null!=n.virtualIndex?t.U.oops():d(`callproc ${i.label()}`);_-=s}function D(e,n){switch(e.exprKind){case p.CellRef:S(n);let i=e.data,r="st"+T(i);if(i.isGlobal()&&0!=i.bitSize){const e=t.sizeOfBitSize(i.bitSize)|(t.isBitSizeSigned(i.bitSize)?16:0);d("bitconv "+e)}d(r);break;case p.FieldAccess:let s=e.data;S(e.args[0]),w(),S(n),d(`stfld ${s.idx}, ${l(s.classInfo)}`),_--;break;default:t.oops()}}}(m,d,e),[e.label()+"_Lit"])}),f+="_code_end:\n\n",f+="_helpers_end:\n\n",d.usedClassInfos.forEach(e=>{_(l(e),s.VTable,()=>r(e,0,d))}),t.U.values(a).forEach(e=>{e.itable=[],e.classNo=65520,_(l(e),s.VTable,()=>r(e,0,d))}),a={};let k=0;_("ifaceMemberNames",s.IfaceMemberNames,()=>`    .word ${d.ifaceMembers.length} ; num. entries\n`+d.ifaceMembers.map(e=>`    .word ${d.emitString(e)}  ; ${k++} .${e}`).join("\n")),f+="_vtables_end:\n\n",t.U.iterMap(d.hexlits,(e,n)=>{_(n,s.Literal,()=>`.word ${u("pxt::buffer_vt")}\n`+t.hexLiteralAsm(e),[],pxt.BuiltInType.BoxedBuffer)});t.U.unique(d.ifaceMembers.concat(Object.keys(d.strings)),e=>e).forEach(e=>{const n=t.utf8AsmStringLiteral(e);let i=pxt.BuiltInType.BoxedString;"pxt::string_inline_ascii_vt"==n.vt?i=pxt.BuiltInType.BoxedString_ASCII:"pxt::string_skiplist16_packed_vt"==n.vt?i=pxt.BuiltInType.BoxedString_SkipList:"pxt::string_inline_utf8_vt"==n.vt?i=pxt.BuiltInType.BoxedString:t.oops("invalid vt");const r=`.word ${u(n.vt)}\n`+n.asm;_(d.strings[e],s.Literal,()=>r,[],i)}),_("numberBoxes",s.NumberBoxes,()=>m.dblBoxText.join("\n")+"\n.word 0, 0, 0 ; dummy entry to make sure not empty"),_("numberLiterals",s.NumberLiterals,()=>m.dblText.join("\n")+"\n.word 0, 0 ; dummy entry to make sure not empty");const x=h.configData||[];_("configData",s.ConfigData,()=>x.map(e=>`    .word ${e.key}, ${e.value}  ; ${e.name}=${e.value}`).join("\n")+"\n    .word 0, 0");let E=m.opcodes.map(e=>null==e?"":e).join("\0")+"\0",S="";for(;E;){let e=E.slice(0,64);E=E.slice(64),1&e.length&&(e+="\0"),S+=".hex "+t.U.toHex(t.U.stringToUint8Array(e))+"\n"}_("opcodeMap",s.OpCodeMap,()=>S),f+="_literals_end:\n",f+="_img_end:\n",f+="\n; The end.\n",d.writeFile(t.BINARY_ASM,f);let C=t.assemble(p.target,d,f,h);const w=C.thumbFile.getSourceMap(),I=function(e){const n=[83,82,67,77,136,21,78,45,170,134,153,113,0,0,0,0];for(const i of Object.keys(e)){for(const e of t.U.stringToUint8Array(i))n.push(e);n.push(0);const s=e[i];let o=0,a=0;for(let e=0;e<s.length;e+=3)r(s[e]-o),r(s[e+1]-a>>1),r(s[e+2]>>1),o=s[e],a=s[e+1];n.push(255)}n.push(0),1&n.length&&n.push(0);const i=[];for(let e=0;e<n.length;e+=2)i.push(n[e]|n[e+1]<<8);return i;function r(e){if(0<=e&&e<240)n.push(e);else{let t=240;e<0&&(e=-e,t|=8);const i=n.length;n.push(null);let r=0;for(;0!=e;)n.push(255&e),e>>>=8,r++;n[i]=t|r}}}(w);C.src&&d.writeFile(t.BINARY_ASM,`; srcmap size: ${I.length<<1} bytes\n`+C.src);{let e="";for(let t of C.buf)e+=String.fromCharCode(255&t,t>>8);const n=t.U.sha256(e);for(let e=0;e<4;++e)C.buf[16+e]=parseInt(n.slice(4*e,4*e+4),16);w.__meta={name:p.name,programHash:C.buf[16]|C.buf[17]<<16}}if(d.writeFile(t.BINARY_SRCMAP,JSON.stringify(w)),pxt.options.debug){let e=C.thumbFile.peepCounts,t=Object.keys(e);t.sort((t,n)=>e[n]-e[t]);for(let n of t.slice(0,50))pxt.log(`${n}  ${e[n]}`)}if(C.buf){let n="";const i=C.buf;for(;15&i.length;)i.push(0);t.U.pushRange(i,I);for(let e of i)n+=String.fromCharCode(255&e,e>>8);if(n=e.pxtc.encodeBase64(n),c()){d.writeFile(t.BINARY_PXT64,n);const r=t.hexfile.patchHex(d,i,!1,!!t.target.useUF2)[0];d.writeFile(pxt.outputName(t.target),e.pxtc.encodeBase64(r))}else d.writeFile(pxt.outputName(t.target),n)}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){let i,r;!function(e){e.DecompileLiterals="decompileLiterals",e.TaggedTemplate="taggedTemplate",e.DecompileIndirectFixedInstances="decompileIndirectFixedInstances",e.DecompileArgumentAsString="decompileArgumentAsString"}(i=n.DecompileParamKeys||(n.DecompileParamKeys={})),function(e){e[e.SingleLine=0]="SingleLine",e[e.MultiLine=1]="MultiLine"}(r=n.CommentKind||(n.CommentKind={})),n.DECOMPILER_ERROR=9267;const s=e.SyntaxKind,o=/^[^\f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]*$/,a=/^(?:Array<(.+)>)|(?:(.+)\[\])$/,l="math_number",c="math_number_minmax",u="math_integer",d="math_whole_number",p="text",h="logic_boolean",f={"+":{type:"math_arithmetic",op:"ADD"},"-":{type:"math_arithmetic",op:"MINUS"},"/":{type:"math_arithmetic",op:"DIVIDE"},"*":{type:"math_arithmetic",op:"MULTIPLY"},"**":{type:"math_arithmetic",op:"POWER"},"%":{type:"math_modulo",leftName:"DIVIDEND",rightName:"DIVISOR"},"<":{type:"logic_compare",op:"LT"},"<=":{type:"logic_compare",op:"LTE"},">":{type:"logic_compare",op:"GT"},">=":{type:"logic_compare",op:"GTE"},"==":{type:"logic_compare",op:"EQ"},"===":{type:"logic_compare",op:"EQ"},"!=":{type:"logic_compare",op:"NEQ"},"!==":{type:"logic_compare",op:"NEQ"},"&&":{type:"logic_operation",op:"AND"},"||":{type:"logic_operation",op:"OR"}},m=/^\s*\/\/\s*(.*)$/,g=/^\s*(?:(?:(?:\/\*\*?)|(?:\*))(?!\/))?\s*(.*?)(?:\*?\*\/)?$/;class _{constructor(e){this.renames=e,this.renames.sort((e,t)=>e.span.start-t.span.start)}getRenamesInSpan(e,t){const n=[];for(const i of this.renames){if(i.span.start>t)break;i.span.start>=e&&n.push(i)}return n}getRenameForPosition(e){for(const t of this.renames){if(t.span.start>e)return;if(t.span.start===e)return t}}}function y(e,t,n=!0){if(1===e.length&&"x"!==e&&"y"!==e&&"z"!==e){const i=e.charCodeAt(0);if(i>=97&&i<=122){const e=i-97;for(let i=1;i<26;i++){const r=String.fromCharCode(97+(e+i)%26);if("x"!==r&&"y"!==r&&"z"!==r&&!t[r])return n&&(t[r]=!0),r}}}for(let i=2;;i++){const r=e+i;if(!t[r])return n&&(t[r]=!0),r}}let b;function v(n,r,o=!1,a=!1){switch(n.kind){case s.WhileStatement:case s.IfStatement:case s.Block:return;case s.ExpressionStatement:return v(n.expression,r,o,a);case s.VariableStatement:return function(e,t){for(const n of e.declarationList.declarations){const e=l(n,t);if(e)return e}return}(n,r);case s.CallExpression:return function(n,r,o=!1,a=!1){const l=t.pxtInfo(n).callInfo;if(!l)return t.Util.lf("Function call not supported in the blocks");const c=r.attrs(l);let u;e.isIdentifier(n.expression)&&(u=r.declaredFunctions[n.expression.text]);if(o){if(c.forceStatement||c.handlerStatement)return t.Util.lf("Function with forceStatement cannot be used as an expression.")}else if(P(n,r)&&!u){if(r.aliasBlocks[l.qName])l.decompilerBlockAlias=r.aliasBlocks[l.qName];else if(!r.opts.snippetMode)return t.Util.lf("No output expressions as statements")}if("Math.pow"==l.qName)return;if(pxt.Util.startsWith(l.qName,"Math.")){if(F(l.qName.substring(5)))return}if(c.blockId===t.PAUSE_UNTIL_TYPE){const e=n.arguments[0];if(1===n.arguments.length&&y(e))return;return t.Util.lf("Predicates must be inline expressions that return a value")}const d=N(l,c);if(d&&!c.handlerStatement&&!c.forceStatement&&!a)return t.Util.lf("Events must be top level");if(!c.blockId||!c.block){const e=pxt.blocks.builtinFunctionInfo[l.qName];if(!e)return u?u.parameters.length!==l.args.length?t.Util.lf("Function calls in blocks must have the same number of arguments as the function definition"):void 0:t.Util.lf("Call statements must have a valid declared function");c.blockId=e.blockId}const p=R(l,r),h=r.blocks.apis.byQName[l.qName],f=r.compInfo(l),m=f.parameters.length+(f.thisParameter?1:0);if(c.imageLiteral||c.gridLiteral){if(l.args.length-m>1)return t.Util.lf("Function call has more arguments than are supported by its block");let e=n.arguments[0];if(e.kind!=s.StringLiteral&&e.kind!=s.NoSubstitutionTemplateLiteral)return t.Util.lf("Only string literals supported for image literals");const i=(e.text||"").replace(/\s+/g,""),r=c.imageLiteralRows||5,o=(c.imageLiteralColumns||5)*(c.imageLiteral||c.gridLiteral),a=o*r;return o*r!=i.length?t.Util.lf("Invalid image pattern ({0} expected vs {1} actual)",a,i.length):void 0}const g=l.args.length-m;if(g>0&&!_()){let e=g;if(d&&e--,c.defaultInstance&&e--,e>0)return t.Util.lf("Function call has more arguments than are supported by its block")}if(f.parameters.length||d){let e;const t=c.defaultInstance||!!f.thisParameter;if(p.forEach((n,i)=>{e||t&&0===i||(t&&i--,e=b(n))}),e)return e}if(h){const e=r.blocks.apis.byQName[h.namespace];if(e&&e.attributes.fixedInstances&&!e.attributes.decompileIndirectFixedInstances&&l.args.length){const e=t.pxtInfo(l.args[0]).callInfo;if(!e||!r.attrs(e).fixedInstance)return t.Util.lf("Fixed instance APIs can only be called directly from the fixed instance")}}return;function _(){if(c.mutatePropertyEnum&&2===g&&l.args.length>=2){const e=l.args[l.args.length-2],t=l.args[l.args.length-1];if(e.kind===s.ArrayLiteralExpression&&O(t)){const n=[],i=!e.elements.some(e=>e.kind!==s.PropertyAccessExpression||e.expression.kind!==s.Identifier||(n.push(e.name.text),e.expression.text!==c.mutatePropertyEnum));if(i){const e=E(t);if(e){const t=e[0];return t.length===n.length&&!n.some(e=>-1===t.indexOf(e))}}}}return!1}function y(e){if(e.kind!==s.FunctionExpression&&e.kind!==s.ArrowFunction)return!1;const t=e;if(P(t.body,r))return!0;const n=t.body;if(1===n.statements.length){if(w(n.statements[0]).kind===s.ReturnStatement)return!0}return!1}function b(e){const n=w(e.value),o=e.info,a=e.param;if(o.isEnum){if(l(n))return;if(n.kind===s.CallExpression){const e=t.pxtInfo(n).callInfo,i=r.attrs(e);if(e&&"TD_ID"===i.shim&&e.args&&1===e.args.length){if(l(w(e.args[0])))return}}else if(n.kind===s.Identifier){const e=t.pxtInfo(n).commentAttrs;if(e&&e.enumIdentity)return}return t.Util.lf("Enum arguments may only be literal property access expressions")}if(D(n)&&(a.fieldEditor||a.shadowBlockId)){let e=!(!a.fieldOptions||!a.fieldOptions[i.DecompileLiterals]);if(!e&&a.shadowBlockId){const t=r.blocks.blocksById[a.shadowBlockId];if(t&&t.parameters&&t.parameters.length){const n=t.parameters[0].name;e=!t.attributes.paramFieldEditorOptions||!t.attributes.paramFieldEditorOptions[n]||!!t.attributes.paramFieldEditorOptions[n][i.DecompileLiterals]}else e=!0}if(!e)return t.Util.lf("Field editor does not support literal arguments")}else if(n.kind===s.TaggedTemplateExpression&&a.fieldEditor){let e=a.fieldOptions&&a.fieldOptions[i.TaggedTemplate];if(!e)return t.Util.lf("Tagged templates only supported in custom fields with param.fieldOptions.taggedTemplate set");const r=w(n.tag).getText(),o=e.split(";").map(e=>e.trim());if(-1===o.indexOf(r))return t.Util.lf("Function only supports template literals with tag '{0}'",o.join(", "));if(n.template.kind!==s.NoSubstitutionTemplateLiteral)return t.Util.lf("Tagged template literals cannot have substitutions")}else if(n.kind===s.ArrowFunction){const e=n;if(e.parameters.length)if("objectdestructuring"===c.mutate){const n=w(e.parameters[0]);if(n.kind===s.Parameter&&n.name.kind!==s.ObjectBindingPattern)return t.Util.lf("Object destructuring mutation callbacks can only have destructuring patters as arguments")}else for(const n of e.parameters)if(n.name.kind!==s.Identifier)return t.Util.lf("Only identifiers allowed as function arguments")}else if(r.blocks.apis.byQName[o.type]){if(r.blocks.apis.byQName[o.type].attributes.fixedInstances){if(M(a))return;if(a.shadowBlockId){const e=r.blocks.blocksById[a.shadowBlockId];if(e){const t=pxt.blocks.compileInfo(e);if(t.parameters&&M(t.parameters[0]))return}}const e=t.pxtInfo(n).callInfo;if(e&&r.attrs(e).fixedInstance)return;return t.Util.lf("Arguments of a fixed instance type must be a reference to a fixed instance declaration")}}return;function l(e){const t=o.type.split("."),n=[];for(;e.kind===s.PropertyAccessExpression;)n.unshift(e.name.text),e=e.expression;if(e.kind!==s.Identifier)return!1;n.unshift(e.text);for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}}}(n,r,o,a);case s.VariableDeclaration:return l(n,r);case s.PostfixUnaryExpression:case s.PrefixUnaryExpression:return function(e){if(e.operand.kind!=s.Identifier)return t.Util.lf("-- and ++ may only be used on an identifier");if(e.operator!==s.PlusPlusToken&&e.operator!==s.MinusMinusToken)return t.Util.lf("Only ++ and -- supported as prefix or postfix unary operators in a statement");return}(n);case s.FunctionExpression:case s.ArrowFunction:return function(e,n){let i=!1;if(e.parameters.length){let r=C(e)[0];if(r&&t.pxtInfo(r).callInfo){let o=t.pxtInfo(r).callInfo;i="objectdestructuring"===n.attrs(o).mutate?e.parameters[0].name.kind!==s.ObjectBindingPattern:e.parameters.some(e=>e.name.kind!==s.Identifier)}}if(i)return t.Util.lf("Unsupported parameters in error function");return}(n,r);case s.BinaryExpression:return function(e,n){if(e.left.kind===s.ElementAccessExpression){if(e.operatorToken.kind!==s.EqualsToken)return t.Util.lf("Element access expressions may only be assigned to using the equals operator")}else{if(e.left.kind===s.PropertyAccessExpression)return e.operatorToken.kind!==s.EqualsToken&&e.operatorToken.kind!==s.PlusEqualsToken?t.Util.lf("Property access expressions may only be assigned to using the = and += operators"):S(e.left,n);if(e.left.kind!==s.Identifier)return t.Util.lf("This expression cannot be assigned to");switch(e.operatorToken.kind){case s.EqualsToken:return S(e.right,n);case s.PlusEqualsToken:case s.MinusEqualsToken:return;default:return t.Util.lf("Unsupported operator token in statement {0}",s[e.operatorToken.kind])}}return}(n,r);case s.ForStatement:return function(e){if(!e.initializer||!e.incrementor||!e.condition)return t.Util.lf("for loops must have an initializer, incrementor, and condition");if(e.initializer.kind!==s.VariableDeclarationList)return t.Util.lf("only variable declarations are permitted in for loop initializers");const n=e.initializer;if(!n.declarations)return t.Util.lf("for loop with out-of-scope variables not supported");if(1!=n.declarations.length)return t.Util.lf("for loop with multiple variables not supported");const i=n.declarations[0];if(i.initializer.kind!==s.NumericLiteral||"0"!==i.initializer.text)return t.Util.lf("for loop initializers must be initialized to 0");const r=i.name.text;if(!a(r))return t.Util.lf("for loop incrementors may only increment the variable declared in the initializer");if(e.condition.kind!==s.BinaryExpression)return t.Util.lf("for loop conditionals must be binary comparison operations");const o=e.condition;if(o.left.kind!==s.Identifier||o.left.text!==r)return t.Util.lf("left side of for loop conditional must be the variable declared in the initializer");if(o.operatorToken.kind!==s.LessThanToken&&o.operatorToken.kind!==s.LessThanEqualsToken)return t.Util.lf("for loop conditional operator must be either < or <=");return;function a(t){if(e.incrementor.kind===s.PostfixUnaryExpression||e.incrementor.kind===s.PrefixUnaryExpression){const n=e.incrementor;if(n.operator===s.PlusPlusToken&&n.operand.kind===s.Identifier)return n.operand.text===t}return!1}}(n);case s.ForOfStatement:return function(e){if(e.initializer.kind!==s.VariableDeclarationList)return t.Util.lf("only variable declarations are permitted in for of loop initializers");return}(n);case s.FunctionDeclaration:return function(e,n){if(!n)return t.Util.lf("Function declarations must be top level");if(e.parameters.length>0&&r.opts.allowedArgumentTypes)for(const n of e.parameters){if(n.initializer||n.questionToken)return t.Util.lf("Function parameters cannot be optional");const e=n.type?n.type.getText():void 0;if(!e)return t.Util.lf("Function parameters must declare a type");const i=V(e);if(-1===r.opts.allowedArgumentTypes.indexOf(i)&&!t.U.endsWith(i,"[]"))return t.Util.lf("Only types that can be added in blocks can be used for function arguments")}return}(n,a);case s.EnumDeclaration:return function(e,n){if(!n)return t.Util.lf("Enum declarations must be top level");const i=e.name.text;if(!r.blocks.enumsByName[i])return t.Util.lf("Enum declarations in user code must have a block");let o=!1;if(e.members.forEach(e=>{if(e.name.kind!==s.Identifier&&(o=!0),!o&&e.initializer){if(e.initializer.kind===s.NumericLiteral)return;if(e.initializer.kind===s.BinaryExpression){const t=e.initializer;if(t.operatorToken.kind===s.LessThanLessThanToken&&t.left.kind===s.NumericLiteral&&t.right.kind===s.NumericLiteral&&"1"==t.left.text)return}o=!0}}),o)return t.Util.lf("Invalid initializer for enum member");return}(n,a);case s.ModuleDeclaration:return function(e){const t=T(e,r);if(!t)return;return k(e)?t:void 0}(n);case s.ReturnStatement:return function(n){if(i(n))return;return t.Util.lf("Return statements can only be used within top-level function declarations");function i(t){const n=e.getEnclosingBlockScopeContainer(t);if(n)switch(n.kind){case s.SourceFile:case s.ArrowFunction:case s.FunctionExpression:return!1;case s.FunctionDeclaration:return n.parent&&n.parent.kind===s.SourceFile&&!v(n,r,!1,!0);default:return i(n)}return!1}}(n);case s.BreakStatement:case s.ContinueStatement:case s.DebuggerStatement:case s.EmptyStatement:return}return t.Util.lf("Unsupported statement in block: {0}",s[n.kind]);function l(e,n){let i;return e.name.kind!==s.Identifier?i=t.Util.lf("Variable declarations may not use binding patterns"):e.initializer?x(e)||(i=S(e.initializer,n)):i=t.Util.lf("Variable declarations must have an initializer"),i}}function T(n,i){if(!e.isModuleBlock(n.body))return t.Util.lf("Namespaces cannot be nested.");const r=i.blocks.kindsByName[n.name.text];if(!r)return t.Util.lf("Only namespaces with 'kind' blocks can be decompiled");const o=t.Util.lf("Namespaces may only contain valid 'kind' exports");for(const t of n.body.statements){if(H(t))return o;if(!e.isVariableStatement(t)||!t.declarationList.declarations)return o;{const n=1===t.declarationList.declarations.length,i=t.modifiers&&1===t.modifiers.length&&t.modifiers[0].kind===s.ExportKeyword,a=t.declarationList.flags&e.NodeFlags.Const;if(!(n&&i&&a))return o;{const n=t.declarationList.declarations[0];if(!n.initializer||!e.isCallExpression(n.initializer)||!e.isIdentifier(n.name))return o;const i=n.initializer;if(i.arguments.length)return o;if(e.isPropertyAccessExpression(i.expression)&&e.isIdentifier(i.expression.expression)){if(i.expression.expression.text!==r.name||i.expression.name.text!==r.createFunctionName)return o}else{if(!e.isIdentifier(i.expression))return o;if(i.expression.text!==r.createFunctionName)return o}}}}}function k(n){if(!e.isModuleBlock(n.body))return t.Util.lf("Namespaces cannot be nested.");if(n.name.text!==pxt.sprite.TILE_NAMESPACE)return t.Util.lf("Tileset namespace must be named myTiles");const i=t.Util.lf("The myTiles namespace can only export tile variables with image literal initializers and no duplicate ids"),r=t.Util.lf("Tileset members must have a blockIdentity comment and no other annotations"),o=new RegExp(`${pxt.sprite.TILE_PREFIX}(\\d+)`),a=[],l=/^\s*\/\/%\s*blockIdentity=[^\s]+\s*$/;for(const t of n.body.statements){const n=e.getLeadingCommentRangesOfNode(t,t.getSourceFile());if(!n||!n.length)return r;{const e=n.map(e=>t.getSourceFile().text.substr(e.pos,e.end-e.pos)).filter(e=>!!e);if(1!==e.length||!l.test(e[0]))return r}if(!e.isVariableStatement(t)||!t.declarationList.declarations)return i;{const n=1===t.declarationList.declarations.length,r=t.modifiers&&1===t.modifiers.length&&t.modifiers[0].kind===s.ExportKeyword,l=t.declarationList.flags&e.NodeFlags.Const;if(!(n&&r&&l))return i;{const n=t.declarationList.declarations[0];if(!n.initializer||!e.isTaggedTemplateExpression(n.initializer)||!e.isIdentifier(n.name))return i;const r=n.initializer;if(!e.isIdentifier(r.tag)||"img"!==r.tag.text)return i;const s=o.exec(n.name.text);if(!s||-1!==a.indexOf(s[1]))return i;a.push(s[1])}}}}function x(n){if(n.initializer){if(n.initializer.kind===e.SyntaxKind.NullKeyword||n.initializer.kind===e.SyntaxKind.FalseKeyword||function(e){return e.kind===s.ArrayLiteralExpression&&0===e.elements.length}(n.initializer))return!0;if(e.isStringOrNumericLiteral(n.initializer)){const e=n.initializer.getText();return"0"===e||I(e)}{const e=t.pxtInfo(n.initializer).callInfo;if(e&&e.isAutoCreate)return!0}}return!1}function E(e){if(1===e.parameters.length&&e.parameters[0].name.kind===s.ObjectBindingPattern){const n=e.parameters[0].name.elements,i={},r=n.map(e=>{if(t(e.propertyName)&&t(e.name)){const t=e.name.text;if(e.propertyName){const n=e.propertyName.text;return i[n]=t,n}return t}return""});return[r,i]}return;function t(e){return!e||e.kind===s.Identifier}}function S(n,i){switch(n.kind){case s.NumericLiteral:case s.TrueKeyword:case s.FalseKeyword:case s.ExpressionStatement:case s.ArrayLiteralExpression:case s.ElementAccessExpression:return;case s.ParenthesizedExpression:return S(n.expression,i);case s.StringLiteral:case s.FirstTemplateToken:case s.NoSubstitutionTemplateLiteral:return function(e){const n=e.text;return o.test(n)?void 0:t.Util.lf("Only whitespace character allowed in string literals is space")}(n);case s.Identifier:const a=t.pxtInfo(n);return(r=n)&&r.kind===s.Identifier&&"undefined"===r.text?t.Util.lf("Undefined is not supported in blocks"):!A(n)||a.commentAttrs&&a.commentAttrs.blockIdentity&&a.commentAttrs.enumIdentity&&i.blocks.apis.byQName[a.commentAttrs.blockIdentity]?void 0:t.Util.lf("Variable is declared in another file");case s.BinaryExpression:const l=n.operatorToken.getText();return f[l]?void 0:t.Util.lf("Could not find operator {0}",l);case s.PrefixUnaryExpression:const c=n.operator;return c===s.MinusToken||c===s.PlusToken||c===s.ExclamationToken?void 0:t.Util.lf("Unsupported prefix unary operator{0}",c);case s.PropertyAccessExpression:return function(n,i){const r=t.pxtInfo(n).callInfo;if(r){const o=i.attrs(r),a=i.compInfo(r);if(o.blockIdentity&&i.blocks.apis.byQName[o.blockIdentity]||"lists_length"===o.blockId||"text_length"===o.blockId)return;if(r.decl.kind===s.EnumMember){if(n.expression.kind===s.Identifier){const e=n.expression.text;if(i.declaredEnums[e])return}const[e,r]=C(n);let o=!0;if(e){const n=t.pxtInfo(e).callInfo;if(n&&n.args){const e=i.blocks.apis.byQName[n.qName],t=1==e.kind||2==e.kind;e&&n.args.forEach((n,i)=>{if(n===r){e.parameters[t?i-1:i].isEnum&&(o=!1)}})}}return o?t.Util.lf("Enum value without a corresponding block"):void 0}if(o.fixedInstance&&n.parent){if(n.parent.parent&&n.parent.kind===s.PropertyAccessExpression&&n.parent.parent.kind===s.CallExpression){if(n.parent.parent.expression===n.parent)return}else if(n.parent.kind===s.CallExpression&&n.parent.expression!==n)return}else{if(o.blockCombine||o.blockId&&a&&a.thisParameter)return S(n.expression,i);if(e.isIdentifier(n.expression)&&i.declaredKinds[n.expression.text]){const e=n.name.text,t=i.declaredKinds[n.expression.text];if(t&&(-1!==t.kindInfo.initialMembers.indexOf(e)||-1!==t.declaredNames.indexOf(e)))return}}}return t.Util.lf("No call info found")}(n,i);case s.CallExpression:return v(n,i,!0,void 0);case s.TaggedTemplateExpression:return function(e,n){const i=t.pxtInfo(e).callInfo;if(!i)return t.Util.lf("Invalid tagged template");const r=n.attrs(i);if(!r.blockIdentity||!n.blocks.apis.byQName[r.blockIdentity])return t.Util.lf("Tagged template does not have blockIdentity set");const s=n.blocks.apis.byQName[r.blockIdentity];if(!s)return t.Util.lf("Could not find blockIdentity for tagged template");if(1!==pxt.blocks.compileInfo(s).parameters.length)return t.Util.lf("Tagged template functions must have 1 argument");return}(n,i);case s.AsExpression:return function(n){if("any"===n.type.getText().trim()&&(e.isStringOrNumericLiteral(n.expression)||n.expression.kind===s.TrueKeyword||n.expression.kind===s.FalseKeyword)){const[e]=C(n);if(e.kind===s.BinaryExpression)switch(e.operatorToken.kind){case s.EqualsEqualsToken:case s.EqualsEqualsEqualsToken:case s.ExclamationEqualsToken:case s.ExclamationEqualsEqualsToken:case s.LessThanToken:case s.LessThanEqualsToken:case s.GreaterThanToken:case s.GreaterThanEqualsToken:return}}return t.Util.lf("Casting not supported in blocks")}(n)}var r;return t.Util.lf("Unsupported syntax kind for output expression block: {0}",s[n.kind])}function C(e){return e.parent?e.parent.kind===s.ParenthesizedExpression?C(e.parent):[e.parent,e]:[void 0,e]}function w(e){for(;e.kind===s.ParenthesizedExpression;)e=e.expression;return e}function I(e){return'""'===e||"''"===e||"``"===e}function A(e){return!!(4&t.pxtInfo(e).flags)}function N(e,n){if(n.blockId===t.PAUSE_UNTIL_TYPE)return!1;e.decl.parameters;return e.args.some((e,t)=>e&&O(e))}function D(e){if(!e)return!1;switch(e.kind){case s.ParenthesizedExpression:return D(e.expression);case s.ArrayLiteralExpression:const t=e;for(const e of t.elements)if(!D(e)&&e.kind!==s.TaggedTemplateExpression)return!1;return!0;case s.NumericLiteral:case s.StringLiteral:case s.NoSubstitutionTemplateLiteral:case s.TrueKeyword:case s.FalseKeyword:return!0;case s.PrefixUnaryExpression:const n=e;return(n.operator===s.PlusToken||n.operator===s.MinusToken)&&D(n.operand);default:return!1}}function O(e){return e.kind===s.ArrowFunction||e.kind===s.FunctionExpression}function R(e,t){const n=[],i=t.blocks.apis.byQName[e.qName];if(i){const r=t.blocks.apis.byQName[e.qName].attributes,s=t.compInfo(e);let o=r.imageLiteral?1:0;s.thisParameter?n.push({value:w(e.args[0]),info:null,param:s.thisParameter}):r.defaultInstance&&n.push({value:w(e.args[0]),info:i.parameters[0],param:{definitionName:"__instance__",actualName:"this"}});const a=!(!s.thisParameter&&!r.defaultInstance);a&&o++;for(let t=o;t<e.args.length;t++)n.push({value:w(e.args[t]),info:i.parameters[a?t-1:t],param:s.parameters[t-o]})}return n}function L(e){return e.body.statements.map(e=>{const t=e.declarationList.declarations[0];return{name:t.name.text,initializer:t.initializer.getText()}})}function P(e,n){switch(e.kind){case s.BinaryExpression:{const t=e.operatorToken.kind;return t!=s.PlusEqualsToken&&t!=s.MinusEqualsToken&&t!=s.EqualsToken}case s.PrefixUnaryExpression:{const t=e.operator;return t!=s.PlusPlusToken&&t!=s.MinusMinusToken}case s.PostfixUnaryExpression:{const t=e.operator;return t!=s.PlusPlusToken&&t!=s.MinusMinusToken}case s.CallExpression:{const i=t.pxtInfo(e).callInfo;t.assert(!!i);const r=n.attrs(i);return i.isExpression&&!r.forceStatement&&!r.handlerStatement}case s.Identifier:case s.ParenthesizedExpression:case s.NumericLiteral:case s.StringLiteral:case s.NoSubstitutionTemplateLiteral:case s.TrueKeyword:case s.FalseKeyword:case s.NullKeyword:case s.TaggedTemplateExpression:return!0;default:return!1}}function M(e){return e&&e.fieldOptions&&e.fieldOptions[i.DecompileIndirectFixedInstances]}function F(e){return B(e)||$(e)||U(e)||-1!==pxt.blocks.MATH_FUNCTIONS.binary.indexOf(e)}function B(e){return-1!==pxt.blocks.MATH_FUNCTIONS.unary.indexOf(e)}function $(e){return-1!==pxt.blocks.MATH_FUNCTIONS.infix.indexOf(e)}function U(e){return-1!==pxt.blocks.ROUNDING_FUNCTIONS.indexOf(e)}function V(e){const t=a.exec(e);return t?`${t[1]||t[2]}[]`:e}function H(t){const n=e.getLeadingCommentRangesOfNode(t,t.getSourceFile());return!(!n||!n.length)}function G(t,n,i=!1){const s=[],o=t.getFullText();if(n&&n.length)for(const a of n){const n=e.getLineOfLocalPosition(t,a.end),l=e.getStartPositionOfLine(n+1,t)||o.length,c=e.getStartPositionOfLine(n+2,t)||o.length,u=!i&&!o.substr(l,c-l).trim();let d=o.substr(a.pos,a.end-a.pos);if(d&&(d=d.replace(/\r\n/g,"\n")),a.kind===e.SyntaxKind.SingleLineCommentTrivia){const e=m.exec(d);e?s.push({kind:r.SingleLine,text:e[1],start:a.pos,end:a.end,hasTrailingNewline:!!a.hasTrailingNewLine,followedByEmptyLine:u,isTrailingComment:i}):s.push({kind:r.SingleLine,text:"",start:a.pos,end:a.end,hasTrailingNewline:!!a.hasTrailingNewLine,followedByEmptyLine:u,isTrailingComment:i})}else{const e=d.split("\n").map(e=>{const t=g.exec(e);return t?t[1]:""});s.push({kind:r.MultiLine,lines:e,start:a.pos,end:a.end,hasTrailingNewline:!!a.hasTrailingNewLine,followedByEmptyLine:u,isTrailingComment:i})}}return s}function j(e){let n="";for(const i of e)if(i.kind===r.SingleLine){if(i.text===t.ON_START_COMMENT||i.text===t.HANDLER_COMMENT)continue;n+=i.text.trim()+"\n"}else for(const e of i.lines)n+=e.trim()+"\n";return n.trim()}function K(e){const[t]=C(e);return!t||t.kind==s.SourceFile||(t.kind==s.ExpressionStatement?K(t):t.kind==s.VariableDeclarationList&&K(t.parent))}function z(t){const n=t.getFullText(),i=e.createScanner(t.languageVersion,!1,t.languageVariant,n,void 0,t.getFullStart());let r,o,a=[];for(;i.getTextPos()<t.end;){const l=i.scan();if(l===s.SingleLineCommentTrivia||l===s.MultiLineCommentTrivia){r=e.getLeadingCommentRanges(n,i.getTokenPos())||[],o=e.getTrailingCommentRanges(n,i.getTokenPos())||[],o=o.filter(e=>!r.some(t=>t.pos===e.pos)),a.push(...G(t,r,!1)),a.push(...G(t,o,!0));for(const e of a)e.end>i.getTextPos()&&i.setTextPos(e.end)}}return a.sort((e,t)=>e.start-t.start),a}function W(e,t){let n;for(let i=0;i<t.length;i++)n=t[i],!n.owner&&n.start>=e.pos&&n.end<=e.end&&(n.owner=e)}function q(e){if(void 0!==e.emitShadowOnly)return e.emitShadowOnly;let t=!1;if("expr"===e.value.kind){const n=e.value;if(n.type===l&&e.shadowType===c&&(n.type=c,n.fields[0].name="SLIDER",n.mutation=e.shadowMutation),t=n.type===e.shadowType,!t)switch(n.type){case"math_number":case"math_number_minmax":case"math_integer":case"math_whole_number":case"logic_boolean":case"text":t=!e.shadowType}if(t&&n.inputs)for(const e of n.inputs)if(!q(e)){t=!1;break}}return e.emitShadowOnly=t,t}n.RenameMap=_,n.buildRenameMap=function(n,i,{declarations:r,takenNames:s}={declarations:"variables",takenNames:{}}){let o=e.createLanguageService(new t.LSHost(n));const a=[];let l=(function t(n){e.forEachChild(n,n=>{if(e.isDeclarationName(n)&&("all"===r||e.isVariableDeclaration(n.parent))){const e=n.getText();if(s[e]){const t=y(e,s),r=o.findRenameLocations(i.fileName,n.pos+1,!1,!1);r&&r.forEach(n=>{a.push({name:t,diff:t.length-e.length,span:n.textSpan})})}else s[e]=!0}t(n)})}(i),s);return[new _(a),l]},n.getNewName=y,function(e){e[e.None=0]="None",e[e.InBlocksOnly=1]="InBlocksOnly",e[e.InTextBlocks=2]="InTextBlocks"}(b||(b={})),n.decompileToBlocks=function(o,a,m,g){let _=a.statements;const y={blocksInfo:o,outfiles:{},diagnostics:[],success:!0,times:{}};m.generateSourceMap&&(y.blockSourceMap=[]);const M={blocks:o,declaredFunctions:{},declaredEnums:{},declaredKinds:{},functionParamIds:{},attrs:oe,compInfo:ae,localReporters:[],tileset:[],opts:m||{},aliasBlocks:{}};a.getFullText();let H="";const G=[],J={},Y=[],X=[],Z=(()=>{let e=0;return()=>""+e++})(),Q=o.apis.byQName;Object.keys(Q).forEach(e=>{const t=Q[e];t.attributes.blockAliasFor&&Q[t.attributes.blockAliasFor]&&(M.aliasBlocks[t.attributes.blockAliasFor]=t.qName)});const ee=z(a),te=n=>{if(n.kind!==s.FunctionDeclaration||v(n,M,!1,!0))if(n.kind!==s.EnumDeclaration||v(n,M,!1,!0))if(e.isModuleDeclaration(n))if(T(n,M))k(n)||(M.tileset=L(n).map(({name:e,initializer:t})=>({projectId:parseInt(e.substr(pxt.sprite.TILE_PREFIX.length)),data:pxt.sprite.imageLiteralToBitmap(t).data()})));else{const e=n.name.text,t=L(n);M.declaredKinds[e]&&M.declaredKinds[e].declaredNames.push(...t.map(({name:e})=>e))}else n.kind===s.Block&&e.forEachChild(n,te);else{const e=n.name.text;M.declaredEnums[e]=!0,function(e){const n=[];return e.members.forEach(e=>{t.U.assert(e.name.kind===s.Identifier);const i=e.name.text;let r;if(e.initializer)if(e.initializer.kind===s.NumericLiteral)r=parseInt(e.initializer.text);else{const n=e.initializer;t.U.assert(n.left.kind===s.NumericLiteral),t.U.assert("1"===n.left.text),t.U.assert(n.operatorToken.kind===s.LessThanLessThanToken),t.U.assert(n.right.kind===s.NumericLiteral);r=1<<parseInt(n.right.text)}else r=0===n.length?0:n[n.length-1][1]+1;n.push([i,r])}),n}(n).forEach(([t,n])=>{G.push({name:n+t,type:e})})}else M.declaredFunctions[et(n.name)]=n};Object.keys(o.kindsByName).forEach(e=>{const t=o.kindsByName[e];M.declaredKinds[e]={kindInfo:t,declaredNames:[]}}),e.forEachChild(a,te);const ne=()=>(Math.PI*Math.random()).toString(36).slice(2);let ie;Object.keys(M.declaredFunctions).forEach(e=>{M.functionParamIds[e]={},M.declaredFunctions[e].parameters.forEach(t=>{M.functionParamIds[e][t.name.getText()]=ne()+ne()})}),Object.keys(M.declaredKinds).forEach(e=>{const t="KIND_"+e;M.declaredKinds[e].declaredNames.forEach(e=>G.push({name:e,type:t}))}),(G.length||M.tileset.length)&&(re("<variables>"),G.forEach(e=>{re(`<variable type="${t.U.htmlEscape(e.type)}">${t.U.htmlEscape(e.name)}</variable>`)}),M.tileset.forEach(e=>{re(`<variable type="${pxt.sprite.BLOCKLY_TILESET_TYPE}">${pxt.sprite.legacy.tileToBlocklyVariable(e)}</variable>`)}),re("</variables>"));try{ie=Ye(_,void 0,!0,void 0,!m.snippetMode);for(const e of ee)e.owner||Y.push({refId:Z(),comment:[e]})}catch(i){return pxt.reportException(i),y.success=!1,y.diagnostics=t.patchUpDiagnostics([{file:a,start:a.getFullStart(),length:a.getFullWidth(),messageText:i.message,category:e.DiagnosticCategory.Error,code:n.DECOMPILER_ERROR}]),y}return ie?me(ie):m.snippetMode||_.length||(ke(e.pxtc.ON_START_TYPE,de(e.pxtc.ON_START_TYPE,_[0])),xe()),Y.forEach(e=>{!function(e){let n=0;const i=j(e.comment);if(i.trim()){const r=i.split("\n");r.forEach(e=>n=Math.max(n,e.length));const s=Math.max(Math.min(10*n,480),160);re(`<comment h="${Math.max(Math.min(40*r.length,360),120)}" w="${s}" data="${t.U.htmlEscape(e.refId)}">`),re(t.U.htmlEscape(i)),re("</comment>")}}(e)}),y.outfiles[a.fileName.replace(/(\.blocks)?\.\w*$/i,"")+".blocks"]=`<xml xmlns="http://www.w3.org/1999/xhtml">\n${H}</xml>`,y;function re(e,t="\n"){H+=e+t}function se(n,i){const r=i||`Language feature "${n.getFullText().trim()}"" not supported in blocks`,s=t.patchUpDiagnostics([{file:a,start:n.getFullStart(),length:n.getFullWidth(),messageText:r,category:e.DiagnosticCategory.Error,code:1001}]);pxt.debug(`decompilation error: ${r}`),t.U.pushRange(y.diagnostics,s),y.success=!1}function oe(e){const n=o.apis.byQName[e.decompilerBlockAlias||e.qName];if(n){const e=n.attributes;if(!e.blockId||o.blocksById[e.blockId]||e.blockId===t.PAUSE_UNTIL_TYPE)return n.attributes}else if(e.decl){const n=t.parseComments(e.decl);if(n)return n}return{paramDefl:{},callingConvention:0}}function ae(e){const t=o.apis.byQName[e.decompilerBlockAlias||e.qName];if(t)return pxt.blocks.compileInfo(t)}function le(n){const i=n.expression,r=t.pxtInfo(i).callInfo,s=oe(r);if(s.blockAllowMultiple)return;if(s.blockHandlerKey)return s.blockHandlerKey;const o=r.args.filter(t=>!e.isArrowFunction(t)&&!O(t)).map(e=>ce(e)).join("$$");return s.blockId+"-"+o}function ce(e){if(!e)return"";switch(e.kind){case s.ParenthesizedExpression:case s.AsExpression:return ce(e.expression);case s.Identifier:return e.text;case s.StringLiteral:case s.FirstTemplateToken:case s.NoSubstitutionTemplateLiteral:return`"${e.text}"`;case s.NumericLiteral:return e.text;case s.TrueKeyword:return"true";case s.FalseKeyword:return"false";case s.BinaryExpression:return`{${ce(e.left)}${e.operatorToken.getText()}${ce(e.right)}}`;case s.PrefixUnaryExpression:return e.operator+ce(e.operand);case s.PropertyAccessExpression:return ce(e.expression)+"."+ce(e.name);case s.ArrayLiteralExpression:return`[${e.elements.map(e=>ce(e))}]`;case s.ElementAccessExpression:return`${e.expression}[${e.argumentExpression}]`;case s.TaggedTemplateExpression:return`${ce(e.tag)}\`${e.template.getText()}\``;case s.CallExpression:return`${ce(e.expression)}(${e.arguments.map(ce).join(",")})`;default:return e.getText()}}function ue(t,n){if(t==e.pxtc.ON_START_TYPE)return"xRRgvHNlG#rZ^u`HECiY";const i=function(){const e="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=[];for(let n=0;n<20;n++)t[n]=e.charAt(88*Math.random());return t.join("")}();if(n){const e=n.getFullStart();y.blockSourceMap.push({id:i,startPos:e,endPos:e+n.getFullWidth()})}return i}function de(e,t){const n={kind:"statement",type:e};return y.blockSourceMap&&(n.id=ue(e,t)),n}function pe(e,t){return{kind:"expr",type:e}}function he(e,t,n,i){return(!n||n===l)&&i&&i.min&&i.max&&(n=c),{kind:"value",name:e,value:t,shadowType:n,shadowMutation:i}}function fe(e){if(e.expression.kind==s.CallExpression){const n=e.expression,i=t.pxtInfo(n).callInfo;if(!i)return se(e),!1;let r=oe(i);return r.block||M.aliasBlocks[i.qName]&&(i.decompilerBlockAlias=M.aliasBlocks[i.qName],r=oe(i)),r.blockId&&!r.handlerStatement&&!r.forceStatement&&!i.isExpression&&N(i,r)}return!1}function me(e){e&&(ke(e.type,e),_e(e),void 0!==e.data&&re(`<data>${t.U.htmlEscape(e.data)}</data>`),e.handlers&&e.handlers.forEach(ve),e.next&&(re("<next>"),me(e.next),re("</next>")),void 0!==e.comment&&re(`<comment pinned="false">${t.U.htmlEscape(j(e.comment))}</comment>`),xe())}function ge(e,t){re("<mutation ",""),Object.keys(e).forEach(t=>{void 0!==e[t]&&re(`${t}="${e[t]}" `,"")}),t?(re(">"),t.forEach(e=>{re(`<${e.nodeName} `,""),Object.keys(e.attributes).forEach(t=>{re(`${t}="${e.attributes[t]}" `,"")}),re("/>")}),re("</mutation>")):re("/>")}function _e(e){e.mutation&&ge(e.mutation,e.mutationChildren),e.fields&&e.fields.forEach(be),e.inputs&&e.inputs.forEach(ye)}function ye(e){if(re(`<value name="${e.name}">`),q(e))Te(e.value,!0);else{if(void 0!==e.shadowType)switch(e.shadowType){case l:case u:case d:re(`<shadow type="${e.shadowType}"><field name="NUM">0</field></shadow>`);break;case c:re(`<shadow type="${c}">`),e.shadowMutation&&ge(e.shadowMutation),re('<field name="SLIDER">0</field></shadow>');break;case h:re(`<shadow type="${h}"><field name="BOOL">TRUE</field></shadow>`);break;case p:re(`<shadow type="${p}"><field name="TEXT"></field></shadow>`);break;default:re(`<shadow type="${e.shadowType}"/>`)}Te(e.value)}re("</value>")}function be(e){re(`<field name="${t.U.htmlEscape(e.name)}">${t.U.htmlEscape(e.value.toString())}</field>`)}function ve(e){re(`<statement name="${t.U.htmlEscape(e.name)}">`),me(e.statement),re("</statement>")}function Te(e,n=!1){if("text"===e.kind){re(e.value)}else{const i=e,r=n||i.isShadow?"shadow":"block";re(`<${r} ${i.id?`id="${i.id}" `:""}type="${t.U.htmlEscape(i.type)}">`),_e(i),re(`</${r}>`)}}function ke(e,n){re(`<block ${n&&n.id?`id="${n.id}" `:""}type="${t.U.htmlEscape(e)}">`)}function xe(){re("</block>")}function Ee(e){if(S(e,M))return Ce(e);switch(e.kind){case s.ExpressionStatement:case s.ParenthesizedExpression:return Ee(e.expression);case s.Identifier:return function(e){if(A(e)){const n=t.pxtInfo(e);return Ue(o.apis.byQName[n.commentAttrs.blockIdentity],n.commentAttrs.enumIdentity)}const n=et(e),i=e.text;let r=null;return M.localReporters.some(e=>{for(let t=0;t<e.length;++t)if(e[t].name===i)return r=e[t],!0;return!1}),r?Me(n,r.type,!1):(Ze(n,b.InBlocksOnly),Le("variables_get","VAR",n))}(e);case s.StringLiteral:case s.FirstTemplateToken:case s.NoSubstitutionTemplateLiteral:return Oe(e.text);case s.NumericLiteral:return De(e.text);case s.TrueKeyword:return Re(!0);case s.FalseKeyword:return Re(!1);case s.BinaryExpression:return function(e){const t=e.operatorToken.getText(),n=f[t];if(we(e))return Ae(e);const i=n.leftName||"A",r=n.rightName||"B";let s,o;"&&"===t||"||"===t?(s=je(i,e.left),o=je(r,e.right)):(s=Ne(i,e.left,l),o=Ne(r,e.right,l));const a=pe(n.type);a.fields=[],n.op&&a.fields.push(Fe("OP",n.op));return a.inputs=[s,o],a}(e);case s.PrefixUnaryExpression:return function(e){switch(e.operator){case s.ExclamationToken:const t=pe("logic_negate");return t.inputs=[je("BOOL",e.operand)],t;case s.PlusToken:return Ee(e.operand);case s.MinusToken:return e.operand.kind==s.NumericLiteral?De("-"+e.operand.text):Be(e.operand);default:se(e)}return}(e);case s.PropertyAccessExpression:return $e(e);case s.ArrayLiteralExpression:return function(e){const t=pe("lists_create_with");return t.inputs=e.elements.map((e,t)=>Ne("ADD"+t,e)),t.mutation={items:e.elements.length.toString()},t}(e);case s.ElementAccessExpression:return function(e){const t=pe("lists_index_get");return t.inputs=[Ne("LIST",e.expression),Ne("INDEX",e.argumentExpression,l)],t}(e);case s.TaggedTemplateExpression:return function(e){const n=t.pxtInfo(e).callInfo;let r;const o=function(e){if(e.parent&&e.parent.kind===s.CallExpression){const n=e.parent,i=t.pxtInfo(n).callInfo,r=n.arguments.indexOf(e);if(i&&-1!==r){const e=ae(i);return e&&e.parameters[r]}}return}(e);if(o&&o.shadowBlockId){const e=M.blocks.blocksById[o.shadowBlockId];e&&"TD_ID"===e.attributes.shim&&(r=e)}r||(r=M.blocks.apis.byQName[oe(n).blockIdentity]);const a=pxt.blocks.compileInfo(r),l=pe(r.attributes.blockId);let c;const u=a.parameters[0];c=u.fieldOptions&&u.fieldOptions[i.DecompileArgumentAsString]?e.getText():e.template.text;return l.fields=[Fe(u.actualName,c)],l}(e);case s.CallExpression:return He(e,void 0,void 0,!0);case s.AsExpression:return Ee(e.expression);default:se(e,t.Util.lf("Unsupported syntax kind for output expression block: {0}",s[e.kind]))}}function Se(e,t,n){if(g){const i=g.getRenamesInSpan(t,n);if(i.length){let n=0;i.forEach(i=>{const r=i.span.start+n-t,s=r+i.span.length;n+=i.diff,e=e.slice(0,r)+i.name+e.slice(s)})}}return e}function Ce(e){const n=Se(e.getFullText(),e.getFullStart(),e.getEnd()).trim();return Qe(e),W(e,ee),Le(t.TS_OUTPUT_TYPE,"EXPRESSION",n)}function we(e){if(e.kind===s.BinaryExpression){const n=e;if("+"===n.operatorToken.getText()||n.operatorToken.kind==s.PlusEqualsToken){return!!t.pxtInfo(e).exprInfo}}return!1}function Ie(e,t){we(e)?(Ie(e.left,t),Ie(e.right,t)):t.push(e)}function Ae(e){const t=[];Ie(e,t);const n=[];for(let e=0;e<t.length;e++)(e>0||!I(t[e].getText()))&&n.push(Ne("ADD"+n.length,t[e],p));const i=pe("text_join");return i.inputs=n,i.mutation={items:n.length.toString()},i}function Ne(e,t,n,i){let r;if(r="number"==typeof t?De(t.toString()):"boolean"==typeof t?Re(t):"string"==typeof t?Oe(t):Ee(t),"expr"==r.kind&&"math_number"==r.type){const e=r.fields[0].value;"math_integer"==n&&e%1==0&&(r.type="math_integer"),"math_whole_number"==n&&e%1==0&&e>0&&(r.type="math_whole_number")}return he(e,r,n,i)}function De(e){return Le("math_number","NUM",e)}function Oe(e){return Le("text","TEXT",e)}function Re(e){return Le("logic_boolean","BOOL",e?"TRUE":"FALSE")}function Le(e,t,n,i){const r=pe(e);return r.fields=[Fe(t,n)],r.isShadow=i,r}function Pe(e,t){const n=Le("variables_get_reporter","VAR",t);return n.mutation={duplicateondrag:"true"},he(e,n,void 0,n.mutation)}function Me(e,t,n){const i=pxt.blocks.reporterTypeForArgType(t),r=Le(i,"VALUE",e);return"argument_reporter_custom"===i&&(r.mutation={typename:t}),n&&(r.mutation||(r.mutation={}),r.mutation.duplicateondrag="true"),r}function Fe(e,t){return{kind:"field",name:e,value:t}}function Be(e){const t=pe("math_arithmetic");return t.inputs=[Ne("A",0,l),Ne("B",e,l)],t.fields=[Fe("OP","MINUS")],t}function $e(e,n=!1,i){let r=t.pxtInfo(e).callInfo;if(!r)return void se(e);if(e.expression.kind===s.Identifier){const t=e.expression.text;if(M.declaredEnums[t]){const n=o.enumsByName[t];if(n&&n.blockId)return Le(n.blockId,"MEMBER",e.name.text)}else if(M.declaredKinds[t]){return Le(M.declaredKinds[t].kindInfo.blockId,"MEMBER",e.name.text)}}const a=oe(r);if(i=a.blockId||i,a.blockCombine)return function(e,t){return We(e,t,null,"@get@")}(e,e);if("lists_length"===a.blockId||"text_length"===a.blockId){const n=pe(t.U.htmlEscape(a.blockId));return n.inputs=[Ne("VALUE",e.expression)],n}let l=t.U.htmlEscape(a.blockId)||r.qName;const[c]=C(e),u=c&&t.pxtInfo(c).callInfo;if(n||!i&&!a.blockIdentity||u&&u.qName===a.blockIdentity)return{kind:"text",value:l};a.enumval&&u&&a.useEnumVal&&(l=a.enumval);const d=M.compInfo(r);if(i&&d&&d.thisParameter){const n=pe(i);return n.inputs=[Ne(t.U.htmlEscape(d.thisParameter.definitionName),e.expression,d.thisParameter.shadowBlockId)],n}let p=a.blockIdentity?o.apis.byQName[a.blockIdentity]:o.blocksById[i];return i&&p.attributes.blockId!==i&&p.attributes.decompilerShadowAlias===i&&(p=o.blocksById[i]),Ue(p,l)}function Ue(e,n){let i=/(?:%|\$)([a-zA-Z0-9_]+)/.exec(e.attributes.block);const r=pe(t.U.htmlEscape(e.attributes.blockId));return r.fields=[{kind:"field",name:t.U.htmlEscape(i[1]),value:n}],r}function Ve(t,n){let i,s=[];for(let e=0;e<ee.length&&(i=ee[e],!i.owner&&i.start>=t.pos&&i.end<=t.end&&(i.owner=t,i.ownerStatement=n,s.push(i)),!(i.start>t.end));e++);if(i&&i.isTrailingComment){const r=e.getLineAndCharacterOfPosition(a,t.end),o=e.getLineAndCharacterOfPosition(a,i.start);if(r.line===o.line){if(i.ownerStatement){i.ownerStatement.comment.splice(i.ownerStatement.comment.indexOf(i),1);for(const e of Y)e.comment.splice(e.comment.indexOf(i),1)}i.owner=t,i.ownerStatement=n,s.push(i)}}if(s.length){const e=[];if(K(t)){let t=[];const n=[];s.forEach((e,i)=>{let o=e.owner&&e.start<e.owner.getStart();e.kind===r.MultiLine&&o&&(t.length&&(n.push(t),t=[]),i!=s.length-1)?n.push([e]):(t.push(e),e.followedByEmptyLine&&o&&(n.push(t),t=[]))}),s=t,n.forEach(t=>{const n=Z();e.push(n),Y.push({comment:t,refId:n})})}n&&(e.length&&(n.data?n.data+=";"+e.join(";"):n.data=e.join(";")),s&&s.length&&(n.comment?n.comment=n.comment.concat(s):n.comment=s))}}function He(n,r,a,f=!1,m=!1){const g=n;let _,y=!1;const T=v(g,M,f,m);if(T)_=Ge(g,void 0,T);else switch(g.kind){case s.Block:return Ye(g.statements,r,m);case s.ExpressionStatement:return He(g.expression,r,a||g,f,m);case s.VariableStatement:if(_=Ye(g.declarationList.declarations,void 0,!1,a||g),!_)return k();y=!0;break;case s.FunctionExpression:case s.ArrowFunction:return function(e,t){return He(e.body,t)}(g,r);case s.BinaryExpression:_=function(e){e.left.text;switch(e.operatorToken.kind){case s.EqualsToken:return e.left.kind===s.Identifier?Ke(e,e.left,e.right):e.left.kind==s.PropertyAccessExpression?ze(e,e.left,e.right,"@set@"):function(e,t,n){const i=de("lists_index_set",e);return i.inputs=[Ne("LIST",t.expression),Ne("INDEX",t.argumentExpression,l),Ne("VALUE",n)],i}(e,e.left,e.right);case s.PlusEqualsToken:if(we(e)){const t=de("variables_set",e),n=et(e.left);return Ze(n,b.InBlocksOnly),t.inputs=[he("VALUE",Ae(e),l)],t.fields=[Fe("VAR",n)],t}return e.left.kind==s.PropertyAccessExpression?ze(e,e.left,e.right,"@change@"):Ke(e,e.left,e.right,!0);case s.MinusEqualsToken:const n=de("variables_change",e);return n.inputs=[he("VALUE",Be(e.right),l)],n.fields=[Fe("VAR",et(e.left))],n;default:return void se(e,t.Util.lf("Unsupported operator token in statement {0}",s[e.operatorToken.kind]))}}(g);break;case s.PostfixUnaryExpression:case s.PrefixUnaryExpression:_=function(e){const t=e.operator===s.PlusPlusToken;if(!t&&e.operator!==s.MinusMinusToken)return void se(e);return Ke(e,e.operand,t?1:-1,!0)}(g);break;case s.VariableDeclaration:const n=g;if(x(n))return function(e){X.push([et(e.name),e])}(n),k();_=function(e){if(function(e){if(e.name.kind!==s.Identifier)return se(e,t.Util.lf("Variable declarations may not use binding patterns")),!1;if(!e.initializer)return se(e,t.Util.lf("Variable declarations must have an initializer")),!1;return!0}(e))return Ke(e,e.name,e.initializer);return}(g);break;case s.WhileStatement:_=function(e){const t=de("device_while",e);return t.inputs=[je("COND",e.expression)],t.handlers=[{name:"DO",statement:He(e.statement)}],t}(g);break;case s.IfStatement:_=function(e){let t=Je(e);const n=de("controls_if",e);if(n.mutation={elseif:(t.ifStatements.length-1).toString(),else:t.elseStatement?"1":"0"},n.inputs=[],n.handlers=[],t.ifStatements.forEach((e,t)=>{let i=He(e.thenStatement);n.inputs.push(je("IF"+t,e.expression)),n.handlers.push({name:"DO"+t,statement:i})}),t.elseStatement){let e=He(t.elseStatement);n.handlers.push({name:"ELSE",statement:e})}return n}(g);break;case s.ForStatement:_=function(t){const n=t.initializer,i=(n.declarations[0].name.text,t.condition),r=et(n.declarations[0].name);let o;if(i.operatorToken.kind!==s.LessThanToken||c(t.statement))if(o=de("pxt_controls_for",t),o.fields=[],o.inputs=[],o.handlers=[],o.inputs=[Pe("VAR",r)],i.operatorToken.kind===s.LessThanToken){const e=w(i.right);if(e.kind===s.NumericLiteral){const t=De(parseFloat(e.text)-1+"");o.inputs.push(he("TO",t,d))}else{const t=pe("math_arithmetic");t.fields=[Fe("OP","MINUS")],t.inputs=[Ne("A",e,l),Ne("B",1,l)],o.inputs.push(he("TO",t,d))}}else i.operatorToken.kind===s.LessThanEqualsToken&&o.inputs.push(Ne("TO",i.right,d));else o=de("controls_repeat_ext",t),o.fields=[],o.inputs=[Ne("TIMES",i.right,d)],o.handlers=[];const a=He(t.statement);return o.handlers=[{name:"DO",statement:a}],o;function c(t){return t.kind===s.Identifier&&et(t)===r||e.forEachChild(t,c)}}(g);break;case s.ForOfStatement:_=function(e){const t=e.initializer,n=et(t.declarations[0].name),i=de("pxt_controls_for_of",e);i.inputs=[Ne("LIST",e.expression),Pe("VAR",n)];const r=He(e.statement);return i.handlers=[{name:"DO",statement:r}],i}(g);break;case s.FunctionDeclaration:_=function(e){const t=et(e.name);M.localReporters.push(e.parameters.map(e=>({name:e.name.getText(),type:e.type.getText()})));const n=He(e.body);let i;M.localReporters.pop(),i=de("function_definition",e),i.mutation={name:t},e.parameters&&(i.mutationChildren=[],e.parameters.forEach(e=>{const n=e.name.getText();let r=V(e.type.getText());pxt.U.endsWith(r,"[]")&&(r="Array"),i.mutationChildren.push({nodeName:"arg",attributes:{name:n,type:r,id:M.functionParamIds[t][n]}})}));return i.handlers=[{name:"STACK",statement:n}],i}(g);break;case s.CallExpression:_=function(n,r){const a=t.pxtInfo(n).callInfo,f=oe(a);if("Math.pow"==a.qName){const e=pe("math_arithmetic");return e.inputs=[he("A",Ee(n.arguments[0]),l),he("B",Ee(n.arguments[1]),l)],e.fields=[Fe("OP","POWER")],e}if(pxt.Util.startsWith(a.qName,"Math.")){const e=a.qName.substring(5);if(F(e)){let t;if(U(e))t=pe("math_js_round");else{let n;t=pe("math_js_op"),n=B(e)?"unary":$(e)?"infix":"binary",t.mutation={"op-type":n}}return t.inputs=a.args.map((e,t)=>he("ARG"+t,Ee(e),"math_number")),t.fields=[Fe("OP",e)],t}}if(f.blockId===t.PAUSE_UNTIL_TYPE){const e=de(t.PAUSE_UNTIL_TYPE,n),i=n.arguments[0];let r;return r=i.body.kind===s.Block?i.body.statements[0].expression:i.body,e.inputs=[he("PREDICATE",Ee(r),"logic_boolean")],e}if(!f.blockId||!f.block){const e=pxt.blocks.builtinFunctionInfo[a.qName];if(!e){const e=et(n.expression);if(M.declaredFunctions[e]){let t,i=!0;if(P(n,M)){const[e]=C(n);i=e&&e.kind===s.ExpressionStatement}return t=de(i?"function_call":"function_call_output",n),a.args.length&&(t.mutationChildren=[],t.inputs=[],M.declaredFunctions[e].parameters.forEach((n,i)=>{const r=n.name.getText(),s=M.functionParamIds[e][r];let o=V(n.type.getText());pxt.U.endsWith(o,"[]")&&(o="Array"),t.mutationChildren.push({nodeName:"arg",attributes:{name:r,type:o,id:s}});const l=he(s,Ee(a.args[i]));t.inputs.push(l)})),t.mutation={name:e},t}return Ge(n)}f.blockId=e.blockId}if(f.imageLiteral||f.gridLiteral)return function(e,n){let i=e.arguments[0];if(i.kind!=s.StringLiteral&&i.kind!=s.NoSubstitutionTemplateLiteral)return void se(e);const r=oe(n),o=de(r.blockId,e);o.fields=[];const a=(i.text||"").replace(/\s+/g,""),l=(r.imageLiteralColumns||5)*(r.imageLiteral||r.gridLiteral),c=r.imageLiteralRows||5,u=l*c;if(u!=a.length)return void se(e,t.Util.lf("Invalid image pattern ({0} expected vs {1} actual)",u,a.length));let d="";for(let e=0;e<c;++e){for(let t=0;t<l;++t)d+=/[#*1]/.test(a[e*l+t])?"#":".";d+="\n"}return o.fields.push(Fe("LEDS",`\`${d}\``)),o}(n,a);e.isFunctionLike(a.decl);const m=R(a,M),g=ae(a),_=r?pe(f.blockId):de(f.blockId,n),y=e=>(_.inputs||(_.inputs=[])).push(e),b=e=>(_.fields||(_.fields=[])).push(e);"Math.max"==a.qName&&b({kind:"field",name:"op",value:"max"});let v=0;if(m.forEach((e,n)=>{let r,m=e.value;const T=e.param,k=e.info,x=g.parameters[g.thisParameter?n-1:n],S=x&&x.range;if(S){const e=S.min,t=S.max;r={min:e.toString(),max:t.toString()}}if(0===n&&f.defaultInstance){if(m.getText()===f.defaultInstance)return;_.mutation={showing:"true"}}if(f.mutatePropertyEnum&&n===a.args.length-2)return;let C;if(T&&T.isOptional&&++v,T&&T.shadowBlockId&&(C=o.blocksById[T.shadowBlockId]),m.kind===s.CallExpression){const e=t.pxtInfo(m).callInfo,n=e&&oe(e);n&&"TD_ID"===n.shim&&k.isEnum&&(m=w(e.args[0]))}if(T&&k&&k.isEnum&&m.kind===s.Identifier)b(Fe(t.U.htmlEscape(T.definitionName),t.pxtInfo(m).commentAttrs.enumIdentity));else if(T&&T.fieldOptions&&T.fieldOptions[i.DecompileArgumentAsString])b(Fe(t.U.htmlEscape(T.definitionName),t.Util.htmlEscape(m.getText())));else switch(m.kind){case s.FunctionExpression:case s.ArrowFunction:const e=function(e){const n=E(e);if(n)return{callbackproperties:n[0].join(","),renamemap:t.Util.htmlEscape(JSON.stringify(n[1]))};return}(m);let v=!1;if(e)_.mutation=e;else{let e=m;const t=o.blocksById[f.blockId].parameters[g.thisParameter?n-1:n],i=(e,t)=>{"reporter"===f.draggableParameters?y(function(e,t,n){return he(e,Me(t,n,!0),void 0)}("HANDLER_DRAG_PARAM_"+e.name,t,e.type)):y(Pe("HANDLER_DRAG_PARAM_"+e.name,t))};if(e.parameters.length&&(f.optionalVariableArgs?(_.mutation={numargs:e.parameters.length.toString()},"reporter"===f.draggableParameters?e.parameters.forEach((e,n)=>{const r=t.handlerParameters[n];i(r,e.name.text)}):e.parameters.forEach((e,t)=>{_.mutation["arg"+t]=e.name.text})):e.parameters.forEach((e,n)=>{const r=t.handlerParameters[n];f.draggableParameters?i(r,e.name.text):b(Fe("HANDLER_"+r.name,e.name.text))})),f.draggableParameters){if(e.parameters.length<t.handlerParameters.length&&!f.optionalVariableArgs)for(let n=e.parameters.length;n<t.handlerParameters.length;n++){const e=t.handlerParameters[n];i(e,e.name)}"reporter"===f.draggableParameters&&(M.localReporters.push(t.handlerParameters),v=!0)}}const x=He(m);(_.handlers||(_.handlers=[])).push({name:"HANDLER",statement:x}),v&&M.localReporters.pop();break;case s.PropertyAccessExpression:const S=t.pxtInfo(m).callInfo,w=t.U.htmlEscape(T.definitionName),I=oe(S);C&&"TD_ID"===C.attributes.shim?y(he(w,$e(m,!1,T.shadowBlockId),T.shadowBlockId,r)):k&&k.isEnum||S&&(I.fixedInstance||I.blockIdentity===a.qName)?b(Fe(w,$e(m,!0).value)):y(Ne(w,m,T.shadowBlockId,r));break;case s.BinaryExpression:if(T&&T.shadowOptions&&T.shadowOptions.toString){const e=m;if(e.operatorToken.kind===s.PlusToken&&function(e){if(e.kind===s.StringLiteral||e.kind===s.NoSubstitutionTemplateLiteral)return""===e.text;return!1}(e.left)){y(Ne(t.U.htmlEscape(T.definitionName),e.right,T.shadowBlockId||"text"));break}}y(Ne(t.U.htmlEscape(T.definitionName),m,T.shadowBlockId,r));break;default:let A;const N=t.U.htmlEscape(T.definitionName);let O=!0;if("Math.random"==a.qName)A=he(N,function(e){switch(e.kind){case s.NumericLiteral:return De((parseInt(e.text)-1).toString());case s.BinaryExpression:const t=e;if(t.operatorToken.kind==s.PlusToken&&"1"==t.right.text)return Ee(t.left);default:return Ee(e)}}(m),l,r),O=!1;else if(D(m)){const e="text"==T.fieldEditor?m.text:m.getText(),n=T.shadowBlockId&&!function(e){switch(e){case l:case c:case u:case d:case p:case h:return!0;default:return!1}}(T.shadowBlockId);if(qe(T)&&T.fieldOptions.onParentBlock)return void b(Fe(N,e));if(n){const n=function(e){if(o.blocksById[e]){const t=pxt.blocks.compileInfo(o.blocksById[e]);if(!t.thisParameter&&1===t.parameters.length)return t.parameters[0]}return}(T.shadowBlockId);if(n&&qe(n)){const i=Le(T.shadowBlockId,n.definitionName,e,!0);T.shadowOptions&&(i.mutation={customfield:t.Util.htmlEscape(JSON.stringify(T.shadowOptions))}),A=he(N,i,T.shadowBlockId,r),O=!1}}}else if(m.kind===s.TaggedTemplateExpression&&T.fieldOptions&&T.fieldOptions[i.TaggedTemplate])return void b(Fe(N,t.Util.htmlEscape(m.getText())));O&&(A=Ne(N,m,T.shadowBlockId,r)),y(A)}}),v)if(_.mutation||(_.mutation={}),f.compileHiddenArguments){let e=0,n=0;for(const i of m){const r=t.U.htmlEscape(i.param.definitionName),s=_.inputs.find(e=>e.name===r);i.param.isOptional?s&&!q(s)&&(n=Math.max(i.param.definitionIndex-e+1,n)):e++}_.mutation._expanded=n.toString()}else _.mutation._expanded=v.toString();return _}(g,f);break;case s.DebuggerStatement:_=function(e){const n=de(t.TS_DEBUGGER_TYPE,e);return n}(g);break;case s.BreakStatement:_=function(e){const n=de(t.TS_BREAK_TYPE,e);return n}(g);break;case s.ContinueStatement:_=function(e){const n=de(t.TS_CONTINUE_TYPE,e);return n}(g);break;case s.EmptyStatement:_=void 0;break;case s.EnumDeclaration:case s.ModuleDeclaration:return W(g,ee),k();case s.ReturnStatement:_=function(e){const n=de(t.TS_RETURN_STATEMENT_TYPE,e);e.expression?n.inputs=[he("RETURN_VALUE",Ee(e.expression),l)]:n.mutation={no_return_value:"true"};return n}(g);break;default:return void se(g,r?t.Util.lf("Unsupported statement in block: {0}",s[g.kind]):t.Util.lf("Statement kind unsupported in blocks: {0}",s[g.kind]))}if(_){let e=_;for(;e.next;)e=e.next;e.next=k(),e.next&&(e.next.prev=e)}return y||Ve(a||g,_),_;function k(){if(r&&r.length)return He(r.shift(),r,void 0,!1,m)}}function Ge(e,n,i){m.errorOnGreyBlocks&&se(e);const r=de(t.TS_STATEMENT_TYPE,e);r.mutation={},Qe(e);let o=e.getText();o=Se(o,e.getStart(),e.getEnd()),W(e,ee),n&&(o=n+o);const a=[];if(e.kind===s.VariableStatement)for(const t of e.declarationList.declarations)a.push(et(t.name));else e.kind===s.VariableDeclaration&&a.push(et(e.name));a.length&&(r.mutation.declaredvars=a.join(","));const l=o.split("\n");return r.mutation.numlines=l.length.toString(),i&&m.includeGreyBlockMessages&&(r.mutation.error=t.U.htmlEscape(i)),l.forEach((e,n)=>{r.mutation[`line${n}`]=t.U.htmlEscape(e)}),r}function je(n,i){const r=function(n){const i=w(n);switch(i.kind){case s.TrueKeyword:case s.FalseKeyword:case s.Identifier:case s.ElementAccessExpression:return;case s.BinaryExpression:return r(i);case s.CallExpression:return o(i);case s.PrefixUnaryExpression:if(i.operator===s.ExclamationToken)return;default:return t.Util.lf("Conditions must evaluate to booleans or identifiers")}function r(e){switch(e.operatorToken.kind){case s.EqualsEqualsToken:case s.EqualsEqualsEqualsToken:case s.ExclamationEqualsToken:case s.ExclamationEqualsEqualsToken:case s.LessThanToken:case s.LessThanEqualsToken:case s.GreaterThanToken:case s.GreaterThanEqualsToken:case s.AmpersandAmpersandToken:case s.BarBarToken:return;default:return t.Util.lf("Binary expressions in conditionals must evaluate to booleans")}}function o(n){const i=t.pxtInfo(n).callInfo;if(i){const t=M.blocks.apis.byQName[i.qName];if(t&&"boolean"==t.retType)return;if(e.isIdentifier(n.expression)&&M.declaredFunctions[n.expression.text])return}return t.Util.lf("Only functions that return booleans are allowed as conditions")}}(i);if(r){return he(n,Ce(i),h)}return Ne(n,i,h)}function Ke(e,t,n,i=!1,r=!1){const s=et(t);Ze(s,b.InBlocksOnly);const o=de(i?"variables_change":"variables_set",e.parent||e);return o.inputs=[Ne("VALUE",n,l)],o.fields=[Fe("VAR",s)],o}function ze(e,t,n,i){return We(e,t,n,i)}function We(e,n,i,r){const s=t.pxtInfo(n).callInfo,o=M.blocks.apis.byQName[s?s.qName:""];if(!o||!o.attributes.blockCombine)return void se(n);const a=`${o.namespace}.${o.retType}.${r}`,l=M.blocks.blocks.find(e=>e.qName==a),c=i?de(l.attributes.blockId,e):pe(l.attributes.blockId),u=l.attributes._def.parameters;let d=s.qName;return l.combinedProperties&&l.combinedProperties.forEach(e=>{0===e.indexOf(s.qName)&&"@"===e.charAt(s.qName.length)&&(d=e)}),c.inputs=[Ne(u[0].name,n.expression)],c.fields=[Fe(u[1].name,d)],i&&c.inputs.push(Ne(u[2].name,i)),c}function qe(e){return e&&e.fieldOptions&&e.fieldOptions[i.DecompileLiterals]}function Je(e){let t={ifStatements:[{expression:e.expression,thenStatement:e.thenStatement}],elseStatement:e.elseStatement};if(e.elseStatement&&e.elseStatement.kind==s.IfStatement){let n=Je(e.elseStatement);t.ifStatements=t.ifStatements.concat(n.ifStatements),t.elseStatement=n.elseStatement}return t}function Ye(t,n,i=!1,r,o=!1){const a=[],l=n||[];for(let e=t.length-1;e>=0;e--){const n=t[e];(n.kind===s.FunctionDeclaration||n.kind==s.ExpressionStatement&&fe(n))&&!v(n,M,!1,i)?a.unshift(n):l.unshift(n)}const c=[],u={};for(const e of a){const t=e.kind===s.FunctionDeclaration?void 0:le(e);t&&u[t]?c.push(He(e,void 0,void 0,!1,!1)):(u[t]=!0,c.push(He(e,void 0,void 0,!1,i)))}if(c.forEach(me),l.length){const t=l.shift(),n=He(t,l,r,!1,i);if(o){let i=n,r=t;if(X.forEach(([e,n])=>{if(J[e]===b.InBlocksOnly)return;let s;n.initializer;s=J[e]===b.InTextBlocks?Ge(n,"let "):Ke(t,n.name,n.initializer,!1,!0),s.next=i,i=s,r=n,Ve(r.parent,i)}),i){const t=de(e.pxtc.ON_START_TYPE,r);return t.handlers=[{name:"HANDLER",statement:i}],t}Xe(n)}return n}o&&Xe(void 0)}function Xe(t){m.alwaysEmitOnStart&&(ke(e.pxtc.ON_START_TYPE,t),xe())}function Ze(e,t){J[e]!==b.InTextBlocks&&(J[e]=t)}function Qe(t){e.forEachChild(t,e=>{e.kind===s.Identifier&&Ze(et(e),b.InTextBlocks),Qe(e)})}function et(e){if(g){const t=g.getRenameForPosition(e.getStart());if(t)return t.name}return e.text}},n.getLeadingComments=function(t,n,i){return G(n,i||e.getLeadingCommentRangesOfNode(t,n))},n.getTrailingComments=function(t,n){return G(n,e.getTrailingCommentRanges(n.getFullText(),t.end))},n.getCommentsForStatement=function(e,t){let n,i=[];for(let r=0;r<t.length&&(n=t[r],!n.owner&&n.start>=e.pos&&n.end<=e.end&&(n.owner=e,i.push(n)),!(n.start>e.end));r++);return i},n.buildCommentMap=z}(t.decompiler||(t.decompiler={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(e){function t(e,n){var i;switch(e){case"void":return"None";case"boolean":return"bool";case"string":return"str"}if(null===(i=n.byQName[e])||void 0===i?void 0:i.pyQName)return n.byQName[e].pyQName;const r=/^(?:Array<(.+)>)|(?:(.+)\[\])|(?:\[.+\])$/.exec(e);return r?`List[${t(r[1]||r[2],n)}]`:e}function n(e,t){return`\`\`\`${t?"python":"ts"}\n${e}\n\`\`\``}e.displayStringForSymbol=function(e,i,r){if(e){switch(e.kind){case 3:case 1:return function(e,i,r){let s="";3===e.kind?s+=i?"def ":"function ":s+="(method) ";s+=i?e.pyQName:e.qName;let o="";e.parameters&&e.parameters.length&&(o=e.parameters.map(e=>`${e.name}: ${i?e.pyTypeString:e.type}`).join(", "));let a=e.retType||"void";i&&(a=t(a,r));return n(`${s}(${o}): ${a}`,i)}(e,i,r);case 6:case 7:return function(e,t){const i=t?e.pyQName:e.qName;if(6===e.kind)return n(`enum ${i}`,t);let r=`(enum member) ${i}`;e.attributes.enumval&&(r+=` = ${e.attributes.enumval}`);return n(r,!1)}(e,i);case 5:return function(e,t){return n(`namespace ${t?e.pyQName:e.qName}`,!1)}(e,i);case 9:return function(e,t){return n(`interface ${t?e.pyQName:e.qName}`,!1)}(e,i);case 8:return function(e,t){return n(`class ${t?e.pyQName:e.qName}`,t)}(e,i);case 4:return function(e,i,r){let s=i?e.pyQName:`let ${e.qName}`;if(e.retType){let o=e.retType;return i&&(o=t(o,r)),n(`${s}: ${o}`,i)}return n(s,i)}(e,i,r);case 2:return function(e,i,r){const s=`(property) ${i?e.pyQName:e.qName}`;if(e.retType){let o=e.retType;return i&&(o=t(o,r)),n(`${s}: ${o}`,!1)}return n(s,!1)}(e,i,r)}return`**${e.qName}**`}},e.displayStringForKeyword=function(e,t){return`\`\`\`${t?"py":"ts"}\n(keyword) ${e}\n\`\`\``}}(e.service||(e.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){const n={r0:0,r1:1,r2:2,r3:3,r4:4,r5:5,r6:6,r7:7,r8:8,r9:9,r10:10,r11:10,r12:12,sp:13,r13:13,lr:14,r14:14,pc:15,r15:15};class i extends e.assembler.AbstractProcessor{constructor(){super(),this.addEnc("$r0","R0-7",e=>this.inrange(7,e,e)),this.addEnc("$r1","R0-7",e=>this.inrange(7,e,e<<3)),this.addEnc("$r2","R0-15",e=>this.inrange(15,e,7&e|(8&e)<<4)),this.addEnc("$r3","R0-15",e=>this.inrange(15,e,e<<3)),this.addEnc("$r4","R0-7",e=>this.inrange(7,e,e<<6)),this.addEnc("$r5","R0-7",e=>this.inrange(7,e,e<<8)),this.addEnc("$r01","R0-7",e=>this.inrange(7,e,e|e<<3)),this.addEnc("$i0","#0-255",e=>this.inrange(255,e,e)),this.addEnc("$i1","#0-1020",e=>this.inrange(255,e/4,e>>2)),this.addEnc("$i2","#0-510",e=>this.inrange(127,e/4,e>>2)),this.addEnc("$i3","#0-7",e=>this.inrange(7,e,e<<6)),this.addEnc("$i4","#0-31",e=>this.inrange(31,e,e<<6)),this.addEnc("$i5","#0-124",e=>this.inrange(31,e/4,e>>2<<6)),this.addEnc("$i6","#1-32",e=>0==e?null:32==e?0:this.inrange(31,e,e<<6)),this.addEnc("$i7","#0-62",e=>this.inrange(31,e/2,e>>1<<6)),this.addEnc("$i32","#0-2^32",e=>1),this.addEnc("$rl0","{R0-7,...}",e=>this.inrange(255,e,e)),this.addEnc("$rl1","{LR,R0-7,...}",e=>16384&e?this.inrange(255,-16385&e,256|255&e):this.inrange(255,e,e)),this.addEnc("$rl2","{PC,R0-7,...}",e=>32768&e?this.inrange(255,-32769&e,256|255&e):this.inrange(255,e,e)),this.addEnc("$la","LABEL",e=>this.inrange(255,e/4,e>>2)).isWordAligned=!0,this.addEnc("$lb","LABEL",e=>this.inrangeSigned(127,e/2,e>>1)),this.addEnc("$lb11","LABEL",e=>this.inrangeSigned(1023,e/2,e>>1)),this.addInst("adcs  $r0, $r1",16704,65472),this.addInst("add   $r2, $r3",17408,65280),this.addInst("add   $r5, pc, $i1",40960,63488),this.addInst("add   $r5, sp, $i1",43008,63488),this.addInst("add   sp, $i2",45056,65408).canBeShared=!0,this.addInst("adds  $r0, $r1, $i3",7168,65024),this.addInst("adds  $r0, $r1, $r4",6144,65024),this.addInst("adds  $r01, $r4",6144,65024),this.addInst("adds  $r5, $i0",12288,63488),this.addInst("adr   $r5, $la",40960,63488),this.addInst("ands  $r0, $r1",16384,65472),this.addInst("asrs  $r0, $r1",16640,65472),this.addInst("asrs  $r0, $r1, $i6",4096,63488),this.addInst("bics  $r0, $r1",17280,65472),this.addInst("bkpt  $i0",48640,65280),this.addInst("blx   $r3",18304,65415),this.addInst("bx    $r3",18176,65408),this.addInst("cmn   $r0, $r1",17088,65472),this.addInst("cmp   $r0, $r1",17024,65472),this.addInst("cmp   $r2, $r3",17664,65280),this.addInst("cmp   $r5, $i0",10240,63488),this.addInst("eors  $r0, $r1",16448,65472),this.addInst("ldmia $r5!, $rl0",51200,63488),this.addInst("ldmia $r5, $rl0",51200,63488),this.addInst("ldr   $r0, [$r1, $i5]",26624,63488),this.addInst("ldr   $r0, [$r1, $r4]",22528,65024),this.addInst("ldr   $r5, [pc, $i1]",18432,63488),this.addInst("ldr   $r5, $la",18432,63488),this.addInst("ldr   $r5, [sp, $i1]",38912,63488).canBeShared=!0,this.addInst("ldr   $r5, [sp]",38912,63488).canBeShared=!0,this.addInst("ldrb  $r0, [$r1, $i4]",30720,63488),this.addInst("ldrb  $r0, [$r1, $r4]",23552,65024),this.addInst("ldrh  $r0, [$r1, $i7]",34816,63488),this.addInst("ldrh  $r0, [$r1, $r4]",23040,65024),this.addInst("ldrsb $r0, [$r1, $r4]",22016,65024),this.addInst("ldrsh $r0, [$r1, $r4]",24064,65024),this.addInst("lsls  $r0, $r1",16512,65472),this.addInst("lsls  $r0, $r1, $i4",0,63488),this.addInst("lsrs  $r0, $r1",16576,65472),this.addInst("lsrs  $r0, $r1, $i6",2048,63488),this.addInst("mov   $r2, $r3",17920,65280),this.addInst("movs  $r0, $r1",0,65472),this.addInst("movs  $r5, $i0",8192,63488),this.addInst("muls  $r0, $r1",17216,65472),this.addInst("mvns  $r0, $r1",17344,65472),this.addInst("negs  $r0, $r1",16960,65472),this.addInst("nop",18112,65535),this.addInst("orrs  $r0, $r1",17152,65472),this.addInst("pop   $rl2",48128,65024),this.addInst("push  $rl1",46080,65024),this.addInst("rev   $r0, $r1",47616,65472),this.addInst("rev16 $r0, $r1",47680,65472),this.addInst("revsh $r0, $r1",47808,65472),this.addInst("rors  $r0, $r1",16832,65472),this.addInst("sbcs  $r0, $r1",16768,65472),this.addInst("sev",48960,65535),this.addInst("stm   $r5!, $rl0",49152,63488),this.addInst("stmia $r5!, $rl0",49152,63488),this.addInst("stmea $r5!, $rl0",49152,63488),this.addInst("str   $r0, [$r1, $i5]",24576,63488).canBeShared=!0,this.addInst("str   $r0, [$r1]",24576,63488).canBeShared=!0,this.addInst("str   $r0, [$r1, $r4]",20480,65024),this.addInst("str   $r5, [sp, $i1]",36864,63488).canBeShared=!0,this.addInst("str   $r5, [sp]",36864,63488).canBeShared=!0,this.addInst("strb  $r0, [$r1, $i4]",28672,63488),this.addInst("strb  $r0, [$r1, $r4]",21504,65024),this.addInst("strh  $r0, [$r1, $i7]",32768,63488),this.addInst("strh  $r0, [$r1, $r4]",20992,65024),this.addInst("sub   sp, $i2",45184,65408),this.addInst("subs  $r0, $r1, $i3",7680,65024),this.addInst("subs  $r0, $r1, $r4",6656,65024),this.addInst("subs  $r01, $r4",6656,65024),this.addInst("subs  $r5, $i0",14336,63488),this.addInst("svc   $i0",57088,65280),this.addInst("sxtb  $r0, $r1",45632,65472),this.addInst("sxth  $r0, $r1",45568,65472),this.addInst("tst   $r0, $r1",16896,65472),this.addInst("udf   $i0",56832,65280),this.addInst("uxtb  $r0, $r1",45760,65472),this.addInst("uxth  $r0, $r1",45696,65472),this.addInst("wfe",48928,65535),this.addInst("wfi",48944,65535),this.addInst("yield",48912,65535),this.addInst("cpsid i",46706,65535),this.addInst("cpsie i",46690,65535),this.addInst("beq   $lb",53248,65280),this.addInst("bne   $lb",53504,65280),this.addInst("bcs   $lb",53760,65280),this.addInst("bcc   $lb",54016,65280),this.addInst("bmi   $lb",54272,65280),this.addInst("bpl   $lb",54528,65280),this.addInst("bvs   $lb",54784,65280),this.addInst("bvc   $lb",55040,65280),this.addInst("bhi   $lb",55296,65280),this.addInst("bls   $lb",55552,65280),this.addInst("bge   $lb",55808,65280),this.addInst("blt   $lb",56064,65280),this.addInst("bgt   $lb",56320,65280),this.addInst("ble   $lb",56576,65280),this.addInst("bhs   $lb",53760,65280),this.addInst("blo   $lb",54016,65280),this.addInst("b     $lb11",57344,63488),this.addInst("bal   $lb11",57344,63488),this.addInst("bl    $lb",61440,63488,!0),this.addInst("bb    $lb",57344,63488,!0),this.addInst("ldlit   $r5, $i32",18432,63488)}toFnPtr(t,n,i){return e.target.runtimeIsARM&&/::/.test(i)?t+n&-2:t+n|1}wordSize(){return 4}is32bit(e){return"bl"==e.name||"bb"==e.name}postProcessAbsAddress(e,t){return t^=1,t-=e.baseOffset}emit32(t,n,i){let r=!!(n%2);r&&(n=n+1&-4);let s=n>>1;if(e.assert(null!=s),(0|s)!=s||!(-2097152<s&&s<2097152))return e.assembler.emitErr("jump out of range",i);let o=2047&s,a=s>>11&1023;return{opcode:4026531840&s?62464|a:61440|a,opcode2:r?59392|o:63488|o,stack:0,numArgs:[n],labelName:i}}expandLdlit(t){let n,i=!1,r=[],s={},o=1;const a=e=>"instruction"==e.type&&e.instruction&&"ldlit"==e.instruction.name;for(let l=0;l<t.lines.length;++l){let c=t.lines[l];if(r.push(c),a(c)){if(!n){let e=c.location+900,r=l+1,s=0;for(;r<t.lines.length&&!(t.lines[r].location>e)&&!(a(t.lines[r])&&(s++,s>=40));++r){let e=t.lines[r].getOp();("b"==e||"bb"==e||"pop"==e&&"pc"==t.lines[r].words[2])&&(n=t.lines[r])}if(n)i=!1;else for(i=!0;--r>l;)if("instruction"==t.lines[r].type){n=t.lines[r];break}}let r=c.words[1],u="#"+c.words[3],d=e.U.lookup(s,u);d||(d="_ldlit_"+ ++o,s[u]=d),c.ldlitLabel=c.words[3],c.update(`ldr ${r}, ${d} ; ${c.ldlitLabel}`)}if(c===n){n=null;let e=[],a="_jmpwords_"+ ++o;i&&e.push("bb "+a),e.push(".object PUSH"),e.push(".balign 4");for(let t of Object.keys(s)){let n=s[t];e.push(n+": .word "+t.slice(1))}i&&e.push(a+":"),e.push(".object POP");for(let n of e){t.buildLine(n,r);let e=r[r.length-1];e.scope=c.scope,e.lineNo=c.lineNo}s={}}}t.lines=r}getAddressFromLabel(e,t,n,i=!1){let r=e.lookupLabel(n);if(null==r)return null;let s=e.location()+4;return i&&(s&=4294967292),r-s}isPop(e){return 48128==e}isPush(e){return 46080==e}isAddSP(e){return 45056==e}isSubSP(e){return 45184==e}peephole(t,n,i){let s=this.encoders.$lb11,o=this.encoders.$lb;function a(e,t){return null!=e.encode(t.numArgs[0]+8)&&null!=e.encode(t.numArgs[0]-8)&&null!=e.encode(t.numArgs[0])}let l=t.getOp(),c=!1;"bne"!=l&&"beq"!=l||("b"==n.getOp()&&0==t.numArgs[0]&&(c=!0),"bb"==n.getOp()&&2==t.numArgs[0]&&(c=!0)),"bb"==l&&a(s,t)?t.update("b "+t.words[1]):"b"==l&&-2==t.numArgs[0]?t.update(""):"bne"==l&&c&&a(o,n)?(t.update("beq "+n.words[1]),n.update("")):"beq"==l&&c&&a(o,n)?(t.update("bne "+n.words[1]),n.update("")):"push"!=l||16384!=t.numArgs[0]||"push"!=n.getOp()||16384&n.numArgs[0]?"pop"==l&&"pop"==n.getOp()&&32768==n.numArgs[0]?(t.update(t.text.replace("}",", pc}")),n.update("")):"push"==l&&"pop"==n.getOp()&&t.numArgs[0]==n.numArgs[0]?(e.assert(t.numArgs[0]>0),t.update(""),n.update("")):"push"==l&&"pop"==n.getOp()&&4==t.words.length&&4==n.words.length?(e.assert("{"==t.words[1]),t.update("mov "+n.words[2]+", "+t.words[2]),n.update("")):i&&"movs $r5, $i0"==t.getOpExt()&&"mov $r0, $r1"==n.getOpExt()&&t.numArgs[0]==n.numArgs[1]&&function(e,t){return!!("pop"==e.getOp()&&e.numArgs[0]&1<<t)}(i,t.numArgs[0])?(t.update("movs r"+n.numArgs[0]+", #"+t.numArgs[1]),n.update("")):"pop"==l&&r(t)>=0&&"push"==n.getOp()&&r(t)==r(n)?(t.update("ldr r"+r(t)+", [sp, #0]"),n.update("")):"push"==l&&"ldr $r5, [sp, $i1]"==n.getOpExt()&&r(t)==n.numArgs[0]&&0==n.numArgs[1]?n.update(""):i&&"push"==l&&r(t)>=0&&function(e,t){return"movs $r5, $i0"==e.getOpExt()&&e.numArgs[0]!=t}(n,r(t))&&"pop"==i.getOp()&&r(t)==r(i)&&(t.update(""),i.update("")):(t.update(n.text.replace("{","{lr, ")),n.update(""))}registerNo(e){if(!e)return null;e=e.toLowerCase();const t=n[e];return void 0===t?null:t}testAssembler(){e.assembler.expectError(this,"lsl r0, r0, #8"),e.assembler.expectError(this,"push {pc,lr}"),e.assembler.expectError(this,"push {r17}"),e.assembler.expectError(this,"mov r0, r1 foo"),e.assembler.expectError(this,"movs r14, #100"),e.assembler.expectError(this,"push {r0"),e.assembler.expectError(this,"push lr,r0}"),e.assembler.expectError(this,"pop {lr,r0}"),e.assembler.expectError(this,"b #+11"),e.assembler.expectError(this,"b #+102400"),e.assembler.expectError(this,"bne undefined_label"),e.assembler.expectError(this,".foobar"),e.assembler.expect(this,"0200      lsls    r0, r0, #8\nb500      push    {lr}\n2064      movs    r0, #100        ; 0x64\nb401      push    {r0}\nbc08      pop     {r3}\nb501      push    {r0, lr}\nbd20      pop {r5, pc}\nbc01      pop {r0}\n4770      bx      lr\n0000      .balign 4\ne6c0      .word   -72000\nfffe\n"),e.assembler.expect(this,"4291      cmp     r1, r2\nd100      bne     l6\ne000      b       l8\n1840  l6: adds    r0, r0, r1\n4718  l8: bx      r3\n"),e.assembler.expect(this,"          @stackmark base\nb403      push    {r0, r1}\n          @stackmark locals\n9801      ldr     r0, [sp, locals@1]\nb401      push    {r0}\n9802      ldr     r0, [sp, locals@1]\nbc01      pop     {r0}\n          @stackempty locals\n9901      ldr     r1, [sp, locals@1]\n9102      str     r1, [sp, base@0]\n          @stackempty locals\nb002      add     sp, #8\n          @stackempty base\n"),e.assembler.expect(this,"b090      sub sp, #4*16\nb010      add sp, #4*16\n"),e.assembler.expect(this,'6261      .string "abc"\n0063      \n'),e.assembler.expect(this,'6261      .string "abcde"\n6463      \n0065      \n'),e.assembler.expect(this,"3042      adds r0, 0x42\n1c0d      adds r5, r1, #0\nd100      bne #0\n2800      cmp r0, #0\n6b28      ldr r0, [r5, #48]\n0200      lsls r0, r0, #8\n2063      movs r0, 0x63\n4240      negs r0, r0\n46c0      nop\nb500      push {lr}\nb401      push {r0}\nb402      push {r1}\nb404      push {r2}\nb408      push {r3}\nb520      push {r5, lr}\nbd00      pop {pc}\nbc01      pop {r0}\nbc02      pop {r1}\nbc04      pop {r2}\nbc08      pop {r3}\nbd20      pop {r5, pc}\n9003      str r0, [sp, #4*3]\n")}}function r(t){e.assert("push"==t.getOp()||"pop"==t.getOp());let n=0,i=-1,r=t.numArgs[0];for(;r>0;)1&r&&(i=-1==i?n:-2),r>>=1,n++;return i>=0?i:-1}t.ThumbProcessor=i}(e.thumb||(e.thumb={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){let i,r=t.Util;r.assert;!function(e){e[e.None=0]="None",e[e.NumberLiteral=1]="NumberLiteral",e[e.PointerLiteral=2]="PointerLiteral",e[e.RuntimeCall=3]="RuntimeCall",e[e.ProcCall=4]="ProcCall",e[e.SharedRef=5]="SharedRef",e[e.SharedDef=6]="SharedDef",e[e.FieldAccess=7]="FieldAccess",e[e.Store=8]="Store",e[e.CellRef=9]="CellRef",e[e.Sequence=10]="Sequence",e[e.JmpValue=11]="JmpValue",e[e.Nop=12]="Nop",e[e.InstanceOf=13]="InstanceOf"}(i=n.EK||(n.EK={}));let s,o,a=0;class l{isExpr(){return!1}isStmt(){return!1}getId(){return this._id||(this._id=++a),this._id}}n.Node=l;class c extends l{constructor(e,t,n){super(),this.exprKind=e,this.args=t,this.data=n,this.callingConvention=0}static clone(e){let t=new c(e.exprKind,e.args?e.args.slice(0):null,e.data);return e.jsInfo&&(t.jsInfo=e.jsInfo),e.totalUses&&(t.totalUses=e.totalUses,t.currUses=e.currUses),t.callingConvention=e.callingConvention,t.mask=e.mask,t.isStringLiteral=e.isStringLiteral,t}reset(){this.currUses=0,this.prevTotalUses&&(this.totalUses=this.prevTotalUses)}ptrlabel(){return this.jsInfo instanceof u?this.jsInfo:null}hexlit(){const e=this.jsInfo;return null!=e.hexlit?e.hexlit:null}isExpr(){return!0}isPure(){return this.isStateless()||this.exprKind==i.CellRef}isLiteral(){switch(this.exprKind){case i.NumberLiteral:case i.PointerLiteral:return!0;default:return!1}}isStateless(){switch(this.exprKind){case i.NumberLiteral:case i.PointerLiteral:case i.SharedRef:return!0;default:return!1}}sharingInfo(){let e=this,t=this.getId();return this.exprKind!=i.SharedRef&&this.exprKind!=i.SharedDef||(e=this.args[0],e?t=e.getId():e={currUses:"",totalUses:""}),`${e.currUses}/${e.totalUses} #${t}`}toString(){return d(this)}canUpdateCells(){switch(this.exprKind){case i.NumberLiteral:case i.PointerLiteral:case i.CellRef:case i.JmpValue:case i.SharedRef:case i.Nop:return!1;case i.SharedDef:case i.FieldAccess:case i.InstanceOf:return this.args[0].canUpdateCells();case i.RuntimeCall:case i.ProcCall:case i.Sequence:case i.Store:return!0;default:throw t.oops()}}}n.Expr=c,function(e){e[e.None=0]="None",e[e.Expr=1]="Expr",e[e.Label=2]="Label",e[e.Jmp=3]="Jmp",e[e.StackEmpty=4]="StackEmpty",e[e.Breakpoint=5]="Breakpoint",e[e.Comment=6]="Comment"}(s=n.SK||(n.SK={})),function(e){e[e.Always=1]="Always",e[e.IfZero=2]="IfZero",e[e.IfNotZero=3]="IfNotZero"}(o=n.JmpMode||(n.JmpMode={})),n.lblNumUsesJmpNext=-101;class u extends l{constructor(e,t){super(),this.stmtKind=e,this.expr=t}isStmt(){return!0}toString(){return d(this)}}function d(e){return function e(r){if(r.isExpr()){let n=r,s=n.args?n.args[0]:null;switch(n.exprKind){case i.NumberLiteral:case i.PointerLiteral:return n.data+"";case i.CellRef:return n.data.toString();case i.JmpValue:return"JMPVALUE";case i.Nop:return"NOP";case i.SharedRef:return`SHARED_REF(#${s.getId()})`;case i.SharedDef:return`SHARED_DEF(#${s.getId()} u(${s.totalUses}): ${e(s)})`;case i.FieldAccess:return`${e(s)}.${n.data.name}`;case i.RuntimeCall:return n.data+"("+n.args.map(e).join(", ")+")";case i.ProcCall:let r=n.data,o="";return o=null!=r.ifaceIndex?`IFACE@${r.ifaceIndex}`:null!=r.virtualIndex?`VTABLE@${r.virtualIndex}`:t.getDeclName(r.proc.action),o+"("+n.args.map(e).join(", ")+")";case i.Sequence:return"("+n.args.map(e).join("; ")+")";case i.InstanceOf:return"("+e(n.args[0])+" instanceof "+n.data.id+")";case i.Store:return`{ ${e(n.args[0])} := ${e(n.args[1])} }`;default:throw t.oops()}}else{let i=r,s=i.expr?e(i.expr):"{null}";switch(i.stmtKind){case n.SK.Expr:return"    "+s+"\n";case n.SK.Jmp:let e=`goto ${i.lblName}\n`;switch(i.jmpMode){case o.Always:return i.expr?`    { JMPVALUE := ${s} } ${e}`:"    "+e;case o.IfZero:return`    if (! ${s}) ${e}`;case o.IfNotZero:return`    if (${s}) ${e}`;default:throw t.oops()}case n.SK.StackEmpty:return"    ;\n";case n.SK.Breakpoint:return"    // brk "+i.breakpointInfo.id+"\n";case n.SK.Comment:return"    // "+i.expr.data+"\n";case n.SK.Label:return i.lblName+":\n";default:throw t.oops()}}}(e)}n.Stmt=u;class p{constructor(e,n,i){this.index=e,this.def=n,this.info=i,this.isarg=!1,this.iscap=!1,this._isLocal=!1,this._isGlobal=!1,this._debugType="?",this.isUserVariable=!1,this.bitSize=0,n&&(t.isInPxtModules(n)||(this.isUserVariable=!0),i&&t.setCellProps(this))}getName(){return t.getDeclName(this.def)}getDebugInfo(){return{name:this.getName(),type:this._debugType,index:this.index}}toString(){let e="";return this.def&&(e+=this.getName()||"?"),this.isarg&&(e="ARG "+e),"["+e+"]"}uniqueName(){return this.isarg?"arg"+this.index:this.getName().replace(/[^\w]/g,"_")+"___"+t.getNodeId(this.def)}isLocal(){return this._isLocal}isGlobal(){return this._isGlobal}loadCore(){return _(i.CellRef,null,this)}load(){let e=this.loadCore();return t.target.isNative&&!t.isStackMachine()&&0!=this.bitSize?6==this.bitSize?b("pxt::fromUInt",[e]):b("pxt::fromInt",[e]):this.isByRefLocal()?b("pxtrt::ldlocRef",[e]):e}isByRefLocal(){return this.isLocal()&&this.info.captured&&this.info.written}storeDirect(e){return _(i.Store,[this.loadCore(),e])}storeByRef(e){if(this.isByRefLocal())return b("pxtrt::stlocRef",[this.loadCore(),e]);if(t.target.isNative&&!t.isStackMachine()&&0!=this.bitSize){let t=6==this.bitSize?"pxt::toUInt":"pxt::toInt";return this.storeDirect(b(t,[e],1))}return this.storeDirect(e)}get isTemporary(){return!1}}n.Cell=p;class h extends p{constructor(e,t){super(e,null,null),this.index=e,this.owningProc=t,this.uid=h.unnamedCellCounter++}getName(){return"unnamed"+this.uid}uniqueName(){return this.getName()+"___U"+this.index}isByRefLocal(){return!1}get isTemporary(){return!0}}function f(e){const t=()=>{if(!e.args)return 0;let t=0;for(let n of e.args)t+=f(n);return e.mask&&e.mask.conversions&&(t+=4*e.mask.conversions.length),t};switch(e.exprKind){case i.NumberLiteral:return 2;case i.PointerLiteral:return 6;case i.RuntimeCall:return t()+2+2+4;case i.CellRef:return 2;case i.FieldAccess:return t()+(e.data.needsCheck?4:0)+2;case i.ProcCall:case i.SharedRef:case i.SharedDef:case i.Store:case i.Sequence:case i.JmpValue:case i.Nop:case i.InstanceOf:return 1e6;default:throw r.oops()}}function m(e,t){switch((e=c.clone(e)).exprKind){case i.PointerLiteral:case i.NumberLiteral:return e;case i.RuntimeCall:for(let t=0;t<e.args.length;++t)e.args[t]=m(e.args[t],!0);return e;case i.CellRef:const n=e.data;return n.repl?n.repl.exprKind===i.CellRef&&t?c.clone(n.repl):(n.replUses++,n.repl):e;case i.FieldAccess:return e.args[0]=m(e.args[0]),e;default:throw r.oops()}}h.unnamedCellCounter=0,n.UnnamedCell=h;function g(e,t){return new u(e,t)}function _(e,t,n){return new c(e,t,n)}function y(e,t){let n=_(i.PointerLiteral,null,e);return n.jsInfo=t,n}function b(e,t,n=0){let r=_(i.RuntimeCall,t,e);return n&&(r.mask={refMask:n}),r}function v(e,s=!1,o=!1){let a=!!s&&e.some(e=>e.canUpdateCells()),l=[];for(let t of r.reversed(e))t.isStateless()||(t.exprKind!=i.CellRef||a)&&(t.canUpdateCells()&&(a=!0),l.push(t));l.reverse(),t.isStackMachine()&&!o&&(l=[]);let c=[],u=e.map(e=>{if(l.indexOf(e)>=0){let t=e,r=e;return e.exprKind==i.SharedDef?(e.args[0].totalUses++,t=n.op(i.SharedRef,[e.args[0]])):(t=n.op(i.SharedRef,[e]),r=n.op(i.SharedDef,[e]),e.totalUses=2,e.currUses=0),c.push(r),t}return e});return{precomp:c,flattened:u}}n.Procedure=class extends l{constructor(){super(...arguments),this.numArgs=0,this.info=null,this.seqNo=-1,this.isRoot=!1,this.locals=[],this.captured=[],this.args=[],this.parent=null,this.debugInfo=null,this.fillDebugInfo=null,this.classInfo=null,this.perfCounterName=null,this.perfCounterNo=0,this.body=[],this.lblNo=0,this.action=null,this.cachedJS=null,this.cachedJSHexLiterals={},this.usingCtx=null}reset(){this.body=[],this.lblNo=0,this.locals=[],this.captured=[],this.args=[]}isGetter(){return this.action&&this.action.kind==e.SyntaxKind.GetAccessor}vtLabel(){return this.label()+(t.isStackMachine()?"":"_args")}label(){return t.getFunctionLabel(this.action)}toString(){return`\nPROC ${t.getDeclName(this.action)}\n${this.body.map(e=>e.toString()).join("")}\n`}emit(e){this.body.push(e)}emitExpr(e){this.emit(g(s.Expr,e))}mkLabel(e){let t=g(s.Label,null);return t.lblName="."+e+"_"+this.lblNo+++"_"+this.seqNo,t.lbl=t,t}emitLbl(e){this.emit(e)}emitLblDirect(e){let t=g(s.Label,null);t.lblName=e,t.lbl=t,this.emit(t)}getFullName(){let n=t.getDeclName(this.action);if(this.action){let t=e.pxtc.nodeLocationInfo(this.action);n=t.fileName.replace("pxt_modules/","")+"("+(t.line+1)+","+(t.column+1)+"): "+n}return n}getName(){return(this.action&&this.action.name?this.action.name.text:null)||"inline"}mkLocal(e,t){let n=new p(this.locals.length,e,t);return this.locals.push(n),n}mkLocalUnnamed(){let e=new h(this.locals.length,this);return this.locals.push(e),e}localIndex(e,t=!1){return this.captured.filter(t=>t.def==e)[0]||this.locals.filter(t=>t.def==e)[0]||(t?null:this.args.filter(t=>t.def==e)[0])}stackEmpty(){this.emit(g(s.StackEmpty,null))}emitJmpZ(e,t){this.emitJmp(e,t,o.IfZero)}emitJmp(e,t,n=o.Always,r=null){let a=g(s.Jmp,t);a.jmpMode=n,r&&r.exprKind==i.NumberLiteral&&(r=null),a.terminateExpr=r,"string"==typeof e?a.lblName=e:(a.lbl=e,a.lblName=a.lbl.lblName),this.emit(a)}inlineSelf(e){const{precomp:t,flattened:n}=v(e,!1,!0);r.assert(n.length==this.args.length),this.args.map((e,t)=>{e.repl=n[t],e.replUses=0});const s=m(this.inlineBody);return this.args.forEach((e,t)=>{e.repl.exprKind==i.SharedRef&&(e.repl.args[0].prevTotalUses||(e.repl.args[0].prevTotalUses=e.repl.args[0].totalUses),e.repl.args[0].totalUses+=e.replUses-1),e.repl=null,e.replUses=0}),t.length?(t.push(s),_(i.Sequence,t)):s}resolve(){let e=(e,t)=>{if(e.args)for(let n=0;n<e.args.length;++n)e.args[n]=t(e.args[n])},s=t=>{switch(t.exprKind){case i.SharedDef:throw r.oops();case i.SharedRef:let e=t.args[0];if(e.totalUses)return e.totalUses--,t;{e.totalUses=-1,e.currUses=0,e.irCurrUses=0;let n=c.clone(t);return n.exprKind=i.SharedDef,n.args[0]=s(n.args[0]),n}}return e(t,s),t},o=t=>{if(t.exprKind==i.SharedRef)return t;if(e(t,o),t.exprKind===i.Sequence)t.args=t.args.filter((e,n)=>n==t.args.length-1||!e.isPure()||(e.exprKind==i.SharedRef&&e.args[0].totalUses>0&&e.args[0].totalUses--,!1));return t},a=t=>{switch(t.exprKind){case i.SharedDef:let e=t.args[0];if(r.assert(e.totalUses<0,"arg.totalUses < 0"),r.assert(0===e.currUses,"arg.currUses === 0"),-1==e.totalUses)return a(e);e.totalUses=1;break;case i.SharedRef:return r.assert(t.args[0].totalUses>0,"e.args[0].totalUses > 0"),t.args[0].totalUses++,t;case i.PointerLiteral:const n=t.ptrlabel();n&&(n.lblNumUses||(n.lblNumUses=0),n.lblNumUses++)}return e(t,a),t},l=t=>{switch(t.exprKind){case i.SharedDef:e(t,l);case i.SharedRef:let n=t.args[0];return r.assert(n.totalUses>0,"arg.totalUses > 0"),1==n.totalUses?(r.assert(t.exprKind==i.SharedDef),n):(n.irCurrUses++,t);default:return e(t,l),t}};this.body=this.body.filter(e=>!e.expr||(e.expr=o(s(e.expr)),e.stmtKind!=n.SK.Expr||!e.expr.isPure()));let u=r.toDictionary(this.body.filter(e=>e.stmtKind==n.SK.Label),e=>e.lblName);for(let e=0;e<this.body.length;++e)this.body[e].stmtNo=e;for(let e of this.body)switch(e.expr&&(e.expr=a(e.expr)),e.stmtKind){case n.SK.Expr:break;case n.SK.Jmp:e.lbl=r.lookup(u,e.lblName),e.lbl||t.oops("missing label: "+e.lblName),e.lbl.lblNumUses?e.lbl.lblNumUses++:e.lbl.lblNumUses=1;break;case n.SK.StackEmpty:case n.SK.Label:case n.SK.Breakpoint:case n.SK.Comment:break;default:t.oops()}let d=[],p=null,h=!t.target.debugMode,m=null;for(let e of this.body)e.expr&&(e.expr=o(l(e.expr))),p&&p.lbl==e&&p.stmtKind==n.SK.Jmp&&e.stmtKind==n.SK.Label&&p.jmpMode==n.JmpMode.Always&&1==e.lblNumUses&&(e.lblNumUses=n.lblNumUsesJmpNext),p=e,e.stmtKind==n.SK.Breakpoint?d[e.breakpointInfo.id]=e.breakpointInfo:h&&(e.stmtKind==n.SK.Jmp?e.expr&&(m?h=!1:m=e.expr):e.stmtKind==n.SK.StackEmpty||(e.stmtKind==n.SK.Label?e.lblNumUses!=n.lblNumUsesJmpNext&&(h=!1):h=!1));if(h&&m){f(m)<=4*this.args.length+4+2+(t.target.isNative?4:30)&&(this.inlineBody=m)}pxt.options.debug&&pxt.debug(this.toString())}},n.iterExpr=function e(t,n){if(n(t),t.args)for(let i of t.args)e(i,n)},n.stmt=g,n.comment=function(e){return g(s.Comment,y(e,e))},n.op=_,n.numlit=function(e){return _(i.NumberLiteral,null,e)},n.shared=function(e){switch(e.exprKind){case i.SharedRef:e=e.args[0];break;case i.NumberLiteral:return e}return _(i.SharedRef,[e])},n.ptrlit=y,n.rtcall=b,n.rtcallMask=function(e,t,n,i){r.startsWith(e,"@nomask@")&&(e=e.slice(8),t=0);let s=b(e,i,t);return s.callingConvention=n,s},n.flattenArgs=v}(t.ir||(t.ir={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){class n{constructor(e,t){this.wave=e,this.id=t,this.flags=0,this.resetAll()}refresh(){this.flags&=-9,!this.proc||this.usedActions||A(this.proc.action)?this.proc&&!this.proc.cachedJS?this.resetEmit():this.usedNodes&&(this.flags|=32):this.resetEmit(),this.classInfo&&this.classInfo.reset()}resetEmit(){this.flags&=-41,this.proc&&this.proc.classInfo&&this.proc.classInfo.ctor==this.proc&&(this.proc.classInfo.ctor=null),this.functionInfo=null,this.variableInfo=null,this.classInfo=null,this.callInfo=null,this.proc=null,this.cell=null,this.exprInfo=null,this.usedNodes=null,this.usedActions=null}resetTSC(){this.flags&=16,this.typeCache=null,this.symbolCache=null,this.commentAttrs=null,this.valueOverride=null,this.declCache=void 0,this.fullName=null,this.constantFolded=void 0}resetAll(){this.resetTSC(),this.resetEmit()}}let i;function r(e){return e<<2|2}t.PxtNode=n,function(e){e[e.Enum=0]="Enum",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Unsupported=4]="Unsupported"}(i||(i={})),t.taggedUndefined=0,t.taggedNull=r(1),t.taggedFalse=r(2),t.taggedNaN=r(3),t.taggedTrue=r(16),t.thumbArithmeticInstr={adds:!0,subs:!0,muls:!0,ands:!0,orrs:!0,eors:!0,lsls:!0,asrs:!0,lsrs:!0},t.numberArithmeticInstr={div:!0,mod:!0,le:!0,lt:!0,ge:!0,gt:!0,eq:!0,neq:!0};const s={"Array_::getAt":{name:"_pxt_array_get",argsFmt:["T","T","T"],value:0},"Array_::setAt":{name:"_pxt_array_set",argsFmt:["T","T","T","T"],value:0},"BufferMethods::getByte":{name:"_pxt_buffer_get",argsFmt:["T","T","T"],value:0},"BufferMethods::setByte":{name:"_pxt_buffer_set",argsFmt:["T","T","T","I"],value:0},"pxtrt::mapGetGeneric":{name:"_pxt_map_get",argsFmt:["T","T","S"],value:0},"pxtrt::mapSetGeneric":{name:"_pxt_map_set",argsFmt:["T","T","S","T"],value:0}};let o=t.ir.EK;t.SK=e.SyntaxKind,t.numReservedGlobals=1;let a=0,l=1;function c(n){if(n.pxt)return!!(16&n.pxt.flags);const i=e.getSourceFileOfNode(n);return!!i&&t.isPxtModulesFilename(i.fileName)}function u(e){if(e.pxt){const n=e.pxt;return n.wave!=l&&(n.wave=l,t.compileOptions&&t.compileOptions.skipPxtModulesTSC&&16&n.flags?t.compileOptions.skipPxtModulesEmit?n.refresh():n.resetEmit():n.resetAll()),n}{const t=new n(l,++a);return c(e)&&(t.flags|=16),e.pxt=t,t}}function d(e){return u(e).id}function p(t){return t?e.SyntaxKind[t.kind]:"<null>"}function h(e,t,n=!1){let i=new Error(t);if(i.ksEmitterUserError=!0,i.ksErrorCode=e,n&&U)return F||(F=t,$=e),i;throw i}function f(){return t.target.isNative&&t.target.nativeType==t.NATIVE_TYPE_VM}function m(){return t.target.isNative&&t.target.nativeType!=t.NATIVE_TYPE_VM}function g(){return t.target.isNative&&t.target.nativeType==t.NATIVE_TYPE_THUMB}function _(e){return m()?t.ir.rtcall("pxt::fromInt",[e]):e}function y(e){return m()?t.ir.rtcall("pxt::fromBool",[e]):e}function b(e){switch(e){case 0:return t.target.shortPointers?2:4;case 1:case 2:return 1;case 3:case 4:return 2;case 5:case 6:return 4;default:throw t.oops()}}function v(e){switch(e){case 1:case 3:case 5:return!0;case 2:case 4:case 6:return!1;default:throw t.oops()}}function T(e){switch(e.kind){case t.SK.TemplateHead:case t.SK.TemplateMiddle:case t.SK.TemplateTail:case t.SK.StringLiteral:case t.SK.NoSubstitutionTemplateLiteral:return!0;default:return!1}}function k(e){return e&&e.modifiers&&e.modifiers.some(e=>e.kind==t.SK.StaticKeyword)}function x(e){return e.modifiers&&e.modifiers.some(e=>e.kind==t.SK.ReadonlyKeyword)}function E(e,t){return e.explicitDefaults?e.explicitDefaults.indexOf(t)<0?null:e.paramDefl[t]:null}function S(e){if(!e)return null;switch(e.kind){case t.SK.MethodDeclaration:return"";case t.SK.Constructor:return"new/";case t.SK.GetAccessor:return"get/";case t.SK.SetAccessor:return"set/";default:return null}}function C(e){return S(e)+K(e)}function w(e){return null!=S(e)}function I(e){return e?w(e)?e:I(e.parent):null}function A(e){let n=e,i=!1;for(;;)switch(n=n.parent,n||h(9229,B("cannot determine parent of {0}",p(e))),n.kind){case t.SK.MethodDeclaration:case t.SK.Constructor:case t.SK.GetAccessor:case t.SK.SetAccessor:case t.SK.FunctionDeclaration:case t.SK.ArrowFunction:case t.SK.FunctionExpression:return n;case t.SK.WhileStatement:case t.SK.DoStatement:case t.SK.ForInStatement:case t.SK.ForOfStatement:case t.SK.ForStatement:i=!0;break;case t.SK.SourceFile:return i?M:null}}function N(e){return"objectFlags"in e}function D(e){return!!e&&(e.kind==t.SK.VariableDeclaration||e.kind==t.SK.BindingElement&&D(e.parent.parent))}function O(e){return!!e&&(D(e)&&!A(e)||e.kind==t.SK.PropertyDeclaration&&k(e))}function R(e){return!!e&&(e.kind==t.SK.Parameter||e.kind==t.SK.BindingElement&&R(e.parent.parent))}t.isInPxtModules=c,t.pxtInfo=u,t.getNodeId=d,t.stringKind=p,t.isStackMachine=f,t.needsNumberConversions=m,t.isThumb=g,t.sizeOfBitSize=b,t.isBitSizeSigned=v,t.setCellProps=function(n){var i;if(n._isLocal=D(i=n.def)&&!O(i)||R(n.def),n._isGlobal=O(n.def),!n.def.isThisParameter){let i=ee(n.def);i.flags&e.TypeFlags.Void&&t.oops("void-typed variable, "+n.toString()),n.bitSize=function(e){if(!e||!e.type)return 0;if(!pe(ee(e)))return 0;if(e.type.kind!=t.SK.TypeReference)return 0;switch(e.type.typeName.getText()){case"int8":return 1;case"int16":return 3;case"int32":return 5;case"uint8":return 2;case"uint16":return 4;case"uint32":return 6;default:return 0}}(n.def),0!=n.bitSize?n._debugType=(v(n.bitSize)?"int":"uint")+8*b(n.bitSize):de(i)?n._debugType="string":i.flags&e.TypeFlags.NumberLike&&(n._debugType="number")}n.isLocal()&&0!=n.bitSize&&(n.bitSize=0,h(9256,B("bit sizes are not supported for locals and parameters")))},t.isStatic=k,t.isReadOnly=x,t.getExplicitDefault=E,t.isObjectType=N;class L{constructor(e,t){this.id=e,this.decl=t,this.baseClassInfo=null,this.allfields=[],this.methods={},this.attrs=j(t),this.reset()}reset(){this.vtable=null,this.itable=null}get isUsed(){return!!(8&u(this.decl).flags)}allMethods(){const e=[];for(let t of Object.keys(this.methods))for(let n of this.methods[t])e.push(n);return e}usedMethods(){const e=[];for(let t of Object.keys(this.methods))for(let n of this.methods[t]){8&u(n).flags&&e.push(n)}return e}}t.ClassInfo=L;let P,M,F,B=t.assembler.lf,$=0,U=0;function V(e,n){const i=u(n);return null==i.fullName&&(i.fullName=t.getFullName(e,n.symbol)),i.fullName}function H(n){n.kind==t.SK.VariableDeclaration&&(n=n.parent.parent);let i=t=>{const n=e.getSourceFileOfNode(t);if(!n)return"";const i=e.getLeadingCommentRangesOfNode(t,n);if(!i)return"";return i.map(e=>n.text.slice(e.pos,e.end)).join("\n")};return n.symbol&&n.symbol.declarations&&n.symbol.declarations.length>1?n.symbol.declarations.map(i).join("\n"):i(n)}function G(e){let n="";for(let t of e.declarations)n+=H(t);return t.parseCommentString(n)}function j(e){const n=e?u(e):null;if(!n||2&n.flags)return t.parseCommentString("");if(n.commentAttrs)return n.commentAttrs;let i=t.parseCommentString(H(e));return i._name=K(e),n.commentAttrs=i,i}function K(e){return e.name&&e.name.kind==t.SK.Identifier?e.name.text:"???"}function z(t){if(N(t)&&t.objectFlags&e.ObjectFlags.Reference){let e=t;if(e.typeArguments&&e.typeArguments.length)return e.target}return null}function W(t){if(t.flags&e.TypeFlags.Union&&t.types){for(const e of t.types)if(!W(e))return!1;return!0}return!!N(t)&&(t.objectFlags&e.ObjectFlags.Reference&&t.symbol&&"Array"==t.symbol.name)}function q(t){return!!N(t)&&(!!(t.objectFlags&e.ObjectFlags.Interface)||!!(t.objectFlags&e.ObjectFlags.Anonymous))}function J(t){return!!t.isThisType||!!N(t)&&!!(t.objectFlags&e.ObjectFlags.Class||t.symbol&&t.symbol.flags&e.SymbolFlags.Class)}function Y(e){let t=z(e);return J(t||e)}function X(t,n=-1){return W(t)?t.flags&e.TypeFlags.Union?t.getNumberIndexType():t.typeArguments[0]:P.getIndexTypeOfType(t,e.IndexKind.Number)}function Z(e){return e}function Q(e){return null===e?t.taggedNull:void 0===e?t.taggedUndefined:!1===e?t.taggedFalse:!0===e?t.taggedTrue:isNaN(e)?t.taggedNaN:null}function ee(t){let n;const i=u(t);if(i.typeCache)return i.typeCache;if(e.isExpression(t)&&(n=P.getContextualType(t)),!n)try{n=P.getTypeAtLocation(t)}catch(e){h(9203,B("Unknown type for expression"))}return n?(i.typeCache=n,n):n}function te(t){if(!(t.flags&e.TypeFlags.Union))return i.Unsupported;let n,r=!0;return t.types.forEach(t=>{if(void 0===n)t.flags&e.TypeFlags.NumberLike?n=i.Number:t.flags&e.TypeFlags.BooleanLike?n=i.Boolean:t.flags&e.TypeFlags.StringLike?n=i.String:t.flags&e.TypeFlags.EnumLike&&(n=i.Enum);else switch(n){case i.Number:r=r&&!!(t.flags&e.TypeFlags.NumberLike);break;case i.Boolean:r=r&&!!(t.flags&e.TypeFlags.BooleanLike);break;case i.String:r=r&&!!(t.flags&e.TypeFlags.StringLike);break;case i.Enum:r=r&&!!(t.flags&e.TypeFlags.EnumLike)}}),r?n:i.Unsupported}function ne(e,t){}function ie(t){let n=P.getSignatureFromDeclaration(t);return!(P.getReturnTypeOfSignature(n).flags&e.TypeFlags.Void)}function re(e){return!(!e||!e.name)}function se(e){if(!e)return"";switch(e.kind){case t.SK.ModuleBlock:return se(e.parent);case t.SK.ClassDeclaration:case t.SK.ModuleDeclaration:return se(e.parent)+e.name.text+".";default:return""}}function oe(e){let n=re(e)?e.name.text:null;if(!n){if(e.kind!=t.SK.Constructor){for(let t=e.parent;t;t=t.parent)if(re(t))return oe(t)+".inline";return"inline"}n="constructor"}return se(e.parent)+n}function ae(e){return oe(e).replace(/[^\w]+/g,"_")}function le(e){return ae(e)+"__P"+d(e)}t.getNodeFullName=V,t.getComments=H,t.parseCommentsOnSymbol=G,t.parseComments=j,t.getName=K,t.checkType=Z,t.taggedSpecial=Q,t.getDeclName=oe,t.getFunctionLabel=le;class ce{constructor(e){this.decl=e,this.capturedVars=[]}get isUsed(){return!!(8&u(this.decl).flags)}}function ue(e,t,n){return!!(e.flags&t)||te(e)===n}function de(t){return ue(t,e.TypeFlags.String|e.TypeFlags.StringLiteral,i.String)}function pe(t){return ue(t,e.TypeFlags.Number|e.TypeFlags.NumberLiteral,i.Number)}t.FunctionAddInfo=ce,t.compileBinary=function(n,i,r,a){t.compilerHooks.preBinary&&t.compilerHooks.preBinary(n,i,r),t.target=i.target,t.compileOptions=i,t.target.debugMode=!!i.breakpoints;const v=e.createDiagnosticCollection();P=n.getTypeChecker();let S=t.U.cpuUs(),N=[],H=[],z={},Z={},te=null,re=null,se=!1,ue=[];if(l++,i.target.isNative){if(!i.extinfo||!i.extinfo.hexinfo)return{diagnostics:[{file:n.getSourceFiles()[0],start:0,length:0,category:t.DiagnosticCategory.Error,code:9043,messageText:B("The hex file is not available, please connect to internet and try again.")}],emittedFiles:[],emitSkipped:!0};let e=i.extinfo,s=i.target;if(e&&e.disabledDeps){const t=(i.otherMultiVariants||[]).find(e=>e.extinfo&&!e.extinfo.disabledDeps);t&&(pxt.debug(`using alternative extinfo (due to ${e.disabledDeps})`),e=t.extinfo,s=t.target)}t.hexfile.setupFor(s,e||t.emptyExtInfo(),r),t.hexfile.setupInlineAssembly(i)}let _e,ye=new he;function be(){ye.reset(),_e=null,r.breakpoints=[{id:0,isDebuggerStmt:!1,fileName:"bogus",start:0,length:0,line:0,column:0}],r.procCallLocations=[]}ye.trace=i.trace,ye.breakpoints=i.breakpoints,ye.name=i.name,ye.target=i.target,i.computeUsedSymbols&&(r.usedSymbols={},r.usedArguments={}),i.computeUsedParts&&(r.usedParts=[]);let ve=[];if(!i.forceEmit||0==r.diagnostics.length){let e=n.getSourceFiles().slice();const t=e.find(e=>e.fileName===pxt.MAIN_TS);t&&(e=e.filter(e=>e.fileName!==pxt.MAIN_TS),e.push(t));const i=e.find(e=>e.fileName===pxt.TUTORIAL_CODE_STOP);i&&(e=e.filter(e=>e.fileName!==pxt.TUTORIAL_CODE_STOP),e.push(i)),e.forEach(e=>{e.statements.forEach(e=>{ve.push(e)})})}let Te=n.getSourceFiles().filter(e=>t.Util.endsWith(e.fileName,a))[0],ke={kind:t.SK.FunctionDeclaration,parameters:[],name:{text:"<main>",pos:0,end:0},body:{kind:t.SK.Block,statements:ve},parent:Te,pos:0,end:0};M=ke;const xe=u(ke);for(xe.flags|=3,it(ke),N=[],be(),se=!0,xn(ke);xt(),!$e(););!function(){let e=ye.globals.slice(0);e.forEach((e,t)=>e.index=t);const n=e=>0==e?10:b(e);e.sort((e,t)=>n(e.bitSize)-n(t.bitSize)||e.index-t.index);let i=4*t.numReservedGlobals,r=0;for(let t of e){const e=f()?0:t.bitSize;let n=b(e);for(;i&n-1;)i++;r||0!=e||(r=i),t.index=i,i+=n}ye.globalsWords=i+3>>2,ye.nonPtrGlobals=r?r>>2:ye.globalsWords}(),se=!1,function(){for(let e of ye.usedClassInfos)Ue(e);let e=Object.keys(ye.ifaceMemberMap);e.sort(t.U.strcmp),e.unshift(""),ye.emitString(""),ye.ifaceMembers=e,ye.ifaceMemberMap={};let n=0;for(let t of e)ye.ifaceMemberMap[t]=n++;for(let e of ye.usedClassInfos)for(let t of e.itable)t.idx=Le(t.name);for(let e of ye.usedClassInfos)e.lastSubtypeNo=void 0,e.classNo=void 0;let i=pxt.BuiltInType.User0;const r=e=>{t.U.assert(!e.classNo),e.classNo=i++;for(let t of e.derivedClasses)t.isUsed&&r(t);e.lastSubtypeNo=i-1};for(let e of ye.usedClassInfos){let t=e;for(;t.baseClassInfo;)t=t.baseClassInfo;t.classNo||r(t)}}();let Ee=t.U.cpuUs();r.times.pass0=Ee-S;let Se=v.getDiagnostics();be(),se=!1,ye.finalPass=!0,En(ke),t.U.assert(0==N.length),r.configData=[];for(let e of Object.keys(Z))Z["!"+e]||r.configData.push({name:e.replace(/^\!/,""),key:Z[e].key,value:Z[e].value});r.configData.sort((e,t)=>e.key-t.key);let Ce=t.U.cpuUs();if(r.times.pass1=Ce-Ee,vn(ke,function(){if(i.noEmit)return;ye.writeFile=(e,t)=>{r.outfiles[e]=t};for(let e of ye.procs)e.cachedJS&&!e.inlineBody||e.resolve();t.target.isNative&&(ye.procs=ye.procs.filter(e=>!(e.inlineBody&&!e.info.usedAsIface&&!e.info.usedAsValue)));i.target.isNative?([...i.otherMultiVariants||[],i].forEach(({extinfo:e})=>{e.yotta&&ye.writeFile("yotta.json",JSON.stringify(e.yotta,null,2)),e.codal&&ye.writeFile("codal.json",JSON.stringify(e.codal,null,2)),e.platformio&&ye.writeFile("platformio.json",JSON.stringify(e.platformio,null,2))}),i.target.nativeType==t.NATIVE_TYPE_VM?t.vmEmit(ye,i,r):t.processorEmit(ye,i,r)):t.jsEmit(ye,r);ye.writeFile=void 0}),r.times.passFinal=t.U.cpuUs()-Ce,i.ast){let e=t.U.cpuUs();t.annotate(n,a,t.target),r.times.passAnnotate=t.U.cpuUs()-e}return t.compileOptions=null,0==Se.length&&(Se=v.getDiagnostics()),t.compilerHooks.postBinary&&t.compilerHooks.postBinary(n,i,r),{diagnostics:Se,emittedFiles:void 0,emitSkipped:!!i.noEmit};function we(t,n,i,r,s,o,a){v.add(e.createDiagnosticForNode(n,{code:i,message:r,key:r.replace(/^[a-zA-Z]+/g,"_"),category:t},s,o,a))}function Ie(e,n,i,r,s,o){we(t.DiagnosticCategory.Error,e,n,i,r,s,o)}function Ae(t,n,i=9202){if(n)return h(i,n);t||h(i,B("Sorry, this language feature is not supported"));let r=p(t),s=!1,o=null;switch(t.kind){case e.SyntaxKind.ForInStatement:r=B("for in loops");break;case e.SyntaxKind.ForOfStatement:r=B("for of loops"),s=!0;break;case e.SyntaxKind.PropertyAccessExpression:r=B("property access");break;case e.SyntaxKind.DeleteExpression:r=B("delete");break;case e.SyntaxKind.GetAccessor:r=B("get accessor method"),s=!0;break;case e.SyntaxKind.SetAccessor:r=B("set accessor method"),s=!0;break;case e.SyntaxKind.TaggedTemplateExpression:r=B("tagged templates");break;case e.SyntaxKind.SpreadElement:r=B("spread");break;case e.SyntaxKind.TryStatement:case e.SyntaxKind.CatchClause:case e.SyntaxKind.FinallyKeyword:case e.SyntaxKind.ThrowStatement:r=B("throwing and catching exceptions");break;case e.SyntaxKind.ClassExpression:r=B("class expressions"),o=B("declare a class as class C {} not let C = class {}")}let a="";return a=s?B("{0} not currently supported",r):B("{0} not supported",e.SyntaxKind[t.kind]),o&&(a+=" - "+o),h(i,a)}function Ne(e){return d(e)+""}function De(e){const t=u(e);return t.functionInfo||(t.functionInfo=new ce(e)),t.functionInfo}function Oe(e){const t=u(e);return t.variableInfo||(t.variableInfo={}),t.variableInfo}function Re(e,t=!1){let n=Oe(e);t&&(n.written=!0);let i=A(e);if(null==i||i==_e.action);else{let t=_e.action;for(;t&&t!=i;){let n=De(t);n.capturedVars.indexOf(e)<0&&n.capturedVars.push(e),t=A(t)}n.captured=!0}}function Le(e,n=!1){return function(e,n,i,r,s){return ge(e,r,s,e=>{i&&(t.U.lookup(e.explicitlyUsedIfaceMembers,n)||(t.U.assert(!e.finalPass),e.explicitlyUsedIfaceMembers[n]=!0));let r=t.U.lookup(e.ifaceMemberMap,n);return null!=r||(t.U.assert(!e.finalPass),r=e.ifaceMemberMap[n]=-1,e.emitString(n)),r})}(ye,e,n,se,re)}function Pe(t){t.flags&e.TypeFlags.Void&&h(9203,B("void-typed variables not supported"))}function Me(e){const n=u(e);Pe(ee(e)),n.cell||(n.cell=new t.ir.Cell(null,e,Oe(e))),ye.globals.indexOf(n.cell)<0&&ye.globals.push(n.cell)}function Fe(e){if(O(e)){it(e);const t=u(e);return t.cell||Me(e),t.cell}{let t=_e.localIndex(e);return t||(ye.finalPass?h(9204,B("cannot locate identifer")):t=_e.mkLocal(e,Oe(e))),t}}function Be(e){return e.kind==t.SK.MethodDeclaration&&0==e.parameters.length&&"toString"==K(e)}function $e(){se=!1;const e=ye.usedClassInfos.length;for(let e of ye.usedClassInfos){for(let t of e.allMethods()){const e=u(t),n=De(t);8&e.flags?n.virtualParent&&rt(n.virtualParent.decl):(n.virtualParent&&n.virtualParent.isUsed||Be(t)||yt(K(t)))&&rt(t)}const t=_t(e.decl);t&&rt(t)}return se=!0,0==N.length&&e==ye.usedClassInfos.length}function Ue(e){if(t.assert(e.isUsed,"inf.isUsed"),e.vtable)return e.vtable;let n=e.baseClassInfo?Ue(e.baseClassInfo).slice(0):[];e.derivedClasses=[],e.baseClassInfo&&e.baseClassInfo.derivedClasses.push(e);for(let i of e.usedMethods()){ye.numMethods++;let r=De(i);const s=j(i);if(Be(i)&&!s.shim&&(e.toStringMethod=mt(i),e.toStringMethod.info.usedAsIface=!0),r.virtualParent){ye.numVirtMethods++;let e=C(i),s=!1,o=mt(i);t.U.assert(!!o);for(let t=0;t<n.length;++t)C(n[t].action)==e&&(n[t]=o,r.virtualIndex=t,s=!0);s||(r.virtualIndex=n.length,n.push(o))}}e.vtable=n,e.itable=[];const i={};for(let t of e.allfields){let n=K(t),r=Mt(e,t,!1);i[n]=!0,e.itable.push({name:n,info:(r.idx+1)*(f()?1:4),idx:Le(n),proc:null})}for(let n=e;n;n=n.baseClassInfo)for(let i of n.usedMethods()){const n=K(i);if(j(i).shim)continue;const r=mt(i),s=e.itable.find(e=>e.name==n),o=i.kind==t.SK.SetAccessor,a=i.kind==t.SK.GetAccessor;s?(o&&!s.setProc?s.setProc=r:a&&!s.proc&&(s.proc=r),s.info=0):e.itable.push({name:n,info:0,idx:Le(n),proc:o?null:r,setProc:o?r:null}),r.info.usedAsIface=!0}return e.vtable}function Ve(e){if(32&e.flags||16&e.flags&&t.compileOptions.skipPxtModulesEmit)throw r.needsFullRecompile=!0,h(9200,B("full recompile required"))}function He(e,n=null){n||(n=e.symbol.valueDeclaration);const i=u(n);if(!i.classInfo){const e=ae(n)+"__C"+d(n),r=new L(e,n);i.classInfo=r,r.attrs.autoCreate&&(z[r.attrs.autoCreate]=!0),r.baseClassInfo=function(e){if(e.heritageClauses)for(let n of e.heritageClauses)switch(n.token){case t.SK.ExtendsKeyword:if(!n.types||1!=n.types.length)throw h(9228,B("invalid extends clause"));let i=ee(n.types[0]);if(i&&J(i))return P.getTypeAtLocation(e),ne(),He(i);throw h(9228,B("cannot inherit from this type"));case t.SK.ImplementsKeyword:break;default:throw h(9228,B("invalid heritage clause"))}return null}(n);const s=r.baseClassInfo?t.U.toDictionary(r.baseClassInfo.allfields,e=>K(e)):{},o=(e,t=r.baseClassInfo)=>t?t.methods[e]||o(e,t.baseClassInfo):null;for(let e of n.members)if(e.kind==t.SK.PropertyDeclaration){let n=e;k(n)||r.allfields.push(n);const i=K(n);(o(i)||t.U.lookup(s,i))&&Ie(n,9279,B("redefinition of '{0}' as field",i))}else if(e.kind==t.SK.Constructor)for(let t of e.parameters)fe(t)&&r.allfields.push(t);else if(w(e)){let n=De(e);n.parentClassInfo=r,n.isUsed&&bt(r);const i=K(e);r.methods.hasOwnProperty(i)||(r.methods[i]=[]),r.methods[i].push(e);const o=t.U.lookup(s,i);if(o){const e=u(o);64&e.flags||(e.flags|=64,8&e.flags&&Le(i,!0),Ve(e))}}r.baseClassInfo&&(r.allfields=r.baseClassInfo.allfields.concat(r.allfields),function(e){for(let n of e.allMethods()){let i=null;const r=C(n),s=K(n);for(let t=e.baseClassInfo;t;t=t.baseClassInfo)if(t.methods.hasOwnProperty(s))for(let e of t.methods[s])C(e)==r&&(i=e);if(i){let e=De(n),r=De(i);i.parameters.length!=n.parameters.length&&Ie(n,9255,B("the overriding method is currently required to have the same number of arguments as the base one")),e.virtualParent=r,r.virtualParent||(Ve(u(i)),r.virtualParent=r),t.assert(r.virtualParent==r,"pinf.virtualParent == pinf")}}}(r))}return i.classInfo}function Ge(e){return!!e&&(!T(e)&&(e.kind===t.SK.ArrayLiteralExpression?e.elements.some(Ge):null==Kt(e)))}function je(e){const t=jt(e);if(t)return Xt(t.val);if(O(e)){if(j(e).shim)return ut(e,e,[])}let n=Fe(e);return Re(e),n.load()}function Ke(e){j(e).shim&&h(9207,B("built-in functions cannot be yet used as values; did you forget ()?"));let n=De(e);return ze(n),n.location?n.location.load():(t.assert(!ye.finalPass||0==n.capturedVars.length,"!bin.finalPass || info.capturedVars.length == 0"),n.usedAsValue=!0,rt(e),kt(e))}function ze(e){void 0===e.usedBeforeDecl?e.usedBeforeDecl=!0:ye.finalPass&&e.usedBeforeDecl&&e.capturedVars.length&&A(e.decl)&&!e.alreadyEmitted&&h(9278,B("function referenced before all variables it uses are defined"))}function We(e){const n=at(e),i=jt(n);if(i)return Xt(i.val);if(n&&(D(n)||R(n)))return je(n);if(n&&n.kind==t.SK.FunctionDeclaration)return Ke(n);if("undefined"==e.text)return Xt(void 0);throw Ae(e,B("Unknown or undeclared identifier"),9235)}function qe(e){let n=I(e);n||h(9208,B("'this' used outside of a method"));let i=De(n);return i.thisParameter||t.oops("no this"),je(i.thisParameter)}function Je(e){let n;if(""==e)n=t.ir.rtcall("String_::mkEmpty",[]);else{let i=function(e){return function(e,t,n,i){return ge(e,n,i,e=>e.emitString(t))}(ye,e,se,re)}(e);n=t.ir.ptrlit(i,JSON.stringify(e))}return n.isStringLiteral=!0,n}function Ye(e){let n=lt(e),i=Tn(e);return t.target.isNative||T(e)?Lt(i,n):(i=t.ir.rtcallMask("String_::stringConv",1,1,[i]),Lt(i,!0))}function Xe(e){let n=0,i=(e,t)=>function(e){return T(e)&&""==e.text}(t)?e:(n++,en("String_::concat",[Lt(e,!0),Ye(t)],null)),r=u(Ye(e.head)).valueOverride;for(let t of e.templateSpans)r=i(r,t.expression),r=i(r,t.literal);return 0==n?en("String_::concat",[Lt(r,!0),Lt(t.ir.rtcall("String_::mkEmpty",[]),!1)],null):r}function Ze(n){const i=e.getDeclarationOfKind(n.symbol,t.SK.GetAccessor);if(null==i)throw h(9281,B("setter currently requires a corresponding getter"));return i}function Qe(e){if(e.kind==t.SK.Parameter||e.kind==t.SK.PropertyDeclaration){const n=u(e);return!!t.target.switches.slowFields||!!(64&n.flags)}return!1}function et(t,n=null){let i=ee(t.expression),r={callingConvention:0,paramDefl:{}},s=null,o=!1;if(!n&&de(i)?s="String_::charAt":W(i)?s=n?"Array_::setAt":"Array_::getAt":q(i)&&(r=G(i.symbol),s=n?r.indexerSet:r.indexerGet),!s&&i.flags&(e.TypeFlags.Any|e.TypeFlags.StructuredOrTypeVariable)&&(s=n?"pxtrt::mapSetGeneric":"pxtrt::mapGetGeneric",o=!0),s){if(o||Zt(t.argumentExpression)){return en(s,[t.expression,t.argumentExpression],r,n?[n]:[])}throw Ae(t,B("non-numeric indexer on {0}",s),9238)}throw Ae(t,B("unsupported indexer"),9239)}function tt(n){let r=function(e){return!!O(e)&&(!Ge(e.initializer)||!!j(e).whenUsed)}(n)||function(e){return e.kind==t.SK.FunctionDeclaration&&!A(e)||w(e)}(n)||e.isClassDeclaration(n);return!t.target.switches.noTreeShake&&(!(i.testMode&&r&&!c(n))&&r)}function nt(e){if(!tt(e))return!0;const t=u(e);return ye.finalPass?!!(8&t.flags):t==re}function it(e){var t;if(!e)return;const n=u(e);if(n.classInfo)bt(n.classInfo);else{if(i.computeUsedSymbols&&e.symbol&&(r.usedSymbols[V(P,e)]=null),i.computeUsedParts&&(null===(t=n.commentAttrs)||void 0===t?void 0:t.parts)){const e=n.commentAttrs.parts.split(/[ ,]+/g);for(const t of e)-1===r.usedParts.indexOf(t)&&r.usedParts.push(t)}f()&&w(e)&&Le(K(e),!0),st(e),8&n.flags||(n.flags|=8,tt(e)&&N.push(e))}}function rt(e){it(e)}function st(e){se&&(re?re.usedNodes[Ne(e)]=e:t.U.oops("no using ctx for: "+K(e)))}function ot(t){if(!t)return null;const n=u(t);if(void 0!==n.declCache)return n.declCache;let i,r=P.getSymbolAtLocation(t);if(r&&(i=r.valueDeclaration,!i&&r.declarations)){let t=r.declarations[0];t&&t.kind==e.SyntaxKind.ImportEqualsDeclaration&&(r=P.getSymbolAtLocation(t.moduleReference),r&&(i=r.valueDeclaration))}return i}function at(e){let n=ot(e);if(it(n),!n&&e&&e.kind==t.SK.PropertyAccessExpression){const i=e;n={kind:t.SK.PropertySignature,symbol:{isBogusSymbol:!0,name:i.name.getText()},name:i.name},u(n).flags|=2}return xe.declCache=n||null,n}function lt(e){return e.kind==t.SK.NullKeyword||e.kind==t.SK.NumericLiteral?!!e.isRefOverride:!T(e)}function ct(e){t.assert(e.length<=8,"args.length <= 8");let n=0;return e.forEach((e,t)=>{lt(e)&&(n|=1<<t)}),n}function ut(n,r,s,o=null){let a=j(n),l=!(ee(r).flags&e.TypeFlags.Void),c=o||a.shim;if(c.indexOf("(")>=0){let e=/(.*)\((.*)\)$/.exec(c);if(e){s.length&&t.U.userError("no arguments expected");let o=[];if(e[2].replace(/\s/g,"")){for(let n of e[2].split(/,/)){let e=parseInt(n);isNaN(e)&&(e=Jt(r,n),null==e&&(e=Wt(r,n)),null==e&&t.U.userError("invalid argument: "+n+" in "+c)),o.push(t.ir.numlit(e))}o.length>4&&t.U.userError("too many args")}return c=e[1],i.target.isNative&&t.hexfile.validateShim(oe(n),c,a,!0,o.map(e=>!0)),t.ir.rtcallMask(c,0,a.callingConvention,o)}}return"TD_NOOP"==c?(t.assert(!l,"!hasRet"),t.target.switches.profile&&"perfCounter"==a.shimArgument&&(s[0]&&s[0].kind==t.SK.StringLiteral&&(_e.perfCounterName=s[0].text),_e.perfCounterName||(_e.perfCounterName=_e.getFullName())),Xt(void 0)):"TD_ID"==c||"ENUM_GET"===c?(t.assert(1==s.length,"args.length == 1"),Tn(s[0])):(i.target.shimRenames&&t.U.lookup(i.target.shimRenames,c)&&(c=i.target.shimRenames[c]),i.target.isNative&&t.hexfile.validateShim(oe(n),c,a,l,s.map(Zt)),en(c,s,a))}function dt(e,n,r){if(!e)return;let s=e.getParameters(),a=n.length;s.length>n.length&&s.slice(n.length).forEach(e=>{if(e.valueDeclaration&&e.valueDeclaration.kind==t.SK.Parameter){let s=e.valueDeclaration;if(s.initializer)i.unfetteredInitializers||function(e){switch(e.kind){case t.SK.UndefinedKeyword:case t.SK.NullKeyword:case t.SK.TrueKeyword:case t.SK.FalseKeyword:case t.SK.NumericLiteral:return!0;case t.SK.PropertyAccessExpression:return Tn(e).exprKind==o.NumberLiteral;default:return!1}}(s.initializer)||h(9212,B("only numbers, null, true and false supported as default arguments")),n.push(s.initializer);else{let e=E(r,K(s)),t=e?Xt(parseInt(e)):null;null==t&&(t=Xt(void 0)),n.push(Lt(t))}}else h(9213,B("unsupported default argument (shouldn't happen)"))});for(let e=0;e<a;e++){let i=s[e];i&&i.valueDeclaration&&i.valueDeclaration.kind==t.SK.Parameter&&ne(n[e],i.valueDeclaration)}r.imageLiteral&&(T(n[0])||h(9214,B("Only image literals (string literals) supported here; {0}",p(n[0]))),n[0]=function(e){e||(e="0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n");let n=0,i=0,r=0,s="",o=0;e+="\n";for(let t=0;t<e.length;++t)switch(e[t]){case".":case"_":case"0":s+="0,",n++,o++;break;case"#":case"*":case"1":s+="255,",n++,o++;break;case"\t":case"\r":case" ":break;case"\n":n&&(0==i?i=n:n!=i&&h(9205,B("lines in image literal have to have the same width (got {0} and then {1} pixels)",i,n)),n=0,r++);break;default:h(9206,B("Only 0 . _ (off) and 1 # * (on) are allowed in image literals"))}let a="_img"+ye.lblNo++;o%2!=0&&(s+="0"),ye.otherLiterals.push(`\n.balign 4\n${a}: .short 0xffff\n        .short ${i}, ${r}\n        .byte ${s}\n`);let l="new pxsim.Image("+i+", ["+s+"])";return{kind:t.SK.NumericLiteral,imageLiteral:a,jsLit:l}}(n[0].text))}function pt(n,i,s,o,a=null,l=null){var c;a||(a=at(i));let u=!1,d=!1,p=!1;const m=n===i;if(a)switch(a.kind){case t.SK.PropertySignature:case t.SK.PropertyAssignment:case t.SK.PropertyDeclaration:case t.SK.MethodSignature:u=!0;break;case t.SK.Parameter:fe(a)&&(u=!0);break;case t.SK.GetAccessor:case t.SK.SetAccessor:case t.SK.MethodDeclaration:u=!0,d=!0,p=k(a);break;case t.SK.FunctionDeclaration:p=!0;break;case t.SK.ModuleDeclaration:break;default:a=null}else i.kind==t.SK.PropertyAccessExpression&&(u=!0);t.target.switches.slowMethods&&(d=!1);const g=j(a);let _=s.slice(0);if(u&&k(a)&&(u=!1),u&&!l&&i.kind==t.SK.PropertyAccessExpression&&(l=i.expression),r.usedArguments&&g.trackArgs){let e=l?[l].concat(_):_,n=g.trackArgs.map(t=>e[t]).map(e=>{let n=at(e);return!n||n.kind!=t.SK.EnumMember&&n.kind!=t.SK.VariableDeclaration?e&&e.kind==t.SK.StringLiteral?e.text:"*":V(P,n)}).join(","),i=V(P,a),s=r.usedArguments[i];s||(s=r.usedArguments[i]=[]),s.indexOf(n)<0&&s.push(n)}function y(){let e=gt(a,n,_.map(e=>Tn(e))),i=e.data;return _[0]&&i.proc&&i.proc.classInfo&&(i.isThis=_[0].kind==t.SK.ThisKeyword),e}if(dt(o,_,g),p){if(!De(a).location)return g.shim&&!At(a)?ut(a,n,_):(rt(a),y())}if(i.kind==t.SK.SuperKeyword){let e=_e.classInfo.baseClassInfo.ctor;for(let t=_e.classInfo.baseClassInfo;t&&!e;t=t.baseClassInfo)e=t.ctor;if(!e&&ye.finalPass)throw h(9280,B("super() call requires an explicit constructor in base class"));let t=_.map(e=>Tn(e));return t.unshift(qe(i)),ht(e,n,t)}if(u){if(t.U.assert(!k(a)),l?_.unshift(l):Ae(n,B("strange method call"),9241),!a){t.U.assert(i.kind==t.SK.PropertyAccessExpression);const e=i.name.text;return ft(_.map(e=>Tn(e)),{ifaceIndex:Le(e,!0),callLocationIndex:Cn(n),noArgs:m})}let r=De(a);if(r.parentClassInfo&&bt(r.parentClassInfo),rt(a),l.kind==t.SK.SuperKeyword)return y();const s=!!r.virtualParent,o=!!f()||!!t.target.switches.slowMethods;if(s&&!o)return a.kind==t.SK.MethodDeclaration?t.U.assert(!m):a.kind==t.SK.GetAccessor||a.kind==t.SK.SetAccessor?t.U.assert(m):t.U.assert(!1),t.U.assert(!ye.finalPass||null!=r.virtualIndex,"!bin.finalPass || info.virtualIndex != null"),ft(_.map(e=>Tn(e)),{classInfo:r.parentClassInfo,virtualIndex:r.virtualIndex,noArgs:m,isThis:_[0].kind==t.SK.ThisKeyword});if(g.shim&&!At(a)){let e;return n.kind===t.SK.PropertyAccessExpression&&_.length>1&&(e=g.shim+"_set"),ut(a,n,_,e)}if(g.helper){let i,r=P.getSymbolsInScope(n,e.SymbolFlags.Module);for(let e of r)if("helpers"==e.name)for(let n of e.declarations||[e.valueDeclaration])if(n.kind==t.SK.ModuleDeclaration)for(let e of n.body.statements)(null===(c=e.symbol)||void 0===c?void 0:c.name)==g.helper&&(i=e);return i||h(9215,B("helpers.{0} not found",g.helper)),i.kind!=t.SK.FunctionDeclaration&&h(9216,B("helpers.{0} isn't a function",g.helper)),rt(a=i),y()}return s||t.target.switches.slowMethods||!d?ft(_.map(e=>Tn(e)),{ifaceIndex:Le(K(a),!0),isSet:m&&2==_.length,callLocationIndex:Cn(n),noArgs:m}):(t.U.assert(a.kind!=t.SK.MethodSignature),y())}return a&&a.kind==t.SK.ModuleDeclaration&&("String"==K(a)?h(9219,B('to convert X to string use: X + ""')):h(9220,B("namespaces cannot be called directly"))),_.unshift(i),t.U.assert(!m),ft(_.map(e=>Tn(e)),{virtualIndex:-1,callLocationIndex:Cn(n),noArgs:m})}function ht(e,n,i){t.U.assert(!ye.finalPass||!!e);let r={proc:e,callLocationIndex:Cn(n),virtualIndex:null,ifaceIndex:null};return t.ir.op(o.ProcCall,i,r)}function ft(e,n){return t.ir.op(o.ProcCall,e,n)}function mt(e){return u(e).proc}function gt(e,n,i){const r=mt(e);if(e.kind==t.SK.FunctionDeclaration){ze(De(e))}return t.assert(!!r||!ye.finalPass,"!!proc || !bin.finalPass"),ht(r,n,i)}function _t(e){return e.members.filter(e=>e.kind==t.SK.Constructor)[0]}function yt(e){return null!=t.U.lookup(ye.explicitlyUsedIfaceMembers,e)}function bt(e){if(st(e.decl),e.isUsed)return;u(e.decl).flags|=8,e.baseClassInfo&&bt(e.baseClassInfo),ye.usedClassInfos.push(e)}function vt(n){function r(e){return/^[0-9a-f]$/i.test(e)}let s=at(n.tag);if(!s)throw Ae(n,B("invalid tagged template"),9265);let o,a=j(s),l={decl:s,qName:s?V(P,s):"?",args:[n.template],isExpression:!0};function c(s){o=function(n,s){let o=te;if("_"==s[0]&&"_"==s[1]&&i.jres[s]&&(o=i.jres[s],s=""),""==s&&o){let n=/font\/x-mkcd-b(\d+)/.exec(o.mimeType);if(n)if(ye.finalPass){let e=parseInt(n[1]),r=atob(o.data),a=ye.usedChars,l="",c="";if(i.target.isNative)for(let t=0;t<r.length;t+=e){let n=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8);(n<128||a[n>>5]&1<<(31&n))&&(l+=r.slice(t,t+e),c+=n+", ")}else l=r;s=t.U.toHex(t.U.stringToUint8Array(l))}else s="aabbccdd";else o.dataEncoding&&"base64"!=o.dataEncoding?"hex"==o.dataEncoding?s=o.data:h(9271,B("invalid jres encoding '{0}' on '{1}'",o.dataEncoding,o.id)):s=t.U.toHex(t.U.stringToUint8Array(e.pxtc.decodeBase64(o.data)))}if(/^e[14]/i.test(s)&&n.parent&&n.parent.kind==t.SK.CallExpression&&"image.ofBuffer"==n.parent.expression.getText()){const e=/^e([14])(..)(..)..(.*)/i.exec(s);s=`870${e[1]}${e[2]}00${e[3]}000000${e[4]}`}let a="";for(let e=0;e<s.length;++e){let t=s[e];if(!r(t)){if(/^[\s\.]$/.test(t))continue;throw Ae(n,B("invalid character in hex literal '{0}'",t),9265)}r(s[e+1])&&(a+=t+s[e+1],e++)}if(t.target.isNative){const e=ye.emitHexLiteral(a.toLowerCase());return t.ir.ptrlit(e,e)}{const e="_hex"+Ne(n);return t.ir.ptrlit(e,{hexlit:a.toLowerCase()})}}(n,s(n.template.text))}if(u(n).callInfo=l,n.template.kind!=t.SK.NoSubstitutionTemplateLiteral)throw Ae(n,B("substitution not supported in hex literal",a.shim),9265);switch(a.shim){case"@hex":c(e=>e);break;case"@f4":c(function(e){if(!Array.isArray(a.groups))throw Ae(n,B("missing groups in @f4 literal"),9272);let i=[],r=[],s={},o=0;a.groups.forEach((e,t)=>{for(let n of e)s[n]=t}),e+="\n";for(let l=0;l<e.length;++l){let c=e[l];switch(c){case" ":case"\t":break;case"\n":r.length>0&&(i.push(r),o=Math.max(r.length,o),r=[]);break;default:let e=t.U.lookup(s,c);if(null==e){if(2!=a.groups.length)throw Ae(n,B("invalid character in image literal: '{0}'",e),9273);e=1}r.push(e)}}let l=8;return a.groups.length<=2?l=1:a.groups.length<=16&&(l=4),t.f4EncodeImg(o,i.length,l,(e,t)=>i[t][e]||0)});break;default:if(void 0===a.shim&&a.helper)return function(n,i){var r;let s,o=P.getSymbolsInScope(n,e.SymbolFlags.Module);for(let e of o)if("helpers"==e.name)for(let n of e.declarations||[e.valueDeclaration])if(n.kind==t.SK.ModuleDeclaration)for(let e of n.body.statements)(null===(r=e.symbol)||void 0===r?void 0:r.name)==i.helper&&(s=e);s||h(9215,B("helpers.{0} not found",i.helper));s.kind!=t.SK.FunctionDeclaration&&h(9216,B("helpers.{0} isn't a function",i.helper));const a=s;rt(a);let l=gt(a,n,[Je(n.text)]);return l}(n.template,a);throw Ae(n,B("invalid shim '{0}' on tagged template",a.shim),9265)}return a.helper&&(o=t.ir.rtcall(a.helper,[o])),o}function Tt(e){let n=e.parameters.slice(0);if(!k(e)&&w(e)){let i=De(e);i.thisParameter||(i.thisParameter={kind:t.SK.Parameter,name:{text:"this"},isThisParameter:!0,parent:e}),n.unshift(i.thisParameter)}return n}function kt(e,n=!1){let i=le(e);return t.ir.ptrlit(i+"_Lit",i)}function xt(){for(_e=mt(ke);N.length>0;){xn(N.pop())}}function Et(){const e=ue;if(e.length>0){ue=[];for(let t of e){const e=_e;try{Ct(t)}finally{_e=e}}}}function St(e){ye.finalPass&&e.functionsToDefine&&t.U.pushRange(ue,e.functionsToDefine)}function Ct(e){const n=De(e);let i=null;if(ye.finalPass){if(n.alreadyEmitted)return t.U.assert(n.usedBeforeDecl),null;n.alreadyEmitted=!0}let r=e.kind==t.SK.ArrowFunction||e.kind==t.SK.FunctionExpression,s=n.capturedVars.slice(0),a=s.map((e,n)=>{let i=new t.ir.Cell(n,e,Oe(e));return i.iscap=!0,i});void 0===n.usedBeforeDecl&&(n.usedBeforeDecl=!1),s.length>0?(t.assert(null!=A(e),"getEnclosingFunction(node) != null)"),i=t.ir.shared(t.ir.rtcall("pxt::mkAction",[t.ir.numlit(s.length),kt(e,!0)])),n.usedAsValue=!0,s.forEach((e,n)=>{let r=_e.localIndex(e);r||h(9223,B("cannot find captured value: {0}",P.symbolToString(e.symbol)));let s=r.loadCore();_e.emitExpr(t.ir.rtcall("pxtrt::stclo",[i,t.ir.numlit(n),s]))}),e.kind==t.SK.FunctionDeclaration&&(n.location=_e.mkLocal(e,Oe(e)),_e.emitExpr(n.location.storeDirect(i)),i=null)):r&&(i=kt(e),n.usedAsValue=!0),t.assert(!!i==r,"!!lit == isExpression");let l=mt(e);if(l)_e=l,_e.reset();else{t.assert(!ye.finalPass,"!bin.finalPass");const i=u(e),r=new t.ir.Procedure;r.isRoot=!!(1&i.flags),r.action=e,r.info=n,i.proc=r,r.usingCtx=re,_e=r,function(e,t,n,i){ge(e,n,i,e=>e.addProc(t))}(ye,r,se,re)}_e.captured=a;const c=[];if(e.parent.kind==t.SK.ClassDeclaration){let n=He(null,e.parent);if(_e.classInfo?t.assert(_e.classInfo==n,"proc.classInfo == classInfo"):_e.classInfo=n,e.kind==t.SK.Constructor){if(n.baseClassInfo)for(let e of n.baseClassInfo.decl.members)e.kind==t.SK.Constructor&&rt(e);n.ctor?t.assert(n.ctor==_e,"classInfo.ctor == proc"):n.ctor=_e;for(let e of n.allfields)if(e.kind==t.SK.PropertyDeclaration&&!k(e)){let t=e;t.initializer&&c.push(t)}}}const d=[],p=[];_e.args=Tt(e).map((n,i)=>{n.name.kind===t.SK.ObjectBindingPattern&&d.push(n),e.kind==t.SK.Constructor&&fe(n)&&p.push(n);let r=new t.ir.Cell(i,n,Oe(n));return St(r.info),r.isarg=!0,r}),_e.args.forEach(e=>{if(e.isByRefLocal()){let n=t.ir.shared(t.ir.rtcall("pxtrt::mklocRef",[]));_e.emitExpr(t.ir.rtcall("pxtrt::stlocRef",[n,e.loadCore()],1)),_e.emitExpr(e.storeDirect(n))}}),d.forEach(e=>_n(e));for(let e of p){let i=Mt(_e.classInfo,Bt(_e.classInfo,K(e)),!1),r=t.ir.op(o.FieldAccess,[je(n.thisParameter)],i);_e.emitExpr(t.ir.op(o.Store,[r,je(e)]))}for(let e of c){let i=Mt(_e.classInfo,Bt(_e.classInfo,K(e)),!1),r=t.ir.op(o.FieldAccess,[je(n.thisParameter)],i);_e.emitExpr(t.ir.op(o.Store,[r,Tn(e.initializer)]))}if(Et(),e.body.kind==t.SK.Block){if(En(e.body),ie(_e.action)){const n=_e.body[_e.body.length-1];n&&n.stmtKind==t.ir.SK.Jmp&&n.jmpMode==t.ir.JmpMode.Always||_e.emitJmp(ln(e).ret,Xt(void 0),t.ir.JmpMode.Always)}}else{let n=Tn(e.body);_e.emitJmp(ln(e).ret,n,t.ir.JmpMode.Always)}_e.emitLblDirect(ln(e).ret),_e.stackEmpty();let f=_e.mkLabel("final");if(ie(_e.action)?_e.emitJmp(f):_e.emitJmp(f,Xt(void 0)),_e.emitLbl(f),n.capturedVars.length&&n.usedBeforeDecl&&e.kind==t.SK.FunctionDeclaration&&!ye.finalPass){n.capturedVars.sort((e,t)=>t.pos-e.pos);const t=Oe(n.capturedVars[0]);t.functionsToDefine||(t.functionsToDefine=[]),t.functionsToDefine.push(e)}return t.assert(!ye.finalPass||0==N.length,"!bin.finalPass || usedWorkList.length == 0"),i}function wt(e){let n=t.ir.shared(e);return _e.emitExpr(n),n}function It(){return wt(t.ir.op(o.JmpValue,[]))}function At(e){if(i.target.isNative)return!1;let n=e;return n.body&&(n.body.kind!=t.SK.Block||n.body.statements.length>0)}function Nt(n){if(!nt(n))return;if(32&u(n).flags)return;let r=j(n);if(null!=r.shim){if("@"==r.shim[0])return;if(i.target.isNative&&t.hexfile.validateShim(oe(n),r.shim,r,ie(n),Tt(n).map(e=>me(ee(e)))),!At(n))return}if(e.isInAmbientContext(n))return;if(!n.body)return;let s=null,o=_e;try{s=Ct(n)}finally{_e=o}return s}function Dt(){}function Ot(e){let t=e;t.needsIRCache=!0,H.push(t)}function Rt(e,n=null){let i=H.length;return e.kind!=t.SK.PropertyAccessExpression&&e.kind!=t.SK.ElementAccessExpression||Ot(e.expression),n&&Ot(n),H.length==i?Dt:()=>{for(let e=i;e<H.length;++e)H[e].cachedIR=null,H[e].needsIRCache=!1;H.splice(i,H.length-i)}}function Lt(e,n=!1){let i={kind:t.SK.NullKeyword,isRefOverride:n};return u(i).valueOverride=e,i}function Pt(e,n,i,r=null){let s=Rt(e),o=r?Tn(r):Xt(1),a=t.ir.shared(Tn(e)),l=t.ir.shared(Vt(n,a,o));return $t(e,Lt(l,!0)),s(),i?a:l}function Mt(e,n,i=!0){k(n)&&t.U.oops("fieldIndex on static field: "+K(n));let r=j(n),s=e.allfields.indexOf(n);return s<0&&ye.finalPass&&t.U.oops("missing field"),{idx:s,name:K(n),isRef:!0,shimName:r.shim,classInfo:e,needsCheck:i}}function Ft(e){const n=ee(e.expression);if(Y(n)){const i=He(n);let r=e.expression.kind==t.SK.ThisKeyword;return t.target.switches.noThisCheckOpt&&(r=!1),Mt(i,Bt(i,e.name.text),!r)}throw Ae(e,B("bad field access"),9247)}function Bt(e,t){const n=e.allfields.filter(e=>e.name.text==t)[0];return n||h(9224,B("field {0} not found",t)),n}function $t(n,i,r=!1){let s=at(n),a=O(s);if(n.kind==t.SK.Identifier||a)if(s&&(a||D(s)||R(s))){let e=Fe(s);Re(s,!0),_e.emitExpr(e.storeByRef(Tn(i)))}else Ae(n,B("bad target identifier"),9248);else if(n.kind==t.SK.PropertyAccessExpression){let r=at(n);if(!r||r.kind!=t.SK.GetAccessor&&r.kind!=t.SK.SetAccessor)if(r&&(r.kind==t.SK.PropertySignature||r.kind==t.SK.PropertyAssignment||Qe(r)))_e.emitExpr(pt(n,n,[i],null,r));else for(;;){if(n.kind===t.SK.PropertyAccessExpression){const e=Ft(n);if(j(Bt(e.classInfo,e.name)).shim){_e.emitExpr(pt(n,n,[i],null,r));break}}let e=Tn(n);_e.emitExpr(t.ir.op(o.Store,[e,Tn(i)]));break}else Ze(r),r=e.getDeclarationOfKind(r.symbol,t.SK.SetAccessor),r||Ae(n,B("setter not available"),9253),_e.emitExpr(pt(n,n,[i],null,r))}else if(n.kind==t.SK.ElementAccessExpression)_e.emitExpr(et(n,i));else if(n.kind==t.SK.ArrayLiteralExpression)if(i.kind==t.SK.ArrayLiteralExpression){const e=i.elements.map(e=>{const n=t.ir.shared(Tn(e));return _e.emitExpr(n),n});n.elements.forEach((t,n)=>{$t(t,Lt(e[n]))})}else{const e=t.ir.shared(Tn(i));n.elements.forEach((n,i)=>{$t(n,Lt(Qt("Array_::getAt",[e,t.ir.numlit(i)])))})}else Ae(n,B("bad assignment target"),9249)}function Ut(e){if(g())switch(e){case"numops::adds":case"numops::subs":case"numops::eors":case"numops::ands":case"numops::orrs":return"@nomask@"+e}return f()&&"pxt::switch_eq"===e?"numops::eq":e}function Vt(e,t,n){return Qt(Ut(e),[t,n])}function Ht(e){if(e.kind==t.SK.Identifier)return e.text;if(e.kind==t.SK.PropertyAccessExpression){const t=e,n=Ht(t.expression);if(n)return n+"."+t.name.text}return null}function Gt(e,t){if(!t)return null;const n=t.val;switch(Ht(e)){case"Math.floor":return{val:Math.floor(n)};case"Math.ceil":return{val:Math.ceil(n)};case"Math.round":return{val:Math.round(n)}}return null}function jt(n){if(!n)return null;const r=u(n);if(void 0!==r.constantFolded)return r.constantFolded;if(D(n)&&n.parent.flags&e.NodeFlags.Const){const e=n;e.initializer&&(r.constantFolded=Kt(e.initializer))}else if(n.kind==t.SK.EnumMember){const e=n,s=function(e){let n=j(e).enumval;if(!n){let t=P.getConstantValue(e);if(null==t)return null;n=t+""}return/^[+-]?\d+$/.test(n)||/^0x[A-Fa-f\d]{2,8}$/.test(n)||i.unfetteredInitializers?n:(t.U.userError("enumval only support number literals"),"0")}(e);if(null==s)r.constantFolded=Kt(e.initializer);else if(i.unfetteredInitializers)r.constantFolded={val:s};else{const e=parseInt(s);isNaN(e)||(r.constantFolded={val:e})}}else if(n.kind==t.SK.PropertyDeclaration&&k(n)&&x(n)){const e=n;r.constantFolded=Kt(e.initializer)}return r.constantFolded}function Kt(e){if(!e)return null;const n=u(e);if(void 0===n.constantFolded){n.constantFolded=null;const i=function(e){if(!e)return null;switch(e.kind){case t.SK.PrefixUnaryExpression:{const n=e,i=Kt(n.operand);return function(e,n){if(!n)return null;const i=n.val;switch(e){case t.SK.PlusToken:return{val:+i};case t.SK.MinusToken:return{val:-i};case t.SK.TildeToken:return{val:~i};case t.SK.ExclamationToken:return{val:!i};default:return null}}(n.operator,i)}case t.SK.BinaryExpression:{const n=e,i=Kt(n.left);if(!i)return null;const r=Kt(n.right);return r?function(e,n,i){if(!n||!i)return null;const r=n.val,s=i.val;switch(e){case t.SK.PlusToken:return{val:r+s};case t.SK.MinusToken:return{val:r-s};case t.SK.SlashToken:return{val:r/s};case t.SK.PercentToken:return{val:r%s};case t.SK.AsteriskToken:return{val:r*s};case t.SK.AsteriskAsteriskToken:return{val:r**s};case t.SK.AmpersandToken:return{val:r&s};case t.SK.BarToken:return{val:r|s};case t.SK.CaretToken:return{val:r^s};case t.SK.LessThanLessThanToken:return{val:r<<s};case t.SK.GreaterThanGreaterThanToken:return{val:r>>s};case t.SK.GreaterThanGreaterThanGreaterThanToken:return{val:r>>>s};case t.SK.LessThanEqualsToken:return{val:r<=s};case t.SK.LessThanToken:return{val:r<s};case t.SK.GreaterThanEqualsToken:return{val:r>=s};case t.SK.GreaterThanToken:return{val:r>s};case t.SK.EqualsEqualsToken:return{val:r==s};case t.SK.EqualsEqualsEqualsToken:return{val:r===s};case t.SK.ExclamationEqualsEqualsToken:return{val:r!==s};case t.SK.ExclamationEqualsToken:return{val:r!=s};case t.SK.BarBarToken:return{val:r||s};case t.SK.AmpersandAmpersandToken:return{val:r&&s};default:return null}}(n.operatorToken.kind,i,r):null}case t.SK.NumericLiteral:{const t=parseFloat(e.text);return isNaN(t)?null:{val:t}}case t.SK.NullKeyword:return{val:null};case t.SK.TrueKeyword:return{val:!0};case t.SK.FalseKeyword:return{val:!1};case t.SK.UndefinedKeyword:return{val:void 0};case t.SK.CallExpression:{const t=e;return 1==t.arguments.length?Gt(t.expression,Kt(t.arguments[0])):null}case t.SK.PropertyAccessExpression:case t.SK.Identifier:return jt(ot(e));case t.SK.AsExpression:return Kt(e.expression);default:return null}}(e);n.constantFolded=i}return n.constantFolded}function zt(e){let n=t.target.switches.boxDebug,i=null;if(n)try{t.target.switches.boxDebug=!1,i=Tn(e)}finally{t.target.switches.boxDebug=n}else i=Tn(e);let r=Yt(i);if(void 0===r)throw h(9267,B("a constant number-like expression is required here"));return r}function Wt(e,t){let n=qt(e,t,"userconfig");return null==n&&(n=qt(e,t,"config")),n}function qt(n,i,r){let s=P.getSymbolsInScope(n,e.SymbolFlags.Module).filter(e=>e.name==r&&!!e.valueDeclaration)[0];if(!s)return null;for(let e of s.valueDeclaration.body.statements)if(e.kind==t.SK.VariableStatement){let t=e;for(let e of t.declarationList.declarations)if(e.symbol.name==i)return zt(e.initializer)}return null}function Jt(t,n){let i=P.getSymbolsInScope(t,e.SymbolFlags.Enum).filter(e=>"DAL"==e.name&&!!e.valueDeclaration)[0];if(!i)return null;let r=i.valueDeclaration.members.filter(e=>e.symbol.name==n)[0];return r?P.getConstantValue(r):null}function Yt(e){if(e.exprKind==t.ir.EK.NumberLiteral){let n=e.data;if(i.target.isNative&&!f()){if(n==t.taggedNull||n==t.taggedUndefined||n==t.taggedFalse)return 0;if(n==t.taggedTrue)return 1;if("number"==typeof n)return n>>1}else if("number"==typeof n)return n}else if(e.exprKind==t.ir.EK.RuntimeCall&&2==e.args.length){let t=Yt(e.args[0]),n=Yt(e.args[1]);if(void 0===t||void 0===n)return;switch(e.data){case"numops::orrs":return t|n;case"numops::adds":return t+n;default:return void pxt.log(e)}}}function Xt(e){if(i.target.isNative&&!f()){const i=Q(e);if(null!=i)return t.ir.numlit(i);if("number"==typeof e){if(n=e,!t.target.switches.boxDebug&&(0|n)==n&&-1073741824<=n&&n<=1073741823)return t.ir.numlit(e<<1|1);{let n=ye.emitDouble(e);return t.ir.ptrlit(n,JSON.stringify(e))}}throw t.U.oops("bad literal: "+e)}return t.ir.numlit(e);var n}function Zt(e){if(e.kind==t.SK.NullKeyword){let t=u(e).valueOverride;if(null!=t)return t.exprKind==o.NumberLiteral?!i.target.isNative||!!(1&t.data):t.exprKind==o.RuntimeCall&&"pxt::ptrOfLiteral"==t.data?t.args[0].exprKind==o.PointerLiteral&&!isNaN(parseFloat(t.args[0].jsInfo)):t.exprKind==o.PointerLiteral&&!isNaN(parseFloat(t.jsInfo))}return e.kind==t.SK.NumericLiteral||me(ee(e))}function Qt(e,n){return t.ir.rtcallMask(e,(1<<n.length)-1,0,n)}function en(e,n,r,a=null){let l=[],c=t.hexfile.lookupFunc(e);if(g()){let n=t.U.lookup(s,e);n&&(c=n,e=n.name)}c&&(l=c.argsFmt),a&&(n=n.concat(a));let u=ct(n),d=[],p=n.map((n,i)=>{let s=Tn(n);if(!m())return s;let a=l[i+1],c=Zt(n);if(!a&&e.indexOf("::")<0&&(a=c?"I":"_"),a){if("_"==a[0]||"T"==a||"N"==a){let e=function(e){switch(e){case"_Buffer":return pxt.BuiltInType.BoxedBuffer;case"_Image":return t.target.imageRefTag||pxt.BuiltInType.RefImage;case"_Action":return pxt.BuiltInType.RefAction;case"_RefCollection":return pxt.BuiltInType.RefCollection;default:return null}}(a);return e&&d.push({argIdx:i,method:"_validate",refTag:e,refTagNullable:!!r.argsNullable}),s}if("I"==a)return s.exprKind==o.NumberLiteral&&"number"==typeof s.data?t.ir.numlit(s.data>>1):(d.push({argIdx:i,method:"pxt::toInt"}),s);if("B"==a)return u&=~(1<<i),an(n,s);if("S"==a)return s.isStringLiteral||(d.push({argIdx:i,method:"_pxt_stringConv",returnsRef:!0}),u|=1<<i),s;if("F"==a||"D"==a)return"D"==a&&t.U.oops("double arguments not yet supported"),c||t.U.userError("argsFmt=...F/D... but argument not a number in "+e),d.push({argIdx:i,method:"D"==a?"pxt::toDouble":"pxt::toFloat"}),s;throw t.U.oops("invalid format specifier: "+a)}throw t.U.userError("not enough args for "+e)}),h=t.ir.rtcallMask(e,u,r?r.callingConvention:0,p);if(h.mask||(h.mask={refMask:0}),h.mask.conversions=d,i.target.isNative){let e=l[0];"I"==e?h=_(h):"B"==e?h=y(h):"F"==e?h=function(e){return m()?t.ir.rtcall("pxt::fromFloat",[e]):e}(h):"D"==e&&(t.U.oops("double returns not yet supported"),h=function(e){return m()?t.ir.rtcall("pxt::fromDouble",[e]):e}(h))}return h}function tn(n){ye.numStmts++;const s=t.assembler.debug||t.target.switches.size||t.target.sourceMap;let o=!!i.breakpoints;if(!s&&!o)return;const a=e.getSourceFileOfNode(n);if(i.justMyCode&&c(a)&&(o=!1),!s&&!o)return;let l=n.pos;for(;/^\s$/.exec(a.text[l]);)l++;for(;"/"==a.text[l]&&"/"==a.text[l+1];){for(;a.text[l]&&"\n"!=a.text[l];)l++;l++}const u=e.getLineAndCharacterOfPosition(a,l);if(s){let e=n.end;e-l>80&&(e=l+80);const i=a.text.slice(l,e).trim().replace(/\n[^]*/,"...");_e.emit(t.ir.comment(`${a.fileName.replace(/pxt_modules\//,"")}(${u.line+1},${u.character+1}): ${i}`))}if(!o)return;const d=e.getLineAndCharacterOfPosition(a,n.end),p={id:r.breakpoints.length,isDebuggerStmt:n.kind==t.SK.DebuggerStatement,fileName:a.fileName,start:l,length:n.end-l,line:u.line,endLine:d.line,column:u.character,endColumn:d.character};r.breakpoints.push(p);const h=t.ir.stmt(t.ir.SK.Breakpoint,null);h.breakpointInfo=p,_e.emit(h)}function nn(e,n){switch(n){case t.SK.PlusToken:return"numops::adds";case t.SK.MinusToken:return"numops::subs";case t.SK.SlashToken:return"numops::div";case t.SK.PercentToken:return"numops::mod";case t.SK.AsteriskToken:return"numops::muls";case t.SK.AsteriskAsteriskToken:return"Math_::pow";case t.SK.AmpersandToken:return"numops::ands";case t.SK.BarToken:return"numops::orrs";case t.SK.CaretToken:return"numops::eors";case t.SK.LessThanLessThanToken:return"numops::lsls";case t.SK.GreaterThanGreaterThanToken:return"numops::asrs";case t.SK.GreaterThanGreaterThanGreaterThanToken:return"numops::lsrs";case t.SK.LessThanEqualsToken:return"numops::le";case t.SK.LessThanToken:return"numops::lt";case t.SK.GreaterThanEqualsToken:return"numops::ge";case t.SK.GreaterThanToken:return"numops::gt";case t.SK.EqualsEqualsToken:return"numops::eq";case t.SK.EqualsEqualsEqualsToken:return"numops::eqq";case t.SK.ExclamationEqualsEqualsToken:return"numops::neqq";case t.SK.ExclamationEqualsToken:return"numops::neq";default:return null}}function rn(e){if(e.operatorToken.kind==t.SK.EqualsToken)return function(e){let n=e.right;e.parent.kind==t.SK.ExpressionStatement&&(n=null);let i=Rt(e.left,n);$t(e.left,e.right,!0);let r=n?Tn(n):Xt(void 0);return i(),r}(e);const n=Kt(e);if(n)return Xt(n.val);let i=null,r=null;e.operatorToken.kind!=t.SK.PlusToken&&e.operatorToken.kind!=t.SK.PlusEqualsToken||(i=ee(e.left),r=ee(e.right),(de(i)||de(r)&&e.operatorToken.kind==t.SK.PlusToken)&&(u(e).exprInfo={leftType:P.typeToString(i),rightType:P.typeToString(r)}));if(e.operatorToken.kind==t.SK.CommaToken){if(cn(e.left))return Tn(e.right);{let n=un(e.left);return t.ir.op(o.Sequence,[n,Tn(e.right)])}}switch(e.operatorToken.kind){case t.SK.BarBarToken:case t.SK.AmpersandAmpersandToken:return function(e){let n=Tn(e.left),i=(de(ee(e.left)),_e.mkLabel("lazy"));n=t.ir.shared(n);let r=t.ir.rtcall("numops::toBool",[n]),s=_e.mkLabel("lazySkip"),o=e.operatorToken.kind==t.SK.BarBarToken?t.ir.JmpMode.IfZero:e.operatorToken.kind==t.SK.AmpersandAmpersandToken?t.ir.JmpMode.IfNotZero:t.U.oops();return _e.emitJmp(s,r,o),_e.emitJmp(i,n,t.ir.JmpMode.Always,n),_e.emitLbl(s),_e.emitExpr(Qt("langsupp::ignore",[n])),_e.emitJmp(i,Tn(e.right),t.ir.JmpMode.Always),_e.emitLbl(i),It()}(e);case t.SK.InstanceOfKeyword:return function(e){let n=ee(e.right),i=Y(n)?at(e.right):null;i&&i.kind==t.SK.ClassDeclaration||h(9275,B("unsupported instanceof expression"));let r=He(n,i);bt(r);let s=t.ir.op(t.ir.EK.InstanceOf,[Tn(e.left)],r);return s.jsInfo="bool",s}(e)}if(e.operatorToken.kind==t.SK.PlusToken&&(de(i)||de(r)))return en("String_::concat",[Ye(e.left),Ye(e.right)],null);if(e.operatorToken.kind==t.SK.PlusEqualsToken&&de(i)){let n=Rt(e.left),i=t.ir.shared(en("String_::concat",[Ye(e.left),Ye(e.right)],null));return $t(e.left,Lt(i)),n(),i}let s=function(e){switch(e){case t.SK.PlusEqualsToken:return t.SK.PlusToken;case t.SK.MinusEqualsToken:return t.SK.MinusToken;case t.SK.AsteriskEqualsToken:return t.SK.AsteriskToken;case t.SK.AsteriskAsteriskEqualsToken:return t.SK.AsteriskAsteriskToken;case t.SK.SlashEqualsToken:return t.SK.SlashToken;case t.SK.PercentEqualsToken:return t.SK.PercentToken;case t.SK.LessThanLessThanEqualsToken:return t.SK.LessThanLessThanToken;case t.SK.GreaterThanGreaterThanEqualsToken:return t.SK.GreaterThanGreaterThanToken;case t.SK.GreaterThanGreaterThanGreaterThanEqualsToken:return t.SK.GreaterThanGreaterThanGreaterThanToken;case t.SK.AmpersandEqualsToken:return t.SK.AmpersandToken;case t.SK.BarEqualsToken:return t.SK.BarToken;case t.SK.CaretEqualsToken:return t.SK.CaretToken;default:return t.SK.Unknown}}(e.operatorToken.kind),a=nn(0,s||e.operatorToken.kind);return a||Ae(e.operatorToken,B("unsupported operator"),9250),s?Pt(e.left,a,!1,e.right):(n=>{n=Ut(n);let i=[e.left,e.right];return t.ir.rtcallMask(n,ct(i),0,i.map(e=>Tn(e)))})(a)}function sn(e){e.statements.forEach(En)}function on(t){if(t.flags&e.NodeFlags.Let||t.flags&e.NodeFlags.Const)return!0;throw h(9260,B("variable needs to be defined using 'let' instead of 'var'"))}function an(e,n=null){if(!n&&g()&&e.kind==t.SK.BinaryExpression){let n=e,i=t.U.lookup(t.thumbCmpMap,nn(0,n.operatorToken.kind));if(i)return t.ir.rtcall(i,[Tn(n.left),Tn(n.right)])}return n||(n=Tn(e)),f()?n:t.ir.rtcall("numops::toBoolDecr",[n])}function ln(e){let t=d(e);return{fortop:".fortop."+t,cont:".cont."+t,brk:".brk."+t,ret:".ret."+t}}function cn(e){if(!e)return!0;switch(e.kind){case t.SK.Identifier:case t.SK.StringLiteral:case t.SK.NumericLiteral:case t.SK.NullKeyword:return!0}return!1}function un(e){return Tn(e)}function dn(e){if(cn(e))return;tn(e);let t=un(e);_e.emitExpr(t),_e.stackEmpty()}function pn(e=1){for(;e--;)_e.emitExpr(Qt("pxt::endTry",[]))}function hn(){h(9282,B("jumps (return, break, continue) through finally blocks not supported yet"))}function fn(t){let n=0;if(t.kind==e.SyntaxKind.Block&&t.parent)if(t.parent.kind==e.SyntaxKind.CatchClause){t.parent.parent.finallyBlock&&(n++,hn())}else if(t.parent.kind==e.SyntaxKind.TryStatement){const e=t.parent;e.tryBlock==t&&(e.catchClause&&n++,e.finallyBlock&&(n++,hn()))}return n}function mn(e){switch(e.kind){case t.SK.WhileStatement:case t.SK.ForInStatement:case t.SK.ForOfStatement:case t.SK.ForStatement:case t.SK.DoStatement:return!0;default:return!1}}function gn(e,n,r){if(e.name.kind===t.SK.ObjectBindingPattern||e.name.kind==t.SK.ArrayBindingPattern)return n||(n=e.initializer?t.ir.shared(Tn(e.initializer)):je(e),r=e.initializer?ee(e.initializer):ee(e)),e.name.elements.forEach(e=>gn(e,n,r)),_e.stackEmpty(),null;if(!nt(e))return null;if(jt(e))return null;let s;if(O(e)?(Me(e),s=Fe(e)):s=_e.mkLocal(e,Oe(e)),St(s.info),s.isByRefLocal()&&_e.emitExpr(s.storeDirect(t.ir.rtcall("pxtrt::mklocRef",[]))),Pe(ee(e)),e.kind===t.SK.BindingElement){tn(e);let[t,i]=yn(e,n,r);_e.emitExpr(s.storeByRef(t))}else if(e.initializer){if(tn(e),O(e)){let n=j(e).jres;if(n){"true"==n&&(n=V(P,e));let r=t.U.lookup(i.jres||{},n);r?te=r:h(9270,B("resource '{0}' not found in any .jres file",n))}}e.initializer,_e.emitExpr(s.storeByRef(Tn(e.initializer))),te=null,_e.stackEmpty()}else(function(e){for(;e;){if(mn(e))return!0;e=e.parent}return!1})(e)&&(tn(e),_e.emitExpr(s.storeByRef(Xt(void 0))),_e.stackEmpty());return s}function _n(e){return gn(e,null,null)}function yn(e,n,i){const r=e.parent.parent;if(r.kind===t.SK.BindingElement){const e=yn(r,n,i);n=e[0],i=e[1]}if(e.parent.kind==t.SK.ArrayBindingPattern){const r=e.parent.elements.indexOf(e);e.dotDotDotToken&&h(9203,B("spread operator not supported yet"));const s=X(i,r);return[Qt("Array_::getAt",[n,t.ir.numlit(r)]),s]}return function(e,n,i,r){const s=P.getPropertyOfType(i,r);t.U.assert(!!s,"field sym");const a=P.getTypeOfSymbolAtLocation(s,e);let l;if(Y(i)){const e=He(i);l=t.ir.op(o.FieldAccess,[n],Mt(e,Bt(e,r)))}else l=ft([n],{ifaceIndex:Le(r,!0),callLocationIndex:Cn(e),noArgs:!0});return[l,a]}(e,n,i,(e.propertyName||e.name).text)}function bn(e){!function(e,n){const i=e=>{e&&e.kind==t.SK.ClassDeclaration&&h(9261,B("Interface with same name as a class not supported"))};if(i(n.symbol.valueDeclaration),n.symbol.declarations&&n.symbol.declarations.forEach(i),n.heritageClauses)for(let e of n.heritageClauses)e.token===t.SK.ExtendsKeyword&&J(ee(e.types[0]))&&h(9262,B("Extending a class by an interface not supported."))}(0,e);let n=j(e);n.autoCreate&&(z[n.autoCreate]=!0)}function vn(e,t){let n=F;U++;try{F=null;let i=t(e);return F&&h($,F),F=n,U--,i}catch(t){return U--,F=null,Ie(e,t.ksErrorCode||9200,t.message),pxt.debug(t.stack),null}}function Tn(e,n=!0){let i=e;if(n&&i.cachedIR)return i.cachedIR;let r=vn(i,kn)||Xt(void 0);return n&&i.needsIRCache?(i.cachedIR=t.ir.shared(r),i.cachedIR):r}function kn(n){let i=function(n){switch(n.kind){case t.SK.NullKeyword:let i=u(n).valueOverride;return i||Xt(null);case t.SK.TrueKeyword:return Xt(!0);case t.SK.FalseKeyword:return Xt(!1);case t.SK.TemplateHead:case t.SK.TemplateMiddle:case t.SK.TemplateTail:case t.SK.NumericLiteral:case t.SK.StringLiteral:case t.SK.NoSubstitutionTemplateLiteral:return function(e){if(e.kind==t.SK.NumericLiteral)return e.imageLiteral?t.ir.ptrlit(e.imageLiteral,e.jsLit):Xt(parseFloat(e.text));if(T(e))return Je(e.text);throw t.oops()}(n);case t.SK.TaggedTemplateExpression:return vt(n);case t.SK.PropertyAccessExpression:return function(e){let n=at(e);const i=jt(n);if(i)return Xt(i.val);if(n.kind==t.SK.SetAccessor&&(n=Ze(n)),n.kind==t.SK.GetAccessor)return pt(e,e,[],null,n);if(n.kind==t.SK.EnumMember)throw h(9210,B("Cannot compute enum value"));if(n.kind==t.SK.PropertySignature||n.kind==t.SK.PropertyAssignment)return pt(e,e,[],null,n,e.expression);if(n.kind==t.SK.PropertyDeclaration||n.kind==t.SK.Parameter){if(k(n))return je(n);if(Qe(n))return pt(e,e,[],null,n,e.expression);{let i=Ft(e);const r=Bt(i.classInfo,i.name);return j(r).shim?ut(r,n,[e.expression]):t.ir.op(o.FieldAccess,[Tn(e.expression)],i)}}if(w(n)||n.kind==t.SK.MethodSignature)throw h(9211,B("cannot use method as lambda; did you forget '()' ?"));if(n.kind==t.SK.FunctionDeclaration)return Ke(n);if(D(n))return je(n);throw Ae(e,B("Unknown property access for {0}",p(n)),9237)}(n);case t.SK.BinaryExpression:return rn(n);case t.SK.PrefixUnaryExpression:return function(e){const n=Kt(e);if(n)return Xt(n.val);switch(e.operator){case t.SK.ExclamationToken:return y(t.ir.rtcall("Boolean_::bang",[an(e.operand)]));case t.SK.PlusPlusToken:return Pt(e.operand,"numops::adds",!1);case t.SK.MinusMinusToken:return Pt(e.operand,"numops::subs",!1);case t.SK.PlusToken:case t.SK.MinusToken:{let n=Tn(e.operand),i=Yt(n);return null!=i?Xt(-i):e.operator==t.SK.MinusToken?Vt("numops::subs",Xt(0),n):Vt("numops::subs",n,Xt(0))}case t.SK.TildeToken:{let t=Tn(e.operand),n=Yt(t);return null!=n?Xt(~n):Qt(Ut("numops::bnot"),[t])}default:throw Ae(e,B("unsupported prefix unary operation"),9245)}}(n);case t.SK.PostfixUnaryExpression:return function(e){if(pe(ee(e.operand)))switch(e.operator){case t.SK.PlusPlusToken:return Pt(e.operand,"numops::adds",!0);case t.SK.MinusMinusToken:return Pt(e.operand,"numops::subs",!0)}throw Ae(e,B("unsupported postfix unary operation"),9246)}(n);case t.SK.ElementAccessExpression:return et(n);case t.SK.ParenthesizedExpression:return function(e){return Tn(e.expression)}(n);case t.SK.TypeAssertionExpression:return function(e){return e.expression,Tn(e.expression)}(n);case t.SK.ArrayLiteralExpression:return function(e){X(ee(e));let n=t.ir.shared(t.ir.rtcall("Array_::mk",[]));for(let i of e.elements){let e=lt(i)?2:0;_e.emitExpr(t.ir.rtcall("Array_::push",[n,Tn(i)],e))}return e.elements.length>0&&_e.emitExpr(t.ir.rtcall("langsupp::ignore",[n],1)),n}(n);case t.SK.NewExpression:return function(e){let n=P.getTypeAtLocation(e);if(n&&W(n))throw t.oops();if(n&&Y(n)){let n,i=at(e.expression);i.kind!=t.SK.ClassDeclaration&&h(9221,B("new expression only supported on class types"));let r=He(ee(e),i);for(let e=r;e&&(n=_t(e.decl),!n);e=e.baseClassInfo);bt(r);let s=r.id+"_VT",o=t.ir.rtcall("pxt::mkClassInstance",[t.ir.ptrlit(s,s)]);if(n){o=wt(o),it(n);let i=(e.arguments||[]).slice(0),r=j(n);dt(P.getResolvedSignature(e),i,r);let s=i.map(e=>Tn(e));return r.shim?t.ir.rtcall(r.shim,s):(s.unshift(o),_e.emitExpr(gt(n,e,s)),o)}return e.arguments&&e.arguments.length&&h(9222,B("constructor with arguments not found")),o}throw Ae(e,B("unknown type for new"),9243)}(n);case t.SK.SuperKeyword:case t.SK.ThisKeyword:return qe(n);case t.SK.CallExpression:return function(e){const t=P.getResolvedSignature(e);return pt(e,e.expression,e.arguments,t)}(n);case t.SK.FunctionExpression:case t.SK.ArrowFunction:return Nt(n);case t.SK.Identifier:return We(n);case t.SK.ConditionalExpression:return function(e){let n=_e.mkLabel("condexprz"),i=_e.mkLabel("condexprfin");return _e.emitJmp(n,an(e.condition),t.ir.JmpMode.IfZero),_e.emitJmp(i,Tn(e.whenTrue),t.ir.JmpMode.Always),_e.emitLbl(n),_e.emitJmp(i,Tn(e.whenFalse),t.ir.JmpMode.Always),_e.emitLbl(i),It()}(n);case t.SK.AsExpression:return function(e){return e.expression,Tn(e.expression)}(n);case t.SK.TemplateExpression:return Xe(n);case t.SK.ObjectLiteralExpression:return function(e){let n=t.ir.shared(t.ir.rtcall("pxtrt::mkMap",[]));return e.properties.forEach(e=>{let i,r;t.assert(!e.questionToken);let s=0;if(e.kind==t.SK.ShorthandPropertyAssignment){const n=e;t.assert(!n.equalsToken&&!n.objectAssignmentInitializer),i=e.name.text;const s=P.getShorthandAssignmentValueSymbol(e),o=s&&s.valueDeclaration&&s.valueDeclaration.name;if(!o||o.kind!=t.SK.Identifier)throw Ae(e);r=We(o)}else{if(e.name.kind==t.SK.ComputedPropertyName){const t=e.name.expression;return void _e.emitExpr(en("pxtrt::mapSetByString",[Lt(n,!0),t,e.initializer],null))}i=e.name.kind==t.SK.StringLiteral?e.name.text:e.name.getText(),r=Tn(e.initializer),lt(e.initializer)&&(s|=4)}const o=t.target.isNative?t.ir.numlit(Le(i)):t.ir.ptrlit(null,JSON.stringify(i)),a=[n,o,r];_e.emitExpr(t.ir.rtcall(t.target.isNative?"pxtrt::mapSet":"pxtrt::mapSetByString",a,s))}),e.properties.length>0&&_e.emitExpr(t.ir.rtcall("langsupp::ignore",[n],1)),n}(n);case t.SK.TypeOfExpression:return function(e){return en("pxt::typeOf",[e.expression],null)}(n);case e.SyntaxKind.DeleteExpression:return function(e){let n,i;if(e.expression.kind==t.SK.PropertyAccessExpression){const t=e.expression;n=t.expression,i=Lt(Je(t.name.text))}else{if(e.expression.kind!=t.SK.ElementAccessExpression)throw h(9276,B("expression not supported as argument to 'delete'"));{const t=e.expression;n=t.expression,i=t.argumentExpression}}const r=ee(n);if(J(r))throw h(9277,B("'delete' not supported on class types"));if(W(r))throw h(9277,B("'delete' not supported on array"));return en("pxtrt::mapDeleteByString",[n,i],null)}(n);default:return Ae(n),null}}(n);if(i.isExpr())return i;throw new Error("expecting expression")}function xn(n){const i=u(n);if(i.usedNodes){se=!1;for(let e of t.U.values(i.usedNodes))it(e);for(let e of i.usedActions)e(ye);se=!0}else O(n)||e.isClassDeclaration(n)?(se=!1,re=i,re.usedNodes=null,re.usedActions=null,O(n)&&!jt(n)&&Me(n),En(n),se=!0):(re=i,re.usedNodes={},re.usedActions=[],En(n),re=null)}function En(e){vn(e,Sn)}function Sn(n){switch(n.kind){case t.SK.SourceFile:return function(e){e.statements.forEach(En)}(n);case t.SK.InterfaceDeclaration:return bn(n);case t.SK.VariableStatement:return function(n){function i(e){let n=t.U.lookup(Z,e.name);if(n||(n=e,Z[e.name]=n),n.value!=e.value)throw h(9269,B("conflicting values for config.{0}",e.name))}if(n.declarationList.flags&e.NodeFlags.Const){let e=n.parent&&n.parent.kind==t.SK.ModuleBlock?K(n.parent.parent):"?";if("config"==e||"userconfig"==e)for(let t of n.declarationList.declarations){let r=oe(t);if(!t.initializer)continue;let s=zt(t.initializer),o=Jt(n,"CFG_"+r);if(null==o||0==o)throw h(9268,B("can't find DAL.CFG_{0}",r));"userconfig"==e&&(r="!"+r),i({name:r,key:o,value:s})}}e.isInAmbientContext(n)||(on(n.declarationList),n.declarationList.declarations.forEach(En))}(n);case t.SK.ModuleDeclaration:return function(e){En(e.body)}(n);case t.SK.EnumDeclaration:return;case t.SK.FunctionDeclaration:case t.SK.Constructor:case t.SK.MethodDeclaration:return void Nt(n);case t.SK.ExpressionStatement:return function(e){dn(e.expression)}(n);case t.SK.Block:case t.SK.ModuleBlock:return sn(n);case t.SK.VariableDeclaration:return _n(n),void Et();case t.SK.IfStatement:return function(e){tn(e);let t=_e.mkLabel("else");_e.emitJmpZ(t,an(e.expression)),En(e.thenStatement);let n=_e.mkLabel("afterif");_e.emitJmp(n),_e.emitLbl(t),e.elseStatement&&En(e.elseStatement),_e.emitLbl(n)}(n);case t.SK.WhileStatement:return function(e){tn(e);let t=ln(e);_e.emitLblDirect(t.cont),tn(e.expression),_e.emitJmpZ(t.brk,an(e.expression)),En(e.statement),_e.emitJmp(t.cont),_e.emitLblDirect(t.brk)}(n);case t.SK.DoStatement:return function(e){tn(e);let t=ln(e);_e.emitLblDirect(t.cont),En(e.statement),tn(e.expression),_e.emitJmpZ(t.brk,an(e.expression)),_e.emitJmp(t.cont),_e.emitLblDirect(t.brk)}(n);case t.SK.ForStatement:return function(e){e.initializer&&e.initializer.kind==t.SK.VariableDeclarationList?(on(e.initializer),e.initializer.declarations.forEach(En)):dn(e.initializer),tn(e);let n=ln(e);_e.emitLblDirect(n.fortop),e.condition&&(tn(e.condition),_e.emitJmpZ(n.brk,an(e.condition))),En(e.statement),_e.emitLblDirect(n.cont),dn(e.incrementor),_e.emitJmp(n.fortop),_e.emitLblDirect(n.brk)}(n);case t.SK.ForOfStatement:return function(e){if(!e.initializer||e.initializer.kind!=t.SK.VariableDeclarationList)return void Ae(e,"only a single variable may be used to iterate a collection");let n=e.initializer;if(1!=n.declarations.length)return void Ae(e,"only a single variable may be used to iterate a collection");on(n);let i=ee(e.expression),r="",s="";if(de(i))r="String_::charAt",s="String_::length";else{if(!W(i))return void Ae(e.expression,"cannot use for...of with this expression");r="Array_::getAt",s="Array_::length"}it(n.declarations[0]);const o=_n(n.declarations[0]);t.U.assert(!!o||!ye.finalPass),_e.stackEmpty();let a=_e.mkLocalUnnamed();_e.emitExpr(a.storeByRef(Tn(e.expression)));let l=_e.mkLocalUnnamed();_e.emitExpr(l.storeByRef(Xt(0))),_e.stackEmpty(),tn(e);let c=ln(e);_e.emitLblDirect(c.fortop);let u=t.ir.rtcall(s,[a.loadCore()]),d=Vt("numops::lt_bool",l.load(),_(u));_e.emitJmpZ(c.brk,d);let p=e=>m()?t.ir.rtcall("pxt::toInt",[e]):e;o&&(_e.emitExpr(o.storeByRef(t.ir.rtcall(r,[a.loadCore(),p(l.loadCore())]))),tn(e.initializer)),Et(),En(e.statement),_e.emitLblDirect(c.cont),_e.emitExpr(l.storeByRef(Vt("numops::adds",l.load(),Xt(1)))),_e.emitJmp(c.fortop),_e.emitLblDirect(c.brk),_e.emitExpr(a.storeByRef(Xt(void 0)))}(n);case t.SK.ContinueStatement:case t.SK.BreakStatement:return function(n){tn(n);let i=n.label?n.label.text:null,r=n.kind==t.SK.BreakStatement,s=0,o=function n(o){return o?i&&o.kind==t.SK.LabeledStatement&&o.label.text==i?o.statement:o.kind==t.SK.SwitchStatement&&!i&&r||!i&&e.isIterationStatement(o,!1)?o:(s+=fn(o),n(o.parent)):null}(n);if(o){let i=ln(o);pn(s),n.kind==t.SK.ContinueStatement?e.isIterationStatement(o,!1)?_e.emitJmp(i.cont):Ie(n,9231,B("continue on non-loop")):n.kind==t.SK.BreakStatement?_e.emitJmp(i.brk):t.oops()}else Ie(n,9230,B("cannot find outer loop"))}(n);case t.SK.LabeledStatement:return function(e){let t=ln(e.statement);En(e.statement),_e.emitLblDirect(t.brk)}(n);case t.SK.ReturnStatement:return function(e){tn(e);let n=null;e.expression?n=Tn(e.expression):ie(_e.action)&&(n=Xt(void 0));let i=0;for(let t=e;t&&t!=_e.action;t=t.parent)i+=fn(t);pn(i),_e.emitJmp(ln(_e.action).ret,n,t.ir.JmpMode.Always)}(n);case t.SK.ClassDeclaration:return function(e){const t=He(null,e);t.isUsed&&ye.usedClassInfos.indexOf(t)<0&&ye.usedClassInfos.push(t),e.members.forEach(En)}(n);case t.SK.PropertyDeclaration:case t.SK.PropertyAssignment:return function(e){if(k(e))_n(e);else if(e.initializer){let t=He(ee(e.parent));ye.finalPass&&t.isUsed&&!t.ctor&&h(9209,B("class field initializers currently require an explicit constructor"))}}(n);case t.SK.SwitchStatement:return function(e){tn(e);let n,i=ln(e),r=t.ir.shared(Tn(e.expression)),s=e.caseBlock.clauses.map(e=>{let i=_e.mkLabel("switch");if(e.kind==t.SK.CaseClause){let n=e,s=Tn(n.expression),o=lt(n.expression)?1:0,a=t.ir.rtcallMask(Ut("pxt::switch_eq"),o,0,[s,r]);_e.emitJmp(i,a,t.ir.JmpMode.IfNotZero,r)}else e.kind==t.SK.DefaultClause?(t.assert(!n,"!defaultLabel"),n=i):t.oops();return i});n?_e.emitJmp(n,r):_e.emitJmp(i.brk,r),e.caseBlock.clauses.forEach((e,t)=>{_e.emitLbl(s[t]),e.statements.forEach(En)}),_e.emitLblDirect(i.brk)}(n);case t.SK.TypeAliasDeclaration:return;case e.SyntaxKind.TryStatement:return function(e){const n=e=>Qt("pxt::beginTry",[t.ir.ptrlit(e.lblName,e)]);tn(e);const i=_e.mkLabel("catch");i.lblName="_catch_"+d(e);const r=_e.mkLabel("finally");if(r.lblName="_finally_"+d(e),e.finallyBlock&&_e.emitExpr(n(r)),e.catchClause&&_e.emitExpr(n(i)),_e.stackEmpty(),sn(e.tryBlock),_e.stackEmpty(),e.catchClause){const t=_e.mkLabel("catchend");pn(),_e.emitJmp(t),_e.emitLbl(i);const n=e.catchClause.variableDeclaration;if(n){_n(n);const e=Fe(n);_e.emitExpr(e.storeByRef(Qt("pxt::getThrownValue",[])))}Et(),sn(e.catchClause.block),_e.emitLbl(t)}e.finallyBlock&&(pn(),_e.emitLbl(r),sn(e.finallyBlock),_e.emitExpr(Qt("pxt::endFinally",[])))}(n);case e.SyntaxKind.ThrowStatement:return function(e){tn(e),_e.emitExpr(Qt("pxt::throwValue",[Tn(e.expression)]))}(n);case t.SK.DebuggerStatement:return function(e){tn(e)}(n);case t.SK.GetAccessor:case t.SK.SetAccessor:return function(e){Nt(e)}(n);case t.SK.ImportEqualsDeclaration:case t.SK.EmptyStatement:case t.SK.SemicolonClassElement:return;default:Ae(n)}}function Cn(e){return r.procCallLocations.push(t.nodeLocationInfo(e))-1}},t.isStringType=de;class he{constructor(){this.procs=[],this.globals=[],this.finalPass=!1,this.writeFile=(e,t)=>{},this.usedClassInfos=[],this.numStmts=1,this.commSize=0,this.itEntries=0,this.itFullEntries=0,this.numMethods=0,this.numVirtMethods=0,this.usedChars=new Uint32Array(2048),this.explicitlyUsedIfaceMembers={},this.ifaceMemberMap={},this.strings={},this.hexlits={},this.doubles={},this.otherLiterals=[],this.codeHelpers={},this.lblNo=0}reset(){this.lblNo=0,this.otherLiterals=[],this.strings={},this.hexlits={},this.doubles={},this.numStmts=0}getTitle(){const e=this.name||t.U.lf("Untitled");return e.length>=90?e.slice(0,87)+"...":e}addProc(e){t.assert(!this.finalPass,"!this.finalPass"),this.procs.push(e),e.seqNo=this.procs.length}recordHelper(e,t,n){const i=e=>{e.codeHelpers[t]||(e.codeHelpers[t]=n(e))};i(this),this.recordAction(e,i)}recordAction(e,n){e?e.usedActions&&e.usedActions.push(n):t.U.oops("no using ctx!")}emitLabelled(e,n,i){let r=t.U.lookup(n,e);if(null!=r)return r;let s=i+this.lblNo++;return n[e]=s,s}emitDouble(e){return this.emitLabelled(t.target.switches.numFloat?function(e){let n=new Float32Array(1);return n[0]=e,t.U.toHex(new Uint8Array(n.buffer))}(e):function(e){let n=new Float64Array(1);return n[0]=e,t.U.toHex(new Uint8Array(n.buffer))}(e),this.doubles,"_dbl")}emitString(e){if(!this.finalPass)for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);n>=128&&(this.usedChars[n>>5]|=1<<(31&n))}return this.emitLabelled(e,this.strings,"_str")}emitHexLiteral(e){return this.emitLabelled(e,this.hexlits,"_hexlit")}setPerfCounters(e){if(!t.target.switches.profile)return[];const n=e.slice();return this.procs.forEach(e=>{e.perfCounterName&&(t.U.assert(t.target.switches.profile),e.perfCounterNo=n.length,n.push(e.perfCounterName))}),n}}function fe(e){if(!e.modifiers)return!1;if(e.parent.kind!=t.SK.Constructor)return!1;for(let n of e.modifiers)if(n.kind==t.SK.PrivateKeyword||n.kind==t.SK.PublicKeyword||n.kind==t.SK.ProtectedKeyword)return!0;return!1}function me(t){return t.flags&e.TypeFlags.Union?t.types.every(e=>me(e)):!!(t.flags&(e.TypeFlags.NumberLike|e.TypeFlags.EnumLike|e.TypeFlags.BooleanLike))}function ge(e,t,n,i){const r=i(e);return t&&e.recordAction(n,i),r}t.Binary=he,t.isCtorField=fe}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(ts){var pxtc;(function(pxtc){function getTsCompilerOptions(e){let t=ts.getDefaultCompilerOptions();return t.target=ts.ScriptTarget.ES5,t.module=ts.ModuleKind.None,t.noImplicitAny=!0,t.noImplicitReturns=!0,t.allowUnreachableCode=!0,Object.assign(Object.assign({},t),null==e?void 0:e.tsCompileOptions)}function nodeLocationInfo(e){let t=ts.getSourceFileOfNode(e);const n=e.getStart?e.getStart():e.pos,{line:i,character:r}=ts.getLineAndCharacterOfPosition(t,n),{line:s,character:o}=ts.getLineAndCharacterOfPosition(t,e.end);return{start:n,length:e.end-n,line:i,column:r,endLine:s,endColumn:o,fileName:t.fileName}}function patchUpDiagnostics(e,t=!1){t&&(e=e.filter(e=>5012!==e.code));let n=e.filter(e=>1148==e.code);return n.length>0&&(e=n),e.map(e=>{if(!e.file){return{code:e.code,start:e.start,length:e.length,line:0,column:0,messageText:ts.flattenDiagnosticMessageText(e.messageText,"\n"),category:e.category,fileName:"?"}}const t=ts.getLineAndCharacterOfPosition(e.file,e.start);let n={code:e.code,start:e.start,length:e.length,line:t.line,column:t.character,messageText:ts.flattenDiagnosticMessageText(e.messageText,"\n"),category:e.category,fileName:e.file.fileName};return 1148==n.code&&(n.messageText=pxtc.Util.lf("all symbols in top-level scope are always exported; please use a namespace if you want to export only some")),n})}function py2tsIfNecessary(e){if(e.target.preferredEditor==pxt.PYTHON_PROJECT_NAME){return pxtc.transpile.pyToTs(e)}}function mkCompileResult(){return{outfiles:{},diagnostics:[],success:!1,times:{}}}function storeGeneratedFiles(e,t){for(let n of e.generatedFiles||[])t.outfiles[n]=e.fileSystem[n]}function runConversionsAndStoreResults(e,t){const n=pxtc.U.cpuUs();t||(t=mkCompileResult());const i=py2tsIfNecessary(e);i&&(t=Object.assign(Object.assign({},t),{diagnostics:i.diagnostics,sourceMap:i.sourceMap,globalNames:i.globalNames})),storeGeneratedFiles(e,t),e.sourceFiles||(e.sourceFiles=Object.keys(e.fileSystem));const r=e.sourceFiles.indexOf(pxt.MAIN_TS);r>=0&&(e.sourceFiles.splice(r,1),e.sourceFiles.push(pxt.MAIN_TS));const s=e.sourceFiles.indexOf(pxt.TUTORIAL_CODE_STOP);return s>=0&&(e.sourceFiles.splice(s,1),e.sourceFiles.push(pxt.TUTORIAL_CODE_STOP)),t.times.conversions=pxtc.U.cpuUs()-n,t}function timesToMs(e){for(let t of Object.keys(e.times))e.times[t]=Math.round(e.times[t])/1e3}function buildProgram(e,t){let n={};for(let t in e.fileSystem)n[normalizePath(t)]=e.fileSystem[t];let i=getTsCompilerOptions(e),r={getSourceFile:(e,t,i)=>{e=normalizePath(e);let r="";return n.hasOwnProperty(e)?r=n[e]:i&&i("File not found: "+e),null==r&&(i("File not found: "+e),r=""),ts.createSourceFile(e,r,t,true)},fileExists:e=>(e=normalizePath(e),n.hasOwnProperty(e)),getCanonicalFileName:e=>e,getDefaultLibFileName:()=>"no-default-lib.d.ts",writeFile:(e,n,i,r)=>{t.outfiles[e]=n},getCurrentDirectory:()=>".",useCaseSensitiveFileNames:()=>!0,getNewLine:()=>"\n",readFile:e=>(e=normalizePath(e),n[e]||""),directoryExists:e=>!0,getDirectories:()=>[]},s=e.sourceFiles.filter(e=>pxtc.U.endsWith(e,".ts"));return ts.createProgram(s,i,r)}function isPxtModulesFilename(e){return pxtc.U.startsWith(e,"pxt_modules/")}function compile(opts,service){pxtc.compilerHooks||(pxtc.compilerHooks={},opts.target.compilerExtension&&eval(opts.target.compilerExtension)),pxtc.compilerHooks.init&&pxtc.compilerHooks.init(opts,service);let startTime=pxtc.U.cpuUs(),res=mkCompileResult(),program;if(service)storeGeneratedFiles(opts,res),program=service.getProgram();else{if(runConversionsAndStoreResults(opts,res),res.diagnostics.length>0)return res;program=buildProgram(opts,res)}const entryPoint=opts.sourceFiles.filter(e=>pxtc.U.endsWith(e,".ts")).pop().replace(/.*\//,"");if(res.diagnostics=patchUpDiagnostics(program.getSyntacticDiagnostics(),opts.ignoreFileResolutionErrors),res.diagnostics.length>0)return opts.forceEmit&&(pxt.debug("syntactic errors, forcing emit"),pxtc.compileBinary(program,opts,res,entryPoint)),res;res.diagnostics=patchUpDiagnostics(program.getOptionsDiagnostics().concat(pxtc.Util.toArray(program.getGlobalDiagnostics())),opts.ignoreFileResolutionErrors);const semStart=pxtc.U.cpuUs();0==res.diagnostics.length&&(res.diagnostics=patchUpDiagnostics(program.getSemanticDiagnostics(),opts.ignoreFileResolutionErrors));const emitStart=pxtc.U.cpuUs();if(res.times["typescript-syn"]=semStart-startTime,res.times["typescript-sem"]=emitStart-semStart,res.times.typescript=emitStart-startTime,opts.ast&&(res.ast=program),opts.ast||opts.forceEmit||0==res.diagnostics.length){const e=pxtc.compileBinary(program,opts,res,entryPoint);res.times.compilebinary=pxtc.U.cpuUs()-emitStart,res.diagnostics=res.diagnostics.concat(patchUpDiagnostics(e.diagnostics))}0==res.diagnostics.length&&(res.success=!0);for(let e of opts.sourceFiles)pxtc.Util.startsWith(e,"built/")&&(res.outfiles[e.slice(6)]=opts.fileSystem[e]);return res.times.all=pxtc.U.cpuUs()-startTime,pxt.tickEvent("compile",res.times),res}function decompile(e,t,n,i=!1){let r=e.getSourceFile(n);pxtc.annotate(e,n,pxtc.target||pxt.appTarget&&pxt.appTarget.compile);const s=pxtc.getApiInfo(e,t.jres),o=pxtc.getBlocksInfo(s,t.bannedCategories),a={snippetMode:t.snippetMode||!1,alwaysEmitOnStart:t.alwaysDecompileOnStart,includeGreyBlockMessages:i,generateSourceMap:void 0!==t.generateSourceMap?t.generateSourceMap:!!t.ast,allowedArgumentTypes:t.allowedArgumentTypes||["number","boolean","string"],errorOnGreyBlocks:!!t.errorOnGreyBlocks},[l,c]=pxtc.decompiler.buildRenameMap(e,r,{declarations:"variables",takenNames:{}});return pxtc.decompiler.decompileToBlocks(o,r,a,l)}function decompileSnippets(e,t,n=!1){const i=pxtc.getApiInfo(e,t.jres),r=pxtc.getBlocksInfo(i,t.bannedCategories),s=new pxtc.decompiler.RenameMap([]),o={snippetMode:t.snippetMode||!1,alwaysEmitOnStart:t.alwaysDecompileOnStart,includeGreyBlockMessages:n,generateSourceMap:void 0!==t.generateSourceMap?t.generateSourceMap:!!t.ast,allowedArgumentTypes:t.allowedArgumentTypes||["number","boolean","string"],errorOnGreyBlocks:!!t.errorOnGreyBlocks};let a;const l=[];if(t.sourceTexts)for(let e=0;e<t.sourceTexts.length;e++){t.fileSystem[pxt.MAIN_TS]=t.sourceTexts[e],t.fileSystem[pxt.MAIN_BLOCKS]="";let n=getTSProgram(t,a);const i=n.getSourceFile(pxt.MAIN_TS),c=pxtc.decompiler.decompileToBlocks(r,i,o,s);l.push(c.outfiles[pxt.MAIN_BLOCKS]),a=n}return l}function getTSProgram(e,t){let n={},i={};for(let t in e.fileSystem)i[normalizePath(t)]=e.fileSystem[t];let r=getTsCompilerOptions(e),s={getSourceFile:(e,t,n)=>{e=normalizePath(e);let s="";return i.hasOwnProperty(e)?s=i[e]:n&&n("File not found: "+e),null==s&&(n("File not found: "+e),s=""),ts.createSourceFile(e,s,t,true,void 0,r)},fileExists:e=>(e=normalizePath(e),i.hasOwnProperty(e)),getCanonicalFileName:e=>e,getDefaultLibFileName:()=>"no-default-lib.d.ts",writeFile:(e,t,i,r)=>{n[e]=t},getCurrentDirectory:()=>".",useCaseSensitiveFileNames:()=>!0,getNewLine:()=>"\n",readFile:e=>(e=normalizePath(e),i[e]||""),directoryExists:e=>!0,getDirectories:()=>[]};e.sourceFiles||(e.sourceFiles=Object.keys(e.fileSystem));let o=e.sourceFiles.filter(e=>pxtc.U.endsWith(e,".ts")),a=o.filter(e=>e!=pxt.MAIN_TS),l=!1;o.length>a.length&&(o=a,o.push(pxt.MAIN_TS),l=!0);const c=o.indexOf(pxt.TUTORIAL_CODE_STOP);c>=0&&(o.splice(c,1),o.push(pxt.TUTORIAL_CODE_STOP));const u=ts.createProgram(o,r,s,t);return pxtc.annotate(u,pxt.MAIN_TS,pxtc.target||pxt.appTarget&&pxt.appTarget.compile),u}function normalizePath(e){e=e.replace(/\\/g,"/");const t=[];return e.split("/").forEach(e=>{".."===e&&t.length?t.pop():"."!==e&&t.push(e)}),t.join("/")}pxtc.getTsCompilerOptions=getTsCompilerOptions,pxtc.nodeLocationInfo=nodeLocationInfo,pxtc.patchUpDiagnostics=patchUpDiagnostics,pxtc.py2tsIfNecessary=py2tsIfNecessary,pxtc.storeGeneratedFiles=storeGeneratedFiles,pxtc.runConversionsAndStoreResults=runConversionsAndStoreResults,pxtc.timesToMs=timesToMs,pxtc.isPxtModulesFilename=isPxtModulesFilename,pxtc.compile=compile,pxtc.decompile=decompile,pxtc.decompileSnippets=decompileSnippets,pxtc.getTSProgram=getTSProgram})(pxtc=ts.pxtc||(ts.pxtc={}))}(ts||(ts={})),function(e){!function(t){const n=["type","offset","vaddr","paddr","filesz","memsz","flags","align"],i=e.HF2.read32,r=e.HF2.read16,s=4096;t.parse=function(t){1179403647!=i(t,0)&&e.U.userError("no magic"),1!=t[4]&&e.U.userError("not 32 bit"),1!=t[5]&&e.U.userError("not little endian"),1!=t[6]&&e.U.userError("bad version"),2!=r(t,16)&&e.U.userError("wrong object type"),40!=r(t,18)&&e.U.userError("not ARM");let o=i(t,28);i(t,32),0==o&&e.U.userError("expecting program headers");let a=r(t,42),l=r(t,44),c=e.U.range(l).map(e=>function(e){let r={},s=e;for(let s of n)r[s]=i(t,e),e+=4;let o=r;return o._filepos=s,o}(o+e*a)),u=t.length+1;for(;15&u;)u++;let d=0;for(let e of c)1==e.type&&(d=Math.max(d,e.vaddr+e.memsz));let p=(d+s-1&-4096)+(4095&u),h=-1;for(let e of c)4==e.type&&(h=e._filepos);return{imageMemStart:p,imageFileStart:u,phOffset:h,template:t}},t.patch=function(t,i){let r=new Uint8Array(t.imageFileStart+i.length);return r.fill(0),e.U.memcpy(r,0,t.template),e.U.memcpy(r,t.imageFileStart,i),function(t,i){let r=i._filepos;for(let s of n)e.HF2.write32(t,r,i[s]||0),r+=4}(r,{_filepos:t.phOffset,type:1,offset:t.imageFileStart,vaddr:t.imageMemStart,paddr:t.imageMemStart,filesz:i.length,memsz:i.length,flags:5,align:s}),r}}(e.elf||(e.elf={}))}(pxt||(pxt={})),function(e){!function(t){const n=e.HF2.read32,i=e.HF2.read16,r=[{name:"esp32",chipId:0,memmap:[{from:0,to:65536,id:"PADDING"},{from:1061158912,to:1065353216,id:"DROM"},{from:1065353216,to:1069547520,id:"EXTRAM_DATA"},{from:1073217536,to:1073225728,id:"RTC_DRAM"},{from:1073283072,to:1073741824,id:"BYTE_ACCESSIBLE"},{from:1073405952,to:1073741824,id:"DRAM"},{from:1073610752,to:1073741820,id:"DIRAM_DRAM"},{from:1073741824,to:1074200576,id:"IROM"},{from:1074200576,to:1074233344,id:"CACHE_PRO"},{from:1074233344,to:1074266112,id:"CACHE_APP"},{from:1074266112,to:1074397184,id:"IRAM"},{from:1074397184,to:1074528252,id:"DIRAM_IRAM"},{from:1074528256,to:1074536448,id:"RTC_IRAM"},{from:1074593792,to:1077936128,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-s2",chipId:2,memmap:[{from:0,to:65536,id:"PADDING"},{from:1056964608,to:1073217536,id:"DROM"},{from:1062207488,to:1073217536,id:"EXTRAM_DATA"},{from:1073340416,to:1073348608,id:"RTC_DRAM"},{from:1073340416,to:1073741824,id:"BYTE_ACCESSIBLE"},{from:1073340416,to:1074208768,id:"MEM_INTERNAL"},{from:1073414144,to:1073741824,id:"DRAM"},{from:1073741824,to:1073848576,id:"IROM_MASK"},{from:1073872896,to:1074200576,id:"IRAM"},{from:1074200576,to:1074208768,id:"RTC_IRAM"},{from:1074266112,to:1082130432,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-s3",chipId:4,memmap:[{from:0,to:65536,id:"PADDING"},{from:1006632960,to:1023410176,id:"DROM"},{from:1023410176,to:1040187392,id:"EXTRAM_DATA"},{from:1611653120,to:1611661312,id:"RTC_DRAM"},{from:1070104576,to:1070596096,id:"BYTE_ACCESSIBLE"},{from:1070104576,to:1077813248,id:"MEM_INTERNAL"},{from:1070104576,to:1070596096,id:"DRAM"},{from:1073741824,to:1073848576,id:"IROM_MASK"},{from:1077346304,to:1077805056,id:"IRAM"},{from:1611653120,to:1611661312,id:"RTC_IRAM"},{from:1107296256,to:1115684864,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-c3",chipId:5,memmap:[{from:0,to:65536,id:"PADDING"},{from:1006632960,to:1015021568,id:"DROM"},{from:1070071808,to:1070465024,id:"DRAM"},{from:1070104576,to:1070596096,id:"BYTE_ACCESSIBLE"},{from:1072693248,to:1072824320,id:"DROM_MASK"},{from:1073741824,to:1074135040,id:"IROM_MASK"},{from:1107296256,to:1115684864,id:"IROM"},{from:1077395456,to:1077805056,id:"IRAM"},{from:1342177280,to:1342185472,id:"RTC_IRAM"},{from:1342177280,to:1342185472,id:"RTC_DRAM"},{from:1611653120,to:1611661312,id:"MEM_INTERNAL2"}]}];function s(t){return`0x${t.addr.toString(16)} 0x${t.data.length.toString(16)} bytes; ${t.isDROM?"drom ":""}${t.isMapped?"mapped ":""}${e.U.toHex(t.data.slice(0,20))}...`}function o(t){if(233!=t[0])throw new Error("ESP: invalid magic: "+t[0]);let s=24;const o=i(t,12),a=r.find(e=>e.chipId==o);if(!a)throw new Error("ESP: unknown chipid: "+o);const l={header:t.slice(0,s),chipName:a.name,segments:[]},c=t[1];for(let i=0;i<c;++i){const i=n(t,s),r=n(t,s+4);s+=8;const o=t.slice(s,s+r);if(o.length!=r)throw new Error("too short file");if(s+=r,u(i,"PADDING"))continue;const a=l.segments.filter(e=>e.addr+e.data.length==i)[0];a?a.data=e.U.uint8ArrayConcat([a.data,o]):l.segments.push({addr:i,isMapped:u(i,"DROM")||u(i,"IROM"),isDROM:u(i,"DROM"),data:o})}return l;function u(e,t){return a.memmap.some(n=>n.id==t&&n.from<=e&&e<=n.to)}}function a(t){const n=e.U.flatClone(t);return n.segments=n.segments.map(e.U.flatClone),n}t.toBuffer=function(t,n=!0){let i=(t=function(t){const n=65535;(t=a(t)).segments.sort((e,t)=>e.addr-t.addr),e.debug("esp padding:\n"+t.segments.map(s).join("\n")+"\n");const i=t.segments.filter(e=>e.isMapped),r=t.segments.filter(e=>!e.isMapped);t.segments=[];let o=t.header.length;for(const t of i){const i=t.addr+t.data.length&n;if(i<36){const n=new Uint8Array(36-i);t.data=e.U.uint8ArrayConcat([t.data,n])}}for(;i.length>0;){let e=i[0];const r=l(e);if(r>0)e=c(r);else{if((o+8&n)!=(e.addr&n))throw new Error(`pad oops 0 ${o}+8 != ${e.addr} (mod mask)`);i.shift()}if(t.segments.push(e),o+=8+e.data.length,3&o)throw new Error("pad oops 1")}return t.segments=t.segments.concat(r),e.debug("esp padded:\n"+t.segments.map(s).join("\n")+"\n"),t;function l(e){let t=(e.addr-8&n)-o&n;return 0==t?0:(t-=8,t<0&&(t+=65536),t)}function c(e){if(!r.length||e<=8)return{addr:0,isMapped:!1,isDROM:!1,data:new Uint8Array(e)};const t=r[0],n={addr:t.addr,isMapped:t.isMapped,isDROM:t.isDROM,data:t.data.slice(0,e)};return t.data=t.data.slice(e),t.addr+=n.data.length,0==t.data.length&&r.shift(),n}}(t)).header.length;for(const e of t.segments)i+=8+e.data.length;i=i+16&-16;let r=new Uint8Array(i);r.set(t.header),r[1]=t.segments.length;let o=t.header.length,l=239;for(const n of t.segments){e.HF2.write32(r,o,n.addr),e.HF2.write32(r,o+4,n.data.length),r.set(n.data,o+8),o+=8+n.data.length;for(let e=0;e<n.data.length;++e)l^=n.data[e]}if(r[r.length-1]=l,n){r[23]=1;const t=ts.pxtc.BrowserImpl.sha256buffer(r);r=e.U.uint8ArrayConcat([r,e.U.fromHex(t)])}else r[23]=0;return r},t.parseBuffer=o,t.parseB64=function(t){return o(e.U.stringToUint8Array(atob(t.join(""))))},t.cloneStruct=a}(e.esp||(e.esp={}))}(pxt||(pxt={})),function(e){!function(t){let n;!function(e){e[e.None=0]="None",e[e.Whitespace=1]="Whitespace",e[e.Identifier=2]="Identifier",e[e.Keyword=3]="Keyword",e[e.Operator=4]="Operator",e[e.CommentLine=5]="CommentLine",e[e.CommentBlock=6]="CommentBlock",e[e.NewLine=7]="NewLine",e[e.Literal=8]="Literal",e[e.Tree=9]="Tree",e[e.Block=10]="Block",e[e.EOF=11]="EOF"}(n||(n={}));let i="";let r=e.SyntaxKind;function s(e){switch(e){case r.CommaToken:return 2;case r.EqualsToken:case r.PlusEqualsToken:case r.MinusEqualsToken:case r.AsteriskEqualsToken:case r.AsteriskAsteriskEqualsToken:case r.SlashEqualsToken:case r.PercentEqualsToken:case r.LessThanLessThanEqualsToken:case r.GreaterThanGreaterThanEqualsToken:case r.GreaterThanGreaterThanGreaterThanEqualsToken:case r.AmpersandEqualsToken:case r.BarEqualsToken:case r.CaretEqualsToken:return 5;case r.QuestionToken:case r.ColonToken:return 7;case r.BarBarToken:return 10;case r.AmpersandAmpersandToken:return 20;case r.BarToken:return 30;case r.CaretToken:return 40;case r.AmpersandToken:return 50;case r.EqualsEqualsToken:case r.ExclamationEqualsToken:case r.EqualsEqualsEqualsToken:case r.ExclamationEqualsEqualsToken:return 60;case r.LessThanToken:case r.GreaterThanToken:case r.LessThanEqualsToken:case r.GreaterThanEqualsToken:case r.InstanceOfKeyword:case r.InKeyword:case r.AsKeyword:return 70;case r.LessThanLessThanToken:case r.GreaterThanGreaterThanToken:case r.GreaterThanGreaterThanGreaterThanToken:return 80;case r.PlusToken:case r.MinusToken:return 90;case r.AsteriskToken:case r.SlashToken:case r.PercentToken:return 100;case r.AsteriskAsteriskToken:return 101;case r.DotToken:return 120;default:return 0}}function o(e){switch(e){case r.EndOfFileToken:return n.EOF;case r.SingleLineCommentTrivia:return n.CommentLine;case r.MultiLineCommentTrivia:return n.CommentBlock;case r.NewLineTrivia:return n.NewLine;case r.WhitespaceTrivia:return n.Whitespace;case r.ShebangTrivia:case r.ConflictMarkerTrivia:return n.CommentBlock;case r.NumericLiteral:case r.StringLiteral:case r.RegularExpressionLiteral:case r.NoSubstitutionTemplateLiteral:case r.TemplateHead:case r.TemplateMiddle:case r.TemplateTail:return n.Literal;case r.Identifier:return n.Identifier;default:return e<r.Identifier?n.Operator:n.Keyword}}function a(e,t){for(;e[t]&&e[t].kind==n.Whitespace;)t++;return t}function l(){return{kind:n.EOF,synKind:r.EndOfFileToken,pos:0,lineNo:0,text:""}}function c(e,t){return{kind:n.Whitespace,synKind:r.WhitespaceTrivia,pos:e.pos-t.length,lineNo:e.lineNo,text:t}}function u(e){return{kind:n.NewLine,synKind:r.NewLineTrivia,pos:e.pos,lineNo:e.lineNo,text:"\n"}}function d(e){return{kind:n.Block,synKind:r.OpenBraceToken,pos:e[0].pos,lineNo:e[0].lineNo,stmts:[{tokens:e}],text:"{",endToken:null}}function p(e){return{kind:n.Tree,synKind:r.WhitespaceTrivia,pos:e[0].pos,lineNo:e[0].lineNo,children:e,endToken:null,text:""}}function h(e){if(!e)return!1;switch(e.synKind){case r.IfKeyword:case r.ElseKeyword:case r.LetKeyword:case r.ConstKeyword:case r.VarKeyword:case r.DoKeyword:case r.WhileKeyword:case r.SwitchKeyword:case r.CaseKeyword:case r.DefaultKeyword:case r.ForKeyword:case r.ReturnKeyword:case r.BreakKeyword:case r.ContinueKeyword:case r.TryKeyword:case r.CatchKeyword:case r.FinallyKeyword:case r.DeleteKeyword:case r.FunctionKeyword:case r.ClassKeyword:case r.YieldKeyword:case r.DebuggerKeyword:return!0;default:return!1}}function f(e,i,o=null){let a,u=[],m=0,g=!1;for(e=e.concat([l()]);e[m].kind!=n.EOF;){let n=m;C(),t.Util.assert(m>n,`Error at ${e[m].text}`),y(e.slice(n,m))}return u;function y(e){if(i&&(e=_(e)),0==e.length)return;e.forEach(v),e=b(e);if(i&&u.length>0){let n=u[u.length-1].tokens[0].synKind,i=e[0].synKind;if(n==r.IfKeyword&&i==r.ElseKeyword||n==r.TryKeyword&&i==r.CatchKeyword||n==r.TryKeyword&&i==r.FinallyKeyword||n==r.CatchKeyword&&i==r.FinallyKeyword)return e.unshift(c(e[0]," ")),void t.Util.pushRange(u[u.length-1].tokens,e)}u.push({tokens:e})}function b(e){let t=[],n=0;for(;n<e.length;)if(e[n].blockSpanLength){let i=e.slice(n,n+e[n].blockSpanLength),r=!!i[0].blockSpanIsVirtual;delete i[0].blockSpanLength,delete i[0].blockSpanIsVirtual,n+=i.length,i=b(i),r?t.push(p(i)):(t.push(c(i[0]," ")),t.push(d(_(i))))}else t.push(e[n++]);return t}function v(e){if(e.kind==n.Tree){let n=e;n.children=t.Util.concat(f(n.children,!1,n).map(e=>e.tokens))}}function T(t=!1){for(;;)switch(m++,e[m].kind){case n.Whitespace:case n.CommentBlock:case n.CommentLine:break;case n.NewLine:if(t)break;break;default:return}}function k(){for(;e[m].kind==n.Whitespace;)m++;e[m].kind==n.NewLine&&m++}function x(){for(;;)switch(m++,e[m].kind){case n.EOF:return;case n.Tree:if(e[m].synKind==r.OpenBraceToken)return m--,void S()}}function E(){t.Util.assert(e[m].synKind==r.OpenBraceToken);let i=e[m];t.Util.assert(i.kind==n.Tree);let s=e[m];s.stmts=f(i.children,!0,a),delete i.children,s.kind=n.Block,m++,g=!0}function S(){let t=m+1;T(),e[m].synKind==r.OpenBraceToken?(E(),k()):(C(),e[t].blockSpanLength=m-t)}function C(){for(;;){let l=e[m],c=m;if(a=l,g=!1,l.kind==n.EOF)return;if(i&&l.synKind==r.SemicolonToken)return m++,void k();if(l.synKind==r.EqualsGreaterThanToken){if(T(),e[m].synKind==r.OpenBraceToken){E();continue}{let t=m;C();let i=m;for(;e[i].kind==n.NewLine;)i--;return e[t].blockSpanLength=i-t,void(e[t].blockSpanIsVirtual=!0)}}if(i&&s(l.synKind)){let t=m;if(T(),!h(e[m]))continue;m=t}if(i&&l.kind==n.NewLine){if(T(),l=e[m],s(l.synKind)&&l.synKind!=r.PlusToken&&l.synKind!=r.MinusToken)continue;return void(m=c+1)}if(l.synKind==r.OpenBraceToken&&o&&o.synKind==r.ClassKeyword){let t=m-1;for(;t>=0&&e[t].kind==n.Whitespace;)t--;if(t<0||e[t].synKind!=r.EqualsToken)return m--,void S()}switch(t.Util.assert(c==m),l.synKind){case r.ForKeyword:case r.WhileKeyword:case r.IfKeyword:case r.CatchKeyword:if(T(),e[m].synKind!=r.OpenParenToken)continue;return void S();case r.DoKeyword:if(S(),m--,T(),e[m].synKind==r.WhileKeyword){m++;continue}return;case r.ElseKeyword:if(T(),e[m].synKind==r.IfKeyword)continue;return m=c,void S();case r.TryKeyword:case r.FinallyKeyword:return void S();case r.ClassKeyword:case r.NamespaceKeyword:case r.ModuleKeyword:case r.InterfaceKeyword:case r.FunctionKeyword:return void x()}t.Util.assert(!g,"forgot continue/return after expectBlock"),m++}}}function m(e){return e&&(e.kind==n.Whitespace||e.kind==n.NewLine)}function g(e){let t=[],i=!1;for(let r=0;r<e.length;++r)i&&(r=a(e,r)),e[r]&&(t.push(e[r]),i=e[r].kind==n.NewLine);return t}function _(e){for(e=e.slice(0);m(e[0]);)e.shift();for(;m(e[e.length-1]);)e.pop();return e}function y(e,t){if(t.synKind==r.NoSubstitutionTemplateLiteral&&/^`[\s\.#01]*`$/.test(t.text)){let n=t.text.slice(1,t.text.length-1).split("\n").map(e=>e.replace(/\s/g,"")).filter(e=>!!e);if(n.length<4||n.length>5)return;let i=Math.floor((Math.max(...n.map(e=>e.length))+2)/5);i<=0&&(i=1);let r="`\n";for(let t=0;t<5;++t){let s=n[t]||"";for(;s.length<5*i;)s+=".";s=s.replace(/0/g,"."),s=s.replace(/1/g,"#"),s=s.replace(/...../g,e=>"/"+e),r+=e+s.replace(/./g,e=>" "+e).replace(/\//g," ").slice(3)+"\n"}r+=e+"`",t.text=r}}t.toStr=function e(t){return Array.isArray(t)?"[[ "+t.map(e).join("  ")+" ]]":"string"==typeof t.text?JSON.stringify(t.text):t+""},t.format=function(t,d){let p=function(t){i=t;let s=e.createScanner(e.ScriptTarget.Latest,!1,e.LanguageVariant.Standard,t,e=>{let t=s.getTextPos();pxt.log("scanner error",t,e.message)}),a=[],l=0,c=-1;for(;;){let e=s.scan();if(e==r.CloseBraceToken&&l==c&&(c=-1,e=s.reScanTemplateToken()),e==r.SlashEqualsToken){let t=s.reScanSlashToken();t==r.RegularExpressionLiteral&&(e=t)}e==r.GreaterThanToken&&(e=s.reScanGreaterToken());let t={kind:o(e),synKind:e,lineNo:0,pos:s.getTokenPos(),text:s.getTokenText()};if(e==r.OpenBraceToken&&l++,e==r.CloseBraceToken&&--l<0&&(l=-1e7),a.push(t),e!=r.TemplateHead&&e!=r.TemplateMiddle||(c=l),t.kind==n.EOF)break}return{tokens:a,braceBalance:l}}(t).tokens;p=function(e,t){let i=[],s=!0,o=1;for(let l=0;l<e.length;++l){if(s){let s=l;if(l=a(e,l),e[l].kind==n.NewLine){let s=!1;t>=0&&e[l].pos>=t&&(t=-1,s=!0),i.push({text:"",kind:n.CommentLine,pos:e[l].pos,lineNo:o,synKind:r.SingleLineCommentTrivia,isCursor:s})}else l=s}i.push(e[l]),e[l].lineNo=o,e[l].kind==n.NewLine?(s=!0,o++):s=!1,t>=0&&e[l].pos>=t&&(t=-1)}return i}(p,d),p=function(e){let t=[];t.push({synKind:r.EndOfFileToken,token:{children:[]}});let i=(e,i)=>{let r=e;r.children=[],r.kind=n.Tree,t.push({synKind:i,token:r})};for(let s=0;s<e.length;++s){let o=e[s],a=t[t.length-1];if(a.token.children.push(o),o.kind===n.Operator)switch(o.synKind){case r.OpenBraceToken:case r.OpenParenToken:case r.OpenBracketToken:i(o,o.synKind+1);break;case r.CloseBraceToken:case r.CloseParenToken:case r.CloseBracketToken:for(a.token.children.pop();;){if(a=t.pop(),a.synKind==o.synKind){a.token.endToken=o;break}if(0==t.length||a.synKind==r.CloseBraceToken){t.push(a);break}}}}return t[0].token.children}(p);let h=f(p,!0),m="",_="",b=-1,v=0;return h.forEach(x),h.forEach(e=>e.tokens.forEach(T)),-1==b&&(b=_.length),{formatted:_,pos:b};function T(e){if(e.kind==n.Tree){let t=e;e.synKind,r.OpenBraceToken,t.children.forEach(T)}else e.kind==n.Block&&e.stmts.forEach(e=>e.tokens.forEach(T))}function k(e,t){if(v==e.lineNo)t();else{v=e.lineNo;let n=m;m+="    ",t(),m=n}}function x(e){let t=g(e.tokens);1!=t.length||t[0].isCursor||""!=t[0].text?(_+=m,k(t[0],()=>{S(t)}),"\n"!=_[_.length-1]&&(_+="\n")):_+="\n"}function E(e){-1==b&&e.pos+e.text.length>=d&&(b=_.length+(d-e.pos)),_+=e.text}function S(e){e=function(e){let t=[],i=0,o=l();for(e=e.concat([l()]);i<e.length;){i=a(e,i);let l=e[i];if(l.kind==n.EOF)break;let d=a(e,i+1);if(l.kind==n.NewLine&&e[d].synKind==r.OpenBraceToken){i=d;continue}let p=!0,h=0==t.length?u(l):t[t.length-1];switch(h.synKind){case r.ExclamationToken:case r.TildeToken:case r.DotToken:p=!1;break;case r.PlusToken:case r.MinusToken:case r.PlusPlusToken:case r.MinusMinusToken:h.isPrefix&&(p=!1)}switch(l.synKind){case r.DotToken:case r.CommaToken:case r.NewLineTrivia:case r.ColonToken:case r.SemicolonToken:case r.OpenBracketToken:p=!1;break;case r.PlusPlusToken:case r.MinusMinusToken:h.kind!=n.Tree&&h.kind!=n.Identifier&&h.kind!=n.Keyword||(p=!1);case r.PlusToken:case r.MinusToken:(o.kind==n.EOF||s(o.synKind)||o.synKind==r.SemicolonToken)&&(l.isPrefix=!0);break;case r.OpenParenToken:if(h.kind==n.Identifier&&(p=!1),h.kind==n.Keyword)switch(h.synKind){case r.IfKeyword:case r.ForKeyword:case r.WhileKeyword:case r.SwitchKeyword:case r.ReturnKeyword:case r.ThrowKeyword:case r.CatchKeyword:break;default:p=!1}}h.kind==n.NewLine&&(p=!1),p&&t.push(c(l," ")),t.push(l),l.kind!=n.NewLine&&(o=l),i++}return t}(e);for(let t=0;t<e.length;++t){let i=e[t];switch(y(m,i),E(i),i.kind){case n.Tree:let r=i;k(i,()=>{S(g(r.children))}),r.endToken&&E(r.endToken);break;case n.Block:let s=i;0==s.stmts.length?_+=" ":(_+="\n",s.stmts.forEach(x),_+=m.slice(4)),s.endToken?E(s.endToken):_+="}";break;case n.NewLine:if(e[t+1]&&e[t+1].kind==n.CommentLine&&""==e[t+1].text&&!e[t+1].isCursor)break;t==e.length-1?_+=m.slice(4):_+=m;case n.Whitespace:}}}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n;function i(e,n){if(!n.packedSource)return;let i=e.currPtr+4096&-256,r=new Uint8Array(256);for(let s=0;s<n.packedSource.length;s+=256){for(let e=0;e<256;++e)r[e]=n.packedSource.charCodeAt(s+e);t.UF2.writeBytes(e,i,r,t.UF2.UF2_FLAG_NOFLASH),i+=256}}!function(e){e.asmTotalSource="";let n={},r=[];let s={commBase:0,funcInfo:{},codeStartIdx:-1,codePaddingSize:0,sha:null,codeStartAddrPadded:void 0,hexlines:void 0,jmpStartAddr:void 0,jmpStartIdx:void 0,codeStartAddr:void 0,elfInfo:void 0,espInfo:void 0,topFlashAddr:0};function o(e){let n="",i=0;for(;i<e.length;i+=2)n=e[i]+e[i+1]+n;return t.assert(i==e.length),n}function a(e){if(!(e=e.replace(/^[\s:]/,"")))return[];let n=[];if(e.replace(/([a-f0-9][a-f0-9])/gi,e=>(n.push(parseInt(e,16)),"")))throw t.oops("bad bytes "+e);return n}function l(e){return e.flashCodeAlign||1024}e.getCommBase=function(){return s.commBase},e.getStartAddress=function(){return s.codeStartAddrPadded},e.getTopFlashAddress=function(){return s.topFlashAddr},e.setupInlineAssembly=function(i){n={};let r=i.sourceFiles.filter(e=>t.U.endsWith(e,".asm"));e.asmTotalSource="";let s=0;for(let t of r){let r=i.fileSystem[t];r.replace(/^\s*(\w+):/gm,(e,t)=>(n[t]=!0,""));let o=".object inlineasm\n.section code\n@stackmark func\n@scope user"+s+++"\n"+r+"\n@stackempty func\n@scope\n";e.asmTotalSource+=o}},e.parseHexBytes=a,e.parseHexRecord=function(e){let t=a(e);return{len:t[0],addr:t[1]<<8|t[2],type:t[3],data:t.slice(4,t.length-1),checksum:t[t.length-1]}},e.flashCodeAlign=l;const c="0108010842424242010801083ed8e98d";function u(e){return s.funcInfo[e]}function p(){let e=s.sha?s.sha.slice(0,16):"";for(;e.length<16;)e+="0";return e.toUpperCase()}function h(e){let t=0,n=":";return e.forEach(e=>t+=e),e.push(255&-t),e.forEach(e=>n+=("0"+e.toString(16)).slice(-2)),n.toUpperCase()}e.setupFor=function(e,n,i){if(s=r.find(e=>e.sha==n.sha),s)return;s={commBase:0,funcInfo:{},codeStartIdx:-1,codePaddingSize:0,sha:null,codeStartAddrPadded:void 0,hexlines:void 0,jmpStartAddr:void 0,jmpStartIdx:void 0,codeStartAddr:void 0,elfInfo:void 0,espInfo:void 0,topFlashAddr:0},r.length>10&&(r=[]),r.push(s);let u=n.functions;s.commBase=n.commBase||0,s.sha=n.sha;const p=n.hexinfo.hex;if(s.hexlines=p,t.target.nativeType==t.NATIVE_TYPE_VM){s.codeStartAddr=0,s.codeStartAddrPadded=0,s.jmpStartAddr=-1,s.jmpStartIdx=-1;for(let e of u)s.funcInfo[e.name]=e,e.value=16777215;if(t.target.useESP){const e=pxt.esp.parseB64(p),i=t.U.fromHex(c),r=(e,t)=>{for(let n=0;n<i.length;++n)if(e[t+n]!=i[n])return!1;return!0},o=e.segments.filter(e=>e.isDROM);t.U.assert(1==o.length);let a=!1;const l=o[0];s.codeStartAddr=l.addr+l.data.length,s.codeStartAddrPadded=s.codeStartAddr+255&-256,s.codePaddingSize=s.codeStartAddrPadded-s.codeStartAddr,pxt.debug(`user code start: 0x${s.codeStartAddrPadded.toString(16)}; dromlen=${l.data.length} pad=${s.codePaddingSize}`);for(let e=0;e<l.data.length;e+=32)if(r(l.data,e)){a=!0,e+=i.length,s.topFlashAddr=pxt.HF2.read32(l.data,e),e+=4;const t=e;for(let t of n.vmPointers||[])"0"!=t&&(t=t.replace(/^&/,""),s.funcInfo[t]={name:t,argsFmt:[],value:pxt.HF2.read32(l.data,e)},e+=4);pxt.HF2.write32(l.data,t,s.codeStartAddrPadded);break}t.U.assert(a||0==(n.vmPointers||[]).length),s.espInfo=e,s.codeStartAddrPadded=0}return}if(p.length<=2){const e=t.U.fromHex(p[0]);if(e[2]<=2&&96==e[3]){const t=1610612736,n=4096,i=e.length+n-1&~(n-1);s.elfInfo={template:e,imageMemStart:t+i,imageFileStart:i,phOffset:-1e3}}else s.elfInfo=pxt.elf.parse(e);s.codeStartAddr=s.elfInfo.imageMemStart,s.codeStartAddrPadded=s.elfInfo.imageMemStart;let n=p[0].indexOf(c);n<0&&t.oops("no jmp table in elf"),s.jmpStartAddr=n/2,s.jmpStartIdx=-1;const i=p[0].slice(n+32,n+40);return s.topFlashAddr=parseInt(o(i),16),b(p[0].slice(n+40,n+40+8*u.length+16)),void v()}!function(e){for(let n=0;n<e.length;++n)if("2"==e[n][8]){let i=/^:02....02(....)..$/.exec(e[n]);t.U.assert(!!i);let r=16*parseInt(i[1],16);t.U.assert(!(65535&r)),e[n]=h([2,0,0,4,0,r>>16])}}(p);let f=0,m="0000",g=0,_=0;s.codeStartAddr=0;let y=()=>{if(!s.codeStartAddr){let n=a(p[_]),i=16-(g+n[0]&15)&15;if(i)if(15&n[2]){let e=g+n[0],t=[i,e>>8,255&e,0];for(let e=0;e<i;++e)t.push(0);_++,p.splice(_,0,h(t)),s.codeStartAddr=e+i}else{if(16!=n[0]){for(n.pop(),n[0]=16;n.length<20;)n.push(0);p[_]=h(n)}s.codeStartAddr=g+16}else s.codeStartAddr=g+n[0];s.codeStartIdx=_+1;const r=l(e);s.codeStartAddrPadded=(s.codeStartAddr&~(r-1))+r;const o=s.codeStartAddrPadded-s.codeStartAddr;t.assert(!(15&o)),s.codePaddingSize=o}};for(;f<p.length;++f){let t=/:02000004(....)/.exec(p[f]);if(t&&(m=t[1]),t=/^:..(....)00/.exec(p[f]),t){if(s.jmpStartIdx>=0&&s.jmpStartIdx+1==f){let t=/^:..(....)00(.{4,})/.exec(p[f]);if(t){let n=e.shortPointers?4:8,i=o(t[2].slice(0,n));s.topFlashAddr=parseInt(i,16)}}let n=parseInt(m+t[1],16);if(!e.flashUsableEnd&&g&&n-g>65536&&y(),e.flashUsableEnd){n>=d(e,i)&&y()}_=f,g=n}/^:00000001/.test(p[f])&&y(),t=/^:10....000108010842424242010801083ED8E98D/.exec(p[f]),t&&(s.jmpStartAddr=g,s.jmpStartIdx=f)}pxt.debug(`code start: ${s.codeStartAddrPadded}, jmptbl: ${s.jmpStartAddr}`),s.jmpStartAddr||t.oops("No hex start"),s.codeStartAddr||t.oops("No hex end"),s.funcInfo={};for(let t=s.jmpStartIdx+1;t<p.length;++t){let n=/^:..(....)00(.{4,})/.exec(p[t]);if(n){if(t===s.jmpStartIdx+1){let t=e.shortPointers?4:8;b(n[2].slice(t))}else b(n[2]);if(0==u.length)break}}return void v();function b(n){let i=e.shortPointers?4:8;for(;n.length>=i;){let r=n.slice(0,i),a=parseInt(o(r),16);n=n.slice(i);let l=u.shift();if(!l)break;s.funcInfo[l.name]=l,a||t.U.oops("No value for "+l.name+" / "+r),0==l.argsFmt.length?a^=1:e.runtimeIsARM||e.nativeType!=t.NATIVE_TYPE_THUMB||1&a||t.U.oops("Non-thumb addr for "+l.name+" / "+r),l.value=a}}function v(){u.length&&t.oops("premature EOF in hex file; missing: "+u.map(e=>e.name).join(", "))}},e.validateShim=function(e,i,r,s,o){if("TD_ID"==i||"TD_NOOP"==i||"ENUM_GET"==i)return;if(t.U.lookup(n,i))return;let a=`${e}(...) (shim=${i})`,l=u(i);if(l){s?"V"==l.argsFmt[0]&&t.U.userError("expecting function for "+a):"V"!=l.argsFmt[0]&&t.U.userError("expecting procedure for "+a);for(let e=0;e<o.length;++e){l.argsFmt[e+1]||t.U.userError("excessive parameters passed to "+a)}o.length!=l.argsFmt.length-1&&t.U.userError(`not enough arguments for ${a} (got ${o.length}; fmt=${l.argsFmt.join(",")})`)}else t.U.userError("function not found: "+a)},e.lookupFunc=u,e.lookupFunctionAddr=function(e){if("_pxt_comm_base"==e)return s.commBase;let t=u(e);return t?t.value:null},e.hexTemplateHash=p,e.hexPrelude=function(){return`    .startaddr 0x${s.codeStartAddrPadded.toString(16)}\n`},e.hexBytes=h,e.patchHex=function(e,n,r,a){let l=s.hexlines.slice(0,s.codeStartIdx);if(!e.target.useESP){let i=2*n.length+7>>3;t.assert(i<64e3,"program too large, bytes: "+2*n.length),n[17]=i,n[20]=e.commSize}let c=[];for(let e=0;e<s.codePaddingSize>>1;++e)c.push(0);n=c.concat(n);let u=0;function d(e,t){let n=[16,t>>8&255,255&t,0];for(let t=0;t<8;++t)n.push(255&(e[u]||0)),n.push((e[u]||0)>>>8),u++;return n}let f=[16912,0,65535&s.codeStartAddrPadded,s.codeStartAddrPadded>>>16],m=p();for(let e=0;e<4;++e)f.push(parseInt(o(m.slice(4*e,4*e+4)),16));let g=a?t.UF2.newBlockFile(t.target.uf2Family):null;if(s.elfInfo){let i=new Uint8Array(2*n.length);for(let e=0;e<n.length;++e)pxt.HF2.write16(i,2*e,n[e]);let r=pxt.elf.patch(s.elfInfo,i);for(let e=0;e<f.length;++e)pxt.HF2.write16(r,2*e+s.jmpStartAddr,f[e]);if(g&&!e.target.switches.rawELF){let n=e.name||"pxt";return n=n.replace(/[^a-zA-Z0-9\-\.]+/g,"_"),g.filename="Projects/"+n+".elf",t.UF2.writeBytes(g,0,r),[t.UF2.serializeFile(g)]}return[t.U.uint8ArrayToString(r)]}if(s.espInfo){const r=pxt.esp.cloneStruct(s.espInfo),o=r.segments.find(e=>e.isDROM);let a=o.data.length;const l=new Uint8Array(a+2*n.length+255&-256);l.set(o.data);for(let e=0;e<n.length;++e)pxt.HF2.write16(l,a,n[e]),a+=2;o.data=l;const c=pxt.esp.toBuffer(r);return g?(t.UF2.writeBytes(g,0,c),i(g,e),[t.UF2.serializeFile(g)]):[t.U.uint8ArrayToString(c)]}if(g){if(t.UF2.writeHex(g,l),t.UF2.writeBytes(g,s.jmpStartAddr,d(f,s.jmpStartIdx).slice(4)),e.checksumBlock){let n=[];for(let t of e.checksumBlock)n.push(255&t,t>>8);t.UF2.writeBytes(g,e.target.flashChecksumAddr,n)}}else l[s.jmpStartIdx]=h(d(f,s.jmpStartAddr)),e.checksumBlock&&t.U.oops("checksum block in HEX not implemented yet");u=0,r&&(l=[]);let _=s.codeStartAddr,y=_-16>>16;for(;u<n.length;)g?t.UF2.writeBytes(g,_,d(n,_).slice(4)):(_>>16!=y&&(y=_>>16,l.push(h([2,0,0,4,y>>8,255&y]))),l.push(h(d(n,_)))),_+=16;if(!r){let e=s.hexlines.slice(s.codeStartIdx);g?t.UF2.writeHex(g,e):t.Util.pushRange(l,e)}if(!g&&e.target.moveHexEof){for(;!l[l.length-1];)l.pop();":00000001FF"==l[l.length-1]&&l.pop()}if(e.packedSource)if(g)i(g,e);else{let t=0;for(let n=0;n<e.packedSource.length;n+=16){let i=[16,t>>8&255,255&t,14];for(let t=0;t<16;++t)i.push(255&(e.packedSource.charCodeAt(n+t)||0));l.push(h(i)),t+=16}}return!g&&e.target.moveHexEof&&l.push(":00000001FF"),g?[t.UF2.serializeFile(g)]:l}}(n=t.hexfile||(t.hexfile={})),t.hexDump=function(e,t=0){function n(e,t=8){let n=e.toString(16);for(;n.length<t;)n="0"+n;return n}let i="";for(let r=0;r<e.length;r+=16){i+=n(t+r)+": ";let s="";for(let t=0;t<16;t++){3&t||(i+=" ");let o=e[r+t];null!=o?(i+=n(o,2)+" ",s+=32<=o&&o<127?String.fromCharCode(o):"."):i+="   "}i+=" "+s+"\n"}return i},t.asmline=function(e){return e.indexOf("\n")>=0?(e=e.replace(/^\s*/gm,"").replace(/^(.*)$/gm,(e,t)=>";"==t[0]&&" "==t[1]||/:\*$/.test(t)?t:"    "+t))+"\n":(/(^[\s;])|(:$)/.test(e)||(e="    "+e),e+"\n")},t.firstMethodOffset=function(){return 9};const r=[21078089,22513679,15655169,18636881,19658081,21486649,21919277,20041213,20548751,16180187,18361627,19338023,19772677,16506547,23530697,22998697,21225203,19815283,23679599,19822889,21136133,19540043,21837031,18095489,23924267,23434627,22582379,21584111,22615171,23403001,19640683,19998031,18460439,20105387,17595791,16482043,23199959,18881641,21578371,22765747,20170273,16547639,16434589,21435019,20226751,19506731,21454393,23224541,23431973,23745511];function s(e){let n=32;t.U.assert(t.U.unique(e,e=>""+e).length==e.length,"non unique");for(let i=2;;i<<=1){if(n--,i<e.length)continue;let s,o=-1,a=-1;for(let l of r){let r=l<<8|n,c=new Uint16Array(i+t.vtLookups+1);t.U.assert(!(1&c.length));let u=0,d=[];for(let i of e){t.U.assert(i>0);let e=Math.imul(i,r)>>>n;d.push(e);let s=!1;for(let n=0;n<t.vtLookups;n++){if(!c[e+n]){s=!0,c[e+n]=i;break}u++}if(!s){u=-1;break}}(-1==o||o>u)&&(o=u,a=r,s=c)}if(o>=0)return{mult:a,mapping:s,size:i}}}function o(e,n,i,r){const o=s(e.itable.map(e=>e.idx));let a=t.target.shortPointers?".short":".word",l=`\n        .object ${e.id}_VT\n        .balign 4\n${e.id}_VT:\n        .short ${4*e.allfields.length+4}  ; size in bytes\n        .byte ${pxt.ValTypeObject}, ${pxt.VTABLE_MAGIC} ; magic\n        ${a} ${e.id}_IfaceVT\n        .short ${e.classNo} ; class-id\n        .short 0 ; reserved\n        .word ${o.mult} ; hash-mult\n`,c=e=>{"0"!=e&&(e+="@fn"),l+=`        ${a} ${e}\n`};c("pxt::RefRecord_destroy"),c("pxt::RefRecord_print"),c("pxt::RefRecord_scan"),c("pxt::RefRecord_gcsize");let u=e.toStringMethod;c(u?u.vtLabel():"0");for(let t of e.vtable)c(t.label()+"_nochk");l+=`\n        .balign ${t.target.shortPointers?2:4}\n${e.id}_IfaceVT:\n`;const d=2*o.mapping.length;let p="",h=d,f={};for(let t of e.itable){f[t.idx+""]=h;const e=t.proc?t.proc.isGetter()?1:2:0;p+=`  .short ${t.idx}, ${e} ; ${t.name}\n`,p+=`  .word ${t.proc?t.proc.vtLabel()+"@fn":t.info}\n`,h+=8,t.setProc&&(p+=`  .short ${t.idx}, 0 ; set ${t.name}\n`,p+=`  .word ${t.setProc.vtLabel()}@fn\n`,h+=8)}p+="  .word 0, 0 ; the end\n",h+=8;let m=o.mapping;for(let e=0;e<m.length;++e)i.itEntries++,m[e]&&i.itFullEntries++;return l+="  .short "+t.U.toArray(m).map((e,t)=>(f[e+""]||d)-2*t).join(", ")+"\n",l+=p,l+="\n",l}t.vtLookups=3,t.computeHashMultiplier=s,t.vtableToAsm=o;const a=["GC"];function l(e,i,r){let s=`\n    .short ${e.globalsWords}   ; num. globals\n    .short 0 ; patched with number of 64 bit words resulting from assembly\n    .word _pxt_config_data\n    .short 0 ; patched with comm section size\n    .short ${e.nonPtrGlobals} ; number of globals that are not pointers (they come first)\n    .word _pxt_iface_member_names\n    .word _pxt_lambda_trampoline@fn\n    .word _pxt_perf_counters\n    .word _pxt_restore_exception_state@fn\n    .word ${e.emitString(e.getTitle())} ; name\n`,l=null;l=new t.ThumbSnippets;const c=e.setPerfCounters(a);e.procs.forEach(n=>{let i=new t.ProctoAssembler(l,e,n);s+="\n"+i.getAssembly()+"\n"});let u=new t.ProctoAssembler(l,e,null);u.emitHelpers(),s+="\n"+u.getAssembly()+"\n",s+=n.asmTotalSource,s+="_code_end:\n\n",t.U.iterMap(e.codeHelpers,(e,t)=>{s+=`    .section code\n    .object _code_helper_${t}\n${t}:\n${e}\n`}),s+=l.arithmetic(),s+="_helpers_end:\n\n",e.usedClassInfos.forEach(t=>{s+=o(t,0,e)}),s+="\n.balign 4\n.object _pxt_iface_member_names\n_pxt_iface_member_names:\n",s+=`    .word ${e.ifaceMembers.length}\n`;let d=0;for(let t of e.ifaceMembers){let n=e.emitString(t);s+=`    .word ${n}  ; ${d++} .${t}\n`}s+="    .word 0\n",s+="_vtables_end:\n\n",s+="\n.balign 4\n.object _pxt_config_data\n_pxt_config_data:\n";const p=r.configData||[];for(let e of p)s+=`    .word ${e.key}, ${e.value}  ; ${e.name}=${e.value}\n`;s+="    .word 0\n\n",function(e,n){const i=t.U.unique(n.ifaceMembers.concat(Object.keys(n.strings)),e=>e);for(let t of i)n.otherLiterals.push(e.string_literal(n.strings[t],t));for(let t of Object.keys(n.doubles)){let i=n.doubles[t];n.otherLiterals.push(`\n.object ${i}\n.balign 4\n${i}: ${e.obj_header("pxt::number_vt")}\n        .hex ${t}\n`)}for(let t of Object.keys(n.hexlits))n.otherLiterals.push(e.hex_literal(n.hexlits[t],t)),n.otherLiterals.push()}(l,e),s+=e.otherLiterals.join(""),s+="\n.balign 4\n.section code\n.object _perf_counters\n_pxt_perf_counters:\n",s+=`    .word ${c.length}\n`;let h="";for(let e=0;e<c.length;++e){let t=".perf"+e;s+=`    .word ${t}\n`,h+=`${t}: .string ${JSON.stringify(c[e])}\n`}return s+=h,s+="_literals_end:\n",s}function c(e){let i;return i=e.nativeType==t.NATIVE_TYPE_VM?new t.assembler.VMFile(new t.vm.VmProcessor(e)):new t.assembler.File(new t.thumb.ThumbProcessor),i.ei.testAssembler(),e.switches.noPeepHole&&(i.disablePeepHole=!0),e.switches.size&&(i.codeSizeStats=!0),i.lookupExternalLabel=n.lookupFunctionAddr,i.normalizeExternalLabel=e=>{let t=n.lookupFunc(e);return t?t.name:e},i}function u(e){if(e.errors.length>0){let n="";throw e.errors.forEach(e=>{let i=/^user(\d+)/.exec(e.scope);if(i){parseInt(i[1]);n+=t.U.lf("At inline assembly:\n"),n+=e.message}}),n?(pxt.log(t.U.lf("errors in inline assembly")),pxt.log(n),new Error(e.errors[0].message)):new Error(e.errors[0].message)}}function d(e,t){let i=0;if(t.configData){let e=t.configData.find(e=>"SETTINGS_SIZE_DEFL"===e.name),n=t.configData.find(e=>"SETTINGS_SIZE"===e.name);i=n?n.value:e?e.value:0}const r=n.getTopFlashAddress();return(r>0?r:e.flashUsableEnd?e.flashUsableEnd:e.flashEnd)-i}t.processorInlineAssemble=function(e,t){let n=c(e);n.disablePeepHole=!0,n.emit(t),u(n);let i=[];for(let e=0;e<n.buf.length;e+=2)i.push(((n.buf[e+1]||0)<<16|n.buf[e])>>>0);return i};function p(e,t,n,i){let r=c(e);return r.emit(n),n=`; Interface tables: ${t.itFullEntries}/${t.itEntries} (${Math.round(100*t.itFullEntries/t.itEntries)}%)\n; Virtual methods: ${t.numVirtMethods} / ${t.numMethods}\n`+r.getSource(!0,t.numStmts,d(e,i)),u(r),{src:n,buf:r.buf,thumbFile:r}}function h(i,r,s,o){const a=s.extinfo.disabledDeps;i=a?`${n.hexPrelude()}\n; compilation disabled on this variant due to ${s.extinfo.disabledDeps}\n.hex 718E3B92C615A841C49866C975EE5197\n.string "${s.extinfo.disabledDeps}"`:`; start\n${n.hexPrelude()}\n    .hex 708E3B92C615A841C49866C975EE5197 ; magic number\n    .hex ${n.hexTemplateHash()} ; hex template hash\n    .hex 873266330af9dbdb ; replaced in binary by program hash\n`+i,s.embedBlob&&(r.packedSource=function(e,n){let i=t.Util.toUTF8(e),r=(i.length,n.length,"A//");return r+=t.U.uint8ArrayToString([255&i.length,i.length>>8,255&n.length,n.length>>8,0,0,0,0]),r+=i,r+=n,r.length%2&&(r+="\0"),r}(s.embedMeta,e.pxtc.decodeBase64(s.embedBlob)),!r.target.noSourceInFlash&&r.packedSource.length<4e4&&(i+=function(e){let t="";for(let n=0;n<e.length;++n){let i=255&e.charCodeAt(n);t+=i<=15?"0"+i.toString(16):i.toString(16)}return`\n    .balign 16\n    .object _stored_program\n_stored_program: .hex ${t}\n`}(r.packedSource),r.packedSource=null));const l=n.flashCodeAlign(s.target);if(!a&&s.target.flashChecksumAddr){let e=0;for(;l>1<<e;)e++;let t=parseInt(n.hexTemplateHash().slice(8,16),16);const r=n.getStartAddress()/l;t=4294967040&t|e;let o=0,a=r;s.target.flashChecksumAddr<n.getStartAddress()&&(o=Math.ceil((s.target.flashChecksumAddr+32)/l),a-=o),i+=`\n    .balign 4\n__end_marker:\n    .word ${t}\n\n; ------- this will get removed from the final binary ------\n__flash_checksums:\n    .word 0x87eeb07c ; magic\n    .word __end_marker ; end marker position\n    .word ${t} ; end marker\n    ; template region\n    .short ${o}, ${a}\n    .word 0x${n.hexTemplateHash().slice(0,8)}\n    ; user region\n    .short ${r}, 0xffff\n    .hex 87326633 ; replaced later\n    .word 0x0 ; terminator\n`}const c=s.extinfo.outputPrefix||"";r.writeFile(c+t.BINARY_ASM,i);const u=p(s.target,r,i,o);if(u.thumbFile.commPtr&&(r.commSize=u.thumbFile.commPtr-n.getCommBase()),u.src&&r.writeFile(c+t.BINARY_ASM,u.src),a)return void h();const d=o.configData||[];if(d.some(e=>"BOOTLOADER_BOARD_ID"==e.name)){let e="const uint32_t configData[] = {\n";e+="    0x1e9e10f1, 0x20227a79, // magic\n",e+=`    ${d.length}, 0, // num. entries; reserved\n`;for(let t of d)e+=`    ${t.key}, 0x${t.value.toString(16)}, // ${t.name}\n`;e+="    0, 0\n};\n",r.writeFile(c+"config.c",e)}if(u.buf){const e=u.buf;let n="";for(let t=0;t<e.length;++t)n+=String.fromCharCode(255&e[t],e[t]>>8);const i=t.U.sha256(n).slice(0,16),o=t.U.range(4).map(e=>parseInt(i.slice(2*e,2*e+2),16));t.U.assert(12935==e[12]);for(let t=0;t<o.length;++t)e[12+t]=o[t];if(s.target.flashChecksumAddr){let n=u.thumbFile.lookupLabel("__flash_checksums")/2;t.U.assert(n==e.length-16);let i=e.slice(e.length-16);e.splice(e.length-16,16);let s=Math.ceil(2*e.length/l);t.U.assert(12935==i[i.length-4]),i[i.length-4]=o[0],i[i.length-3]=o[1],i[i.length-5]=s,r.checksumBlock=i}h()}if(!o.procDebugInfo){for(let e of o.breakpoints){let n=t.U.lookup(u.thumbFile.getLabels(),"__brkp_"+e.id);null!=n&&(e.binAddr=n)}for(let e of r.procs)e.fillDebugInfo(u.thumbFile);if(o.procDebugInfo=r.procs.map(e=>e.debugInfo),r.target.switches.size){const n=[];for(const i of r.procs){const r=e.pxtc.nodeLocationInfo(i.action),s=[r.fileName.replace("pxt_modules/",""),t.getDeclName(i.action),i.debugInfo.size,"function",r.line+1];n.push(f(s))}n.sort(),n.unshift("filename,name,size,type,line"),r.writeFile(c+"size.csv",n.join("\n"))}}function h(){if(pxt.isOutputText(t.target)){const e=n.patchHex(r,u.buf,!1,!1).join("\r\n")+"\r\n";r.writeFile(c+pxt.outputName(t.target),e)}else{const i=e.pxtc.encodeBase64(n.patchHex(r,u.buf,!1,!!t.target.useUF2)[0]);r.writeFile(c+pxt.outputName(t.target),i)}}}function f(e){return e.map(e=>`"${e}"`).join(",")}t.assemble=p,t.processorEmit=function(e,i,r){var s,o;const a=l(e,0,r),c=t.U.flatClone(i);n.setupFor(i.target,i.extinfo||t.emptyExtInfo(),r),h(a,e,i,r),r.builtVariants||(r.builtVariants=[]),r.builtVariants.push(null===(s=i.extinfo)||void 0===s?void 0:s.appVariant);const u=c.otherMultiVariants||[];if(u.length)try{for(let i of u){const s=t.U.flatClone(c);s.extinfo=i.extinfo,i.target.isNative=!0,s.target=i.target,n.setupFor(s.target,s.extinfo,r),h(a,e,s,r),r.builtVariants.push(null===(o=i.extinfo)||void 0===o?void 0:o.appVariant)}}finally{n.setupFor(c.target,c.extinfo,r)}},t.validateShim=n.validateShim}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){e.getHelpForKeyword=function(e,t){const n={abstract:null,any:null,as:null,break:null,case:null,catch:null,class:null,continue:null,const:null,constructor:null,debugger:null,declare:null,delete:null,do:null,else:null,enum:null,export:null,extends:null,false:lf("Represents the negative outcome of a logical expression"),finally:null,for:null,from:null,function:null,get:null,if:null,implements:null,in:null,instanceof:null,interface:null,is:null,let:null,namespace:null,new:null,null:null,private:null,protected:null,public:null,return:null,set:null,static:null,super:null,switch:null,this:null,throw:null,true:lf("Represents the positive outcome of a logical expression"),try:null,type:null,typeof:null,undefined:null,void:null,while:null,with:null,of:null};if(t){return{True:n.true,False:n.false,None:null,abs:null,all:null,any:null,ascii:null,bin:null,bool:null,bytearray:null,bytes:null,callable:null,chr:null,classmethod:null,compile:null,complex:null,copyright:null,credits:null,delattr:null,dict:null,dir:null,divmod:null,enumerate:null,eval:null,exec:null,exit:null,filter:null,float:null,format:null,frozenset:null,getattr:null,globals:null,hasattr:null,hash:null,help:null,hex:null,id:null,input:null,int:null,isinstance:null,issubclass:null,iter:null,len:null,license:null,list:null,locals:null,map:null,max:null,memoryview:null,min:null,next:null,object:null,oct:null,open:null,ord:null,pow:null,print:null,property:null,quit:null,range:null,repr:null,reversed:null,round:null,set:null,setattr:null,slice:null,sorted:null,staticmethod:null,str:null,sum:null,super:null,tuple:null,type:null,vars:null}[e]}return n[e]}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){e.LSHost=class{constructor(e){this.p=e}getCompilationSettings(){const e=this.p.getCompilerOptions();return e.noLib=!0,e}getNewLine(){return"\n"}getScriptFileNames(){return this.p.getSourceFiles().map(e=>e.fileName)}getScriptVersion(e){return"0"}getScriptSnapshot(e){const t=this.p.getSourceFile(e);return{getLength:()=>t.getFullText().length,getText:()=>t.getFullText(),getChangeRange:()=>{}}}getCurrentDirectory(){return"."}getDefaultLibFileName(e){return""}useCaseSensitiveFileNames(){return!0}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){function i(e){var t,i;const r=null===(i=null===(t=null==e?void 0:e.pxt)||void 0===t?void 0:t.callInfo)||void 0===i?void 0:i.qName;return n.lastApiInfo.apis.byQName[r]}function r(e,t,i){if(!e||t<0)return;let r=e.parameters[t];if(e.attributes._def){const s=e.attributes._def.parameters[t].shadowBlockId;if(s){const e=i.blocksById[s],t=n.lastApiInfo.apis.byQName[e.qName];"TD_ID"===t.attributes.shim&&1===t.parameters.length&&(r=t.parameters[0])}}return r}function s(i,r,s,o,a=!1){const l={};o.forEach(e=>{var t,n;let i=e.symbol.retType;if(a)if(7==e.symbol.kind)i=e.symbol.namespace;else if(4==e.symbol.kind){const r=null===(n=null===(t=e.symbol.attributes)||void 0===t?void 0:t.enumIdentity)||void 0===n?void 0:n.split(".");(null==r?void 0:r.length)>1&&(i=r[0])}l[i]=[...l[i]||[],e]});const c=l[i]||[];let u=[];for(let i of c){const o=m(i.symbol,r,e.SymbolFlags.Enum);if(o){const e=s.getTypeOfSymbolAtLocation(o,r),i=t.getEnumMembers(s,e).map(e=>t.enumMemberToQName(s,e)),a=i.map(e=>n.lastApiInfo.apis.byQName[e]);u=[...u,...a]}}return[...c,...p(u,1)]}function o(t){return t.flags&e.SymbolFlags.Variable?4:t.flags&e.SymbolFlags.Class?8:t.flags&e.SymbolFlags.Enum?6:t.flags&e.SymbolFlags.EnumMember?7:t.flags&e.SymbolFlags.Method?1:t.flags&e.SymbolFlags.Module?5:t.flags&e.SymbolFlags.Property?2:0}function a(e){return{kind:0,name:e,pyName:e,qName:e,pyQName:e,namespace:"",attributes:{callingConvention:0,paramDefl:{}},fileName:pxt.MAIN_TS,parameters:[],retType:"any"}}function l(e,t){var n,i;let r=e.getName(),s=/(.*)\.(.*)/.exec(r),a=s?s[2]:r,l=s?s[1]:"",c=null!==(i=null===(n=t.getSymbol())||void 0===n?void 0:n.getName())&&void 0!==i?i:"any";return{kind:o(e),name:a,pyName:a,qName:r,pyQName:r,namespace:l,attributes:{callingConvention:0,paramDefl:{}},fileName:pxt.MAIN_TS,parameters:[],retType:c}}function c(e,t,n){if(e)return t.byQName[n.getFullyQualifiedName(e)]}function u(e,n){return e.weight!==n.weight?n.weight-e.weight:t.compareSymbols(e.symbol,n.symbol)}function d(e,t){return{symbol:e,weight:t}}function p(e,t){return e.map(e=>d(e,t))}function h(t,n){var i;if(t.flags&e.TypeFlags.NumberLiteral)return"Number";if(t.flags&e.TypeFlags.StringLiteral)return"String";if(t.flags&e.TypeFlags.BooleanLiteral)return"Boolean";const r=n.typeToString(t);return null!==(i={number:"Number",string:"String",boolean:"Boolean"}[r])&&void 0!==i?i:r}function f(e,t){return"."===t.charAt(0)&&(t=t.substr(1)),e.substr(0,e.lastIndexOf(".")+1)+t}function m(e,t,i){const r=n.service&&n.service.getProgram().getTypeChecker();if(!r)return null;const s=r.getSymbolsInScope(t,i);for(let t of s)if(t.escapedName.toString()===e.qName)return t;return null}function g({symbol:e}){return!(/^__/.test(e.name)||/^__/.test(e.namespace)||e.attributes.hidden||e.attributes.deprecated||"TD_ID"==e.attributes.shim||e.attributes.blockAliasFor)}n.getCallSymbol=i,n.getParameter=r,n.getApisForTsType=s,n.getBasicKindDefault=function(e,n){switch(e){case t.SK.StringKeyword:return'""';case t.SK.NumberKeyword:return"0";case t.SK.BooleanKeyword:return n?"False":"false";case t.SK.ArrayType:return"[]";case t.SK.NullKeyword:return n?"None":"null";default:return}},n.tsSymbolToPxtSymbolKind=o,n.makePxtSymbolFromKeyword=a,n.makePxtSymbolFromTsSymbol=l,n.getPxtSymbolFromTsSymbol=c,n.compareCompletionSymbols=u,n.completionSymbol=d,n.completionSymbols=p,n.getNodeAndSymbolAtLocation=function(e,n,i,r){const s=e.getSourceFile(n),o=e.getTypeChecker(),a=t.findInnerMostNodeAtPosition(s,i);if(a){const e=o.getSymbolAtLocation(a);if(e){return[a,c(e,r,o)]}}return null},n.tsTypeToPxtTypeString=h,n.filenameWithExtension=f,n.getWordAtPosition=function(e,t){let n=t,i=t;for(;n>0&&r(n);)--n;for(;i<e.length-1&&r(i);)++i;return n!=i?{text:e.substring(n+1,i),start:n+1,end:i}:null;function r(t){const n=e.charCodeAt(t);return n>=65&&n<=90||n>=97&&n<=122}},n.getTsSymbolFromPxtSymbol=m,n.getDefaultEnumValue=function(e,i){const r=n.service&&n.service.getProgram().getTypeChecker(),s=t.getEnumMembers(r,e);for(const e of s)if(e.name.kind===t.SK.Identifier){const s=t.enumMemberToQName(r,e),o=n.lastApiInfo.apis.byQName[s];return o?o.attributes.alias?i&&o.attributes.pyAlias||o.attributes.alias:i?o.pyQName:o.qName:s}return"0"},n.getCompletions=function(o){var m,_;const{fileName:y,fileContent:b,position:v,wordStartPos:T,wordEndPos:k,runtime:x}=o;let E=b;b&&n.host.setFile(y,b);const S=f(y,"ts"),C={startPos:T,endPos:k},w=/\.py$/.test(y),I={entries:[],isMemberCompletion:!1,isNewIdentifierLocation:!0,isTypeLocation:!1,namespace:[]};let A=E.lastIndexOf("\n",v-1);A=Math.max(0,A);const N=E.substring(A+1,v),D=w?"#":"//";if(N.trim().startsWith(D))return I;let O=-1,R=-1;for(let e=v-1;e>=0;--e){if("."==E[e]){O=e;break}if(!/\w/.test(E[e]))break;-1==R&&(R=e)}O==v-1?E=E.slice(0,v)+"_"+E.slice(v):-1==R&&(E=E.slice(0,v)+"_"+E.slice(v),R=v);const L=-1!==O;I.isMemberCompletion=L;const P=L?E.slice(O+1,k):E.slice(T,k);L&&(R=O);const M={};let F=n.cloneCompileOpts(n.host.opts);F.fileSystem[y]=E,n.addApiInfo(F),F.syntaxInfo={position:R,type:I.isMemberCompletion?"memberCompletion":"identifierCompletion"};let B,$=[];if(w){const e=t.transpile.pyToTs(F);if(e.syntaxInfo&&e.syntaxInfo.symbols&&($=p(e.syntaxInfo.symbols,1)),e.globalNames&&(n.lastGlobalNames=e.globalNames),!$.length&&e.globalNames&&($=p(pxt.U.values(e.globalNames),1)),Object.keys(e.outfiles).forEach(t=>{t===S&&n.host.setFile(t,e.outfiles[t])}),e.sourceMap){const n=E,i=e.outfiles[S]||"",r=t.BuildSourceMapHelpers(e.sourceMap,i,n).py.smallestOverlap(C);r&&(B=r.ts.startPos)}!L&&$.length>50&&($=$.filter(e=>(w?e.symbol.pyQName:e.symbol.qName).toLowerCase().indexOf(P.toLowerCase())>=0)),F.ast=!0;t.compile(F,n.service)}else{B=v,F.ast=!0,n.host.setOpts(F);n.runConversionsAndCompileUsingService()}const U=n.service.getProgram(),V=U.getSourceFile(S),H=U.getTypeChecker();let G=t.findInnerMostNodeAtPosition(V,B);if(t.decompiler.buildCommentMap(V).some(e=>e.start<=v&&v<=e.end))return I;if(G){if([t.SK.StringLiteral,t.SK.FirstTemplateToken,t.SK.NoSubstitutionTemplateLiteral].some(e=>G.kind===e))return I}I.namespace=t.getCurrentNamespaces(G);let j=!1;if(L){const e=t.findInnerMostNodeAtPosition(V,w?B:O-1);if(e){let t;const i=H.getSymbolAtLocation(e);if(t=(null===(m=null==i?void 0:i.members)||void 0===m?void 0:m.size)>0?H.getDeclaredTypeOfSymbol(i):i?H.getTypeOfSymbolAtLocation(i,e):H.getTypeAtLocation(e),t){const e=t.symbol?H.getFullyQualifiedName(t.symbol):h(t,H);if(e){$=t.getApparentProperties().map(t=>e+"."+t.getName()).map(e=>n.lastApiInfo.apis.byQName[e]).filter(e=>!!e).map(e=>d(e,1)),j=!0}}}}const K=pxt.U.values(n.lastApiInfo.apis.byQName);if(0===$.length){$=p(K.filter(e=>(w?e.pyQName:e.qName).toLowerCase().indexOf(P.toLowerCase())>=0),1)}if(!w&&!j){G=t.findInnerMostNodeAtPosition(V,T),G||(G=V.getSourceFile());let i=e.SymbolFlags.Variable,r=H.getSymbolsInScope(G,i),s=G.getText();"_"!==s&&(r=r.filter(e=>e.name.indexOf(s)>=0));let o=r.map(e=>{let t=c(e,n.lastApiInfo.apis,H);if(!t){t=l(e,H.getTypeOfSymbolAtLocation(e,G))}return t}).filter(e=>!!e).map(e=>d(e,1));o.forEach(e=>e.weight+=5),$=[...$,...o]}const z=t.getParentCallExpression(G);if(z){let e=t.findCurrentCallArgIdx(z,G,B);if(e>=0){const t=n.blocksInfoOp(n.lastApiInfo.apis,x.bannedCategories),o=i(z);if(o){e>=o.parameters.length&&(e=o.parameters.length-1);const n=r(o,e,t);if(n){s(n.type,z,H,$,n.isEnum).forEach(e=>e.weight=10)}}}}if(!L){let e;if(w){let t=pxt.py.keywords;e=Object.keys(t)}else e=[...ts.pxtc.reservedWords,...ts.pxtc.keywordTypes];let t=e.filter(e=>e.indexOf(P)>=0).map(a).map(e=>d(e,0));$=[...$,...t]}let W={};W=w&&n.lastGlobalNames?n.lastGlobalNames:n.lastApiInfo.apis.byQName,$.map(e=>!e.symbol.attributes.alias||L&&7===e.symbol.kind?e:d(n.lastApiInfo.apis.byQName[e.symbol.attributes.alias],e.weight)).filter(g).forEach(e=>{M[e.symbol.qName]=e}),$=pxt.Util.values(M).filter(e=>!!e&&!!e.symbol),$.sort(u),o.light&&$.length>100&&($=$.splice(0,100));const{bannedCategories:q,screenSize:J}=o.runtime,Y={takenNames:W,blocksInfo:n.blocksInfoOp(n.lastApiInfo.apis,q),screenSize:J,apis:n.lastApiInfo.apis,checker:null===(_=null===n.service||void 0===n.service?void 0:n.service.getProgram())||void 0===_?void 0:_.getTypeChecker()};return $.forEach(t=>function(t,i,r){const s=n.lastApiInfo.decls[t.qName];if(e.isFunctionLike(s)&&(t.snippetAddsDefinitions||i&&!t.pySnippet||!i&&!t.snippet)){const e=n.getSnippet(r,t,s,i),o=n.snippetStringify(e),a=n.snippetStringify(e,!0),l=n.snippetAddsDefinitions(e);i?(t.pySnippet=o,t.pySnippetWithMarkers=a):(t.snippet=o,t.snippetWithMarkers=a),t.snippetAddsDefinitions=l}}(t.symbol,w,Y)),I.entries=$.map(e=>e.symbol),I}}(t.service||(t.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n=function(t){let n=r(t);e.sys.write(n)};function i(e){for(const t of e)n(t)}function r(n){let i;if(void 0!==n.file){let t=n;const{line:r,character:s}=e.getLineAndCharacterOfPosition(t.file,t.start),o=t.file.fileName;i=Object.assign({fileName:o,line:r,column:s},t)}else i=Object.assign({fileName:void 0,line:void 0,column:void 0},n);return function(n){let i="";n.fileName&&(i+=`${n.fileName}(${n.line+1},${n.column+1}): `);let r=e.sys?e.sys.newLine:"\n";const s=t.DiagnosticCategory[n.category].toLowerCase();return i+=`${s} TS${n.code}: ${t.flattenDiagnosticMessageText(n.messageText,r)}${r}`,i}(i)}function s(t,n){const i=e.createCompilerHost(n);return i.getDefaultLibFileName=()=>"node_modules/pxt-core/pxtcompiler/ext-typescript/lib/lib.d.ts",e.createProgram(t,n,i)}function o(e){let n=e.getSyntacticDiagnostics();return 0===n.length&&(n=e.getOptionsDiagnostics().concat(t.Util.toArray(e.getGlobalDiagnostics())),0===n.length&&(n=e.getSemanticDiagnostics())),n.slice(0)}t.getDiagnosticString=r,t.plainTscCompileDir=function(t){const r=e.parseCommandLine([]);let a=e.findConfigFile(t,e.sys.fileExists);const l=function(){let n=e.sys.readFile(a);const s=e.parseConfigFileTextToJson(a,n),o=s.config;if(!o)return i([s.error]),void e.sys.exit(e.ExitStatus.DiagnosticsPresent_OutputsSkipped);const l=e.parseJsonConfigFileContent(o,e.sys,t,r.options,a);if(l.errors.length>0)return i(l.errors),void e.sys.exit(e.ExitStatus.DiagnosticsPresent_OutputsSkipped);return l}();let c=s(l.fileNames,l.options);return o(c).forEach(n),c},t.plainTscCompileFiles=s,t.getProgramDiagnostics=o}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){function n(t){if(!t||!t.kind)return null;switch(t.kind){case e.SyntaxKind.StringKeyword:return"str";case e.SyntaxKind.NumberKeyword:return"number";case e.SyntaxKind.BooleanKeyword:return"bool";case e.SyntaxKind.VoidKeyword:return"None";case e.SyntaxKind.FunctionType:return function(e){let t=n(e.type),i=e.parameters.map(e=>e.type).map(n);return`(${i.join(", ")}) -> ${t}`}(t);case e.SyntaxKind.ArrayType:return`List[${n(t.elementType)}]`;case e.SyntaxKind.TypeReference:{let e=t;return e.typeName&&e.typeName.getText?e.typeName.getText():""}case e.SyntaxKind.AnyKeyword:return"any";default:return pxt.tickEvent("depython.todo.tstypenodetopytype",{kind:t.kind}),""}}function i(t){if(!t||!t.flags)return null;switch(t.flags){case e.TypeFlags.String:return"str";case e.TypeFlags.Number:return"number";case e.TypeFlags.Boolean:return"bool";case e.TypeFlags.Void:return"None";case e.TypeFlags.Any:return"any";default:return pxt.tickEvent("depython.todo.tstypetopytype",{kind:t.flags}),""}}function r(r,s,o){var a;function l(t,n,i=!1){let s=r.getTypeAtLocation(n);if(!s)return"None";i&&(s=s.getCallSignatures()[0].getReturnType());const o=r.typeToString(s,void 0,e.TypeFormatFlags.UseFullyQualifiedType);return/^\d/.test(o)?"number":"this"==o?c(r,s.symbol):o}let u=function(e){switch(e.kind){case t.SK.MethodDeclaration:case t.SK.MethodSignature:return 1;case t.SK.PropertyDeclaration:case t.SK.PropertySignature:case t.SK.GetAccessor:case t.SK.SetAccessor:return 2;case t.SK.Constructor:case t.SK.FunctionDeclaration:return 3;case t.SK.VariableDeclaration:return 4;case t.SK.ModuleDeclaration:return 5;case t.SK.EnumDeclaration:return 6;case t.SK.EnumMember:return 7;case t.SK.ClassDeclaration:return 8;case t.SK.InterfaceDeclaration:return 9;default:return 0}}(o);if(0!=u){let c=o,d=t.parseComments(c);if(d.weight<0)return null;let p,h=/^(.*)\.(.*)/.exec(s),f=3==u||1==u,m=null,g=null,_=e.getSourceFileOfNode(o);if(_){let e=/^pxt_modules\/([^\/]+)/.exec(_.fileName);e&&(m=e[1])}if(8==u||9==u){let e=o;if(p=[],e.heritageClauses)for(let t of e.heritageClauses)if(t.types)for(let e of t.types)p.push(l(0,e))}6!=u&&7!==u||(p||(p=[])).push("Number");let y={kind:u,qName:s,namespace:h?h[1]:"",name:h?h[2]:s,fileName:o.getSourceFile().fileName,attributes:d,pkg:m,pkgs:g,extendsTypes:p,isStatic:null===(a=c.modifiers)||void 0===a?void 0:a.some(t=>t.kind===e.SyntaxKind.StaticKeyword),retType:o.kind==e.SyntaxKind.Constructor?"void":5==u?"":l(c.type,c,f),parameters:f?t.Util.toArray(c.parameters).map((s,o)=>{let a,c,u=t.getName(s),p=d.paramHelp[u]||"",h=d.paramMin&&d.paramMin[u],f=d.paramMax&&d.paramMax[u];/\beg\.?:\s*(.+)/.exec(p);if(s.type&&s.type.kind===t.SK.FunctionType){const n=r.getSignatureFromDeclaration(s.type).getParameters();"objectdestructuring"===d.mutate?(t.assert(n.length>0),a=r.getTypeAtLocation(n[0].valueDeclaration).getProperties().map(e=>({name:e.getName(),type:r.typeToString(r.getTypeOfSymbolAtLocation(e,n[0].valueDeclaration))}))):c=n.map((t,n)=>({name:t.getName(),type:r.typeToString(r.getTypeOfSymbolAtLocation(t,s),void 0,e.TypeFormatFlags.UseFullyQualifiedType)}))}let m={};const g=r.getTypeAtLocation(s);let _=g&&!!(g.flags&(e.TypeFlags.Enum|e.TypeFlags.EnumLiteral));if(d.block&&d.paramShadowOptions){const e=[];d.block.replace(/%(\w+)/g,(t,n)=>(e.push(n),"")),d.paramShadowOptions[e[o]]&&(m.fieldEditorOptions={value:d.paramShadowOptions[e[o]]})}h&&(m.min={value:h}),f&&(m.max={value:f});const y=s.type&&n(s.type)||g&&i(g)||"unknown",b=s.initializer?s.initializer.getText():t.getExplicitDefault(d,u)||(s.questionToken?"undefined":void 0);return{name:u,description:p,type:l(s.type,s),pyTypeString:y,initializer:b,default:d.paramDefl[u],properties:a,handlerParameters:c,options:m,isEnum:_}}):null,snippet:e.isFunctionLike(o)?null:void 0};switch(y.kind){case 7:y.pyName=t.U.snakify(y.name).toUpperCase();break;case 4:case 1:case 2:case 3:y.pyName=t.U.snakify(y.name);break;default:y.pyName=y.name}return(o.kind===t.SK.GetAccessor||(o.kind===t.SK.PropertyDeclaration||o.kind===t.SK.PropertySignature)&&t.isReadonly(o))&&(y.isReadOnly=!0),y}return null}function s(e){return!!e.attributes.block&&!!e.attributes.blockId}let o;function a(e,n){function i(t){return-t(e)+t(n)}let r=i(e=>s(e)?1:-1);return r||(r=i(e=>e.namespace?-1:1),r||(o||(o={},o[4]=100,o[5]=101,o[3]=99,o[2]=98,o[1]=97,o[8]=89,o[6]=81,o[7]=80),r=i(e=>o[e.kind]||0),r||(r=i(e=>e.attributes.weight||50),r||t.U.strcmp(e.name,n.name))))}function l(e,n,i=!1){const s={byQName:{},jres:n},o={},a=e.getTypeChecker(),l=e=>{var n,i;if(e.kind==t.SK.VariableStatement){return void e.declarationList.declarations.forEach(l)}if(t.isExported(e)){if(!e.symbol)return void pxt.warn("no symbol",e);let l=c(a,e.symbol);e.kind==t.SK.SetAccessor&&(l+="@set"),o[l]=e;let u=r(a,l,e);if(u){let r=t.U.lookup(s.byQName,l);if(r)if(9==r.kind&&9!=u.kind)s.byQName[l+"@type"]=r;else if(9!=r.kind&&9==u.kind)s.byQName[l+"@type"]=u,u=r;else{const e=null===(n=r.attributes._source)||void 0===n?void 0:n.trim(),s=null===(i=u.attributes._source)||void 0===i?void 0:i.trim();let o=e+"\n"+s;e&&(null==s?void 0:s.indexOf(e))>=0?o=s:s&&(null==e?void 0:e.indexOf(s))>=0&&(o=e),u.attributes=t.parseCommentString(o),5===r.kind&&(u.pkgs=r.pkgs||[],r.pkg!==u.pkg&&(u.pkgs.find(e=>e===r.pkg)||u.pkgs.push(r.pkg))),r.extendsTypes&&(u.extendsTypes=u.extendsTypes||[],r.extendsTypes.forEach(e=>{-1===u.extendsTypes.indexOf(e)&&u.extendsTypes.push(e)}))}!e.parent||e.parent.kind!=t.SK.ClassDeclaration&&e.parent.kind!=t.SK.InterfaceDeclaration||t.isStatic(e)||(u.isInstance=!0),s.byQName[l]=u}}if(e.kind==t.SK.ModuleDeclaration){let n=e;if(n.body.kind==t.SK.ModuleBlock){n.body.statements.forEach(l)}else n.body.kind==t.SK.ModuleDeclaration&&l(n.body)}else if(e.kind==t.SK.InterfaceDeclaration){e.members.forEach(l)}else if(e.kind==t.SK.ClassDeclaration){e.members.forEach(l)}else if(e.kind==t.SK.EnumDeclaration){e.members.forEach(l)}};for(let t of e.getSourceFiles())t.statements.forEach(l);let u=[];for(let e in s.byQName){let i=s.byQName[e];i.qName=e,i.attributes._source=null,i.extendsTypes&&i.extendsTypes.length&&u.push(i);let r=i.attributes.jres;if(r){"true"==r&&(r=e);let s=t.U.lookup(n||{},r);s&&s.icon&&!i.attributes.iconURL&&(i.attributes.iconURL=s.icon),s&&s.data&&!i.attributes.jresURL&&(i.attributes.jresURL="data:"+s.mimeType+";base64,"+s.data)}if(i.pyName){let e=t.U.lookup(t.ts2PyFunNameMap,i.qName);if(e&&e.n)i.pyQName=e.n,i.pySnippet=e.snippet,i.pySnippetName=e.n,i.pySnippetWithMarkers=void 0;else if(i.namespace){let e=s.byQName[i.namespace];e?i.pyQName=e.pyQName+"."+i.pyName:(pxt.log("namespace missing: "+i.namespace),i.pyQName=i.namespace+"."+i.pyName)}else i.pyQName=i.pyName}}let d={},p=e=>{if(t.U.lookup(d,e.qName))return;d[e.qName]=!0;let n={};n[e.qName]=!0;for(let t of e.extendsTypes||[]){n[t]=!0;let e=s.byQName[t];if(e){p(e);for(let t of e.extendsTypes)n[t]=!0}}e.extendsTypes=Object.keys(n)};return u.forEach(p),i&&delete s.byQName["Array.map"],{apis:s,decls:o}}function c(e,t){return t.isBogusSymbol?t.name:e.getFullyQualifiedName(t)}t.placeholderChar="",t.ts2PyFunNameMap={"Math.trunc":{n:"int",t:e.SyntaxKind.NumberKeyword,snippet:"int(0)"},"Math.min":{n:"min",t:e.SyntaxKind.NumberKeyword,snippet:"min(0, 0)"},"Math.max":{n:"max",t:e.SyntaxKind.NumberKeyword,snippet:"max(0, 0)"},"Math.abs":{n:"abs",t:e.SyntaxKind.NumberKeyword,snippet:"abs(0)"},"console.log":{n:"print",t:e.SyntaxKind.VoidKeyword,snippet:'print(":)")'},".length":{n:"len",t:e.SyntaxKind.NumberKeyword},".toLowerCase()":{n:"string.lower",t:e.SyntaxKind.StringKeyword},".toUpperCase()":{n:"string.upper",t:e.SyntaxKind.StringKeyword},".charCodeAt(0)":{n:"ord",t:e.SyntaxKind.NumberKeyword},"pins.createBuffer":{n:"bytearray",t:e.SyntaxKind.Unknown},"pins.createBufferFromArray":{n:"bytes",t:e.SyntaxKind.Unknown},"control.createBuffer":{n:"bytearray",t:e.SyntaxKind.Unknown},"control.createBufferFromArray":{n:"bytes",t:e.SyntaxKind.Unknown},"!!":{n:"bool",t:e.SyntaxKind.BooleanKeyword},"Array.push":{n:"Array.append",t:e.SyntaxKind.Unknown},parseInt:{n:"int",t:e.SyntaxKind.NumberKeyword,snippet:'int("0")'},"_py.range":{n:"range",t:e.SyntaxKind.Unknown,snippet:"range(4)"}},t.emitPyTypeFromTypeNode=n,t.emitPyTypeFromTsType=i,t.genDocs=function(n,i,r={}){pxt.debug(`generating docs for ${n}`),pxt.debug(JSON.stringify(Object.keys(i.byQName),null,2));const s={},o=t.Util.values(i.byQName),l=o.filter(e=>7==e.kind).sort(a),c={},u={},d={},p=t=>{var n;if(r.locs&&t.qName&&!/^__/.test(t.name)){if(pxt.debug(`loc: ${t.qName}`),7!=t.kind){const n=e.pxtc.blocksCategory(t);n&&(u[`{id:category}${n}`]=n)}if(t.attributes.jsDoc&&(d[t.qName]=t.attributes.jsDoc),t.attributes.group&&(u[`{id:group}${t.attributes.group}`]=t.attributes.group),t.attributes.subcategory&&(u[`{id:subcategory}${t.attributes.subcategory}`]=t.attributes.subcategory),t.parameters&&t.parameters.filter(e=>!!e.description).forEach(e=>{d[`${t.qName}|param|${e.name}`]=e.description}),t.attributes.block){u[`${t.qName}|block`]=t.attributes.block;const e=pxt.blocks.compileInfo(t);if(null===(n=e.handlerArgs)||void 0===n?void 0:n.length)for(const t of e.handlerArgs)u[t.localizationKey]=t.name}}},h=(e,t)=>{if(!r.locs)return;const i={};Object.keys(e).sort().forEach(t=>i[t]=e[t]),s[n+t+"-strings.json"]=JSON.stringify(i,null,2)};for(const e of o){if(5==e.kind){if(!o.filter(t=>t.namespace==e.name&&!!t.attributes.jsDoc)[0])continue;e.attributes.block||(e.attributes.block=e.name)}p(e)}return r.locs&&l.forEach(e=>{e.attributes.block&&(u[`${e.qName}|block`]=e.attributes.block),e.attributes.jsDoc&&(u[e.qName]=e.attributes.jsDoc)}),h(u,""),h(d,"-jsdoc"),r.pxtsnippet&&(r.pxtsnippet.forEach(e=>function(e,t){const n=["label","title","hint","errorMessage"];t[e.label]=e.label,e.questions.forEach(e=>{n.forEach(n=>{e[n]&&(t[e[n]]=e[n])})})}(e,c)),h(c,"-snippet")),s},t.hasBlock=s,t.compareSymbols=a,t.getApiInfo=function(e,t,n=!1){return l(e,t,n).apis},t.internalGetApiInfo=l,t.getFullName=c}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){let i,r,s={fileSystem:{},sourceFiles:[],target:{isNative:!1,hasHex:!1,switches:{}}};class o{constructor(){this.opts=s,this.fileVersions={},this.projectVer=0,this.pxtModulesOK=null}getProjectVersion(){return this.projectVer+""}setFile(e,t){this.opts.fileSystem[e]!=t&&(this.fileVersions[e]=(this.fileVersions[e]||0)+1,this.opts.fileSystem[e]=t,this.projectVer++)}reset(){this.setOpts(s),this.pxtModulesOK=null}setOpts(e){t.Util.iterMap(e.fileSystem,(e,t)=>{this.opts.fileSystem[e]!=t&&(this.fileVersions[e]=(this.fileVersions[e]||0)+1)}),this.opts=Object.assign(Object.assign({},e),{fileSystem:Object.assign({},e.fileSystem)}),this.projectVer++}getCompilationSettings(){return t.getTsCompilerOptions(this.opts)}getScriptFileNames(){return this.opts.sourceFiles.filter(e=>t.U.endsWith(e,".ts"))}getScriptVersion(e){return(this.fileVersions[e]||0).toString()}getScriptSnapshot(t){let n=this.opts.fileSystem[t];return null!=n?e.ScriptSnapshot.fromString(n):null}getNewLine(){return"\n"}getCurrentDirectory(){return"."}getDefaultLibFileName(e){return"no-default-lib.d.ts"}log(e){pxt.log("LOG",e)}trace(e){pxt.log("TRACE",e)}error(e){pxt.error("ERROR",e)}useCaseSensitiveFileNames(){return!0}}function a(e,i){return e?(n.lastLocBlocksInfo||(n.lastLocBlocksInfo=t.getBlocksInfo(e,i)),n.lastLocBlocksInfo):(n.lastBlocksInfo||(n.lastBlocksInfo=t.getBlocksInfo(n.lastApiInfo.apis,i)),n.lastBlocksInfo)}function l(e){return n.lastApiInfo||(n.lastApiInfo=t.internalGetApiInfo(n.service.getProgram(),e.jres)),n.lastApiInfo}function c(e){if(!e.apisInfo){const n=l(e);e.apisInfo=t.U.clone(n.apis)}}function u(e){let t=pxt.U.flatClone(e);return t.fileSystem=pxt.U.flatClone(t.fileSystem),t}n.blocksInfoOp=a,n.getLastApiInfo=l,n.addApiInfo=c,n.cloneCompileOpts=u,n.IsOpErr=function(e){return!!e.errorMessage};const d={reset:()=>{n.service=e.createLanguageService(n.host),n.lastApiInfo=void 0,n.lastGlobalNames=void 0,n.host.reset()},setOptions:e=>{n.host.setOpts(e.options)},syntaxInfo:e=>{var i,r,s;let o=e.fileContent;e.fileContent&&n.host.setFile(e.fileName,e.fileContent);let a=u(n.host.opts);a.fileSystem[e.fileName]=o,c(a),a.syntaxInfo={position:e.position,type:e.infoType};const d=e.fileName.endsWith(".py"),h="symbol"===a.syntaxInfo.type,f="signature"===a.syntaxInfo.type;if(d){let e=t.transpile.pyToTs(a);e.globalNames&&(n.lastGlobalNames=e.globalNames)}else{a.ast=!0,n.host.setOpts(a);p();const r=n.service.getProgram(),s=r.getSourceFile(e.fileName),o=r.getTypeChecker();if(h||f){let r=t.findInnerMostNodeAtPosition(s,e.position);if(r)if(h){const e=o.getSymbolAtLocation(r);if(e){let t=n.getPxtSymbolFromTsSymbol(e,a.apisInfo,o);a.syntaxInfo.symbols=[t],a.syntaxInfo.beginPos=r.getStart(),a.syntaxInfo.endPos=r.getEnd()}}else if(f){const n=null===(i=null==r?void 0:r.pxt)||void 0===i?void 0:i.callInfo;if(n){const i=a.apisInfo.byQName[n.qName];a.syntaxInfo.symbols=[i],a.syntaxInfo.beginPos=r.getStart(),a.syntaxInfo.endPos=r.getEnd();const s=t.getParentCallExpression(r);if(s){const n=t.findCurrentCallArgIdx(s,r,e.position);a.syntaxInfo.auxResult=n}}}}}if(h&&!(null===(r=a.syntaxInfo.symbols)||void 0===r?void 0:r.length)){const i=n.getWordAtPosition(e.fileContent,e.position);if(i)if(d&&"range"===i.text){const e=l(a).apis;e.byQName["_py.range"]&&(a.syntaxInfo.symbols=[e.byQName["_py.range"]],a.syntaxInfo.beginPos=i.start,a.syntaxInfo.endPos=i.end)}else{const e=t.getHelpForKeyword(i.text,d);e&&(a.syntaxInfo.auxResult={documentation:e,displayString:n.displayStringForKeyword(i.text,d)},a.syntaxInfo.beginPos=i.start,a.syntaxInfo.endPos=i.end)}}if(null===(s=a.syntaxInfo.symbols)||void 0===s?void 0:s.length){const e=l(a).apis;d&&(a.syntaxInfo.symbols=a.syntaxInfo.symbols.map(t=>e.byQName[t.qName]||t)),h&&(a.syntaxInfo.auxResult=a.syntaxInfo.symbols.map(t=>n.displayStringForSymbol(t,d,e)))}return a.syntaxInfo},getCompletions:e=>n.getCompletions(e),compile:e=>{n.host.setOpts(e.options);const i=p();return t.timesToMs(i),i},decompile:e=>(n.host.setOpts(e.options),t.decompile(n.service.getProgram(),e.options,e.fileName,!1)),pydecompile:e=>(n.host.setOpts(e.options),t.transpile.tsToPy(n.service.getProgram(),e.fileName)),decompileSnippets:e=>(n.host.setOpts(e.options),t.decompileSnippets(n.service.getProgram(),e.options,!1)),assemble:e=>({words:t.processorInlineAssemble(n.host.opts.target,e.fileContent)}),py2ts:e=>(c(e.options),t.transpile.pyToTs(e.options)),fileDiags:e=>t.patchUpDiagnostics(function(e){if(!/\.ts$/.test(e))return[];let t=n.service.getSyntacticDiagnostics(e);return t&&t.length||(t=n.service.getSemanticDiagnostics(e)),t||(t=[]),t}(e.fileName)),allDiags:()=>{let e=p();return t.timesToMs(e),n.host.opts.target.switches.time&&pxt.log("DIAG-TIME",e.times),e},format:e=>{const n=e.format;return t.format(n.input,n.pos)},apiInfo:()=>{if(n.lastBlocksInfo=void 0,i=void 0,n.host.opts!==s)return n.lastApiInfo=t.internalGetApiInfo(n.service.getProgram(),n.host.opts.jres),n.lastApiInfo.apis},snippet:t=>{const i=t.snippet;if(!n.lastApiInfo)return;const r=n.lastApiInfo.apis.byQName[i.qName],s=n.lastApiInfo.decls[i.qName];if(!r||!s||!e.isFunctionLike(s))return;const o=!!i.python;let l={};l=o&&n.lastGlobalNames?n.lastGlobalNames:n.lastApiInfo.apis.byQName;const{bannedCategories:c,screenSize:u}=t.runtime,{apis:d}=n.lastApiInfo,p={apis:d,blocksInfo:a(d,c),takenNames:l,bannedCategories:c,screenSize:u,checker:n.service&&n.service.getProgram().getTypeChecker(),includeParentSnippet:!0},h=n.getSnippet(p,r,s,o);return n.snippetStringify(h)},blocksInfo:e=>a(e,e.blocks&&e.blocks.bannedCategories),apiSearch:e=>{const t=e.search,r=a(t.localizedApis,e.blocks&&e.blocks.bannedCategories);t.localizedStrings&&pxt.Util.setLocalizedStrings(t.localizedStrings);const s=(e,t,n)=>{if(e)return"string"==typeof e?e:t?e[t]:Object.keys(e).map(t=>e[t]).join(" ")},o=(e,t=!1,n)=>{var i,s,a,l,c;const u=(null===(i=e.attributes)||void 0===i?void 0:i.toolboxParent)||(null===(s=e.attributes)||void 0===s?void 0:s.duplicateWithToolboxParent),d=(null===(a=e.attributes)||void 0===a?void 0:a.toolboxParentArgument)||(null===(l=e.attributes)||void 0===l?void 0:l.duplicateWithToolboxParentArgument);if(u&&!t){const t=r.blocksById[u];if(t){const n=o(e,!0);return o(t,!0,{[d||"*"]:n})}}if(null===(c=e.attributes)||void 0===c?void 0:c._def){let t=[];const i=e.attributes._def,r=pxt.blocks.compileInfo(e);for(let e of i.parts)switch(e.kind){case"label":t.push(e.text);break;case"param":let i=r.definitionNameToParam[e.name],s=(null==i?void 0:i.defaultValue)||e.varName||(null==i?void 0:i.actualName)||e.name;(null==n?void 0:n["*"])?(s=n["*"],delete n["*"]):(null==n?void 0:n[i.definitionName])&&(s=n[i.definitionName]),t.push(s)}return t.join(" ")}return e.attributes.block},l=e=>{var t;const n=null===(t=e.attributes)||void 0===t?void 0:t.paramHelp;return n?Object.keys(n).map(e=>n[e]).join(" "):""},c=e=>{let t=[];return e.parameters&&e.parameters.forEach(n=>{if(n.options&&n.options.fieldEditorOptions){const e=n.options.fieldEditorOptions.value;e&&Array.isArray(e)&&e.forEach(e=>{Array.isArray(e)&&e.length>=2&&("string"==typeof e[0]?t.push(e[0]):"object"==typeof e[0]&&e[0].alt&&t.push(e[0].alt))})}if(n.isEnum&&n.type){const e=r.apis.byQName[n.type];e&&6===e.kind&&Object.keys(r.apis.byQName).forEach(n=>{const i=r.apis.byQName[n];7===i.kind&&i.namespace===e.name&&t.push(i.name)})}const i=r.apis.byQName[n.type];if(i&&i.attributes.fixedInstances){pxt.Util.values(r.apis.byQName).filter(e=>4===e.kind&&e.attributes.fixedInstance&&e.retType===n.type).forEach(e=>{const n=e.attributes.block||e.attributes.blockId||e.name;t.push(n)})}if(e.attributes.constantShim){pxt.Util.values(r.apis.byQName).filter(t=>t.attributes.blockIdentity===e.qName).forEach(e=>{const n=e.attributes.block||e.attributes.blockId||e.name;t.push(n)})}"@combined@"===n.type&&e.combinedProperties&&e.combinedProperties.forEach(e=>{const n=r.apis.byQName[e];if(n){const e=n.attributes.block||n.attributes.blockId||n.name;t.push(e)}})}),t.join(" ")};if(!n.builtinItems){n.builtinItems=[],n.blockDefinitions=pxt.blocks.blockDefinitions();for(const e in n.blockDefinitions){const t=n.blockDefinitions[e];if(t.operators)for(const i in t.operators){t.operators[i].forEach(r=>n.builtinItems.push({id:e,name:t.name,jsdoc:"string"==typeof t.tooltip?t.tooltip:t.tooltip[r],block:r,field:[i,r],builtinBlock:!0}))}else n.builtinItems.push({id:e,name:t.name,jsdoc:s(t.tooltip,t.tooltipSearch),block:s(t.block,t.blockTextSearch),builtinBlock:!0})}}let u;if(!i||t.subset){const e={};let s=[];t.subset&&(n.tbSubset=t.subset,s=n.builtinItems.filter(e=>!!n.tbSubset[e.id])),n.tbSubset?u=r.blocks.filter(e=>!!n.tbSubset[e.attributes.blockId]):(u=r.blocks,s=n.builtinItems);let a=u.map(e=>({id:e.attributes.blockId,qName:e.qName,name:e.name,namespace:e.namespace,block:o(e),params:l(e),jsdoc:e.attributes.jsDoc,localizedCategory:n.tbSubset&&"string"==typeof n.tbSubset[e.attributes.blockId]?n.tbSubset[e.attributes.blockId]:void 0,dropdownOptions:c(e)})),d={};s.forEach(e=>d[e.id]=!0),a=a.filter(e=>!(e.id in d));let p=0;u.forEach(t=>{const n=e[t.qName]=(e=>{const t=e.attributes.weight||50,n=r.apis.byQName[e.namespace];return(1e3*(n&&n.attributes.weight||50)+t)*(n&&n.attributes.advanced||e.attributes.advanced?1:1e6)})(t);p=Math.max(p,n)}),a=a.concat(s);i=new Fuse(a,{shouldSort:!0,threshold:.4,location:0,distance:1e3,maxPatternLength:16,minMatchCharLength:2,findAllMatches:!1,caseSensitive:!1,keys:[{name:"name",weight:.3},{name:"dropdownOptions",weight:.15},{name:"namespace",weight:.1},{name:"localizedCategory",weight:.1},{name:"block",weight:.4375},{name:"params",weight:.0625},{name:"jsdoc",weight:.0625}],sortFn:function(t,n){const i=t.qName?1-e[t.item.qName]/p:1,r=n.qName?1-e[n.item.qName]/p:1;return t.score*(1+i/10)-n.score*(1+r/10)}})}return i.search(t.term).slice(0,7)},projectSearch:e=>{const t=e.projectSearch,n=t.headers;if(!r){r=new Fuse(n,{shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:16,minMatchCharLength:2,findAllMatches:!1,caseSensitive:!1,keys:[{name:"name",weight:.3}]})}return r.search(t.term)},projectSearchClear:()=>{r=void 0}};function p(){c(n.host.opts);const e=t.U.flatClone(n.host.opts.fileSystem);let i=t.runConversionsAndStoreResults(n.host.opts);(null==i?void 0:i.globalNames)&&(n.lastGlobalNames=i.globalNames);const r=n.host.opts.fileSystem;n.host.opts.fileSystem=e;for(let e of Object.keys(r))n.host.setFile(e,r[e]);if(i.fileSystem=t.U.flatClone(r),0==i.diagnostics.length){n.host.opts.skipPxtModulesEmit=!1,n.host.opts.skipPxtModulesTSC=!1;const e=n.host.opts.target.isNative?"native":"js";!n.host.opts.target.switches.noIncr&&n.host.pxtModulesOK&&(n.host.opts.skipPxtModulesTSC=!0,n.host.opts.noEmit?n.host.opts.skipPxtModulesEmit=!0:n.host.opts.target.isNative?n.host.opts.skipPxtModulesEmit=!1:"js"!=n.host.pxtModulesOK||n.host.opts.breakpoints&&!n.host.opts.justMyCode||(n.host.opts.skipPxtModulesEmit=!0));let r=t.compile(n.host.opts,n.service);if(i=Object.assign({sourceMap:i.sourceMap,fileSystem:i.fileSystem},r),(i.needsFullRecompile||(!i.success||i.diagnostics.length)&&n.host.opts.clearIncrBuildAndRetryOnError)&&(pxt.debug("triggering full recompile"),pxt.tickEvent("compile.fullrecompile"),n.host.opts.skipPxtModulesEmit=!1,r=t.compile(n.host.opts,n.service),i=Object.assign({sourceMap:i.sourceMap},r)),i.diagnostics.every(e=>!t.isPxtModulesFilename(e.fileName))&&(n.host.pxtModulesOK=e),i.ast){let e=t.internalGetApiInfo(i.ast);e&&(n.lastApiInfo=e)}}return i}n.runConversionsAndCompileUsingService=p,n.performOperation=function(t,i){n.service||(n.host=new o,n.service=e.createLanguageService(n.host));let r=null;if(d.hasOwnProperty(t))try{r=(0,d[t])(i)||{}}catch(e){r={errorMessage:e.stack}}else r={errorMessage:"No such operation: "+t};return r}}(t.service||(t.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){function i(e){return"object"==typeof e&&void 0!==e.default}function r(e){return"object"==typeof e&&"number"==typeof e.length}function s(e,t=!1){const n={};let a=1;return function e(l){if(i(l)){if(t){if(o(l.default))return e(l.default);const t=s(l.default,!1);let i=n[t];if(i&&!l.isLiteral||(i=a,a++,n[t]=i),t.indexOf(".")>=0&&t.indexOf(" ")<0){let e=t.split(".");return e[e.length-1]="${"+i+":"+e[e.length-1]+"}",e.join(".")}return"${"+i+":"+t+"}"}return e(l.default)}return r(l)?l.map(t=>e(t)).join(""):l}(e)}function o(e){return!!i(e)||!!r(e)&&e.map(o).reduce((e,t)=>e||t,!1)}function a(e){return e.attributes.shim&&"@"==e.attributes.shim[0]||e.attributes.pyConvertToTaggedTemplate}n.snippetStringify=s,n.snippetHasReplacementPoints=o,n.snippetAddsDefinitions=function e(t){return i(t)?t.isDefinition||e(t.default):!!r(t)&&t.map(e).reduce((e,t)=>e||t,!1)},n.getSnippet=function i(r,o,l,c,u=0){var d,p,h;let{apis:f,takenNames:m,blocksInfo:g,screenSize:_,checker:y,parameterOverride:b,includeParentSnippet:v}=r;const T=pxt.py.INDENT,k=c?"python":"typescript";let x,E,S,C=o.namespace,w=!1,I="",A=0;b&&(E=null===(d=Object.keys(b))||void 0===d?void 0:d[0],E&&(S=b[E]));let N=[];if(a(o))return c?`${o.name}(""" """)`:`${o.name}\`\``;let D="";D=l.kind==t.SK.Constructor?K(l.symbol)||l.parent.name.getText():K(l.symbol)||l.name.getText(),c&&(D=t.U.snakify(D));const O=o.attributes;if("TD_ID"===O.shim&&u&&l.parameters.length)return G(l.parameters[0]);const R=o,L=pxt.blocks.compileInfo(R),P=g.blocksById,M=(null===(p=O._def)||void 0===p?void 0:p.parameters.filter(e=>!!L.definitionNameToParam[e.name]).map(e=>L.definitionNameToParam[e.name].actualName))||[],F=l.parameters?l.parameters.filter(e=>!e.initializer&&!e.questionToken||M.indexOf(e.name.getText())>=0):[],B=F.map(G).map(e=>({default:e,isLiteral:!0}));if(R.attributes.block)if(R.attributes.defaultInstance)C=R.attributes.defaultInstance,c&&C&&(C=t.U.snakify(C));else if("variables_get"===(null===(h=L.thisParameter)||void 0===h?void 0:h.shadowBlockId))C=L.thisParameter.defaultValue||L.thisParameter.definitionName,c&&C&&(C=t.U.snakify(C));else if(R.namespace){const e=f.byQName[R.namespace];if(e.attributes.fixedInstances){let n,i=t.Util.values(f.byQName),r=function(e){return i.filter(e=>e.extendsTypes).filter(t=>t.extendsTypes.reduce((t,n)=>t||-1!=n.indexOf(e),!1)).reduce((e,t)=>e.concat(t.extendsTypes),[])},s=i.filter(e=>4===e.kind&&e.attributes.fixedInstance);const o=s.filter(t=>t.retType==e.qName).sort((e,t)=>e.name.localeCompare(t.name));if(o.length)n=o[0];else{n=s.filter(t=>-1!==r(e.qName).indexOf(t.retType)).sort((e,t)=>e.name.localeCompare(t.name))[0]}n?(C=`${z(n)}`,I=n.namespace):I=e.namespace,I&&(w=!0)}else if(1==R.kind||2==R.kind){if(L.thisParameter){let e;L.thisParameter.definitionName&&(e=L.thisParameter.definitionName,e=e[0].toUpperCase()+e.substring(1),e=`my${e}`),C=L.thisParameter.defaultValue||e,c&&C&&(C=t.U.snakify(C))}}else if(8===e.kind)return}const $=O&&(c?O.pySnippet:O.snippet);let U;if($)U=[$],C=void 0;else if(U=[D],(null==B?void 0:B.length)||1==R.kind||3==R.kind||8==R.kind){const e=B.reduce((e,t)=>[...e,e.length?", ":"",t],[]);U=U.concat(["(",...e,")"])}let V=C?[C,".",...U]:U;if(V=w?[function(e){const t=e.indexOf(".");return t<0?e:e.substring(0,t)}(I),".",...V]:V,O&&O.blockSetVariable)if(c){V=[{default:H(t.U.snakify(O.blockSetVariable)),isDefinition:!0}," = ",...V]}else{V=["let ",{default:H(O.blockSetVariable),isDefinition:!0}," = ",...V]}if(v&&R.attributes.toolboxParent&&0===u){S=[N,V],E=R.attributes.toolboxParentArgument,b={[E]:S};const e=P[o.attributes.toolboxParent];return x=i(Object.assign(Object.assign({},r),{parameterOverride:b}),e,n.lastApiInfo.decls[e.qName],c,u+1),x}return[N,V];function H(t){return m[t]?e.pxtc.decompiler.getNewName(t,m,!1):t}function G(a){var l,d;const p=a.type;if(!p)return c?"None":"null";if(S&&a.symbol.escapedName===E)return s(S);const h=a.name.kind===t.SK.Identifier?a.name.text:void 0,m=null===(l=O.paramSnippets)||void 0===l?void 0:l[h];if(m)if(c){if(m.python)return m.python}else if(m.ts)return m.ts;const g=null===(d=null==O?void 0:O.paramDefl)||void 0===d?void 0:d[h];if(g){let e;if(p.kind==t.SK.AnyKeyword){const n=g.toUpperCase();e=Number.isNaN(+n)?"FALSE"==n||"TRUE"==n?t.SK.BooleanKeyword:n.includes(".")?t.SK.EnumKeyword:t.SK.StringKeyword:t.SK.NumberKeyword}if(p.kind===t.SK.StringKeyword||e===t.SK.StringKeyword)return 0!=g.indexOf('"')?`"${g}"`:g;const i=null==y?void 0:y.getTypeAtLocation(a),r=n.getPxtSymbolFromTsSymbol(null==i?void 0:i.symbol,f,y);return(null==r?void 0:r.attributes.fixedInstances)&&c?pxt.Util.snakify(g):c?t.tsSnippetToPySnippet(g,r):g}let b=function(e){var t,n;const i=pxt.blocks.compileInfo(o),r=null===(t=i.parameters)||void 0===t?void 0:t.find(t=>t.actualName===e);if(!(null==r?void 0:r.shadowBlockId))return null;let s=P[r.shadowBlockId];if(!s)return null;const a=null===(n=s.attributes)||void 0===n?void 0:n.paramFieldEditor;if(!a)return null;const l=a[e];if(!l)return null;const c=s.attributes.paramFieldEditorOptions||{};if("sprite"===l)return function(e){const t={initColor:0,initWidth:16,initHeight:16};if(null==e?void 0:e.sizes){const n=e.sizes.split(";"),i=[];for(let e=0;e<n.length;e++){const t=n[e].split(",");if(2!==t.length)continue;let r=parseInt(t[0]),s=parseInt(t[1]);isNaN(r)||isNaN(s)||(r<0&&_&&(r=_.width),s<0&&_&&(s=_.height),i.push([r,s]))}i.length>0&&(t.initWidth=i[0][0],t.initHeight=i[0][1])}return t.initColor=n(null==e?void 0:e.initColor,t.initColor),t.initWidth=n(null==e?void 0:e.initWidth,t.initWidth),t.initHeight=n(null==e?void 0:e.initHeight,t.initHeight),pxt.sprite.imageLiteralFromDimensions(t.initWidth,t.initHeight,t.initColor,k);function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(c[e]);return null}(h);if(b)return b;let v=function(e){let t=(O._shadowOverrides||{})[e];if(!t){const n=pxt.blocks.compileInfo(o);for(const i of n.parameters)if(i.actualName===e){t=i.shadowBlockId;break}}if(!t)return null;let n=P[t];if(!n)return null;if("TD_ID"===n.attributes.shim&&n.parameters.length){let e=n.parameters[0].type;n=f.byQName[e]||n}return n}(h);if(v){let s=n.getTsSymbolFromPxtSymbol(v,a,e.SymbolFlags.Enum);if(s){let e=y.getTypeOfSymbolAtLocation(s,a);if(e){let t=j(e);if(t)return t}}const l=v.attributes;if("KIND_GET"===l.shim&&l.blockId){const e=l.kindNamespace||o.namespace,n=t.Util.values(f.byQName).find(t=>t.namespace===e&&t.attributes.isKind);if(n)return c?n.pyQName:n.qName}if(u<3&&n.lastApiInfo.decls[v.qName]){let e=i(r,v,n.lastApiInfo.decls[v.qName],c,u+1);if(e)return e}}if(p.kind===t.SK.StringKeyword&&"leds"===h)return c?'"""\n. . . . .\n. . . . .\n. . # . .\n. . . . .\n. . . . .\n"""':"`\n. . . . .\n. . . . .\n. . # . .\n. . . . .\n. . . . .\n`";if(p.kind===t.SK.FunctionType){const e=p;let t=y?y.getSignatureFromDeclaration(e):void 0;return t?W(t,!0):q(h)}const T=n.getBasicKindDefault(p.kind,c);if(void 0!==T)return T;let x=y&&y.getTypeAtLocation(a);if(x){let e=j(x);if(e)return e}return c?"None":"null"}function j(i){if(i.symbol&&i.symbol.flags&e.SymbolFlags.Enum){return n.getDefaultEnumValue(i,c)}const r=n.getPxtSymbolFromTsSymbol(i.symbol,f,y);if(t.isObjectType(i)){const t=r&&r.attributes&&(c?r.attributes.pySnippet:r.attributes.snippet);if(t)return t;if(i.objectFlags&e.ObjectFlags.Anonymous){const t=y.getSignaturesOfType(i,e.SignatureKind.Call);return t&&t.length?W(t[0],!1):q()}}if(i.flags&e.TypeFlags.NumberLike)return"0";if(r&&r.attributes.fixedInstances){const e=function(e){return pxt.Util.values(f.byQName).filter(t=>4===t.kind&&t.attributes.fixedInstance&&function(e,t,n){if(t==n)return!0;let i=e.byQName[t];return!(!i||!i.extendsTypes)&&i.extendsTypes.indexOf(n)>=0}(f,t.retType,e.qName))}(r);if(e.length){const t=e[0];return c?t.pyQName:t.qName}}}function K(e){if(y){const n=t.getFullName(y,e),i=f.byQName[n];if(i)return z(i)}}function z(e){return c?e.pyName:e.name}function W(n,i){let r="",o=y.getReturnTypeOfSignature(n);if(o.flags&e.TypeFlags.NumberLike?r="return 0":o.flags&e.TypeFlags.StringLike?r='return ""':o.flags&(e.TypeFlags.Boolean|e.TypeFlags.BooleanLiteral)&&(r=c?"return False":"return false"),c){let o;o=O.optionalVariableArgs?"()":`(${n.parameters.map(e=>e.name).join(", ")})`;let a=D||"fn";A++>0&&(a+=A),i&&!/^on/i.test(a)&&(a="on"+pxt.Util.capitalize(a));const l=F.filter(t=>{const n=y&&y.getTypeAtLocation(t);return!!(n&&n.symbol&&n.symbol.flags&e.SymbolFlags.Enum)}).map(e=>{const t=s(G(e)).toLowerCase(),n=t.lastIndexOf(".");return-1!==n?t.substr(n+1):t}).join("_");return l&&(a+="_"+l),a=t.U.snakify(a),a=H(a),N=[...N,N.length?"\n":"","def ",{default:a,isDefinition:!0},o,`:\n${T}`,{default:r||"pass"},"\n"],{default:a}}{let t="()";if(!O.optionalVariableArgs){let i=e.mapToDisplayParts(t=>{y.getSymbolDisplayBuilder().buildSignatureDisplay(n,t,void 0,e.TypeFormatFlags.UseFullyQualifiedType)}),r=e.displayPartsToString(i);t=r.substr(0,r.lastIndexOf(":"))}return["function",t,` {\n${T}`,{default:r},"\n}"]}}function q(e){return c?(e=e||"fn",e=H(e=t.U.snakify(e)),N=[...N,N.length?"\n":"","def ",{default:e,isDefinition:!0},`():\n${T}`,{default:"pass"},"\n"],{default:e}):"function () {}"}},n.isTaggedTemplate=a}(t.service||(t.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(e){const t=e=>`main.${e}`;e.pyToTs=function(e,n=t("py")){return pxt.py.py2ts(e)},e.tsToPy=function(e,n=t("ts")){return pxt.py.decompileToPython(e,n)}}(e.transpile||(e.transpile={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n;function i(e,t){if(!e)return;const r=t(e);if(r===n.Continue)return i(e.parent,t);if(r===n.Abort)return;if(r===n.Found)return e;return r}function r(t){return i(t,t=>e.isModuleDeclaration(t)?n.Found:n.Continue)}t.getParentCallExpression=function(t){return i(t,t=>e.isCallExpression(t)?n.Found:e.isBlock(t)?n.Abort:n.Continue)},t.findCurrentCallArgIdx=function(e,t,n){let i=e.arguments.map(e=>e===t).indexOf(!0);if(i>=0)return i;if(!(e.arguments.pos<=n&&n<e.end))return-1;if(0===e.arguments.length)return 0;i=0;for(let t of e.arguments){if(!(t.end<=n))break;i++}return e.arguments.hasTrailingComma||(i=Math.max(0,i-1)),i},function(e){e[e.Found=0]="Found",e[e.Continue=1]="Continue",e[e.Abort=2]="Abort"}(n=t.TraverseCheck||(t.TraverseCheck={})),t.traverseUp=i,t.enumMemberToQName=function(e,n){if(n.name.kind===t.SK.Identifier)return e.getFullyQualifiedName(e.getSymbolAtLocation(n.name))},t.findInnerMostNodeAtPosition=function n(i,r){for(let t of i.getChildren()){if(t.kind>=e.SyntaxKind.FirstPunctuation&&t.kind<=e.SyntaxKind.LastPunctuation)continue;let i=t.getStart(),s=t.getEnd();if(i<=r&&r<s)return n(t,r)}return i&&i.kind===t.SK.SourceFile?null:i},t.getParentNamespace=r,t.getCurrentNamespaces=function e(t){if(!t)return[];let n=r(t);if(!n)return[];let i=n.name.getText();return[...e(n.parent),i]},t.getEnumMembers=function(e,n){if(e&&n.symbol&&n.symbol.declarations&&n.symbol.declarations.length)for(let e=0;e<n.symbol.declarations.length;e++){const i=n.symbol.declarations[e];if(i.kind===t.SK.EnumDeclaration){return i.members}}},t.isExported=function(e){if(e.modifiers&&e.modifiers.some(e=>e.kind==t.SK.PrivateKeyword||e.kind==t.SK.ProtectedKeyword))return!1;let n=e.symbol;if(!n)return!1;for(;;){let e=n.parent;if(!e)break;n=e}let i=n.valueDeclaration||n.declarations[0];return i.kind==t.SK.VariableDeclaration&&(i=i.parent.parent),!(!i.parent||i.parent.kind!=t.SK.SourceFile)},t.isReadonly=function(e){return e.modifiers&&e.modifiers.some(e=>e.kind==t.SK.ReadonlyKeyword)}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){const n=e.assembler.emitErr,i=n("opcode name doesn't match","<name>");class r extends e.assembler.Instruction{constructor(e,t,n){super(e,t,n,n,!1)}emit(t){let r=t.words;if(r[0]!=this.name)return i;let s=this.opcode,o=1,a=[],l=null,c=null;for(let i=0;i<this.args.length;++i){let u=this.args[i],d=r[o++];if("$"==u[0]){let i=this.ei.encoders[u],r=null;if(i.isImmediate||i.isLabel){if(!d)return n("expecting number",d);if(d=d.replace(/^#/,""),r=t.bin.parseOneInt(d),null==r)return n("expecting number",d)}else e.oops();if(null==r)return n("didn't understand it",d);e.U.assert(r>=0),11111!=r&&"$lbl"==u&&(r-=t.bin.location()+2,r>>=1),a.push(r);const o=r;if(r=i.encode(r),null==r)return n(`argument (${o}) out of range or mis-aligned`,d);"$i3"==u?r=c|r<<6:"$i5"==u&&(r=c|r<<8),"$i2"==u||"$i4"==u?c=r:"$rt"==u?(11111!=r&&r>4096&&e.U.oops("label: "+d+" v="+r),s=32768|r,"callrt.p"==this.name&&(s|=8192)):t.isLong||r<0||r>255?(t.isLong=!0,"$lbl"==u&&(r-=1),s=r>>9&65535|49152,l=this.opcode+(r<<7)&65535):s=this.opcode+(r<<7)&65535}else if(u!=d)return n("expecting "+u,d)}return r[o]?n("trailing tokens",r[o]):{stack:0,opcode:s,opcode2:l,numArgs:a,labelName:t.bin.normalizeExternalLabel(null)}}}t.VmInstruction=r,t.withPush={},t.opcodes=["stloc     $i1","ldloc     $i1","stfld     $i4, $i5","ldfld     $i4, $i5","newobj    $i1","ldcap     $i1","bitconv   $i1","stglb     $i1","ldglb     $i1","ldint     $i1","ldintneg  $i1","ldspecial $i1","ldnumber  $i1","ldlit     $i1","checkinst $i1","mapget","mapset","ret       $i2, $i3","popmany   $i1","pushmany  $i1","callind   $i1","callproc  $i1","calliface $i2, $i3","callget   $i1","callset   $i1","jmp       $lbl","jmpnz     $lbl","jmpz      $lbl","try       $lbl","push","pop"];class s extends e.assembler.AbstractProcessor{constructor(e){super(),this.addEnc("$i1","#0-8388607",e=>this.inrange(8388607,e,e)),this.addEnc("$i2","#0-31",e=>this.inrange(31,e,e)),this.addEnc("$i3","#0-262143",e=>this.inrange(262143,e,e)),this.addEnc("$i4","#0-255",e=>this.inrange(255,e,e)),this.addEnc("$i5","#0-32767",e=>this.inrange(32767,e,e)),this.addEnc("$lbl","LABEL",e=>this.inminmax(-4194304,4194303,e,e)).isLabel=!0,this.addEnc("$rt","SHIM",e=>this.inrange(8388607,e,e)).isLabel=!0;let n=1,i=!0;for(let e of t.opcodes.concat(["callrt $rt"])){let s=new r(this,e,n);this.instructions[s.name]=[s],(i||"callrt"==s.name)&&(t.withPush[s.name]=!0,s=new r(this,e.replace(/\w+/,e=>e+".p"),64|n),this.instructions[s.name]=[s]),"mapset.p"==s.name&&(i=!1),n++}}testAssembler(){}postProcessRelAddress(e,t){return t}postProcessAbsAddress(e,t){return t}getAddressFromLabel(e,t,n,i=!1){let r=e.lookupLabel(n);return null==r?null:t.is32bit?r:r-(e.pc()+2)}toFnPtr(e,t){return e}wordSize(){return 8}peephole(e,n,i){let r=e.getOp(),s="";if(n){s=n.getOp();let e=r+";"+s,t=this.file.peepCounts;t[e]=(t[e]||0)+1}"stloc"==r&&"ldloc"==s&&e.numArgs[0]==n.numArgs[0]?(/LAST/.test(n.text)&&e.update(""),n.update("")):t.withPush[r]&&"push"==s&&(e.update(e.text.replace(/\w+/,e=>e+".p")),n.update(""))}}t.VmProcessor=s}(e.vm||(e.vm={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){let t;!function(e){e[e.NonLocal=0]="NonLocal",e[e.Global=1]="Global"}(t=e.VarModifier||(e.VarModifier={})),e.isIndex=function(e){return"Index"===e.kind},e.isSubscript=function(e){return"Subscript"===e.kind}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){var n=e.blocks;let i,r,s,o,a,l,c,u,d,p,h=0,f=0,m=0,g="???";function _(e){return null==e}function y(e){return null!=e}function b(t){return e.tickEvent("python.todo.statement",{kind:t.kind}),n.mkStmt(n.mkText("TODO: "+t.kind))}function v(t){return e.tickEvent("python.todo.expression",{kind:t.kind}),n.mkText(" {TODO: "+t.kind+"} ")}const T=L({primType:"string"}),k=L({primType:"number"}),x=L({primType:"boolean"}),E=L({primType:"void"}),S=L({primType:"any"});let C;const w={str:T,string:T,number:k,bool:x,void:E,any:S};function I(e){switch(e){case ts.SyntaxKind.StringKeyword:return T;case ts.SyntaxKind.NumberKeyword:return k;case ts.SyntaxKind.BooleanKeyword:return x;case ts.SyntaxKind.VoidKeyword:return E;case ts.SyntaxKind.AnyKeyword:return S;default:return C}}function A(t){let n=e.U.flatClone(t);return delete n.pyAST,delete n.pyInstanceType,delete n.pyRetType,delete n.pySymbolType,delete n.moduleTypeMarker,delete n.declared,n.parameters&&(n.parameters=n.parameters.map(t=>(delete(t=e.U.flatClone(t)).pyType,t))),n}function N(t){if("("==t[0]&&e.U.endsWith(t,")"))return N(t.slice(1,-1));const n=t.indexOf(" => ");if(n>0){const e=t.slice(n+4);if(-1==e.indexOf(")[]")){const i=N(e),r=t.slice(1,n-1);return M(i,(r?r.split(/, /):[]).map(e=>N(e.replace(/\w+\??: /,""))))}}if(e.U.endsWith(t,"[]"))return P(N(t.slice(0,-2)));if("_py.Array"===t)return P(S);const i=e.U.lookup(w,t);if(i)return i;if(!!t&&!isNaN(t))return k;if("T"==t||"U"==t)return L({primType:"'"+t});if(t.indexOf("|")>=0){return L({primType:"@union",typeArgs:t.split("|").map(e=>e.trim()).map(N)})}let r=O(t+"@type")||O(t);return r?7==r.kind?k:8==r.kind||9==r.kind?r.pyInstanceType||L({classType:r}):6==r.kind?k:(J(null,9502,e.U.lf("'{0}' is not a type near '{1}'",t,g||"???")),L({primType:t})):(J(null,9501,e.U.lf("unknown type '{0}' near '{1}'",t,g||"???")),L({primType:t}))}function D(t){var n;if(!t.pySymbolType){if(g=t.pyQName,t.parameters){pxtc.service.isTaggedTemplate(t)&&(t.parameters=[{name:"literal",description:"",type:"string",options:{}}]);for(let e of t.parameters)e.pyType||(e.pyType=N(e.type))}const i=t.pyRetType;if(_e(t))t.pyRetType=L({moduleType:t});else if(t.retType)if((null===(n=t.qName)||void 0===n?void 0:n.endsWith(".__constructor"))&&"void"===t.retType){const e=R(t.qName.substring(0,t.qName.lastIndexOf(".")));t.pyRetType=e?L({classType:e}):N(t.retType)}else t.pyRetType=N(t.retType);else t.pyRetType||(e.U.oops("no type for: "+t.pyQName),t.pyRetType=L({}));if(i&&ee(t.pyAST,i,t.pyRetType),3==t.kind||1==t.kind){let n=t.parameters.map(e=>e.pyType);if(n.some(_))return J(null,9526,e.U.lf("function symbol is missing parameter types near '{1}'",g||"???")),L({});t.pySymbolType=M(t.pyRetType,n.filter(y))}else t.pySymbolType=t.pyRetType;8!=t.kind&&9!=t.kind||(t.pyInstanceType=L({classType:t})),g=void 0}return t.pySymbolType}function O(t){return e.U.lookup(r,t)||e.U.lookup(i,t)}function R(e){var t;if(!e)return;let n=O(e);if(n)D(n);else if(e.indexOf(".")&&!e.endsWith(".__constructor")){const n=e.substring(0,e.lastIndexOf(".")),i=R(n);if(8===(null==i?void 0:i.kind)&&(null===(t=i.extendsTypes)||void 0===t?void 0:t.length))return R(i.extendsTypes[0]+e.substring(n.length))}return n}function L(t={}){let n=e.U.flatClone(t);return n.tid=++f,n}function P(e){return L({primType:"@array",typeArgs:[e]})}function M(e,t){return L({primType:"@fn"+t.length,typeArgs:[e].concat(t)})}function F(t){return!!e.U.startsWith(t.primType||"","@fn")}function B(t){return!!t.primType&&!e.U.startsWith(t.primType,"@")}function $(t){return!!e.U.startsWith(t.primType||"","@union")}function U(){return s.currFun||s.currClass||s.currModule}function V(){let e=U();for(;e&&e.parent;)e=e.parent;return e}function H(){return"main"==s.currModule.name&&!s.currFun&&!s.currClass}function G(t,n,i){const r=R(n);return r||J(t,9503,e.U.lf("No module named '{0}'",n)),r}function j(e,n,i,r){r||(r=U());let s=r.vars[e],o=null==s?void 0:s.symbol;if(!o){let n=z(r);n&&(n+=".");let a=n+e;o="ClassDef"===r.kind?oe(2,a):!ae(r)||i!==t.VarModifier.Global&&i!==t.VarModifier.NonLocal?ae(r)?se(4,e):oe(4,a):oe(4,e),s={symbol:o,modifier:i},r.vars[e]=s}for(let e of Object.keys(n))o[e]=n[e];return s}function K(e){return e.unifyWith?(e.unifyWith=K(e.unifyWith),e.unifyWith):e}function z(e){let t=e,n="";t.parent&&"FunctionDef"!==t.parent.kind&&"AsyncFunctionDef"!==t.parent.kind&&(n=z(t.parent),n?n+=".":n="");let i=e;return"Module"==e.kind&&"main"==i.name?"":i.name?n+i.name:n+"?"+e.kind}function W(t){let n=e.U.lookup(we,t);if(n)return n;for(let n of e.U.values(s.currModule.vars)){let i=n.symbol;if(i.isImport){if(i.expandsTo==t)return i.pyName||J(null,9553,lf("missing pyName")),i.pyName;if(i.isImport&&e.U.startsWith(t,(i.expandsTo||"")+"."))return i.pyName+t.slice(i.expandsTo.length)}}return t}function q(e){return(e=K(e)).primType?e.typeArgs&&"@array"==e.primType?q(e.typeArgs[0])+"[]":F(e)&&e.typeArgs?"("+e.typeArgs.slice(1).map(e=>"_: "+q(e)).join(", ")+") => "+q(e.typeArgs[0]):$(e)&&e.typeArgs?e.typeArgs.map(q).join(" | "):e.primType+"":e.classType&&e.classType.pyQName?W(e.classType.pyQName)+"":e.moduleType&&e.moduleType.pyQName?W(e.moduleType.pyQName)+"":"any"}function J(e,t,n){l.push(function(e,t,n,i){return e||(e=o),e&&s&&s.currModule?{fileName:a,start:e.startPos,length:e.endPos-e.startPos,line:void 0,column:void 0,code:n,category:t,messageText:i}:{fileName:a,start:0,length:0,line:void 0,column:void 0,code:n,category:t,messageText:i}}(e,pxtc.DiagnosticCategory.Error,t,n))}function Y(e){return e.primType?e.primType:e.classType?e.classType:e.moduleType?(e.moduleType.moduleTypeMarker||(e.moduleType.moduleTypeMarker={}),e.moduleType.moduleTypeMarker):null}function X(e){return!Y(K(e))}function Z(t,n,i){var r;(n=K(n)).classType!=i&&(X(n)?n.classType=i:ee(t,n,(D(r=i),r.pyInstanceType||J(null,9527,e.U.lf("Instance type symbol '{0}' is missing pyInstanceType",r)),r.pyInstanceType)))}function Q(e,t){ee(e,ge(e),t)}function ee(t,n,i){if(n===i)return;if((n=K(n))===(i=K(i))||re(n)||re(i))return;if("any"===n.primType)return void(n.unifyWith=i);const r=Y(n),s=Y(i);if(r&&s)if(r===s){if(n.unifyWith=i,n.typeArgs&&i.typeArgs)for(let e=0;e<Math.min(n.typeArgs.length,i.typeArgs.length);++e)ee(t,n.typeArgs[e],i.typeArgs[e]);n.unifyWith=i}else!function(t,n,i){J(t,9500,e.U.lf("types not compatible: {0} and {1}",q(n),q(i)))}(t,n,i);else r&&!s?ee(t,i,n):(m++,n.unifyWith=i)}function te(e,t){const n=K(e),i=K(t);if(n===i)return!0;const r=Y(n),s=Y(i);if(r===s)return!0;if(r&&s){if(ie(r)&&ie(s)&&r.extendsTypes&&r.extendsTypes.length&&r.extendsTypes.some(e=>e===s.qName))return!0;if($(i)){for(let e of i.typeArgs||[])if(te(n,e))return!0;return!1}}return!1}function ne(e,t){const n=K(ge(e)),i=K(t);te(n,i)||(F(n)||F(i)||B(n)||B(i))&&ee(e,n,i)}function ie(e){return!!(null==e?void 0:e.name)}function re(e){var t;return!!(null===(t=null==e?void 0:e.primType)||void 0===t?void 0:t.startsWith("'"))}function se(e,t){let n=/(.*)\.(.*)/.exec(t),i=n?n[2]:t;return{kind:e,name:i,pyName:i,qName:t,pyQName:t,namespace:n?n[1]:"",attributes:{},pyRetType:L()}}function oe(t,n){let i=r[n];return i?(i.kind=t,i):(i=se(t,n),i.pyQName||J(null,9527,e.U.lf("Symbol '{0}' is missing pyQName",n)),r[i.pyQName]=i,i)}function ae(e){let t=e;for(;t;){if("FunctionDef"==t.kind)return!0;t=t.parent}return!1}function le(t,n,i){if(!n.symInfo){let r=z(n);e.U.endsWith(r,".__init__")&&(r=r.slice(0,-9)+".__constructor"),ae(i=i||U())?n.symInfo=se(t,r):n.symInfo=oe(t,r);const s=n.symInfo;s.pyAST=n,s.pyName||J(null,9528,e.U.lf("Symbol '{0}' is missing pyName",s.qName||s.name)),i.vars[s.pyName]={symbol:s}}return n.symInfo}function ce(t){let n=t.symInfo.qName;return e.U.values(r).filter(e=>e.namespace==n&&2==e.kind)}function ue(t,n,i,r=!1,s=!1){let o;o="__init__"===n?t.pyQName+".__constructor":n.startsWith(t.pyQName+".")?n:t.pyQName+"."+n;let a=R(o);if(a)return a;if(!s)for(let r of t.extendsTypes||[]){let s=R(r);if(s){s==t&&e.U.userError("field lookup loop on: "+s.qName+" / "+n);let r=ue(s,n,i,!0);if(r)return r}}if(!r&&t.pyAST&&"ClassDef"==t.pyAST.kind){let e=oe(2,o);return e.isInstance=!i,e}return null}function de(t,n,i=!1){const r=ge(t),o=function(e){let t=K(e);return[t.classType,...pe(t.primType),t.moduleType].filter(y)}(r);for(let a of o){let o=!!r.moduleType,l=ue(a,n,o,i);if(l)return o?l.isInstance&&J(null,9505,e.U.lf("the field '{0}' of '{1}' is not static",n,a.pyQName)):Ke(t)?l.isProtected=!0:ze(t)&&(s.currClass||J(null,9529,e.U.lf("no class context found for {0}",l.pyQName)),l.namespace!=s.currClass.symInfo.qName&&(l.isProtected=!0)),l}return null}function pe(e){let t=[];return"@array"==e?t=[O("_py.Array"),O("Array")]:"string"==e&&(t=[O("_py.String"),O("String")]),t.filter(e=>!!e)}function he(t){let n=U(),i=e.U.lookup(n.vars,t);if(i)return i;for(;n;){let i=e.U.lookup(n.vars,t);if(i)return i;do{n=n.parent}while(n&&"ClassDef"==n.kind)}return null}function fe(e){if(!e)return null;const t=e.indexOf(".");if(t>0){const n=he(e.slice(0,t)),i=null==n?void 0:n.symbol;i&&i.pyQName!=i.pyName&&(e=i.pyQName+e.slice(t))}else{const t=he(e);if(t)return t}let n=R(e);return n?{symbol:n}:void 0}function me(e){var t;return null===(t=fe(e))||void 0===t?void 0:t.symbol}function ge(e){return e.tsType?K(e.tsType):(e.tsType=L(),e.tsType)}function _e(e){if(!e)return!1;switch(e.kind){case 5:case 9:case 8:case 6:return!0;default:return!1}}function ye(t){const n=e.U.flatClone(s);let i;try{i=t()}finally{s=n}return i}function be(e,t){return 0==t.length?n.mkText(""):n.mkGroup([n.mkText("/* TODO: "+e+" "),n.mkGroup(t),n.mkText(" */"),n.mkNewLine()])}function ve(e){let t=nt(e.value);return e.arg?n.mkInfix(n.mkText(e.arg),"=",t):n.mkGroup([n.mkText("**"),t])}function Te(n){if(!n)return L();let i=Be(n);if(i){let t=O(i+"@type")||O(i);if(t){if(D(t),6==t.kind)return k;if(t.pyInstanceType)return t.pyInstanceType}else if(w[i])return w[i];J(n,9506,e.U.lf("cannot find type '{0}'",i))}else if(t.isSubscript(n)){if("List"===Be(n.value)&&t.isIndex(n.slice)){return P(Te(n.slice.value))}}return J(n,9507,e.U.lf("invalid type syntax")),L({})}function ke(e){return e.pyName&&"_"==e.pyName[0]?e.isProtected?n.mkText("protected "):n.mkText("private "):n.mkText("")}const xe={Sub:1,Div:1,Pow:1,LShift:1,RShift:1,BitOr:1,BitXor:1,BitAnd:1,FloorDiv:1,Mult:1},Ee={Eq:1,NotEq:1,Lt:1,LtE:1,Gt:1,GtE:1},Se={Add:"+",Sub:"-",Mult:"*",MatMult:"Math.matrixMult",Div:"/",Mod:"%",Pow:"**",LShift:"<<",RShift:">>",BitOr:"|",BitXor:"^",BitAnd:"&",FloorDiv:"Math.idiv",And:"&&",Or:"||",Eq:"==",NotEq:"!=",Lt:"<",LtE:"<=",Gt:">",GtE:">=",Is:"===",IsNot:"!==",In:"py.In",NotIn:"py.NotIn"},Ce={Invert:"~",Not:"!",UAdd:"P+",USub:"P-"},we={"adafruit_bus_device.i2c_device.I2CDevice":"pins.I2CDevice"};function Ie(e){s.blockDepth++;const t=n.mkBlock(e.map(it));return s.blockDepth--,t}function Ae(e){e.vars||(e.vars={},e.parent=U(),e.blockDepth=s.blockDepth)}function Ne(e,t=!1){return"any"===q(e)?t?n.mkText(": any"):n.mkText(""):n.mkText(": "+q(e))}function De(t,i){try{return ye(i)}catch(i){return e.log(i),n.mkStmt(be(`conversion failed for ${t.name||t.kind}`,[]))}}function Oe(e){if(!e||!e.pyAST)return!1;if("FunctionDef"!=e.pyAST.kind)return!1;const t=e.pyAST;return!(!t.callers||1!=t.callers.length)&&!t.callers[0].inCalledPosition}function Re(t,i=!1){return De(t,()=>{var r,o,a,l;const c=!!s.currClass&&!s.currFun,u=H(),d=!!s.currFun;Ae(t);const p=me(z(t)),f=le(c?1:3,t);if(!i&&(p&&p.declared===h&&J(t,9520,lf("Duplicate function declaration")),f.declared=h,Oe(f)))return n.mkText("");c&&(f.isInstance=!0),s.currFun=t;let m="",g=t.name;let _=[be("decorators",t.decorator_list.filter(e=>"property"==Be(e)?(m="get",!1):"Attribute"!=e.kind||"setter"!=e.attr||"Name"!=e.value.kind||(g=e.value.id,m="set",!1)).map(nt))];if(t.body.length>=1&&"Raise"==t.body[0].kind&&(t.alwaysThrows=!0),c)if(s.currClass||J(t,9531,lf("method '{0}' is missing current class context",f.pyQName)),f.pyRetType||J(t,9532,lf("method '{0}' is missing a return type",f.pyQName)),"__init__"==t.name)_.push(n.mkText("constructor")),Z(t,f.pyRetType,s.currClass.symInfo);else{if("__get__"==g||"__set__"==g){let e=t.vars.value,n=null==e?void 0:e.symbol;if("__set__"==g&&n){let e=ue(s.currClass.symInfo,"__get__",!1);e&&e.pyAST&&"FunctionDef"==e.pyAST.kind&&ee(t,n.pyRetType,e.pyRetType)}g=g.replace(/_/g,"")}m||(m="_"==g[0]?f.isProtected?"protected":"private":"public",t.symInfo.isStatic&&(m+=" static")),_.push(n.mkText(m+" "),Ue(g))}else e.U.assert(!m),"_"==t.name[0]||u||i||d?_.push(n.mkText("function "),Ue(g)):_.push(n.mkText("export function "),Ue(g));let y="__init__"==t.name?void 0:t.returns?Te(t.returns):f.pyRetType;_.push(function(t,i){var r;const s=t.args;s.kwonlyargs.length&&J(t,9517,e.U.lf("keyword-only arguments not supported yet"));let o=s.args.slice();if(i?"self"!==(null===(r=o[0])||void 0===r?void 0:r.arg)?t.symInfo.isStatic=!0:o.shift():o.some(e=>"self"==e.arg)&&J(t,9519,e.U.lf("non-methods cannot have an argument called 'self'")),!t.symInfo.parameters){let i=s.defaults.length-o.length;t.symInfo.parameters=o.map(r=>{r.annotation||J(t,9519,e.U.lf("Arg '{0}' missing annotation",r.arg));let o=Te(r.annotation),a="";return i>=0&&(a=n.flattenNode([nt(s.defaults[i])]).output,ee(r,o,ge(s.defaults[i]))),i++,{name:r.arg,description:"",type:"",initializer:a,default:a,pyType:o}})}let a=t.symInfo.parameters.map(i=>{let r=j(i.name,{isParam:!0}),s=null==r?void 0:r.symbol;i.pyType||J(t,9530,e.U.lf("parameter '{0}' missing pyType",i.name)),ee(t,D(s),i.pyType);let o=[Ue(i.name),Ne(i.pyType,!0)];return i.default&&o.push(n.mkText(" = "+i.default)),n.mkGroup(o)});return s.vararg&&a.push(n.mkText("TODO *"+s.vararg.arg)),s.kwarg&&a.push(n.mkText("TODO **"+s.kwarg.arg)),n.H.mkParenthesizedExpression(n.mkCommaSep(a))}(t,c),y&&K(y)!=E?Ne(y):n.mkText("")),D(f);let b=t.body.map(it);if("__init__"==t.name){if(s.currClass||J(t,9533,lf("__init__ method '{0}' is missing current class context",f.pyQName)),null===(r=s.currClass)||void 0===r?void 0:r.baseClass){const e=t.body[0],n=s.currClass.baseClass.pyQName+".__constructor";(null===(l=null===(a=null===(o=e.value)||void 0===o?void 0:o.func)||void 0===a?void 0:a.symbolInfo)||void 0===l?void 0:l.pyQName)!==n&&J(t,9575,lf("Sub classes must call 'super().__init__' as the first statement inside an __init__ method"))}for(let e of ce(s.currClass)){let t=e.pyAST;t&&t.value&&b.push(n.mkStmt(n.mkText(`this.${Fe(e.pyName)} = `),nt(t.value)))}}const v=at(t);_.push(n.mkBlock(v.concat(b)));let T=n.mkGroup(_);return i?_[_.length-1].noFinalNewline=!0:T=n.mkStmt(T),T})}const Le={FunctionDef:e=>Re(e),ClassDef:t=>De(t,()=>{Ae(t);const i=le(8,t);e.U.assert(!s.currClass);let r=H();s.currClass=t,t.isNamespace=t.decorator_list.some(e=>"Name"==e.kind&&"namespace"==e.id);let o=t.isNamespace?[n.mkText("namespace "),Ue(t.name)]:[be("keywords",t.keywords.map(ve)),be("decorators",t.decorator_list.map(nt)),n.mkText(r?"class ":"export class "),Ue(t.name)];if(!t.isNamespace&&t.bases.length>0)if("Enum"==Be(t.bases[0]))t.isEnum=!0;else{o.push(n.mkText(" extends ")),o.push(n.mkCommaSep(t.bases.map(nt)));let e=function(e){let t=me($e(e));return t&&t.pyAST&&"ClassDef"==t.pyAST.kind?t.pyAST:null}(t.bases[0]);if(e)t.baseClass=e.symInfo,i.extendsTypes=[e.symInfo.pyQName];else{const e=Be(t.bases[0]);if(e){const n=me(e),r=R(e);t.baseClass=n||r,t.baseClass&&(i.extendsTypes=[t.baseClass.pyQName])}}}const a=t.body.filter(e=>t.isNamespace||"FunctionDef"===e.kind),l=t.isNamespace?[]:t.body.filter(e=>-1===a.indexOf(e)&&"Pass"!==e.kind);let c=Ie(a);o.push(c);let u=!1;if(l.length){u=!0;const e=Ie(l),i=n.mkStmt(n.mkGroup([n.mkText(`public static __init${t.name}() `),e]));c.children.unshift(i)}if(!t.isNamespace){const e=ce(t).map(e=>(e.pyName&&e.pyRetType||J(t,9535,lf("field definition missing py name or return type",e.qName)),e)),i=e.filter(e=>!e.isInstance),r=e.filter(e=>e.isInstance).map(e=>n.mkStmt(ke(e),Ue(e.pyName),Ne(e.pyRetType))),s=i.map(e=>n.mkGroup([n.mkStmt(ke(e),n.mkText("static "),Ue(e.pyName),Ne(e.pyRetType)),ft(Fe(t.name),Fe(e.pyName),q(e.pyRetType))]));c.children=s.concat(r).concat(c.children)}return u&&(o=[n.mkStmt(n.mkGroup(o)),n.mkStmt(n.mkText(`${t.name}.__init${t.name}()`))]),n.mkStmt(n.mkGroup(o))}),Return:e=>{if(e.value){let t=s.currFun;return t&&(t.symInfo.pyRetType||J(e,9536,lf("function '{0}' missing return type",t.symInfo.pyQName)),Q(e.value,t.symInfo.pyRetType)),n.mkStmt(n.mkText("return "),nt(e.value))}return n.mkStmt(n.mkText("return"))},AugAssign:e=>{let t=Se[e.op];return t.length>3?n.mkStmt(n.mkInfix(nt(e.target),"=",n.H.mkCall(t,[nt(e.target),nt(e.value)]))):n.mkStmt(nt(e.target),n.mkText(" "+t+"= "),nt(e.value))},Assign:e=>Pe(e),AnnAssign:e=>Pe(e),For:t=>{if(e.U.assert(0==t.orelse.length),t.target.forTargetEndPos=t.endPos,Ve(t.iter,"range")){let e=t.iter,i=nt(t.target),r=Ue($e(t.target));Q(t.target,k);let s=1==e.args.length?n.mkText("0"):nt(e.args[0]),o=nt(e.args[1==e.args.length?0:1]);if(e.args.length<=2)return n.mkStmt(n.mkText("for ("),n.mkInfix(i,"=",s),n.mkText("; "),n.mkInfix(r,"<",o),n.mkText("; "),n.mkPostfix([r],"++"),n.mkText(")"),Ie(t.body));let a="Num"===e.args[2].kind?e.args[2].n:void 0;if(null==a&&"UnaryOp"===e.args[2].kind){const t=e.args[2];"Num"===t.operand.kind&&("UAdd"===t.op?a=t.operand.n:"USub"===t.op&&(a=-t.operand.n))}if(void 0!==a){const l=a>0?"<":">";return n.mkStmt(n.mkText("for ("),n.mkInfix(i,"=",s),n.mkText("; "),n.mkInfix(r,l,o),n.mkText("; "),n.mkInfix(r,"+=",nt(e.args[2])),n.mkText(")"),Ie(t.body))}}if(h>1){const e=ge(t.target);Q(t.iter,ge(t.iter)==T?e:P(e))}return n.mkStmt(n.mkText("for ("),nt(t.target),n.mkText(" of "),nt(t.iter),n.mkText(")"),Ie(t.body))},While:t=>(e.U.assert(0==t.orelse.length),n.mkStmt(n.mkText("while ("),nt(t.test),n.mkText(")"),Ie(t.body))),If:t=>{let i=t=>{let r=[n.mkText("if ("),nt(t.test),n.mkText(")"),Ie(t.body)];return t.orelse.length&&(r[r.length-1].noFinalNewline=!0,1==t.orelse.length&&"If"==t.orelse[0].kind?(r.push(n.mkText(" else ")),e.U.pushRange(r,i(t.orelse[0]))):r.push(n.mkText(" else"),Ie(t.orelse))),r};return n.mkStmt(n.mkGroup(i(t)))},With:t=>{if(1==t.items.length&&function(e,t){let n=ge(e);return!(!n.classType||n.classType.pyQName!=t)||q(n)==t}(t.items[0].context_expr,"pins.I2CDevice")){let i=t.items[0],r=[],s=nt(i.context_expr);if(i.optional_vars){let e=Be(i.optional_vars);if(e){let o=j(e,{isLocal:!0}),a=null==o?void 0:o.symbol;e=Fe(e),r.push(n.mkStmt(n.mkText("const "+e+" = "),s)),a.pyRetType||J(t,9537,lf("function '{0}' missing return type",a.pyQName)),Q(i.context_expr,a.pyRetType),s=n.mkText(e)}}return r.push(n.mkStmt(n.mkInfix(s,".",n.mkText("begin()")))),e.U.pushRange(r,t.body.map(it)),r.push(n.mkStmt(n.mkInfix(s,".",n.mkText("end()")))),n.mkGroup(r)}let i=[],r=t.items.map((e,t)=>{let r="with"+t;if(e.optional_vars){let t=$e(e.optional_vars);j(t,{isLocal:!0}),r=Fe(t)}return i.push(n.mkStmt(n.mkText(r+".end()"))),n.mkStmt(n.mkText("const "+r+" = "),n.mkInfix(nt(e.context_expr),".",n.mkText("begin()")))});return e.U.pushRange(r,t.body.map(it)),e.U.pushRange(r,i),n.mkBlock(r)},Raise:e=>{let t,i=e.exc||e.cause;if(!i)return n.mkStmt(n.mkText("throw"));if(i&&"Call"==i.kind){let e=i;1==e.args.length&&(t=nt(e.args[0]))}return t||(t=n.mkGroup([n.mkText("`"),nt(i),n.mkText("`")])),n.mkStmt(n.H.mkCall("control.fail",[t]))},Assert:e=>{return e.msg||J(e,9537,lf("assert missing message")),n.mkStmt(n.H.mkCall("control.assert",(t=(t=[e.test,e.msg]).filter(e=>!!e),t.map(nt))));var t},Import:e=>{for(let t of e.names)t.asname&&j(t.asname,{expandsTo:t.name}),G(e,t.name);return n.mkText("")},ImportFrom:e=>{let t=[];for(let i of e.names)if("*"==i.name)e.module||J(e,9538,lf("import missing module name")),j(e.module,{isImportStar:!0});else{let r=e.module+"."+i.name,s=R(r),o=i.asname||i.name;_e(s)?(j(o,{isImport:s,expandsTo:r}),t.push(n.mkStmt(n.mkText(`import ${Fe(o)} = ${r}`)))):j(o,{expandsTo:r})}return n.mkGroup(t)},ExprStmt:e=>{return"Str"==e.value.kind?((t=e.value.s).trim().split(/\n/).length<=1?t=t.trim():t+="\n",n.mkStmt(n.mkText("/** "+t+" */"))):n.mkStmt(nt(e.value));var t},Pass:e=>n.mkStmt(n.mkText("")),Break:e=>n.mkStmt(n.mkText("break")),Continue:e=>n.mkStmt(n.mkText("continue")),Delete:t=>(J(t,9550,e.U.lf("delete statements are unsupported")),b(t)),Try:e=>{let t=[n.mkText("try"),Ie(e.body.concat(e.orelse))];for(let i of e.handlers)t.push(n.mkText("catch ("),i.name?Ue(i.name):n.mkText("_")),i.type&&t.push(n.mkText("/* instanceof "),nt(i.type),n.mkText(" */")),t.push(n.mkText(")"),Ie(i.body));return e.finalbody.length&&t.push(n.mkText("finally"),Ie(e.finalbody)),n.mkStmt(n.mkGroup(t))},AsyncFunctionDef:t=>(J(t,9551,e.U.lf("async function definitions are unsupported")),b(t)),AsyncFor:t=>(J(t,9552,e.U.lf("async for statements are unsupported")),b(t)),AsyncWith:t=>(J(t,9553,e.U.lf("async with statements are unsupported")),b(t)),Global:i=>{const r=V();U();for(const n of i.names){e.U.lookup(r.vars,n)||J(i,9521,e.U.lf("No binding found for global variable"));j(n,{},t.VarModifier.Global).firstRefPos<i.startPos&&J(i,9522,e.U.lf("Variable referenced before global declaration"))}return n.mkStmt(n.mkText(""))},Nonlocal:i=>{const r=V(),s=U();for(const n of i.names){const o=ot(n,s);o&&o!==r&&o.vars[n].modifier!==t.VarModifier.Global||J(i,9523,e.U.lf("No binding found for nonlocal variable"));j(n,{},t.VarModifier.NonLocal).firstRefPos<i.startPos&&J(i,9524,e.U.lf("Variable referenced before nonlocal declaration"))}return n.mkStmt(n.mkText(""))}};function Pe(t){let i,r,o,a;if("Assign"===t.kind){if(1!=t.targets.length)return J(t,9553,e.U.lf("multi-target assignment statements are unsupported")),b(t);a=t.targets[0],o=t.value,i=null,r=null}else{if("AnnAssign"!==t.kind)return t;a=t.target,o=t.value||null,i=t.annotation,r=Te(i),Q(a,r)}let l,c="",u=!!o&&Ve(o,"const"),d=Be(a)||"";if(H()||s.currClass||s.currFun||"_"==d[0]||(c="export "),d&&s.currClass&&!s.currFun){u=!(!o||!s.currClass.isNamespace);let e=ue(s.currClass.symInfo,d,!0);if(e||J(t,9544,lf("cannot get class field")),0==h)return n.mkText("/* skip for now */");e.pyRetType||J(t,9539,lf("function '{0}' missing return type",e.pyQName)),Q(a,e.pyRetType),e.isInstance=!1,s.currClass.isNamespace&&(c=`export ${u?"const":"let"} `)}if(!o)return J(t,9555,e.U.lf("unable to determine value of assignment")),b(t);if(Q(a,ge(o)),u)return j($e(a),{}),/^static /.test(c)||/const/.test(c)||(c+="const "),n.mkStmt(n.mkText(c),n.mkInfix(nt(a),"=",nt(o)));if(!c&&"Tuple"==a.kind)return function(t,i,r){let s=i.elts.filter(e=>"Name"!==e.kind);if(s.length)return J(t,9556,e.U.lf("non-trivial tuple assignment unsupported")),b(t);const o=i.elts.map(Be).map(e=>e?U().vars[e]:void 0);if(o.some(e=>void 0!==(null==e?void 0:e.modifier))){const e=function(){const e=U();return void 0===e.nextHelperVariableId&&(e.nextHelperVariableId=0),"___tempvar"+e.nextHelperVariableId++}(),t=[n.mkStmt(n.mkInfix(n.mkGroup([n.mkText("let "),n.mkText(e)]),"=",nt(r)))];for(let r=0;r<o.length;r++){const s=a(i.elts[r]);t.push(n.mkStmt(n.mkInfix(s,"=",n.mkGroup([n.mkText(e),n.mkText(`[${r}]`)]))))}return n.mkGroup(t)}{let e=[n.mkText("let "),n.mkText("[")],t=i.elts.map(e=>e).map(e=>a(e,!0));return e.push(n.mkCommaSep(t)),e.push(n.mkText("]")),n.mkStmt(n.mkInfix(n.mkGroup(e),"=",nt(r)))}function a(e,t=!1){Je(e,"identifierCompletion"),ge(e);Ze(e);return Me(e,t)}}(t,a,o);if("Name"===a.kind){const e=U().vars[d],t=null==e?void 0:e.symbol;t&&4===t.kind&&void 0===e.modifier&&(void 0===e.firstAssignPos||e.firstAssignPos>a.startPos)&&(e.firstAssignPos=a.startPos,e.firstAssignDepth=s.blockDepth)}if(i&&r&&("NameConstant"===o.kind&&null===o.value||"List"===o.kind&&0===o.elts.length)){const e=q(r);l=n.mkInfix(nt(a),":",n.mkText(e))}return l||(l=nt(a)),n.mkStmt(n.mkText(c),n.mkInfix(l,"=",nt(o)))}function Me(e,t=!1){var i,r;let o=e.id,a=fe(o),l=null==a?void 0:a.symbol,c=U().vars[o],u=null==c?void 0:c.symbol;return void 0===e.isdef&&(!l||4===l.kind&&l!==u?(s.currClass&&!s.currFun?(e.isdef=!1,a=j(o,{})):(e.isdef=!0,a=j(o,{isLocal:!0})),l=a.symbol):e.isdef=!1,e.symbolInfo=l,e.tsType||J(e,9540,lf("definition missing ts type")),l.pyRetType||J(e,9568,lf("missing py return type")),ee(e,e.tsType,l.pyRetType)),e.isdef&&lt(a,U())&&(e.isdef=!1),Qe(a,e),e.isdef&&!t?n.mkGroup([n.mkText("let "),Ue(o)]):!(null==l?void 0:l.namespace)||!(null==l?void 0:l.qName)||(null===(i=s.currClass)||void 0===i?void 0:i.isNamespace)&&(null===(r=s.currClass)||void 0===r?void 0:r.name)===(null==l?void 0:l.namespace)?Ue(o):Ue(l.qName)}function Fe(e){return n.isReservedWord(e)?e+"_":e||e}function Be(e){var t;if("Name"==e.kind){let t=e.id,n=he(t),i=null==n?void 0:n.symbol;if(i){if(i.expandsTo)return i.expandsTo;if(s.currClass&&!s.currFun&&!(null==n?void 0:n.modifier)&&i.qName)return i.qName}return t}if("Attribute"==e.kind){let t=Be(e.value);if(t)return t+"."+e.attr}if(Ke(e)&&(null===(t=s.currClass)||void 0===t?void 0:t.baseClass))return s.currClass.baseClass.qName}function $e(e){let t=Be(e);return t||J(null,9542,lf("Cannot get name of unknown expression kind '{0}'",e.kind)),t}function Ue(e){return"self"==e?n.mkText("this"):n.mkText(Fe(e))}function Ve(e,t){if("Call"!=e.kind)return!1;return Be(e.func)===t}function He(t,i,r){let s=Se[i];return e.U.assert(!!s),s.length>3?n.H.mkCall(s,[t,r]):n.mkInfix(t,s,r)}const Ge={memoryview:{n:"",t:C},const:{n:"",t:k},"micropython.const":{n:"",t:k}};const je=function(){let e={};return Object.keys(pxtc.ts2PyFunNameMap).forEach(t=>{let n=pxtc.ts2PyFunNameMap[t];if(n&&n.n){let i={n:t,t:I(n.t),scale:n.scale};e[n.n]=i}}),Object.keys(Ge).forEach(t=>{e[t]=Ge[t]}),e}();function Ke(e){return Ve(e,"super")&&0==e.args.length}function ze(e){return"Name"==e.kind&&"self"==e.id}function We(e){return e.type==n.NT.Prefix&&'"'==e.op[0]?n.mkText(n.backtickLit(JSON.parse(e.op))):e}function qe(e){return u&&e.startPos<=u.position&&u.position<=e.endPos}function Je(e,t){h>100&&u&&null==d&&(u.type==t||"symbol"==u.type)&&qe(e)&&(d=e,p=U())}function Ye(e,t){if(t&&t.pyAST&&"FunctionDef"==t.pyAST.kind){let n=t.pyAST;n.callers||(n.callers=[]),n.callers.indexOf(e)<0&&n.callers.push(e)}}const Xe={BoolOp:e=>{let t=nt(e.values[0]);for(let n=1;n<e.values.length;++n)t=He(t,e.op,nt(e.values[n]));return t},BinOp:e=>{let t=function(e){if("Mod"==e.op&&"Str"==e.left.kind&&("Tuple"==e.right.kind||"List"==e.right.kind)){let t=e.left.s,i=e.right.elts;i=i.slice();let r=[n.mkText("`")];return t.replace(/([^%]+)|(%[\d\.]*([a-zA-Z%]))/g,(e,t,s,o)=>{if(t)r.push(n.mkText(t.replace(/[`\\$]/g,e=>"\\"+e)));else{let e=i.shift(),t=e?nt(e):n.mkText("???");r.push(n.mkText("${"),t,n.mkText("}"))}return""}),r.push(n.mkText("`")),n.mkGroup(r)}return null}(e);if(t)return t;const i=nt(e.left),r=nt(e.right);return dt(e.left)&&dt(e.right)&&"Add"===e.op?n.H.extensionCall("concat",[i,r],!1):(t=He(i,e.op,r),xe[e.op]&&(Q(e.left,k),Q(e.right,k),e.tsType||J(e,9570,lf("binary op missing ts type")),ee(e,e.tsType,k)),t)},UnaryOp:t=>{let i=Ce[t.op];return"Not"!==t.op?(Q(t,k),Q(t.operand,k)):Q(t,x),e.U.assert(!!i),n.mkInfix(null,i,nt(t.operand))},Lambda:t=>(J(t,9574,e.U.lf("lambda expressions are not supported yet")),v(t)),IfExp:e=>n.mkInfix(n.mkInfix(nt(e.test),"?",nt(e.body)),":",nt(e.orelse)),Dict:e=>{s.blockDepth++;const t=e.keys.map((t,i)=>{const r=e.values[i];return void 0===t?v(e):n.mkStmt(n.mkInfix(nt(t),":",nt(r)),n.mkText(","))}),i=n.mkBlock(t);return s.blockDepth--,i},Set:e=>v(e),ListComp:e=>v(e),SetComp:e=>v(e),DictComp:e=>v(e),GeneratorExp:e=>{if(1==e.generators.length&&"Comprehension"==e.generators[0].kind){let t=e.generators[0];if(0==t.ifs.length)return ye(()=>{let i=$e(t.target);return j(i,{isParam:!0}),n.mkInfix(nt(t.iter),".",n.H.mkCall("map",[n.mkGroup([Ue(i),n.mkText(" => "),nt(e.elt)])]))})}return v(e)},Await:e=>v(e),Yield:e=>v(e),YieldFrom:e=>v(e),Compare:e=>{if(1==e.ops.length&&("In"==e.ops[0]||"NotIn"==e.ops[0])){K(ge(e.comparators[0]))==T&&Q(e.left,T);let t=n.mkInfix(nt(e.comparators[0]),".",n.H.mkCall("indexOf",[nt(e.left)]));return n.mkInfix(t,"In"==e.ops[0]?">=":"<",n.mkText("0"))}let t=nt(e.left),i=nt(e.comparators[0]);const r=(e,r,s)=>{Ee[e]&&pt(r)&&pt(s)&&n.flattenNode([t])!==n.flattenNode([i])&&(t=n.H.mkParenthesizedExpression(n.mkGroup([t,n.mkText(" as any")])),i=n.H.mkParenthesizedExpression(n.mkGroup([i,n.mkText(" as any")])))};r(e.ops[0],e.left,e.comparators[0]);let s=He(t,e.ops[0],i);for(let n=1;n<e.ops.length;++n)t=nt(e.comparators[n-1]),i=nt(e.comparators[n]),r(e.ops[n],e.comparators[n-1],e.comparators[n]),s=He(s,"And",He(t,e.ops[n],i));return s},Call:t=>{var i,r,o,a,l;t.func.inCalledPosition=!0;let c,h,f=Be(t.func),m=me(f),g=m&&8==m.kind,_=m,y="";if(g)_=me(m.pyQName+".__constructor"),_||(_=le(3,ht(null==m?void 0:m.pyAST)));else if("Attribute"==t.func.kind){let e=t.func;h=e.value,c=ge(h),(c.classType||c.primType)&&(y=e.attr,_=de(h,y,!0),_&&(y=_.name))}let b=t.args.slice();if("super"==f&&0==b.length)return s.currClass&&s.currClass.baseClass&&(t.tsType||J(t,9543,lf("call expr missing ts type")),Z(t,t.tsType,s.currClass.baseClass)),n.mkText("super");if(Ve(t,"int")&&1===b.length&&b[0]){const e=b[0],t=nt(e),i=ge(e);if("string"===i.primType)return n.mkGroup([n.mkText("parseInt"),n.mkText("("),t,n.mkText(")")]);if("number"===i.primType)return n.mkGroup([n.mkInfix(n.mkText("Math"),".",n.mkText("trunc")),n.mkText("("),t,n.mkText(")")])}if(!_){let t=e.U.lookup(je,f);if(t&&(y=""),y&&(f=q(c)+"."+y,t=e.U.lookup(je,f),t||"@array"!=Y(K(c))||(f="Array."+y,t=e.U.lookup(je,f))),y="",t)if("."==t.n[0]&&b.length){if(h=b.shift(),c=ge(h),y=t.n.slice(1),_=de(h,y),_&&2==_.kind)return n.mkInfix(nt(h),".",n.mkText(y))}else _=R(t.n)}if(Ve(t,"str"))return ee(t,t.tsType,T),n.mkInfix(n.mkText('""'),"+",nt(t.args[0]));const v="Attribute"===t.func.kind&&Ke(t.func.value);!_&&v&&(_=R(f));const k="__init__"===(null===(i=s.currFun)||void 0===i?void 0:i.name)&&"__constructor"===(null==_?void 0:_.name)&&(null===(o=null===(r=s.currClass)||void 0===r?void 0:r.baseClass)||void 0===o?void 0:o.pyQName)===(null==_?void 0:_.namespace)&&v;k&&(_=me((null===(l=null===(a=s.currClass)||void 0===a?void 0:a.baseClass)||void 0===l?void 0:l.pyQName)+".__constructor")),_||J(t,9508,e.U.lf("can't find called function '{0}'",f));let x,E=_?_.parameters:null,C=[];if(E){for(b.length>E.length&&J(t,9510,e.U.lf("too many arguments in call to '{0}'",_.pyQName));b.length<E.length;)b.push(null);b=b.slice(0,E.length);for(let n of t.keywords){let t=E.findIndex(e=>e.name==n.arg);t<0?J(n,9511,e.U.lf("'{0}' doesn't have argument named '{1}'",_.pyQName,n.arg)):null!=b[t]?J(n,9512,e.U.lf("argument '{0} already specified in call to '{1}'",n.arg,_.pyQName)):b[t]=n.value}for(let e=b.length-1;e>=0&&(E[e].initializer&&null==b[e]);e--)b.pop();for(let i=0;i<b.length;++i){let r=b[i];if(null!=r||E[i].initializer)if(r){E[i].pyType||J(t,9545,lf("formal arg missing py type"));const e=E[i].pyType;"any"!==e.primType&&ne(r,e),"Name"==r.kind&&Oe(r.symbolInfo)?C.push(Re(r.symbolInfo.pyAST,!0)):C.push(nt(r))}else E[i].initializer||J(t,9547,lf("formal arg missing initializer")),C.push(n.mkText(E[i].initializer));else J(t,9513,e.U.lf("missing argument '{0}' in call to '{1}'",E[i].name,_.pyQName)),C.push(n.mkText("null"))}}else _&&J(t,9509,e.U.lf("calling non-function")),C=b.map(nt);if(!d&&u&&"signature"==u.type&&qe(t)){d=t,p=U(),u.auxResult=0;for(let e=0;e<b.length;++e){u.auxResult=e;let t=b[e];if(!t)break;if(t.startPos<=u.position&&u.position<=t.endPos)break}}if(_)if(_.pyRetType||J(t,9549,lf("function missing pyRetType")),h&&dt(h)&&c?function(e,t,n){switch(t.qName){case"Array.pop":case"Array.removeAt":case"Array.shift":case"Array.find":case"Array.get":case"Array._pickRandom":Q(e,n.typeArgs[0]);break;case"Array.concat":case"Array.slice":case"Array.filter":case"Array.fill":Q(e,n);break;case"Array.reduce":if("Call"===e.kind&&e.args.length>1){const t=ge(e.args[1]);t&&Q(e,t)}break;case"Array.map":Q(e,P(S));break;default:Q(e,t.pyRetType)}}(t,_,c):Q(t,_.pyRetType),t.symbolInfo=_,_.attributes.py2tsOverride){const e=function(e){const t=new RegExp(/([^\$]*\()?([^\$\(]*)\$(\d)(?:(?:(?:=(\d+|'[a-zA-Z0-9_]*'|false|true|null|undefined))|(\?)|))/,"y"),n=[];let i,r=0;do{r=t.lastIndex,i=t.exec(e),i&&(i[1]&&n.push({kind:"text",text:i[1]}),n.push({kind:"arg",prefix:i[2],index:parseInt(i[3]),default:i[4],isOptional:!!i[5]}))}while(i);null!=r?n.push({kind:"text",text:e.substr(r)}):n.push({kind:"text",text:e});return{parts:n}}(_.attributes.py2tsOverride);if(e){y&&!h&&J(t,9550,lf("missing recv"));let i=function(e,t,i){const r=[];for(const i of e.parts)if("text"===i.kind)r.push(n.mkText(i.text));else if(t[i.index]||i.default)i.prefix&&r.push(n.mkText(i.prefix)),t[i.index]?r.push(t[i.index]):r.push(n.mkText(i.default));else if(!i.isOptional)return;if(i)return n.mkInfix(i,".",n.mkGroup(r));return n.mkGroup(r)}(e,C,y?nt(h):void 0);return i||J(t,9555,lf("buildOverride failed unexpectedly")),i}}else if(_.attributes.pyHelper)return n.mkGroup([n.mkInfix(n.mkText("_py"),".",n.mkText(_.attributes.pyHelper)),n.mkText("("),n.mkCommaSep(h?[nt(h)].concat(C):C),n.mkText(")")]);k?x=n.mkText("super"):y?(x=n.mkInfix(nt(h),".",n.mkText(y)),Je(t.func,"memberCompletion")):x=nt(t.func);let w=[x,n.mkText("("),n.mkCommaSep(C),n.mkText(")")];return _&&1==C.length&&pxtc.service.isTaggedTemplate(_)&&(w=[x,We(C[0])]),g&&(m&&m.pyQName||J(t,9551,lf("missing namedSymbol or pyQName")),w[0]=n.mkText(W(m.pyQName)),w.unshift(n.mkText("new "))),n.mkGroup(w)},Num:e=>(e.tsType||J(e,9556,lf("tsType missing")),ee(e,e.tsType,k),n.mkText(e.ns)),Str:e=>(e.tsType||J(e,9557,lf("tsType missing")),ee(e,e.tsType,T),n.mkText(n.stringLit(e.s))),FormattedValue:e=>v(e),JoinedStr:e=>v(e),Bytes:t=>n.mkText(`hex\`${e.U.toHex(new Uint8Array(t.s))}\``),NameConstant:e=>(null!==e.value&&(e.tsType||J(e,9558,lf("tsType missing")),ee(e,e.tsType,x)),n.mkText(JSON.stringify(e.value))),Ellipsis:e=>v(e),Constant:e=>v(e),Attribute:t=>{let i=nt(t.value),r=ge(t.value),s=de(t.value,t.attr),o=t.attr;if(Je(t,"memberCompletion"),s)t.symbolInfo=s,Ye(t,s),t.tsType&&s.pyRetType||J(t,9559,lf("tsType or pyRetType missing")),ee(t,t.tsType,s.pyRetType),o=s.name;else if(r.moduleType){let n=R(r.moduleType.pyQName+"."+t.attr);n?(t.symbolInfo=n,Ye(t,n),Q(t,D(n)),o=n.name):J(t,9514,e.U.lf("module '{0}' has no attribute '{1}'",r.moduleType.pyQName,t.attr))}else h>2&&J(t,9515,e.U.lf("unknown object type; cannot lookup attribute '{0}'",t.attr));return n.mkInfix(i,".",n.mkText(Fe(o)))},Subscript:e=>{if("Index"==e.slice.kind){const t=K(ge(e.value));if(dt(e.value)){Q(e,t.typeArgs[0])}else"string"===t.primType?Q(e,t):h>2&&X(ge(e))&&Q(e,S);let i=e.slice.value;return h>2&&X(ge(i))&&Q(i,k),n.mkGroup([nt(e.value),n.mkText("["),nt(i),n.mkText("]")])}if("Slice"==e.slice.kind){const t=ge(e.value);Q(e,t);let i=e.slice;if(i.step){const r="string"===(null==t?void 0:t.primType);return n.H.mkCall(r?"_py.stringSlice":"_py.slice",[nt(e.value),i.lower?nt(i.lower):n.mkText("null"),i.upper?nt(i.upper):n.mkText("null"),nt(i.step)])}return n.mkInfix(nt(e.value),".",n.H.mkCall("slice",[i.lower?nt(i.lower):n.mkText("0"),i.upper?nt(i.upper):null].filter(y)))}return v(e)},Starred:e=>n.mkGroup([n.mkText("... "),nt(e.value)]),Name:e=>{if(Je(e,"identifierCompletion"),"self"==e.id&&s.currClass)return e.tsType||J(e,9560,lf("missing tsType")),Z(e,e.tsType,s.currClass.symInfo),n.mkText("this");let t=Ze(e),i=null==t?void 0:t.symbol;if(i&&i.isImport)return Ue(i.name);if(Qe(t,e),e.ctx.indexOf("Load")>=0){if(!i)return Ue($e(e));if(!(null==i?void 0:i.qName))return J(e,9561,lf("missing qName")),Ue("unknown");return Ue(i.qName.replace("@type",""))}return Me(e)},List:et,Tuple:et};function Ze(t){let n=fe(t.id),i=null==n?void 0:n.symbol;if(!n){let i=e.U.lookup(je,t.id);i&&(n=fe(i.n))}if(n&&i){if(t.symbolInfo=i,t.tsType||J(t,9562,lf("missing tsType")),ee(t,t.tsType,D(i)),i.isImport)return n;Ye(t,i),t.forTargetEndPos&&n.forVariableEndPos!==t.forTargetEndPos&&(n.forVariableEndPos?n.lastRefPos=n.forVariableEndPos+1:n.forVariableEndPos=t.forTargetEndPos)}else h>0&&J(t,9516,e.U.lf("name '{0}' is not defined",t.id));return n}function Qe(e,n){if(e){if(e.modifier===t.VarModifier.Global){const t=V();t&&t.vars[e.symbol.name]&&(e=t.vars[e.symbol.name])}else if(e.modifier===t.VarModifier.NonLocal){const t=ot(e.symbol.name,U());t&&(e=t.vars[e.symbol.name])}(void 0===e.firstRefPos||e.firstRefPos>n.startPos)&&(e.firstRefPos=n.startPos),(void 0===e.lastRefPos||e.lastRefPos<n.startPos)&&(e.lastRefPos=n.startPos)}}function et(e){return e.tsType||J(e,9563,lf("missing tsType")),ee(e,e.tsType,P(e.elts[0]?ge(e.elts[0]):L())),n.mkGroup([n.mkText("["),n.mkCommaSep(e.elts.map(nt)),n.mkText("]")])}function tt(e){return`${e.startPos}:${e.endPos}`}function nt(t){o=t;let n=Xe[t.kind];n||e.U.oops(t.kind+" - unknown expr"),ge(t);const i=n(t);return i.id=tt(t),i}function it(t){o=t;let i=Le[t.kind];i||e.U.oops(t.kind+" - unknown stmt");let r=(t._comments||[]).map(e=>e.value),s=i(t);return r.length&&(s=n.mkGroup(r.map(e=>n.mkStmt(n.H.mkComment(e))).concat(s))),s.id=tt(t),s}function rt(e){return!e||(e.type==n.NT.Prefix&&""==e.op?e.children.every(rt):e.type==n.NT.NewLine)}function st(e){const t=Ue(e.name),i=q(D(e));return n.mkStmt(n.mkGroup([n.mkText("let "),t,n.mkText(": "+i+";")]))}function ot(e,n){if(!n)return;const i=n.vars&&n.vars[e];return i&&i.modifier!=t.VarModifier.NonLocal?n:ot(e,n.parent)}function at(e){const t=[];let n;for(const i of Object.keys(e.vars))n=e.vars[i],lt(n,e)&&t.push(st(null==n?void 0:n.symbol));return t}function lt(e,t){let n=4===e.symbol.kind&&!e.symbol.isParam&&void 0===e.modifier&&(e.lastRefPos>e.forVariableEndPos||e.firstRefPos<e.firstAssignPos||e.firstAssignDepth>t.blockDepth)&&!(function(e){return"Module"===e.kind&&"main"===e.name}(t)&&0===e.firstAssignDepth);return!!n}function ct(t){if(e.U.assert("Module"==t.kind),t.tsBody)return;var i;s={currClass:void 0,currFun:void 0,currModule:i=t,blockDepth:0},a=i.tsFilename.replace(/\.ts$/,".py"),t.vars||(t.vars={});let r=at(t).concat(t.body.map(it));return r.every(rt)?void 0:"main"==t.name?r:[n.mkText("namespace "+t.name+" "),n.mkBlock(r)]}function ut(e){h=e,l=[],m=0,o=void 0}function dt(e){const t=K(ge(e));return t&&"@array"===t.primType}function pt(e){switch(e.kind){case"Num":case"Str":return!0;case"NameConstant":return null!==e.value}return!1}function ht(e,t=e.symInfo){var n;const i=O(t.pyQName+".__constructor");if(!i&&(null===(n=t.extendsTypes)||void 0===n?void 0:n.length)){const n=me(t.extendsTypes[0])||R(t.extendsTypes[0]);if(n)return ht(e,n)}const r={kind:"FunctionDef",name:"__init__",startPos:e.startPos,endPos:e.endPos,parent:e,body:[],args:{kind:"Arguments",startPos:0,endPos:0,args:[{startPos:0,endPos:0,kind:"Arg",arg:"self"}],kw_defaults:[],kwonlyargs:[],defaults:[]},decorator_list:[],vars:{},symInfo:se(3,e.symInfo.qName+".__constructor")};return r.symInfo.parameters=[],r.symInfo.pyRetType=L({classType:e.symInfo}),i&&(r.args.args.push(...i.parameters.map(e=>({startPos:0,endPos:0,kind:"Arg",arg:e.name}))),r.symInfo.parameters.push(...i.parameters.map(e=>{if(e.pyType)return e;return Object.assign(Object.assign({},e),{pyType:N(e.type)})}))),r}function ft(e,t,i){const r=`___${t}_is_set`,s=`___${t}`;return n.mkStmt(n.mkStmt(n.mkText(`private ${r}: boolean`)),n.mkStmt(n.mkText(`private ${s}: ${i}`)),n.mkStmt(n.mkText(`get ${t}(): ${i}`),n.mkBlock([n.mkText(`return this.${r} ? this.${s} : ${e}.${t}`)])),n.mkStmt(n.mkText(`set ${t}(value: ${i})`),n.mkBlock([n.mkStmt(n.mkText(`this.${r} = true`)),n.mkStmt(n.mkText(`this.${s} = value`))])))}t.py2ts=function(s){let o=[];const h={};l=[],e.U.assert(!!s.sourceFiles,"missing sourceFiles! Cannot convert py to ts");let f=s.sourceFiles.filter(t=>e.U.endsWith(t,".py"));if(0==f.length)return{outfiles:h,diagnostics:l,success:0===l.length,sourceMap:[]};let g=(e,t)=>e.substr(0,e.length-t.length),_=e.U.toDictionary(f,e=>g(e,".py")),y=s.sourceFiles.filter(t=>e.U.endsWith(t,".ts")).filter(e=>g(e,".ts")in _);e.U.assert(!!s.apisInfo,"missing apisInfo! Cannot convert py to ts"),a=f[0],function(t,n){r={},i={};let s=e.U.toDictionary(n,e=>e);for(let n of e.U.values(t.byQName)){if(s.hasOwnProperty(n.fileName))continue;let t=n;t.extendsTypes&&(t.extendsTypes=t.extendsTypes.filter(e=>e!=t.qName)),t.pyQName&&t.qName||J(null,9526,e.U.lf("Symbol '{0}' is missing qName for '{1}'",t.name,t.pyQName?"ts":"py")),i[t.pyQName]=t,i[t.qName]=t}C=N("Buffer")}(s.apisInfo,y),c=s,u=void 0,s.generatedFiles||(s.generatedFiles=[]);for(const w of f){let I=w,D=w.replace(/\.py$/,"").replace(/.*\//,""),O=s.fileSystem[w];try{a=w;let R=e.py.lex(O),L=e.py.parse(O,I,R);e.U.pushRange(l,L.diagnostics),o.push({kind:"Module",body:L.stmts,blockDepth:0,name:D,source:O,tsFilename:I.replace(/\.py$/,".ts")})}catch(P){e.log("Parse error",P)}}const b=l;for(let M=0;M<5;++M){ut(M);for(let F of o)try{ct(F)}catch(B){e.log("Conv pass error",B)}if(0==m)break}ut(1e3),d=void 0,u=s.syntaxInfo||{position:0,type:"symbol"};let v=[];for(let $ of o)try{let U=ct($);if(!U)continue;let V=n.flattenNode(U);function H(e){let t=e.id.split(":");if(2!=t.length)return;let n=t.map(e=>parseInt(e));return{py:{startPos:n[0],endPos:n[1]},ts:{startPos:e.startPos,endPos:e.endPos}}}s.sourceFiles.push($.tsFilename),s.generatedFiles.push($.tsFilename),s.fileSystem[$.tsFilename]=V.output,h[$.tsFilename]=V.output,v=V.sourceMap.map(H).filter(e=>!!e)}catch(G){e.log("Conv error",G)}l=b.concat(l);let T={};const k=e.U.values(i).concat(e.U.values(r));let x=[];const E=e=>{if((e=>{switch(e.kind){case 6:case 7:case 4:case 3:case 5:return!0;case 2:case 1:return!e.isInstance;default:return!1}})(e)&&x.indexOf(e)<0){let t=A(e);T[t.qName||t.name]=t}};for(let j=p;j;j=j.parent)j&&j.vars&&e.U.values(j.vars).map(e=>e.symbol).forEach(E);if(k.forEach(E),u&&d){if(u.beginPos=d.startPos,u.endPos=d.endPos,u.symbols||(u.symbols=[]),x=u.symbols.slice(),"memberCompletion"==u.type&&"Attribute"==d.kind){const K=ge(d.value);if(K.moduleType)for(let z of k)z.isInstance||z.namespace!=K.moduleType.qName||u.symbols.push(z);else if(K.classType||K.primType){const W=K.classType||pe(K.primType).reduce((e,t)=>e||t,null);if(W){W.extendsTypes&&W.qName||J(null,9567,lf("missing extendsTypes or qName"));let q=W.extendsTypes.concat(W.qName);for(let Y of k)Y.isInstance&&q.indexOf(Y.namespace)>=0&&u.symbols.push(Y)}}}else if("identifierCompletion"==u.type)u.symbols=e.U.values(T);else{let X=d.symbolInfo;X&&u.symbols.push(X)}u.symbols=u.symbols.map(A)}let S=function(){for(let e of l)t.patchPosition(e,s.fileSystem[e.fileName]);return l}();return{outfiles:h,success:0===S.length,diagnostics:S,syntaxInfo:u,globalNames:T,sourceMap:v}}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){let n;!function(e){e[e.Id=0]="Id",e[e.Op=1]="Op",e[e.Keyword=2]="Keyword",e[e.Number=3]="Number",e[e.String=4]="String",e[e.NewLine=5]="NewLine",e[e.Comment=6]="Comment",e[e.Indent=7]="Indent",e[e.Dedent=8]="Dedent",e[e.EOF=9]="EOF",e[e.Error=10]="Error"}(n=t.TokenType||(t.TokenType={})),t.keywords={False:!0,None:!0,True:!0,and:!0,as:!0,assert:!0,async:!0,await:!0,break:!0,class:!0,continue:!0,def:!0,del:!0,elif:!0,else:!0,except:!0,finally:!0,for:!0,from:!0,global:!0,if:!0,import:!0,in:!0,is:!0,lambda:!0,nonlocal:!0,not:!0,or:!0,pass:!0,raise:!0,return:!0,try:!0,while:!0,with:!0,yield:!0};let i,r,s=[];const o={"%":"Mod","&":"BitAnd","*":"Mult","**":"Pow","+":"Add","-":"Sub","/":"Div","//":"FloorDiv","<<":"LShift",">>":"RShift","@":"MatMult","^":"BitXor","|":"BitOr"},a={"!":"Bang","!=":"NotEq","(":"LParen",")":"RParen",",":"Comma","->":"Arrow",".":"Dot",":":"Colon",";":"Semicolon","<":"Lt","<=":"LtE","=":"Assign","==":"Eq",">":"Gt",">=":"GtE","[":"LSquare","]":"RSquare","{":"LBracket","}":"RBracket","~":"Invert"},l={b:/^[_0-1]$/,B:/^[_0-1]$/,o:/^[_0-7]$/,O:/^[_0-7]$/,x:/^[_0-9a-fA-F]$/,X:/^[_0-9a-fA-F]$/},c={b:2,B:2,o:8,O:8,x:16,X:16};let u,d,p=0,h=0;function f(e,t){let n=0,i=0;for(let r=0;r<e;++r)10==t.charCodeAt(r)&&(n++,i=r);return{line:n,column:e-i-1}}function m(e){switch(e.type){case n.Id:return`id(${e.value})`;case n.Op:return"'"+r[e.value]+"'";case n.Keyword:return e.value;case n.Number:return`num(${e.value})`;case n.String:return e.stringPrefix+JSON.stringify(e.value);case n.NewLine:return"<nl>";case n.Comment:return`/* ${e.value} */`;case n.Indent:return"indent"+e.value;case n.Dedent:return"dedent";case n.Error:return`[ERR: ${e.value}]`;case n.EOF:return"End of file";default:return"???"}}t.position=f,t.patchPosition=function(e,t){if(!e.start&&!e.length)return e.start=0,e.length=0,e.line=0,void(e.column=0);let n=f(e.start,t);e.line=n.line,e.column=n.column,e.length>0&&(n=f(e.start+e.length-1,t),e.endLine=n.line,e.endColumn=n.column+2)},t.tokenToString=m,t.friendlyTokenToString=function(e,t){let n=e.endPos-e.startPos,i="";return i=0==n?m(e):n>20?"`"+t.slice(e.startPos,e.startPos+20)+"`...":"`"+t.slice(e.startPos,e.endPos)+"`",i=i.replace(/\r/g,"").replace(/\n/g,"\\n").replace(/\t/g,"\\t"),i},t.tokensToString=function(e){let t="",i=0;for(let r of e){let e=m(r);i+e.length>70&&(i=0,t+="\n"),0!=i&&(t+=" "),t+=e,i+=e.length,r.type!=n.NewLine&&r.type!=n.Comment||(i=0,t+="\n")}return t},t.lex=function(f){for(0==s.length&&function(){const n={'"':x,"'":x,"#":w,"\\":C,".":A};i=e.U.clone(a);for(let e of Object.keys(o))i[e]=o[e],i[e+"="]=o[e]+"Assign";r={};for(let e of Object.keys(i))r[i[e]]=e;for(let e=0;e<128;++e)if(t.rx.isIdentifierStart(e))s[e]=_;else{let r=String.fromCharCode(e);if(n.hasOwnProperty(r))s[e]=n[r];else if(i.hasOwnProperty(r)){let t=!1,n=i[r];for(let e of Object.keys(i))e!=r&&e.startsWith(r)&&(t=!0);s[e]=t?()=>b(n):()=>y(n)}else t.rx.isSpace(e)?s[e]=()=>{}:13==e?s[e]=()=>{10==d.charCodeAt(p)&&p++,E()}:t.rx.isNewline(e)?s[e]=E:N(e)?s[e]=I:s[e]=D}}(),d=f,u=[],p=0,h=0,S();p<d.length;){h=p;const e=d.charCodeAt(p++);e<128?s[e]():t.rx.isIdentifierStart(e)?_():t.rx.isSpace(e)||(t.rx.isNewline(e)?E():D())}return h=p,E(),m(n.EOF,""),u;function m(e,t,n){let i={type:e,value:t,startPos:h,endPos:p,auxValue:n};return u.push(i),i}function g(e){m(n.Error,e)}function _(){for(;t.rx.isIdentifierChar(d.charCodeAt(p));)p++;let e=d.slice(h,p),i=d.charCodeAt(p);t.keywords.hasOwnProperty(e)?m(n.Keyword,e):34==i||39==i?k(e):m(n.Id,e)}function y(e){m(n.Op,e)}function b(e){let t=d.slice(h,p+1);if(2==t.length&&i.hasOwnProperty(t)){let n=d.slice(h,p+2);3==n.length&&i.hasOwnProperty(n)?(p+=2,e=i[n]):(p++,e=i[t])}y(e)}function v(e){switch(e){case 97:return 7;case 98:return 8;case 102:return 12;case 110:return 10;case 114:return 13;case 116:return 9;case 118:return 11;default:return 0}}function T(e){return("0000"+e.toString(16)).slice(-4)}function k(i){const r=d.charCodeAt(p++);let s=!1;d.charCodeAt(p)==r&&d.charCodeAt(p+1)==r&&(p+=2,s=!0);let o=(i=i.toLowerCase()).indexOf("r")>=0,a="",l="";for(;;){const n=d.charCodeAt(p++);if(n==r){if(!s)break;if(d.charCodeAt(p)==r&&d.charCodeAt(p+1)==r){p+=2;break}l+="\\"+String.fromCharCode(r),a+=String.fromCharCode(r)}else if(92==n){let n=d.charCodeAt(p++);if(13==n&&10==d.charCodeAt(p)&&(n=10,p++),34==n||39==n||92==n)o&&(l+="\\",a+="\\"),l+="\\"+String.fromCharCode(n),a+=String.fromCharCode(n);else if(!o&&v(n))l+="\\"+String.fromCharCode(n),a+=String.fromCharCode(v(n));else if(t.rx.isNewline(n))o&&(a+="\\"+String.fromCharCode(n),l+="\\\\",l+=10==n?"\\n":"\\u"+T(n));else if(o||48!=n)if(o||117!=n&&120!=n)l+="\\\\"+String.fromCharCode(n),a+="\\"+String.fromCharCode(n);else{let t=117==n?4:2,i=d.slice(p,p+t);p+=t;let r=parseInt(i,16);isNaN(r)&&g(e.U.lf("invalid unicode or hex escape")),l+="\\"+String.fromCharCode(n)+i,a+=String.fromCharCode(r)}else l+="\\\\x00",a+="\0"}else{if(isNaN(n)){g(e.U.lf("end of file in a string"));break}if(t.rx.isNewline(n)&&!s){g(e.U.lf("new line in a string"));break}a+=String.fromCharCode(n),l+=String.fromCharCode(n)}}let c=m(n.String,a);c.quoted=l,c.stringPrefix=i}function x(){p--,k("")}function E(){m(n.NewLine,""),S()}function S(){let e=0;for(;;){const t=d.charCodeAt(p);if(9!=t){if(32!=t)break;e++,p++}else e=e+8&-8,p++}m(n.Indent,""+e)}function C(){let n=d.charCodeAt(p);t.rx.isNewline(n)?(p++,13==n&&10==d.charCodeAt(p)&&p++):g(e.U.lf("unexpected character after line continuation character"))}function w(){for(m(n.NewLine,"");p<d.length&&!t.rx.isNewline(d.charCodeAt(p));)p++;m(n.Comment,d.slice(h+1,p)),13==d.charCodeAt(p)&&10==d.charCodeAt(p+1)&&p++,p++,S()}function I(){let t=d[h],i="";if("0"==t){let r=d[p];const s=l[r];if(s){for(p++;;){const e=d[p];if(!s.test(e))break;i+=e,p++}if(i){let s=parseInt(i,c[r]);isNaN(s)&&g(e.U.lf("invalid number")),m(n.Number,t+r+i,s)}else g(e.U.lf("expecting numbers to follow 0b, 0o, 0x"));return}}let r=!1,s=!1,o=!1;for(p=h;;){const e=d.charCodeAt(p);if(!o||43!=e&&45!=e)if(o=!1,95==e||N(e));else if(s||r||46!=e){if(s||69!=e&&101!=e)break;s=!0,o=!0}else r=!0;else;i+=String.fromCharCode(e),p++}!r&&!s&&"0"==t&&i.length>1&&!/^0+/.test(i)&&g(e.U.lf("unexpected leading zero"));let a=parseFloat(i);isNaN(a)&&g(e.U.lf("invalid number")),m(n.Number,i,a)}function A(){N(d.charCodeAt(p))?I():m(n.Op,"Dot")}function N(e){return 48<=e&&e<=57}function D(){g(e.U.lf("invalid token"))}}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){let n,i,r,s,o,a,l,c,u;function d(){return i[o]}function p(){for(;i[o];o++){let r=i[o];if(r.type!=t.TokenType.Comment){if(n>=0&&r.type==t.TokenType.Op)switch(r.value){case"LParen":case"LSquare":case"LBracket":n++;break;case"RParen":case"RSquare":case"RBracket":n--}if(r.type!=t.TokenType.Error){if(n>0){if(r.type==t.TokenType.NewLine||r.type==t.TokenType.Indent)continue}else if(r.type==t.TokenType.Indent){if(i[o+1].type==t.TokenType.NewLine){o++;continue}let n=parseInt(r.value),s=l[l.length-1];if(n==s)continue;if(n>s)return void l.push(n);{r.type=t.TokenType.Dedent;let s=0;for(;l.length;){let t=l[l.length-1];if(!(t>n)){for(t!=n&&f(9552,e.U.lf("inconsitent indentation"));s>1;)i.splice(o,0,r),s--;return}l.pop(),s++}}}return}f(9551,r.value)}else a.push(r)}}function h(){c=d(),c.type!=t.TokenType.EOF&&(o++,p())}function f(n,i){i||(i=e.U.lf("invalid syntax")),n||(n=9550);const o=d(),a={code:n,category:pxtc.DiagnosticCategory.Error,messageText:e.U.lf("{0} near {1}",i,t.friendlyTokenToString(o,r)),fileName:s,start:o.startPos,length:o.endPos?o.endPos-o.startPos:0,line:0,column:0};t.patchPosition(a,r),u.push(a),9572!=n&&u.length>100&&e.U.userError(e.U.lf("too many parse errors"))}function m(n,i){const r=d();(r.type==n&&r.value==i||(f(9553,e.U.lf("expecting {0}",t.tokenToString(function(e,t){return{type:e,value:t,startPos:0,endPos:0}}(n,i)))),r.type!=t.TokenType.NewLine))&&h()}function g(){m(t.TokenType.NewLine,"")}function _(e){m(t.TokenType.Keyword,e)}function y(e){m(t.TokenType.Op,e)}function b(){let e=d();return e.type==t.TokenType.Keyword?e.value:""}function v(){let e=d();return e.type==t.TokenType.Op?e.value:""}const T={if:function e(){let t=E("If");h(),t.test=z(),t.body=x(),"elif"==b()?t.orelse=[e()]:t.orelse=C();return S(t)},while:function(){let e=E("While");return _("while"),e.test=z(),e.body=x(),e.orelse=C(),S(e)},for:function(){let e=E("For");return _("for"),e.target=$(),U(e.target),_("in"),e.iter=B(),e.body=x(),e.orelse=C(),S(e)},try:function(){let e=E("Try");_("try"),e.body=x(),e.handlers=[];let t=!1;for(;"except"==b();){let n=E("ExceptHandler");e.handlers.push(n),h(),"Colon"!=v()?(t&&f(),n.type=z(),"as"==b()?(h(),n.name=be()):n.name=void 0):(t=!0,n.type=void 0,n.name=void 0),n.body=x()}e.orelse=C(),0==e.handlers.length&&e.orelse.length&&f();"finally"==b()?(h(),e.finalbody=x()):e.finalbody=[];return S(e)},with:function(){let t=E("With");return _("with"),t.items=ge(e.U.lf("with item"),w),t.body=x(),S(t)},def:function(){let e=E("FunctionDef");_("def"),e.name=be(),y("LParen"),e.args=j(!0),y("RParen"),e.returns=void 0,"Arrow"==v()&&(h(),e.returns=z());return e.body=x(),S(e)},class:function(){let e=E("ClassDef");if(_("class"),e.name=be(),"LParen"==v()){let t=ve();e.bases=t.args,e.keywords=t.keywords}else e.bases=[],e.keywords=[];return e.body=x(),S(e)}},k={del:function(){let t=E("Delete");return _("del"),t.targets=me(e.U.lf("expression"),oe),S(t)},pass:function(){let e=E("Pass");return _("pass"),S(e)},break:function(){let e=E("Break");return h(),S(e)},continue:function(){let e=E("Continue");return h(),S(e)},return:function(){let e=E("Return");h(),A()?e.value=void 0:e.value=B();return S(e)},raise:function(){let e=E("Raise");_("raise"),e.exc=void 0,e.cause=void 0,A()||(e.exc=z(),"from"==b()&&(h(),e.cause=z()));return S(e)},global:N,nonlocal:function(){let e=N();return e.kind="Nonlocal",e},import:function(){let t=E("Import");return h(),t.names=ge(e.U.lf("import name"),O),S(t)},from:function(){let n=E("ImportFrom");h(),n.level=L(),d().type==t.TokenType.Id?n.module=D():n.module=void 0;n.level||n.module||f();if(_("import"),"Mult"==v()){h();let e=E("Alias");e.name="*",n.names=[e]}else"LParen"==v()?(h(),n.names=me(e.U.lf("import name"),R),y("RParen")):n.names=me(e.U.lf("import name"),R);return S(n)},assert:function(){let e=E("Assert");h(),e.test=z(),"Comma"==v()?(h(),e.msg=z()):e.msg=void 0;return S(e)},yield:function(){d();if(h(),"from"==b()){let e=E("YieldFrom");return e.value=z(),I(S(e))}let e=E("Yield");A()||(e.value=B());return I(S(e))}};function x(){return y("Colon"),function(){if(d().type==t.TokenType.NewLine){let n;if(h(),d().type!=t.TokenType.Indent)f(9554,e.U.lf("expected an indented block")),n=G();else{const i=parseInt(d().value);for(h(),n=G();;){if(d().type==t.TokenType.Dedent){const e=isNaN(i)||parseInt(d().value)<i;if(h(),e)break}if(e.U.pushRange(n,G()),d().type==t.TokenType.EOF)break}}return n}return H()}()}function E(e,t){let n=t||d();return{startPos:n.startPos,endPos:n.endPos,kind:e}}function S(e){return e.endPos=c.endPos,e}function C(){return"else"==b()?(h(),x()):[]}function w(){let e=E("WithItem");return e.context_expr=z(),e.optional_vars=void 0,"as"==b()&&(h(),e.optional_vars=oe()),S(e)}function I(e){let t=E("ExprStmt");return t.startPos=e.startPos,t.endPos=e.endPos,t.value=e,t}function A(){let e=d();return e.type==t.TokenType.NewLine||e.type==t.TokenType.Op&&"Semicolon"==e.value}function N(){let e=E("Global");for(h(),e.names=[];e.names.push(be()),"Comma"==v();)h();return S(e)}function D(){let e="";for(;;){if(e+=be(),"Dot"!=v())return e;e+=".",h()}}function O(){let e=E("Alias");return e.name=D(),"as"==b()?(h(),e.asname=be()):e.asname=void 0,S(e)}function R(){let e=E("Alias");return e.name=be(),"as"==b()?(h(),e.asname=be()):e.asname=void 0,S(e)}function L(){let e=0;for(;;)if("Dot"==v())e+=1,h();else{if("Ellipsis"!=v())return e;e+=3,h()}}function P(e,t){let n=E("Tuple",e);return n.elts=t,S(n)}function M(t){let n=d(),i=me(e.U.lf("expression"),t),r=i[0];return 1!=i.length?P(n,i):r}function F(){return M(le)}function B(){return M(z)}function $(){return M(oe)}function U(e){if("Tuple"==e.kind){e.elts.forEach(U)}else e.ctx="Store"}function V(){let n=e.U.lookup(k,b());return n?n():function(){let n=d(),i=F(),r=v();if("Assign"==r){let e=E("Assign");for(e.targets=[i];;){if(h(),i=F(),r=v(),"Assign"!=r){e.value=i;break}e.targets.push(i)}return e.targets.forEach(U),S(e)}if("Colon"==r){let e=E("AnnAssign");return e.target=i,h(),e.annotation=z(),"Assign"==v()&&(h(),e.value=z()),e.simple=n.type==t.TokenType.Id&&"Name"==i.kind?1:0,U(e.target),S(e)}if(e.U.endsWith(r,"Assign")){let e=E("AugAssign");return e.target=i,e.op=r.replace("Assign",""),h(),e.value=B(),U(e.target),S(e)}if("Semicolon"==r||d().type==t.TokenType.NewLine){let e=E("ExprStmt");return e.value=i,S(e)}return f(9555,e.U.lf("unexpected token")),h(),null}()}function H(){let e=[V()];for(;"Semicolon"==v()&&(h(),d().type!=t.TokenType.NewLine);)e.push(V());return g(),e.filter(e=>!!e)}function G(){const i=u.length,r=d().type==t.TokenType.Indent;r&&(h(),f(9573,e.U.lf("unexpected indent")));let s=[];for(;"MatMult"==v();)h(),s.push(ke()),g();let o=b(),l=e.U.lookup(T,b()),p=[],m=a;if(a=[],"class"==o||"def"==o){let e=l();e.decorator_list=s,p=[e]}else s.length?f(9556,e.U.lf("decorators not allowed here")):p=l?[l()]:H();m.length&&p.length&&(p[0]._comments=m);if(u.length>i){for(n=-1;c.type!=t.TokenType.Dedent&&c.type!=t.TokenType.NewLine&&(h(),d().type!=t.TokenType.EOF););r&&d().type===t.TokenType.Dedent&&h(),n=0}return p}function j(n){let i=E("Arguments");for(i.args=[],i.defaults=[],i.kwonlyargs=[],i.kw_defaults=[],i.vararg=void 0;;){let n=v();if("Colon"==n||"RParen"==n)break;if("Mult"==n)i.vararg&&f(9557,e.U.lf("multiple *arg")),h(),d().type==t.TokenType.Id?i.vararg=r():i.vararg=void 0;else if("Pow"==n)i.kwarg&&f(9558,e.U.lf("multiple **arg")),h(),i.kwarg=r();else{i.kwarg&&f(9559,e.U.lf("arguments after **"));let t,n=r();"Assign"==v()&&(h(),t=z()),void 0!==i.vararg&&t?(i.kwonlyargs.push(n),i.kw_defaults.push(t)):(i.args.push(n),t?i.defaults.push(t):i.defaults.length&&f(9560,e.U.lf("non-default argument follows default argument")))}if("Comma"!=v())break;h()}return i.kwarg||(i.kwarg=void 0),i.vararg||(i.vararg=void 0),S(i);function r(){let e=E("Arg");return e.arg=be(),e.annotation=void 0,n&&"Colon"==v()&&(h(),e.annotation=z()),e}}function K(e){let t=E("Lambda");return h(),t.args=j(!1),y("Colon"),t.body=e?ce():z(),S(t)}function z(){if("lambda"==b())return K();let e=d(),t=J();if("if"==b()){let n=E("IfExp",e);return n.body=t,_("if"),n.test=J(),_("else"),n.orelse=z(),S(n)}return t}function W(e,t){let n=d(),i=t();if(b()==e){let r=E("BoolOp",n);for(r.op="or"==e?"Or":"And",r.values=[i];b()==e;)_(e),r.values.push(t());return S(r)}return i}function q(){return W("and",Y)}function J(){return W("or",q)}function Y(){if("not"==b()){let e=E("UnaryOp");return h(),e.op="Not",e.operand=Y(),S(e)}return function(){let e=d(),t=oe();if(!Z())return t;let n=E("Compare",e);n.left=t,n.comparators=[],n.ops=[];for(;;){let e=Z();if(!e)break;h(),"NotIn"==e?_("in"):"Is"==e&&"not"==b()&&(h(),e="IsNot"),n.ops.push(e),n.comparators.push(oe())}return S(n)}()}const X={Lt:"Lt",Gt:"Gt",Eq:"Eq",GtE:"GtE",LtE:"LtE",NotEq:"NotEq",in:"In",not:"NotIn",is:"Is"};function Z(){return X[v()]||X[b()]||null}const Q={Invert:"Invert",Sub:"USub",Add:"UAdd"};function ee(e,t){let n=d(),i=e();for(;;){let r=v();if(!(r&&t.indexOf(","+r+",")>=0))return i;{let t=E("BinOp",n);t.left=i,t.op=r,h(),t.right=e(),i=t}}}function te(){return ee(xe,",Mult,MatMult,Div,Mod,FloorDiv,")}function ne(){return ee(te,",Add,Sub,")}function ie(){return ee(ne,",LShift,RShift,")}function re(){return ee(ie,",BitAnd,")}function se(){return ee(re,",BitXor,")}function oe(){return ee(se,",BitOr,")}function ae(){let t,n=d();if("Colon"!=v()&&(t=z()),"Colon"==v()){let e=E("Slice",n);e.lower=t,h();let i=v();return e.upper="Colon"!=i&&"Comma"!=i&&"RSquare"!=i?z():void 0,e.step=void 0,"Colon"==v()&&(h(),i=v(),"Comma"!=i&&"RSquare"!=i&&(e.step=z())),S(e)}{t||f(9570,e.U.lf("unable to parse lower subscript"));let n=E("Index");return n.value=t,S(n)}}function le(){if("Mult"==v()){let e=E("Starred");return e.value=oe(),S(e)}return z()}function ce(){return"lambda"==b()?K(!0):J()}function ue(){let e=[];for(;;){let t=E("Comprehension");for(t.is_async=0,e.push(t),_("for"),t.target=$(),U(t.target),_("in"),t.iter=J(),t.ifs=[];"if"==b();)h(),t.ifs.push(ce());if("for"!=b())return e}}function de(){let t=d();if("Mult"==v()){let e=E("Starred");return h(),e.value=z(),S(e)}if("Pow"==v()){let e=E("Keyword");return h(),e.arg=void 0,e.value=z(),S(e)}let n=z();if("Assign"==v()){"Name"!=n.kind&&f(9561,e.U.lf("invalid keyword argument; did you mean ==?")),h();let i=E("Keyword",t);return i.arg=n.id||"???",i.value=z(),S(i)}if("for"==b()){let e=E("GeneratorExp",t);return e.elt=n,e.generators=ue(),S(e)}return n}function pe(){let e=E("NameConstant");return e.value=null,h(),S(e)}function he(){let n=d();if(n.type==t.TokenType.Id){let e=E("Name");return h(),e.id=n.value,e.ctx="Load",S(e)}if(n.type==t.TokenType.Number){let e=E("Num");return h(),e.ns=n.value,e.n=n.auxValue,S(e)}if(n.type==t.TokenType.String){h();let i=n.value;for(;d().type==t.TokenType.String;)i+=d().value,h();if("b"==n.stringPrefix){let t=E("Bytes",n);return t.s=e.U.toArray(e.U.stringToUint8Array(i)),S(t)}{let e=E("Str",n);return e.s=i,S(e)}}if(n.type==t.TokenType.Keyword){if("None"==n.value||"True"==n.value||"False"==n.value){let e=E("NameConstant");return h(),e.value="True"==n.value||"False"!=n.value&&null,S(e)}return f(9564,e.U.lf("expecting atom")),pe()}if(n.type==t.TokenType.Op){let t=n.value;return"LParen"==t?ye("RParen","Tuple","GeneratorExp"):"LSquare"==t?ye("RSquare","List","ListComp"):"LBracket"==t?function(){let t=d();if(h(),"Pow"==v())return h(),i(void 0,oe());if("RBracket"==v()){let e=E("Dict",t);return h(),e.keys=[],e.values=[],S(e)}{let n=le();return"Starred"!=n.kind&&"Colon"==v()?(h(),i(n,z())):function(n){if("for"==b()){"Starred"==n.kind&&f(9562,e.U.lf("iterable unpacking cannot be used in comprehension"));let i=E("SetComp",t);return i.elt=n,i.generators=ue(),S(i)}let i=E("Set",t);if(i.elts=[n],"Comma"==v()){let t=_e("RBracket",e.U.lf("set element"),le);i.elts=[n].concat(t)}else y("RBracket");return S(i)}(n)}function n(){if("Pow"==v())return h(),[null,oe()];{let e=z();return y("Colon"),[e,z()]}}function i(i,r){if("for"==b()){i||f(9563,e.U.lf("dict unpacking cannot be used in dict comprehension"));let n=E("DictComp",t);return n.key=i,n.value=r,n.generators=ue(),S(n)}let s=E("Dict",t);if(s.keys=[i],s.values=[r],"Comma"==v()){let t=_e("RBracket",e.U.lf("dict element"),n);for(let e of t)e.length>=2&&e[0]&&e[1]&&(s.keys.push(e[0]),s.values.push(e[1]))}else y("RBracket");return S(s)}}():(f(9565,e.U.lf("unexpected operator")),pe())}return f(9566,e.U.lf("unexpected token")),pe()}function fe(){let n=v();return"RParen"==n||"RSquare"==n||"RBracket"==n||"Colon"==n||"Semicolon"==n||(!!e.U.endsWith(n,"Assign")||("in"==b()||d().type==t.TokenType.NewLine))}function me(t,n){let i=[];if(fe())return i;for(;;){i.push(n());let r="Comma"==v();if(r&&h(),fe())return i;if(!r)return f(9567,e.U.lf("expecting {0}",t)),i}}function ge(e,t){let n=[];for(;n.push(t()),"Comma"==v();)h();return n}function _e(t,n,i){h();let r=[];if(v()!=t)for(;;){r.push(i());let s="Comma"==v();if(s&&h(),v()==t)break;if(!s){f(9568,e.U.lf("expecting {0}",n));break}}return y(t),r}function ye(t,n,i){let r=d();if(h(),v()==t){h();let e=E(n,r);return e.elts=[],S(e)}let s=le();if("for"==b()){let e=E(i,r);return e.elt=s,e.generators=ue(),y(t),S(e)}if("Comma"==v()){let i=E(n,r);return h(),i.elts=me(e.U.lf("expression"),le),i.elts.unshift(s),y(t),S(i)}if(y(t),"List"==n){let e=E(n,r);return e.elts=[s],S(e)}return s}function be(){let n=d();return n.type!=t.TokenType.Id&&f(9569,e.U.lf("expecting identifier")),h(),n.value}function ve(){let t=_e("RParen",e.U.lf("argument"),de),n=[],i=[];for(let r of t)"Keyword"==r.kind?i.push(r):(i.length&&f(9570,e.U.lf("positional argument follows keyword argument")),n.push(r));return{args:n,keywords:i}}function Te(t,n){let i=v();if("LParen"==i){let e=E("Call",t);e.func=n;let i=ve();return e.args=i.args,e.keywords=i.keywords,S(e)}if("LSquare"==i){let i=d(),r=E("Subscript",t);r.value=n;let s=_e("RSquare",e.U.lf("subscript"),ae);if(0==s.length)f(9571,e.U.lf("need non-empty index list"));else if(1==s.length)r.slice=s[0];else if(s.every(e=>"Index"==e.kind)){let e=s[0];e.value=P(i,s.map(e=>e.value)),r.slice=e}else{let e=E("ExtSlice",i);e.dims=s,r.slice=S(e)}return S(r)}if("Dot"==i){let e=E("Attribute",t);return e.value=n,h(),e.attr=be(),S(e)}return n}function ke(){let e=d(),t=he();for(;;){let n=Te(e,t);if(n===t)return t;t=n}}function xe(){if(Q[v()]){let e=E("UnaryOp");return e.op=Q[v()],h(),e.operand=xe(),S(e)}return function(){d();let e=ke();if("Pow"==v()){let t=E("BinOp");return h(),t.left=e,t.op="Pow",t.right=xe(),S(t)}return e}()}const Ee={kind:1,id:2,n:3,s:4,func:5,key:6,elt:7,elts:8,keys:9,left:10,ops:11,comparators:12,names:13,items:14,test:15,targets:16,dims:17,context_expr:18,name:19,bases:20,type:21,inClass:22,target:23,annotation:24,simple:25,op:26,operand:27,right:28,values:29,iter:30,ifs:31,is_async:32,value:33,slice:34,attr:35,generators:36,args:37,keywords:38,body:39,handlers:40,orelse:41,finalbody:42,decorator_list:43,kwonlyargs:44,kw_defaults:45,defaults:46,arg:47},Se={lineno:1,col_offset:1,startPos:1,endPos:1,kind:1},Ce={body:1,orelse:1,finalbody:1},we={_comments:1,ctx:1,ns:1};t.dump=function(t,n=!1){const i=(t,r)=>{if(Array.isArray(r)){let e="";for(let n=0;n<r.length;++n)n>0&&(e+=", "),e+=i(t,r[n]);return"["+e+"]"}if(!r||!r.kind)return JSON.stringify(r);let s="",o=Object.keys(r);o.sort((t,n)=>(Ee[t]||100)-(Ee[n]||100)||e.U.strcmp(t,n));for(let a of o)if(!(e.U.lookup(Se,a)||n&&e.U.lookup(we,a)))if(s&&(s+=", "),s+=a+"=",Array.isArray(r[a])&&r[a].length&&e.U.lookup(Ce,a)){s+="[\n";let e=t+"  ";for(let t of r[a])s+=e+i(e,t)+"\n";s+=t+"]"}else if("_comments"==a){s+="[\n";let e=t+"  ";for(let t of r[a])s+=e+JSON.stringify(t.value)+"\n";s+=t+"]"}else s+=i(t,r[a]);return r.kind+"("+s+")"};let r="";for(let e of t)r+=i("",e)+"\n";return r},t.parse=function(h,m,g){r=h,s=m,i=g,n=0,o=0,a=[],l=[0],u=[];let _=[];try{if(c=i[0],p(),d().type!=t.TokenType.EOF)for(_=G();d().type!=t.TokenType.EOF;)e.U.pushRange(_,G())}catch(t){f(9572,e.U.lf("exception: {0}",t.message))}return{stmts:_,diagnostics:u}}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){function n(e,t,n){const i={fileName:e.getSourceFile().fileName,start:e.getStart(),length:e.getEnd()-e.getStart(),line:void 0,column:void 0,code:t,category:pxtc.DiagnosticCategory.Error,messageText:n},r=new Error(n);throw r.pyDiagnostic=i,r}t.decompileToPython=function(s,o){let a={blocksInfo:void 0,outfiles:{},diagnostics:[],success:!0,times:{}};try{let l=function(s,o){const a=s.getTypeChecker(),l=(new ts.pxtc.LSHost(s),s.getSourceFile(o)),c=pxtc.decompiler.buildCommentMap(l),u=e.U.toSet(g(),e=>e),[d,p]=ts.pxtc.decompiler.buildRenameMap(s,l,{takenNames:u,declarations:"all"}),h=pxtc.getApiInfo(s),f=e.U.mapMap(h.byQName,(e,t)=>t.fileName==o?void 0:t),m=t.computeScopeVariableLookup(l);return S(l);function g(){return["ArithmeticError","AssertionError","AttributeError","BaseException","BlockingIOError","BrokenPipeError","BufferError","BytesWarning","ChildProcessError","ConnectionAbortedError","ConnectionError","ConnectionRefusedError","ConnectionResetError","DeprecationWarning","EOFError","Ellipsis","EnvironmentError","Exception","False","FileExistsError","FileNotFoundError","FloatingPointError","FutureWarning","GeneratorExit","IOError","ImportError","ImportWarning","IndentationError","IndexError","InterruptedError","IsADirectoryError","KeyError","KeyboardInterrupt","LookupError","MemoryError","NameError","None","NotADirectoryError","NotImplemented","NotImplementedError","OSError","OverflowError","PendingDeprecationWarning","PermissionError","ProcessLookupError","RecursionError","ReferenceError","ResourceWarning","RuntimeError","RuntimeWarning","StopAsyncIteration","StopIteration","SyntaxError","SyntaxWarning","SystemError","SystemExit","TabError","TimeoutError","True","TypeError","UnboundLocalError","UnicodeDecodeError","UnicodeEncodeError","UnicodeError","UnicodeTranslateError","UnicodeWarning","UserWarning","ValueError","Warning","ZeroDivisionError","_","__build_class__","__debug__","__doc__","__import__","__loader__","__name__","__package__","__spec__","abs","all","any","ascii","bin","bool","bytearray","bytes","callable","chr","classmethod","compile","complex","copyright","credits","delattr","dict","dir","divmod","enumerate","eval","exec","exit","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","license","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","quit","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip",...Object.keys(e.py.keywords)]}function _(e){if(!e.getSourceFile())return null;let t=e.getText();return f[t]||null}function y(e){if(!e.getSourceFile())return null;let t=e.getText();const n=a.getSymbolAtLocation(e);n&&(t=a.getFullyQualifiedName(n));let i=f[t];if(i&&i.attributes.alias)return i.attributes.alias;if(i&&i.pyQName){if(i.isInstance){if(ts.isPropertyAccessExpression(e))return null;const t=new RegExp(`(?:^|.)${i.namespace}.(.+)`).exec(i.pyQName);if(t)return t[1]}return i.pyQName}return t in pxtc.ts2PyFunNameMap?pxtc.ts2PyFunNameMap[t].n:null}function b(t){let i=y(t);if(i)return i;if(!ts.isIdentifier(t))return e.tickEvent("depython.todo.advancedname"),n(t,3001,"Unsupported advanced name format: "+t.getText());let r=t.text;if(t.getSourceFile()){const e=d.getRenameForPosition(t.getStart());e&&(r=e.name)}return r}function v(e){return"string"!=typeof e&&(e=b(e)),p[e]?pxtc.decompiler.getNewName(e,p):(p[e]=!0,e)}function T(e,t){return 0!==(e.flags&t)}function k(e,t){return T(a.getTypeAtLocation(e),t)}function x(e){return k(e,ts.TypeFlags.StringLike)}function E(e){return k(e,ts.TypeFlags.NumberLike)}function S(e){let t=e.getChildren().map(C).reduce((e,t)=>e.concat(t),[]).reduce((e,t)=>t||e[e.length-1]?[...e,t]:e,[]);return c.filter(e=>!e.owner).forEach(e=>t.push(...w(e))),t.join("\n")}function C(e){switch(e.kind){case ts.SyntaxKind.SyntaxList:return e._children.map(C).reduce((e,t)=>e.concat(t),[]);case ts.SyntaxKind.EndOfFileToken:case ts.SyntaxKind.OpenBraceToken:case ts.SyntaxKind.CloseBraceToken:return[];default:return I(e)}}function w(e){let t=[];if(e.kind===pxtc.decompiler.CommentKind.SingleLine)t.push("# "+e.text);else{t.push('"""');for(const n of e.lines)t.push(n);t.push('"""')}return t}function I(e){const t=A(e);return pxtc.decompiler.getCommentsForStatement(e,c).map(w).reduce((e,t)=>e.concat(t),[]).concat(t)}function A(t){return ts.isVariableStatement(t)?V(t):ts.isClassDeclaration(t)?H(t):ts.isEnumDeclaration(t)?G(t):ts.isExpressionStatement(t)?X(t):ts.isFunctionDeclaration(t)?Q(t):ts.isIfStatement(t)?$(t):ts.isForStatement(t)?B(t):ts.isForOfStatement(t)?F(t):ts.isWhileStatement(t)?R(t):ts.isReturnStatement(t)?O(t):ts.isBlock(t)?Z(t):ts.isTypeAliasDeclaration(t)?D(t):ts.isEmptyStatement(t)?[]:ts.isModuleDeclaration(t)?N(t):ts.isBreakStatement(t)?["break"]:ts.isContinueStatement(t)?["continue"]:(e.tickEvent("depython.todo.statement",{statement:t.kind}),n(t,3002,`Not supported in MakeCode Python: ${ts.SyntaxKind[t.kind]} (${t.kind})`))}function N(e){let n=b(e.name),i=e.body&&e.body.getChildren().map(C).reduce((e,t)=>e.concat(t),[]).map(e=>t.indent1(e));return["@namespace",`class ${n}:`].concat(i||[])}function D(e){let t=pxtc.emitPyTypeFromTypeNode(e.type);return[`${b(e.name)} = ${t}`]}function O(e){if(!e.expression)return["return"];let[t,n]=Ie(e.expression),i=re("return ",t);return n.concat(i)}function R(e){let[t,n]=Ie(e.expression),i=M(e.statement),r=re("while ",t,":");return n.concat(r).concat(i)}function L(e){let t=Math.floor(Number(e));return t!==1/0&&String(t)===e}function P(e){if(!e.initializer)return null;if(e.initializer.kind!==ts.SyntaxKind.VariableDeclarationList)return null;let t=e.initializer;if(1!==t.declarations.length)return null;let n=t.declarations[0],i=b(n.name);if(!n.initializer||!Ce(n.initializer)||!E(n.initializer))return null;let[r,s]=Ie(n.initializer);if(s.length)return null;let o=ie(r);if(!e.condition)return null;if(!ts.isBinaryExpression(e.condition))return null;if(!ts.isIdentifier(e.condition.left))return null;if(b(e.condition.left)!=i)return null;if(!E(e.condition.right))return null;let[a,l]=Ie(e.condition.right);if(l.length)return null;let c=ie(a),u=c;if(e.condition.operatorToken.kind===ts.SyntaxKind.LessThanEqualsToken&&L(c))u=""+(Number(c)+1);else if(e.condition.operatorToken.kind!==ts.SyntaxKind.LessThanToken)return null;return e.incrementor&&(ts.isPostfixUnaryExpression(e.incrementor)||ts.isPrefixUnaryExpression(e.incrementor))?e.incrementor.operator!==ts.SyntaxKind.PlusPlusToken?null:o<u?{name:i,fromIncl:o,toExcl:u}:null:null}function M(e){let n=A(e).map(t.indent1);return n.length<1&&(n=[t.indent1("pass")]),n}function F(t){if(!ts.isVariableDeclarationList(t.initializer))return e.tickEvent("depython.todo.forof.complexexp"),n(t,3003,"Unsupported expression in for..of initializer: "+t.initializer.getText());let i=t.initializer.declarations.map(e=>b(e.name));if(1!==i.length)return e.tickEvent("depython.todo.forof.multidecl"),n(t,3004,"Unsupported multiple declerations in for..of: "+t.initializer.getText());let r=i[0],[s,o]=Ie(t.expression),a=o;a=a.concat(re(`for ${r} in `,s,":"));let l=M(t.statement);return a=a.concat(l),a}function B(e){let n=P(e);if(n){let{name:t,fromIncl:i,toExcl:r}=n,s="0"===i?`for ${t} in range(${r}):`:`for ${t} in range(${i}, ${r}):`,o=M(e.statement);return[s].concat(o)}let i,r=[];if(e.initializer)if(ts.isVariableDeclarationList(e.initializer)){let t=e.initializer.declarations.map(te).reduce((e,t)=>e.concat(t),[]);r=r.concat(t)}else{let[t,n]=Ie(e.initializer);r=r.concat(n).concat(t)}if(e.condition){let[t,n]=Ie(e.condition);r=r.concat(n),i=ie(t)}else i="True";let s=`while ${i}:`;r.push(s);let o=A(e.statement).map(t.indent1);if(0!==o.length||e.incrementor||(o=[t.indent1("pass")]),r=r.concat(o),e.incrementor){let n=Y(e.incrementor);if(n)r=r.concat(n.map(t.indent1));else{let[n,i]=Ie(e.incrementor);r=r.concat(i).concat(n.map(t.indent1))}}return r}function $(e){let{supportStmts:t,ifStmt:n,rest:i}=U(e);return t.concat([n]).concat(i)}function U(e){let t=[],[n,i]=Ie(e.expression);t=t.concat(i);let r=`if ${ie(n)}:`,s=[],o=M(e.thenStatement);if(s=s.concat(o),e.elseStatement)if(ts.isIfStatement(e.elseStatement)){let{supportStmts:n,ifStmt:i,rest:r}=U(e.elseStatement),o=`el${i}`;t=t.concat(n),s.push(o),s=s.concat(r)}else{s.push("else:");let t=M(e.elseStatement);s=s.concat(t)}return{supportStmts:t,ifStmt:r,rest:s}}function V(e){return e.declarationList.declarations.map(te).reduce((e,t)=>e.concat(t),[])}function H(i){if(!r)return e.tickEvent("depython.todo.classes"),n(i,3016,"Unsupported: classes are not supported in Python right now.");let s=[];if(!i.name)return e.tickEvent("depython.todo.anonymousclass"),n(i,3011,"Unsupported: anonymous class");let o=i.members.every(j),a=b(i.name);o?s.push(`class ${a}(Enum):`):s.push(`class ${a}:`);let l=i.members.map(K).reduce((e,t)=>e.concat(t),[]).filter(e=>e);return l.length&&(s=s.concat(l.map(t.indent1))),s}function G(i){let r=[];r.push(`class ${b(i.name)}(Enum):`);let s=i.members.every(e=>!!e.initializer),o=!i.members.every(e=>!!e.initializer);if(!s&&!o)return e.tickEvent("depython.todo.enummix"),n(i,3005,"Unsupported enum decleration: has mixture of explicit and implicit initialization");if(s)return e.tickEvent("depython.todo.enuminit"),n(i,3006,"Unsupported: explicit enum initialization");let a=0;for(let e of i.members)r.push(t.indent1(`${b(e.name)} = ${a++}`));return r}function j(e){if(e.kind!==ts.SyntaxKind.PropertyDeclaration)return!1;let t=e;if(!t.modifiers||1!==t.modifiers.length)return!1;for(let e of t.modifiers)if(e.kind!==ts.SyntaxKind.StaticKeyword)return!1;return!!t.initializer&&t.initializer.kind===ts.SyntaxKind.NumericLiteral}function K(e){return ts.isPropertyDeclaration(e)?q(e):ts.isMethodDeclaration(e)?Q(e):ts.isConstructorDeclaration(e)?z(e):["# unknown ClassElement "+e.kind]}function z(e){let n=[];const i=e.parameters.filter(ts.isParameterPropertyDeclaration);return i.forEach(e=>{n=[...n,...q(e)]}),n=[...n,...Q(e,"__init__")],i.length&&n.slice(-1)[0].endsWith("pass")&&n.pop(),i.forEach(e=>{const i=b(e.name);n.push(t.indent1(`self.${i} = ${i}`))}),n}function W(e){return T(e,ts.TypeFlags.NumberLike)?"0":T(e,ts.TypeFlags.StringLike)?'""':T(e,ts.TypeFlags.BooleanLike)?"False":void 0}function q(t){let i=b(t.name);if(t.initializer){let[e,n]=Ie(t.initializer);return[...n,`${i} = ${ie(e)}`]}if(ts.isParameterPropertyDeclaration(t)&&t.type){const e=W(a.getTypeFromTypeNode(t.type));if(e)return[`${i} = ${e}`]}return e.tickEvent("depython.todo.classwithoutinit"),n(t,3006,"Unsupported: class properties without initializers")}function J(e){return!(!ts.isPrefixUnaryExpression(e)&&!ts.isPostfixUnaryExpression(e))&&(e.operator===ts.SyntaxKind.MinusMinusToken||e.operator===ts.SyntaxKind.PlusPlusToken)}function Y(e){if(!J(e))return null;let[t,n]=Ie(e.operand),i=e.operator===ts.SyntaxKind.MinusMinusToken?" -= 1":" += 1",r=n;return r.push(`${ie(t)}${i}`),r}function X(e){let t=Y(e.expression);if(t)return t;const[n,i]=Ie(e.expression);return i.length?["",...i,...n,""]:[...i,...n]}function Z(e){return e.getChildren().map(C).reduce((e,t)=>e.concat(t),[])}function Q(i,r,s,o){let a=[];i.kind!==ts.SyntaxKind.MethodDeclaration&&i.kind!==ts.SyntaxKind.Constructor||a.push("self");let l=(s?he(i.parameters,s):i.parameters).map(e=>ee(e,!o));a=a.concat(l);let c,u=a.join(", "),d=[];if(r)c=r;else{if(!i.name)return e.tickEvent("depython.todo.anonymousfunc"),n(i,3012,"Unsupported: anonymous function decleration");c=b(i.name)}if(d.push(`def ${c}(${u}):`),!i.body)return e.tickEvent("depython.todo.funcwithoutbody"),n(i,3013,"Unsupported: function decleration without body");let p=[];if(ts.isBlock(i.body))p=Z(i.body);else{let[e,t]=Ie(i.body);p=p.concat(t),p.concat(e)}if(p.length){let e=m.getExplicitGlobals(i).map(e=>b(e));e&&e.length&&p.unshift(`global ${e.join(", ")}`);let n=m.getExplicitNonlocals(i).map(e=>b(e));n&&n.length&&p.unshift(`nonlocal ${n.join(", ")}`),d=d.concat(p.map(t.indent1))}else d.push(t.indent1("pass"));return d}function ee(t,i=!0){let r=t.altName||b(t.name),s="";if(t.type&&i){let e=pxtc.emitPyTypeFromTypeNode(t.type);e&&-1===e.indexOf("(TODO")&&(s=`: ${e}`)}let o="";if(t.initializer){let[i,r]=Ie(t.initializer);if(r.length)return e.tickEvent("depython.todo.complexinit"),n(t,3007,`Unsupported: complex expression in parameter default value not supported. Expression: ${t.initializer.getText()}`);o=` = ${ie(i)}`}return`${r}${s}${o}`}function te(e){let t=[],n=b(e.name);if(e.initializer){let i,[r,s]=Ie(e.initializer);if(t=t.concat(s),e.type){i=`${n}: ${pxtc.emitPyTypeFromTypeNode(e.type)} = ${ie(r)}`}else i=`${n} = ${ie(r)}`;return t.push(i),t}return t}function ne(e,t){return[[e],t||[]]}function ie(e,t="\n"){return e.join(t)}function re(e="",t,n=""){return t[0]=e+t[0],t[t.length-1]=t[t.length-1]+n,t}function se(t,i){switch(t){case ts.SyntaxKind.BarBarToken:return"or";case ts.SyntaxKind.AmpersandAmpersandToken:return"and";case ts.SyntaxKind.ExclamationToken:return"not";case ts.SyntaxKind.LessThanToken:return"<";case ts.SyntaxKind.LessThanEqualsToken:return"<=";case ts.SyntaxKind.GreaterThanToken:return">";case ts.SyntaxKind.GreaterThanEqualsToken:return">=";case ts.SyntaxKind.EqualsEqualsEqualsToken:case ts.SyntaxKind.EqualsEqualsToken:return"==";case ts.SyntaxKind.ExclamationEqualsEqualsToken:case ts.SyntaxKind.ExclamationEqualsToken:return"!=";case ts.SyntaxKind.EqualsToken:return"=";case ts.SyntaxKind.PlusToken:return"+";case ts.SyntaxKind.MinusToken:return"-";case ts.SyntaxKind.AsteriskToken:return"*";case ts.SyntaxKind.PlusEqualsToken:return"+=";case ts.SyntaxKind.MinusEqualsToken:return"-=";case ts.SyntaxKind.PercentToken:return"%";case ts.SyntaxKind.SlashToken:return"/";case ts.SyntaxKind.PlusPlusToken:case ts.SyntaxKind.MinusMinusToken:return e.tickEvent("depython.todo.unsupportedop",{op:t}),n(i,3008,"Unsupported ++ and -- in an expression (not a statement or for loop)");case ts.SyntaxKind.AmpersandToken:return"&";case ts.SyntaxKind.CaretToken:return"^";case ts.SyntaxKind.LessThanLessThanToken:return"<<";case ts.SyntaxKind.GreaterThanGreaterThanToken:return">>";case ts.SyntaxKind.GreaterThanGreaterThanGreaterThanToken:return e.tickEvent("depython.todo.unsupportedop",{op:t}),n(i,3009,"Unsupported operator: >>>");case ts.SyntaxKind.AsteriskAsteriskToken:return"**";case ts.SyntaxKind.AsteriskAsteriskEqualsToken:return"**=";case ts.SyntaxKind.PercentEqualsToken:return"%=";case ts.SyntaxKind.AsteriskEqualsToken:return"*=";case ts.SyntaxKind.SlashEqualsToken:return"/=";default:return e.tickEvent("depython.todo.unsupportedop",{op:t}),n(i,3008,`Unsupported Python operator (code: ${t})`)}}function oe(e){let t=x(e.left),n=x(e.right),i=e.operatorToken.kind===ts.SyntaxKind.PlusToken&&(t||n),[r,s]=Ie(e.left);i&&!t&&(r=re("str(",r,")"));let o=se(e.operatorToken.kind,e),[a,l]=Ie(e.right);i&&!n&&(a=re("str(",a,")"));let c=s.concat(l);return[re(ie(r)+" "+o+" ",a),c]}function ae(e){let t=y(e);if(t)return ne(t);let[n,i]=Ie(e.expression),r=b(e.name);return ne("length"===r?`len(${ie(n)})`:`${ie(n)}.${r}`,i)}function le(e){if(ts.isPropertyAccessExpression(e)){let t=b(e.name),n=t.substr(t.lastIndexOf(".")+1);return ts.isIdentifier(e.expression)?[n]:le(e.expression).concat([n])}return ts.isIdentifier(e)?[b(e)]:[]}function ce(t,n,i,r){let s="";n&&(s=le(n).map(e.U.snakify).join("_"));let o=[];if(i&&i.length>1&&r&&r.length>1)for(let t=0;t<i.length&&t<r.length;t++){let n=r[t];if(T(a.getTypeAtLocation(n),ts.TypeFlags.EnumLike)){let t=le(n).map(e.U.snakify);o=o.concat(t)}}let l=o.join("_"),c="";s||l||!t||(c=b(t.name));let u=([s,l,c].filter(e=>e).map(e.U.snakify).map(e=>e.toLowerCase()).join("_")||"my_callback").split("_");u.length>4&&(u=p(u));let d=e.U.toDictionary(["any","on","event"],e=>e);for(;u.length>2;){let e=h(u,d);if(e.length==u.length)break;u=e}return u=["on",...u],u.join("_");function p(e){let t={},n=[];for(let i of e)i in t||(t[i]=!0,n.push(i));return n}function h(e,t){let n=[],i=!1;for(let r of e)!(r in t)||i?n.push(r):i=!0;return n}}function ue(e){let n=e.join(", ");return n.length>60&&e.length>1?e.map((n,i)=>{let r=","==n.charAt(n.length-1)?"":",";if(0==i){let e=n.split("\n");if(e.length>1){n=e.shift()+"\n"+t.indent1(e.join("\n"))}return n+r}return i==e.length-1?t.indent1(n):t.indent1(n+r)}):[n]}function de(e,t,n,i,r){if((ts.isFunctionExpression(e)||ts.isArrowFunction(e))&&t&&t.type&&ts.isFunctionTypeNode(t.type)){let s;return fe(e,ce(t,n,i,r),s,!0)}return Ie(e)}function pe(t){let i=a.getTypeAtLocation(t.expression),r=a.typeToTypeNode(i),s=ts.createNodeArray([]);if(ts.isFunctionTypeNode(r)&&(s=r.parameters,t.arguments&&s.length<t.arguments.length))return e.tickEvent("depython.todo.argparammismatch",{kind:t.kind}),n(t,3010,"TODO: Unsupported call site where caller the arguments outnumber the callee parameters: "+t.getText());const o=_(t.expression);if(t.arguments&&o&&"TD_ID"==o.attributes.shim)return Ie(t.arguments[0]);if(ts.isPropertyAccessExpression(t.expression)&&"toString"===t.expression.name.getText()){const[e,n]=Ie(t.expression.expression);return[re("str(",e,")"),n]}let[l,c]=Ie(t.expression),u=ie(l),d=(t.arguments||ts.createNodeArray()).map((e,n,i)=>de(e,s[n],t.expression,s,i)),p=d.map(([e,t])=>t).reduce((e,t)=>e.concat(t),c);if(0===u.indexOf("_py.py_")){if(d.length<=0)return e.tickEvent("depython.todo._pynoargs"),n(t,3014,"Unsupported: call expression has no arguments for _py.py_ fn");u=u.substr(7).split("_").filter((e,t)=>0!==t).join("_");return[re(`${d.shift()[0]}.${u}(`,ue(d.map(([e,t])=>e).reduce((e,t)=>e.concat(t),[])),")"),p]}return[re(`${u}(`,ue(d.map(([e,t])=>e).reduce((e,t)=>e.concat(t),[])),")"),p]}function he(e,t){let n=[],i={};for(let r=0;r<Math.max(e.length,t.length);r++){let s;if(e[r])s=e[r],i[b(s.name)]=!0;else{s=t[r];let e=b(s.name);i[e]&&(e=pxtc.decompiler.getNewName(e,i),s=Object.assign({altName:e},t[r]))}n.push(s)}return ts.createNodeArray(n,!1)}function fe(e,t,n,r){if(i&&!ts.isBlock(e.body)){let[t,i]=Ie(e.body);if(0===i.length){let i=(n?he(e.parameters,n):e.parameters).map(e=>ee(e,!1)).join(", ");return ne(i.length?`lambda ${i}: ${ie(t)}`:`lambda: ${ie(t)}`)}}let s=e.name?b(e.name):v(t||"my_function");return ne(s,Q(e,s,n,r))}function me(e){switch(e){case ts.SyntaxKind.ExclamationToken:return" ";case ts.SyntaxKind.PlusToken:case ts.SyntaxKind.MinusToken:return"";default:return" "}}function ge(e){let t=se(e.operator,e),[n,i]=Ie(e.operand);return ne(`${t}${me(e.operator)}${ie(n)}`,i)}function _e(e){let t=se(e.operator,e),[n,i]=Ie(e.operand),r=me(e.operator);return ne(`${ie(n)}${r}${t}`,i)}function ye(e){let t=e.elements.map(Ie),n=t.map(([e,t])=>t).reduce((e,t)=>e.concat(t),[]),i=ue(t.map(([e,t])=>e).reduce((e,t)=>e.concat(t),[]));return[re("[",i,"]"),n]}function be(t){if(!t.argumentExpression)return e.tickEvent("depython.todo.accesswithoutexp"),n(t,3015,"Unsupported: element access expression without an argument expression");let[i,r]=Ie(t.expression),[s,o]=Ie(t.argumentExpression),a=r.concat(o);return ne(`${ie(i)}[${ie(s)}]`,a)}function ve(e){let[t,n]=Ie(e.expression);return ne(`(${ie(t)})`,n)}function Te(e){if(ts.isNoSubstitutionTemplateLiteral(e))return ne(`"""\n${e.text.trim().split("\n").map(e=>`${t.INDENT}${e.trim()}`).join("\n")}\n${t.INDENT}"""`);let[n,i]=Ie(e.tag),[r,s]=Ie(e.template),o=i.concat(s);return ne(`${ie(n)}(${ie(r)})`,o)}function ke(e){if("undefined"==e.text)return ne("None");return ne(b(e))}function xe(e,t){let n=e=>xe(e,t);return ts.isBinaryExpression(e)?n(e.left)&&n(e.right):ts.isPropertyAccessExpression(e)?n(e.expression):ts.isPrefixUnaryExpression(e)||ts.isPostfixUnaryExpression(e)?e.operator!==ts.SyntaxKind.PlusPlusToken&&e.operator!==ts.SyntaxKind.MinusMinusToken&&n(e.operand):ts.isParenthesizedExpression(e)?n(e.expression):ts.isArrayLiteralExpression(e)?e.elements.map(n).reduce((e,t)=>e&&t,!0):ts.isElementAccessExpression(e)?n(e.expression)&&(!e.argumentExpression||n(e.argumentExpression)):t(e)}function Ee(e){return e.parent?e.parent.kind===ts.SyntaxKind.ParenthesizedExpression?Ee(e.parent):e.parent:void 0}function Se(e){if("any"===e.type.getText().trim()&&(ts.isNumericLiteral(e.expression)||ts.isStringLiteral(e.expression)||e.expression.kind===ts.SyntaxKind.TrueKeyword||e.expression.kind===ts.SyntaxKind.FalseKeyword)){const t=Ee(e);if((null==t?void 0:t.kind)===ts.SyntaxKind.BinaryExpression)switch(t.operatorToken.kind){case ts.SyntaxKind.EqualsEqualsToken:case ts.SyntaxKind.EqualsEqualsEqualsToken:case ts.SyntaxKind.ExclamationEqualsToken:case ts.SyntaxKind.ExclamationEqualsEqualsToken:case ts.SyntaxKind.LessThanToken:case ts.SyntaxKind.LessThanEqualsToken:case ts.SyntaxKind.GreaterThanToken:case ts.SyntaxKind.GreaterThanEqualsToken:return!0}}return!1}function Ce(e){let t=e=>{switch(e.kind){case ts.SyntaxKind.PropertyAccessExpression:case ts.SyntaxKind.BinaryExpression:case ts.SyntaxKind.ParenthesizedExpression:case ts.SyntaxKind.ArrayLiteralExpression:case ts.SyntaxKind.ElementAccessExpression:case ts.SyntaxKind.TrueKeyword:case ts.SyntaxKind.FalseKeyword:case ts.SyntaxKind.NullKeyword:case ts.SyntaxKind.UndefinedKeyword:case ts.SyntaxKind.NumericLiteral:case ts.SyntaxKind.StringLiteral:case ts.SyntaxKind.NoSubstitutionTemplateLiteral:return!0;case ts.SyntaxKind.CallExpression:case ts.SyntaxKind.NewExpression:case ts.SyntaxKind.FunctionExpression:case ts.SyntaxKind.ArrowFunction:case ts.SyntaxKind.Identifier:case ts.SyntaxKind.ThisKeyword:return!1;case ts.SyntaxKind.PrefixUnaryExpression:case ts.SyntaxKind.PostfixUnaryExpression:let t=e;return t.operator!==ts.SyntaxKind.PlusPlusToken&&t.operator!==ts.SyntaxKind.MinusMinusToken}return!1};return xe(e,t)}function we(e){let[t,n]=Ie(e.condition),[i,r]=Ie(e.whenTrue),[s,o]=Ie(e.whenFalse),a=n.concat(r).concat(o);return ne(`${i} if ${ie(t)} else ${ie(s)}`,a)}function Ie(t){if(ts.isBinaryExpression(t))return oe(t);if(ts.isPropertyAccessExpression(t))return ae(t);if(ts.isCallExpression(t))return pe(t);if(ts.isNewExpression(t))return pe(t);if(ts.isFunctionExpression(t)||ts.isArrowFunction(t))return fe(t);if(ts.isPrefixUnaryExpression(t))return ge(t);if(ts.isPostfixUnaryExpression(t))return _e(t);if(ts.isParenthesizedExpression(t))return ve(t);if(ts.isArrayLiteralExpression(t))return ye(t);if(ts.isElementAccessExpression(t))return be(t);if(ts.isNoSubstitutionTemplateLiteral(t)||ts.isTaggedTemplateExpression(t))return Te(t);switch(t.kind){case ts.SyntaxKind.TrueKeyword:return ne("True");case ts.SyntaxKind.FalseKeyword:return ne("False");case ts.SyntaxKind.ThisKeyword:return ne("self");case ts.SyntaxKind.NullKeyword:case ts.SyntaxKind.UndefinedKeyword:return ne("None")}return ts.isIdentifier(t)?ke(t):ts.isNumericLiteral(t)||ts.isStringLiteral(t)?ne(t.getText()):ts.isConditionalExpression(t)?we(t):ts.isAsExpression(t)&&Se(t)?Ie(t.expression):(e.tickEvent("depython.todo.expression",{kind:t.kind}),n(t,3017,"Unsupported expression kind: "+t.kind))}}(s,o),c=o.replace(/(\.py)?\.\w*$/i,"")+".py";a.outfiles[c]=l}catch(t){t.pyDiagnostic?a.diagnostics=[t.pyDiagnostic]:e.reportException(t),a.success=!1}return a};const i=!1,r=!1;function s(e){return n=>(n||"").split("\n").map(n=>`${t.INDENT.repeat(e)}${n}`).join("\n")}t.INDENT="    ",t.indent=s,t.indent1=s(1)}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(e){!function(e){const t=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/;e.isIdentifierStart=function(e){return ts.pxtc.isIdentifierStart(e,ts.pxtc.ScriptTarget.ES5)},e.isIdentifierChar=function(e){return ts.pxtc.isIdentifierPart(e,ts.pxtc.ScriptTarget.ES5)},e.isSpace=function(e){return!!(32===e||9===e||11===e||12===e||160===e||e>=5760&&t.test(String.fromCharCode(e)))},e.isNewline=function(e){return 10===e||13===e||(8232===e||8233===e)}}(e.rx||(e.rx={}))}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(e){function t(e){const t={refs:[],children:[],owner:void 0};return function e(i){var r;if(!i)return t;if(ts.isPropertyAccessOrQualifiedName(i))return t;if(ts.isIdentifier(i))return{refs:[{kind:"read",node:i,varName:i.text}],children:[],owner:void 0};if(ts.isVariableDeclaration(i)||ts.isParameter(i)){const t=e(i.initializer);return{refs:[...t.refs,{kind:"decl",node:i,varName:i.name.getText()}],children:t.children,owner:void 0}}if(ts.isPrefixUnaryExpression(i)||ts.isPostfixUnaryExpression(i)){const t=e(i.operand),r=i.operand.getText();return n(t,{refs:[{kind:"assign",node:i,varName:r}],children:[],owner:void 0})}if(function(e){const t=[ts.SyntaxKind.EqualsToken,ts.SyntaxKind.PlusEqualsToken,ts.SyntaxKind.MinusEqualsToken,ts.SyntaxKind.AsteriskEqualsToken,ts.SyntaxKind.AsteriskAsteriskEqualsToken,ts.SyntaxKind.SlashEqualsToken,ts.SyntaxKind.PercentEqualsToken,ts.SyntaxKind.LessThanLessThanEqualsToken,ts.SyntaxKind.GreaterThanGreaterThanEqualsToken,ts.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,ts.SyntaxKind.AmpersandEqualsToken,ts.SyntaxKind.BarEqualsToken,ts.SyntaxKind.CaretEqualsToken];return ts.isBinaryExpression(e)&&t.some(t=>e.operatorToken.kind===t)}(i)){const t=e(i.right);let r;i.operatorToken.kind!==ts.SyntaxKind.EqualsToken&&(r=e(i.left));const s=i.left.getText();return n(r,n(t,{refs:[{kind:"assign",node:i,varName:s}],children:[],owner:void 0}))}if(ts.isFunctionExpression(i)||ts.isArrowFunction(i)||ts.isFunctionDeclaration(i)||ts.isMethodDeclaration(i)){const s=null===(r=i.name)||void 0===r?void 0:r.getText();let o;s&&(o={kind:"decl",node:i,varName:s});const a=n(i.parameters.map(t=>e(t)).reduce(n,t),e(i.body));return a.owner=i,{refs:o?[o]:[],children:[a],owner:void 0}}return i.getChildren().map(e).reduce(n,t)}(e);function n(e,n){return e&&n?{refs:[...e.refs,...n.refs],children:[...e.children,...n.children],owner:e.owner||n.owner}:e||n||t}}function n(e,t,i=[]){const r=[],s=[],o=[],a=[],l={};for(const n of e.refs)"read"===n.kind||"assign"===n.kind?l[n.varName]?o.push(n):d(n)?s.push(n):t&&t[n.varName]?r.push(n):a.push(n):l[n.varName]=n;const c=t||l,u=t?[...i,l]:[];return{globalUsage:r,nonlocalUsage:s,localUsage:o,environmentUsage:a,children:e.children.map(e=>n(e,c,u)),owner:e.owner};function d(e){return i.map(t=>t[e.varName]).reduce((e,t)=>t||e,void 0)}}function i(e){return`${e.kind}:${e.varName}`}e.computeScopeVariableLookup=function(e){const i=n(t(e)),r=new Map,s=new Map;return function e(t){const n=a((i=t,[...i.globalUsage,...i.environmentUsage].filter(e=>"assign"===e.kind).map(e=>e)));var i;r.set(t.owner,n);const o=a(function(e){return e.nonlocalUsage.filter(e=>"assign"===e.kind).map(e=>e)}(t));s.set(t.owner,o),t.children.forEach(e)}(i),{getExplicitGlobals:e=>r.get(e)||[],getExplicitNonlocals:e=>s.get(e)||[]};function o(e){let t=e.node.operand||e.node.left;return ts.isIdentifier(t)?t:void 0}function a(e){return e.map(o).filter(e=>!!e).map(e=>e).reduce((e,t)=>e.find(e=>e.text===t.text)?e:[...e,t],[])}},e.toStringVariableScopes=function(r){const s=t(r),o=n(s);return function t(n){return[n.refs.map(i).join(", "),...n.children.map(t).map(t=>t.map(e.indent1)).map(e=>["{",...e,"}"]).reduce((e,t)=>[...e,...t],[])]}(s).join("\n")+"\n\n\n"+function(t){return function t(n){const r=n.globalUsage.map(i).join(", "),s=n.nonlocalUsage.map(i).join(", "),o=n.localUsage.map(i).join(", "),a=n.environmentUsage.map(i).join(", ");return[r?"global "+r:"",s?"nonlocal "+s:"",o?"local "+o:"",a?"env "+a:"",...n.children.map(t).map(t=>t.map(e.indent1)).map(e=>["{",...e,"}"]).reduce((e,t)=>[...e,...t],[])].filter(e=>!!e)}(t).join("\n")}(o)}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){let n,i=!1;function r(e){const t=window.navigator&&/Mac/i.test(window.navigator.platform)?e.metaKey:e.ctrlKey;return"Escape"===e.key?(e.preventDefault(),"escape"):"/"===e.key&&t?(e.preventDefault(),"togglekeyboardcontrolshelp"):"b"===e.key&&t?(e.preventDefault(),"toggleareamenu"):null}t.makeFocusable=function(e){e.setAttribute("focusable","true"),e.setAttribute("tabindex","0")},t.getGlobalAction=r,t.postKeyboardEvent=function(){i||(i=!0,document.addEventListener("keydown",t=>{const n=r(t);if(n){const t={type:"action",action:n};e.Runtime.postMessage(t)}}))},t.enableKeyboardInteraction=function(e,t,n){t&&e.addEventListener("keydown",e=>{const n="number"==typeof e.which?e.which:e.keyCode;32!==n&&13!==n||t()}),n&&e.addEventListener("keyup",e=>{const t="number"==typeof e.which?e.which:e.keyCode;32!==t&&13!==t||n()})},t.setAria=function(e,t,n){t&&!e.hasAttribute("role")&&e.setAttribute("role",t),n&&!e.hasAttribute("aria-label")&&e.setAttribute("aria-label",n)},t.setLiveContent=function(e){if(!n){let e="position: absolute !important;display: block;visibility: visible;overflow: hidden;width: 1px;height: 1px;margin: -1px;border: 0;padding: 0;clip: rect(0 0 0 0);";n=document.createElement("div"),n.setAttribute("role","status"),n.setAttribute("aria-live","polite"),n.setAttribute("aria-hidden","false"),n.setAttribute("style",e),document.body.appendChild(n)}n.textContent!==e&&(n.textContent=e)}}(e.accessibility||(e.accessibility={}))}(pxsim||(pxsim={})),function(e){const t="blue",n="red",i="orange";const r=e=>(e=>e.reduce((e,t)=>e+(t?1:0),0))(e)>0;function s(e,t){let n={};for(let t in e)n[t]=e[t];for(let e in t)n[e]=t[e];return n}function o(t){e.U.assert(!!t,"Invalid pin: "+t);const n=/^(\w+)\.\s*(?:[a-z]*)?([A-Z][A-Z\d_]+)$/.exec(t);return n?n[2]:void 0}function a(e){return"-Z"===e.orientation&&"male"===e.style}e.readPin=o;class l{constructor(t){this.availablePowerPins={top:{fiveVolt:e.mkRange(26,51).map(e=>({type:"breadboard",row:"+",col:`${e}`})),threeVolt:e.mkRange(26,51).map(e=>({type:"breadboard",row:"+",col:`${e}`})),ground:e.mkRange(26,51).map(e=>({type:"breadboard",row:"-",col:`${e}`}))},bottom:{fiveVolt:e.mkRange(1,26).map(e=>({type:"breadboard",row:"+",col:`${e}`})),threeVolt:e.mkRange(1,26).map(e=>({type:"breadboard",row:"+",col:`${e}`})),ground:e.mkRange(1,26).map(e=>({type:"breadboard",row:"-",col:`${e}`}))}},this.opts=t}allocPartIRs(t,n,i){let r=[];const s=(t,n,r,s)=>{let o=[];for(let n=0;n<t.numberOfPins;n++){let s,a=t.pinDefinitions[n];if("string"==typeof a.target)s=a.target;else{let t=a.target.pinInstantiationIdx;if(!r||void 0===r[t])return void e.log(`error: parts no pin found for PinInstantiationIdx: ${t}. (Is the part missing an ArgumentRole or "trackArgs=" annotations?)`);s=r[t]}let l=t.visual.pinLocations[n],c=i.yOffset+l.y,u=Math.round(c/t.visual.pinDistance),d=c-u*t.visual.pinDistance,p=i.xOffset+l.x,h=Math.round(p/t.visual.pinDistance),f={partRelativeRowIdx:u,partRelativeColIdx:h,xOffset:p-h*t.visual.pinDistance,yOffset:d};o.push({def:a,loc:l,target:s,bbFit:f})}return{name:n,def:t,pins:o,partParams:s||{},bbFit:i}},a=t.instantiations||[];return t.instantiation&&a.push(t.instantiation),a.forEach(i=>{if("singleton"===i.kind)r.push(s(t,n));else if("function"===i.kind){let a=i,l=a.fullyQualifiedName.split(","),c={};l.forEach(e=>{this.opts.fnArgs[e]&&this.opts.fnArgs[e].forEach(e=>{c[e]=1})});let u=Object.keys(c);if(!u||!u.length)return void e.log(`error: parts failed to read pin(s) from callsite for: ${l}`);u.forEach(i=>{const c=i.split(",");if(c.length!=a.argumentRoles.length)return void e.log(`error: parts mismatch between number of arguments at callsite (function name: ${l}) vs number of argument roles in part definition (part: ${n}).`);let u=[],d={};c.forEach((e,t)=>{let n=a.argumentRoles[t];if(void 0!==n.partParameter&&(d[n.partParameter]=e),void 0!==n.pinInstantiationIdx){let t=n.pinInstantiationIdx,i=o(e);u[t]=i}}),r.push(s(t,n,u,d))})}}),r.filter(e=>!!e)}computePartDimensions(t,n){let i=t.visual.pinLocations,r=t.pinDefinitions,o=t.numberOfPins;e.U.assert(i.length===o,`Mismatch between "numberOfPins" and length of "visual.pinLocations" for "${n}"`),e.U.assert(r.length===o,`Mismatch between "numberOfPins" and length of "pinDefinitions" for "${n}"`),e.U.assert(o>0,`Part "${n}" has no pins`);let a,l,c,u,d=i.map((e,t)=>{return n={idx:t},i=e,o=r[t],s(s(n,i),o);var n,i,o}).filter(e=>"-Z"===e.orientation),p=d.length>0,h=t.visual.pinDistance;if(p){let e=d[0],n=Math.ceil(e.x/h),i=Math.ceil(e.y/h);a=n*h-e.x,l=i*h-e.y,c=Math.ceil((a+t.visual.width)/h)+1,u=Math.ceil((l+t.visual.height)/h)+1}else c=Math.ceil(t.visual.width/h),u=Math.ceil(t.visual.height/h),a=c*h-t.visual.width,l=u*h-t.visual.height;return{xOffset:a,yOffset:l,rowCount:u,colCount:c}}allocColumns(t){let n=t.length;let i=e.visuals.BREADBOARD_MID_COLS-t.map(e=>e.colCount).reduce((e,t)=>e+t,0);i<=0&&e.log("Not enough breadboard space!");let r=Math.floor(i/(n-1+2)),s=i-r*(n-1),o=Math.floor(s/2),a=(Math.ceil(s/2),1+o);return t.map(e=>{let t=a;return a+=e.colCount+r,t})}placeParts(t){const n=e.visuals.BREADBOARD_MID_ROWS+2;let i=this.allocColumns(t.map(e=>e.bbFit)),r=t.map(e=>{let t=n-e.bbFit.rowCount,i=Math.floor(t/2);return i>4&&(i=4),i<1&&(i=1),i});return t.map((e,t)=>{let n=r[t];return s({startColumnIdx:i[t],startRowIdx:n},e)})}nextColor(){return(!this.availableWireColors||this.availableWireColors.length<=0)&&(this.availableWireColors=e.visuals.GPIO_WIRE_COLORS.map(e=>e)),this.availableWireColors.pop()}allocWireIRs(r){let o=[],l=r.pins.map((s,l)=>{let c,u,d=s.target,p=r.startColumnIdx+s.bbFit.partRelativeColIdx,h=e.visuals.getColumnName(p),f=r.startRowIdx+s.bbFit.partRelativeRowIdx;if(f>=7&&(f-=2),a(s.def)){c={type:"breadboard",row:f<5?"j":"a",col:h,style:s.def.style}}else{c={type:"breadboard",row:e.visuals.getRowName(f),col:h,xOffset:s.bbFit.xOffset/r.def.visual.pinDistance,yOffset:s.bbFit.yOffset/r.def.visual.pinDistance,style:s.def.style}}return u="ground"===d?t:"threeVolt"===d?n:"fiveVolt"===d?i:"number"==typeof s.def.colorGroup?o[s.def.colorGroup]?o[s.def.colorGroup]:o[s.def.colorGroup]=this.nextColor():this.nextColor(),{start:c,end:d,color:u,pinIdx:l}});return s(r,{wires:l})}allocLocation(t,n){if("ground"===t||"threeVolt"===t||"fiveVolt"==t){if("ground"===t&&this.powerUsage.singleGround){return{type:"dalboard",pin:this.getBoardGroundPin()}}if("threeVolt"===t&&this.powerUsage.singleThreeVolt){return{type:"dalboard",pin:this.getBoardThreeVoltPin()}}if("fiveVolt"===t&&this.powerUsage.singleFiveVolt){return{type:"dalboard",pin:this.getBoardFiveVoltPin()}}e.U.assert(!!n.referenceBBPin);let i=this.opts.getBBCoord(n.referenceBBPin),r=[this.availablePowerPins.top.ground[0]||this.availablePowerPins.top.threeVolt[0],this.availablePowerPins.bottom.ground[0]||this.availablePowerPins.bottom.threeVolt[0]].map(e=>this.opts.getBBCoord(e));r[0]&&r[1]||e.debug(`No more available "${t}" locations!`);let s,o=0==e.visuals.findClosestCoordIdx(i,r);o?"ground"===t?s=this.availablePowerPins.top.ground:"threeVolt"===t?s=this.availablePowerPins.top.threeVolt:"fiveVolt"===t&&(s=this.availablePowerPins.top.fiveVolt):"ground"===t?s=this.availablePowerPins.bottom.ground:"threeVolt"===t?s=this.availablePowerPins.bottom.threeVolt:"fiveVolt"===t&&(s=this.availablePowerPins.bottom.fiveVolt);let a=s.map(e=>this.opts.getBBCoord(e)),l=e.visuals.findClosestCoordIdx(i,a),c=s[l];return o?(this.availablePowerPins.top.ground.splice(l,1),this.availablePowerPins.top.threeVolt.splice(l,1)):(this.availablePowerPins.bottom.ground.splice(l,1),this.availablePowerPins.bottom.threeVolt.splice(l,1)),c}if("breadboard"===t.type)return t;if("MOSI"===t||"MISO"===t||"SCK"===t){return this.opts.boardDef.spiPins||e.debug("No SPI pin mappings found!"),{type:"dalboard",pin:this.opts.boardDef.spiPins[t]}}if("SDA"===t||"SCL"===t){return this.opts.boardDef.i2cPins||e.debug("No I2C pin mappings found!"),{type:"dalboard",pin:this.opts.boardDef.i2cPins[t]}}{e.U.assert("string"==typeof t,"Unknown location type: "+t);let n=t,i=this.opts.boardDef.gpioPinMap[n]||n;return i?{type:"dalboard",pin:i}:void e.debug(`unknown pin location for ${n}`)}}getBoardGroundPin(){let t=this.opts.boardDef.groundPins&&this.opts.boardDef.groundPins[0]||null;return t||e.debug("No available ground pin on board!"),t}getBoardThreeVoltPin(){let t=this.opts.boardDef.threeVoltPins&&this.opts.boardDef.threeVoltPins[0]||null;return t||e.debug("No available 3.3V pin on board!"),t}getBoardFiveVoltPin(){let t=this.opts.boardDef.fiveVoltPins&&this.opts.boardDef.fiveVoltPins[0]||null;return t||e.debug("No available 5V pin on board!"),t}allocPowerWires(e){let r=this.getBoardGroundPin(),s=this.getBoardThreeVoltPin(),o=this.getBoardFiveVoltPin();const a={type:"breadboard",row:"-",col:"26"},l={type:"breadboard",row:"-",col:"1"},c={type:"breadboard",row:"-",col:"50"},u={type:"breadboard",row:"-",col:"25"};let d,p;this.opts.boardDef.attachPowerOnRight?(d=c,p=u):(d=a,p=l);let h=[],f=[],m=[];e.bottomGround&&e.topGround&&h.push({start:this.allocLocation("ground",{referenceBBPin:d}),end:this.allocLocation("ground",{referenceBBPin:p}),color:t}),e.topGround?h.push({start:this.allocLocation("ground",{referenceBBPin:d}),end:{type:"dalboard",pin:r},color:t}):e.bottomGround&&h.push({start:this.allocLocation("ground",{referenceBBPin:p}),end:{type:"dalboard",pin:r},color:t}),e.bottomThreeVolt&&e.bottomGround?f.push({start:this.allocLocation("threeVolt",{referenceBBPin:d}),end:this.allocLocation("threeVolt",{referenceBBPin:p}),color:n}):e.bottomFiveVolt&&e.bottomGround&&m.push({start:this.allocLocation("fiveVolt",{referenceBBPin:d}),end:this.allocLocation("fiveVolt",{referenceBBPin:p}),color:i}),e.topThreeVolt?f.push({start:this.allocLocation("threeVolt",{referenceBBPin:d}),end:{type:"dalboard",pin:s},color:n}):e.bottomThreeVolt&&f.push({start:this.allocLocation("threeVolt",{referenceBBPin:p}),end:{type:"dalboard",pin:s},color:i}),e.topFiveVolt&&!e.topThreeVolt?m.push({start:this.allocLocation("fiveVolt",{referenceBBPin:d}),end:{type:"dalboard",pin:o},color:n}):e.bottomFiveVolt&&!e.bottomThreeVolt&&m.push({start:this.allocLocation("fiveVolt",{referenceBBPin:p}),end:{type:"dalboard",pin:o},color:i});let g=[];h.length>0&&g.push({wireIndices:h.map((e,t)=>t)});let _=h.length;return f.length>0&&g.push({wireIndices:f.map((e,t)=>t+_)}),m.length>0&&g.push({wireIndices:f.map((e,t)=>t+_+f.length)}),{wires:h.concat(f).concat(m),assembly:g}}allocWire(e){const t=[e.start,e.end],n=t.map(e=>"ground"===e||"threeVolt"===e||"fiveVolt"===e);let i=t.map((e,t)=>n[t]?void 0:this.allocLocation(e,{}));if(i=i.map((e,n)=>{if(e)return e;const r=i[1-n];return this.allocLocation(t[n],{referenceBBPin:r})}),i[0]&&i[1])return{start:i[0],end:i[1],color:e.color}}allocPart(t){let n=t.pins.filter(e=>a(e.def)).map(n=>{let i=t.startRowIdx+n.bbFit.partRelativeRowIdx;i>=7&&(i-=2);let r=e.visuals.getRowName(i),s=t.startColumnIdx+n.bbFit.partRelativeColIdx;return{type:"breadboard",row:r,col:e.visuals.getColumnName(s)}});return{name:t.name,visual:t.def.visual,bbFit:t.bbFit,startColumnIdx:t.startColumnIdx,startRowIdx:t.startRowIdx,breadboardConnections:n,params:t.partParams,simulationBehavior:t.def.simulationBehavior}}allocAll(){let e=this.opts.partsList.map(e=>({name:e,def:this.opts.partDefs[e]})).filter(e=>!!e.def);if(e.length>0){let t=e.map(e=>this.computePartDimensions(e.def,e.name)),n=[];e.forEach((e,i)=>{let r=t[i],s=this.allocPartIRs(e.def,e.name,r);n=n.concat(s)});const i=this.placeParts(n).map(e=>this.allocWireIRs(e)),s=i.map(e=>e.wires).reduce((e,t)=>e.concat(t),[]).map(e=>function(e){let t=[e.start,e.end],n=t.map(e=>"ground"===e),i=t.map(e=>"threeVolt"===e),s=t.map(e=>"fiveVolt"===e),o=t.map(e=>function(e){let t=!1;if("string"!=typeof e&&"breadboard"===e.type){let n=e.row;t=0<=["a","b","c","d","e"].indexOf(n)}return t}(e)),a=r(n),l=r(i),c=r(s),u=r(o);return{topGround:a&&!u,topThreeVolt:l&&!u,topFiveVolt:c&&!u,bottomGround:a&&u,bottomThreeVolt:l&&u,bottomFiveVolt:c&&u,singleGround:a,singleThreeVolt:l,singleFiveVolt:c}}(e));this.powerUsage=function(e){const t=e.reduce((e,t)=>({topGround:e.topGround||t.topGround,topThreeVolt:e.topThreeVolt||t.topThreeVolt,topFiveVolt:e.topFiveVolt||t.topFiveVolt,bottomGround:e.bottomGround||t.bottomGround,bottomThreeVolt:e.bottomThreeVolt||t.bottomThreeVolt,bottomFiveVolt:e.bottomFiveVolt||t.bottomFiveVolt,singleGround:t.singleGround?null===e.singleGround:e.singleGround,singleThreeVolt:t.singleThreeVolt?null===e.singleThreeVolt:e.singleThreeVolt,singleFiveVolt:t.singleFiveVolt?null===e.singleFiveVolt:e.singleFiveVolt}),{topGround:!1,topThreeVolt:!1,topFiveVolt:!1,bottomGround:!1,bottomThreeVolt:!1,bottomFiveVolt:!1,singleGround:null,singleThreeVolt:null,singleFiveVolt:null});return t.singleGround&&(t.topGround=t.bottomGround=!1),t.singleThreeVolt&&(t.topThreeVolt=t.bottomThreeVolt=!1),t.singleFiveVolt&&(t.topFiveVolt=t.bottomFiveVolt=!1),t}(s);const o=this.allocPowerWires(this.powerUsage),a=i.map((e,t)=>{const n=this.allocPart(e),i=e.wires.map(e=>this.allocWire(e));if(i.some(e=>!e))return;const r=[];e.wires.forEach((e,t)=>{r[e.pinIdx]=t});return{part:n,wires:i,assembly:e.def.assembly.map(e=>({part:e.part,wireIndices:(e.pinIndices||[]).map(e=>r[e])}))}}).filter(e=>!!e),l=[o].concat(a).filter(e=>e.assembly&&e.assembly.length),c=!l.some(e=>e.part&&e.part.breadboardConnections&&e.part.breadboardConnections.length>0||e.wires&&e.wires.some(e=>"breadboard"==e.end.type&&"croc"!=e.end.style||"breadboard"==e.start.type&&"croc"!=e.start.style));return{partsAndWires:l,wires:[],parts:[],hideBreadboard:c}}return{partsAndWires:[],wires:[],parts:[]}}}e.allocateDefinitions=function(e){return new l(e).allocAll()}}(pxsim||(pxsim={})),function(e){!function(t){class n{constructor(e){this.seq=0,this.type=e}}t.Message=n;t.Response=class extends n{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};class i extends n{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}t.Event=i;t.Source=class{constructor(e,t,n=0,i,r){this.name=e,this.path=t,this.sourceReference=n,i&&(this.origin=i),r&&(this.adapterData=r)}};t.Scope=class{constructor(e,t,n=!1){this.name=e,this.variablesReference=t,this.expensive=n}};t.StackFrame=class{constructor(e,t,n,i=0,r=0){this.id=e,this.source=n,this.line=i,this.column=r,this.name=t}};t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};t.Variable=class{constructor(e,t,n=0,i,r){this.name=e,this.value=t,this.variablesReference=n,"number"==typeof r&&(this.namedVariables=r),"number"==typeof i&&(this.indexedVariables=i)}};t.Breakpoint=class{constructor(e,t,n,i){this.verified=e;const r=this;"number"==typeof t&&(r.line=t),"number"==typeof n&&(r.column=n),i&&(r.source=i)}};t.Module=class{constructor(e,t){this.id=e,this.name=t}};t.CompletionItem=class{constructor(e,t,n=0){this.label=e,this.start=t,this.length=n}};t.StoppedEvent=class extends i{constructor(e,t,n=null){if(super("stopped"),this.body={reason:e,threadId:t},n){this.body.text=n}}};t.ContinuedEvent=class extends i{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}};t.InitializedEvent=class extends i{constructor(){super("initialized")}};t.TerminatedEvent=class extends i{constructor(e){if(super("terminated"),"boolean"==typeof e){this.body={restart:e}}}};t.OutputEvent=class extends i{constructor(e,t="console",n){super("output"),this.body={category:t,output:e},void 0!==n&&(this.body.data=n)}};t.ThreadEvent=class extends i{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}};t.BreakpointEvent=class extends i{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}};t.ModuleEvent=class extends i{constructor(e,t){super("module"),this.body={reason:e,module:t}}};class r{constructor(){this._pendingRequests={}}start(e){this._sequence=1,this.host=e,this.host.onData(e=>{if("request"===e.type)this.dispatchRequest(e);else if("response"===e.type){const t=e,n=this._pendingRequests[t.seq];n&&(delete this._pendingRequests[t.seq],n(t))}})}stop(){this.host&&this.host.close()}sendEvent(e){this.send("event",e)}sendResponse(t){t.seq>0?e.error(`attempt to send more than one response for command ${t.command}`):this.send("response",t)}sendRequest(e,n,i,r){const s={command:e};if(n&&Object.keys(n).length>0&&(s.arguments=n),this.send("request",s),r){this._pendingRequests[s.seq]=r;const e=setTimeout(()=>{clearTimeout(e);const n=this._pendingRequests[s.seq];n&&(delete this._pendingRequests[s.seq],n(new t.Response(s,"timeout")))},i)}}send(e,t){if(t.type=e,t.seq=this._sequence++,this.host){const e=JSON.stringify(t);this.host.send(e)}}dispatchRequest(e){}}t.ProtocolServer=r;class s extends r{constructor(){super(...arguments),this._debuggerLinesStartAt1=!1,this._debuggerColumnsStartAt1=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0}shutdown(){}dispatchRequest(e){const n=new t.Response(e);try{if("initialize"===e.command){let t=e.arguments;if("boolean"==typeof t.linesStartAt1&&(this._clientLinesStartAt1=t.linesStartAt1),"boolean"==typeof t.columnsStartAt1&&(this._clientColumnsStartAt1=t.columnsStartAt1),"path"!==t.pathFormat)this.sendErrorResponse(n,2018,"debug adapter only supports native paths",null);else{const e=n;e.body={},this.initializeRequest(e,t)}}else"launch"===e.command?this.launchRequest(n,e.arguments):"attach"===e.command?this.attachRequest(n,e.arguments):"disconnect"===e.command?this.disconnectRequest(n,e.arguments):"setBreakpoints"===e.command?this.setBreakPointsRequest(n,e.arguments):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(n,e.arguments):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(n,e.arguments):"configurationDone"===e.command?this.configurationDoneRequest(n,e.arguments):"continue"===e.command?this.continueRequest(n,e.arguments):"next"===e.command?this.nextRequest(n,e.arguments):"stepIn"===e.command?this.stepInRequest(n,e.arguments):"stepOut"===e.command?this.stepOutRequest(n,e.arguments):"stepBack"===e.command?this.stepBackRequest(n,e.arguments):"restartFrame"===e.command?this.restartFrameRequest(n,e.arguments):"goto"===e.command?this.gotoRequest(n,e.arguments):"pause"===e.command?this.pauseRequest(n,e.arguments):"stackTrace"===e.command?this.stackTraceRequest(n,e.arguments):"scopes"===e.command?this.scopesRequest(n,e.arguments):"variables"===e.command?this.variablesRequest(n,e.arguments):"setVariable"===e.command?this.setVariableRequest(n,e.arguments):"source"===e.command?this.sourceRequest(n,e.arguments):"threads"===e.command?this.threadsRequest(n):"evaluate"===e.command?this.evaluateRequest(n,e.arguments):"stepInTargets"===e.command?this.stepInTargetsRequest(n,e.arguments):"gotoTargets"===e.command?this.gotoTargetsRequest(n,e.arguments):"completions"===e.command?this.completionsRequest(n,e.arguments):this.customRequest(e.command,n,e.arguments)}catch(e){this.sendErrorResponse(n,1104,"{_stack}",{_exception:e.message,_stack:e.stack})}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.sendResponse(e)}attachRequest(e,t){this.sendResponse(e)}setBreakPointsRequest(e,t){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e)}continueRequest(e,t){this.sendResponse(e)}nextRequest(e,t){this.sendResponse(e)}stepInRequest(e,t){this.sendResponse(e)}stepOutRequest(e,t){this.sendResponse(e)}stepBackRequest(e,t){this.sendResponse(e)}restartFrameRequest(e,t){this.sendResponse(e)}gotoRequest(e,t){this.sendResponse(e)}pauseRequest(e,t){this.sendResponse(e)}sourceRequest(e,t){this.sendResponse(e)}threadsRequest(e){this.sendResponse(e)}stackTraceRequest(e,t){this.sendResponse(e)}scopesRequest(e,t){this.sendResponse(e)}variablesRequest(e,t){this.sendResponse(e)}setVariableRequest(e,t){this.sendResponse(e)}evaluateRequest(e,t){this.sendResponse(e)}stepInTargetsRequest(e,t){this.sendResponse(e)}gotoTargetsRequest(e,t){this.sendResponse(e)}completionsRequest(e,t){this.sendResponse(e)}customRequest(e,t,n){this.sendErrorResponse(t,1014,"unrecognized request",null)}sendErrorResponse(e,t,n,i){let r;"number"==typeof t?(r={id:t,format:n},i&&(r.variables=i),r.showUser=!0):r=t,e.success=!1,s.formatPII(r.format,!0,r.variables),e.body||(e.body={}),e.body.error=r,this.sendResponse(e)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!=this._debuggerPathsAreURIs?this._clientPathsAreURIs?s.uri2path(e):s.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!=this._clientPathsAreURIs?this._debuggerPathsAreURIs?s.uri2path(e):s.path2uri(e):e}static path2uri(e){let t=e.replace(/\\/g,"/");return"/"!==t[0]&&(t="/"+t),encodeURI("file://"+t)}static uri2path(e){return e}static formatPII(e,t,n){return e.replace(s._formatPIIRegexp,function(e,i){return t&&i.length>0&&"_"!==i[0]?e:n[i]&&n.hasOwnProperty(i)?n[i]:e})}}s._formatPIIRegexp=/{([^}]+)}/g,t.DebugSession=s}(e.protocol||(e.protocol={}))}(pxsim||(pxsim={})),function(e){!function(e){e.injectPolyphils=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){return void 0!==e&&null!=e&&(t=!t||t<0?0:+t,this.substring(t,t+e.length)===e)}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{writable:!0,enumerable:!0,value:function(e){if(null==this)throw new TypeError("this is null or not defined");let t=Object(this),n=t.length>>>0,i=arguments[1]|0,r=i<0?Math.max(n+i,0):Math.min(i,n),s=arguments[2],o=void 0===s?n:s|0,a=o<0?Math.max(n+o,0):Math.min(o,n);for(;r<a;)t[r]=e,r++;return t}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{writable:!0,enumerable:!0,value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');let t=Object(this);const n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");const i=arguments[1];let r=0;for(;r<n;){const n=t[r];if(e.call(i,n,r,t))return n;r++}}}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint16Array.prototype.slice||Object.defineProperty(Uint16Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint32Array.prototype.slice||Object.defineProperty(Uint32Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint8Array.prototype.fill||Object.defineProperty(Uint8Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint16Array.prototype.fill||Object.defineProperty(Uint16Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint32Array.prototype.fill||Object.defineProperty(Uint32Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint8Array.prototype.some||Object.defineProperty(Uint8Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint16Array.prototype.some||Object.defineProperty(Uint16Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint32Array.prototype.some||Object.defineProperty(Uint32Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint8Array.prototype.reverse||Object.defineProperty(Uint8Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Uint16Array.prototype.reverse||Object.defineProperty(Uint16Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Uint32Array.prototype.reverse||Object.defineProperty(Uint32Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Math.imul||(Math.imul=function(e,t){const n=65535&e,i=65535&t;return n*i+((e>>>16&65535)*i+n*(t>>>16&65535)<<16>>>0)|0}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");let n=Object(e);for(let e=1;e<arguments.length;e++){let t=arguments[e];if(null!=t)for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},writable:!0,configurable:!0}),Promise.prototype.finally||(Promise.prototype.finally=Promise.prototype.finally||{finally(e){const t=t=>Promise.resolve(e()).then(t);return this.then(e=>t(()=>e),e=>t(()=>Promise.reject(e)))}}.finally)};function t(e){e=e.replace(/\\/g,"/");const t=[];return e.split("/").forEach(e=>{".."===e&&t.length?t.pop():e&&"."!==e&&t.push(e)}),t}e.Lazy=class{constructor(e){this._func=e,this._evaluated=!1}get value(){return this._evaluated||(this._value=this._func(),this._evaluated=!0),this._value}},e.getNormalizedParts=t,e.normalizePath=function(e){return t(e).join("/")},e.relativePath=function(e,n){const i=t(e),r=t(n);let s=0;for(;i[s]===r[s]&&(s++,s!==i.length&&s!==r.length););const o=i.slice(s),a=r.slice(s);for(let e=0;e<o.length;e++)a.unshift("..");return a.join("/")},e.pathJoin=function(...e){let t="";return e.forEach(e=>{e.replace(/\\/g,"/"),e.lastIndexOf("/")===e.length-1&&(e=e.slice(0,e.length-1)),t+="/"+e}),t},e.toArray=function(e){if(Array.isArray(e))return e;let t=[];for(let n=0;n<e.length;++n)t.push(e[n]);return t}}(e.util||(e.util={}))}(pxsim||(pxsim={})),function(e){e.getWarningMessage=function(t){let n={type:"debugger",subtype:"warning",breakpointIds:[],message:t},i=e.runtime.currFrame;for(;null!=i;)n.breakpointIds.push(i.lastBrkId),i=i.parent;return n};function t(t,n){switch(typeof t){case"string":case"number":case"boolean":return t;case"function":return{text:"(function)",type:"function"};case"undefined":return null;case"object":if(!t)return null;if(t instanceof e.RefObject){n&&(n[t.id]=t);let i=e.RefObject.toDebugString(t),r=i.startsWith("[")?"array":i;return{id:t.id,preview:i,hasFields:null!==t.fields||i.startsWith("["),type:r}}return t._width&&t._height?{text:t._width+"x"+t._height,type:"image"}:{text:"(object)",type:"object"};default:throw new Error}}function n(n,r,s,o,a=!1){return function(n,s){const l={};for(let e of Object.keys(n))/^__/.test(e)||!/___\d+$/.test(e)||o&&-1===o.indexOf(e)||(l[e]=t(n[e],r));if(n.fields&&s)for(let e of s)e=e.substring(e.lastIndexOf(".")+1),l[e]=t(i(n.vtable.iface[e],n),r);if(n.fields)for(let e of Object.keys(n.fields).filter(e=>a||!e.startsWith("_")))l[e]=t(n.fields[e],r);else if(n instanceof e.RefMap)for(const e of n.data)l[e.key]=t(e.val,r);else Array.isArray(n.data)?n.data.forEach((e,n)=>{l[n]=t(e,r)}):void 0!==n._width&&void 0!==n._height&&(l.width=n._width,l.height=n._height,a&&void 0!==n._bpp&&(l.isMono=1===n._bpp));return l}(n,s)}function i(e,t){let n={pc:0,arg0:t,fn:e,parent:{}};for(;n.fn;)n=n.fn(n);return n.retval}function r(e,i){let r=e.fn?e.fn.info:null;if(r){let s={thisParam:t(e.argL,i),params:[]};if(r.argumentNames){const n=r.argumentNames;s.params=n.map((n,r)=>({name:n,value:t(e["arg"+r],i)}))}return{locals:n(e,i),funcInfo:r,breakpointId:e.lastBrkId,callLocationId:e.callLocIdx,arguments:s}}}e.BreakpointMap=class{constructor(e){this.fileMap={},this.idMap={},e.forEach(e=>{const[t,n]=e;this.fileMap[n.source.path]||(this.fileMap[n.source.path]=[]),this.fileMap[n.source.path].push(e),this.idMap[t]=n});for(const e in this.fileMap){const t=this.fileMap[e];this.fileMap[e]=t.sort(([,e],[,t])=>e.line===t.line?t.endLine===e.endLine?e.column-t.column:t.endLine-e.endLine:e.line-t.line)}}getById(e){return this.idMap[e]}verifyBreakpoint(e,t){const n=this.fileMap[e];let i;if(n)for(const[e,r]of n)r.line<=t.line&&r.endLine>=t.line&&(i=[e,r]);return i?(i[1].verified=!0,i):[-1,{verified:!1}]}},e.dumpHeap=n,e.injectEnvironmentGlobals=function(n,i){const r=e.runtime.environmentGlobals;if(!Object.keys(r).length)return;const s=n.environmentGlobals={};Object.keys(r).forEach(n=>s[n]=t(e.runtime.environmentGlobals[n],i))},e.getBreakpointMsg=function(t,i,s){const o={},a={type:"debugger",subtype:"breakpoint",breakpointId:i,globals:n(e.runtime.globals,o,void 0,s),stackframes:[]};for(;null!=t;){let e=r(t,o);e&&a.stackframes.push(e),t=t.parent}return{msg:a,heap:o}};class s extends e.protocol.DebugSession{constructor(t){super();let n={onDebuggerBreakpoint:e=>this.onDebuggerBreakpoint(e),onDebuggerWarning:e=>this.onDebuggerWarning(e),onDebuggerResume:()=>this.onDebuggerResume(),onStateChanged:e=>this.onStateChanged(e)};this.driver=new e.SimulatorDriver(t,n)}runCode(t,n,i,r,s){this.breakpoints=r,this.projectDir&&this.fixBreakpoints(),this.sendEvent(new e.protocol.InitializedEvent),this.driver.run(t,{parts:n,fnArgs:i,boardDefinition:s})}stopSimulator(e=!1){this.driver.stop(e)}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsConfigurationDoneRequest=!0,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(t,n){this.projectDir||(this.projectDir=e.util.normalizePath(n.projectDir),this.breakpoints&&this.fixBreakpoints()),this.sendResponse(t)}setBreakPointsRequest(t,n){t.body={breakpoints:[]};const i=[];n.breakpoints.forEach(r=>{if(this.breakpoints){const[s,o]=this.breakpoints.verifyBreakpoint(e.util.relativePath(this.projectDir,n.source.path),r);t.body.breakpoints.push(o),o.verified&&i.push(s)}else t.body.breakpoints.push({verified:!1})}),this.driver.setBreakpoints(i),this.sendResponse(t)}continueRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.Resume),this.sendResponse(t)}nextRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.StepOver),this.sendResponse(t)}stepInRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.StepInto),this.sendResponse(t)}stepOutRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.StepOut),this.sendResponse(t)}pauseRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.Pause),this.sendResponse(t)}threadsRequest(e){e.body={threads:[{id:s.THREAD_ID,name:"main"}]},this.sendResponse(e)}stackTraceRequest(e,t){if(this.lastBreak){const t=this.state.getFrames();e.body={stackFrames:t}}this.sendResponse(e)}scopesRequest(e,t){this.state&&(e.body={scopes:this.state.getScopes(t.frameId)}),this.sendResponse(e)}variablesRequest(e,t){this.state&&(e.body={variables:this.state.getVariables(t.variablesReference)}),this.sendResponse(e)}onDebuggerBreakpoint(t){if(this.lastBreak=t,this.state=new o(this.lastBreak,this.breakpoints,this.projectDir),t.exceptionMessage){const n=t.exceptionMessage.replace(/___\d+/g,"");this.sendEvent(new e.protocol.StoppedEvent("exception",s.THREAD_ID,n))}else this.sendEvent(new e.protocol.StoppedEvent("breakpoint",s.THREAD_ID))}onDebuggerWarning(e){}onDebuggerResume(){this.sendEvent(new e.protocol.ContinuedEvent(s.THREAD_ID,!0))}onStateChanged(t){switch(t){case e.SimulatorState.Paused:break;case e.SimulatorState.Running:this.sendEvent(new e.protocol.ContinuedEvent(s.THREAD_ID,!0));break;case e.SimulatorState.Stopped:this.sendEvent(new e.protocol.TerminatedEvent)}}fixBreakpoints(){for(const t in this.breakpoints.idMap){const n=this.breakpoints.idMap[t];n.source.path=e.util.pathJoin(this.projectDir,n.source.path),n.line=this.convertDebuggerLineToClient(n.line),n.endLine=this.convertDebuggerLineToClient(n.endLine),n.column=this.convertDebuggerColumnToClient(n.column),n.endColumn=this.convertDebuggerColumnToClient(n.endColumn)}}}s.THREAD_ID=1,e.SimDebugSession=s;class o{constructor(e,t,n){this._message=e,this._map=t,this._dir=n,this._currentId=1,this._frames={},this._vars={};const i=this.nextId();this._vars[i]=this.getVariableValues(this._message.globals),this._globalScope={name:"Globals",variablesReference:i,expensive:!1}}getFrames(){return this._message.stackframes.map((e,t)=>{const n=this._map.getById(e.breakpointId);if(n)return this._frames[e.breakpointId]=e,{id:e.breakpointId,name:e.funcInfo?e.funcInfo.functionName:0===t?"main":"anonymous",line:n.line,column:n.column,endLine:n.endLine,endColumn:n.endLine,source:n.source}}).filter(e=>!!e)}getScopes(e){const t=this._frames[e];if(t){const e=this.nextId();return this._vars[e]=this.getVariableValues(t.locals),[{name:"Locals",variablesReference:e,expensive:!1},this._globalScope]}return[this._globalScope]}getVariables(e){const t=this._vars[e];return t&&t.value||[]}getVariableValues(t){return new e.util.Lazy(()=>{const e=[];for(const n in t){const i=t[n];let r,s=0;null===i?r="null":void 0===i?r="undefined":"object"==typeof i?(r="(object)",s=this.nextId(),this._vars[s]=this.getVariableValues(i)):r=i.toString();const o=n.substr(0,n.lastIndexOf("___"));e.push({name:o,value:r,variablesReference:s})}return e})}nextId(){return this._currentId++}}}(pxsim||(pxsim={})),function(e){let t,n;function i(e=0){function t(){try{window.print()}catch(e){}}e?setTimeout(t,e):t()}function r(e,t){s({type:"pxtsim",action:"event",tick:e,data:t})}function s(e){"undefined"!=typeof window&&window.parent&&window.parent!==window&&window.parent.postMessage(e,"*")}function o(){setInterval(()=>{e.Runtime.postMessage({type:"simulator",command:"reload"})},3e3)}!function(e){let t;!function(e){e[e.Player=0]="Player",e[e.Reaction=1]="Reaction"}(t=e.IconType||(e.IconType={}))}(t=e.multiplayer||(e.multiplayer={})),e.print=i,function(t){function n(t){t.origin;let n=t.data||{},o=n.type;if(o)switch(o){case"run":l(n);break;case"instructions":e.instructions.renderInstructions(n);break;case"stop":a();break;case"mute":c(n.mute);break;case"stopsound":e.AudioContextManager.stopAll();break;case"print":i();break;case"recorder":!function(e){if(!s)return;switch(e.action){case"start":s.startRecording(e.width);break;case"stop":s.stopRecording()}}(n);break;case"screenshot":e.Runtime.postScreenshotAsync(n);break;case"custom":e.handleCustomMessage&&e.handleCustomMessage(n);break;case"pxteditor":break;case"debugger":s&&s.handleDebuggerMsg(n);break;case"simulator":let t=n;switch(t.command){case"focus":r("simulator.focus",{timestamp:t.timestamp});break;case"blur":r("simulator.blur",{timestamp:t.timestamp})}default:!function(e){if(!s||s.dead)return;s.board.receiveMessage(e)}(n)}}let s;function a(){s&&(s.kill(),s.board&&s.board.kill())}function l(t){a(),t.mute&&c(t.mute),t.localizedStrings&&e.localization.setLocalizedStrings(t.localizedStrings);const n=new e.Runtime(t);s=n,n.board.initAsync(t).then(()=>{n===s&&n.run(t=>{e.dumpLivePointers(),e.Runtime.postMessage({type:"toplevelcodefinished"})})})}function c(t){e.AudioContextManager.mute(t)}t.start=function(){window.addEventListener("message",n,!1),t.frameid=window.location.hash.slice(1),function(){if("serviceWorker"in navigator&&-1!==window.location.href.indexOf("---simulator")&&!e.U.isLocalHost()){const t=window.location.pathname,n=t.substring(1,t.indexOf("---"));navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("message",e=>{const t=e.data;t&&"serviceworker"===t.type&&"activated"===t.state&&t.ref===n&&o()});const i=window.location.href.replace(/---simulator.*$/,"---simserviceworker");navigator.serviceWorker.register(i).then(function(t){e.log("Simulator ServiceWorker registration successful with scope: ",t.scope)},function(t){e.log("Simulator ServiceWorker registration failed: ",t)})}}(),e.Runtime.postMessage({type:"ready",frameid:t.frameid})},t.stop=a,t.run=l}(n=e.Embed||(e.Embed={})),e.tickEvent=r,e.reportError=function(e,t,n){s({type:"pxtsim",action:"event",tick:"error",category:e,message:t,data:n})},e.reload=o}(pxsim||(pxsim={})),pxsim.util.injectPolyphils(),"undefined"!=typeof window&&window.addEventListener("load",function(e){pxsim.Embed.start()}),function(e){!function(t){const n=e=>`${e}x`,i=.95,[r,s]=[816*i,1056*i],o=r-86.4,a=s-86.4,l="gray",[c,u]=[1,1],d=24,p=o/u-48*u,h=`\n            .instr-panel {\n                margin: 20px;\n                padding: 24px;\n                border-width: 4px;\n                border-color: ${l};\n                border-style: solid;\n                border-radius: 20px;\n                display: inline-block;\n                width: ${p}px;\n                height: ${a/c-48*c}px;\n                position: relative;\n                overflow: hidden;\n                page-break-inside: avoid;\n            }\n            .board-svg {\n                margin: 0 auto;\n                display: block;\n                position: absolute;\n                bottom: 24px;\n                left: ${(p-465)/2+d}px;\n            }\n            .panel-num-outer {\n                position: absolute;\n                left: -4px;\n                top: -4px;\n                width: 120px;\n                height: 120px;\n                border-width: 4px;\n                border-style: solid;\n                border-color: ${l};\n                border-radius: 20px 0 20px 0;\n            }\n            .panel-num {\n                margin: 10px 0;\n                text-align: center;\n                font-size: 80px;\n            }\n            .cmp-div {\n                display: inline-block;\n            }\n            .reqs-div {\n                margin-left: 144px;\n                margin-top: 5px;\n            }\n            .partslist-wire,\n            .partslist-cmp {\n                margin: 10px;\n            }\n            .partslist-wire {\n                display: inline-block;\n            }\n            `;function f(t,n){let i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r={l:0,t:0,w:0,h:0},s=document.createElementNS("http://www.w3.org/2000/svg","svg");i.appendChild(s),s.appendChild(t.el);let o={viewBox:`${t.x} ${t.y} ${t.w} ${t.h}`,preserveAspectRatio:"xMidYMid"};r.w=t.w,r.h=t.h;let a=e=>{r.h*=e,r.w*=e,o.width=r.w,o.height=r.h};n.cmpScale&&a(n.cmpScale),n.cmpWidth&&n.cmpWidth<r.w?a(n.cmpWidth/r.w):n.cmpHeight&&n.cmpHeight<r.h&&a(n.cmpHeight/r.h),e.svg.hydrate(s,o);let l=r.l,c=r.t,u=r.w,d=r.h,p=e=>{if(e<r.l){let t=r.l-e;r.l=e,r.w+=t}},h=e=>{let t=r.l+r.w;if(t<e){let n=e-t;r.w+=n}},f=e=>{if(e<r.t){let t=r.t-e;r.t=e,r.h+=t}},m=e=>{let t=r.t+r.h;if(t<e){let n=e-t;r.h+=n}},[g,_]=[-.3,.3];const y=[1.4,1];if(n&&n.top){let t=n.topSize,r=t/y[0],s=t/y[1],[o,a]=[l+u/2,c-3-s/2],d=e.visuals.mkTxt(o,a,t,0,n.top,g,_);e.U.addClass(d,"cmp-lbl"),i.appendChild(d);let m=r*n.top.length;f(a-s/2),p(o-m/2),h(o+m/2)}if(n&&n.bot){let t=n.botSize,r=t/y[0],s=t/y[1],[o,a]=[l+u/2,c+d+3+s/2],f=e.visuals.mkTxt(o,a,t,0,n.bot,g,_);e.U.addClass(f,"cmp-lbl"),i.appendChild(f);let b=r*n.bot.length;m(a+s/2),p(o-b/2),h(o+b/2)}if(n&&n.right){let t=n.rightSize,r=t/y[1],s=t/y[0]*n.right.length,[o,a]=[l+u+5+s/2,c+d/2],p=e.visuals.mkTxt(o,a,t,0,n.right,g,_);e.U.addClass(p,"cmp-lbl"),i.appendChild(p),f(a-r/2),h(o+s/2),m(a+r/2)}if(n&&n.left){let t=n.leftSize,r=t/y[1],s=t/y[0]*n.left.length,[o,a]=[l-5-s/2,c+d/2],u=e.visuals.mkTxt(o,a,t,0,n.left,g,_);e.U.addClass(u,"cmp-lbl"),i.appendChild(u),f(a-r/2),p(o-s/2),m(a+r/2)}let b={viewBox:`${r.l} ${r.t} ${r.w} ${r.h}`,width:1.7*r.w,height:1.7*r.h,preserveAspectRatio:"xMidYMid"};e.svg.hydrate(i,b);let v=document.createElement("div");return v.appendChild(i),v}function m(t,n){let i,r=e.runtime.board;if("wire"==t)i=e.visuals.mkWirePart([0,0],n.wireClr||"red",n.crocClips);else{let n=t;if("string"==typeof n.builtIn){i=(0,r.builtinPartVisuals[n.builtIn])([0,0])}else i=e.visuals.mkGenericPartSVG(n)}return f(i,n)}function g(t,n,i=!1){const r={state:e.runtime.board,boardDef:t.boardDef,forceBreadboardLayout:!0,forceBreadboardRender:t.allAlloc.requiresBreadboard,partDefs:t.cmpDefs,maxWidth:`${n}px`,fnArgs:t.fnArgs,wireframe:i,partsList:[]};let s=new e.visuals.BoardHost(e.visuals.mkBoardView({visual:r.boardDef.visual,boardDef:r.boardDef,wireframe:r.wireframe}),r),o=s.getView();return e.U.addClass(o,"board-svg"),s}function _(){let t=document.createElement("div");return e.U.addClass(t,"instr-panel"),t}function y(t){let i=_();var r;let s=f((r=t.boardDef,e.visuals.mkBoardView({visual:r.visual,boardDef:r}).getView()),{left:n(1),leftSize:30,cmpScale:.17});i.appendChild(s);let o=f(new e.visuals.Breadboard({}).getSVGAndSize(),{left:n(1),leftSize:30,cmpScale:.25});return i.appendChild(o),t.allCmps.forEach(t=>{let r=1;"buttonpair"===t.visual.builtIn&&(r=2);let s=m(t.visual,{left:n(r),leftSize:30,cmpScale:.3});e.U.addClass(s,"partslist-cmp"),i.appendChild(s)}),t.allWireColors.forEach(r=>{let s=t.colorToWires[r].length,o=t.boardDef.pinStyles[r]||"female",a=m("wire",{left:n(s),leftSize:20,wireClr:r,cmpScale:.23,crocClips:"croc"==o});e.U.addClass(a,"partslist-wire"),i.appendChild(a)}),i}function b(t,n){let i=_(),r=g(n,465,!0);!function(t,n,i){let r=t.getView();n>0&&e.U.addClass(r,"grayed");for(let r=0;r<=n;r++){let s=i.stepToCmps[r];s&&s.forEach(i=>{let s=t.addPart(i);r===n&&(i.breadboardConnections.forEach(e=>t.highlightBreadboardPin(e)),e.U.addClass(s.element,"notgrayed"))});let o=i.stepToWires[r];o&&o.forEach(e=>{let i=t.addWire(e);i&&r===n&&("breadboard"==e.start.type?t.highlightBreadboardPin(e.start):t.highlightBoardPin(e.start.pin),"breadboard"==e.end.type?t.highlightBreadboardPin(e.end):t.highlightBoardPin(e.end.pin),t.highlightWire(i))})}}(r,t,n),i.appendChild(r.getView());let s=document.createElement("div");e.U.addClass(s,"panel-num-outer"),e.U.addClass(s,"noselect"),i.appendChild(s);let o=document.createElement("div");e.U.addClass(o,"panel-num"),o.textContent=t+1+"",s.appendChild(o);let a=document.createElement("div");e.U.addClass(a,"reqs-div"),i.appendChild(a);let l=n.stepToWires[t]||[],c=e=>{if("breadboard"===e.type){let{row:t,col:n}=e;return`(${t},${n})`}return e.pin};return l.forEach(t=>{let i=!1;"dalboard"==t.end.type&&(i="croc"==n.boardDef.pinStyles[t.end.pin]);let r=m("wire",{top:c(t.end),topSize:10,bot:c(t.start),botSize:10,wireClr:t.color,cmpHeight:40,crocClips:i});e.U.addClass(r,"cmp-div"),a.appendChild(r)}),(n.stepToCmps[t]||[]).forEach(t=>{let n;n="buttonpair"===t.visual.builtIn?[t.breadboardConnections[0],t.breadboardConnections[2]]:[t.breadboardConnections[0]],n.forEach((n,i)=>{let r;if(n){let{row:e,col:t}=n;r=`(${e},${t})`}else r="";let s=1.5;"buttonpair"===t.visual.builtIn&&(s*=.5);let o=m(t.visual,{top:r,topSize:10,cmpHeight:50,cmpScale:s});e.U.addClass(o,"cmp-div"),a.appendChild(o)})}),i}function v(t,n){n.boardDef.pinStyles||(n.boardDef.pinStyles={}),n.configData&&e.setConfigData(n.configData.cfg,n.configData.cfgKey);const i={type:"run",code:"",boardDefinition:n.boardDef,partDefinitions:n.partDefinitions};e.runtime=new e.Runtime(i),e.runtime.board=null,e.initCurrentRuntime(i);let r=document.createElement("style");r.textContent+=h,document.head.appendChild(r);const s=n.partDefinitions;let o=new e.visuals.Breadboard({}),a=function(t){let n=e.allocateDefinitions(t),i=[],r=[],s=1;n.partsAndWires.forEach(e=>{let t=e.part,n=e.wires;e.assembly.forEach((e,o)=>{e.part&&t&&(r[s+o]=[t]),e.wireIndices&&e.wireIndices.length>0&&n&&(i[s+o]=e.wireIndices.map(e=>n[e]))}),s+=e.assembly.length});let o=s-1,a=n.partsAndWires.map(e=>e.part).filter(e=>!!e),l=n.partsAndWires.map(e=>e.wires||[]).reduce((e,t)=>e.concat(t),[]),c={},u=[];return l.forEach(e=>{c[e.color]||(c[e.color]=[],u.push(e.color)),c[e.color].push(e)}),{boardDef:t.boardDef,cmpDefs:t.partDefs,fnArgs:t.fnArgs,allAlloc:n,stepToWires:i,stepToCmps:r,allWires:l,allCmps:a,lastStep:o,colorToWires:c,allWireColors:u}}({boardDef:n.boardDef,partDefs:s,partsList:n.parts,fnArgs:n.fnArgs,getBBCoord:o.getCoord.bind(o)});a.allAlloc.requiresBreadboard=!0;!function(e){let t=document.getElementById("front-panel"),n=g(e,400,!1);n.addAll(e.allAlloc),t.appendChild(n.getView())}(a);let l=y(a);t.appendChild(l);for(let e=0;e<=a.lastStep;e++){let n=b(e,a);t.appendChild(n)}n.print&&e.print(2e3)}t.renderParts=v,t.renderInstructions=function(e){document.getElementById("proj-title").innerText=e.options.name||"",v(document.body,e.options)}}(e.instructions||(e.instructions={}))}(pxsim||(pxsim={})),function(e){function t(e,t="sim: check failed"){if(!e)throw new Error(t)}e.quiet=!1,e.check=t,e.title="";let n,i,r,s,o,a={},l={};e.getConfig=function(e){return l.hasOwnProperty(e+"")?l[e+""]:null},e.getConfigKey=function(e){return a.hasOwnProperty(e)?a[e]:null},e.getAllConfigKeys=function(){return Object.keys(a)},e.setConfigKey=function(e,t){a[e]=t},e.setConfig=function(e,t){l[e]=t},e.setConfigData=function(e,t){l=e,a=t},e.getConfigData=function(){return{cfg:l,cfgKey:a}},e.setTitle=function(t){e.title=t};class c{constructor(){e.runtime?this.id=e.runtime.registerLiveObject(this):this.id=0}destroy(){}scan(t){throw e.U.userError("scan not implemented")}gcKey(){throw e.U.userError("gcKey not implemented")}gcSize(){throw e.U.userError("gcSize not implemented")}gcIsStatic(){return!1}print(){e.runtime&&e.runtime.refCountingDebug&&e.log(`RefObject id:${this.id}`)}toDebugString(){return"(object)"}static toAny(e){return e&&e.toAny?e.toAny():e}static fromAny(t){return t?t instanceof c?t:Array.isArray(t)?e.RefCollection.fromAny(t):"object"==typeof t?d.fromAny(t):t:t}static toDebugString(e){return null===e?"null":void 0===e?"undefined;":e.vtable&&e.vtable.name?"_Map"===e.vtable.name&&e instanceof f?"(object)":e.vtable.name:e.toDebugString?e.toDebugString():e.vtable&&e.vtable.name?e.vtable.name:"string"==typeof e?JSON.stringify(e):e.toString()}}e.RefObject=c;class u{constructor(e,t,n){this.func=e,this.caps=t,this.args=n}}e.FnWrapper=u;class d extends c{constructor(){super(...arguments),this.fields={}}scan(e){for(let t of Object.keys(this.fields))e(t,this.fields[t])}gcKey(){return this.vtable.name}gcSize(){return this.vtable.numFields+1}destroy(){this.fields=null,this.vtable=null}print(){e.runtime&&e.runtime.refCountingDebug&&e.log(`RefRecord id:${this.id} (${this.vtable.name})`)}toDebugString(){let e="RefRecord: {";const t=Object.keys(this.fields);for(let n=0;n<t.length;++n)n>0&&(e+=", "),e+=t[n]+": "+c.toDebugString(this.fields[t[n]]);return e+"}"}toAny(){const e={};for(let t of Object.keys(this.fields))e[t]=c.toAny(this.fields[t]);return e}static fromAny(e){const t=new d;for(let n of Object.keys(e))t.fields[n]=c.fromAny(e[n]);return t}}e.RefRecord=d;class p extends c{constructor(){super(...arguments),this.fields=[]}scan(e){for(let t=0;t<this.fields.length;++t)e("_cap"+t,this.fields[t])}gcKey(){return e.functionName(this.func)}gcSize(){return this.fields.length+3}isRef(e){return t(0<=e&&e<this.fields.length),e<this.len}ldclo(e){return t(0<=(e>>=2)&&e<this.fields.length),this.fields[e]}destroy(){this.fields=null,this.func=null}print(){e.runtime&&e.runtime.refCountingDebug&&e.log(`RefAction id:${this.id} len:${this.fields.length}`)}}e.RefAction=p,function(t){t.seedAddRandom=function(e){},t.mkAction=function(e,t){let n=new p;n.len=e,n.func=t;for(let t=0;t<e;++t)n.fields.push(null);return n},t.runAction=function(t,n){let i=e.getResume();i(t instanceof p?new u(t.func,t.fields,n):new u(t,null,n))};let n={};t.dumpPerfCounters=function(){if(!e.runtime||!e.runtime.perfCounters)return;let t="calls,us,name\n";for(let n of e.runtime.perfCounters){n.lastFew.sort();const e=n.lastFew[n.lastFew.length>>1];t+=`${n.numstops},${n.value},${n.name},${e}\n`}!function(t){let i="";const r=(e,t)=>{i+=e.length>=t?e:("              "+e).slice(-t)},s=(e,t)=>{i+=e.length>=t?e:(e+"                         ").slice(0,t)},o=e=>r(""+Math.round(e),6),a=(e,t)=>{r(Math.round(t)+"",8),i+=" /",o(e),i+=" =",o(t/e)};for(let e of t.split(/\n/)){if(!e)continue;if(!/^\d/.test(e))continue;const t=e.split(/,/);let r=n[t[2]];r||(n[t[2]]=r={stops:0,us:0,meds:[]}),s(t[2],25);const l=parseInt(t[0]),c=parseInt(t[1]);a(l,c),i+=" |",a(l-r.stops,c-r.us),i+=" ~";const u=parseInt(t[3]);o(u),r.meds.length>10&&r.meds.shift(),r.meds.push(u);const d=r.meds.slice();d.sort((e,t)=>e-t);const p=d[d.length>>1];i+=" ~~",o(p),r.stops=l,r.us=c,i+="\n"}e.log(i)}(t)}}(n=e.pxtcore||(e.pxtcore={}));class h extends c{constructor(){super(...arguments),this.v=void 0}scan(e){e("*",this.v)}gcKey(){return"LOC"}gcSize(){return 2}destroy(){}print(){e.runtime&&e.runtime.refCountingDebug&&e.log(`RefRefLocal id:${this.id} v:${this.v}`)}}e.RefRefLocal=h;class f extends c{constructor(){super(...arguments),this.vtable=e.mkMapVTable(),this.data=[]}scan(e){for(let t of this.data)e(t.key,t.val)}gcKey(){return"{...}"}gcSize(){return 2*this.data.length+4}findIdx(e){e+="";for(let t=0;t<this.data.length;++t)if(this.data[t].key==e)return t;return-1}destroy(){super.destroy();for(let e=0;e<this.data.length;++e)this.data[e].val=0;this.data=[]}print(){e.runtime&&e.runtime.refCountingDebug&&e.log(`RefMap id:${this.id} size:${this.data.length}`)}toDebugString(){let e="RefMap: {";for(let t=0;t<this.data.length;++t)t>0&&(e+=", "),e+=this.data[t].key+": "+c.toDebugString(this.data[t].val);return e+"}"}toAny(){const e={};return this.data.forEach(t=>{e[t.key]=c.toAny(t.val)}),e}static fromAny(e){const t=new f;for(let n of Object.keys(e))t.data.push({key:n,val:c.fromAny(e[n])});return t}}function m(){e.runtime&&e.runtime.dumpLivePointers()}e.RefMap=f,e.dumpLivePointers=m,function(e){e.toString=function(e){return null===e?"null":void 0===e?"undefined":e.toString()},e.toBoolDecr=function(e){return!!e},e.toBool=function(e){return!!e}}(i=e.numops||(e.numops={})),function(e){e.toInt=function(e){return 0|e},e.toFloat=function(e){return e},e.ignore=function(e){return e}}(r=e.langsupp||(e.langsupp={})),function(t){t.ptrOfLiteral=function(e){return e},t.debugMemLeaks=function(){m()},t.templateHash=function(){return 0},t.programHash=function(){return 0},t.programName=function(){return e.title},t.programSize=function(){return 0},t.afterProgramPage=function(){return 0},t.getConfig=function(t,n){let i=e.getConfig(t);return null==i?n:i},t.toInt=function(e){return e|0},t.toUInt=function(e){return e>>>0},t.toDouble=function(e){return e},t.toFloat=function(e){return e},t.fromInt=function(e){return e},t.fromUInt=function(e){return e},t.fromDouble=function(e){return e},t.fromFloat=function(e){return e},t.fromBool=function(e){return!!e}}(n=e.pxtcore||(e.pxtcore={})),function(n){function i(t,n){if(t||e.throwFailedPropertyAccessError(t,n),n+="",t instanceof d){return t.fields[n]}let i=t.findIdx(n);if(!(i<0))return t.data[i].val}function r(t,n,i){if(t||e.throwFailedPropertyAccessError(t,n),n+="",t instanceof d){return void(t.fields[n]=i)}let r=t.findIdx(n);r<0?t.data.push({key:n,val:i}):t.data[r].val=i}n.toInt8=function(e){return(255&e)<<24>>24},n.toInt16=function(e){return(65535&e)<<16>>16},n.toInt32=function(e){return 0|e},n.toUInt32=function(e){return e>>>0},n.toUInt8=function(e){return 255&e},n.toUInt16=function(e){return 65535&e},n.nullFix=function(e){return null==e||!1===e?0:!0===e?1:e},n.nullCheck=function(t){null==t&&e.U.userError("Dereferencing null/undefined value.")},n.panic=function(t){e.U.userError("PANIC! Code "+t)},n.stringToBool=function(e){return e?1:0},n.ptrToBool=function(e){return e?1:0},n.emptyToNull=function(e){return""==e?0:e},n.ldlocRef=function(e){return e.v},n.stlocRef=function(e,t){e.v=t},n.mklocRef=function(){return new h},n.stclo=function(e,n,i){return t(0<=n&&n<e.fields.length),t(null===e.fields[n]),e.fields[n]=i,e},n.runtimeWarning=function(t){e.Runtime.postMessage(e.getWarningMessage(t))},n.mkMap=function(){return new f},n.mapGet=function(e,t){return i(e,n.mapKeyNames[t])},n.mapSet=function(e,t,i){return r(e,n.mapKeyNames[t],i)},n.mapGetByString=i,n.mapDeleteByString=function(t,n){null==t&&e.throwNullUndefinedAsObjectError(),t instanceof f||e.throwFailedCastError(t,"object");let i=t.findIdx(n);return i>=0&&t.data.splice(i,1),!0},n.mapSetGeneric=r,n.mapGetGeneric=i,n.mapSetByString=r,n.keysOf=function(t){null==t&&e.throwNullUndefinedAsObjectError();let n=new e.RefCollection;if(t instanceof f)for(let e of t.data)n.push(e.key);return n}}(s=e.pxtrt||(e.pxtrt={})),function(e){e.mkClassInstance=function(e){t(!!e.methods);let n=new d;return n.vtable=e,n},e.switch_eq=function(e,t){return e==t},e.typeOf=function(e){return typeof e}}(n=e.pxtcore||(e.pxtcore={})),function(t){function n(t){t&&(t instanceof p||t.info)||e.throwFailedCastError(t,"function")}t.panic=s.panic,t.pause=function(t){let n=e.getResume();e.runtime.schedule(()=>{n()},t)},t.runInBackground=function(t){n(t),e.runtime.runFiberAsync(t)},t.forever=function(t){n(t),function n(){e.runtime.runFiberAsync(t).then(()=>e.U.delay(20)).then(n)}()},t.typeCheck=n}(o=e.thread||(e.thread={}))}(pxsim||(pxsim={})),function(e){class t extends e.RefObject{constructor(){super(),this.data=[]}scan(e){for(let t=0;t<this.data.length;++t)e("["+t+"]",this.data[t])}gcKey(){return"[...]"}gcSize(){return this.data.length+2}toArray(){return this.data.slice(0)}toAny(){return this.data.map(t=>e.RefObject.toAny(t))}static fromAny(n,i=!0){const r=new t;return r.data=i?n.map(t=>e.RefObject.fromAny(t)):n.slice(0),r}toDebugString(){let t="[";for(let n=0;n<this.data.length;++n){n>0&&(t+=",");let i=e.RefObject.toDebugString(this.data[n]);if(t.length+i.length>100){0==n&&(t+=i.substr(0,100)),t+="...";break}t+=i}return t+="]",t}destroy(){let e=this.data;for(let t=0;t<e.length;++t)e[t]=0;this.data=[]}isValidIndex(e){return e>=0&&e<this.data.length}push(e){this.data.push(e)}pop(){return this.data.pop()}getLength(){return this.data.length}setLength(e){this.data.length=e}getAt(e){return this.data[e]}setAt(e,t){this.data[e]=t}insertAt(e,t){this.data.splice(e,0,t)}removeAt(e){return this.data.splice(e,1)[0]}indexOf(e,t){return this.data.indexOf(e,t)}print(){}}let n,i,r,s,o,a,l,c;e.RefCollection=t,function(n){function i(e,t){if(s(e),e.isValidIndex(t))return e.removeAt(t)}function r(e,t,n){return s(e),e.indexOf(t,n)}function s(n){n instanceof t||e.throwFailedCastError(n,"Array")}n.mk=function(){return new t},n.isArray=function(e){return e instanceof t},n.length=function(e){return s(e),e.getLength()},n.setLength=function(e,t){s(e),e.setLength(t)},n.push=function(e,t){s(e),e.push(t)},n.pop=function(e,t){return s(e),e.pop()},n.getAt=function(e,t){return s(e),e.getAt(t)},n.removeAt=i,n.insertAt=function(e,t,n){s(e),e.insertAt(t,n)},n.setAt=function(e,t,n){s(e),e.setAt(t,n)},n.indexOf=r,n.removeElement=function(e,t){s(e);let n=r(e,t,0);return n>=0?(i(e,n),1):0},n.typeCheck=s}(n=e.Array_||(e.Array_={})),function(e){e.imul=Math.imul||function(e,t){const n=65535&e,i=65535&t;return n*i+((e>>>16&65535)*i+n*(t>>>16&65535)<<16>>>0)|0},e.idiv=function(e,t){return(0|e)/(0|t)|0},e.round=function(e){return Math.round(e)},e.roundWithPrecision=function(e,t){if((t|=0)<=0)return Math.round(e);if(0==e)return 0;let n=0;for(;0==n&&t<21;){const i=Math.pow(10,t++);n=Math.round(e*i+Number.EPSILON)/i}return n},e.ceil=function(e){return Math.ceil(e)},e.floor=function(e){return Math.floor(e)},e.sqrt=function(e){return Math.sqrt(e)},e.pow=function(e,t){return Math.pow(e,t)},e.clz32=function(e){return Math.clz32(e)},e.log=function(e){return Math.log(e)},e.log10=function(e){return Math.log10(e)},e.log2=function(e){return Math.log2(e)},e.exp=function(e){return Math.exp(e)},e.sin=function(e){return Math.sin(e)},e.sinh=function(e){return Math.sinh(e)},e.cos=function(e){return Math.cos(e)},e.cosh=function(e){return Math.cosh(e)},e.tan=function(e){return Math.tan(e)},e.tanh=function(e){return Math.tanh(e)},e.asin=function(e){return Math.asin(e)},e.asinh=function(e){return Math.asinh(e)},e.acos=function(e){return Math.acos(e)},e.acosh=function(e){return Math.acosh(e)},e.atan=function(e){return Math.atan(e)},e.atanh=function(e){return Math.atanh(e)},e.atan2=function(e,t){return Math.atan2(e,t)},e.trunc=function(e){return e>0?Math.floor(e):Math.ceil(e)},e.random=function(){return Math.random()},e.randomRange=function(e,t){if(e==t)return e;if(e>t){let n=e;e=t,t=n}return Math.floor(e)==e&&Math.floor(t)==t?e+Math.floor(Math.random()*(t-e+1)):e+Math.random()*(t-e)}}(i=e.Math_||(e.Math_={})),function(t){function n(t,n){return e.pxtrt.nullFix(t)==e.pxtrt.nullFix(n)}t.lt=function(e,t){return e<t},t.le=function(e,t){return e<=t},t.neq=function(e,t){return!n(e,t)},t.eq=n,t.eqDecr=function(t,n){return e.pxtrt.nullFix(t)==e.pxtrt.nullFix(n)},t.gt=function(e,t){return e>t},t.ge=function(e,t){return e>=t},t.div=function(e,t){return 0|Math.floor(e/t)},t.mod=function(e,t){return e%t},t.bnot=function(e){return~e},t.toString=function(e){return e+""}}(r=e.Number_||(e.Number_={})),function(e){e.adds=function(e,t){return e+t|0},e.subs=function(e,t){return e-t|0},e.divs=function(e,t){return 0|Math.floor(e/t)},e.muls=function(e,t){return i.imul(e,t)},e.ands=function(e,t){return e&t},e.orrs=function(e,t){return e|t},e.eors=function(e,t){return e^t},e.lsls=function(e,t){return e<<t},e.lsrs=function(e,t){return e>>>t},e.asrs=function(e,t){return e>>t},e.bnot=function(e){return~e},e.ignore=function(e){return e}}(s=e.thumb||(e.thumb={})),function(e){function t(e){return e<<16>>16}e.adds=function(e,n){return t(e+n)},e.subs=function(e,n){return t(e-n)},e.divs=function(e,n){return t(Math.floor(e/n))},e.muls=function(e,n){return t(i.imul(e,n))},e.ands=function(e,n){return t(e&n)},e.orrs=function(e,n){return t(e|n)},e.eors=function(e,n){return t(e^n)},e.lsls=function(e,n){return t(e<<n)},e.lsrs=function(e,t){return(65535&e)>>>t},e.asrs=function(e,n){return t(e>>n)},e.bnot=function(e){return~e},e.ignore=function(e){return e}}(o=e.avr||(e.avr={})),function(t){function n(t){"string"!=typeof t&&e.throwFailedCastError(t,"string")}t.stringConv=function(t){const n=e.getResume();t instanceof e.RefRecord&&t.vtable.toStringMethod?e.runtime.runFiberAsync(t.vtable.toStringMethod,t).then(()=>{n(e.runtime.currFrame.retval+"")}):n(t+"")},t.mkEmpty=function(){return""},t.fromCharCode=function(e){return String.fromCharCode(e)},t.toNumber=function(e){return n(e),parseFloat(e)},t.concat=function(e,t){return n(e),e+t},t.substring=function(e,t,i){return n(e),e.slice(t,t+i)},t.equals=function(e,t){return n(e),e==t},t.compare=function(e,t){return n(e),e==t?0:e<t?-1:1},t.compareDecr=function(e,t){return n(e),e==t?0:e<t?-1:1},t.length=function(e){return n(e),e.length},t.substr=function(e,t,i){return n(e),e.substr(t,i)},t.charAt=function(e,t){return n(e),e.charAt(t)},t.charCodeAt=function(e,t){return n(e),function(e,t){return n(e),0<=t&&t<e.length}(e,t)?e.charCodeAt(t):0},t.indexOf=function(e,t,i){return n(e),null==t?-1:e.indexOf(t,i)},t.lastIndexOf=function(e,t,i){return n(e),null==t?-1:e.lastIndexOf(t,i)},t.includes=function(e,t,i){return n(e),null!=t&&e.includes(t,i)},t.typeCheck=n}(a=e.String_||(e.String_={})),function(e){e.toString=function(e){return e?"true":"false"},e.bang=function(e){return!e}}(l=e.Boolean_||(e.Boolean_={}));class u extends e.RefObject{constructor(e){super(),this.data=e,this.isStatic=!1}scan(e){}gcKey(){return"Buffer"}gcSize(){return 2+(this.data.length+3>>2)}gcIsStatic(){return this.isStatic}print(){}toDebugString(){return c.toHex(this)}}e.RefBuffer=u,function(t){let n;function i(t){let i=function(t){switch(t){case n.Int8LE:return-1;case n.UInt8LE:return 1;case n.Int16LE:return-2;case n.UInt16LE:return 2;case n.Int32LE:return-4;case n.UInt32LE:return 4;case n.Int8BE:return-10;case n.UInt8BE:return 10;case n.Int16BE:return-20;case n.UInt16BE:return 20;case n.Int32BE:return-40;case n.UInt32BE:return 40;case n.Float32LE:return 4;case n.Float32BE:return 40;case n.Float64LE:return 8;case n.Float64BE:return 80;default:throw e.U.userError("bad format")}}(t),r=!1;i<0&&(r=!0,i=-i);let s=!1;return i>=10&&(s=!0,i/=10),{size:i,signed:r,swap:s,isFloat:t>=n.Float32LE}}function r(e){return new u(new Uint8Array(e))}function s(e,t){return 0<=t&&t<e.data.length}function o(e,t){return f(e),s(e,t)?e.data[t]:0}function l(t){t.isStatic&&e.U.userError("Writing to read only buffer.")}function c(e,t,n){f(e),s(e,t)&&(l(e),e.data[t]=n)}function d(e,t,n=0,i=-1){f(e),n<0||n>e.data.length||(i<0&&(i=e.data.length),i=Math.min(i,e.data.length-n),l(e),e.data.fill(t,n,n+i))}function p(e,t,n,i,r){if(n.buffer===e.buffer)p(e,t,n.slice(i,i+r),0,r);else for(let s=0;s<r;++s)e[t+s]=n[i+s]}!function(e){e[e.Int8LE=1]="Int8LE",e[e.UInt8LE=2]="UInt8LE",e[e.Int16LE=3]="Int16LE",e[e.UInt16LE=4]="UInt16LE",e[e.Int32LE=5]="Int32LE",e[e.Int8BE=6]="Int8BE",e[e.UInt8BE=7]="UInt8BE",e[e.Int16BE=8]="Int16BE",e[e.UInt16BE=9]="UInt16BE",e[e.Int32BE=10]="Int32BE",e[e.UInt32LE=11]="UInt32LE",e[e.UInt32BE=12]="UInt32BE",e[e.Float32LE=13]="Float32LE",e[e.Float64LE=14]="Float64LE",e[e.Float32BE=15]="Float32BE",e[e.Float64BE=16]="Float64BE"}(n=t.NumberFormat||(t.NumberFormat={})),t.fmtInfo=i,t.getNumber=function(e,t,n){f(e);let r=i(t);if(r.isFloat){let t=e.data.buffer.slice(n,n+r.size);if(r.swap){new Uint8Array(t).reverse()}return 4==r.size?new Float32Array(t)[0]:new Float64Array(t)[0]}let s=0;for(let t=0;t<r.size;++t){s<<=8;let i=r.swap?n+t:n+r.size-t-1;s|=e.data[i]}if(r.signed){let e=32-8*r.size;s=s<<e>>e}else s>>>=0;return s},t.setNumber=function(e,t,n,r){f(e);let s=i(t);if(s.isFloat){let t=new Uint8Array(s.size);4==s.size?new Float32Array(t.buffer)[0]=r:new Float64Array(t.buffer)[0]=r,s.swap&&t.reverse();for(let i=0;i<s.size;++i)e.data[n+i]=t[i];return}for(let t=0;t<s.size;++t){let i=s.swap?n+s.size-t-1:n+t;e.data[i]=255&r,r>>=8}},t.createBuffer=r,t.createBufferFromHex=function(e){a.typeCheck(e);let t=r(e.length>>1);for(let n=0;n<e.length;n+=2)t.data[n>>1]=parseInt(e.slice(n,n+2),16);return t.isStatic=!0,t},t.isReadOnly=function(e){return f(e),e.isStatic},t.getBytes=function(e){return f(e),e.data},t.getUint8=function(e,t){return f(e),o(e,t)},t.getByte=o,t.setUint8=function(e,t,n){f(e),c(e,t,n)},t.setByte=c,t.length=function(e){return f(e),e.data.length},t.fill=d,t.slice=function(e,t,n){return f(e),t=Math.min(e.data.length,t),n<0&&(n=e.data.length),n=Math.min(n,e.data.length-t),new u(e.data.slice(t,t+n))},t.toHex=function(e){f(e);const t="0123456789abcdef";let n="";for(let i=0;i<e.data.length;++i)n+=t[e.data[i]>>4],n+=t[15&e.data[i]];return n},t.toString=function(t){return f(t),e.U.fromUTF8Array(t.data)};const h=-2147483648;function f(t){t instanceof u||e.throwFailedCastError(t,"Buffer")}t.shift=function(e,t,n,i){f(e),i<0&&(i=e.data.length-n),n<0||n+i>e.data.length||n+i<n||0==i||0==t||t==h||0!=i&&0!=t&&t!=h&&(t<=-i||t>=i?d(e,0):(l(e),t<0?(t=-t,p(e.data,n+t,e.data,n,i-t),e.data.fill(0,n,n+t)):(i-=t,p(e.data,n,e.data,n+t,i),e.data.fill(0,n+i,n+i+t))))},t.rotate=function(e,t,n,i){if(f(e),i<0&&(i=e.data.length-n),n<0||n+i>e.data.length||n+i<n||0==i||0==t||t==h)return;l(e),t<0&&(t+=i<<8),(t%=i)<0&&(t+=i);let r=e.data,s=t,o=0,a=s,c=i;for(;o!=a;){let e=r[o+n];r[o+++n]=r[a+n],r[a+++n]=e,a==c?a=s:o==s&&(s=a)}},t.write=function(e,t,n,i=0,r=-1){f(e),f(n),r<0&&(r=n.data.length),i<0||t<0||t>e.data.length||(r=Math.min(n.data.length-i,e.data.length-t))<0||(l(e),p(e.data,t,n.data,i,r))},t.typeCheck=f}(c=e.BufferMethods||(e.BufferMethods={}))}(pxsim||(pxsim={})),function(e){!function(t){t.createBufferFromUTF8=function(t){return e.String_.typeCheck(t),new e.RefBuffer(e.U.toUTF8Array(t))}}(e.control||(e.control={}))}(pxsim||(pxsim={})),function(e){!function(e){let t={};e.setLocalizedStrings=function(e){t=e||{}};function n(e,t){return 0==t.length?e:e.replace(/\{([0-9]+)(\:[^\}]+)?\}/g,function(e,n,s){let o=t[parseInt(n)],a="",l=/^:f(\d*)\.(\d+)/.exec(s);if(l){let e=parseInt(l[2]),t=parseInt(l[1])||0,n=/^0/.test(l[1])?"0":" ",i=o.toFixed(e);if(t>0&&e>0&&(t+=e+1),t>0)for(;i.length<t;)i=n+i;a=i}else a=":x"==s?"0x"+o.toString(16):void 0===o?"(undef)":null===o?"(null)":o.toString?o.toString():o+"";return":a"==s?/^\s*[euioah]/.test(a.toLowerCase())?a="an "+a:/^\s*[bcdfgjklmnpqrstvwxz]/.test(a.toLowerCase())&&(a="a "+a):":s"==s?a=1==o?"":"s":":q"==s?a=i(a):":jq"==s?a=r(a):":uri"==s?a=encodeURIComponent(a).replace(/'/g,"%27").replace(/"/g,"%22"):":url"==s?a=encodeURI(a).replace(/'/g,"%27").replace(/"/g,"%22"):":%"==s&&(a=(100*o).toFixed(1).toString()+"%"),a})}function i(e){return e?e.replace(/([^\w .!?\-$])/g,e=>"&#"+e.charCodeAt(0)+";"):e}function r(e){return e.replace(/[^\w .!?\-$]/g,e=>{let t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substr(0,4-t.length)+t})}e.lf=function(e,...i){let r=t[e]||e;return r=r.replace(/^\{(id|loc):[^\}]+\}/g,""),n(r,i)},e.fmt_va=n,e.htmlEscape=i,e.jsStringQuote=r}(e.localization||(e.localization={}))}(pxsim||(pxsim={})),function(e){let t;!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Log=1]="Log",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t=e.LogLevel||(e.LogLevel={}));e.ConsoleLogger=class{constructor(){this.setLogLevel(t.Info)}setLogLevel(e){this.logLevel=e}getLogLevel(){return this.logLevel}info(...e){this.shouldLog(t.Info)&&(null===console||void 0===console?void 0:console.info)&&console.info.call(null,...e)}log(...e){this.shouldLog(t.Log)&&(null===console||void 0===console?void 0:console.log)&&console.log.call(null,...e)}debug(...e){this.shouldLog(t.Debug)&&(null===console||void 0===console?void 0:console.debug)&&console.debug.call(null,...e)}error(...e){this.shouldLog(t.Error)&&(null===console||void 0===console?void 0:console.error)&&console.error.call(null,...e)}warn(...e){this.shouldLog(t.Warning)&&(null===console||void 0===console?void 0:console.warn)&&console.warn.call(null,...e)}shouldLog(e){return e>=this.logLevel}};let n=new e.ConsoleLogger;e.info=function(...e){n.info(...e)},e.log=function(...e){n.log(...e)},e.debug=function(...e){n.debug(...e)},e.error=function(...e){n.error(...e)},e.warn=function(...e){n.warn(...e)},e.setLogger=function(e){const t=null==n?void 0:n.getLogLevel();n=e,void 0!==t&&n.setLogLevel(t)},e.setLogLevel=function(e){n.setLogLevel(e)}}(pxsim||(pxsim={})),function(pxsim){const MIN_MESSAGE_WAIT_MS=200;let tracePauseMs=0,MessageListenerFlags,U,pxtcore;!function(e){e[e.MESSAGE_BUS_LISTENER_REENTRANT=8]="MESSAGE_BUS_LISTENER_REENTRANT",e[e.MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY=16]="MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY",e[e.MESSAGE_BUS_LISTENER_DROP_IF_BUSY=32]="MESSAGE_BUS_LISTENER_DROP_IF_BUSY",e[e.MESSAGE_BUS_LISTENER_IMMEDIATE=192]="MESSAGE_BUS_LISTENER_IMMEDIATE"}(MessageListenerFlags||(MessageListenerFlags={})),function(e){function t(e){return e.split(/\s+/).filter(e=>!!e)}function n(e){for(;e.firstChild;)e.removeChild(e.firstChild)}let i;e.containsClass=function(e,n){return t(n).every(t=>function(e,t){if(e.classList)return e.classList.contains(t);return!((e.className+"").split(/\s+/).indexOf(t)<0)}(e,t))},e.addClass=function(e,n){t(n).forEach(t=>function(e,t){if(e.classList)e.classList.add(t);else{(e.className+"").split(/\s+/).indexOf(t)<0&&(e.className.baseVal+=" "+t)}}(e,t))},e.removeClass=function(e,n){t(n).forEach(t=>function(e,t){e.classList?e.classList.remove(t):e.className.baseVal=(e.className+"").split(/\s+/).filter(e=>e!=t).join(" ")}(e,t))},e.remove=function(e){e.parentElement.removeChild(e)},e.removeChildren=n,e.clear=function(e){n(e)},e.assert=function(e,t="Assertion failed"){if(!e)throw new Error(t)},e.repeatMap=function(e,t){e=e||0;let n=[];for(let i=0;i<e;++i)n.push(t(i));return n},e.userError=function(e){let t=new Error(e);throw t.isUserError=!0,t},e.now=function(){return Date.now()},e.perfNowUs=function(){return i||(i="undefined"!=typeof performance?performance.now.bind(performance)||performance.moznow.bind(performance)||performance.msNow.bind(performance)||performance.webkitNow.bind(performance)||performance.oNow.bind(performance):Date.now),1e3*i()};const r=Promise.resolve();async function s(e,t,n){let i=0;const r=[],s=[];for(let o=0;o<e;o++){const e=(async()=>{for(;i<t.length;){const e=i++,r=t[e];s[e]=await n(r)}})();r.push(e)}try{await Promise.all(r)}catch(e){throw i=t.length,e}return s}function o(){return"undefined"!=typeof window&&!!window.pxtElectron}function a(){return"undefined"!=typeof window&&!!window.ipcRenderer}function l(){return o()||a()}function c(e){return/^http:\/\/(?:localhost|127\.0\.0\.1|192\.168\.\d{1,3}\.\d{1,3}|[a-zA-Z0-9.-]+\.local):\d+\/?/.test(e)&&!/nolocalhost=1/.test(e)}function u(){try{return"undefined"!=typeof window&&c(window.location.href)}catch(e){return!1}}e.nextTick=function(e){r.then(e)},e.delay=async function(e,t){const n=await t;return await new Promise(t=>setTimeout(()=>t(),e)),n},e.throttle=function(e,t,n){let i;return function(){let r=this,s=arguments,o=n&&!i;i||(i=setTimeout(function(){i=null,n||e.apply(r,s)},t)),o&&e.apply(r,s)}},e.promiseMapAll=function(e,t){return Promise.all(e.map(e=>t(e)))},e.promiseMapAllSeries=function(e,t){return s(1,e,t)},e.promisePoolAsync=s,e.promiseTimeout=async function(e,t,n){let i,r;const s=new Promise((t,s)=>{r=t,i=setTimeout(()=>{r=void 0,clearTimeout(i),s(n||`Promise timed out after ${e}ms`)},e)});return Promise.race([t,s]).then(e=>(r&&(clearTimeout(i),r()),e))},e.stringToUint8Array=function(e){let t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n},e.uint8ArrayToString=function(e){let t=e.length,n="";for(let i=0;i<t;++i)n+=String.fromCharCode(e[i]);return n},e.fromUTF8=function(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){let i=255&e.charCodeAt(n);t+=37==i||i>127?"%"+i.toString(16):e.charAt(n)}return decodeURIComponent(t)},e.toUTF8=function(e,t){let n="";if(!e)return n;for(let i=0;i<e.length;++i){let r=e.charCodeAt(i);if(r<=127)n+=e.charAt(i);else if(r<=2047)n+=String.fromCharCode(192|r>>6,128|63&r);else{if(!t&&55296<=r&&r<=56319){let t=e.charCodeAt(++i);isNaN(t)||(r=65536+(r-55296<<10)+(t-56320))}n+=r<=65535?String.fromCharCode(224|r>>12,128|r>>6&63,128|63&r):String.fromCharCode(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}}return n},e.toUTF8Array=function(e){return(new TextEncoder).encode(e)},e.fromUTF8Array=function(e){return(new TextDecoder).decode(e)},e.isPxtElectron=o,e.isIpcRenderer=a,e.isElectron=l,e.testLocalhost=c,e.isLocalHost=u,e.isLocalHostDev=function(){return u()&&!l()},e.unique=function(e,t){let n=[],i={};return e.forEach(e=>{let r=t(e);i.hasOwnProperty(r)||(i[r]=null,n.push(e))}),n},e.sanitizeCssName=function(e){let t=e.replace(/[^a-zA-Z0-9-_]/g,"_");return/^[a-zA-Z_]/.test(t)||(t="cls_"+t),t}}(U=pxsim.U||(pxsim.U={}));class BreakLoopException{}function getResume(){return pxsim.runtime.getResume()}pxsim.BreakLoopException=BreakLoopException,function(e){function t(e){let t=pxsim.runtime.currTryFrame();t||U.userError("unhandled exception: "+e);const n=t.handlerFrame;throw pxsim.runtime.currFrame=n,n.pc=t.handlerPC,n.tryFrame=t.parent,n.thrownValue=e,n.hasThrownValue=!0,new BreakLoopException}e.beginTry=function(e){pxsim.runtime.currFrame.tryFrame={parent:pxsim.runtime.currTryFrame(),handlerPC:e,handlerFrame:pxsim.runtime.currFrame}},e.endTry=function(){const e=pxsim.runtime.currFrame;e.tryFrame=e.tryFrame.parent},e.throwValue=t,e.getThrownValue=function(){const e=pxsim.runtime.currFrame;return U.assert(e.hasThrownValue),e.hasThrownValue=!1,e.thrownValue},e.endFinally=function(){const e=pxsim.runtime.currFrame;e.hasThrownValue&&(e.hasThrownValue=!1,t(e.thrownValue))}}(pxtcore=pxsim.pxtcore||(pxsim.pxtcore={})),pxsim.getResume=getResume;const SERIAL_BUFFER_LENGTH=16;class BaseBoard{constructor(){this.messageListeners=[],this.serialOutBuffer="",this.messages=[],this.lastSerialTime=0,this.debouncedPostAll=()=>{const e=Date.now();e-this.lastSerialTime>MIN_MESSAGE_WAIT_MS?(clearTimeout(this.serialTimeout),this.messages.length&&(Runtime.postMessage({type:"bulkserial",data:this.messages,id:pxsim.runtime.id,sim:!0}),this.messages=[],this.lastSerialTime=e)):this.serialTimeout=setTimeout(this.debouncedPostAll,50)},this.id=pxsim.Embed.frameid||"b"+Math.round(2147483647*Math.random()),this.bus=new pxsim.EventBus(pxsim.runtime,this)}updateView(){}receiveMessage(e){pxsim.runtime&&!pxsim.runtime.dead&&this.dispatchMessage(e)}dispatchMessage(e){for(const t of this.messageListeners)t(e)}addMessageListener(e){this.messageListeners.push(e)}get storedState(){return this.runOptions?(this.runOptions.storedState||(this.runOptions.storedState={}),this.runOptions.storedState):{}}initAsync(e){return this.runOptions=e,Promise.resolve()}setStoredState(e,t){null==t?delete this.storedState[e]:this.storedState[e]=t,Runtime.postMessage({type:"simulator",command:"setstate",stateKey:e,stateValue:t})}onDebuggerResume(){}screenshotAsync(e){return Promise.resolve(void 0)}kill(){}writeSerial(e){this.serialOutBuffer+=e,(/\n/.test(this.serialOutBuffer)||this.serialOutBuffer.length>SERIAL_BUFFER_LENGTH)&&(this.messages.push({time:Date.now(),data:this.serialOutBuffer}),this.debouncedPostAll(),this.serialOutBuffer="")}}pxsim.BaseBoard=BaseBoard;class CoreBoard extends BaseBoard{constructor(){super(),this.updateSubscribers=[],this.updateView=()=>{this.updateSubscribers.forEach(e=>e())},this.builtinParts={},this.builtinVisuals={},this.builtinPartVisuals={}}kill(){super.kill(),pxsim.codal.music.__stopSoundExpressions(),pxsim.AudioContextManager.stopAll()}}pxsim.CoreBoard=CoreBoard;class BareBoard extends BaseBoard{}function initBareRuntime(){pxsim.runtime.board=new BareBoard;let e=pxsim;e.basic={pause:pxsim.thread.pause,showNumber:e=>{let t=getResume();pxsim.log("SHOW NUMBER:",e),U.nextTick(t)}},e.serial={writeString:e=>pxsim.runtime.board.writeSerial(e)},e.pins={createBuffer:pxsim.BufferMethods.createBuffer},e.control={inBackground:pxsim.thread.runInBackground,createBuffer:pxsim.BufferMethods.createBuffer,dmesg:e=>pxsim.log("DMESG: "+e),deviceDalVersion:()=>"sim",__log:(e,t)=>pxsim.log("LOG: "+t.trim())}}let LogType;pxsim.initBareRuntime=initBareRuntime,function(e){e[e.UserSet=0]="UserSet",e[e.BackAdd=1]="BackAdd",e[e.BackRemove=2]="BackRemove"}(LogType||(LogType={}));class EventHandler{constructor(e,t){this.handler=e,this.flags=t,this.busy=0}async runAsync(e,t,n){const i=this.flags||MessageListenerFlags.MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY;if(i!==MessageListenerFlags.MESSAGE_BUS_LISTENER_IMMEDIATE)return i===MessageListenerFlags.MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY?this.runFiberAsync(e,t,n):void(i===MessageListenerFlags.MESSAGE_BUS_LISTENER_DROP_IF_BUSY&&this.busy||this.runFiberAsync(e,t,n));U.userError("MESSAGE_BUS_LISTENER_IMMEDIATE is not supported!")}async runFiberAsync(e,t,n){this.busy++,await t.runFiberAsync(this.handler,...n?n(e):[e]),this.busy--}}class EventQueue{constructor(e,t){this.runtime=e,this.valueToArgs=t,this.max=5,this.events=[],this.awaiters=[],this._handlers=[],this._addRemoveLog=[]}push(e,t){if(this.awaiters.length>0)if(t){const e=this.awaiters.shift();e&&e()}else{const e=this.awaiters.slice();this.awaiters=[],e.forEach(e=>e())}return 0==this.handlers.length||this.events.length>this.max?Promise.resolve():(this.events.push(e),this.lock?Promise.resolve():this.poke())}async poke(){this.lock=!0;let e=this.events;this.events=[];for(const t of e)for(const e of this.handlers)await e.runAsync(t,this.runtime,this.valueToArgs);if(this.events.length>0)return this.poke();this.lock=!1;for(const e of this._addRemoveLog)e.log===LogType.BackAdd?this.addHandler(e.act,e.flags):e.log===LogType.BackRemove?this.removeHandler(e.act):this.setHandler(e.act,e.flags);this._addRemoveLog=[]}get handlers(){return this._handlers}setHandler(e,t=0){this.lock?this._addRemoveLog.push({act:e,log:LogType.UserSet,flags:t}):this._handlers=[new EventHandler(e,t)]}addHandler(e,t=0){this.lock?this._addRemoveLog.push({act:e,log:LogType.BackAdd,flags:t}):this._handlers.some(t=>t.handler===e)||this._handlers.push(new EventHandler(e,t))}removeHandler(e){if(this.lock)this._addRemoveLog.push({act:e,log:LogType.BackRemove,flags:0});else{let t=this._handlers.findIndex(t=>t.handler===e);-1!=t&&this._handlers.splice(t,1)}}addAwaiter(e){this.awaiters.push(e)}}function bind(e){const t=e.arg0,n=e.fn;return e=>{let i=0;for(;e.hasOwnProperty("arg"+i);)i++;const r=e;for(let e=i;e>0;e--)r["arg"+e]=r["arg"+(e-1)];return e.arg0=t,n(e)}}function _leave(e,t){return e.parent.retval=t,e.parent}function syntheticRefAction(e){return pxtcore.mkAction(0,t=>_leave(t,e(t)))}pxsim.EventQueue=EventQueue,pxsim.initCurrentRuntime=void 0,pxsim.handleCustomMessage=void 0,pxsim.syntheticRefAction=syntheticRefAction;class TimeoutScheduled{constructor(e,t,n,i){this.id=e,this.fn=t,this.totalRuntime=n,this.timestampCall=i}}pxsim.TimeoutScheduled=TimeoutScheduled;class PausedTimeout{constructor(e,t){this.fn=e,this.timeRemaining=t}}function mkVTable(e){return{name:e.name,numFields:e.numFields,classNo:e.classNo,methods:e.methods,iface:e.iface,lastSubtypeNo:e.lastSubtypeNo,toStringMethod:e.toStringMethod,maxBgInstances:e.maxBgInstances}}pxsim.PausedTimeout=PausedTimeout,pxsim.mkVTable=mkVTable;let mapVTable=null;function mkMapVTable(){return mapVTable||(mapVTable=mkVTable({name:"_Map",numFields:0,classNo:0,lastSubtypeNo:0,methods:null})),mapVTable}function functionName(e){const t=e.info;return t?`${t.functionName} (${t.fileName}:${t.line+1}:${t.column+1})`:"()"}pxsim.mkMapVTable=mkMapVTable,pxsim.functionName=functionName;class Runtime{constructor(msg){this.numGlobals=1e3,this.dead=!1,this.running=!1,this.idleTimer=void 0,this.recording=!1,this.recordingTimer=0,this.recordingLastImageData=void 0,this.recordingWidth=void 0,this.startTime=0,this.startTimeUs=0,this.pausedTime=0,this.lastPauseTimestamp=0,this.globals={},this.environmentGlobals={},this.otherFrames=[],this.loopLock=null,this.loopLockWaitList=[],this.heapSnapshots=[],this.timeoutsScheduled=[],this.timeoutsPausedOnBreakpoint=[],this.pausedOnBreakpoint=!1,this.traceDisabled=!1,this.perfOffset=0,this.perfElapsed=0,this.perfStack=0,this.refCountingDebug=!1,this.refObjId=1,this.numDisplayUpdates=0,U.assert(!!pxsim.initCurrentRuntime),this.id=msg.id,this.refCountingDebug=!!msg.refCountingDebug;let threadId=0,breakpoints=null,currResume,dbgHeap,dbgResume,breakFrame=null,lastYield=Date.now(),userGlobals,__this=this;this.traceDisabled=!!msg.traceDisabled;const yieldDelay=void 0!==msg.yieldDelay?msg.yieldDelay:5,evalIface={runtime:this,oops:oops,doNothing:doNothing,pxsim:pxsim,globals:this.globals,setupYield:setupYield,maybeYield:maybeYield,setupDebugger:setupDebugger,isBreakFrame:isBreakFrame,breakpoint:breakpoint,trace:trace,checkStack:checkStack,leave:_leave,checkResumeConsumed:checkResumeConsumed,setupResume:setupResume,setupLambda:setupLambda,checkSubtype:checkSubtype,failedCast:failedCast,buildResume:buildResume,mkVTable:mkVTable,bind:bind,leaveAccessor:leaveAccessor};function oops(e){throw new Error("sim error: "+e)}function doNothing(e){return e.pc=-1,_leave(e,e.parent.retval)}function flushLoopLock(){for(;__this.loopLockWaitList.length>0&&!__this.loopLock;){__this.loopLockWaitList.shift()()}}let yieldReset=()=>{};function setupYield(e){yieldReset=e}function loopForSchedule(e){const t=new Object,n=e.pc;return __this.loopLock=t,__this.otherFrames.push(e),()=>{__this.dead||(U.assert(e.pc==n),U.assert(__this.loopLock===t),__this.loopLock=null,loop(e),flushLoopLock())}}function maybeYield(e,t,n){if(__this.pausedOnBreakpoint)return!1;__this.cleanScheduledExpired(),yieldReset();let i=Date.now();return i-lastYield>=20&&(lastYield=i,e.pc=t,e.r0=n,setTimeout(loopForSchedule(e),yieldDelay),!0)}function setupDebugger(e,t){return breakpoints=new Uint8Array(e),breakpoints[0]=msg.breakOnStart?1:0,userGlobals=t,breakpoints}function isBreakFrame(e){if(!breakFrame)return!0;for(let t=breakFrame;t;t=t.parent)if(t==e)return!0;return!1}function breakpoint(e,t,n,i){let r={};__this.loopLock=r,U.assert(!dbgResume),U.assert(!dbgHeap),e.pc=t,e.r0=i;const{msg:s,heap:o}=pxsim.getBreakpointMsg(e,n,userGlobals);return dbgHeap=o,pxsim.injectEnvironmentGlobals(s,o),Runtime.postMessage(s),breakpoints[0]=0,breakFrame=null,__this.pauseScheduled(),dbgResume=n=>{if(dbgResume=null,dbgHeap=null,__this.dead)return null;switch(__this.resumeAllPausedScheduled(),__this.board.onDebuggerResume(),pxsim.runtime=__this,U.assert(e.pc==t),breakpoints[0]=0,breakFrame=null,n.subtype){case"resume":break;case"stepover":breakpoints[0]=1,breakFrame=e;break;case"stepinto":breakpoints[0]=1;break;case"stepout":breakpoints[0]=1,breakFrame=e.parent||e}U.assert(__this.loopLock==r),__this.loopLock=null,__this.otherFrames.push(e),loop(e),flushLoopLock()},null}function trace(e,t,n,i){if(setupResume(t,n),"<main>"===i.functionName||"main.ts"===i.fileName){if(!pxsim.runtime.traceDisabled){const{msg:n}=pxsim.getBreakpointMsg(t,e,userGlobals);n.subtype="trace",Runtime.postMessage(n)}pxsim.thread.pause(tracePauseMs||1)}else pxsim.thread.pause(0);checkResumeConsumed()}function handleDebuggerMsg(e){switch(e.subtype){case"config":let t=e;if(t.setBreakpoints&&breakpoints){breakpoints.fill(0);for(let e of t.setBreakpoints)breakpoints[e]=1}break;case"traceConfig":tracePauseMs=e.interval;break;case"pause":breakpoints[0]=1,breakFrame=null;break;case"resume":case"stepover":case"stepinto":case"stepout":dbgResume&&dbgResume(e);break;case"variables":const n=e;let i;if(dbgHeap){const e=dbgHeap[n.variablesReference];void 0!==e&&(i=pxsim.dumpHeap(e,dbgHeap,n.fields,void 0,n.includeAll))}Runtime.postMessage({type:"debugger",subtype:"variables",req_seq:e.seq,variables:i})}}function removeFrame(e){const t=__this.otherFrames;for(let n=t.length-1;n>=0;--n)if(t[n]===e)return void t.splice(n,1);U.userError("frame cannot be removed!")}function loop(e){if(__this.dead)pxsim.log("Runtime terminated");else{U.assert(!__this.loopLock),__this.perfStartRuntime(),removeFrame(e);try{for(pxsim.runtime=__this;e;)__this.currFrame=e,__this.currFrame.overwrittenPC=!1,e=e.fn(e),__this.maybeUpdateDisplay(),__this.currFrame.overwrittenPC&&(e=__this.currFrame);__this.perfStopRuntime()}catch(t){if(t instanceof BreakLoopException)return void U.nextTick(loopForSchedule(__this.currFrame));if(__this.perfStopRuntime(),__this.errorHandler)__this.errorHandler(t);else{pxsim.error("Simulator crashed, no error handler",t.stack);const{msg:n,heap:i}=pxsim.getBreakpointMsg(e,e.lastBrkId,userGlobals);pxsim.injectEnvironmentGlobals(n,i),n.exceptionMessage=t.message,n.exceptionStack=t.stack,Runtime.postMessage(n),__this.postError&&__this.postError(t)}}}}function checkStack(e){e>100&&U.userError("Stack overflow")}function actionCall(e){return e.depth=e.parent.depth+1,checkStack(e.depth),e.pc=0,e}function setupTop(e){let t=setupTopCore(e);return setupResume(t,0),t}function setupTopCore(e){let t={parent:null,pc:0,depth:0,threadId:++threadId,fn:()=>(e&&e(t.retval),null)};return t}function topCall(e,t){U.assert(!!__this.board),U.assert(!__this.running),__this.setRunning(!0);let n={parent:setupTopCore(t),fn:e,depth:0,pc:0};__this.otherFrames=[n],loop(actionCall(n))}function checkResumeConsumed(){currResume&&oops("getResume() not called")}function setupResume(e,t){currResume=buildResume(e,t)}function leaveAccessor(e,t){if(e.stage2Call){const n={pc:0,fn:null,depth:e.depth,parent:e.parent};let i=1;for(;e.hasOwnProperty("arg"+i);)n["arg"+(i-1)]=e["arg"+i],i++;return setupLambda(n,t),n}return e.parent.retval=t,e.parent}function setupLambda(e,t,n){if(n){const t=e;for(let e=1;e<n;++e)t["arg"+(e-1)]=t["arg"+e];delete t["arg"+(n-1)]}t instanceof pxsim.RefAction?(e.fn=t.func,e.caps=t.fields):"function"==typeof t?e.fn=t:oops("calling non-function")}function checkSubtype(e,t){if(!e)return!1;const n=e.vtable;return t===n||n&&t.classNo<=n.classNo&&n.classNo<=t.lastSubtypeNo}function failedCast(e,t){pxsim.control&&pxsim.control.dmesgValue&&pxsim.control.dmesgValue(e),throwFailedCastError(e,null==t?void 0:t.name)}function buildResume(e,t){currResume&&oops("already has resume"),e.pc=t;let n=Date.now();__this.otherFrames.push(e);let i=r=>{if(__this.dead)return;if(__this.loopLock)return void __this.loopLockWaitList.push(()=>i(r));pxsim.runtime=__this;let s=Date.now();if(s-n>3&&(lastYield=s),U.assert(e.pc==t),r instanceof pxsim.FnWrapper){let t=r,n={parent:e,fn:t.func,lambdaArgs:t.args,pc:0,caps:t.caps,depth:e.depth+1},i={};return __this.loopLock=i,removeFrame(e),__this.otherFrames.push(n),U.nextTick(()=>{U.assert(__this.loopLock===i),__this.loopLock=null,loop(actionCall(n)),flushLoopLock()})}return e.retval=r,loop(e)};return i}const entryPoint=msg.code&&eval(msg.code)(evalIface);this.run=e=>topCall(entryPoint,e),this.getResume=()=>{currResume||oops("noresume");let e=currResume;return currResume=null,e},this.setupTop=setupTop,this.handleDebuggerMsg=handleDebuggerMsg,this.entry=entryPoint,this.overwriteResume=e=>{currResume=null,e>=0&&(this.currFrame.pc=e),this.currFrame.overwrittenPC=!0},pxsim.runtime=this,pxsim.initCurrentRuntime(msg)}registerLiveObject(e){return this.refObjId++}runningTime(){return U.now()-this.startTime-this.pausedTime}runningTimeUs(){return 4294967295&U.perfNowUs()-this.startTimeUs}runFiberAsync(e,t,n,i){return new Promise((r,s)=>U.nextTick(()=>{pxsim.runtime=this,this.setupTop(r),pxtcore.runAction(e,[t,n,i])}))}currTryFrame(){for(let e=this.currFrame;e;e=e.parent)if(e.tryFrame)return e.tryFrame;return null}traceObjects(){const e={};for(;this.heapSnapshots.length>2;)this.heapSnapshots.shift();const t={count:0,size:0,name:"TOTAL"},n={TOTAL:t};function i(t,n,r=null){if(!(n instanceof pxsim.RefObject))return;const s=n;if(s.gcIsStatic())return;const o=e[s.id];if(o)return void(r&&o.pointers.push([r,t]));const a={obj:s,path:null,pointers:[[r,t]]};e[s.id]=a,s.scan((t,n)=>{n instanceof pxsim.RefObject&&!e[n.id]&&i(t,n,a)})}this.heapSnapshots.push({visited:e,statsByType:n});for(let e of Object.keys(this.globals))i(e.replace(/___\d+$/,""),this.globals[e]);const r=this.otherFrames.slice();this.currFrame&&r.indexOf(this.currFrame)<0&&r.unshift(this.currFrame);for(const e of this.getThreads()){const t="Thread-"+this.rootFrame(e).threadId;for(let n=e;n;n=n.parent){const e=t+"."+functionName(n.fn);for(let t of Object.keys(n))if(/^(r0|arg\d+|.*___\d+)/.test(t)){const r=n[t];r instanceof pxsim.RefObject&&(t=t.replace(/___.*/,""),i(e+"."+t,r))}if(n.caps)for(let t of n.caps)i(e+".cap",t)}}const s=Object.keys(e).map(t=>e[t]);s.sort((e,t)=>t.obj.gcSize()-e.obj.gcSize());const o=e=>{if(null!=e.path)return;let t="";e.path="(cycle)";for(let[n,i]of e.pointers){if(null==n)return void(e.path=i);o(n);const r=n.path+"."+i;(!t||t.length>r.length)&&(t=r)}e.path=t};s.forEach(o);const a=[t];for(const e of s){const i=e.obj.gcSize(),r=e.obj.gcKey();n.hasOwnProperty(r)||a.push(n[r]={count:0,size:0,name:r});const s=n[r];s.size+=i,s.count++,t.size+=i,t.count++}a.sort((e,t)=>e.size-t.size);let l="";const c=e=>("        "+e.toString()).slice(-7);for(const e of a)l+=c(4*e.size)+c(e.count)+" "+e.name+"\n";const u=e=>c(4*e.obj.gcSize())+" "+e.obj.gcKey()+" "+e.path,d=s.slice(0,20).map(u).join("\n");let p="";if(this.heapSnapshots.length>=3){const e=this.heapSnapshots[this.heapSnapshots.length-3].visited,t=this.heapSnapshots[this.heapSnapshots.length-2].visited,i=e=>e instanceof pxsim.RefRecord&&!!(e.vtable&&e.vtable.maxBgInstances&&n[e.gcKey()].count<=e.vtable.maxBgInstances);p=s.filter(n=>!e[n.obj.id]&&t[n.obj.id]).filter(e=>!i(e.obj)).map(u).join("\n")}return"Threads:\n"+this.threadInfo()+"\n\nSummary:\n"+l+"\n\nLarge Objects:\n"+d+"\n\nNew Objects:\n"+p}getThreads(){const e=this.otherFrames.slice();return this.currFrame&&e.indexOf(this.currFrame)<0&&e.unshift(this.currFrame),e}rootFrame(e){let t=e;for(;t.parent;)t=t.parent;return t}threadInfo(){const e=this.getThreads();let t="";for(let n of e){t+=`Thread ${this.rootFrame(n).threadId}:\n`;for(let e of pxsim.getBreakpointMsg(n,n.lastBrkId).msg.stackframes){let n=e.funcInfo;t+=`   at ${n.functionName} (${n.fileName}:${n.line+1}:${n.column+1})\n`}t+="\n"}return t}static postMessage(e){e&&("undefined"!=typeof window&&window.parent&&window.parent.postMessage&&window.parent.postMessage(e,"*"),Runtime.messagePosted&&Runtime.messagePosted(e))}static async postScreenshotAsync(e){const t=pxsim.runtime&&pxsim.runtime.board;if(!t)return;const n=await t.screenshotAsync();Runtime.postMessage({type:"screenshot",data:n,delay:e&&e.delay})}static requestToggleRecording(){const e=pxsim.runtime;e&&Runtime.postMessage({type:"recorder",action:e.recording?"stop":"start"})}restart(){this.kill(),setTimeout(()=>pxsim.Runtime.postMessage({type:"simulator",command:"restart"}),500)}kill(){this.dead=!0,this.stopRecording(),this.stopIdle(),this.setRunning(!1)}updateDisplay(){this.board.updateView(),this.postFrame()}startRecording(e){!this.recording&&this.running&&(this.recording=!0,this.recordingTimer=setInterval(()=>this.postFrame(),66),this.recordingLastImageData=void 0,this.recordingWidth=e)}stopRecording(){this.recording&&(this.recordingTimer&&clearInterval(this.recordingTimer),this.recording=!1,this.recordingTimer=0,this.recordingLastImageData=void 0,this.recordingWidth=void 0)}postFrame(){if(!this.recording||!this.running)return;let e=pxsim.U.now();this.board.screenshotAsync(this.recordingWidth).then(t=>{this.recordingLastImageData&&isImageDataEqual(this.recordingLastImageData,t)||(this.recordingLastImageData=t,Runtime.postMessage({type:"screenshot",data:t,time:e}))})}queueDisplayUpdate(){this.numDisplayUpdates++}maybeUpdateDisplay(){this.numDisplayUpdates&&(this.numDisplayUpdates=0,this.updateDisplay())}setRunning(e){this.running!=e&&(this.running=e,this.running?(this.startTime=U.now(),this.startTimeUs=U.perfNowUs(),Runtime.postMessage({type:"status",frameid:pxsim.Embed.frameid,runtimeid:this.id,state:"running"})):(this.stopRecording(),this.stopIdle(),Runtime.postMessage({type:"status",frameid:pxsim.Embed.frameid,runtimeid:this.id,state:"killed"})),this.stateChanged&&this.stateChanged())}dumpLivePointers(){}setupPerfCounters(e){e&&e.length&&(this.perfCounters=e.map(e=>new PerfCounter(e)))}perfStartRuntime(){0!==this.perfOffset?this.perfStack++:this.perfOffset=U.perfNowUs()-this.perfElapsed}perfStopRuntime(){this.perfStack?this.perfStack--:(this.perfElapsed=this.perfNow(),this.perfOffset=0)}perfNow(){return 0===this.perfOffset&&U.userError("bad time now"),U.perfNowUs()-this.perfOffset|0}startPerfCounter(e){if(!this.perfCounters)return;const t=this.perfCounters[e];t.start&&U.userError("startPerf"),t.start=this.perfNow()}stopPerfCounter(e){if(!this.perfCounters)return;const t=this.perfCounters[e];t.start||U.userError("stopPerf");const n=this.perfNow()-t.start;t.start=0,t.value+=n,t.numstops++;let i=t.lastFewPtr++;i>=t.lastFew.length&&(i=0,t.lastFewPtr=1),t.lastFew[i]=n}startIdle(){void 0===this.idleTimer&&(this.idleTimer=setInterval(()=>{if(!this.running||this.pausedOnBreakpoint)return;const e=this.board.bus;e&&e.queueIdle()},20))}stopIdle(){void 0!==this.idleTimer&&(clearInterval(this.idleTimer),this.idleTimer=void 0)}schedule(e,t){if(t<=0&&(t=0),this.pausedOnBreakpoint)return this.timeoutsPausedOnBreakpoint.push(new PausedTimeout(e,t)),-1;const n=U.now(),i=new TimeoutScheduled(-1,e,t,n);return i.id=setTimeout(()=>{const t=this.timeoutsScheduled.indexOf(i);t>=0&&this.timeoutsScheduled.splice(t,1),e()},t),this.timeoutsScheduled.push(i),i.id}pauseScheduled(){this.pausedOnBreakpoint=!0,this.timeoutsScheduled.forEach(e=>{clearTimeout(e.id);let t=U.now()-e.timestampCall,n=e.totalRuntime-t;n<=0&&(n=1),this.timeoutsPausedOnBreakpoint.push(new PausedTimeout(e.fn,n))}),this.lastPauseTimestamp=U.now(),this.timeoutsScheduled=[]}resumeAllPausedScheduled(){this.pausedOnBreakpoint=!1,this.timeoutsPausedOnBreakpoint.forEach(e=>{this.schedule(e.fn,e.timeRemaining)}),this.lastPauseTimestamp&&(this.pausedTime+=U.now()-this.lastPauseTimestamp,this.lastPauseTimestamp=0),this.timeoutsPausedOnBreakpoint=[]}cleanScheduledExpired(){let e=U.now();this.timeoutsScheduled=this.timeoutsScheduled.filter(t=>{let n=e-t.timestampCall;return t.totalRuntime>n})}registerUserInteraction(){this.lastInteractionTime=Date.now(),this.thumbnailRecordingIntervalRef||this.lastThumbnailTime&&this.lastInteractionTime-this.lastThumbnailTime<1e3||(this.thumbnailFrames=[],this.thumbnailRecordingIntervalRef=setInterval(async()=>{const e=await this.board.screenshotAsync();this.thumbnailFrames.length&&isImageDataEqual(e,this.thumbnailFrames[this.thumbnailFrames.length-1])||(this.thumbnailFrames.push(e),(Date.now()-this.lastInteractionTime>1e4||this.thumbnailFrames.length>30)&&(clearInterval(this.thumbnailRecordingIntervalRef),this.thumbnailRecordingIntervalRef=void 0,this.lastThumbnailTime=Date.now(),Runtime.postMessage({type:"thumbnail",frames:this.thumbnailFrames})))},66))}}function throwUserException(e){throw new Error(e)}function throwTypeError(e){throwUserException(pxsim.localization.lf("TypeError: {0}",e))}function throwFailedCastError(e,t){const n=getType(e);throwTypeError(t?null==e?pxsim.localization.lf("Expected type {0} but received type {1}. Did you forget to assign a variable?",t,n):pxsim.localization.lf("Expected type {0} but received type {1}",t,n):pxsim.localization.lf("Cannot read properties of {0}",n))}function throwFailedPropertyAccessError(e,t){const n=getType(e);throwTypeError(t?pxsim.localization.lf("Cannot read properties of {0} (reading '{1}')",n,t):pxsim.localization.lf("Cannot read properties of {0}",n))}function throwNullUndefinedAsObjectError(){throwTypeError(pxsim.localization.lf("Cannot convert undefined or null to object"))}function getType(e){let t;const n=null==e?void 0:e.vtable;return t=n?n.name:null===e?"null":void 0===e?"undefined":e instanceof pxsim.RefCollection?"Array":e instanceof pxsim.RefBuffer?"Buffer":e instanceof pxsim.RefAction?"function":typeof e,t}function setParentMuteState(e){Runtime.postMessage({type:"setmutebuttonstate",state:e})}pxsim.Runtime=Runtime,pxsim.throwUserException=throwUserException,pxsim.throwTypeError=throwTypeError,pxsim.throwFailedCastError=throwFailedCastError,pxsim.throwFailedPropertyAccessError=throwFailedPropertyAccessError,pxsim.throwNullUndefinedAsObjectError=throwNullUndefinedAsObjectError,pxsim.setParentMuteState=setParentMuteState;class PerfCounter{constructor(e){this.name=e,this.start=0,this.numstops=0,this.value=0,this.lastFew=new Uint32Array(32),this.lastFewPtr=0}}function isImageDataEqual(e,t){if(e.data.byteLength!==t.data.byteLength)return!1;const n=e.data.byteLength;let i=0;for(i=0;i<n&&e.data[i]==t.data[i];++i);return i===n}pxsim.PerfCounter=PerfCounter}(pxsim||(pxsim={})),function(e){let t,n;!function(e){e[e.Unloaded=0]="Unloaded",e[e.Stopped=1]="Stopped",e[e.Pending=2]="Pending",e[e.Starting=3]="Starting",e[e.Running=4]="Running",e[e.Paused=5]="Paused",e[e.Suspended=6]="Suspended"}(t=e.SimulatorState||(e.SimulatorState={})),function(e){e[e.StepInto=0]="StepInto",e[e.StepOver=1]="StepOver",e[e.StepOut=2]="StepOut",e[e.Resume=3]="Resume",e[e.Pause=4]="Pause"}(n=e.SimulatorDebuggerCommand||(e.SimulatorDebuggerCommand={}));const i="messagechannel",r="aspectratio",s="pxtdriver",o="permanent";e.SimulatorDriver=class{constructor(n,i={}){this.container=n,this.options=i,this.themes=["blue","red","green","yellow"],this.runId="",this.nextFrameId=0,this.frameCounter=0,this.singleSimulator=!1,this.traceInterval=0,this.breakpointsSet=!1,this._runOptions={},this.state=t.Unloaded,this._allowedOrigins=[],this.newJacdacSimulator=!1,this.frameCleanupTimeout=void 0,this.debuggerSeq=1,this.debuggerResolvers={},this._allowedOrigins.push(window.location.origin),i.parentOrigin&&this._allowedOrigins.push(i.parentOrigin),this._allowedOrigins.push(this.getSimUrl().origin);const r=(null==i?void 0:i.messageSimulators)||{};Object.keys(r).map(e=>r[e]).forEach(e=>{this._allowedOrigins.push(new URL(e.url).origin),e.localHostUrl&&this._allowedOrigins.push(new URL(e.localHostUrl).origin)});const s=e.U.isLocalHost()&&/[?&]simxdev(?:[=&#]|$)/i.test(window.location.href);Object.entries((null==i?void 0:i.simulatorExtensions)||{}).forEach(([e,t])=>{if(t&&t.index&&t.aspectRatio&&void 0!==t.permanent){if(s&&t.devUrl)t.url=new URL(t.index,t.devUrl).toString();else{const n=this.getSimUrl(),i=["simx",e,"-",t.index].join("/");t.url=new URL(i.replace(/^\/+/,""),n.origin).toString()}this._allowedOrigins.push(new URL(t.url).origin)}}),this._allowedOrigins=e.U.unique(this._allowedOrigins,e=>e)}isDebug(){return this._runOptions&&!!this._runOptions.debug}isTracing(){return this._runOptions&&!!this._runOptions.trace}hasParts(){return this._runOptions&&this._runOptions.parts&&!!this._runOptions.parts.length}setDirty(){this.state==e.SimulatorState.Running&&this.suspend()}setPending(){this.setState(t.Pending)}focus(){const e=this.simFrames()[0];e&&e.focus()}registerDependentEditor(e){e&&(this._dependentEditors||(this._dependentEditors=[]),this._dependentEditors.push(e))}dependentEditors(){return this._dependentEditors&&(this._dependentEditors=this._dependentEditors.filter(e=>!!e.parent),this._dependentEditors.length||(this._dependentEditors=void 0)),this._dependentEditors}setStarting(){this.setState(t.Starting)}setHwDebugger(e){e?(this.hwdbg=e,this.setState(t.Running),this.container.style.opacity="0.3"):(delete this.container.style.opacity,this.hwdbg=null,this.setState(t.Running),this.stop())}handleHwDebuggerMsg(e){this.hwdbg&&this.handleMessage(e)}setThemes(t){e.U.assert(t&&t.length>0),this.themes=t}startRecording(e){this.simFrames()[0]&&this.postMessage({type:"recorder",action:"start",source:s,width:e})}stopRecording(){this.postMessage({type:"recorder",source:s,action:"stop"})}setFrameState(n){const i=n.nextElementSibling,r=i.nextElementSibling;switch(this.state){case t.Pending:case t.Starting:i.style.display="",i.className="",r.style.display="";break;case t.Stopped:case t.Suspended:e.U.addClass(n,this.state==t.Stopped||this._runOptions&&this._runOptions.autoRun?this.stoppedClass:this.invalidatedClass),this._runOptions&&this._runOptions.autoRun?i.style.display="none":(i.style.display="",i.className="videoplay xicon icon"),r.style.display="none",this.scheduleFrameCleanup();break;default:e.U.removeClass(n,this.stoppedClass),e.U.removeClass(n,this.invalidatedClass),i.style.display="none",r.style.display="none"}}setState(e){this.state!=e&&(this.state=e,this.freeze(this.state==t.Paused),this.simFrames().forEach(e=>this.setFrameState(e)),this.options.onStateChanged&&this.options.onStateChanged(this.state))}freeze(t){const n="pause-overlay";t?e.util.toArray(this.container.querySelectorAll("div.simframe")).forEach(e=>{if(e.querySelector(`div.${n}`))return;const t=document.createElement("div");t.className=n,t.onclick=e=>(e.preventDefault(),!1),e.appendChild(t)}):e.util.toArray(this.container.querySelectorAll(`div.simframe div.${n}`)).forEach(e=>e.parentElement.removeChild(e))}simFrames(t=!1){let n=e.util.toArray(this.container.getElementsByTagName("iframe"));const i=this.loanedIFrame();return i&&!t&&n.unshift(i),n}getSimUrl(){var e,t;const n=this.options.simUrl||(null===(e=window.pxtConfig)||void 0===e?void 0:e.simUrl)||(null===(t=pxt.webConfig)||void 0===t?void 0:t.simUrl)||`${location.origin}/sim/simulator.html`;try{return new URL(n)}catch(e){return new URL(n,location.origin)}}setSingleSimulator(){this.singleSimulator=!0}postMessage(t,n,s){var a;if(this.hwdbg)return void this.hwdbg.postMessage(t);const l=this.dependentEditors();let c=this.simFrames();s&&(c=c.filter(e=>e.id===s));let u=!1;const d=t;if(n&&(null==d?void 0:d.broadcast)){d.srcFrameIndex=this.simFrames().findIndex(e=>e.contentWindow===n);const s=!!(null===(a=this._currentRuntime)||void 0===a?void 0:a.single),p=window.parent&&window.parent!==window.window?window.parent:window.opener;if(p&&n!==p&&p.postMessage(t,"*"),!this.options.nestedEditorSim&&!(null==d?void 0:d.toParentIFrameOnly))if(l)l.forEach(e=>{n!==e&&e.postMessage(t,window.location.origin)});else if(!s){const n="messagepacket"===t.type&&t.channel,s=n&&this.options.messageSimulators&&this.options.messageSimulators[n],a=n&&this.options.simulatorExtensions&&this.options.simulatorExtensions[n],l=(t,s,a)=>{var l;a=a||(null===(l=this._runOptions)||void 0===l?void 0:l.aspectRatio)||1.22;let u=this.createFrame(t);this.container.appendChild(u);const d=u.firstElementChild;d.dataset[i]=n,d.dataset[r]=a+"",e.U.addClass(u,"simmsg"),e.U.addClass(u,"simmsg"+e.U.sanitizeCssName(n)),s&&(d.dataset[o]="true"),this.startFrame(d),c=this.simFrames()};if(a){let e=c.find(e=>e.dataset[i]===n);if("jacdac/pxt-jacdac"===n&&(this.newJacdacSimulator=!0),e)e.dataset.runid!=this.runId&&this.startFrame(e);else{const e=new URL(a.url);this.options.parentOrigin&&e.searchParams.set("parentOrigin",encodeURIComponent(this.options.parentOrigin)),this.options.userLanguage&&e.searchParams.set("language",encodeURIComponent(this.options.userLanguage)),l(e.toString(),a.permanent,a.aspectRatio)}}else if(s){let t=c.find(e=>e.dataset[i]===n);if(t)t.dataset.runid!=this.runId&&this.startFrame(t);else if("jacdac"!==n||!this.newJacdacSimulator){l((e.U.isLocalHost()&&/localhostmessagesims=1/i.test(window.location.href)&&s.localHostUrl||s.url).replace("$PARENT_ORIGIN$",encodeURIComponent(this.options.parentOrigin||"")).replace("$LANGUAGE$",encodeURIComponent(this.options.userLanguage)),s.permanent,s.aspectRatio)}}else{u=!0;const e=c.filter(e=>!e.dataset[i]);n||0!=e.length&&(1!=e.length||this.singleSimulator)?2==e.length&&e[1].dataset.runid!=this.runId&&this.startFrame(e[1]):(this.container.appendChild(this.createFrame()),c=this.simFrames())}}}for(let e=0;e<c.length;++e){const i=c[e];if((!n||i.contentWindow!=n)&&(i.contentWindow&&(u?this.postDeferrableMessage(i,t):this.postMessageCore(i,t),"recorder"==t.type&&"start"==t.action)))break}}postDeferrableMessage(e,t){!e.dataset.loading?this.postMessageCore(e,t):(this.deferredMessages||(this.deferredMessages=[]),this.deferredMessages.push([e,t]))}postMessageCore(t,n){const i=e.U.isLocalHostDev()?"*":t.dataset.origin;t.contentWindow.postMessage(n,i)}setRunOptionQueryParams(e){var t,n;const i=new URL(e);if((null===(t=this._runOptions)||void 0===t?void 0:t.hideSimButtons)&&i.searchParams.set("hideSimButtons","1"),null===(n=this._runOptions)||void 0===n?void 0:n.queryParameters){const e=this._runOptions.queryParameters.split("&");for(const t of e){const[e,n]=t.split(/[:=]/);e&&n&&i.searchParams.set(e,n)}}return i.toString()}createFrame(n){var i;const r=document.createElement("div");r.className="simframe ui embed";const s=document.createElement("iframe");s.id="sim-frame-"+this.nextId(),s.title=e.localization.lf("Simulator"),s.allowFullscreen=!0,s.setAttribute("allow","autoplay;microphone"),s.setAttribute("sandbox","allow-same-origin allow-scripts"),s.className="no-select";let o=this.setRunOptionQueryParams(n||this.getSimUrl().toString());o+="#"+s.id,s.src=o,s.frameBorder="0",s.dataset.runid=this.runId,s.dataset.origin=new URL(o).origin||"*",s.dataset.loading="true",(null===(i=this._runOptions)||void 0===i?void 0:i.autofocus)&&s.setAttribute("autofocus","true"),r.appendChild(s);const a=document.createElement("i");a.className="videoplay xicon icon",a.style.display="none",a.onclick=e=>(e.preventDefault(),this.state!=t.Running&&this.state!=t.Starting&&(this.options.restart?this.options.restart():this.start()),s.focus(),!1),r.appendChild(a);const l=document.createElement("div");return l.className="ui active loader",a.style.display="none",r.appendChild(l),this._runOptions&&this.applyAspectRatioToFrame(s),r}preload(e,t){this.addEventListeners(),t&&(this._currentRuntime=void 0,this.container.textContent=""),this.simFrames().length||(this.container.appendChild(this.createFrame()),this.applyAspectRatio(e),this.setStarting())}stop(e=!1,n=!1){this.state!==t.Stopped&&this.state!==t.Unloaded&&(this.clearDebugger(),this.stopSound(),this.postMessage({type:"stop",source:s}),this.setState(n?t.Starting:t.Stopped)),e&&this.unload()}suspend(){this.stopSound(),this.postMessage({type:"stop",source:s}),this.setState(t.Suspended)}unload(){this.cancelFrameCleanup(),e.U.removeChildren(this.container),this.setState(t.Unloaded),this._runOptions=void 0,this._currentRuntime=void 0,this.runId=void 0,this.deferredMessages=void 0}mute(e){this._currentRuntime&&(this._currentRuntime.mute=e),this.postMessage({type:"mute",source:s,mute:e})}stopSound(){this.postMessage({type:"stopsound",source:s})}isLoanedSimulator(e){return!!this.loanedSimulator&&this.loanedIFrame()==e}loanSimulator(){return this.loanedSimulator||(this.loanedSimulator=this.container.firstElementChild||this.createFrame(),this.loanedSimulator.parentNode&&this.container.removeChild(this.loanedSimulator)),this.loanedSimulator}unloanSimulator(){this.loanedSimulator&&(this.loanedSimulator.parentNode&&this.loanedSimulator.parentNode.removeChild(this.loanedSimulator),this.container.insertBefore(this.loanedSimulator,this.container.firstElementChild),delete this.loanedSimulator)}loanedIFrame(){return this.loanedSimulator&&this.loanedSimulator.parentNode&&this.loanedSimulator.querySelector("iframe")}cancelFrameCleanup(){this.frameCleanupTimeout&&(clearTimeout(this.frameCleanupTimeout),this.frameCleanupTimeout=void 0)}scheduleFrameCleanup(){this.cancelFrameCleanup(),this.frameCleanupTimeout=setTimeout(()=>{this.frameCleanupTimeout=void 0,this.cleanupFrames()},5e3)}applyAspectRatio(e){if(!e&&!this._runOptions)return;this.simFrames().forEach(t=>this.applyAspectRatioToFrame(t,e))}applyAspectRatioToFrame(e,t){var n,s,o,a;let l=t;if(void 0===l){const t=parseFloat(e.dataset[r]);isNaN(t)||(l=t)}if(void 0===l){const t=e.dataset[i];if(t){const e=null===(o=null===(s=null===(n=this.options)||void 0===n?void 0:n.messageSimulators)||void 0===s?void 0:s[t])||void 0===o?void 0:o.aspectRatio;e&&(l=e)}}void 0===l&&(l=(null===(a=this._runOptions)||void 0===a?void 0:a.aspectRatio)||1.22),e.parentElement.style.paddingBottom=100/l+"%"}cleanupFrames(){const e=this.simFrames(!0);e.shift(),e.filter(e=>!e.dataset[o]).forEach(e=>{this.state!=t.Stopped&&e.dataset.runid==this.runId||(this.options.removeElement?this.options.removeElement(e.parentElement):e.parentElement.remove())})}hide(e){if(this.suspend(),!this.options.removeElement)return;const t=this.simFrames();t.forEach(t=>{this.options.removeElement(t.parentElement,e)}),0==t.length&&e&&e()}unhide(){if(!this.options.unhideElement)return;this.simFrames().forEach(e=>{this.options.unhideElement(e.parentElement)})}setRunOptions(e={}){this._runOptions=e}run(e,t={}){this.setRunOptions(t),this.runId=this.nextId(),this._currentRuntime={type:"run",source:s,boardDefinition:t.boardDefinition,parts:t.parts,builtinParts:t.builtinParts,fnArgs:t.fnArgs,code:e,partDefinitions:t.partDefinitions,mute:t.mute,highContrast:t.highContrast,light:t.light,cdnUrl:t.cdnUrl,localizedStrings:t.localizedStrings,refCountingDebug:t.refCountingDebug,version:t.version,clickTrigger:t.clickTrigger,breakOnStart:t.breakOnStart,storedState:t.storedState,ipc:t.ipc,single:t.single,dependencies:t.dependencies,activePlayer:t.activePlayer,theme:t.theme},this.stopSound(),this.start()}restart(){this.stop(),this.cleanupFrames(),this.start()}areBreakpointsSet(){return this.breakpointsSet}start(){if(this.clearDebugger(),this.addEventListeners(),this.applyAspectRatio(),this.scheduleFrameCleanup(),!this._currentRuntime)return;this.singleSimulator=!1,this.breakpointsSet=!1;let e=this.simFrames()[0];if(!e){let t=this.createFrame();this.container.appendChild(t),e=t.firstElementChild}this.startFrame(e),this.debuggingFrame=e.id,this.setState(t.Running),this.setTraceInterval(this.traceInterval)}startFrame(e){var t,n,i;if(!this._currentRuntime||!e.contentWindow)return!1;const r=JSON.parse(JSON.stringify(this._currentRuntime));r.frameCounter=++this.frameCounter;const s=(null===(t=this._runOptions)||void 0===t?void 0:t.mpRole)||(null===(i=null===(n=/[\&\?]mp=(server|client)/i.exec(window.location.href))||void 0===n?void 0:n[1])||void 0===i?void 0:i.toLowerCase());return r.options={theme:this.themes[this.nextFrameId++%this.themes.length],mpRole:s},r.id=`${r.options.theme}-${this.nextId()}`,e.dataset.runid=this.runId,e.dataset.runtimeid=r.id,e.id!==this.debuggingFrame&&(r.traceDisabled=!0,r.breakOnStart=!1),this.postMessageCore(e,r),this.traceInterval&&this.setTraceInterval(this.traceInterval),this.applyAspectRatioToFrame(e),this.setFrameState(e),!0}handleDeferredMessages(e){var t,n,i;e.dataset.loading&&(delete e.dataset.loading,null===(n=null===(t=this.deferredMessages)||void 0===t?void 0:t.filter(t=>t[0]===e))||void 0===n||n.forEach(t=>{const[n,i]=t;this.postMessageCore(e,i)}),this.deferredMessages=null===(i=this.deferredMessages)||void 0===i?void 0:i.filter(t=>t[0]!==e))}handleMessage(e,n){var i,s,o;switch(e.type||""){case"ready":{const t=e.frameid,n=document.getElementById(t);n&&((null===(i=this._runOptions)||void 0===i?void 0:i.autofocus)&&n.focus(),this.startFrame(n),this.options.revealElement&&this.options.revealElement(n),this.handleDeferredMessages(n)),this.options.onSimulatorReady&&this.options.onSimulatorReady();break}case"status":{const n=e.frameid,i=document.getElementById(n);if(i){const n=e;if(n.runtimeid==i.dataset.runtimeid)switch(n.state){case"running":this.setState(t.Running),this.handleDeferredMessages(i);break;case"killed":this.setState(t.Stopped)}}break}case"simulator":this.handleSimulatorCommand(e);break;case"serial":case"pxteditor":case"screenshot":case"custom":case"recorder":case"addextensions":break;case"aspectratio":{const t=e,n=t.frameid,i=document.getElementById(n);i&&(i.dataset[r]=t.value+"",this.applyAspectRatioToFrame(i));break}case"debugger":this.handleDebuggerMessage(e);break;case"toplevelcodefinished":this.options.onTopLevelCodeEnd&&this.options.onTopLevelCodeEnd();break;case"setmutebuttonstate":null===(o=(s=this.options).onMuteButtonStateChange)||void 0===o||o.call(s,e.state);break;default:this.postMessage(e,n)}}addEventListeners(){this.listener||(this.listener=t=>{if(!this.hwdbg){if(e.U.isLocalHost());else if(this._allowedOrigins.indexOf(t.origin)<0)return;this.handleMessage(t.data,t.source)}},window.addEventListener("message",this.listener,!1))}removeEventListeners(){this.listener&&(window.removeEventListener("message",this.listener,!1),this.listener=void 0)}resume(i){let r;switch(i){case n.Resume:r="resume",this.setState(t.Running);break;case n.StepInto:r="stepinto",this.setState(t.Running);break;case n.StepOut:r="stepout",this.setState(t.Running);break;case n.StepOver:r="stepover",this.setState(t.Running);break;case n.Pause:r="pause";break;default:return void e.debug("unknown command")}this.postMessage({type:"debugger",subtype:r,source:s})}setBreakpoints(e){this.breakpointsSet=!0,this.postDebuggerMessage("config",{setBreakpoints:e},void 0,this.debuggingFrame)}setTraceInterval(e){this.traceInterval=e,this.postDebuggerMessage("traceConfig",{interval:e})}variablesAsync(e,t,n=!1){return this.postDebuggerMessageAsync("variables",{variablesReference:e,fields:t,includeAll:n},this.debuggingFrame).then(e=>e,e=>{})}handleSimulatorCommand(e){this.options.onSimulatorCommand&&this.options.onSimulatorCommand(e)}clearDebugger(){const e=new Error("Debugging cancelled");Object.keys(this.debuggerResolvers).forEach(t=>{const{reject:n}=this.debuggerResolvers[t];n(e)}),this.debuggerResolvers={},this.debuggerSeq++}handleDebuggerMessage(i){if("trace"!==i.subtype&&e.log("DBG-MSG",i.subtype,i),i.seq){const{resolve:e}=this.debuggerResolvers[i.seq];e&&e(i)}switch(i.subtype){case"warning":this.options.onDebuggerWarning&&this.options.onDebuggerWarning(i);break;case"breakpoint":{const r=i;if(this.state==t.Running){if(r.exceptionMessage)this.suspend();else{this.setState(t.Paused);this.simFrames(!0).length>1&&this.resume(n.Pause)}this.options.onDebuggerBreakpoint&&this.options.onDebuggerBreakpoint(r);let i=r.exceptionMessage+"\n";for(let e of r.stackframes){let t=e.funcInfo;i+=`   at ${t.functionName} (${t.fileName}:${t.line+1}:${t.column+1})\n`}r.exceptionMessage&&e.error(i)}else e.error("debugger: trying to pause from "+this.state);break}case"trace":{const e=i;this.state==t.Running&&this.options.onTraceMessage&&this.options.onTraceMessage(e);break}default:const r=i.req_seq;if(r){const{resolve:e}=this.debuggerResolvers[r];e&&(delete this.debuggerResolvers[r],e(i))}}}postDebuggerMessageAsync(e,t={},n){return new Promise((i,r)=>{const s=this.debuggerSeq++;this.debuggerResolvers[s.toString()]={resolve:i,reject:r},this.postDebuggerMessage(e,t,s,n)})}postDebuggerMessage(e,t={},n,i){const r=JSON.parse(JSON.stringify(t));r.type="debugger",r.subtype=e,r.source=s,n&&(r.seq=n),this.postMessage(r,void 0,i)}nextId(){return this.nextFrameId+++(Math.random()+""+Math.random()).replace(/[^\d]/,"")}get stoppedClass(){return this.options&&this.options.stoppedClass||"grayscale"}get invalidatedClass(){return this.options&&this.options.invalidatedClass||"sepia"}}}(pxsim||(pxsim={})),function(e){e.mkRange=function(e,t){let n=[];for(;e<t;e++)n.push(e);return n};e.EventBus=class{constructor(e,t,n){this.runtime=e,this.board=t,this.valueToArgs=n,this.queues={},this.backgroundHandlerFlag=!1,this.nextNotifyEvent=1024,this.schedulerID=15,this.idleEventID=2,this.board.addMessageListener(this.handleMessage.bind(this))}handleMessage(e){if("eventbus"===e.type){const t=e;this.queue(t.id,t.eventid,t.value)}}setBackgroundHandlerFlag(){this.backgroundHandlerFlag=!0}setNotify(e,t){this.notifyID=e,this.notifyOneID=t}setIdle(e,t){this.schedulerID=e,this.idleEventID=t}start(t,n,i,r=!1){let s=(i?"back":"fore")+":"+t+":"+n;return!this.queues[s]&&r&&(this.queues[s]=new e.EventQueue(this.runtime,this.valueToArgs)),this.queues[s]}listen(e,t,n,i=0){e==this.schedulerID&&t==this.idleEventID&&this.runtime.startIdle();let r=this.start(e,t,this.backgroundHandlerFlag,!0);this.backgroundHandlerFlag?r.addHandler(n,i):r.setHandler(n,i),this.backgroundHandlerFlag=!1}removeBackgroundHandler(e){Object.keys(this.queues).forEach(t=>{t.startsWith("back:")&&this.queues[t].removeHandler(e)})}getQueues(e,t,n){let i=[this.start(0,0,n)];return 0==e&&0==t||(t&&i.push(this.start(0,t,n)),e&&i.push(this.start(e,0,n)),e&&t&&i.push(this.start(e,t,n))),i}queue(t,n,i=null){if(e.runtime.pausedOnBreakpoint)return;const r=this.notifyID&&this.notifyOneID&&t==this.notifyOneID;r&&(t=this.notifyID);let s=this.getQueues(t,n,!0).concat(this.getQueues(t,n,!1));this.lastEventValue=n,this.lastEventTimestampUs=e.U.perfNowUs(),e.U.promiseMapAllSeries(s,e=>e?e.push(i,r):Promise.resolve())}queueIdle(){this.schedulerID&&this.idleEventID&&this.queue(this.schedulerID,this.idleEventID)}wait(e,t,n){this.start(e,t,!1,!0).addAwaiter(n)}getLastEventValue(){return this.lastEventValue}getLastEventTime(){return 4294967295&this.lastEventTimestampUs-e.runtime.startTimeUs}};let t;function n(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&navigator.maxTouchPoints>0)}function i(){return"undefined"!=typeof window&&!!window.PointerEvent}e.AnimationQueue=class{constructor(e){this.runtime=e,this.queue=[],this.process=()=>{let t=this.queue[0];if(!t)return;if(this.runtime.dead)return;e=this.runtime;let n=t.frame();e.queueDisplayUpdate(),e.maybeUpdateDisplay(),!1===n?(this.queue.shift(),this.queue[0]&&(this.queue[0].setTimeoutHandle=setTimeout(this.process,this.queue[0].interval)),t.whenDone(!1)):t.setTimeoutHandle=setTimeout(this.process,t.interval)}}cancelAll(){let e=this.queue;this.queue=[];for(let t of e)t.whenDone(!0),t.setTimeoutHandle&&clearTimeout(t.setTimeoutHandle)}cancelCurrent(){let e=this.queue[0];e&&(this.queue.shift(),e.whenDone(!0),e.setTimeoutHandle&&clearTimeout(e.setTimeoutHandle))}enqueue(e){e.whenDone||(e.whenDone=()=>{}),this.queue.push(e),1==this.queue.length&&this.process()}executeAsync(t){return e.U.assert(!t.whenDone),new Promise((e,n)=>{t.whenDone=e,this.enqueue(t)})}},function(t){let n,i,r,s,o=0,a=!1;const l=[];let c,u=[];function d(){return n||(n=function(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(e){}return}(),n&&(c=n.createGain(),c.connect(n.destination),c.gain.setValueAtTime(1,0))),n}function p(){E(0),o=0,s&&s.pause()}function h(e,t){e.gain.value&&e.gain.setTargetAtTime(0,d().currentTime,.015),setTimeout(()=>{e.disconnect(),t&&t.disconnect()},450)}t.isAudioElementActive=function(){return!!r},t.mute=function(e){a=e;const t=d();e?c.gain.setTargetAtTime(0,t.currentTime,.015):c.gain.setTargetAtTime(1,t.currentTime,.015),!e&&t&&"suspended"===t.state&&t.resume()},t.isMuted=function(){return a},t.stopAll=function(){p(),k();for(const e of u)e()},t.stop=function(){p(),function(){if(r){try{h(r,i)}catch(e){}r=void 0,i=void 0}}()},t.onStopAll=function(e){u.push(e)},t.frequency=function(){return o};const f=[null,"triangle","sawtooth","sine"];let m,g,_=[],y=[];function b(e,t){let n,i=f[e];if(i){let e=d().createOscillator();return e.type=i,e.frequency.value=t,e}if(4==e)n=function(){if(!g){const e=131072;g=d().createBuffer(1,e,d().sampleRate);const t=g.getChannelData(0);let n=251771520;for(let i=0;i<e;i+=4)n^=n<<13,n^=n>>17,n^=n<<5,32768&n?(t[i]=1,t[i+1]=1,t[i+2]=-1,t[i+3]=-1):(t[i]=0,t[i+1]=0,t[i+2]=0,t[i+3]=0)}return g}();else if(5==e)n=function(){if(!m){const e=1e5;m=d().createBuffer(1,e,d().sampleRate);const t=m.getChannelData(0);let n=251771520;for(let i=0;i<e;i++)n^=n<<13,n^=n>>17,n^=n<<5,t[i]=(1023&n)/512-1}return m}();else if(11<=e&&e<=15)n=function(e){if(!y[e]){const t=1024,n=d().createBuffer(1,t,d().sampleRate),i=n.getChannelData(0);for(let n=0;n<t;n++)i[n]=n<e/100*t?1:-1;y[e]=n}return y[e]}(10*(e-10));else{if(!(16<=e&&e<=18))return null;n=function(e){if(!_[e]){const t=1024,n=d().createBuffer(1,t,d().sampleRate),i=n.getChannelData(0),r=[770763591,3356908179],s=[15,31,63];for(let n=0;n<t;n+=4){let t,o=n/4;o&=s[e-4],t=!!(r[o>>5]&1<<(31&o)),t?(i[n]=1,i[n+1]=1,i[n+2]=-1,i[n+3]=-1):(i[n]=0,i[n+1]=0,i[n+2]=0,i[n+3]=0)}_[e]=n}return _[e]}(e-16+4)}let r=d().createBufferSource();r.buffer=n,r.loop=!0;return 4==e||16<=e&&e<=18?r.playbackRate.value=t/(d().sampleRate/4):5!=e&&(r.playbackRate.value=t/(d().sampleRate/1024)),r}class v{constructor(){this.gain=d().createGain(),this.gain.connect(c),this.gain.gain.value=0}disconnectNodes(){this.gain?h(this.gain,this.generator):this.generator&&(this.generator.stop&&this.generator.stop(),this.generator.disconnect()),this.gain=null,this.generator=null}remove(){const e=l.indexOf(this);e>=0&&l.splice(e,1),this.disconnectNodes()}}let T=1;function k(){for(null===t.soundEventCallback||void 0===t.soundEventCallback||t.soundEventCallback("muteallchannels"),T++;l.length;)l[0].remove()}function x(e,t){if(e<0)return;o=e;let n=d();if(n){t=Math.max(0,Math.min(1,t));try{i||(i=n.createOscillator(),r=n.createGain(),r.gain.value=0,i.type="triangle",i.connect(r),r.connect(c),i.start(0)),E(t)}catch(e){return i=void 0,void(r=void 0)}i.frequency.value=e,E(t)}}function E(e){(null==r?void 0:r.gain)&&r.gain.setTargetAtTime(e,n.currentTime,.015)}t.muteAllChannels=k,t.queuePlayInstructions=function(t,n){const i=T;e.U.delay(t).then(()=>i!=T?Promise.resolve():S(n.data))},t.tone=x,t.setCurrentToneGain=E,t.playBufferAsync=function(e){return e?new Promise(t=>{function n(){t&&t(),t=void 0}const i="data:audio/wav;base64,"+window.btoa(function(e){let t=e.length,n="";for(let i=0;i<t;++i)n+=String.fromCharCode(e[i]);return n}(e.data));s=new Audio(i),a&&(s.volume=0),s.onended=()=>n(),s.onpause=()=>n(),s.onerror=()=>n(),s.play()}):Promise.resolve()};function S(n,i,r){return new Promise(async s=>{null===t.soundEventCallback||void 0===t.soundEventCallback||t.soundEventCallback("playinstructions",n);let o=!1,a=d(),l=w();l.gain.gain.value=1;const c={},u={};let p=a.currentTime,h=p,f=0,m=0;const g=(e,t)=>e/1024/4*(t?.5:1),_=()=>{if(!o){o=!0,l.disconnectNodes();for(const e of Object.keys(c))c[e].stop(),c[e].disconnect(),u[e].disconnect();s()}};for(let e=0;e<n.length;e+=12){const t=n[e],i=C(n,e+2),r=C(n,e+4)/1e3,s=C(n,e+6),o=C(n,e+8),d=C(n,e+10);if(m+=r,0===t){h+=r;continue}const p=11<=t&&t<=15;c[t]||(c[t]=b(t,i),u[t]=a.createGain(),u[t].gain.value=0,u[t].connect(l.gain),c[t].connect(u[t]),c[t].start()),f&&t!==f&&u[f].gain.setTargetAtTime(0,h,.015);const _=c[t],y=u[t];if(_ instanceof OscillatorNode)_.frequency.setValueAtTime(i,h),_.frequency.linearRampToValueAtTime(d,h+r);else{4==t||16<=t&&t<=18?_.playbackRate.linearRampToValueAtTime(d/(a.sampleRate/4),h+r):5!=t&&_.playbackRate.linearRampToValueAtTime(d/(a.sampleRate/1024),h+r)}y.gain.setValueAtTime(g(s,p),h),y.gain.linearRampToValueAtTime(g(o,p),h+r),f=t,h+=r}if(l.gain.gain.setTargetAtTime(0,h,.015),i||r){const e=()=>{const t=a.currentTime;if(t>p+m)return;if(i&&i())return void _();const{frequency:s,volume:o}=function(e,t){let n=0;for(let i=0;i<t.length;i+=12){const r=C(t,i+2),s=C(t,i+4),o=C(t,i+6),a=C(t,i+8),l=C(t,i+10);if(n+s<e){n+=s;continue}const c=(e-n)/s;return{frequency:r+(l-r)*c,volume:o+(a-o)*c}}return{frequency:-1,volume:-1}}(1e3*(t-p),n);r&&r(s,o/1024),requestAnimationFrame(e)};requestAnimationFrame(e)}await e.U.delay(1e3*m),_()})}function C(e,t){const n=new Uint8Array(2);return n[0]=e[t],n[1]=e[t+1],new Uint16Array(n.buffer)[0]}function w(){l.length>20&&l[0].remove();const e=new v;return l.push(e),e}t.playPCMBufferStreamAsync=function(e,t,n=.3,i){return new Promise(r=>{let s=[],o=d().currentTime,a=!1;const l=w();l.gain.gain.setValueAtTime(n,d().currentTime);const c=()=>!!(i&&i()||!l.gain)&&(r&&r(),r=void 0,l.remove(),!0);function u(){for(;!a&&s.length<3&&!c();){const t=e();if(!t||!t.length){a=!0;break}p(t)}a&&0===s.length&&(l.remove(),r&&r(),r=void 0)}function p(e){if(c())return;const n=d().createBuffer(1,e.length,t);if(n.copyToChannel)n.copyToChannel(e,0);else{const t=n.getChannelData(0);for(let n=0;n<e.length;n++)t[n]=e[n]}const i=d().createBufferSource();s.push(i),i.connect(l.gain),i.buffer=n,i.addEventListener("ended",()=>{s.shift().disconnect(),u()}),i.start(o),o+=n.duration}u()})},t.playInstructionsAsync=S,t.sendMidiMessage=function(e){const t=e.data;if(!t.length)return;const n=t[0]>>4,i=15&t[0],r=t[1]||0,s=(o=r,440*Math.pow(2,(o-69)/12));var o;const a=t[2]||0;8==n||9==n&&0==a?p():9==n&&(x(s,1),9==i&&setTimeout(()=>p(),500))},t.startSamplePlayback=function(t,n,i,r,s){let o,a;return{promise:new Promise(l=>{a=l;let c=1;r<3e3?(c=r/3e3,r=3e3):r>768e3&&(c=r/768e3,r=768e3);const u=e.BufferMethods.fmtInfo(n).size,p=d().createBuffer(1,t.data.length/u,r),h=p.getChannelData(0);for(let r=0;r<p.length;r++)h[r]=e.BufferMethods.getNumber(t,n,r*u)/i*2-1;o=w();const f=d().createBufferSource();f.playbackRate.value=c,o.gain.gain.value=s,o.generator=f,o.generator.buffer=p,o.generator.connect(o.gain),o.generator.start(0),o.generator.addEventListener("ended",()=>{o.remove(),o=void 0,l()})}),cancel:()=>{o&&(o.remove(),o=void 0,a())}}},t.createAudioSourceNode=function(e,t,n){const i=new Audio(e),r=d().createMediaElementSource(i),s=d().createWaveShaper();s.curve=function(e){const t=44100,n=new Float32Array(t);e=Math.max(.01,Math.min(1,e));const i=1/e;for(let e=0;e<t;e++){const r=(2*e/t-1)*i;n[e]=Math.max(-1,Math.min(1,r))}return n}(t),s.oversample="4x";const o=w();return o.generator=s,o.generator.connect(o.gain),r.connect(s),o.gain.gain.value=.1*n,i}}(t=e.AudioContextManager||(e.AudioContextManager={})),e.isTouchEnabled=n,e.hasPointerEvents=i,e.pointerEvents=i()?{up:"pointerup",down:["pointerdown"],move:"pointermove",enter:"pointerenter",leave:"pointerleave"}:n()?{up:"mouseup",down:["mousedown","touchstart"],move:"touchmove",enter:"touchenter",leave:"touchend"}:{up:"mouseup",down:["mousedown"],move:"mousemove",enter:"mouseenter",leave:"mouseleave"}}(pxsim||(pxsim={})),function(e){!function(t){function n(e,t){return n=>n*(t/e)}function i(e,t){let n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}t.translateEl=function(t,n){e.svg.hydrate(t,{transform:`translate(${n[0]} ${n[1]})`})},t.composeSVG=function(t){let[n,i]=[t.el1,t.el2];e.U.assert(0==n.x&&0==n.y&&0==i.x&&0==i.y,"el1 and el2 x,y offsets not supported");let r=(t,n,i)=>e.svg.hydrate(t,{x:n,y:i}),s=(t,n,i)=>e.svg.hydrate(t,{width:`${n}px`,height:`${i}px`}),o=t.scaleUnit2,a=t.scaleUnit2/t.scaleUnit1,l=n.w*a,c=n.h*a;s(n.el,l,c);let u=1*i.w,d=1*i.h;s(i.el,u,d);let[p,h,f,m]=t.margin,g=t.middleMargin,_=Math.max(l,u),y=h+(_-l)/2,b=p;r(n.el,y,b);let v=h+(_-u)/2,T=b+c+g;r(i.el,v,T);let k=[b,b+c,T,T+d],x=h+_+m,E=p+c+g+d+f,S=e.svg.elt("svg",{version:"1.0",viewBox:`0 0 ${x} ${E}`,class:"sim-bb"});((t,n,i)=>{n&&e.svg.hydrate(t,{width:n}),i&&e.svg.hydrate(t,{height:i})})(S,t.maxWidth,t.maxHeight),r(S,0,0);let C=e.svg.child(S,"g");return S.appendChild(n.el),S.appendChild(i.el),{under:C,over:e.svg.child(S,"g"),host:S,edges:k,scaleUnit:o,toHostCoord1:e=>{let[t,n]=e;return[t*a+y,n*a+b]},toHostCoord2:e=>{let[t,n]=e;return[1*t+v,1*n+T]}}},t.mkScaleFn=n,t.mkImageSVG=function(t){let i=n(t.imageUnitDist,t.targetUnitDist),r=i(t.width),s=i(t.height),o=e.svg.elt("image",{width:r,height:s});return o.setAttributeNS("http://www.w3.org/1999/xlink","href",`${t.image}`),{el:o,w:r,h:s,x:0,y:0}},t.findDistSqrd=i,t.findClosestCoordIdx=function(e,t){return t.map(t=>i(e,t)).reduce((e,t,n,i)=>t<i[e]?n:e,0)},t.mkTxt=function(t,n,i,r,s,o,a){let l=e.svg.elt("text");a=a||.3;const c=(o=o||-.33333)*i*s.length,u=a*i;return e.svg.hydrate(l,{style:`font-size:${i}px;`,transform:`translate(${t} ${n}) rotate(${r}) translate(${c} ${u})`}),e.U.addClass(l,"noselect"),l.textContent=s,l},t.GPIO_WIRE_COLORS=["pink","orange","yellow","green","purple"],t.WIRE_COLOR_MAP={black:"#514f4d",white:"#fcfdfc",gray:"#acabab",purple:"#a772a1",blue:"#01a6e8",green:"#3cce73",yellow:"#ece600",orange:"#fdb262",red:"#f44f43",brown:"#c89764",pink:"#ff80fa"},t.mapWireColor=function(e){return t.WIRE_COLOR_MAP[e]||e},t.PIN_DIST=15,t.rgbToHsl=function(e){let t,n,i,[r,s,o]=e,[a,l,c]=[r/255,s/255,o/255],u=Math.min(a,l,c),d=Math.max(a,l,c),p=d-u,h=d+u;return i=h/2*100,0===p?n=t=0:(d===a?t=(l-c)/p%6*60:d===l?t=60*((c-a)/p+2):d===c&&(t=60*((a-l)/p+4)),n=i>50?p/(2-h)*100:p/h*100),[Math.floor(t),Math.floor(n),Math.floor(i)]}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){var t;!function(n){function i(e,n,i){let r={class:e,d:n};i&&(r.title=i);let s=t.elt("path");return t.hydrate(s,r),s}function r(e,n=!1){let i=t.elt("linearGradient");t.hydrate(i,{id:e,x1:"0%",y1:"0%",x2:n?"100%":"0%",y2:n?"0%":"100%"});t.child(i,"stop",{offset:"0%"}),t.child(i,"stop",{offset:"100%"}),t.child(i,"stop",{offset:"100%"}),t.child(i,"stop",{offset:"100%"});return i}function s(e){let n=t.elt("title");return n.textContent=e,n}n.parseString=function(e){return(new DOMParser).parseFromString(e,"image/svg+xml").getElementsByTagName("svg").item(0)},n.toDataUri=function(e){return"data:image/svg+xml,"+encodeURI(e)},n.cursorPoint=function(e,t,n){return e.x=null!=n.clientX?n.clientX:n.pageX,e.y=null!=n.clientY?n.clientY:n.pageY,e.matrixTransform(t.getScreenCTM().inverse())},n.rotateElement=function(e,t,n,i){e.setAttribute("transform",`translate(${t},${n}) rotate(${i+90}) translate(${-t},${-n})`)},n.hydrate=function(e,n){for(let i in n)"title"==i?t.title(e,n[i]):e.setAttributeNS(null,i,n[i])},n.elt=function(e,n){let i=document.createElementNS("http://www.w3.org/2000/svg",e);return n&&t.hydrate(i,n),i},n.child=function(e,n,i){let r=t.elt(n,i);return e.appendChild(r),r},n.mkPath=i,n.path=function(e,t,n,r){let s=i(t,n,r);return e.appendChild(s),s},n.fill=function(e,t){e.style.fill=t},n.filter=function(e,t){e.style.filter=t},n.fills=function(e,t){e.forEach(e=>e.style.fill=t)},n.isTouchEnabled=function(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)},n.onClick=function(t,n){let i=!1;e.pointerEvents.down.forEach(e=>t.addEventListener(e,e=>(i=!0,!0),!1)),t.addEventListener(e.pointerEvents.up,e=>!i||(i=!1,n(e),e.preventDefault(),!1),!1)},n.buttonEvents=function(t,n,i,r,s){let o=!1;e.pointerEvents.down.forEach(e=>t.addEventListener(e,e=>(o=!0,i&&i(e),!0),!1)),t.addEventListener(e.pointerEvents.move,e=>!o||(n&&n(e),e.preventDefault(),!1),!1),t.addEventListener(e.pointerEvents.up,e=>{o=!1,r&&r(e)},!1),t.addEventListener(e.pointerEvents.leave,e=>{o=!1,r&&r(e)},!1),t.addEventListener("keydown",e=>{o=!1,s&&s(e)})},n.mkLinearGradient=r,n.linearGradient=function(e,t,n=!1){let i=r(t,n);return e.appendChild(i),i},n.setGradientColors=function(e,t,n){e&&(e.childNodes[0].style.stopColor=t,e.childNodes[1].style.stopColor=t,e.childNodes[2].style.stopColor=n,e.childNodes[3].style.stopColor=n)},n.setGradientValue=function(e,t){e.childNodes[1].getAttribute("offset")!=t&&(e.childNodes[1].setAttribute("offset",t),e.childNodes[2].setAttribute("offset",t))},n.animate=function(t,n){e.U.addClass(t,n);let i=t.parentElement;i&&(i.removeChild(t),i.appendChild(t))},n.mkTitle=s,n.title=function(e,t){let n=s(t);return e.appendChild(n),n},n.toHtmlColor=function(e){return`rgba(${e>>16&255}, ${e>>8&255}, ${255&e}, ${e>>24&1})`}}(t=e.svg||(e.svg={}))}(pxsim||(pxsim={})),function(e){!function(e){e.Metronome=class{constructor(){this.tickListeners=[],this.onTick=()=>{for(const e of this.tickListeners)e()}}initAsync(){return this.metronomeLoadPromise?this.metronomeLoadPromise:this.metronomeWorker?this.metronomeWorker:(this.metronomeLoadPromise=new Promise(e=>{this.metronomeWorker=new Worker("data:application/javascript,"+encodeURIComponent(t));const n=t=>{"ready"===t.data&&(e(this.metronomeWorker),this.metronomeWorker.removeEventListener("message",n),this.metronomeWorker.addEventListener("message",this.onTick))};this.metronomeWorker.addEventListener("message",n)}),this.metronomeLoadPromise)}stop(){this.postMessage({type:"stop"})}setInterval(e){this.currentInterval=e,this.postMessage({type:"set-interval",interval:e})}start(e){this.currentInterval=e,this.postMessage({type:"start",interval:e})}addTickListener(e){this.tickListeners.push(e)}removeTickListener(e){this.tickListeners=this.tickListeners.filter(t=>t!==e)}interval(){return this.currentInterval}dispose(){if(this.metronomeWorker)this.metronomeWorker.terminate(),this.metronomeWorker=void 0,this.metronomeLoadPromise=void 0,this.tickListeners=[],this.interval=void 0;else if(this.metronomeLoadPromise)return void this.metronomeLoadPromise.then(()=>this.dispose())}postMessage(e){if(!this.metronomeWorker)throw new Error("initAsync not called on metronome");this.metronomeWorker.postMessage(e)}};const t='\n/**\n * Adpated from https://github.com/cwilso/metronome/\n */\n\nlet timerRef;\nlet interval;\n\naddEventListener("message", ev => {\n    const message = ev.data;\n\n    if (message.type === "start") {\n        updateInterval(message.interval, true);\n    }\n    else if (message.type === "stop") {\n        clearInterval(timerRef);\n        timerRef = undefined;\n    }\n    else if (message.type === "set-interval") {\n        updateInterval(message.interval, false);\n    }\n})\n\npostMessage("ready");\n\nfunction updateInterval(interval, startIfStopped) {\n    if (timerRef) {\n        clearInterval(timerRef);\n        startIfStopped = true;\n    }\n    interval = interval;\n\n    if (startIfStopped) {\n        timerRef = setInterval(() => postMessage("tick"), interval);\n    }\n}\n'}(e.music||(e.music={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(e){e.chromaticInterval=[1,1.0417,1.125,1.2,1.25,1.3333,1.4063,1.5,1.6,1.6667,1.8,1.875],e.majorScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[5],e.chromaticInterval[7],e.chromaticInterval[9],e.chromaticInterval[11]],e.minorScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[3],e.chromaticInterval[5],e.chromaticInterval[7],e.chromaticInterval[8],e.chromaticInterval[10]],e.pentatonicScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[7],e.chromaticInterval[9]],e.majorTriadInterval=[e.chromaticInterval[0],e.chromaticInterval[4],e.chromaticInterval[7]],e.minorTriadInterval=[e.chromaticInterval[0],e.chromaticInterval[3],e.chromaticInterval[7]],e.diminishedInterval=[e.chromaticInterval[0],e.chromaticInterval[3],e.chromaticInterval[6],e.chromaticInterval[9]],e.wholeToneInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[6],e.chromaticInterval[8],e.chromaticInterval[10]]}(e.MusicalIntervals||(e.MusicalIntervals={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(t){t.chromatic={interval:e.MusicalIntervals.chromaticInterval,length:12},t.majorScale={interval:e.MusicalIntervals.majorScaleInterval,length:7},t.minorScale={interval:e.MusicalIntervals.minorScaleInterval,length:7},t.pentatonicScale={interval:e.MusicalIntervals.pentatonicScaleInterval,length:5},t.majorTriad={interval:e.MusicalIntervals.majorTriadInterval,length:3},t.minorTriad={interval:e.MusicalIntervals.minorTriadInterval,length:3},t.diminished={interval:e.MusicalIntervals.diminishedInterval,length:4},t.wholeTone={interval:e.MusicalIntervals.wholeToneInterval,length:6},t.calculateFrequencyFromProgression=function(e,t,n){let i=Math.floor(n/t.length),r=n%t.length;return e*Math.pow(2,i)*t.interval[r]}}(e.MusicalProgressions||(e.MusicalProgressions={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(t){const n=[31,33,35,37,39,41,44,46,49,52,55,58,62,65,69,73,78,82,87,92,98,104,110,117,123,131,139,147,156,165,175,185,196,208,220,233,247,262,277,294,311,330,349,370,392,415,440,466,494,523,554,587,622,659,698,740,784,831,880,932,988,1047,1109,1175,1245,1319,1397,1480,1568,1661,1760,1865,1976,2093,2217,2349,2489,2637,2794,2960,3136,3322,3520,3729,3951,4186,4435,4699,4978,5274,5588,5920,6272,6645,7040,7459,7902];async function i(t,i,r,s,o=100){await e.AudioContextManager.playInstructionsAsync(e.music.renderInstrument(i,n[t],r,o),s)}async function r(t,n,i=100){await e.AudioContextManager.playInstructionsAsync(e.music.renderDrumInstrument(t,i),n)}function s(e,t,n){return 6e4/e/t*n}t.Sequencer=class{constructor(){this._currentTick=0,this._state="stop",this.listeners={},this.globalVolume=1024,this.trackVolumes=[],this.drumTrackVolumes=[],this.currentCancelToken={cancelled:!1},this.onTick=()=>{const e=this.currentCancelToken;for(let t=0;t<this.currentlyPlaying.tracks.length;t++){const n=this.currentlyPlaying.tracks[t];for(const o of n.notes)if(o.startTick===this._currentTick)for(const a of o.notes)n.drums?r(n.drums[a.note],()=>e.cancelled,this.getDrumTrackVolume(t,a.note)):i(a.note,n.instrument,s(this.currentlyPlaying.beatsPerMinute,this.currentlyPlaying.ticksPerBeat,o.endTick-o.startTick),()=>e.cancelled,this.getMelodicTrackVolume(t));else if(o.startTick>this._currentTick)break}this.fireEvent("tick"),this._currentTick++,this._currentTick>=this.maxTick()&&("loop"===this._state?(this._currentTick=0,this.fireEvent("looped")):this.stop(!0))}}async initAsync(){this.metronome?await this.metronome.initAsync():(this.metronome=new t.Metronome,await this.metronome.initAsync(),this.metronome.addTickListener(this.onTick))}dispose(){this.metronome&&this.metronome.dispose(),this.metronome=void 0,this.stop(),this.currentlyPlaying=void 0,this.listeners={}}state(){return this._state}currentTick(){return this._currentTick}currentTime(){return s(this.currentlyPlaying.beatsPerMinute,this.currentlyPlaying.ticksPerBeat,this.currentTick())}maxTick(){return this.currentlyPlaying?this.currentlyPlaying.measures*this.currentlyPlaying.beatsPerMeasure*this.currentlyPlaying.ticksPerBeat:0}duration(){return s(this.currentlyPlaying.beatsPerMinute,this.currentlyPlaying.ticksPerBeat,this.maxTick())}start(e,t){this.startFrom(e,t,0)}startFrom(e,t,n){"stop"!==this._state&&this.stop(),void 0!==t&&(this.shouldLoop=t),this._currentTick=null!=n?n:0,this.currentlyPlaying=e,this.metronome.start(s(e.beatsPerMinute,e.ticksPerBeat,1)),this._state=this.shouldLoop?"loop":"play",this.fireStateChange()}stop(e=!1){"stop"!==this._state&&(this._state="stop",this.metronome&&this.metronome.stop(),this.fireStateChange(),e||(this.currentCancelToken.cancelled=!0),this.currentCancelToken={cancelled:!1})}updateSong(e){this.currentlyPlaying=e,"stop"!==this._state&&this.metronome.setInterval(s(e.beatsPerMinute,e.ticksPerBeat,1))}setLooping(e){e&&"play"===this._state?(this._state="loop",this.fireStateChange()):e||"loop"!==this._state||(this._state="play",this.fireStateChange()),this.shouldLoop=e}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}setVolume(e){this.globalVolume=Math.min(Math.max(e,0),1024)}setTrackVolume(e,t){for(t=Math.min(Math.max(t,0),1024);this.trackVolumes.length<e;)this.trackVolumes.push(1024);this.trackVolumes[e]=t}setDrumTrackVolume(e,t,n){for(n=Math.min(Math.max(n,0),1024);this.drumTrackVolumes.length<e;)this.drumTrackVolumes.push([]);for(;this.drumTrackVolumes[e].length<t;)this.drumTrackVolumes[e].push(1024);this.drumTrackVolumes[e][t]=n}getMelodicTrackVolume(e){let t=1024;return e<this.trackVolumes.length&&(t=this.trackVolumes[e]),this.globalVolume*(t/1024)}getDrumTrackVolume(e,t){const n=this.getMelodicTrackVolume(e);let i=1024;return e<this.drumTrackVolumes.length&&t<this.drumTrackVolumes[e].length&&(i=this.drumTrackVolumes[e][t]),n*(i/1024)}fireStateChange(){this.fireEvent(this._state),this.fireEvent("state-change")}fireEvent(e){if(this.listeners[e])for(const t of this.listeners[e])t()}},t.playNoteAsync=i,t.playDrumAsync=r,t.tickToMs=s}(e.music||(e.music={}))}(pxsim||(pxsim={})),function(e){!function(e){function t(e,t,n,s){var o,a;let l=0;return(null===(o=e.pitchEnvelope)||void 0===o?void 0:o.amplitude)&&(l+=i(e.pitchEnvelope,s,n)),(null===(a=e.pitchLFO)||void 0===a?void 0:a.amplitude)&&(l+=r(e.pitchLFO,s)),Math.max(t+l,0)}function n(e,t,n,s){var o;let a=0;return e.ampEnvelope.amplitude&&(a+=i(e.ampEnvelope,n,t)),(null===(o=e.ampLFO)||void 0===o?void 0:o.amplitude)&&(a+=r(e.ampLFO,n)),Math.max(Math.min(a,e.ampEnvelope.amplitude),0)/1024*s|0}function i(e,t,n){const i=e.sustain/1024*e.amplitude;if(t>n){if(t-n>e.release)return 0;if(t<e.attack){const i=e.amplitude/e.attack*n;return i-i/e.release*(t-n)}if(t<e.attack+e.decay){const r=e.amplitude-(e.amplitude-i)/e.decay*(n-e.attack);return r-r/e.release*(t-n)}return i-i/e.release*(t-n)}return t<e.attack?e.amplitude/e.attack*t:t<e.attack+e.decay?e.amplitude-(e.amplitude-i)/e.decay*(t-e.attack):i}function r(e,t){return Math.cos(t/1e3*e.frequency*2*Math.PI)*e.amplitude}function s(e,t,n,i,r,s,a,l){return n>0&&(e[t]=s,e[t+1]=0,o(e,t+2,a),o(e,t+4,n),o(e,t+6,255*i>>6),o(e,t+8,255*r>>6),o(e,t+10,l),t+=12),e[t]=0,t}function o(e,t,n){const i=new Uint8Array(2);new Uint16Array(i.buffer)[0]=0|n,e[t]=i[0],e[t+1]=i[1]}function a(e,t){const n=new Uint8Array(2);return n[0]=e[t],n[1]=e[t+1],new Uint16Array(n.buffer)[0]}function l(e,t){return{waveform:e[t],ampEnvelope:{attack:a(e,t+1),decay:a(e,t+3),sustain:a(e,t+5),release:a(e,t+7),amplitude:a(e,t+9)},pitchEnvelope:{attack:a(e,t+11),decay:a(e,t+13),sustain:a(e,t+15),release:a(e,t+17),amplitude:a(e,t+19)},ampLFO:{frequency:e[t+21],amplitude:a(e,22)},pitchLFO:{frequency:e[t+24],amplitude:a(e,25)},octave:e[t+27]}}function c(e,t){return e[t+1]?function(e,t){const n={id:e[t],instrument:{ampEnvelope:{attack:0,decay:0,sustain:0,release:0,amplitude:0},waveform:0},notes:[],drums:[]},i=a(e,t+2);let r=t+4;for(;r<t+4+i;)n.drums.push(u(e,r)),r+=5+7*n.drums[n.drums.length-1].steps.length;const s=a(e,r);r+=2;for(;r<t+4+i+s;)n.notes.push(d(e,r,0,!0)),r+=5+n.notes[n.notes.length-1].notes.length;return[n,r]}(e,t):function(e,t){const n={id:e[t],instrument:l(e,t+4),notes:[]},i=t+4+a(e,t+2),r=a(e,i);let s=i+2;for(;s<i+2+r;)n.notes.push(d(e,s,n.instrument.octave,!1)),s+=5+n.notes[n.notes.length-1].notes.length;return[n,s]}(e,t)}function u(e,t){const n={startFrequency:a(e,t+1),startVolume:a(e,t+3),steps:[]};for(let i=0;i<e[t];i++){const r=t+5+7*i;n.steps.push({waveform:e[r],frequency:a(e,r+1),volume:a(e,r+3),duration:a(e,r+5)})}return n}function d(e,t,n,i){const r={startTick:a(e,t),endTick:a(e,t+2),notes:[]};for(let s=0;s<e[t+4];s++)r.notes.push(p(e[t+5+s],n,i));return r}function p(e,t,n){const i=e>>6,r={note:n?e:(63&e)+12*(t-2),enharmonicSpelling:"normal"};return 1===i?r.enharmonicSpelling="flat":2===i&&(r.enharmonicSpelling="sharp"),r}e.renderInstrument=function(e,i,r,o){var a,l,c,u,d;const p=r+e.ampEnvelope.release,h=(null===(a=e.ampLFO)||void 0===a?void 0:a.amplitude)?Math.max(500/e.ampLFO.frequency,50):50,f=(null===(l=e.pitchLFO)||void 0===l?void 0:l.amplitude)?Math.max(500/e.pitchLFO.frequency,50):50;let m=[0],g=e.ampEnvelope.attack,_=(null===(c=e.pitchEnvelope)||void 0===c?void 0:c.amplitude)?e.pitchEnvelope.attack:p,y=(null===(u=e.pitchLFO)||void 0===u?void 0:u.amplitude)?f:p,b=(null===(d=e.ampLFO)||void 0===d?void 0:d.amplitude)?h:p,v=0;for(;v<p&&(g<=_&&g<=y&&g<=b?(v=g,m.push(g),g=v<e.ampEnvelope.attack+e.ampEnvelope.decay&&e.ampEnvelope.attack+e.ampEnvelope.decay<r?e.ampEnvelope.attack+e.ampEnvelope.decay:v<r?r:p):_<=y&&_<=b&&_<p?(v=_,m.push(_),_=v<e.pitchEnvelope.attack+e.pitchEnvelope.decay&&e.pitchEnvelope.attack+e.pitchEnvelope.decay<r?e.pitchEnvelope.attack+e.pitchEnvelope.decay:v<r?r:v<r+e.pitchEnvelope.release?Math.min(p,r+e.pitchEnvelope.release):p):y<=b&&y<p?(v=y,m.push(y),y+=f):b<p&&(v=b,m.push(b),b+=h),!(v>=p));){for(g<=v&&(g=v<e.ampEnvelope.attack+e.ampEnvelope.decay&&e.ampEnvelope.attack+e.ampEnvelope.decay<r?e.ampEnvelope.attack+e.ampEnvelope.decay:v<r?r:p),_<=v&&(_=v<e.pitchEnvelope.attack+e.pitchEnvelope.decay&&e.pitchEnvelope.attack+e.pitchEnvelope.decay<r?e.pitchEnvelope.attack+e.pitchEnvelope.decay:v<r?r:v<r+e.pitchEnvelope.release?Math.min(p,r+e.pitchEnvelope.release):p);b<=v;)b+=h;for(;y<=v;)y+=f}let T,k,x=0|n(e,r,0,o),E=0|t(e,i,r,0),S=0;const C=new Uint8Array(12*(m.length+1));for(let a=1;a<m.length;a++)m[a]-S<5||(T=0|n(e,r,m[a],o),k=0|t(e,i,r,m[a]),s(C,12*(a-1),m[a]-S|0,x,T,e.waveform,E,k),x=T,E=k),S=m[a];return s(C,12*m.length,10,x,0,e.waveform,E,E),C},e.renderDrumInstrument=function(e,t){let n=e.startVolume,i=e.startFrequency;const r=e=>e/1024*t;let o=new Uint8Array(12*(e.steps.length+1));for(let t=0;t<e.steps.length;t++)s(o,12*t,e.steps[t].duration,r(n),r(e.steps[t].volume),e.steps[t].waveform,i,e.steps[t].frequency),n=e.steps[t].volume,i=e.steps[t].frequency;return s(o,12*e.steps.length,10,r(n),0,e.steps[e.steps.length-1].waveform,i,i),o},e.decodeSong=function(e){const t={beatsPerMinute:a(e,1),beatsPerMeasure:e[3],ticksPerBeat:e[4],measures:e[5],tracks:[]};let n=7;for(;n<e.length;){const[i,r]=c(e,n);n=r,t.tracks.push(i)}return t}}(e.music||(e.music={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){e.EMOJI_SYNTHESIZER_SAMPLE_RATE=44100,e.EMOJI_SYNTHESIZER_TONE_WIDTH_F=1024,e.EMOJI_SYNTHESIZER_TONE_WIDTH=1024,e.EMOJI_SYNTHESIZER_BUFFER_SIZE=512,e.EMOJI_SYNTHESIZER_TONE_EFFECT_PARAMETERS=2,e.EMOJI_SYNTHESIZER_TONE_EFFECTS=3,e.EMOJI_SYNTHESIZER_STATUS_ACTIVE=1,e.EMOJI_SYNTHESIZER_STATUS_OUTPUT_SILENCE_AS_EMPTY=2,e.EMOJI_SYNTHESIZER_STATUS_STOPPING=4;e.SoundEmojiSynthesizer=class{constructor(t,n=e.EMOJI_SYNTHESIZER_SAMPLE_RATE){this.samplesPerStep=[],this.status=0,this.effectPointer=0,this.position=0,this.bufferSize=e.EMOJI_SYNTHESIZER_BUFFER_SIZE,this.sampleRate=n,this.samplesToWrite=0,this.samplesWritten=0,this.sampleRange=1023,this.orMask=0,this.effectPointer=-1,this.volume=1}get effect(){return this.effectBuffer[this.effectPointer]}play(e){this.effectBuffer=e,this.effectPointer=-1,this.nextSoundEffect()}nextSoundEffect(){const t=null!=this.effect;if(this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING&&(this.effectPointer=null,this.effectBuffer=[]),this.effect?this.effectPointer++:this.effectPointer=0,this.effectPointer>=this.effectBuffer.length&&(this.effectPointer=0,this.effect.duration>=0))return this.effectPointer=-1,this.effectBuffer=[],this.samplesWritten=0,this.samplesToWrite=0,this.position=0,t;this.samplesToWrite=this.determineSampleCount(this.effect.duration),this.frequency=this.effect.frequency,this.volume=this.effect.volume,this.samplesWritten=0;for(let t=0;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)this.effect.effects[t].step=0,this.effect.effects[t].steps=Math.max(this.effect.effects[t].steps,1),this.samplesPerStep[t]=Math.floor(this.samplesToWrite/this.effect.effects[t].steps);return!1}pull(){let t,n,i=!1;for(;!i;){if(this.samplesWritten==this.samplesToWrite||this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING){let t=this.nextSoundEffect();(0==this.samplesToWrite||this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING)&&(i=!0,(t||this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING)&&(this.status&=~e.EMOJI_SYNTHESIZER_STATUS_STOPPING))}for(!(this.samplesWritten<this.samplesToWrite)&&this.status&e.EMOJI_SYNTHESIZER_STATUS_OUTPUT_SILENCE_AS_EMPTY||null!=t||(this.buffer=new Array(this.bufferSize),t=0,n=this.buffer.length);this.samplesWritten<this.samplesToWrite;){let i=e.EMOJI_SYNTHESIZER_TONE_WIDTH_F*this.frequency/this.sampleRate,r=this.sampleRange*this.volume/1024,s=512-512*r,o=[];for(let t=0;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)o[t]=this.samplesPerStep[t]*this.effect.effects[t].step,this.effect.effects[t].step==this.effect.effects[t].steps-1&&(o[t]=this.samplesToWrite);let a=o[0];for(let t=1;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)a=Math.min(a,o[t]);for(;this.samplesWritten<a;){if(t==n)return this.buffer;let o=this.effect.tone.tonePrint(this.effect.tone.parameter,Math.max(this.position,0));for(this.buffer[t]=o*r+s,t++,this.samplesWritten++,this.position+=i;this.position>e.EMOJI_SYNTHESIZER_TONE_WIDTH_F;)this.position-=e.EMOJI_SYNTHESIZER_TONE_WIDTH_F}for(let t=0;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)this.samplesWritten==o[t]&&this.effect.effects[t].step<this.effect.effects[t].steps&&(this.effect.effects[t].effect&&this.effect.effects[t].effect(this,this.effect.effects[t]),this.effect.effects[t].step++)}}if(null==t)this.buffer=[];else{const e=.5*this.sampleRange;for(;t<n;)this.buffer[t]=e,t++}return this.buffer}determineSampleCount(e){e<0&&(e=-e);const t=e/1e3;return Math.floor(this.sampleRate*t)}totalDuration(){let e=0;for(const t of this.effectBuffer)e+=t.duration;return e}}}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(e){const t=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,3,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,11,11,12,13,13,14,15,16,16,17,18,19,20,21,22,22,23,24,25,26,27,28,29,30,32,33,34,35,36,37,38,40,41,42,43,45,46,47,49,50,51,53,54,56,57,58,60,61,63,64,66,68,69,71,72,74,76,77,79,81,82,84,86,87,89,91,93,95,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,141,143,145,147,149,152,154,156,158,161,163,165,167,170,172,175,177,179,182,184,187,189,191,194,196,199,201,204,206,209,211,214,216,219,222,224,227,229,232,235,237,240,243,245,248,251,253,256,259,262,264,267,270,273,275,278,281,284,287,289,292,295,298,301,304,307,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384,387,390,393,396,399,402,405,408,411,414,417,420,424,427,430,433,436,439,442,445,448,452,455,458,461,464,467,470,473,477,480,483,486,489,492,495,498,502,505,508,511,514,517,520,524,527,530,533,536,539,542,545,549,552,555,558,561,564,567,570,574,577,580,583,586,589,592,595,598,602,605,608,611,614,617,620,623,626,629,632,635,638,641,644,647,650,653,656,659,662,665,668,671,674,677,680,683,686,689,692,695,698,701,704,707,710,713,715,718,721,724,727,730,733,735,738,741,744,747,749,752,755,758,760,763,766,769,771,774,777,779,782,785,787,790,793,795,798,800,803,806,808,811,813,816,818,821,823,826,828,831,833,835,838,840,843,845,847,850,852,855,857,859,861,864,866,868,870,873,875,877,879,881,884,886,888,890,892,894,896,898,900,902,904,906,908,910,912,914,916,918,920,922,924,926,927,929,931,933,935,936,938,940,941,943,945,946,948,950,951,953,954,956,958,959,961,962,964,965,966,968,969,971,972,973,975,976,977,979,980,981,982,984,985,986,987,988,989,990,992,993,994,995,996,997,998,999,1e3,1e3,1001,1002,1003,1004,1005,1006,1006,1007,1008,1009,1009,1010,1011,1011,1012,1013,1013,1014,1014,1015,1015,1016,1016,1017,1017,1018,1018,1019,1019,1019,1020,1020,1020,1021,1021,1021,1021,1022,1022,1022,1022,1022,1022,1022,1022,1022,1022,1023,1022];e.SineTone=function(e,n){let i=1024-(n|=0);return i<512&&(n=i),t[n]},e.SawtoothTone=function(e,t){return t},e.TriangleTone=function(e,t){return t<512?2*t:2*(1023-t)},e.NoiseTone=function(e,t){let n=e[0];return 0==n&&(n=7919),t*n&1023},e.SquareWaveTone=function(e,t){return t<512?1023:0}}(e.Synthesizer||(e.Synthesizer={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(t){t.noInterpolation=function(e,t){},t.linearInterpolation=function(e,t){let n=(t.parameter[0]-e.effect.frequency)/t.steps;e.frequency=e.effect.frequency+n*t.step},t.logarithmicInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.log10(Math.max(t.step,.1))*(t.parameter[0]-e.effect.frequency)/1.95},t.curveInterpolation=function(e,t){e.frequency=Math.sin(3.12159*t.step/180)*(t.parameter[0]-e.effect.frequency)+e.effect.frequency},t.slowVibratoInterpolation=function(e,t){e.frequency=Math.sin(t.step/10)*t.parameter[0]+e.effect.frequency},t.warbleInterpolation=function(e,t){e.frequency=Math.sin(t.step)*(t.parameter[0]-e.effect.frequency)+e.effect.frequency},t.vibratoInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.sin(t.step)*t.parameter[0]},t.exponentialRisingInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.sin(.01745329*t.step)*t.parameter[0]},t.exponentialFallingInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.cos(.01745329*t.step)*t.parameter[0]},t.appregrioAscending=function(t,n){t.frequency=e.MusicalProgressions.calculateFrequencyFromProgression(t.effect.frequency,n.parameter_p[0],n.step)},t.appregrioDescending=function(t,n){t.frequency=e.MusicalProgressions.calculateFrequencyFromProgression(t.effect.frequency,n.parameter_p[0],n.steps-n.step-1)},t.frequencyVibratoEffect=function(e,t){0!=t.step&&(t.step%2==0?e.frequency/=t.parameter[0]:e.frequency*=t.parameter[0])},t.volumeVibratoEffect=function(e,t){0!=t.step&&(t.step%2==0?e.volume/=t.parameter[0]:e.volume*=t.parameter[0])},t.adsrVolumeEffect=function(e,t){let n=.5*t.steps;if(t.step<=n){let i=(t.parameter[0]-e.effect.volume)/n;e.volume=e.effect.volume+t.step*i}else{let i=(t.parameter[1]-t.parameter[0])/n;e.volume=t.parameter[0]+(t.step-n)*i}},t.volumeRampEffect=function(e,t){let n=(t.parameter[0]-e.effect.volume)/t.steps;e.volume=e.effect.volume+t.step*n}}(e.SoundSynthesizerEffects||(e.SoundSynthesizerEffects={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(t){!function(t){let n,i,r;!function(e){e[e.Sine=0]="Sine",e[e.Sawtooth=1]="Sawtooth",e[e.Triangle=2]="Triangle",e[e.Square=3]="Square",e[e.Noise=4]="Noise"}(n=t.WaveShape||(t.WaveShape={})),function(e){e[e.None=0]="None",e[e.Linear=1]="Linear",e[e.Curve=2]="Curve",e[e.ExponentialRising=5]="ExponentialRising",e[e.ExponentialFalling=6]="ExponentialFalling",e[e.ArpeggioRisingMajor=8]="ArpeggioRisingMajor",e[e.ArpeggioRisingMinor=10]="ArpeggioRisingMinor",e[e.ArpeggioRisingDiminished=12]="ArpeggioRisingDiminished",e[e.ArpeggioRisingChromatic=14]="ArpeggioRisingChromatic",e[e.ArpeggioRisingWholeTone=16]="ArpeggioRisingWholeTone",e[e.ArpeggioFallingMajor=9]="ArpeggioFallingMajor",e[e.ArpeggioFallingMinor=11]="ArpeggioFallingMinor",e[e.ArpeggioFallingDiminished=13]="ArpeggioFallingDiminished",e[e.ArpeggioFallingChromatic=15]="ArpeggioFallingChromatic",e[e.ArpeggioFallingWholeTone=17]="ArpeggioFallingWholeTone",e[e.Logarithmic=18]="Logarithmic"}(i=t.InterpolationEffect||(t.InterpolationEffect={})),function(e){e[e.None=0]="None",e[e.Vibrato=1]="Vibrato",e[e.Tremolo=2]="Tremolo",e[e.Warble=3]="Warble"}(r=t.Effect||(t.Effect={}));class s{constructor(){this.src="000000000000000000000000000000000000000000000000000000000000000000000000"}get wave(){return this.getValue(0,1)}set wave(e){this.setValue(0,g(e,0,4),1)}get volume(){return this.getValue(1,4)}set volume(e){this.setValue(1,g(e,0,1023),4)}get frequency(){return this.getValue(5,4)}set frequency(e){this.setValue(5,e,4)}get duration(){return this.getValue(9,4)}set duration(e){this.setValue(9,e,4)}get shape(){return this.getValue(13,2)}set shape(e){this.setValue(13,e,2)}get endFrequency(){return this.getValue(18,4)}set endFrequency(e){this.setValue(18,e,4)}get endVolume(){return this.getValue(26,4)}set endVolume(e){this.setValue(26,g(e,0,1023),4)}get steps(){return this.getValue(30,4)}set steps(e){this.setValue(30,e,4)}get fx(){return this.getValue(34,2)}set fx(e){this.setValue(34,g(e,0,3),2)}get fxParam(){return this.getValue(36,4)}set fxParam(e){this.setValue(36,e,4)}get fxnSteps(){return this.getValue(40,4)}set fxnSteps(e){this.setValue(40,e,4)}get frequencyRandomness(){return this.getValue(44,4)}set frequencyRandomness(e){this.setValue(44,e,4)}get endFrequencyRandomness(){return this.getValue(48,4)}set endFrequencyRandomness(e){this.setValue(48,e,4)}get volumeRandomness(){return this.getValue(52,4)}set volumeRandomness(e){this.setValue(52,e,4)}get endVolumeRandomness(){return this.getValue(56,4)}set endVolumeRandomness(e){this.setValue(56,e,4)}get durationRandomness(){return this.getValue(60,4)}set durationRandomness(e){this.setValue(60,e,4)}get fxParamRandomness(){return this.getValue(64,4)}set fxParamRandomness(e){this.setValue(64,e,4)}get fxnStepsRandomness(){return this.getValue(68,4)}set fxnStepsRandomness(e){this.setValue(68,e,4)}copy(){const e=new s;return e.src=this.src.slice(0),e}setValue(e,t,n){t=g(0|t,0,Math.pow(10,n)-1),this.src=this.src.substr(0,e)+function(e,t){let n=e+"";for(;n.length<t;)n="0"+n;return n}(t,n)+this.src.substr(e+n)}getValue(e,t){return parseInt(this.src.substr(e,t))}}t.Sound=s;let o,a=!1,l={cancelled:!1};async function c(){if(o.length){a=!0;const e=o.shift();let t=l;try{e.onStarted(),await d(e.notes,()=>t.cancelled,void 0,e.volume),t.cancelled?e.onCancelled():e.onFinished()}catch(t){e.onCancelled()}c()}else a=!1}function u(){o=[],l.cancelled=!0,l={cancelled:!1}}function d(n,i,r,s=.03){const o=new t.SoundEmojiSynthesizer(0),a=function(e){const t=72,n=Math.floor((e.length+1)/(t+1)),i=n*(t+1)-1;if(e.length!=i)return[];const r=[];for(let i=0;i<n;++i){const n=i*t+i;if(n>0&&","!=e[n-1])return[];const s=m();if(!p(e.substr(n),s))return[];r.push(s)}return r}(n);o.play(a);let l=!1;return Promise.race([(c=o.totalDuration(),new Promise(e=>setTimeout(e,c))).then(()=>{l=!0}),e.AudioContextManager.playPCMBufferStreamAsync(()=>{if(!o.effect)return;const e=o.pull();r&&r(o.frequency,o.volume);const t=new Float32Array(e.length);for(let n=0;n<e.length;n++)t[n]=(e[n]-512)/512;return t},o.sampleRate,s,()=>l||i&&i())]);var c}function p(e,n){let i=parseInt(e.substr(0,1)),r=parseInt(e.substr(1,4)),s=parseInt(e.substr(5,4)),o=parseInt(e.substr(9,4)),a=parseInt(e.substr(13,2)),l=parseInt(e.substr(18,4)),c=parseInt(e.substr(26,4)),u=parseInt(e.substr(30,4)),d=parseInt(e.substr(34,2)),p=parseInt(e.substr(36,4)),m=parseInt(e.substr(40,4));if(s=f(s,parseInt(e.substr(44,4))),l=f(l,parseInt(e.substr(48,4))),r=f(r,parseInt(e.substr(52,4))),c=f(c,parseInt(e.substr(56,4))),o=f(o,parseInt(e.substr(60,4))),p=f(p,parseInt(e.substr(64,4))),m=f(m,parseInt(e.substr(68,4))),-1==s||-1==l||-1==r||-1==c||-1==o||-1==p||-1==m)return!1;switch(i){case 0:n.tone.tonePrint=t.Synthesizer.SineTone;break;case 1:n.tone.tonePrint=t.Synthesizer.SawtoothTone;break;case 2:n.tone.tonePrint=t.Synthesizer.TriangleTone;break;case 3:n.tone.tonePrint=t.Synthesizer.SquareWaveTone;break;case 4:n.tone.tonePrint=t.Synthesizer.NoiseTone}switch(n.frequency=s,n.duration=o,n.effects[0].steps=u,a){case 0:n.effects[0].effect=t.SoundSynthesizerEffects.noInterpolation;break;case 1:n.effects[0].effect=t.SoundSynthesizerEffects.linearInterpolation,n.effects[0].parameter[0]=l;break;case 2:n.effects[0].effect=t.SoundSynthesizerEffects.curveInterpolation,n.effects[0].parameter[0]=l;break;case 5:n.effects[0].effect=t.SoundSynthesizerEffects.exponentialRisingInterpolation,n.effects[0].parameter[0]=l;break;case 6:n.effects[0].effect=t.SoundSynthesizerEffects.exponentialFallingInterpolation,n.effects[0].parameter[0]=l;break;case 8:case 10:case 12:case 14:case 16:n.effects[0].effect=t.SoundSynthesizerEffects.appregrioAscending;break;case 9:case 11:case 13:case 15:case 17:n.effects[0].effect=t.SoundSynthesizerEffects.appregrioDescending;break;case 18:n.effects[0].effect=t.SoundSynthesizerEffects.logarithmicInterpolation,n.effects[0].parameter[0]=l}switch(a){case 8:case 9:n.effects[0].parameter_p[0]=t.MusicalProgressions.majorScale;break;case 10:case 11:n.effects[0].parameter_p[0]=t.MusicalProgressions.minorScale;break;case 12:case 13:n.effects[0].parameter_p[0]=t.MusicalProgressions.diminished;break;case 14:case 15:n.effects[0].parameter_p[0]=t.MusicalProgressions.chromatic;break;case 16:case 17:n.effects[0].parameter_p[0]=t.MusicalProgressions.wholeTone}let g=h(0,r,1023)/1023,_=h(0,c,1023)/1023;n.volume=1*g,n.effects[1].effect=t.SoundSynthesizerEffects.volumeRampEffect,n.effects[1].steps=36,n.effects[1].parameter[0]=1*_;let y=Math.round(n.duration/1e4*m);switch(d){case 1:n.effects[2].steps=y,n.effects[2].effect=t.SoundSynthesizerEffects.frequencyVibratoEffect,n.effects[2].parameter[0]=p;break;case 2:n.effects[2].steps=y,n.effects[2].effect=t.SoundSynthesizerEffects.volumeVibratoEffect,n.effects[2].parameter[0]=p;break;case 3:n.effects[2].steps=y,n.effects[2].effect=t.SoundSynthesizerEffects.warbleInterpolation,n.effects[2].parameter[0]=p}return!0}function h(e,t,n){return Math.min(n,Math.max(e,t))}function f(e,t){if(e<0||t<0)return-1;const n=(i=2*t+1,Math.floor(Math.random()*i)-t);var i;return Math.abs(e+n)}function m(){const e={frequency:0,volume:1,duration:0,tone:{tonePrint:void 0,parameter:[0]},effects:[]};for(let n=0;n<t.EMOJI_SYNTHESIZER_TONE_EFFECTS;n++)e.effects.push({effect:void 0,step:0,steps:0,parameter:[],parameter_p:[]});return e}function g(e,t,n){return Math.min(Math.max(e,t),n)}t.isSoundExpPlaying=function(){return a},t.__playSoundExpression=function(t,n,i=.03){o||(o=[]);const r=e.getResume(),s=new Promise((e,s)=>{o.push({notes:t,volume:i,onStarted:()=>{n||r()},onFinished:e,onCancelled:e})});a||c(),n&&s.then(r)},t.clearSoundQueue=u,t.playSoundExpressionAsync=d,t.__stopSoundExpressions=function(){u(),e.AudioContextManager.stopAll()},t.parseSoundExpression=p}(t.music||(t.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){class t{constructor(e){this.id=e}}e.Button=t;e.ButtonPairState=class{constructor(e){this.props=e,this.usesButtonAB=!1,this.aBtn=new t(this.props.ID_BUTTON_A),this.bBtn=new t(this.props.ID_BUTTON_B),this.abBtn=new t(this.props.ID_BUTTON_AB),this.abBtn.virtual=!0}}}(pxsim||(pxsim={})),function(e){e.CompassState=class{constructor(){this.usesHeading=!1,this.heading=90}}}(pxsim||(pxsim={})),function(e){e.FileSystemState=class{constructor(){this.files={}}append(e,t){this.files[e]=(this.files[e]||"")+t}remove(e){delete this.files[e]}}}(pxsim||(pxsim={})),function(e){e.LightSensorState=class{constructor(){this.usesLightLevel=!1,this.lightLevel=128}}}(pxsim||(pxsim={})),function(e){!function(t){t.mkBoardView=e=>{const n=e.visual;return new t.GenericBoardSvg({visualDef:n,boardDef:e.boardDef,wireframe:e.wireframe})};t.BoardHost=class{constructor(n,i){this.parts=[],this.boardView=n,this.opts=i,i.boardDef.pinStyles||(i.boardDef.pinStyles={}),this.state=i.state;let r=i.partsList,s=0<r.length||i.forceBreadboardLayout;if(s){this.breadboard=new t.Breadboard({wireframe:i.wireframe});const n=i.boardDef.marginWhenBreadboarding||[0,0,40,0],o=t.composeSVG({el1:this.boardView.getView(),scaleUnit1:this.boardView.getPinDist(),el2:this.breadboard.getSVGAndSize(),scaleUnit2:this.breadboard.getPinDist(),margin:[n[0],n[1],20,n[3]],middleMargin:n[2],maxWidth:i.maxWidth,maxHeight:i.maxHeight}),a=o.under,l=o.over;this.view=o.host;const c=o.edges;this.fromMBCoord=o.toHostCoord1,this.fromBBCoord=o.toHostCoord2,this.partGroup=l,this.partOverGroup=e.svg.child(this.view,"g"),this.style=e.svg.child(this.view,"style",{}),this.defs=e.svg.child(this.view,"defs",{}),this.wireFactory=new t.WireFactory(a,l,c,this.style,this.getLocCoord.bind(this),this.getPinStyle.bind(this));const u=e.allocateDefinitions({boardDef:i.boardDef,partDefs:i.partDefs,fnArgs:i.fnArgs,getBBCoord:this.breadboard.getCoord.bind(this.breadboard),partsList:r});u.partsAndWires.length||i.forceBreadboardLayout?(this.addAll(u),u.requiresBreadboard||i.forceBreadboardRender?u.hideBreadboard&&this.breadboard&&this.breadboard.hide():s=!1):s=!1}if(!s){delete this.breadboard,delete this.wireFactory,delete this.partOverGroup,delete this.partGroup,delete this.style,delete this.defs,delete this.fromBBCoord,delete this.fromMBCoord;const t=this.boardView.getView().el;this.view=t,this.partGroup=e.svg.child(this.view,"g"),this.partOverGroup=e.svg.child(this.view,"g"),i.maxWidth&&e.svg.hydrate(this.view,{width:i.maxWidth}),i.maxHeight&&e.svg.hydrate(this.view,{height:i.maxHeight})}this.state.updateSubscribers.push(()=>this.updateState())}highlightBoardPin(e){this.boardView.highlightPin(e)}removeEventListeners(){this.boardView.removeEventListeners&&this.boardView.removeEventListeners()}highlightBreadboardPin(e){this.breadboard.highlightLoc(e)}highlightWire(t){t.wires.forEach(t=>{e.U.addClass(t,"highlight"),t.style.visibility="visible"}),e.U.addClass(t.endG,"highlight")}getView(){return this.view}screenshotAsync(t){const n=this.view.classList.contains("sim")?this.view:this.view.querySelector(".sim"),i=n?n.cloneNode(!0):this.view.cloneNode(!0);i.setAttribute("width",i.viewBox.baseVal.width+""),i.setAttribute("height",i.viewBox.baseVal.height+"");const r=(new XMLSerializer).serializeToString(i),s="data:image/svg+xml,"+encodeURIComponent(r.replace(/\s+/g," ").replace(/"/g,"'"));return new Promise((n,i)=>{const r=document.createElement("img");r.onload=()=>{const e=document.createElement("canvas");e.width=r.width,e.height=r.height,t>0?(e.width=t,e.height=r.height*t/r.width|0):e.width<200?(e.width*=2,e.height*=2):e.width>480&&(e.width/=2,e.height/=2);const i=e.getContext("2d");i.drawImage(r,0,0,e.width,e.height),n(i.getImageData(0,0,e.width,e.height))},r.onerror=t=>{e.log(t),n(void 0)},r.src=s})}updateState(){this.parts.forEach(e=>e.updateState())}getBBCoord(e){let t=this.breadboard.getCoord(e);return this.fromBBCoord(t)}getPinCoord(t){let n=this.boardView.getCoord(t);if(n)return this.fromMBCoord(n);e.error(`Unable to find coord for pin: ${t}`)}getLocCoord(t){let n;if("breadboard"===t.type){let e=t;n=this.getBBCoord(e)}else{let e=t.pin;n=this.getPinCoord(e)}return n||e.debug("Unknown location: "+name),n}getPinStyle(e){return"breadboard"==e.type?"female":this.opts.boardDef.pinStyles[e.pin]||"female"}addPart(n){let i=null;if(n.simulationBehavior){let e=n.simulationBehavior,t=this.state.builtinVisuals[e],r=this.state.builtinParts[e];i=t(),i.init(this.state.bus,r,this.view,n.params)}else{let e=n.visual;i=new t.GenericPart(e)}this.parts.push(i),this.partGroup.appendChild(i.element),i.overElement&&this.partOverGroup.appendChild(i.overElement),i.defs&&i.defs.forEach(e=>this.defs.appendChild(e)),this.style.textContent+=i.style||"";let r=n.startColumnIdx,s=n.startRowIdx,o={type:"breadboard",row:t.getRowName(s),col:t.getColumnName(r),xOffset:n.bbFit.xOffset/n.visual.pinDistance,yOffset:n.bbFit.yOffset/n.visual.pinDistance},a=this.getBBCoord(o);i.moveToCoord(a);let l=`sim-${n.name}-cmp`;return e.U.addClass(i.element,l),e.U.addClass(i.element,"sim-cmp"),i.updateTheme(),i.updateState(),i}addWire(e){return this.wireFactory.addWire(e.start,e.end,e.color)}addAll(e){e.partsAndWires.forEach(t=>{const n=t.wires,i=n&&n.every(e=>this.wireFactory.checkWire(e.start,e.end));i&&n.forEach(t=>e.wires.push(this.addWire(t)));let r=t.part;!r||n&&!i||e.parts.push(this.addPart(r))}),e.requiresBreadboard=!!e.wires.length||!!e.parts.length}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){const n=15,i="#1AA5D7",r="#DD4BA0",s=`\n        /* bread board */\n        .sim-bb-background {\n            fill:#E0E0E0;\n        }\n        .sim-bb-pin {\n            fill:#999;\n        }\n        .sim-bb-pin-hover {\n            visibility: hidden;\n            pointer-events: all;\n            stroke-width: 7.5px;\n            stroke: transparent;\n            fill: #777;\n        }\n        .sim-bb-pin-hover:hover {\n            visibility: visible;\n            fill:#444;\n        }\n        .sim-bb-group-wire {\n            stroke: #999;\n            stroke-width: 3.75px;\n            visibility: hidden;\n        }\n        .sim-bb-pin-group {\n            pointer-events: all;\n        }\n        .sim-bb-label,\n        .sim-bb-label-hover {\n            font-family:"Lucida Console", Monaco, monospace;\n            fill:#555;\n            pointer-events: all;\n            stroke-width: 0;\n            cursor: default;\n        }\n        .sim-bb-label-hover {\n            visibility: hidden;\n            fill:#000;\n            font-weight: bold;\n        }\n        .sim-bb-bar {\n            stroke-width: 0;\n        }\n        .sim-bb-blue {\n            fill:${i};\n            stroke:${i}\n        }\n        .sim-bb-red {\n            fill:${r};\n            stroke:${r};\n        }\n        .sim-bb-pin-group:hover .sim-bb-pin-hover,\n        .sim-bb-pin-group:hover .sim-bb-group-wire,\n        .sim-bb-pin-group:hover .sim-bb-label-hover {\n            visibility: visible;\n        }\n        .sim-bb-pin-group:hover .sim-bb-label {\n            visibility: hidden;\n        }\n        /* outline mode */\n        .sim-bb-outline .sim-bb-background {\n            stroke-width: ${n/7}px;\n            fill: #FFF;\n            stroke: #000;\n        }\n        .sim-bb-outline .sim-bb-mid-channel {\n            fill: #FFF;\n            stroke: #888;\n            stroke-width: 2px;\n        }\n        /* grayed out */\n        .grayed .sim-bb-background {\n            stroke-width: 3px;\n        }\n        .grayed .sim-bb-red,\n        .grayed .sim-bb-blue {\n            fill: #BBB;\n        }\n        .grayed .sim-bb-bar {\n            fill: #FFF;\n        }\n        .grayed .sim-bb-pin {\n            fill: #000;\n            stroke: #FFF;\n            stroke-width: 3px;\n        }\n        .grayed .sim-bb-label {\n            fill: none;\n        }\n        .grayed .sim-bb-background {\n            stroke-width: 7.5px;\n            stroke: #555;\n        }\n        .grayed .sim-bb-group-wire {\n            stroke: #DDD;\n        }\n        .grayed .sim-bb-channel {\n            visibility: hidden;\n        }\n        /* highlighted */\n        .sim-bb-label.highlight {\n            visibility: hidden;\n        }\n        .sim-bb-label-hover.highlight {\n            visibility: visible;\n        }\n        .sim-bb-blue.highlight {\n            fill:${i};\n        }\n        .sim-bb-red.highlight {\n            fill:${r};\n        }\n        .sim-bb-bar.highlight {\n            stroke-width: 0px;\n        }\n        `;t.BREADBOARD_MID_ROWS=10,t.BREADBOARD_MID_COLS=30;const o=[4,4],a=t.BREADBOARD_MID_ROWS+o.length,l=25,c=[4,9,14,19],u=l+c.length,d=n*(t.BREADBOARD_MID_COLS+3),p=n*(a+4+5.5),h=2/3,f=p*h,m=p*(.5*(1-h)),g=(t.BREADBOARD_MID_COLS-1)*n,_=(d-g)/2,y=m+(f-(a-1)*n)/2,b=(u-1)*n,v=(d-b)/2,T=(m-15)/2,k=v,x=T+m+f,E=25.5,S=12,C=1.05,w=-90,I="abcdefghij".split("").reverse();function A(e){return`${e+1}`}function N(e){return I[e]}function D(t){let n=t.xOffset||0,i=t.yOffset||0,r=[],s=e.svg.elt("g"),o=t.colStartIdx||0,a=t.rowStartIdx||0,l=e=>e?e.slice(0,e.length):[],c=(e,t)=>{let n,i=0;for(;0<=(n=e.indexOf(t));)e.splice(n,1),i+=1;return i},u=0,d=l(t.rowIdxsWithGap);for(let p=0;p<t.rowCount;p++){let h=0,f=l(t.colIdxsWithGap),m=i+p*t.pinDist+u*t.pinDist,g=p+a;for(let i=0;i<t.colCount;i++){let a=n+i*t.pinDist+h*t.pinDist,l=i+o;const u=t=>(e.svg.hydrate(t.el,"circle"==t.el.tagName?{cx:a,cy:m}:{x:a-.5*t.w,y:m-.5*t.h}),s.appendChild(t.el),t.el);let d=u(t.mkPin()),p=u(t.mkHoverPin()),_=t.getRowName(g),y=t.getColName(l),b=t.getGroupName?t.getGroupName(g,l):null,v={el:d,hoverEl:p,cx:a,cy:m,row:_,col:y,group:b};r.push(v),h+=c(f,l)}u+=c(d,g)}return{g:s,allPins:r}}function O(){let t=e.svg.elt("rect");return e.svg.hydrate(t,{class:"sim-bb-pin",rx:2,ry:2,width:6,height:6}),{el:t,w:6,h:6,x:0,y:0}}function R(){let t=e.svg.elt("rect"),n=6*1.3;return e.svg.hydrate(t,{class:"sim-bb-pin-hover",rx:2,ry:2,width:n,height:n}),{el:t,w:n,h:n,x:0,y:0}}function L(n,i,r,s,o,a,l){let c=t.mkTxt(n,i,r,s,o);e.U.addClass(c,"sim-bb-label"),l&&l.forEach(t=>e.U.addClass(c,t));let u=t.mkTxt(n,i,1.3*r,s,o);return e.U.addClass(u,"sim-bb-label-hover"),l&&l.forEach(t=>e.U.addClass(u,t)),{el:c,hoverEl:u,txt:o,group:a}}t.getColumnName=A,t.getRowName=N,t.mkGrid=D;t.Breadboard=class{constructor(t){this.allPins=[],this.allLabels=[],this.allPowerBars=[],this.rowColToPin={},this.rowColToLbls={},this.buildDom(),t.wireframe&&e.U.addClass(this.bb,"sim-bb-outline")}hide(){this.bb.style.display="none"}updateLocation(t,n){e.svg.hydrate(this.bb,{x:`${t}px`,y:`${n}px`})}getPin(e,t){let n=this.rowColToPin[e];if(!n)return null;let i=n[t];return i||null}getCoord(e){let{row:t,col:i,xOffset:r,yOffset:s}=e,o=this.getPin(t,i);if(!o)return null;let a=(r||0)*n,l=(s||0)*n;return[o.cx+a,o.cy+l]}getPinDist(){return n}buildDom(){this.bb=e.svg.elt("svg",{version:"1.0",viewBox:`0 0 ${d} ${p}`,class:"sim-bb",width:d+"px",height:p+"px"}),this.styleEl=e.svg.child(this.bb,"style",{}),this.styleEl.textContent+=s,this.defs=e.svg.child(this.bb,"defs",{}),e.svg.child(this.bb,"rect",{class:"sim-bb-background",width:d,height:p,rx:4.5,ry:4.5});let i="sim-bb-channel-grad",r=e.svg.elt("linearGradient");e.svg.hydrate(r,{id:i,x1:"0%",y1:"0%",x2:"0%",y2:"100%"}),this.defs.appendChild(r);let a="#AAA",u="#CCC";e.svg.child(r,"stop",{offset:"0%",style:`stop-color: ${a};`}),e.svg.child(r,"stop",{offset:"20%",style:`stop-color: ${u};`}),e.svg.child(r,"stop",{offset:"80%",style:`stop-color: ${u};`}),e.svg.child(r,"stop",{offset:"100%",style:`stop-color: ${a};`});const h=(t,n,r)=>{let s=e.svg.child(this.bb,"rect",{class:`sim-bb-channel ${r||""}`,y:t-n/2,width:d,height:n});return s.setAttribute("fill",`url(#${i})`),s};h(m+f/2,15,"sim-bb-mid-channel"),h(m,.75,"sim-bb-sml-channel"),h(m+f,.75,"sim-bb-sml-channel");const g=(e,n)=>{let i=(e=>e<t.BREADBOARD_MID_ROWS/2?"b":"t")(e);return`${i}${A(n)}`},I=e=>0===e?"-":"+",P=(e,t)=>{let n=(e=>e<25?"b":"t")(t);return`${I(e)}${n}`};let M=D({xOffset:_,yOffset:y,rowCount:t.BREADBOARD_MID_ROWS,colCount:t.BREADBOARD_MID_COLS,pinDist:n,mkPin:O,mkHoverPin:R,getRowName:N,getColName:A,getGroupName:g,rowIdxsWithGap:o});M.g;this.allPins=this.allPins.concat(M.allPins);let F=D({xOffset:k,yOffset:x,rowCount:2,colCount:l,pinDist:n,mkPin:O,mkHoverPin:R,getRowName:I,getColName:A,getGroupName:P,colIdxsWithGap:c});F.g;this.allPins=this.allPins.concat(F.allPins);let B=D({xOffset:v,yOffset:T,rowCount:2,colCount:l,colStartIdx:l,pinDist:n,mkPin:O,mkHoverPin:R,getRowName:I,getColName:A,getGroupName:P,colIdxsWithGap:c.map(e=>e+l)});B.g;this.allPins=this.allPins.concat(B.allPins),this.allPins.forEach(t=>{let{el:n,row:i,col:r,hoverEl:s}=t,o=`(${i},${r})`;e.svg.hydrate(n,{title:o}),e.svg.hydrate(s,{title:o})}),this.allPins.forEach(e=>{let t=this.rowColToPin[e.row];t||(t=this.rowColToPin[e.row]={}),t[e.col]=e});const $=(e,t,n,i,r,s)=>{let o=this.getCoord({type:"breadboard",row:e,col:t}),[a,l]=o;return L(a+n,l+i,10.5,-90,r,s)};for(let e=0;e<t.BREADBOARD_MID_COLS;e++){let n=A(e),i=0,r=$(N(i),n,0,-15,n,g(i,e));this.allLabels.push(r);let s=t.BREADBOARD_MID_ROWS-1,o=$(N(s),n,0,15,n,g(s,e));this.allLabels.push(o)}for(let e=0;e<t.BREADBOARD_MID_ROWS;e++){let n=N(e),i=$(n,A(0),-15,0,n);this.allLabels.push(i);let r=$(n,A(t.BREADBOARD_MID_COLS-1),15,0,n);this.allLabels.push(r)}let U=[L(13.05,m+f+S,30,w,"-",P(0,0),["sim-bb-blue"]),L(12,m+f+m-S,E,w,"+",P(1,0),["sim-bb-red"]),L(d-S+C,m+f+S,30,w,"-",P(0,24),["sim-bb-blue"]),L(d-S,m+f+m-S,E,w,"+",P(1,24),["sim-bb-red"])];this.allLabels=this.allLabels.concat(U);let V=[L(13.05,12,30,w,"-",P(0,l),["sim-bb-blue"]),L(12,m-S,E,w,"+",P(1,l),["sim-bb-red"]),L(d-S+C,12,30,w,"-",P(0,49),["sim-bb-blue"]),L(d-S,m-S,E,w,"+",P(1,49),["sim-bb-red"])];this.allLabels=this.allLabels.concat(V);let H={};this.allLabels.forEach(e=>{let{el:t,txt:n}=e;(H[n]=H[n]||[]).push(e)});this.allPins.forEach(e=>{let{row:t,col:n,group:i}=e,r=this.rowColToLbls[t]||(this.rowColToLbls[t]={}),s=r[n]||(r[n]=[]);if((e=>"-"===e.row||"+"===e.row)(e)){Number(n)<=l?U.filter(t=>t.group==e.group).forEach(e=>s.push(e)):V.filter(t=>t.group==e.group).forEach(e=>s.push(e))}else{H[t].forEach(e=>s.push(e)),H[n].forEach(e=>s.push(e))}});const G=b+22.5,j=(G-b)/2,K=(t,n,i,r)=>{let s=e.svg.elt("rect");return e.svg.hydrate(s,{class:`sim-bb-bar ${r}`,x:t,y:n-1.5,width:G,height:3}),{el:s,group:i}};let z=[K(k-j,x-9,P(0,49),"sim-bb-blue"),K(k-j,x+n+9,P(1,49),"sim-bb-red"),K(v-j,T-9,P(0,0),"sim-bb-blue"),K(v-j,T+n+9,P(1,0),"sim-bb-red")];this.allPowerBars=this.allPowerBars.concat(z),this.allPowerBars.forEach(e=>this.bb.appendChild(e.el));let W=this.allPins.map(e=>e.group).filter((e,t,n)=>n.indexOf(e)==t),q=W.map(t=>e.svg.elt("g"));q.forEach(t=>e.U.addClass(t,"sim-bb-pin-group")),q.forEach((t,n)=>e.U.addClass(t,`group-${W[n]}`));let J={};W.forEach((e,t)=>J[e]=q[t]);let Y={};this.allPins.forEach((e,t)=>{let n=e.group;(Y[n]||(Y[n]=[])).push(e)}),W.forEach(t=>{let n=Y[t],[i,r]=[n.map(e=>e.cx),n.map(e=>e.cy)],s=e=>e.reduce((e,t)=>e<t?e:t),o=e=>e.reduce((e,t)=>e>t?e:t),[a,l,c,u]=[s(i),o(i),s(r),o(r)],d=e.svg.elt("rect"),p=Math.max(l-a,1e-4),h=Math.max(u-c,1e-4);e.svg.hydrate(d,{x:a,y:c,width:p,height:h}),e.U.addClass(d,"sim-bb-group-wire"),J[t].appendChild(d)}),this.allPins.forEach(e=>{let t=J[e.group];t.appendChild(e.el),t.appendChild(e.hoverEl)});let X=e.svg.elt("g");e.svg.hydrate(X,{class:"sim-bb-group-misc"}),q.push(X),this.allLabels.forEach(e=>{if(e.group){let t=J[e.group];t.appendChild(e.el),t.appendChild(e.hoverEl)}else X.appendChild(e.el),X.appendChild(e.hoverEl)}),q.forEach(e=>this.bb.appendChild(e))}getSVGAndSize(){return{el:this.bb,y:0,x:0,w:d,h:p}}highlightLoc(t){let{row:n,col:i}=t,r=this.rowColToPin[n][i],{cx:s,cy:o}=r;this.rowColToLbls[n][i].forEach(t=>{e.U.addClass(t.el,"highlight"),e.U.addClass(t.hoverEl,"highlight")})}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){t.BOARD_SYTLE=`\n        .noselect {\n            -webkit-touch-callout: none; /* iOS Safari */\n            -webkit-user-select: none;   /* Chrome/Safari/Opera */\n            -khtml-user-select: none;    /* Konqueror */\n            -moz-user-select: none;      /* Firefox */\n            -ms-user-select: none;       /* Internet Explorer/Microsoft Edge */\n            user-select: none;           /* Non-prefixed version, currently\n                                            not supported by any browser */\n        }\n\n        .sim-board-pin {\n            fill:#999;\n            stroke:#000;\n            stroke-width:${t.PIN_DIST/3}px;\n        }\n        .sim-board-pin-lbl {\n            fill: #333;\n        }\n        .gray-cover {\n            fill:#FFF;\n            opacity: 0.3;\n            stroke-width:0;\n            visibility: hidden;\n        }\n        .sim-board-pin-hover {\n            visibility: hidden;\n            pointer-events: all;\n            stroke-width:${t.PIN_DIST/6}px;\n        }\n        .sim-board-pin-hover:hover {\n            visibility: visible;\n        }\n        .sim-board-pin-lbl {\n            visibility: hidden;\n        }\n        .sim-board-outline .sim-board-pin-lbl {\n            visibility: visible;\n        }\n        .sim-board-pin-lbl {\n            fill: #555;\n        }\n        .sim-board-pin-lbl-hover {\n            fill: red;\n        }\n        .sim-board-outline .sim-board-pin-lbl-hover {\n            fill: black;\n        }\n        .sim-board-pin-lbl,\n        .sim-board-pin-lbl-hover {\n            font-family:"Lucida Console", Monaco, monospace;\n            pointer-events: all;\n            stroke-width: 0;\n        }\n        .sim-board-pin-lbl-hover {\n            visibility: hidden;\n        }\n        .sim-board-outline .sim-board-pin-hover:hover + .sim-board-pin-lbl,\n        .sim-board-pin-lbl.highlight {\n            visibility: hidden;\n        }\n        .sim-board-outline .sim-board-pin-hover:hover + * + .sim-board-pin-lbl-hover,\n        .sim-board-pin-lbl-hover.highlight {\n            visibility: visible;\n        }\n        /* Graying out */\n        .grayed .sim-board-pin-lbl:not(.highlight) {\n            fill: #AAA;\n        }\n        .grayed .sim-board-pin:not(.highlight) {\n            fill:#BBB;\n            stroke:#777;\n        }\n        .grayed .gray-cover {\n            visibility: inherit;\n        }\n        .grayed .sim-cmp:not(.notgrayed) {\n            opacity: 0.3;\n        }\n        /* Highlighting */\n        .sim-board-pin-lbl.highlight {\n            fill: #000;\n            font-weight: bold;\n        }\n        .sim-board-pin.highlight {\n            fill:#999;\n            stroke:#000;\n        }\n        `;const n=.7*t.PIN_DIST,i=1.5*n,r=.66666*t.PIN_DIST,s=.66666*t.PIN_DIST+t.PIN_DIST/3;let o=0;t.GenericBoardSvg=class{constructor(a){this.props=a,this.allPins=[],this.allLabels=[],this.pinNmToLbl={},this.pinNmToPin={},this.id=o++;let l=a.visualDef,c=a.wireframe&&l.outlineImage?l.outlineImage:l.image,u=t.mkImageSVG({image:c,width:l.width,height:l.height,imageUnitDist:l.pinDist,targetUnitDist:t.PIN_DIST}),d=t.mkScaleFn(l.pinDist,t.PIN_DIST);this.width=u.w,this.height=u.h;let p=u.el;this.element=e.svg.elt("svg"),e.svg.hydrate(this.element,{version:"1.0",viewBox:`0 0 ${this.width} ${this.height}`,class:`sim sim-board-id-${this.id}`,x:"0px",y:"0px"}),a.wireframe&&e.U.addClass(this.element,"sim-board-outline"),this.style=e.svg.child(this.element,"style",{}),this.style.textContent+=t.BOARD_SYTLE,this.defs=e.svg.child(this.element,"defs",{}),this.g=e.svg.elt("g"),this.element.appendChild(this.g),this.g.appendChild(p),this.background=p,e.svg.hydrate(p,{class:"sim-board"});const h=()=>{let t=e.svg.elt("circle"),n=r;return e.svg.hydrate(t,{class:"sim-board-pin",r:n/2}),{el:t,w:n,h:n,x:0,y:0}},f=()=>{let t=e.svg.elt("circle"),n=s;return e.svg.hydrate(t,{class:"sim-board-pin-hover",r:n/2}),{el:t,w:n,h:n,x:0,y:0}},m=()=>{let t=e.svg.elt("rect"),n=r;return e.svg.hydrate(t,{class:"sim-board-pin",width:n,height:n}),{el:t,w:n,h:n,x:0,y:0}},g=()=>{let t=e.svg.elt("rect"),n=s;return e.svg.hydrate(t,{class:"sim-board-pin-hover",width:n,height:n}),{el:t,w:n,h:n,x:0,y:0}};let _=l.pinBlocks.map((n,i)=>{let r=d(n.x)+t.PIN_DIST/2,s=d(n.y)+t.PIN_DIST/2,o=n.labels.length,a=t.mkGrid({xOffset:r,yOffset:s,rowCount:1,colCount:o,pinDist:t.PIN_DIST,mkPin:l.useCrocClips?h:m,mkHoverPin:l.useCrocClips?f:g,getRowName:()=>`${i+1}`,getColName:e=>n.labels[e],getGroupName:()=>n.labels.join(" ")});a.allPins,a.g;return e.U.addClass(a.g,"sim-board-pin-group"),a}),y=[];_.forEach((e,t)=>e.allPins.forEach((e,n)=>{this.allPins.push(e),y.push(l.pinBlocks[t])})),this.allPins.forEach(t=>{let n=t.col;e.svg.hydrate(t.el,{title:n}),e.svg.hydrate(t.hoverEl,{title:n})}),this.allPins.forEach(e=>{this.pinNmToPin[e.col]=e});const b=(e,n,i,r,s)=>{let o,a;if("below"===s){a=e,o=n+12+.25*i*r.length}else{a=e,o=n-11-.32*i*r.length}return t.mkTxt(a,o,i,-90,r)};this.allLabels=this.allPins.map((t,r)=>{let s=y[r];return((t,r,s,o)=>{let a=b(t,r,n,s,o);e.U.addClass(a,"sim-board-pin-lbl");let l=b(t,r,i,s,o);return e.U.addClass(l,"sim-board-pin-lbl-hover"),{el:a,hoverEl:l,txt:s}})(t.cx,t.cy,t.col,s.labelPosition||"above")}),this.allPins.forEach((e,t)=>{let n=this.allLabels[t];this.pinNmToLbl[e.col]=n}),this.allPins.forEach((e,t)=>{let n=this.allLabels[t];this.g.appendChild(e.el),this.g.appendChild(e.hoverEl),this.g.appendChild(n.el),this.g.appendChild(n.hoverEl)})}findPin(e){let t=this.pinNmToPin[e];return!t&&this.props.boardDef.gpioPinMap&&(e=this.props.boardDef.gpioPinMap[e])&&(t=this.pinNmToPin[e]),t}findPinLabel(e){let t=this.pinNmToLbl[e];return!t&&this.props.boardDef.gpioPinMap&&(e=this.props.boardDef.gpioPinMap[e])&&(t=this.pinNmToLbl[e]),t}getCoord(e){let t=this.findPin(e);return t?[t.cx,t.cy]:null}mkGrayCover(t,n,i,r){let s=e.svg.elt("rect");return e.svg.hydrate(s,{x:t,y:n,width:i,height:r,class:"gray-cover"}),s}getView(){return{el:this.element,w:this.width,h:this.height,x:0,y:0}}getPinDist(){return t.PIN_DIST}highlightPin(t){let n=this.findPinLabel(t),i=this.findPin(t);n&&i&&(e.U.addClass(n.el,"highlight"),e.U.addClass(n.hoverEl,"highlight"),e.U.addClass(i.el,"highlight"),e.U.addClass(i.hoverEl,"highlight"))}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){function n(e){return t.mkImageSVG({image:e.image,width:e.width,height:e.height,imageUnitDist:e.pinDistance,targetUnitDist:t.PIN_DIST})}t.mkGenericPartSVG=n;t.GenericPart=class{constructor(t){this.style="",this.defs=[];let i=n(t).el;this.element=e.svg.elt("g"),this.element.appendChild(i)}moveToCoord(e){t.translateEl(this.element,e)}init(e,t,n){}updateState(){}updateTheme(){}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){const n=t.PIN_DIST/2.5,i=.7;function r(e){return e.replace(/\#/g,"-").replace(/\(/g,"-").replace(/\)/g,"-").replace(/\,/g,"-").replace(/\./g,"-").replace(/\s/g,"")}let s;function o(t,n,i,r){const s=e=>`${e[0]}, ${e[1]}`;let[o,a]=t,[l,c]=n,u=c-a,d=[o,a+u*i],p=[l,c-u*i],h=e.svg.mkPath("sim-bb-wire",`M${s(t)} C${s(d)} ${s(p)} ${s(n)}`);return e.U.addClass(h,`wire-stroke-${r}`),h}function a(t,n,i){const r=e=>`${e[0]}, ${e[1]}`;let s=e.svg.mkPath("sim-bb-wire",`M${r(t)} L${r(n)}`);return e.U.addClass(s,`wire-stroke-${i}`),s}function l(i,r){const s=t.PIN_DIST/4;let o=e.svg.elt("circle"),a=i[0],l=i[1],c=n/2+s/2;return e.svg.hydrate(o,{cx:a,cy:l,r:c,class:"sim-bb-wire-end"}),e.U.addClass(o,`wire-fill-${r}`),o.style["stroke-width"]=`${s}px`,o}function c(n,i,r){let s=.24*t.PIN_DIST,o=10*s,a=2*s,l=6*s,c=s;const u=t.PIN_DIST/4;let[d,p]=n,h=i?-1:1,f=e.svg.elt("g"),m=e.svg.elt("rect"),g=o,_=a,y=d-_/2,b=p-g/2;e.svg.hydrate(m,{x:y,y:b,width:_,height:g,rx:.5,ry:.5,class:"sim-bb-wire-end"}),m.style["stroke-width"]=`${u}px`;let v=e.svg.elt("rect"),T=l,k=c,x=d-k/2,E=p+h*(g/2+T/2)-T/2;return e.svg.hydrate(v,{x:x,y:E,width:k,height:T,class:"sim-bb-wire-bare-end"}),v.style.fill="#bbb",f.appendChild(v),f.appendChild(m),{el:f,x:y-u,y:Math.min(b,E),w:_+2*u,h:g+T}}function u(n,i,r){let s=.24*t.PIN_DIST;const o=4*s,a=10*s,l=3.5*s,c=3.5*s,u=t.PIN_DIST/4;let[d,p]=n,h=i?-1:1,f=e.svg.elt("g"),m=e.svg.elt("polygon"),g=a,_=o,y=d-_/2,b=p-g/2;const v=i?.15:.3,T=i?.7:1-.7,k=i?.3:.15;e.svg.hydrate(m,{points:((...e)=>e.map(e=>(e=>`${e[0]},${e[1]}`)(e)).join(" "))([y+_*v,b],[y+_*(1-v),b],[y+_,b+g*T],[y+_*(1-k),b+g],[y+_*k,b+g],[y,b+g*T])}),e.svg.hydrate(m,{rx:.5,ry:.5,class:"sim-bb-wire-end"}),m.style["stroke-width"]=`${u}px`;let x=e.svg.elt("rect"),E=l,S=c,C=d-S/2,w=p+h*(g/2+E/2)-E/2;return e.svg.hydrate(x,{x:C,y:w,width:S,height:E,class:"sim-bb-wire-bare-end"}),f.appendChild(x),f.appendChild(m),{el:f,x:y-u,y:Math.min(b,w),w:_+2*u,h:g+E}}t.WIRES_CSS=`\n        .sim-bb-wire {\n            fill:none;\n            stroke-linecap: round;\n            stroke-width:${n}px;\n            pointer-events: none;\n        }\n        .sim-bb-wire-end {\n            stroke:#333;\n            fill:#333;\n        }\n        .sim-bb-wire-bare-end {\n            fill: #ccc;\n        }\n        .sim-bb-wire-hover {\n            stroke-width: ${n}px;\n            visibility: hidden;\n            stroke-dasharray: ${t.PIN_DIST/10},${t.PIN_DIST/1.5};\n            /*stroke-opacity: 0.4;*/\n        }\n        .grayed .sim-bb-wire-ends-g:not(.highlight) .sim-bb-wire-end {\n            stroke: #777;\n            fill: #777;\n        }\n        .grayed .sim-bb-wire:not(.highlight) {\n            stroke: #CCC;\n        }\n        .sim-bb-wire-ends-g:hover .sim-bb-wire-end {\n            stroke: red;\n            fill: red;\n        }\n        .sim-bb-wire-ends-g:hover .sim-bb-wire-bare-end {\n            stroke: #FFF;\n            fill: #FFF;\n        }\n        `,function(e){e[e.BBJumper=0]="BBJumper",e[e.OpenJumper=1]="OpenJumper",e[e.Croc=2]="Croc"}(s=t.WireEndStyle||(t.WireEndStyle={})),t.mkWirePart=function(n,i,r=!1){let s,o=e.svg.elt("g"),[a,l]=n,d=[a-15,l-50],p=[a+15,l+50];i=t.mapWireColor(i),s=r?u(d,!0,i):c(d,!0,i);let h=function(t,n,i){const r=e=>`${e[0]}, ${e[1]}`;let[s,o]=t,[a,l]=n,c=l-o,u=[s,o+.8*c],d=[a,l-.8*c],p=e.svg.mkPath("sim-bb-wire",`M${r(t)} C${r(u)} ${r(d)} ${r(n)}`);return p.style.stroke=i,{el:p,x:Math.min(s,a),y:Math.min(o,l),w:Math.abs(s-a),h:Math.abs(o-l)}}(d,p,i),f=c(p,!1,i);o.appendChild(h.el),o.appendChild(s.el),o.appendChild(f.el);let m=Math.min(s.x,f.x),g=Math.max(s.x+s.w,f.x+f.w),_=Math.min(s.y,f.y);return{el:o,x:m,y:_,w:g-m,h:Math.max(s.y+s.h,f.y+f.h)-_}};t.WireFactory=class{constructor(e,n,i,r,s,o){this.nextWireId=0,this.styleEl=r,this.styleEl.textContent+=t.WIRES_CSS,this.underboard=e,this.overboard=n,this.boardEdges=i,this.getLocCoord=s,this.getPinStyle=o}indexOfMin(e){let t=0,n=e[0];for(let i=1;i<e.length;i++)e[i]<n&&(n=e[i],t=i);return t}closestEdgeIdx(e){let t=this.boardEdges.map(t=>Math.abs(e[1]-t));return this.indexOfMin(t)}closestEdge(e){return this.boardEdges[this.closestEdgeIdx(e)]}drawWire(n,s,c){let u=[],d=e.svg.child(this.overboard,"g",{class:"sim-bb-wire-group"});const p=e=>{const n=t.PIN_DIST/2;let i,r=this.closestEdge(e);return i=r-e[1]<0?r-n:r+n,[e[0],i]};let h=this.nextWireId++,f=r(c),m=l(n,f),g=l(s,f),_=e.svg.child(d,"g",{class:"sim-bb-wire-ends-g"});_.appendChild(m),_.appendChild(g);let y=this.closestEdgeIdx(n),b=this.closestEdgeIdx(s);if(y==b){let e=a(n,s,f);d.appendChild(e),u.push(e)}else{let t,r,l=p(n),c=p(s),m=a(n,l,f),g=a(s,c,f);!(1!=y&&2!=y||1!=b&&2!=b)?(t=o(l,c,i,f),r=o(l,c,i,f)):(t=a(l,c,f),r=a(l,c,f)),e.U.addClass(r,"sim-bb-wire-hover"),d.appendChild(m),u.push(m),d.appendChild(g),u.push(g),this.underboard.appendChild(t),u.push(t),d.appendChild(r),u.push(r);let v=`sim-bb-wire-id-${h}`;const T=t=>e.U.addClass(t,v);T(_),T(r),this.styleEl.textContent+=`\n                    .${v}:hover ~ .${v}.sim-bb-wire-hover {\n                        visibility: visible;\n                    }`}let v=`\n                .wire-stroke-${f} {\n                    stroke: ${t.mapWireColor(c)};\n                }\n                .wire-fill-${f} {\n                    fill: ${t.mapWireColor(c)};\n                }\n                `;return this.styleEl.textContent+=v,{endG:_,end1:m,end2:g,wires:u}}drawWireWithCrocs(n,s,c,d=!1){let p=[],h=e.svg.child(this.overboard,"g",{class:"sim-bb-wire-group"});const f=e=>{const n=t.PIN_DIST/2;let i,r=this.closestEdge(e);return i=r-e[1]<0?r-n:r+n,[e[0],i]};let m=this.nextWireId++,g=r(c),_=l(n,g),y=s,[b,v]=s;s=[b,v+40],[b,v]=s;let T,k=[b,v+-17];T=d?function(n,i){let r=.24*t.PIN_DIST,s=4*r,o=1.2*r,a=10*r,l=r;const c=t.PIN_DIST/4;let[u,d]=n,p=i?-1:1,h=e.svg.elt("g"),f=e.svg.elt("rect"),m=s,g=o,_=u-g/2,y=d+10-m/2;e.svg.hydrate(f,{x:_,y:y,width:g,height:m,rx:.5,ry:.5,class:"sim-bb-wire-end"}),f.style["stroke-width"]=`${c}px`;let b=e.svg.elt("rect"),v=a,T=l,k=u-T/2,x=d+10+p*(m/2+v/2)-v/2;return e.svg.hydrate(b,{x:k,y:x,width:T,height:v,class:"sim-bb-wire-bare-end"}),b.style.fill="#bbb",h.appendChild(b),h.appendChild(f),{el:h,x:_-c,y:Math.min(y,x),w:g+2*c,h:m+v}}(k,!0):u(k,!0);let x=T.el,E=e.svg.child(h,"g",{class:"sim-bb-wire-ends-g"});E.appendChild(_);let S=this.closestEdgeIdx(n),C=this.closestEdgeIdx(y);if(S==C){let e=a(n,s,g);h.appendChild(e),p.push(e)}else{let t,r,l=f(n),c=a(n,l,g);!(1!=S&&2!=S||1!=C&&2!=C)?(t=o(l,s,i,g),r=o(l,s,i,g)):(t=a(l,s,g),r=a(l,s,g)),e.U.addClass(r,"sim-bb-wire-hover"),h.appendChild(c),p.push(c),this.underboard.appendChild(t),p.push(t);let u=`sim-bb-wire-id-${m}`;const d=t=>e.U.addClass(t,u);d(E),d(r),this.styleEl.textContent+=`\n                    .${u}:hover ~ .${u}.sim-bb-wire-hover {\n                        visibility: visible;\n                    }`}E.appendChild(x);let w=`\n                .wire-stroke-${g} {\n                    stroke: ${t.mapWireColor(c)};\n                }\n                .wire-fill-${g} {\n                    fill: ${t.mapWireColor(c)};\n                }\n                `;return this.styleEl.textContent+=w,{endG:E,end1:_,end2:x,wires:p}}checkWire(e,t){let n=this.getLocCoord(e),i=this.getLocCoord(t);return!!n&&!!i}addWire(t,n,i){let r=this.getLocCoord(t),s=this.getLocCoord(n);if(!r||!s)return void e.debug(`unable to allocate wire for ${t} or ${n}`);let o,a=this.getPinStyle(n);return o="dalboard"==n.type&&"croc"==a?this.drawWireWithCrocs(r,s,i):this.drawWire(r,s,i),o}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return r(t[o][1][e]||e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BlockDragger=void 0;const i=e("blockly");class r extends i.dragging.Dragger{onDrag(e,t){super.onDrag(e,t);const n=document.getElementsByClassName("blocklyToolbox")[0],r=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],s=document.getElementById("blocklyTrashIcon");if(r&&s){const t=r.getBoundingClientRect(),l=(o=r.getBoundingClientRect(),a=e.clientX,Math.abs(a-(o.left+o.width/2))),c=i.Gesture.inProgress();if(c&&l<200||!c&&function(e,t){return t-(e.left+e.width)<0}(t,e.clientX)){const e=l/200;s.style.opacity=""+(1-e),s.style.display="block",n&&(r.style.opacity=`${e}`,l<50&&pxt.BrowserUtils.addClass(n,"blocklyToolboxDeleting"))}else s.style.display="none",r.style.opacity="1",n&&pxt.BrowserUtils.removeClass(n,"blocklyToolboxDeleting")}var o,a}onDragEnd(e){super.onDragEnd(e);const t=document.getElementsByClassName("blocklyToolbox")[0],n=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],i=document.getElementById("blocklyTrashIcon");i&&n&&(i.style.display="none",n.style.opacity="1",t&&pxt.BrowserUtils.removeClass(t,"blocklyToolboxDeleting"))}}n.BlockDragger=r},{blockly:176}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BreakpointIcon=void 0;const i=e("blockly");class r extends i.icons.Icon{constructor(e,t){super(e),this.onStateChange=t,this.isSet_=!1}getType(){return r.type}initView(e){super.initView(e),this.breakpointSvg||(this.breakpointSvg=i.utils.dom.createSvgElement("circle",{class:"blocklyBreakpointSymbol",stroke:"white","stroke-width":2,cx:7,cy:11.5,r:8},this.svgRoot),this.updateColor())}getSize(){return new i.utils.Size(25,25)}onClick(){this.isSet_=!this.isSet_,this.updateColor(),this.onStateChange(this.sourceBlock,this.isSet_)}isEnabled(){return this.isSet_}setEnabled(e){this.isSet_=e,this.updateColor()}updateColor(){this.breakpointSvg&&this.breakpointSvg.setAttribute("fill",this.isSet_?"#FF0000":"#CCCCCC")}}n.BreakpointIcon=r,r.type=new i.icons.IconType("breakpoint")},{blockly:176}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initFunctions=void 0;const i=e("blockly"),r=e("../help"),s=e("../plugins/functions"),o=e("../toolbox"),a=e("../fields"),l=e("../loader"),c=e("../importer"),u=e("../fields/field_imagenotext");function d(e,t){if(!t)return[];let n=[];if(!pxt.appTarget.appTheme.hideFlyoutHeadings){let e=(0,o.createFlyoutHeadingLabel)(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions");n.push(e)}const r=lf("Make a Function..."),s=lf("New function name:");let a=i.utils.xml.createElement("button");a.setAttribute("text",r),a.setAttribute("callbackKey","CREATE_FUNCTION");return e.registerButtonCallback("CREATE_FUNCTION",function(t){let n=t=>{i.dialog.prompt(s,t,function(t){pxt.tickEvent("blocks.makeafunction"),t&&(t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))==r&&(t=null),t&&(e.getVariableMap().getVariable(t)?i.dialog.alert(i.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",t.toLowerCase()),function(){n(t)}):i.Procedures.isNameUsed(t,e)?(t=>{let n=e.getTopBlocks(!0)[0],r=10,s=10;if(n){let e=n.getRelativeToSurfaceXY();r=e.x+i.SNAP_RADIUS*(n.RTL?-1:1),s=e.y+2*i.SNAP_RADIUS}let o=i.utils.xml.createElement("xml"),a=i.utils.xml.createElement("block");a.setAttribute("type","procedures_defnoreturn"),a.setAttribute("x",String(r)),a.setAttribute("y",String(s));let l=i.utils.xml.createElement("field");l.setAttribute("name","NAME"),l.appendChild(document.createTextNode(t)),a.appendChild(l),o.appendChild(a);let u=(0,c.domToWorkspaceNoEvents)(o,e);i.hideChaff();let d=e.getBlockById(u[0]);d.select(),e.centerOnBlock(d.id,!0)})(t):i.dialog.alert(i.Msg.PROCEDURE_ALREADY_EXISTS.replace("%1",t.toLowerCase()),function(){n(t)}))})};n("doSomething")}),n.push(a),function(e,t){for(let r=0;r<e.length;r++){let s=e[r][0],o=(e[r][1],i.utils.xml.createElement("block"));o.setAttribute("type",t),o.setAttribute("gap","16"),o.setAttribute("colour",pxt.toolbox.getNamespaceColor("functions"));let a=i.utils.xml.createElement("field");a.textContent=s,a.setAttribute("name","NAME"),o.appendChild(a),n.push(o)}}(i.Procedures.allProcedures(e)[0],"procedures_callnoreturn"),n}n.initFunctions=function(){const e=i.Msg;e.FUNCTION_CREATE_NEW=lf("Make a Function..."),e.FUNCTION_WARNING_DUPLICATE_ARG=lf("Functions cannot use the same argument name more than once."),e.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME=lf("Argument names must not be the same as the function name."),e.FUNCTION_WARNING_EMPTY_NAME=lf("Function and argument names cannot be empty."),e.FUNCTIONS_DEFAULT_FUNCTION_NAME=lf("doSomething"),e.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME=lf("bool"),e.FUNCTIONS_DEFAULT_STRING_ARG_NAME=lf("text"),e.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME=lf("num"),e.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME=lf("arg"),e.FUNCTION_FLYOUT_LABEL=lf("Your Functions"),e.FUNCTIONS_CREATE_CALL_OPTION=lf("Create 'call {0}'","%1"),e.FUNCTIONS_DEFNORETURN_TITLE=lf("function"),e.PROCEDURES_HUE=pxt.toolbox.getNamespaceColor("functions"),e.REPORTERS_HUE=pxt.toolbox.getNamespaceColor("variables");const t="procedures_defnoreturn",n=pxt.blocks.getBlockDefinition(t);e.PROCEDURES_DEFNORETURN_TITLE=n.block.PROCEDURES_DEFNORETURN_TITLE,e.PROCEDURE_ALREADY_EXISTS=n.block.PROCEDURE_ALREADY_EXISTS,i.Blocks.procedures_defnoreturn.init=function(){let e=new i.FieldTextInput("",i.Procedures.rename);this.appendDummyInput().appendField(i.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.argumentVarModels_=[],this.hat="cap",this.setStatements_(!0),this.statementConnection_=null},(0,r.installBuiltinHelpInfo)(t);const o="procedures_callnoreturn",p=pxt.blocks.getBlockDefinition(o);e.PROCEDURES_CALLRETURN_TOOLTIP=n.tooltip.toString(),i.Blocks.procedures_callnoreturn={init:function(){let e=new a.FieldProcedure("");this.appendDummyInput("TOPROW").appendField(p.block.PROCEDURES_CALLNORETURN_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.quarkConnections_={},this.quarkIds_=null},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,t){i.Names.equals(e,this.getProcedureCall())&&this.setFieldValue(t,"NAME")},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&!this.isInsertionMarker())if(e.type==i.Events.CREATE&&-1!=e.ids.indexOf(this.id)){let t=this.getProcedureCall(),n=i.Procedures.getDefinition(t,this.workspace);if(!n||n.type==this.defType_&&JSON.stringify(n.arguments_)==JSON.stringify(this.arguments_)||(n=null),!n){i.Events.setGroup(e.group);let t=i.utils.xml.createElement("xml"),n=i.utils.xml.createElement("block");n.setAttribute("type",this.defType_);let r=this.getRelativeToSurfaceXY(),s=r.x+i.SNAP_RADIUS*(this.RTL?-1:1),o=r.y+2*i.SNAP_RADIUS;n.setAttribute("x",s),n.setAttribute("y",o);let a=i.utils.xml.createElement("field");a.setAttribute("name","NAME"),a.appendChild(document.createTextNode(this.getProcedureCall())),n.appendChild(a),t.appendChild(n),(0,c.domToWorkspaceNoEvents)(t,this.workspace),i.Events.setGroup(!1)}}else if(e.type==i.Events.DELETE){let t=this.getProcedureCall();i.Procedures.getDefinition(t,this.workspace)||(i.Events.setGroup(e.group),this.dispose(!0,!1),i.Events.setGroup(!1))}},mutationToDom:function(){const e=document.createElement("mutation");return e.setAttribute("name",this.getProcedureCall()),e},domToMutation:function(e){const t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t)},customContextMenu:function(e){let t={enabled:!0};t.text=i.Msg.PROCEDURES_HIGHLIGHT_DEF;let n=this.getProcedureCall(),r=this.workspace;t.callback=function(){let e=i.Procedures.getDefinition(n,r);e&&e.select()},e.push(t)},defType_:"procedures_defnoreturn"},(0,r.installBuiltinHelpInfo)(o);const h="function_definition",f=pxt.blocks.getBlockDefinition(h);e.FUNCTIONS_EDIT_OPTION=f.block.FUNCTIONS_EDIT_OPTION,(0,r.installBuiltinHelpInfo)(h);const m="function_call",g=pxt.blocks.getBlockDefinition(m);e.FUNCTIONS_CALL_TITLE=g.block.FUNCTIONS_CALL_TITLE,e.FUNCTIONS_GO_TO_DEFINITION_OPTION=g.block.FUNCTIONS_GO_TO_DEFINITION_OPTION,(0,r.installBuiltinHelpInfo)(m),(0,r.installBuiltinHelpInfo)("function_call_output");const _="function_return";i.Blocks[_]={init:function(){!function(e){const t=pxt.blocks.getBlockDefinition("function_return"),n="0_add_button",r="0_rem_button";i.Extensions.apply("inline-svgs",e,!1);let s,o=!0;function a(){const i=e.getInput("RETURN_VALUE");if(o){if(!i){for(;e.getInput("");)e.removeInput("");e.jsonInit({message0:t.block.message_with_value,args0:[{type:"input_value",name:"RETURN_VALUE",check:null}],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})}if(e.getInput(n)&&e.removeInput(n),e.getInput(r)||p(),s){const t=e.workspace.getBlockById(s);t&&t.outputConnection&&!t.outputConnection.targetBlock()&&e.getInput("RETURN_VALUE").connection.connect(t.outputConnection),s=void 0}}else{if(i){const n=i.connection.targetBlock();n&&(n.isShadow()&&n.setShadow(!1),i.connection.disconnect(),s=n.id),e.removeInput("RETURN_VALUE"),e.jsonInit({message0:t.block.message_no_value,args0:[],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})}e.getInput(r)&&e.removeInput(r),e.getInput(n)||d()}e.setInputsInline(!0)}function l(e,t){e.setAttribute("no_return_value",t?"false":"true")}function c(e){return"true"!==e.getAttribute("no_return_value")}function d(){m(n,e.ADD_IMAGE_DATAURI,lf("Add return value"))}function p(){m(r,e.REMOVE_IMAGE_DATAURI,lf("Remove return value"))}function h(){return i.Xml.domToText(e.mutationToDom())}function f(t,n){t!==n&&i.Events.fire(new i.Events.BlockChange(e,"mutation",null,t,n))}function m(t,n,i){e.appendDummyInput(t).appendField(new u.FieldImageNoText(n,24,24,i,()=>{const e=h();o=!o;const t=h();f(e,t),a();f(t,h())},!1))}a(),e.domToMutation=e=>{e.hasAttribute("last_connected_id")&&(s=e.getAttribute("last_connected_id")),o=c(e),a()},e.mutationToDom=()=>{const t=document.createElement("mutation");return l(t,!!e.getInput("RETURN_VALUE")),s&&t.setAttribute("last_connected_id",s),t}}(this)},onchange:function(e){const t=this;if(!t.workspace||t.workspace.isFlyout)return;const n=e.type===i.Events.BLOCK_CREATE&&-1!=e.ids.indexOf(t.id),r=e.type===i.Events.BLOCK_DRAG&&e.blocks.some(e=>e.id===t.id);if(n||r){const n=t.getRootBlock();if(n.type===_||null!=n.previousConnection)return;n.type!==h&&(i.Events.setGroup(e.group),t.previousConnection.disconnect(),i.Events.setGroup(!1))}}},(0,r.installBuiltinHelpInfo)(_),i.Procedures.flyoutCategory=d;const y={number:pxt.blocks.defaultIconForArgType("number"),boolean:pxt.blocks.defaultIconForArgType("boolean"),string:pxt.blocks.defaultIconForArgType("string"),Array:pxt.blocks.defaultIconForArgType("Array")},b={},v=pxt.appTarget.runtime&&pxt.appTarget.runtime.functionsOptions;v&&v.extraFunctionEditorTypes&&v.extraFunctionEditorTypes.forEach(e=>{y[e.typeName]=e.icon||pxt.blocks.defaultIconForArgType(),e.defaultName&&(b[e.typeName]=e.defaultName)});for(const e of Object.keys(y))s.FunctionManager.getInstance().setIconForType(e,y[e]);for(const e of Object.keys(b))s.FunctionManager.getInstance().setArgumentNameForType(e,b[e]);i.Blocks.argument_reporter_custom&&(i.Blocks.argument_reporter_custom.domToMutation=function(e){const t=e.getAttribute("typename");this.typeName_=t,(0,l.setOutputCheck)(this,t,l.cachedBlockInfo)});const T=i.Blocks.function_definition.makeCallOption;i.Blocks.function_definition.makeCallOption=function(){const e=T.call(this),t=this.getName();return e.text=pxt.Util.lf("Create 'call {0}'",t),e}}},{"../fields":70,"../fields/field_imagenotext":38,"../help":72,"../importer":73,"../loader":77,"../plugins/functions":112,"../toolbox":140,blockly:176}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initLists=void 0;const i=e("blockly"),r=e("../help"),s=e("../constants");n.initLists=function(){const e=i.Msg,t="lists_create_with",n=pxt.blocks.getBlockDefinition(t);e.LISTS_CREATE_EMPTY_TITLE=n.block.LISTS_CREATE_EMPTY_TITLE,e.LISTS_CREATE_WITH_INPUT_WITH=n.block.LISTS_CREATE_WITH_INPUT_WITH,e.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD=n.block.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD,e.LISTS_CREATE_WITH_ITEM_TITLE=n.block.LISTS_CREATE_WITH_ITEM_TITLE,(0,r.installBuiltinHelpInfo)(t);const o="lists_length",a=pxt.blocks.getBlockDefinition(o);e.LISTS_LENGTH_TITLE=a.block.LISTS_LENGTH_TITLE,i.Blocks[o].init=function(){this.jsonInit({message0:e.LISTS_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["Array"]}],output:"Number",outputShape:s.provider.SHAPES.ROUND})},(0,r.installBuiltinHelpInfo)(o);const l="lists_index_get",c=pxt.blocks.getBlockDefinition(l);i.Blocks.lists_index_get={init:function(){this.jsonInit({message0:c.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"}],colour:pxt.toolbox.blockColors.arrays,outputShape:s.provider.SHAPES.ROUND,inputsInline:!0}),this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0),(0,r.setBuiltinHelpInfo)(this,l)}};const u="lists_index_set",d=pxt.blocks.getBlockDefinition(u);i.Blocks[u]={init:function(){this.jsonInit({message0:d.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"},{type:"input_value",name:"VALUE",check:null}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.arrays,inputsInline:!0}),(0,r.setBuiltinHelpInfo)(this,u)}}}},{"../constants":18,"../help":72,blockly:176}],5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initLogic=void 0;const i=e("blockly"),r=e("../help");n.initLogic=function(){const e=i.Msg,t="controls_if",n=pxt.blocks.getBlockDefinition(t),s=n.tooltip;e.CONTROLS_IF_MSG_IF=n.block.CONTROLS_IF_MSG_IF,e.CONTROLS_IF_MSG_THEN=n.block.CONTROLS_IF_MSG_THEN,e.CONTROLS_IF_MSG_ELSE=n.block.CONTROLS_IF_MSG_ELSE,e.CONTROLS_IF_MSG_ELSEIF=n.block.CONTROLS_IF_MSG_ELSEIF,e.CONTROLS_IF_TOOLTIP_1=s.CONTROLS_IF_TOOLTIP_1,e.CONTROLS_IF_TOOLTIP_2=s.CONTROLS_IF_TOOLTIP_2,e.CONTROLS_IF_TOOLTIP_3=s.CONTROLS_IF_TOOLTIP_3,e.CONTROLS_IF_TOOLTIP_4=s.CONTROLS_IF_TOOLTIP_4,(0,r.installBuiltinHelpInfo)(t);const o="logic_compare",a=pxt.blocks.getBlockDefinition(o).tooltip;e.LOGIC_COMPARE_TOOLTIP_EQ=a.LOGIC_COMPARE_TOOLTIP_EQ,e.LOGIC_COMPARE_TOOLTIP_NEQ=a.LOGIC_COMPARE_TOOLTIP_NEQ,e.LOGIC_COMPARE_TOOLTIP_LT=a.LOGIC_COMPARE_TOOLTIP_LT,e.LOGIC_COMPARE_TOOLTIP_LTE=a.LOGIC_COMPARE_TOOLTIP_LTE,e.LOGIC_COMPARE_TOOLTIP_GT=a.LOGIC_COMPARE_TOOLTIP_GT,e.LOGIC_COMPARE_TOOLTIP_GTE=a.LOGIC_COMPARE_TOOLTIP_GTE,(0,r.installBuiltinHelpInfo)(o);const l="logic_operation",c=pxt.blocks.getBlockDefinition(l),u=c.tooltip;e.LOGIC_OPERATION_AND=c.block.LOGIC_OPERATION_AND,e.LOGIC_OPERATION_OR=c.block.LOGIC_OPERATION_OR,e.LOGIC_OPERATION_TOOLTIP_AND=u.LOGIC_OPERATION_TOOLTIP_AND,e.LOGIC_OPERATION_TOOLTIP_OR=u.LOGIC_OPERATION_TOOLTIP_OR,(0,r.installBuiltinHelpInfo)(l);const d="logic_negate",p=pxt.blocks.getBlockDefinition(d);e.LOGIC_NEGATE_TITLE=p.block.LOGIC_NEGATE_TITLE,(0,r.installBuiltinHelpInfo)(d);const h="logic_boolean",f=pxt.blocks.getBlockDefinition(h);e.LOGIC_BOOLEAN_TRUE=f.block.LOGIC_BOOLEAN_TRUE,e.LOGIC_BOOLEAN_FALSE=f.block.LOGIC_BOOLEAN_FALSE,(0,r.installBuiltinHelpInfo)(h)}},{"../help":72,blockly:176}],6:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initLoops=void 0;const i=e("blockly"),r=e("../help"),s=e("../plugins/duplicateOnDrag");n.initLoops=function(){const e=i.Msg,t="controls_repeat_ext",n=pxt.blocks.getBlockDefinition(t);e.CONTROLS_REPEAT_TITLE=n.block.CONTROLS_REPEAT_TITLE,e.CONTROLS_REPEAT_INPUT_DO=n.block.CONTROLS_REPEAT_INPUT_DO,(0,r.installBuiltinHelpInfo)(t);const o="device_while",a=pxt.blocks.getBlockDefinition(o);i.Blocks[o]={init:function(){this.jsonInit({message0:a.block.message0,args0:[{type:"input_value",name:"COND",check:"Boolean"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops")}),this.appendStatementInput("DO").appendField(a.block.appendField),(0,r.setBuiltinHelpInfo)(this,o)}};const l="pxt_controls_for",c=pxt.blocks.getBlockDefinition(l);i.Blocks[l]={init:function(){this.jsonInit({message0:c.block.message0,args0:[{type:"input_value",name:"VAR",variable:c.block.variable,check:"Variable"},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(c.block.appendField);let e=this;(0,r.setHelpResources)(this,l,c.name,function(){return pxt.U.rlf(c.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")},c.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){const n=this.getField("VAR");i.Names.equals(e,n.getText())&&n.setValue(t)}},(0,s.setDuplicateOnDrag)(l,"VAR");const u="controls_simple_for",d=pxt.blocks.getBlockDefinition(u);i.Blocks[u]={init:function(){this.jsonInit({message0:d.block.message0,args0:[{type:"field_variable",name:"VAR",variable:d.block.variable,variableTypes:[""]},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(d.block.appendField);let e=this;(0,r.setHelpResources)(this,u,d.name,function(){return pxt.U.rlf(d.tooltip,e.getField("VAR").getText())},d.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){const n=this.getField("VAR");i.Names.equals(e,n.getText())&&n.setValue(t)},customContextMenu:function(e){var t,n;if(!this.isCollapsed()&&!(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly)){let t={enabled:!0},n=this.getField("VAR").getText();t.text=lf("Create 'get {0}'",n);let r=i.utils.xml.createElement("field");r.textContent=n,r.setAttribute("name","VAR");let s=i.utils.xml.createElement("block");s.setAttribute("type","variables_get"),s.appendChild(r),t.callback=i.ContextMenu.callbackFactory(this,s),e.push(t)}}};const p=pxt.blocks.getBlockDefinition(ts.pxtc.TS_BREAK_TYPE);i.Blocks[pxtc.TS_BREAK_TYPE]={init:function(){const e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:p.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,r.setHelpResources)(this,ts.pxtc.TS_BREAK_TYPE,p.name,p.tooltip,p.url,e,void 0,void 0,!1)}};const h=pxt.blocks.getBlockDefinition(ts.pxtc.TS_CONTINUE_TYPE);i.Blocks[pxtc.TS_CONTINUE_TYPE]={init:function(){const e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:h.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,r.setHelpResources)(this,ts.pxtc.TS_CONTINUE_TYPE,h.name,h.tooltip,h.url,e,void 0,void 0,!1)}};const f="#cccccc";i.Blocks[pxtc.COLLAPSED_BLOCK]={init:function(){this.jsonInit({message0:"...",inputsInline:!0,previousStatement:null,nextStatement:null,colour:f}),(0,r.setHelpResources)(this,ts.pxtc.COLLAPSED_BLOCK,"...",lf("a few blocks"),void 0,f,void 0,void 0,!1)}};const m="pxt_controls_for_of",g=pxt.blocks.getBlockDefinition(m);i.Blocks[m]={init:function(){this.jsonInit({message0:g.block.message0,args0:[{type:"input_value",name:"VAR",variable:g.block.variable,check:"Variable"},{type:"input_value",name:"LIST",check:["Array","String"]}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(g.block.appendField);let e=this;(0,r.setHelpResources)(this,m,g.name,function(){return pxt.Util.rlf(g.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")},g.url,String(pxt.toolbox.getNamespaceColor("loops")))}},(0,s.setDuplicateOnDrag)(m,"VAR");const _="controls_for_of",y=pxt.blocks.getBlockDefinition(_);i.Blocks[_]={init:function(){this.jsonInit({message0:y.block.message0,args0:[{type:"field_variable",name:"VAR",variable:y.block.variable,variableTypes:[""]},{type:"input_value",name:"LIST",check:"Array"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(y.block.appendField);let e=this;(0,r.setHelpResources)(this,_,y.name,function(){return pxt.Util.rlf(y.tooltip,e.getField("VAR").getText())},y.url,String(pxt.toolbox.getNamespaceColor("loops")))}}}},{"../help":72,"../plugins/duplicateOnDrag":92,blockly:176}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initMathRoundBlock=n.initMathOpBlock=n.initMath=void 0;const i=e("blockly"),r=e("../help"),s=e("../constants"),o=e("../composableMutations"),a=e("../fields/field_dropdown");function l(){const e=pxt.blocks.MATH_FUNCTIONS.unary.concat(pxt.blocks.MATH_FUNCTIONS.binary).concat(pxt.blocks.MATH_FUNCTIONS.infix),t="math_js_op",n=pxt.blocks.getBlockDefinition(t);function l(e,t){const n=e.appendValueInput("ARG"+(t?1:0));n.setCheck("Number"),t&&(n.connection.setShadowDom(function(){if(!c){c=document.createElement("shadow"),c.setAttribute("type","math_number");const e=document.createElement("field");e.setAttribute("name","NUM"),e.textContent="0",c.appendChild(e)}return c}()),n.connection.respawnShadow_())}function u(e,t){let n=!!e.getInput("ARG1");t?(n&&e.moveInputBefore("op_dropdown","ARG1"),e.moveInputBefore("ARG0","op_dropdown")):(n&&e.moveInputBefore("ARG0","ARG1"),e.moveInputBefore("op_dropdown","ARG0"))}i.Blocks[t]={init:function(){const t=this;t.setPreviousStatement(!1),t.setNextStatement(!1),t.setOutput(!0,"Number"),t.setOutputShape(s.provider.SHAPES.ROUND),t.setInputsInline(!0);t.appendDummyInput("op_dropdown").appendField(new a.FieldDropdown(e.map(e=>[n.block[e],e]),e=>function(e,t){!function(e){return-1!==pxt.blocks.MATH_FUNCTIONS.unary.indexOf(e)}(t)?e.getInput("ARG1")||l(e,!0):e.removeInput("ARG1",!0);return u(e,function(e){return-1!==pxt.blocks.MATH_FUNCTIONS.infix.indexOf(e)}(t)),t}(t,e)),"OP"),l(t,!1),(0,o.appendMutation)(t,{mutationToDom:e=>{let n;for(let e=0;e<t.inputList.length;e++){const i=t.inputList[e];if("op_dropdown"===i.name){n=!1;break}if("ARG0"===i.name){n=!0;break}}return e.setAttribute("op-type",(t.getInput("ARG1")?n?"infix":"binary":"unary").toString()),e},domToMutation:e=>{if(e.hasAttribute("op-type")){const n=e.getAttribute("op-type");"unary"!=n&&l(t,!0),u(t,"infix"===n)}}})}},(0,r.installHelpResources)(t,n.name,function(e){return n.tooltip[e.getFieldValue("OP")]},n.url,pxt.toolbox.getNamespaceColor(n.category))}let c;function u(){const e=pxt.blocks.ROUNDING_FUNCTIONS,t="math_js_round",n=pxt.blocks.getBlockDefinition(t);i.Blocks[t]={init:function(){const t=this;t.setPreviousStatement(!1),t.setNextStatement(!1),t.setOutput(!0,"Number"),t.setOutputShape(s.provider.SHAPES.ROUND),t.setInputsInline(!0);t.appendDummyInput("round_dropdown").appendField(new a.FieldDropdown(e.map(e=>[n.block[e],e])),"OP"),function(e){const t=e.appendValueInput("ARG0");t.setCheck("Number")}(t)}},(0,r.installHelpResources)(t,n.name,function(e){return n.tooltip[e.getFieldValue("OP")]},n.url,pxt.toolbox.getNamespaceColor(n.category))}n.initMath=function(e){const t="math_op2",n=pxt.blocks.getBlockDefinition(t),o=n.tooltip;i.Blocks[t]={init:function(){this.jsonInit({message0:lf("%1 of %2 and %3"),args0:[{type:"field_dropdown",name:"op",options:[[lf("{id:op}min"),"min"],[lf("{id:op}max"),"max"]]},{type:"input_value",name:"x",check:"Number"},{type:"input_value",name:"y",check:"Number"}],inputsInline:!0,output:"Number",outputShape:s.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,r.setHelpResources)(this,t,n.name,function(e){return o[e.getFieldValue("op")]},n.url,pxt.toolbox.getNamespaceColor(n.category))},codeCard:(0,r.attachCardInfo)(e,"Math.min")};const a="math_op3",c=pxt.blocks.getBlockDefinition(a);i.Blocks[a]={init:function(){this.jsonInit({message0:c.block.message0,args0:[{type:"input_value",name:"x",check:"Number"}],inputsInline:!0,output:"Number",outputShape:s.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,r.setBuiltinHelpInfo)(this,a)},codeCard:(0,r.attachCardInfo)(e,"Math.abs")},["math_number","math_integer","math_whole_number","math_number_minmax"].forEach(e=>{const t=pxt.blocks.getBlockDefinition(e);(0,r.installHelpResources)(e,t.name,t.tooltip,t.url,"#fff","#fff","#fff")});const d=i.Msg,p="math_arithmetic",h=pxt.blocks.getBlockDefinition(p),f=h.tooltip;d.MATH_ADDITION_SYMBOL=h.block.MATH_ADDITION_SYMBOL,d.MATH_SUBTRACTION_SYMBOL=h.block.MATH_SUBTRACTION_SYMBOL,d.MATH_MULTIPLICATION_SYMBOL=h.block.MATH_MULTIPLICATION_SYMBOL,d.MATH_DIVISION_SYMBOL=h.block.MATH_DIVISION_SYMBOL,d.MATH_POWER_SYMBOL=h.block.MATH_POWER_SYMBOL,(0,r.installHelpResources)(p,h.name,function(e){return f[e.getFieldValue("OP")]},h.url,pxt.toolbox.getNamespaceColor(h.category));const m="math_modulo",g=pxt.blocks.getBlockDefinition(m);d.MATH_MODULO_TITLE=g.block.MATH_MODULO_TITLE,(0,r.installBuiltinHelpInfo)(m),l(),u()},n.initMathOpBlock=l,n.initMathRoundBlock=u},{"../composableMutations":17,"../constants":18,"../fields/field_dropdown":34,"../help":72,blockly:176}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initOnStart=void 0;const i=e("blockly"),r=e("../fields"),s=e("../help");n.initOnStart=function(){const e=pxt.blocks.getBlockDefinition(ts.pxtc.ON_START_TYPE);if(i.Blocks[ts.pxtc.ON_START_TYPE]={init:function(){var t;let n=null===(t=pxt.appTarget.runtime)||void 0===t?void 0:t.onStartColor;n&&(n=pxt.toolbox.getAccessibleBackground(n)),this.jsonInit({message0:e.block.message0,args0:[{type:"input_dummy"},{type:"input_statement",name:"HANDLER"}],colour:n||pxt.toolbox.getNamespaceColor("loops")}),(0,s.setHelpResources)(this,ts.pxtc.ON_START_TYPE,e.name,e.tooltip,e.url,n||pxt.toolbox.getNamespaceColor("loops"),void 0,void 0,!!pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable)}},i.Blocks[pxtc.TS_STATEMENT_TYPE]={init:function(){let e,t,n=this;n.setColour("#717171"),n.setPreviousStatement(!0),n.setNextStatement(!0),n.setInputsInline(!1),n.domToMutation=e=>{const i=parseInt(e.getAttribute("numlines"));n.declaredVariables=e.getAttribute("declaredvars"),t=[];for(let n=0;n<i;n++){const i=e.getAttribute("line"+n);t.push(i)}n.setPythonEnabled(!1)},n.mutationToDom=()=>{let e=document.createElement("mutation");return t&&(t.forEach((t,n)=>e.setAttribute("line"+n,t)),e.setAttribute("numlines",t.length.toString())),n.declaredVariables&&e.setAttribute("declaredvars",this.declaredVariables),e},n.setPythonEnabled=i=>{if(e!==i){for(;n.inputList.length;)n.removeInput(n.inputList[0].name);e=i,i?(n.appendDummyInput().appendField(pxt.Util.lf("<python code>"),"LINE0"),n.setTooltip(lf("A Python statement that could not be converted to blocks"))):(t.forEach((e,t)=>{n.appendDummyInput().appendField(e,"LINE"+t)}),n.setTooltip(lf("A JavaScript statement that could not be converted to blocks")))}},n.getLines=()=>t,n.setEditable(!1),(0,s.setHelpResources)(this,pxtc.TS_STATEMENT_TYPE,lf("JavaScript statement"),lf("A JavaScript statement that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},i.Blocks[pxtc.TS_OUTPUT_TYPE]={init:function(){let e=this;e.setColour("#717171"),e.setPreviousStatement(!1),e.setNextStatement(!1),e.setOutput(!0),e.setEditable(!1),e.appendDummyInput().appendField(new r.FieldTsExpression(""),"EXPRESSION"),e.setPythonEnabled=t=>{e.getField("EXPRESSION").setPythonEnabled(t),t?e.setTooltip(lf("A Python expression that could not be converted to blocks")):e.setTooltip(lf("A JavaScript expression that could not be converted to blocks"))},(0,s.setHelpResources)(e,pxtc.TS_OUTPUT_TYPE,lf("JavaScript expression"),lf("A JavaScript expression that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock){const e=pxt.appTarget.runtime.pauseUntilBlock,t=pxt.blocks.getBlockDefinition(ts.pxtc.PAUSE_UNTIL_TYPE);i.Blocks[pxtc.PAUSE_UNTIL_TYPE]={init:function(){const n=e.color||pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:t.block.message0,args0:[{type:"input_value",name:"PREDICATE",check:"Boolean"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:n}),(0,s.setHelpResources)(this,ts.pxtc.PAUSE_UNTIL_TYPE,t.name,t.tooltip,t.url,n,void 0,void 0,!1)}}}}},{"../fields":70,"../help":72,blockly:176}],9:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initText=void 0;const i=e("blockly"),r=e("../help"),s=e("../constants");n.initText=function(){const e=pxt.blocks.getBlockDefinition("text");(0,r.installHelpResources)("text",e.name,e.tooltip,e.url,"#fff","#fff","#fff");const t="text_length",n=pxt.blocks.getBlockDefinition(t);i.Msg.TEXT_LENGTH_TITLE=n.block.TEXT_LENGTH_TITLE,i.Blocks[t].init=function(){this.jsonInit({message0:i.Msg.TEXT_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String"]}],output:"Number",outputShape:s.provider.SHAPES.ROUND})},(0,r.installBuiltinHelpInfo)(t);const o="text_join",a=pxt.blocks.getBlockDefinition(o);i.Msg.TEXT_JOIN_TITLE_CREATEWITH=a.block.TEXT_JOIN_TITLE_CREATEWITH,(0,r.installBuiltinHelpInfo)(o)}},{"../constants":18,"../help":72,blockly:176}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initVariables=n.CREATE_VAR_BTN_ID=void 0;const i=e("blockly"),r=e("../toolbox"),s=e("../help");function o(e,t){let s=[];if(!pxt.appTarget.appTheme.hideFlyoutHeadings){const e=(0,r.createFlyoutHeadingLabel)(lf("Variables"),pxt.toolbox.getNamespaceColor("variables"),pxt.toolbox.getNamespaceIcon("variables"));s.push(e)}const o=document.createElement("button");o.setAttribute("text",lf("Make a Variable...")),o.setAttribute("callbackKey","CREATE_VARIABLE"),o.setAttribute("id",n.CREATE_VAR_BTN_ID),e.registerButtonCallback("CREATE_VARIABLE",function(e){i.Variables.createVariableButtonHandler(e.getTargetWorkspace())}),s.push(o);const a=i.Variables.flyoutCategoryBlocks(e);return s=s.concat(a),s}n.CREATE_VAR_BTN_ID="create-variable-btn",n.initVariables=function(){let e=lf("{id:var}item");i.Variables.flyoutCategory=o,i.Variables.flyoutCategoryBlocks=function(e){let t=e.getVariableMap().getVariablesOfType(""),n=[];if(t.length>0){let e=t[t.length-1];t.sort(i.Variables.compareByName);for(let e=0;e<t.length;e++){const s=t[e];if(i.Blocks.variables_get){const e=(0,r.mkVariableFieldBlock)("variables_get",s.getId(),s.getType(),s.getName(),!1);e.setAttribute("gap","8"),n.push(e)}}if(n[n.length-1].setAttribute("gap","24"),(i.Blocks.variables_change||i.Blocks.variables_set)&&n.unshift((0,r.createFlyoutGroupLabel)(lf("Your Variables"))),i.Blocks.variables_change){let t=i.Blocks.variables_get?20:8;const s=(0,r.mkVariableFieldBlock)("variables_change",e.getId(),e.getType(),e.getName(),!1);s.setAttribute("gap",t+"");{let e=i.utils.xml.createElement("value");e.setAttribute("name","VALUE");let t=i.utils.xml.createElement("shadow");t.setAttribute("type","math_number"),e.appendChild(t);let n=i.utils.xml.createElement("field");n.setAttribute("name","NUM"),n.appendChild(document.createTextNode("1")),t.appendChild(n),s.appendChild(e)}n.unshift(s)}if(i.Blocks.variables_set){let t=i.Blocks.variables_change?8:24;const s=(0,r.mkVariableFieldBlock)("variables_set",e.getId(),e.getType(),e.getName(),!1);s.setAttribute("gap",t+"");{let e=i.utils.xml.createElement("value");e.setAttribute("name","VALUE");let t=i.utils.xml.createElement("shadow");t.setAttribute("type","math_number"),e.appendChild(t);let n=i.utils.xml.createElement("field");n.setAttribute("name","NUM"),n.appendChild(document.createTextNode("0")),t.appendChild(n),s.appendChild(e)}n.unshift(s)}}return n};const t=i.Msg,n="variables_get",a=pxt.blocks.getBlockDefinition(n);t.VARIABLES_GET_CREATE_SET=a.block.VARIABLES_GET_CREATE_SET,i.Blocks[n]={init:function(){this.jsonInit({type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]}),(0,s.setBuiltinHelpInfo)(this,n)}},(0,s.installBuiltinHelpInfo)("variables_get_reporter"),t.RENAME_VARIABLE=lf("Rename variable..."),t.DELETE_VARIABLE=lf('Delete the "%1" variable'),t.DELETE_VARIABLE_CONFIRMATION=lf('Delete %1 uses of the "%2" variable?'),t.NEW_VARIABLE_DROPDOWN=lf("New variable...");const l="variables_set",c=pxt.blocks.getBlockDefinition(l);t.VARIABLES_SET=c.block.VARIABLES_SET,t.VARIABLES_DEFAULT_NAME=e,t.VARIABLES_SET_CREATE_GET=lf("Create 'get %1'"),i.Blocks[l]={init:function(){this.jsonInit({type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}),(0,s.setBuiltinHelpInfo)(this,l)}};const u="variables_change",d=pxt.blocks.getBlockDefinition(u);i.Blocks[u]={init:function(){this.jsonInit({message0:d.block.message0,args0:[{type:"field_variable",name:"VAR",variable:e,variableTypes:[""]},{type:"input_value",name:"VALUE",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("variables")}),(0,s.setBuiltinHelpInfo)(this,u)},customContextMenu:function(e){var t,n;if(!(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly)&&!this.isInFlyout){let t={enabled:this.workspace.remainingCapacity()>0},n=this.getField("VAR").getText();t.text=lf("Create 'get {0}'",n);let r=i.utils.xml.createElement("field");r.textContent=n,r.setAttribute("name","VAR");let s=i.utils.xml.createElement("block");s.setAttribute("type","variables_get"),s.appendChild(r),t.callback=i.ContextMenu.callbackFactory(this,s),e.push(t)}}},t.NEW_VARIABLE_TITLE=lf("New variable name:"),t.RENAME_VARIABLE_TITLE=lf("Rename all '%1' variables to:")}},{"../help":72,"../toolbox":140,blockly:176}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.renderCodeCard=void 0;const i=e("./render");n.renderCodeCard=function(e,t={}){const n=e.url?/^[^:]+:\/\//.test(e.url)?e.url:"/"+e.url.replace(/^\.?\/?/,""):e.youTubeId?`https://youtu.be/${e.youTubeId}`:void 0,r=!!n,s=(e,t,n="div",i="")=>{let r=document.createElement(n);return t&&(r.className=t),e&&e.appendChild(r),i&&r.appendChild(document.createTextNode(i+"")),r};let o=s(null,"ui "+(e.style||"card")+" "+(e.color||"")+(r?" link":""),r?"a":"div");if(t.role&&o.setAttribute("role",t.role),"option"===t.role&&o.setAttribute("aria-selected","true"),r){const e=o;e.href=n,/^https?:\/\//.test(n)&&(e.target="_blank")}if(!t.hideHeader&&e.header){let t=s(o,"ui content "+(e.responsive?" tall desktop only":""));e.header&&s(t,"description","span",e.header)}const a=(t.shortName?e.shortName:"")||e.name;let l=s(o,"ui image"+(e.responsive?" tall landscape only":""));if(e.label){let t=document.createElement("label");t.className=`ui ${e.labelClass?e.labelClass:"orange right ribbon"} label`,t.textContent=e.label,l.appendChild(t)}if(e.blocksXml){const t=(0,i.render)(e.blocksXml);if(t){let e=s(l,"");e.setAttribute("style","width:100%; min-height:10em"),e.appendChild(t)}else pxt.error("failed to render blocks"),pxt.debug(e.blocksXml)}if(e.typeScript){let t=document.createElement("pre");t.appendChild(document.createTextNode(e.typeScript)),l.appendChild(t)}if(e.imageUrl||(e.youTubeId?`https://img.youtube.com/vi/${e.youTubeId}/0.jpg`:void 0)){let t=document.createElement("div");t.className="ui imagewrapper";let n=document.createElement("div");n.className="ui cardimage",n.style.backgroundImage=`url("${e.imageUrl}")`,n.title=a,n.setAttribute("role","presentation"),t.appendChild(n),l.appendChild(t)}if("file"==e.cardType){let e=s(o,"ui fileimage");l.appendChild(e)}if(a||e.description){let t=s(o,"ui content");if(a&&(o.setAttribute("aria-label",a),s(t,"header","div",a)),e.description){const n=s(t,"ui description"),i=/((?:\.{1,3})|[\!\?])/.exec(e.description);let r=e.description+".";if(i){const t=i[1];r=e.description.split(t)[0]+t}n.appendChild(document.createTextNode(r))}}if(e.time){let t=s(o,"meta");if(e.time){s(t,"date","span").appendChild(document.createTextNode(pxt.Util.timeSince(e.time)))}}if(e.extracontent){s(o,"extra content","div").appendChild(document.createTextNode(e.extracontent))}return o}},{"./render":138}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.workerOpAsync=n.compileExpression=n.AUTO_DISABLED_REASON=n.callKey=n.compileAsync=n.compileBlockAsync=n.PXT_WARNING_ID=void 0;const i=e("blockly"),r=e("./environment"),s=e("./typeChecker"),o=e("./util"),a=e("../toolbox"),l=e("../legacyMutations"),c=e("./variables"),u=e("../fields");function d(e,t){if(e.type===ts.pxtc.ON_START_TYPE)return 0;const n=t.stdCallTable[e.type],i=p(t,e),r=1+ts.pxtc.Util.codalHash16(i);return n&&n.attrs.afterOnStart?r:-r}function p(e,t){if(t.type==ts.pxtc.ON_START_TYPE)return JSON.stringify({name:ts.pxtc.ON_START_TYPE});if(t.type==ts.pxtc.FUNCTION_DEFINITION_TYPE)return JSON.stringify({type:"function",name:t.getFieldValue("function_name")});return JSON.stringify(h(t)).replace(/"id"\s*:\s*"[^"]+"/g,"")}function h(e){const t=[],n=[];for(const r of e.inputList){for(const e of r.fieldRow)e.name&&t.push(e.getText());r.type===i.inputs.inputTypes.VALUE&&(r.connection.targetBlock()?n.push(h(r.connection.targetBlock())):n.push(null))}return{type:e.type,fields:t,inputs:n}}function f(e,t){e.setDisabledReason(!t,n.AUTO_DISABLED_REASON);const i=e.getDescendants(!1);for(const e of i)e.setDisabledReason(!t,n.AUTO_DISABLED_REASON)}function m(e){e.setDisabledReason(!1,n.AUTO_DISABLED_REASON),e.setDisabledReason(!1,i.constants.MANUALLY_DISABLED),e.setDisabledReason(!1,"ORPHANED_BLOCK")}function g(e,t){if(t.isInsertionMarker())return[];let n;const i=[];switch(e.stats[t.type]=(e.stats[t.type]||0)+1,S(t,i),t.type){case"controls_if":n=function(e,t,n){let i=[];for(let r=0;r<=t.elseifCount_;++r){let s=_(e,(0,o.getInputTargetBlock)(e,t,"IF"+r),n),a=y(e,(0,o.getInputTargetBlock)(e,t,"DO"+r)),l=pxt.blocks.mkText("if (");r>0&&(l=pxt.blocks.mkText("else if ("),l.glueToBlock=pxt.blocks.GlueMode.WithSpace),(0,o.append)(i,[l,s,pxt.blocks.mkText(")"),a])}if(t.elseCount_){let n=pxt.blocks.mkText("else");n.glueToBlock=pxt.blocks.GlueMode.WithSpace,(0,o.append)(i,[n,y(e,(0,o.getInputTargetBlock)(e,t,"ELSE"))])}return i}(e,t,i);break;case"pxt_controls_for":case"controls_for":case"controls_simple_for":n=function(e,t,n){let i=(0,o.getInputTargetBlock)(e,t,"TO"),r=(0,o.getInputTargetBlock)(e,t,"DO"),a=(0,o.getInputTargetBlock)(e,t,"BY"),l=(0,o.getInputTargetBlock)(e,t,"FROM"),c=!a||a.type.match(/^math_number/)&&1==B(a),u=(0,s.lookup)(e,t,(0,o.getLoopVariableField)(e,t).getField("VAR").getText());return[pxt.blocks.mkText("for (let "+u.escapedName+" = "),l?_(e,l,n):pxt.blocks.mkText("0"),pxt.blocks.mkText("; "),pxt.blocks.mkInfix(pxt.blocks.mkText(u.escapedName),"<=",_(e,i,n)),pxt.blocks.mkText("; "),c?pxt.blocks.mkText(u.escapedName+"++"):pxt.blocks.mkInfix(pxt.blocks.mkText(u.escapedName),"+=",_(e,a,n)),pxt.blocks.mkText(")"),y(e,r)]}(e,t,i);break;case"pxt_controls_for_of":case"controls_for_of":n=function(e,t,n){let i,r=(0,o.getInputTargetBlock)(e,t,"LIST"),a=(0,o.getInputTargetBlock)(e,t,"DO");i=r&&"placeholder"!==r.type?_(e,r,n):pxt.blocks.mkText("[0]");let l=(0,s.lookup)(e,t,(0,o.getLoopVariableField)(e,t).getField("VAR").getText());return[pxt.blocks.mkText("for (let "+l.escapedName+" of "),i,pxt.blocks.mkText(")"),y(e,a)]}(e,t,i);break;case"variables_set":n=[v(e,t,i)];break;case"variables_change":n=[T(e,t,i)];break;case"controls_repeat_ext":n=function(e,t,n){let i=_(e,(0,o.getInputTargetBlock)(e,t,"TIMES"),n),r=y(e,(0,o.getInputTargetBlock)(e,t,"DO")),a=n=>!(0,s.lookup)(e,t,n),l="index";for(let e=2;!a(l);e++)l="index"+e;return[pxt.blocks.mkText("for (let "+l+" = 0; "),pxt.blocks.mkInfix(pxt.blocks.mkText(l),"<",i),pxt.blocks.mkText("; "+l+"++)"),r]}(e,t,i);break;case"device_while":n=function(e,t,n){let i=_(e,(0,o.getInputTargetBlock)(e,t,"COND"),n),r=y(e,(0,o.getInputTargetBlock)(e,t,"DO"));return[pxt.blocks.mkText("while ("),i,pxt.blocks.mkText(")"),r]}(e,t,i);break;case"procedures_defnoreturn":n=function(e,t){const n=(0,o.escapeVarName)(t.getFieldValue("NAME"),e,!0),i=(0,o.getInputTargetBlock)(e,t,"STACK");return[pxt.blocks.mkText("function "+n+"() "),y(e,i)]}(e,t);break;case"function_definition":n=function(e,t){const n=(0,o.escapeVarName)(t.getField("function_name").getText(),e,!0),i=(0,o.getInputTargetBlock)(e,t,"STACK"),r=t.getArguments().map(n=>{if("Array"==n.type){const i=(0,s.lookup)(e,t,n.name),r=(0,s.getConcreteType)(i.type),a=(null==r?void 0:r.type)&&"Array"!==r.type?r.type:"any[]";return`${(0,o.escapeVarName)(n.name,e)}: ${a}`}return`${(0,o.escapeVarName)(n.name,e)}: ${n.type}`}),a=(0,s.isFunctionRecursive)(e,t,!1);return[pxt.blocks.mkText(`function ${n} (${r.join(", ")})${a?": any":""}`),y(e,i)]}(e,t);break;case"procedures_callnoreturn":n=[A(e,t,i)];break;case"function_call":n=[N(e,t,i,!0)];break;case pxtc.TS_RETURN_STATEMENT_TYPE:n=[D(e,t,i)];break;case ts.pxtc.ON_START_TYPE:n=function(e,t){const n=(0,o.getInputTargetBlock)(e,t,"HANDLER"),i=y(e,n);pxt.appTarget.compile&&pxt.appTarget.compile.onStartText&&i&&i.children&&i.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText(`// ${pxtc.ON_START_COMMENT}\n`)));return i}(e,t).children;break;case pxtc.TS_STATEMENT_TYPE:n=function(e,t){return t.getLines().map(e=>pxt.blocks.mkText(e+"\n"))}(0,t);break;case pxtc.PAUSE_UNTIL_TYPE:n=function(e,t,n){const i=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock;pxt.U.assert(!!i,"target has block enabled");const r=i.namespace,s=i.callName||"pauseUntil",o=R(e,t,{definitionName:"PREDICATE",actualName:"PREDICATE"},n),a=[pxt.blocks.mkGroup([pxt.blocks.mkText("() => "),o])];return r?[pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(r,s,a,!1))]:[pxt.blocks.mkStmt(pxt.blocks.H.mkCall(s,a,!1,!1))]}(e,t,i);break;case pxtc.TS_DEBUGGER_TYPE:n=function(e,t){if("1"==t.getFieldValue("ON_OFF"))return[pxt.blocks.mkText("debugger;\n")];return[]}(0,t);break;case pxtc.TS_BREAK_TYPE:n=[pxt.blocks.mkText("break;\n")];break;case pxtc.TS_CONTINUE_TYPE:n=[pxt.blocks.mkText("continue;\n")];break;default:n=e.stdCallTable[t.type]?[O(e,t,i)]:[pxt.blocks.mkStmt(_(e,t,i))]}let r=n[n.length-1];return r&&!r.id&&(r.id=t.id),i.length&&function(e,t){const n=[];for(const t of e)for(const e of t.split("\n"))n.push(pxt.blocks.mkText(`// ${e}`)),n.push(pxt.blocks.mkNewLine());for(const e of n.reverse())t.unshift(e)}(i,n),n.forEach(e=>{!(e.type===pxt.blocks.NT.Block||e.type===pxt.blocks.NT.Prefix&&pxt.Util.startsWith(e.op,"//"))||t.type==pxtc.ON_START_TYPE&&e.id||(e.id=t.id)}),n}function _(e,t,n){let i;if(pxt.U.assert(null!=t),e.stats[t.type]=(e.stats[t.type]||0)+1,S(t,n),"placeholder"!=t.type&&t.isEnabled&&t.isEnabled())switch(t.type){case"math_number":case"math_integer":case"math_whole_number":case"math_number_minmax":i=$(e,t,n);break;case"math_op2":i=function(e,t,n){let i=t.getFieldValue("op"),r=_(e,(0,o.getInputTargetBlock)(e,t,"x"),n),s=_(e,(0,o.getInputTargetBlock)(e,t,"y"),n);return pxt.blocks.H.mathCall(i,[r,s])}(e,t,n);break;case"math_op3":i=function(e,t,n){let i=_(e,(0,o.getInputTargetBlock)(e,t,"x"),n);return pxt.blocks.H.mathCall("abs",[i])}(e,t,n);break;case"math_arithmetic":case"logic_compare":case"logic_operation":i=function(e,t,n){let i=t.getFieldValue("OP"),r=(0,o.getInputTargetBlock)(e,t,"A"),a=(0,o.getInputTargetBlock)(e,t,"B"),l=[_(e,r,n),_(e,a,n)];c=i,-1!==["LT","LTE","GT","GTE","EQ","NEQ"].indexOf(c)&&M(e,r)&&M(e,a)&&pxt.blocks.flattenNode([l[0]]).output!==pxt.blocks.flattenNode([l[1]]).output&&(l=l.map(e=>pxt.blocks.H.mkParenthesizedExpression(pxt.blocks.mkGroup([e,pxt.blocks.mkText(" as any")]))));var c;const u=(0,s.returnType)(e,r);if((0,s.isStringType)(u)){if("EQ"==i)return pxt.blocks.H.mkSimpleCall("==",l);if("NEQ"==i)return pxt.blocks.H.mkSimpleCall("!=",l)}else if((0,s.isBooleanType)(u))return pxt.blocks.H.mkSimpleCall(I[i],l);return pxt.U.assert(i in I),pxt.blocks.H.mkSimpleCall(I[i],l)}(e,t,n);break;case"math_modulo":i=function(e,t,n){let i=(0,o.getInputTargetBlock)(e,t,"DIVIDEND"),r=(0,o.getInputTargetBlock)(e,t,"DIVISOR"),s=[_(e,i,n),_(e,r,n)];return pxt.blocks.H.mkSimpleCall("%",s)}(e,t,n);break;case"logic_boolean":i=function(e,t){return pxt.blocks.H.mkBooleanLiteral("TRUE"==t.getFieldValue("BOOL"))}(0,t);break;case"logic_negate":i=function(e,t,n){let i=_(e,(0,o.getInputTargetBlock)(e,t,"BOOL"),n);return pxt.blocks.mkPrefix("!",[pxt.blocks.H.mkParenthesizedExpression(i)])}(e,t,n);break;case"variables_get":case"variables_get_reporter":i=function(e,t){const n=t.getField("VAR").getText();let i=(0,s.lookup)(e,t,n);if(!i)return pxt.blocks.mkText(n);i.firstReference||(i.firstReference=t);return pxt.U.assert(null!=i&&null!=i.type),pxt.blocks.mkText(i.escapedName)}(e,t);break;case"text":i=function(e,t){return pxt.blocks.H.mkStringLiteral(t.getFieldValue("TEXT"))}(0,t);break;case"text_join":i=function(e,t,n){let i,r=0;for(;;){const s=(0,o.getInputTargetBlock)(e,t,"ADD"+r);if(r++,!s){if(r<t.inputList.length)continue;break}const a=_(e,s,n);i=i?pxt.blocks.H.mkSimpleCall("+",[i,a]):0===s.type.indexOf("text")?a:pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),a])}if(!i)return pxt.blocks.H.mkStringLiteral("");return i}(e,t,n);break;case"lists_create_with":i=function(e,t,n){let i=t.inputList.map(t=>t.connection&&t.connection.targetBlock()?_(e,t.connection.targetBlock(),n):void 0).filter(e=>!!e);return pxt.blocks.H.mkArrayLiteral(i,!t.getInputsInline())}(e,t,n);break;case"lists_index_get":i=function(e,t,n){const i=(0,o.getInputTargetBlock)(e,t,"LIST"),r=_(e,i,n),s=_(e,(0,o.getInputTargetBlock)(e,t,"INDEX"),n);return pxt.blocks.mkGroup([r,pxt.blocks.mkText("["),s,pxt.blocks.mkText("]")])}(e,t,n);break;case"lists_index_set":i=function(e,t,n){const i=(0,o.getInputTargetBlock)(e,t,"LIST"),r=_(e,i,n),s=_(e,(0,o.getInputTargetBlock)(e,t,"INDEX"),n),a=_(e,(0,o.getInputTargetBlock)(e,t,"VALUE"),n),l=pxt.blocks.mkGroup([r,pxt.blocks.mkText("["),s,pxt.blocks.mkText("] = "),a]);return"lists_create_with"===i.type?b(l):l}(e,t,n);break;case"math_js_op":case"math_js_round":i=function(e,t,n){const i=t.getFieldValue("OP"),r=[_(e,(0,o.getInputTargetBlock)(e,t,"ARG0"),n)];t.getInput("ARG1")&&r.push(_(e,(0,o.getInputTargetBlock)(e,t,"ARG1"),n));return pxt.blocks.H.mathCall(i,r)}(e,t,n);break;case pxtc.TS_OUTPUT_TYPE:i=function(e,t){return pxt.blocks.mkText(t.getFieldValue("EXPRESSION").trim())}(0,t);break;case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":i=function(e,t){const n=(0,o.escapeVarName)(t.getFieldValue("VALUE"),e);return pxt.blocks.mkText(n)}(e,t);break;case"function_call_output":i=N(e,t,n,!1);break;default:let r=e.stdCallTable[t.type];r?i=r.imageLiteral?x(e,t,r.imageLiteral,r.imageLiteralColumns,r.imageLiteralRows,r.namespace,r.f,(0,o.visibleParams)(r,(0,o.countOptionals)(t,r)).map(i=>R(e,t,i,n))):L(e,t,r,n):(pxt.reportError("blocks","unable to compile expression",{details:t.type}),i=(0,s.defaultValueForType)((0,s.returnType)(e,t)))}else{if("Array"===(0,s.find)((0,s.returnType)(e,t)).type){let n="lists_index_get"===t.getParent().type;if(!n){const i=e.stdCallTable[t.getParent().type];n=i&&i.isExpression}const r=pxt.blocks.mkText("[0]");i=n?r:b(r)}else i=(0,s.defaultValueForType)((0,s.returnType)(e,t))}return i.id=t.id,i}function y(e,t){let n=[],i=t;for(;t;)t.isEnabled()&&(0,o.append)(n,g(e,t)),t=t.getNextBlock();return i&&e.blockDeclarations[i.id]&&e.blockDeclarations[i.id].filter(e=>!e.alreadyDeclared).forEach(t=>{n.unshift(C(t,e.blocksInfo)),t.alreadyDeclared=r.BlockDeclarationType.Implicit}),pxt.blocks.mkBlock(n)}function b(e){const t=pxt.blocks.mkStmt(pxt.blocks.mkText(";"));return t.glueToBlock=pxt.blocks.GlueMode.NoSpace,pxt.blocks.mkGroup([t,e])}function v(e,t,n){let i=(0,o.getInputTargetBlock)(e,t,"VALUE"),a=(0,s.lookup)(e,t,t.getField("VAR").getText());let l=e.idToScope[t.id].declaredVars[a.name]===a&&!a.firstReference&&!a.alreadyDeclared;l&&(0,o.forEachChildExpression)(t,t=>{if("variables_get"===t.type){(0,s.lookup)(e,t,t.getField("VAR").getText())===a&&(l=!1)}},!0);let c=_(e,i,n),u=a.escapedName+" = ";if(a.isAssigned=!0,l){a.alreadyDeclared=r.BlockDeclarationType.Assigned;const t=(0,s.getConcreteType)(a.type);if(u=`let ${a.escapedName} = `,t){const n=(0,s.getConcreteType)((0,s.returnType)(e,i));t.type!==n.type&&(u=`let ${a.escapedName}: ${t.type} = `)}}else a.firstReference||(a.firstReference=t);return pxt.blocks.mkStmt(pxt.blocks.mkText(u),c)}function T(e,t,n){let i=(0,o.getInputTargetBlock)(e,t,"VALUE"),r=(0,s.lookup)(e,t,t.getField("VAR").getText()),a=_(e,i,n),l=pxt.blocks.mkText(r.escapedName);return pxt.blocks.mkStmt(pxt.blocks.mkInfix(l,"+=",a))}function k(e,t,n,i,r,a){const c=i.map(n=>R(e,t,n,a)),u=(0,o.getInputTargetBlock)(e,t,"HANDLER"),d=y(e,u);let p;if(pxt.appTarget.compile&&pxt.appTarget.compile.emptyEventHandlerComments&&0===d.children.length&&d.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText(`// ${pxtc.HANDLER_COMMENT}`))),(0,o.isMutatingBlock)(t)&&t.mutation.getMutationType()===l.MutatorTypes.ObjectDestructuringMutator)p=t.mutation.compileMutation(e,a);else if(n.comp.handlerArgs.length){let i=(0,s.getEscapedCBParameters)(t,n,e);p=pxt.blocks.mkText(`function (${i.join(", ")})`)}let h=r,f=n.f;if(n.attrs.blockAliasFor){const t=e.blocksInfo.apis.byQName[n.attrs.blockAliasFor];t&&(f=t.name,h=t.namespace)}return function(e,t,n,i,r,s,o=!1){let a;return r.noFinalNewline=!0,a=s?pxt.blocks.mkGroup([s,r]):pxt.blocks.mkGroup([pxt.blocks.mkText("function ()"),r]),o?pxt.blocks.mkStmt(pxt.blocks.H.extensionCall(n,i.concat([a]),!1)):t?pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(t,n,i.concat([a]),!1)):pxt.blocks.mkStmt(pxt.blocks.H.mkCall(n,i.concat([a]),!1))}(0,h,f,c,d,p,n.isExtensionMethod)}function x(e,t,n,i,r,s,o,a){a=void 0===a?[]:a;let l="\n";r=r||5,i=(i||5)*n;let c=t.getFieldValue("LEDS");c=c.replace(/[ `\n]+/g,"");for(let e=0;e<r;++e){for(let t=0;t<i;++t)t>0&&(l+=" "),l+="#"===c[e*i+t]?"#":".";l+="\n"}let u=pxt.blocks.H.mkStringLiteral(l);return u.canIndentInside=!0,pxt.blocks.H.namespaceCall(s,o,[u].concat(a),!1)}function E(e,t,n){let i=pxt.blocks.flattenNode(t);return U("format",{format:{input:i.output,pos:1}}).then(()=>({source:i.output,sourceMap:i.sourceMap,stats:e.stats,diagnostics:n||[]}))}function S(e,t){var n;const i=null===(n=e.getCommentText)||void 0===n?void 0:n.call(e);i&&t.push(i)}function C(e,t){const n=(0,s.getConcreteType)(e.type);let i;i="Array"===n.type?pxt.blocks.mkText("[]"):(0,s.defaultValueForType)(n);let r="";if("null"==i.op||"[]"==i.op){let e=n.type;"Array"!==e&&"null[]"!==e||(e="number[]");let s=t.apis.byQName[e];s&&s.attributes.autoCreate?i=pxt.blocks.mkText(s.attributes.autoCreate+"()"):r=": "+e}return pxt.blocks.mkStmt(pxt.blocks.mkText("let "+e.escapedName+r+" = "),i)}function w(e,t,n,i,r){const s=a(e,r.x,r.x+r.width)||a(r.x,e,e+n),o=a(t,r.y,r.y+r.height)||a(r.y,t,t+i);return s&&o;function a(e,t,n){return e>=t&&e<=n}}n.PXT_WARNING_ID="WARNING_MESSAGE",n.compileBlockAsync=function(e,t){const n=e.workspace,i=(0,r.mkEnv)(n,t);(0,s.infer)(n&&n.getAllBlocks(!1),i,n);const o=g(i,e);return i.placeholders={},E(i,o)},n.compileAsync=function(e,t,l={}){const u=(0,r.mkEnv)(e,t,l),[h,_]=function(e,t,l){try{let n=t.getAllBlocks(!1);pxt.react.getTilemapProject&&pxt.react.getTilemapProject().removeInactiveBlockAssets(n.map(e=>e.id));let u=t.getTopBlocks(!0);u=u.sort((t,n)=>d(t,e)-d(n,e)),function(e,t,n){const r=i.Events.isEnabled();r&&i.Events.disable();t.forEach(m);const s={};function a(e,t){s[e]?f(t,!1):(f(t,!0),s[e]=t)}n.forEach(t=>{const n=e.stdCallTable[t.type];if(t.type==ts.pxtc.ON_START_TYPE)a(ts.pxtc.ON_START_TYPE,t);else{if((0,o.isFunctionDefinition)(t)||n&&n.attrs.blockAllowMultiple&&!n.attrs.handlerStatement&&!n.attrs.forceStatement)return;if(n&&n.hasHandler&&!n.attrs.handlerStatement&&!n.attrs.forceStatement){a(n.attrs.blockHandlerKey||p(e,t),t)}else{let e=t;for(;e;)f(t,!1),e=e.getNextBlock()}}}),r&&i.Events.enable()}(e,n,u),n=n.filter(e=>e.isEnabled()),u=u.filter(e=>e.isEnabled()),(0,c.trackAllVariables)(u,e),(0,s.infer)(n,e,t);const h=[],_=function(e,t){if(!e.length||e.some(e=>!e.rendered))return{orphans:t,idToComments:{}};const n=e.map(e=>{const t=e.getBoundingRectangle(),n=e.getHeightWidth();return{id:e.id,x:t.left,y:t.top,width:n.width,height:n.height}}),i={orphans:[],idToComments:{}},r=20;for(const e of t){const t=e.getBoundingRectangle(),s=e.getSize(),o=t.left,a=t.top;let l;for(const e of n)(w(o,a,s.width,s.height,e)||!l&&w(o-r,a-r,s.width+2*r,s.height+2*r,e))&&(l=e);l?(i.idToComments[l.id]||(i.idToComments[l.id]=[]),i.idToComments[l.id].push(e)):i.orphans.push(e)}return i}(u,t.getTopComments(!0));_.orphans.forEach(e=>(0,o.append)(h,P(e).children)),u.forEach(t=>{if(_.idToComments[t.id]&&_.idToComments[t.id].forEach(e=>{(0,o.append)(h,P(e).children)}),t.type==ts.pxtc.ON_START_TYPE)(0,o.append)(h,g(e,t));else{const n=pxt.blocks.mkBlock(g(e,t));n.type==pxt.blocks.NT.Block?(0,o.append)(h,n.children):h.push(n)}});const y=[];e.enums.forEach(e=>{const n=t.getVariableMap().getVariablesOfType(e.name);if(n&&n.length){const t=n.map(e=>{const t=/^(\d+)([^0-9].*)$/.exec(e.getName());return t?[t[2],parseInt(t[1])]:[e.getName(),-1]});t.sort((e,t)=>e[1]-t[1]);const i=[];let r=-1;t.forEach(([t,n],s)=>{let o;if(e.isBitMask){const e=Math.log2(n);e>=0&&Math.floor(e)===e&&(o=pxt.blocks.H.mkAssign(pxt.blocks.mkText(t),pxt.blocks.H.mkSimpleCall("<<",[pxt.blocks.H.mkNumberLiteral(1),pxt.blocks.H.mkNumberLiteral(e)])))}else if(e.isHash){const e=ts.pxtc.Util.codalHash16(t.toLowerCase());o=pxt.blocks.H.mkAssign(pxt.blocks.mkText(t),pxt.blocks.H.mkNumberLiteral(e))}o||(o=n===r+1?pxt.blocks.mkText(t):pxt.blocks.H.mkAssign(pxt.blocks.mkText(t),pxt.blocks.H.mkNumberLiteral(n))),i.push(o),r=n});const s=pxt.blocks.mkCommaSep(i,!0);s.glueToBlock=pxt.blocks.GlueMode.NoSpace,y.push(pxt.blocks.mkGroup([pxt.blocks.mkText(`enum ${e.name}`),pxt.blocks.mkBlock([s])]))}}),e.kinds.forEach(e=>{const n=t.getVariableMap().getVariablesOfType("KIND_"+e.name);if(n&&n.length){const t=n.map(e=>e.getName()).filter(t=>-1===e.initialMembers.indexOf(t));t.length&&y.push(pxt.blocks.mkGroup([pxt.blocks.mkText(`namespace ${e.name}`),pxt.blocks.mkBlock(t.map(t=>pxt.blocks.mkStmt(pxt.blocks.mkText(`export const ${t} = ${e.name}.${e.createFunctionName}()`))))]))}});const b=e.allVariables.filter(e=>!e.alreadyDeclared).map(e=>C(e,l));return e.allVariables.filter(e=>e.alreadyDeclared===r.BlockDeclarationType.Implicit&&!e.isAssigned).forEach(t=>{const n=(0,s.getConcreteType)(t.type);"string"===n.type||"number"===n.type||"boolean"===n.type||(0,a.isArrayType)(n.type)||e.diagnostics.push({blockId:t.firstReference&&t.firstReference.id,message:lf("Variable '{0}' is never assigned",t.name)})}),[y.concat(b.concat(h)),e.diagnostics]}catch(t){let i=t.block;if(!i)throw t;i.setWarningText(t+"",n.PXT_WARNING_ID),e.errors.push(i)}finally{e.placeholders={}}return[null,null]}(u,e,t);return E(u,h,_)},n.callKey=p,n.AUTO_DISABLED_REASON="pxt_automatic_disabled",n.compileExpression=_;let I={ADD:"+",MINUS:"-",MULTIPLY:"*",DIVIDE:"/",LT:"<",LTE:"<=",GT:">",GTE:">=",AND:"&&",OR:"||",EQ:"==",NEQ:"!=",POWER:"**"};function A(e,t,n){const i=(0,o.escapeVarName)(t.getFieldValue("NAME"),e,!0);return pxt.blocks.mkStmt(pxt.blocks.mkText(i+"()"))}function N(e,t,n,i){const r=(0,o.escapeVarName)(t.getField("function_name").getText(),e,!0),s=!t.getInputsInline(),a=t.getArguments().map(e=>({actualName:e.name,definitionName:e.id})).map(i=>R(e,t,i,n)),l=pxt.blocks.H.stdCall(r,a,s);return i?pxt.blocks.mkStmt(l):l}function D(e,t,n){const i=(0,o.getInputTargetBlock)(e,t,"RETURN_VALUE");return i&&"placeholder"!=i.type?pxt.blocks.mkStmt(pxt.blocks.mkText("return "),_(e,i,n)):pxt.blocks.mkStmt(pxt.blocks.mkText("return"))}function O(e,t,n){const i=e.stdCallTable[t.type];return i.imageLiteral?pxt.blocks.mkStmt(x(0,t,i.imageLiteral,i.imageLiteralColumns,i.imageLiteralRows,i.namespace,i.f,(0,o.visibleParams)(i,(0,o.countOptionals)(t,i)).map(i=>R(e,t,i,n)))):i.hasHandler?k(e,t,i,function(e,t){return(0,o.visibleParams)(e,(0,o.countOptionals)(t,e)).filter(e=>!!e.definitionName)}(i,t),i.namespace,n):pxt.blocks.mkStmt(L(e,t,i,n))}function R(e,t,n,r,a=!1){let l=t.getFieldValue(n.definitionName);if(null!=l){const r=t.getField(n.definitionName);if(r instanceof i.FieldTextInput||r instanceof u.FieldTextInput)return pxt.blocks.H.mkStringLiteral(l);if(r instanceof u.FieldTilemap&&!r.isGreyBlock){const t=pxt.react.getTilemapProject(),n=r.getValue();if(n.startsWith("tilemap`"))return pxt.blocks.mkText(n);if(e.options.emitTilemapLiterals)try{const e=pxt.sprite.decodeTilemap(n,"typescript",t);if(e){const[n]=t.createNewTilemapFromData(e);return pxt.blocks.mkText(`tilemap\`${n}\``)}}catch(e){}}const s=e.blocksInfo.apis.byQName[n.type];if(s&&s.attributes.emitAsConstant)for(const t of Object.keys(e.blocksInfo.apis.byQName)){const n=e.blocksInfo.apis.byQName[t];if(n&&n.attributes&&n.attributes.enumIdentity===l)return pxt.blocks.mkText(t)}let o=pxt.blocks.mkText(l);return o.canIndentInside="string"==typeof l&&l.indexOf("\n")>=0,o}{(0,s.attachPlaceholderIf)(e,t,n.definitionName);const i=(0,o.getInputTargetBlock)(e,t,n.definitionName);return a&&"lists_create_with"===i.type?b(_(e,i,r)):n.shadowOptions&&n.shadowOptions.toString&&!(0,s.isStringType)((0,s.returnType)(e,i))?pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),pxt.blocks.H.mkParenthesizedExpression(_(e,i,r))]):_(e,i,r)}}function L(e,t,n,i){let r;if((0,o.isMutatingBlock)(t)&&t.mutation.getMutationType()===l.MutatorTypes.RestParameterMutator)r=t.mutation.compileMutation(e,i).children;else{if("ENUM_GET"===n.attrs.shim){const e=n.attrs.enumName,i=t.getFieldValue("MEMBER").replace(/^\d+/,"");return pxt.blocks.H.mkPropertyAccess(i,pxt.blocks.mkText(e))}if("KIND_GET"===n.attrs.shim){const i=e.kinds.filter(e=>e.blockId===n.attrs.blockId)[0];return pxt.blocks.H.mkPropertyAccess(t.getFieldValue("MEMBER"),pxt.blocks.mkText(i.name))}r=(0,o.visibleParams)(n,(0,o.countOptionals)(t,n)).map((r,s)=>R(e,t,r,i,n.isExtensionMethod&&0===s&&!n.isExpression))}let s=n.namespace,a=n.f;if(n.attrs.blockAliasFor){const t=e.blocksInfo.apis.byQName[n.attrs.blockAliasFor];t&&(a=t.name,s=t.namespace)}const c=!t.getInputsInline();if(n.isIdentity)return r[0];if(n.property)return pxt.blocks.H.mkPropertyAccess(a,r[0]);if("@get@"==a)return pxt.blocks.H.mkPropertyAccess(r[1].op.replace(/.*\./,""),r[0]);if("@set@"==a)return pxt.blocks.H.mkAssign(pxt.blocks.H.mkPropertyAccess(r[1].op.replace(/.*\./,"").replace(/@set/,""),r[0]),r[2]);if("@change@"==a)return pxt.blocks.H.mkSimpleCall("+=",[pxt.blocks.H.mkPropertyAccess(r[1].op.replace(/.*\./,"").replace(/@set/,""),r[0]),r[2]]);if(n.isExtensionMethod){if(n.attrs.defaultInstance){let s;(0,o.isMutatingBlock)(t)&&t.mutation.getMutationType()===l.MutatorTypes.DefaultInstanceMutator&&(s=t.mutation.compileMutation(e,i)),s?r.unshift(s):r.unshift(pxt.blocks.mkText(n.attrs.defaultInstance))}return pxt.blocks.H.extensionCall(a,r,c)}return s?pxt.blocks.H.namespaceCall(s,a,r,c):pxt.blocks.H.stdCall(a,r,c)}function P(e){const t=e.getText();return pxt.blocks.H.mkMultiComment(t.trim())}function M(e,t){return F(e,t)||"logic_boolean"===t.type||"text"===t.type}function F(e,t){if(!t)return!1;if("math_number"===t.type||"math_integer"===t.type||"math_number_minmax"===t.type||"math_whole_number"===t.type)return!0;const n=e.stdCallTable[t.type];if(!n)return!1;const{comp:i}=n;if("TD_ID"===n.attrs.shim&&1===i.parameters.length){const n=t.getFieldValue(i.parameters[0].definitionName);return n?!isNaN(parseInt(n)):F(e,(0,o.getInputTargetBlock)(e,t,i.parameters[0].definitionName))}return!1}function B(e){let t=e.getFieldValue("math_number_minmax"===e.type?"SLIDER":"NUM");const n=parseFloat(t);return function(e,t){isFinite(e)&&!isNaN(e)||function(e,t){let n=new Error(e);throw n.block=t,n}(lf("Number entered is either too large or too small"),t)}(n,e),n}function $(e,t,n){return pxt.blocks.H.mkNumberLiteral(B(t))}function U(e,t){return pxt.worker.getWorker(pxt.webConfig.workerjs).opAsync(e,t)}n.workerOpAsync=U},{"../fields":70,"../legacyMutations":76,"../toolbox":140,"./environment":13,"./typeChecker":14,"./util":15,"./variables":16,blockly:176}],13:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mkEnv=n.emptyEnv=n.BlockDeclarationType=n.Point=void 0;const i=e("./util");function r(e,t){return{workspace:e,options:t,stdCallTable:{},userFunctionReturnValues:{},diagnostics:[],errors:[],renames:{oldToNew:{},takenNames:{},oldToNewFunctions:{}},stats:{},enums:[],kinds:[],idToScope:{},blockDeclarations:{},allVariables:[],blocksInfo:null,placeholders:{}}}n.Point=class{constructor(e,t,n,i,r){this.link=e,this.type=t,this.parentType=n,this.childType=i,this.isArrayType=r}},function(e){e[e.None=0]="None",e[e.Argument=1]="Argument",e[e.Assigned=2]="Assigned",e[e.Implicit=3]="Implicit"}(n.BlockDeclarationType||(n.BlockDeclarationType={})),n.emptyEnv=r,n.mkEnv=function(e,t,n={}){let s=r(e,n);return s.blocksInfo=t,t&&(Object.keys(t.apis.byQName).forEach(e=>{const n=t.apis.byQName[e];!n.pkg||6!==n.kind&&3!==n.kind&&5!==n.kind&&4!==n.kind||(s.renames.takenNames[n.qName]=!0)}),t.enumsByName&&Object.keys(t.enumsByName).forEach(e=>s.enums.push(t.enumsByName[e])),t.kindsByName&&Object.keys(t.kindsByName).forEach(e=>s.kinds.push(t.kindsByName[e])),t.blocks.forEach(e=>{if(s.stdCallTable[e.attributes.blockId])return void pxt.reportError("blocks","function already defined",{details:e.attributes.blockId,qualifiedName:e.qName,packageName:e.pkg});s.renames.takenNames[e.namespace]=!0;const t=pxt.blocks.compileInfo(e),n=!!t.thisParameter;s.stdCallTable[e.attributes.blockId]={namespace:e.namespace,f:e.name,comp:t,attrs:e.attributes,isExtensionMethod:n,isExpression:e.retType&&"void"!==e.retType,imageLiteral:e.attributes.imageLiteral||e.attributes.gridLiteral,imageLiteralColumns:e.attributes.imageLiteralColumns,imageLiteralRows:e.attributes.imageLiteralRows,hasHandler:pxt.blocks.hasHandler(e),property:!e.parameters,isIdentity:"TD_ID"==e.attributes.shim}}),e.getTopBlocks(!1).filter(i.isFunctionDefinition).forEach(e=>{const t="procedures_defnoreturn"===e.type?e.getFieldValue("NAME"):e.getField("function_name").getText();(0,i.escapeVarName)(t,s,!0)})),s}},{"./util":15}],14:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isBooleanType=n.isStringType=n.defaultValueForType=n.getEscapedCBParameters=n.isFunctionRecursive=n.getDeclaredVariables=n.lookup=n.getConcreteType=n.attachPlaceholderIf=n.returnType=n.find=n.mkPoint=n.infer=void 0;const i=e("./environment"),r=e("./util"),s=e("../plugins/functions"),o=e("./compiler"),a=e("../loader");function l(e,t){let n=g(e),i=g(t);if(A(null==n.link&&null==i.link),n==i)return;if(_(n))return void v(e.type,t.type);if(_(i))return v(e.type,t.type),e.type=null,e.link=i,n.link=i,void(n.isArrayType=i.isArrayType);if(n.childType&&i.childType){const e=n.childType;n.childType=null,l(e,i.childType)}else n.childType&&!i.childType&&(i.childType=n.childType);if(n.parentType&&i.parentType){const e=n.parentType;n.parentType=null,l(e,i.parentType)}else!n.parentType||i.parentType||i.type||(i.parentType=n.parentType);let r=v(n.type,i.type);e.link=i,n.link=i,n.isArrayType=i.isArrayType,e.type=null,t.type=r}function c(e,t,n,i){k(e,t,n);try{l(y(e,(0,r.getInputTargetBlock)(e,t,n)),i)}catch(e){}}function u(e,t=!1){return new i.Point(null,e,null,null,t)}n.infer=function(e,t,n){function i(e){var t,n;const i=null===(n=null===(t=e.connection)||void 0===t?void 0:t.getCheck())||void 0===n?void 0:n[0];return e.name?i||"T":void 0}function s(e,n){let s=e.inputList.filter(e=>"T"===i(e));if(s.length){const i=(0,r.getInputTargetBlock)(t,e,s[0].name);if(i){const r=y(t,i),s=r.type?m(y(t,i).type+"[]"):m(null);return x(s,r),c(t,e,n,s),!0}}return!1}e&&e.filter(e=>e.isEnabled()).forEach(e=>{try{switch(e.type){case"math_op2":c(t,e,"x",m(d.type)),c(t,e,"y",m(d.type));break;case"math_op3":c(t,e,"x",m(d.type));break;case"math_arithmetic":case"logic_compare":switch(e.getFieldValue("OP")){case"ADD":case"MINUS":case"MULTIPLY":case"DIVIDE":case"LT":case"LTE":case"GT":case"GTE":case"POWER":c(t,e,"A",m(d.type)),c(t,e,"B",m(d.type));break;case"AND":case"OR":k(t,e,"A",p.type),k(t,e,"B",p.type);break;case"EQ":case"NEQ":k(t,e,"A"),k(t,e,"B");let n=y(t,(0,r.getInputTargetBlock)(t,e,"A")),i=y(t,(0,r.getInputTargetBlock)(t,e,"B"));try{l(n,i)}catch(e){}}break;case"logic_operation":k(t,e,"A",p.type),k(t,e,"B",p.type);break;case"logic_negate":k(t,e,"BOOL",p.type);break;case"controls_if":for(let n=0;n<=e.elseifCount_;++n)k(t,e,"IF"+n,p.type);break;case"pxt_controls_for":case"controls_simple_for":c(t,e,"TO",m(d.type));break;case"pxt_controls_for_of":case"controls_for_of":const n=(0,r.getInputTargetBlock)(t,e,"LIST");if(n&&"placeholder"!==n.type){const i=y(t,n);x(i,S(t,e,(0,r.getLoopVariableField)(t,e).getField("VAR").getText()).type)}else t.diagnostics.push({blockId:e.id,message:lf("The 'for of' block must have a list input")});break;case"variables_set":case"variables_change":let o=S(t,e,e.getField("VAR").getText()).type;k(t,e,"VALUE");let a=(0,r.getInputTargetBlock)(t,e,"VALUE");if(a){let e=function(e,t){var n;const i=null===(n=t.outputConnection)||void 0===n?void 0:n.getCheck();if(!(null==i?void 0:i.length)||"Array"===i[0]||"T"===i[0])return[y(e,t)];return i.map(e=>m(e))}(t,a);const n=g(o);if(n.type&&e.slice(1).some(e=>e.type===n.type))o.link=g(e[0]);else try{l(o,e[0])}catch(e){}}break;case"controls_repeat_ext":c(t,e,"TIMES",m(d.type));break;case"device_while":k(t,e,"COND",p.type);break;case"lists_index_get":c(t,e,"LIST",m("Array")),c(t,e,"INDEX",m(d.type));const u=y(t,(0,r.getInputTargetBlock)(t,e,"LIST"));x(u,y(t,e));break;case"lists_index_set":c(t,e,"LIST",m("Array")),k(t,e,"VALUE"),s(e,"LIST"),c(t,e,"INDEX",m(d.type));break;case"function_definition":b(t,e.getField("function_name").getText());break;case"function_call":case"function_call_output":e.getArguments().forEach(n=>{c(t,e,n.id,m(n.type))});break;case pxtc.TS_RETURN_STATEMENT_TYPE:k(t,e,"RETURN_VALUE");break;case pxtc.PAUSE_UNTIL_TYPE:c(t,e,"PREDICATE",p);break;default:if(e.type in t.stdCallTable){const n=t.stdCallTable[e.type];if("ENUM_GET"===n.attrs.shim||"KIND_GET"===n.attrs.shim)return;(0,r.visibleParams)(n,(0,r.countOptionals)(e,n)).forEach((r,o)=>{var a;const l=n.isExtensionMethod&&0===o;if(r.definitionName&&!e.getFieldValue(r.definitionName)){let n=e.inputList.find(e=>e.name==r.definitionName);const o=null===(a=null==n?void 0:n.connection)||void 0===a?void 0:a.getCheck();if(o){if(l&&"Array"===i(n)){if(s(e,r.definitionName))return}for(let n=0;n<o.length;n++)try{let i=o[n];c(t,e,r.definitionName,m(i));break}catch(e){}}}})}}}catch(n){const i=n.block||e;i.setWarningText(n+"",o.PXT_WARNING_ID),t.errors.push(i)}}),t.allVariables.forEach(e=>{null==E(e.type).type&&(e.isFunctionParameter?e.type.isArrayType&&(e.type.type="any[]"):l(e.type,m(e.type.isArrayType?"number[]":d.type)))})},n.mkPoint=u;const d=u("number"),p=u("boolean"),h=u("string"),f=u("void");function m(e){if(!e)return u(e);switch(e.toLowerCase()){case"number":return d;case"boolean":return p;case"string":return h;case"void":return f;default:return u(e)}}function g(e){return e.link?g(e.link):e}function _(e){return e===d||e===p||e===h||e===f}function y(e,t){var n,i;if(A(null!=t),function(e){return"placeholder"==e.type||e.type===pxtc.TS_OUTPUT_TYPE}(t))return t.p||(t.p=u(null)),g(t.p);if("variables_get"==t.type)return g(S(e,t,t.getField("VAR").getText()).type);if("function_call_output"==t.type)return function(e,t){const n=t.getField("function_name").getText();return b(e,n)}(e,t);if(!t.outputConnection)return m(f.type);const r=(null===(i=null===(n=t.outputConnection)||void 0===n?void 0:n.getCheck())||void 0===i?void 0:i[0])||"T";if("Array"===r){const n=t.outputConnection.getCheck();if(n.length>1)return m(n[1]);let i;if("lists_create_with"==t.type){if(t.inputList&&t.inputList.length)for(const n of t.inputList)if(n.connection&&n.connection.targetBlock()){let t=g(y(e,n.connection.targetBlock()));if(t){if(t.parentType)return t.parentType;i=t.type?m(t.type+"[]"):u(null),x(i,t);break}}}else"argument_reporter_array"==t.type&&(i||(i=S(e,t,t.getFieldValue("VALUE")).type));return i&&(i.isArrayType=!0),i||u(null,!0)}if("T"===r){const n=e.stdCallTable[t.type],i="lists_index_get"===t.type;if(i||n&&n.comp.thisParameter){let r;if(r=i?t.inputList.find(e=>"LIST"===e.name):t.inputList.find(e=>e.name===n.comp.thisParameter.definitionName),r.connection&&r.connection.targetBlock()){const t=y(e,r.connection.targetBlock());if(t.childType)return t.childType;const n=T(t.type)&&"Array"!==t.type?u(t.type.substr(0,t.type.length-2)):u(null);return x(t,n),n}}return u(null)}return m(r)}function b(e,t){if(!e.userFunctionReturnValues[t]){const n=(0,s.getDefinition)(t,e.workspace);let i=u("void");if(w(e,n,!0))i=u("any");else{const s=[];for(const t of n.getDescendants(!1))"function_return"===t.type&&(k(e,t,"RETURN_VALUE"),s.push(y(e,(0,r.getInputTargetBlock)(e,t,"RETURN_VALUE"))));if(s.length)try{const e=u(null);for(const t of s)l(e,t);i=e}catch(r){e.diagnostics.push({blockId:n.id,message:pxt.Util.lf("Function '{0}' has an invalid return type",t)}),i=u("any")}}e.userFunctionReturnValues[t]=i}return e.userFunctionReturnValues[t]}function v(e,t){if(null==e||"Array"===e&&T(t))return t;if(null==t||"Array"===t&&T(e))return e;if(e==t)return e;throw new Error("cannot mix "+e+" with "+t)}function T(e){return e&&(-1!==e.indexOf("[]")||"Array"==e)}function k(e,t,n,i){const r=t.getInputTargetBlock(n);r?r.type!==pxtc.TS_OUTPUT_TYPE||r.p||(r.p=u(null)):(e.placeholders[t.id]||(e.placeholders[t.id]={}),e.placeholders[t.id][n]||(e.placeholders[t.id][n]=function(e,t,n){return{type:"placeholder",p:u(n||null),workspace:e.workspace,parentBlock_:t,getParent:()=>t}}(e,t,i)))}function x(e,t){const n=g(e),i=g(t);n.childType?l(n.childType,i):n.type||(n.childType=i),i.parentType?l(i.parentType,n):i.type||(i.parentType=n),T(n.type)&&(n.isArrayType=!0)}function E(e,t=[]){const n=g(e);if(-1===t.indexOf(n)&&(t.push(n),!n.type||"Array"===n.type)){if(n.parentType){const e=E(n.parentType,t);if(e.type&&"Array"!==e.type)return T(e.type)?n.type=e.type.substr(0,e.type.length-2):n.type=e.type,n}if(n.childType){const e=E(n.childType,t);if(e.type)return n.type=e.type+"[]",n}}return n}function S(e,t,n){return C(n,e.idToScope[t.id])}function C(e,t){return t&&t.declaredVars[e]?t.declaredVars[e]:t&&t.parent?C(e,t.parent):null}function w(e,t,n){const i=(0,r.getFunctionName)(t),o={};return function t(a){let l;l=n?a.getDescendants(!1).filter(e=>"function_return"==e.type).map(t=>(0,r.getInputTargetBlock)(e,t,"RETURN_VALUE")).filter(e=>e&&"function_call_output"===e.type):a.getDescendants(!1).filter(e=>"function_call_output"==e.type);for(const e of l){const n=(0,r.getFunctionName)(e);if(n===i)return!0;if(!o[n]&&(o[n]=!0,t((0,s.getDefinition)(n,e.workspace))))return!0}return!1}(t)}function I(e,t,n){let i=[];if(t.attrs.draggableParameters)for(let s=0;s<t.comp.handlerArgs.length;s++){const o=t.comp.handlerArgs[s];let l;const c=(0,r.getInputTargetBlock)(n,e,a.DRAGGABLE_PARAM_INPUT_PREFIX+o.name);if(l="reporter"===t.attrs.draggableParameters?c&&c.getFieldValue("VALUE"):c&&c.getField("VAR").getText(),null==l)break;i.push({name:l,type:u(o.type)})}else for(let n=0;n<t.comp.handlerArgs.length;n++){const r=t.comp.handlerArgs[n],s=e.getField("HANDLER_"+r.name),o=s&&s.getText();if(null===o)break;i.push({name:o,type:u(r.type)})}return i}function A(e){if(!e)throw new Error("Assertion failure")}n.find=g,n.returnType=y,n.attachPlaceholderIf=k,n.getConcreteType=E,n.lookup=S,n.getDeclaredVariables=function(e,t){switch(e.type){case"pxt_controls_for":case"controls_simple_for":return[{name:(0,r.getLoopVariableField)(t,e).getField("VAR").getText(),type:d}];case"pxt_controls_for_of":case"controls_for_of":return[{name:(0,r.getLoopVariableField)(t,e).getField("VAR").getText(),type:u(null)}];case"function_definition":return e.getArguments().filter(e=>"Array"===e.type).map(e=>{const t=u(null);return t.isArrayType=!0,{name:e.name,type:t,isFunctionParameter:!0}})}if((0,r.isMutatingBlock)(e)){const t=e.mutation.getDeclaredVariables();if(t)return Object.keys(t).map(e=>({name:e,type:u(t[e])}))}let n=t.stdCallTable[e.type];return n&&n.comp.handlerArgs.length?I(e,n,t):[]},n.isFunctionRecursive=w,n.getEscapedCBParameters=function(e,t,n){return I(e,t,n).map(t=>S(n,e,t.name).escapedName)},n.defaultValueForType=function(e){if(null==e.type&&(l(e,m(d.type)),e=g(e)),T(e.type)||e.isArrayType)return pxt.blocks.mkText("[]");switch(e.type){case"boolean":return pxt.blocks.H.mkBooleanLiteral(!1);case"number":return pxt.blocks.H.mkNumberLiteral(0);case"string":return pxt.blocks.H.mkStringLiteral("");default:return pxt.blocks.mkText("null")}},n.isStringType=function(e){return e===h},n.isBooleanType=function(e){return e===p}},{"../loader":77,"../plugins/functions":112,"./compiler":12,"./environment":13,"./util":15}],15:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isFunctionDefinition=n.append=n.escapeVarName=n.isMutatingBlock=n.getInputTargetBlock=n.countOptionals=n.visibleParams=n.getFunctionName=n.getLoopVariableField=n.printScope=n.forEachStatementInput=n.forEachChildExpression=void 0;const i=e("blockly");function r(e){let t="";for(let n=0;n<e;n++)t+="    ";return t}function s(e,t,n){var i;const r=t.getInputTargetBlock(n);return r||(null===(i=e.placeholders[t.id])||void 0===i?void 0:i[n])}n.forEachChildExpression=function e(t,n,r=!1){t.inputList.filter(e=>e.type===i.inputs.inputTypes.VALUE).forEach(t=>{t.connection&&t.connection.targetBlock()&&(n(t.connection.targetBlock()),r&&e(t.connection.targetBlock(),n,r))})},n.forEachStatementInput=function(e,t){e.inputList.filter(e=>e.type===i.inputs.inputTypes.STATEMENT).forEach(e=>{e.connection&&e.connection.targetBlock()&&t(e.connection.targetBlock())})},n.printScope=function e(t,n=0){const i=Object.keys(t.declaredVars).map(e=>`${e}(${t.declaredVars[e].id})`).join(",");t.referencedVars.join(", "),pxt.log(`${r(n)}SCOPE: ${t.firstStatement?t.firstStatement.type:"TOP-LEVEL"}`),i.length&&pxt.log(`${r(n)}DECS: ${i}`),t.children.forEach(t=>e(t,n+1))},n.getLoopVariableField=function(e,t){return"pxt_controls_for"==t.type||"pxt_controls_for_of"==t.type?s(e,t,"VAR"):t},n.getFunctionName=function(e){return e.getField("function_name").getText()},n.visibleParams=function({comp:e},t){const n=[];return e.thisParameter&&n.push(e.thisParameter),e.parameters.forEach(e=>{e.isOptional&&t>0?(n.push(e),--t):e.isOptional||n.push(e)}),n},n.countOptionals=function(e,t){if(t.attrs.compileHiddenArguments)return t.comp.parameters.reduce((e,t)=>(t.isOptional&&e++,e),0);if(e.mutationToDom){const t=e.mutationToDom();if(t.hasAttribute("_expanded")){const e=parseInt(t.getAttribute("_expanded"));return isNaN(e)?0:Math.max(e,0)}}return 0},n.getInputTargetBlock=s,n.isMutatingBlock=function(e){return!!e.mutation},n.escapeVarName=function(e,t,n=!1){if(!e)return"_";if(n){if(t.renames.oldToNewFunctions[e])return t.renames.oldToNewFunctions[e]}else if(t.renames.oldToNew[e])return t.renames.oldToNew[e];let i=ts.pxtc.escapeIdentifier(e);if(t.renames.takenNames[i]){let e=2;for(;t.renames.takenNames[i+e];)e++;i+=e}return n?(t.renames.oldToNewFunctions[e]=i,t.renames.takenNames[i]=!0):t.renames.oldToNew[e]=i,i},n.append=function(e,t){e.push.apply(e,t)},n.isFunctionDefinition=function(e){return"procedures_defnoreturn"===e.type||"function_definition"===e.type}},{blockly:176}],16:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.trackAllVariables=void 0;const i=e("blockly"),r=e("./environment"),s=e("./typeChecker"),o=e("./util");function a(e,t){const n=Object.keys(e.declaredVars);if(n.length){const i=n.map(t=>e.declaredVars[t]);e.firstStatement&&(t.blockDeclarations[e.firstStatement.id]=i.concat(t.blockDeclarations[e.firstStatement.id]||[])),i.forEach(e=>t.allVariables.push(e))}e.children.forEach(e=>a(e,t))}function l(e,t){let n;if(-1!==e.referencedVars.indexOf(t))return e;for(const i of e.children)if(c(i,t)){if(u(i,t))return e;if(n)return e;n=i}return n?l(n,t):void 0}function c(e,t){if(-1!==e.referencedVars.indexOf(t))return!0;for(const n of e.children)if(c(n,t))return!0;return!1}function u(e,t){if(-1!==e.assignedVars.indexOf(t))return!0;for(const n of e.children)if(u(n,t))return!0;return!1}function d(e,t){for(const t of Object.keys(e.declaredVars)){const i=e.declaredVars[t];i.escapedName||(i.escapedName=n(t))}function n(n){if(!n)return"_";let r=ts.pxtc.escapeIdentifier(n);if(t.renames.takenNames[r]||i(r,e,n)){let s=2;for(;t.renames.takenNames[r+s]||i(r+s,e,n);)s++;r+=s}return r}function i(e,t,n){if(t){for(const i of Object.keys(t.declaredVars)){const r=t.declaredVars[i];if((n!==r.name||r.name!==r.escapedName)&&r.escapedName===e)return!0}return i(e,t.parent,n)}return!1}e.children.forEach(e=>d(e,t))}n.trackAllVariables=function(e,t){let n,c=1;return e.forEach(e=>{if(e.type===ts.pxtc.ON_START_TYPE){const i=e.getInputTargetBlock("HANDLER");i&&(n={firstStatement:i,declaredVars:{},referencedVars:[],children:[],assignedVars:[]},u(i,n,t))}}),n||(n={firstStatement:null,declaredVars:{},referencedVars:[],children:[],assignedVars:[]}),e.forEach(e=>{e.type!==ts.pxtc.ON_START_TYPE&&u(e,n,t)}),Object.keys(n.declaredVars).forEach(e=>{const t=n.declaredVars[e];delete n.declaredVars[e];(l(n,t.id)||n).declaredVars[e]=t}),a(n,t),d(n,t),n;function u(e,t,n){if(n.idToScope[e.id]=t,"variables_get"===e.type){const n=p(e.getField("VAR").getText(),t);t.referencedVars.push(n.id)}else if("variables_set"===e.type||"variables_change"===e.type){const n=p(e.getField("VAR").getText(),t);t.assignedVars.push(n.id),t.referencedVars.push(n.id)}else if(e.type===pxtc.TS_STATEMENT_TYPE){const n=e.declaredVariables;if(n){n.split(",").forEach(e=>{p(e,t).alreadyDeclared=r.BlockDeclarationType.Argument})}}if(function(e){return e.inputList.some(e=>e.type===i.inputs.inputTypes.STATEMENT)}(e)){const i=(0,s.getDeclaredVariables)(e,n).map(e=>Object.assign(Object.assign({},e),{id:c++}));let a=t;i.length&&(a={parent:t,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]},i.forEach(e=>{e.alreadyDeclared=r.BlockDeclarationType.Assigned,a.declaredVars[e.name]=e}),n.idToScope[e.id]=a),t!==a&&t.children.push(a),(0,o.forEachChildExpression)(e,e=>{u(e,a,n)}),(0,o.forEachStatementInput)(e,e=>{const t={parent:a,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]};a.children.push(t),u(e,t,n)})}else(0,o.forEachChildExpression)(e,e=>{u(e,t,n)});e.nextConnection&&e.nextConnection.targetBlock()&&u(e.nextConnection.targetBlock(),t,n)}function p(e,t){return t.declaredVars[e]?t.declaredVars[e]:t.parent?p(e,t.parent):(t.declaredVars[e]={name:e,type:(0,s.mkPoint)(null),id:c++},t.declaredVars[e])}}},{"./environment":13,"./typeChecker":14,"./util":15,blockly:176}],17:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initVariableReporterArgs=n.initExpandableBlock=n.initVariableArgsBlock=n.appendMutation=void 0;const i=e("blockly"),r=e("./toolbox"),s=e("./constants"),o=e("./fields"),a=e("./loader"),l=e("./fields/field_imagenotext"),c=e("./plugins/duplicateOnDrag");function u(e,t){const n=e,i=n.mutationToDom,r=n.domToMutation;n.mutationToDom=()=>{const e=i?i():document.createElement("mutation");return t.mutationToDom(e)},n.domToMutation=e=>{r&&r(e),t.domToMutation(e)}}n.appendMutation=u,n.initVariableArgsBlock=function(e,t){let n=0,r=0,s=e.appendDummyInput(),c=()=>{if(n!==r){if(n>r){const i=n-r;for(let n=0;n<i;n++){const i=t[r+n];s.insertFieldAt(s.fieldRow.length-1,new o.FieldArgumentVariable(i.name),"HANDLER_"+i.name);const a=e;(null==a?void 0:a.initSvg)&&a.initSvg()}}else{let e=r-n;for(let n=0;n<e;n++){const e=t[r-n-1];s.removeField("HANDLER_"+e.name)}}n>=t.length?s.removeField("_HANDLER_ADD"):r>=t.length&&d(),r=n}};function d(){s.appendField(new l.FieldImageNoText(e.ADD_IMAGE_DATAURI,24,24,lf("Add argument"),()=>{n=Math.min(n+1,t.length),c()},!1),"_HANDLER_ADD")}i.Extensions.apply("inline-svgs",e,!1),d(),u(e,{mutationToDom:i=>{i.setAttribute("numArgs",n.toString());for(let r=0;r<n;r++){const n=e.getField("HANDLER_"+t[r].name);let s=n&&n.getText();i.setAttribute("arg"+r,s)}return i},domToMutation:i=>{let r=parseInt(i.getAttribute("numargs"));n=Math.min(isNaN(r)?0:r,t.length),c();for(let r=0;r<n;r++){const n=i.getAttribute("arg"+r),s="HANDLER_"+t[r].name;e.getField(s)&&(0,a.setVarFieldValue)(e,s,n)}}})},n.initExpandableBlock=function(e,t,n,o,a,c){const p="0_add_button",h="0_rem_button",f="0_add_rem_button",m="_expanded",g="_input_init",_=n.parameters.map(e=>e.name),y=n.parameters.length,b=a?y:1,v="variable"===e.blocksById[t.type].attributes.inlineInputMode,T=e.blocksById[t.type].attributes.inlineInputModeLimit||4,k=e.blocksById[t.type].attributes.compileHiddenArguments,x=e.blocksById[t.type].attributes.expandableArgumentBreaks;let E;x&&(E=x.split(/[;,]/).map(e=>parseInt(e)));const S=new d(t);S.setEventsEnabled(!1),S.setValue(m,0),S.setValue(g,!1),S.setEventsEnabled(!0),i.Extensions.apply("inline-svgs",t,!1);let C=!1,w=!0;if(u(t,{mutationToDom:e=>(e.setAttribute(m,S.getString(m)),e.setAttribute(g,S.getString(g)),e),domToMutation:e=>{if(S.setEventsEnabled(!1),e.hasAttribute(g)&&"true"==e.getAttribute(g)&&!S.getBoolean(g)&&S.setValue(g,!0),O(),e.hasAttribute(m)){const n=parseInt(e.getAttribute(m));if(!isNaN(n)){const e=n-(S.getNumber(m)||0);S.getBoolean(g)?t.rendered||t.isInsertionMarker()?A(e,!0,t.isInsertionMarker()):(S.setValue(m,R(e)),D()):A(e,!0)}}S.setEventsEnabled(!0)}}),O(),k){let e=0;for(let i=0;i<t.inputList.length;i++){const r=t.inputList[i];if(pxt.Util.startsWith(r.name,s.optionalInputWithFieldPrefix)||-1!==_.indexOf(r.name)){if(r.connection&&!r.connection.isConnected()&&!t.isInsertionMarker()){P(r,o.definitionNameToParam[n.parameters[e].name])}++e}}}const I={updateBeforeRender:()=>{C||w&&(w=!1,C=!0,A(0,void 0,!0),C=!1)}};function A(e,i=!1,r=!1){const a=R(e);if(!r&&!i&&a===S.getNumber(m))return;S.setValue(m,a);const l=a;if(!S.getBoolean(g)&&l>0&&(O(),!t.rendered))return;let c=0;for(let e=0;e<t.inputList.length;e++){const i=t.inputList[e];if(pxt.Util.startsWith(i.name,s.optionalDummyInputPrefix))L(i,c<l||l===y);else if(pxt.Util.startsWith(i.name,s.optionalInputWithFieldPrefix)||-1!==_.indexOf(i.name)){const e=c<l;if(L(i,e),e&&i.connection&&!i.connection.isConnected()&&!t.isInsertionMarker()){P(i,o.definitionNameToParam[n.parameters[c].name])}++c}}D(),v&&t.setInputsInline(l<T),i||t.queueRender()}function N(e,n,i,r){t.appendDummyInput(e).appendField(new l.FieldImageNoText(n,24,24,i,()=>A(r),!1))}function D(){if(C)return;const e=S.getNumber(m),n=e!==y,i=0!==e;t.inputList.some(e=>e.name===p)&&t.removeInput(p,!0),t.inputList.some(e=>e.name===h)&&t.removeInput(h,!0),t.inputList.some(e=>e.name===f)&&t.removeInput(f,!0),n&&i?t.appendDummyInput(f).appendField(new l.FieldImageNoText(t.REMOVE_IMAGE_DATAURI,24,24,lf("Hide optional arguments"),()=>A(-1*b),!1)).appendField(new l.FieldImageNoText(t.ADD_IMAGE_DATAURI,24,24,lf("Reveal optional arguments"),()=>A(b),!1)):n?N(p,t.ADD_IMAGE_DATAURI,lf("Reveal optional arguments"),b):i&&N(h,t.REMOVE_IMAGE_DATAURI,lf("Hide optional arguments"),-1*b)}function O(){S.setValue(g,!0),c(),D()}function R(e){const t=Math.min(Math.max(S.getNumber(m)+e,0),y);if(E){if(e>=0){if(0===t)return 0;for(const e of E)if(e>=t)return e;return y}for(let e=0;e<E.length;e++)if(E[e]>=t)return e>0?E[e-1]:0;return E[E.length-1]}return t}function L(e,t){e.setVisible(t)}function P(n,s){let o=(0,r.createShadowValue)(e,s);"value"===o.tagName.toLowerCase()&&(o=o.firstElementChild),i.Events.disable();try{let e;t.initialized?e=i.Xml.domToBlock(o,t.workspace):(e=i.Xml.domToBlockInternal(o,t.workspace),setTimeout(()=>{e.isInsertionMarker()&&(i.Events.disable(),e.dispose(),i.Events.enable())})),e&&n.connection.connect(e.outputConnection)}catch(e){}i.Events.enable()}t.mixin(I)},n.initVariableReporterArgs=function(e,t,n){const r="0_add_button",s="numargs",o=new d(e);o.setEventsEnabled(!1),o.setValue(s,0),o.setEventsEnabled(!0),i.Extensions.apply("inline-svgs",e,!1);const p=()=>{for(const n of t){const t=e.getInput(a.DRAGGABLE_PARAM_INPUT_PREFIX+n.name);if(!t)break;if(!t.connection.targetConnection){i.Events.disable();const r=pxt.blocks.reporterTypeForArgType(n.type),s=document.createElement("block");s.setAttribute("type",r);const o=document.createElement("field");if(o.setAttribute("name","VALUE"),o.textContent=n.name,s.appendChild(o),"argument_reporter_custom"===r){const e=document.createElement("mutation");e.setAttribute("type",n.type),s.appendChild(e)}const a=i.Xml.domToBlock(s,e.workspace);t.connection.connect(a.outputConnection),!e.isInsertionMarker()&&a instanceof i.BlockSvg&&(a.initSvg(),a.queueRender()),i.Events.enable()}}},h=()=>{const u=e.inputList.filter(e=>e.name.startsWith(a.DRAGGABLE_PARAM_INPUT_PREFIX)).length,d=e.inputList.some(e=>e.name===r);if(u<o.getNumber(s))for(let i=u;i<o.getNumber(s);i++){const s=t[i];if(s){const t=e.appendValueInput(a.DRAGGABLE_PARAM_INPUT_PREFIX+s.name);t.setCheck((0,a.getBlocklyCheckForType)(s.type,n)),(0,c.setDuplicateOnDrag)(e.type,t.name),d?e.moveInputBefore(t.name,r):e.moveInputBefore(t.name,"HANDLER")}}else if(u>o.getNumber(s))for(let n=u-1;n>=o.getNumber(s);n--){const r=t[n];if(r){const t=e.getInput(a.DRAGGABLE_PARAM_INPUT_PREFIX+r.name);t.connection.targetConnection&&(i.Events.disable(),t.connection.targetBlock().dispose(),i.Events.enable()),e.removeInput(t.name,!0)}}o.getNumber(s)<t.length?d||(e.appendDummyInput(r).appendField(new l.FieldImageNoText(e.ADD_IMAGE_DATAURI,24,24,lf("Add argument"),()=>{o.setValue(s,o.getNumber(s)+1),h()},!1)),e.moveInputBefore(r,"HANDLER")):d&&e.removeInput(r,!0),setTimeout(p)};h(),u(e,{mutationToDom:e=>(e.setAttribute(s,o.getString(s)),e),domToMutation:e=>{if(o.setEventsEnabled(!1),e.hasAttribute(s)){const t=parseInt(e.getAttribute(s));isNaN(t)||(o.setValue(s,t),h())}o.setEventsEnabled(!0)}})};class d{constructor(e,t){this.block=e,this.fireEvents=!0,this.state=t||{}}setValue(e,t){if(this.fireEvents&&this.block.mutationToDom){const n=this.block.mutationToDom();this.state[e]=t.toString();const r=this.block.mutationToDom();Object.keys(this.state).forEach(e=>{n.getAttribute(e)!==this.state[e]&&r.setAttribute(e,this.state[e])});const s=i.Xml.domToText(n),o=i.Xml.domToText(r);s!=o&&i.Events.fire(new i.Events.BlockChange(this.block,"mutation",null,s,o))}else this.state[e]=t.toString()}getNumber(e){return parseInt(this.state[e])}getBoolean(e){return"false"!=this.state[e]}getString(e){return this.state[e]}setEventsEnabled(e){this.fireEvents=e}}},{"./constants":18,"./fields":70,"./fields/field_imagenotext":38,"./loader":77,"./plugins/duplicateOnDrag":92,"./toolbox":140,blockly:176}],18:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.optionalInputWithFieldPrefix=n.optionalDummyInputPrefix=n.provider=void 0;const i=e("blockly");n.provider=new i.zelos.ConstantProvider,n.optionalDummyInputPrefix="0_optional_dummy",n.optionalInputWithFieldPrefix="0_optional_field"},{blockly:176}],19:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.registerBlockitems=n.BlockContextWeight=void 0;const i=e("blockly"),r=e("../external");var s;!function(e){e[e.Duplicate=10]="Duplicate",e[e.Copy=15]="Copy",e[e.AddComment=20]="AddComment",e[e.ExpandCollapse=30]="ExpandCollapse",e[e.DeleteBlock=40]="DeleteBlock",e[e.Help=50]="Help"}(s=n.BlockContextWeight||(n.BlockContextWeight={})),n.registerBlockitems=function(){i.ContextMenuRegistry.registry.unregister("blockDuplicate"),i.ContextMenuRegistry.registry.unregister("blockCollapseExpand"),i.ContextMenuRegistry.registry.unregister("blockHelp"),i.ContextMenuRegistry.registry.unregister("blockInline"),function(){const e={displayText:()=>lf("Duplicate"),preconditionFn(e){const t=e.block;return!t.isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){if(!e.block)return;let t=!1;e.block.duplicateOnDrag_&&(e.block.duplicateOnDrag_=!1,t=!0);const n=e.block.toCopyData();t&&(e.block.duplicateOnDrag_=!0),n&&i.clipboard.paste(n,e.block.workspace)},scopeType:i.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:s.Duplicate};i.ContextMenuRegistry.registry.register(e)}(),function(){const e={displayText:e=>e.block.isCollapsed()?pxt.U.lf("Expand Block"):pxt.U.lf("Collapse Block"),preconditionFn(e){const t=e.block;return t.workspace.getTopBlocks(!1).some(e=>e===t)&&t.statementInputCount>0&&!t.previousConnection&&!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block&&(pxt.tickEvent("blocks.context.expandCollapseBlock",void 0,{interactiveConsent:!0}),e.block.setCollapsed(!e.block.isCollapsed()))},scopeType:i.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtExpandCollapseBlock",weight:s.ExpandCollapse};i.ContextMenuRegistry.registry.register(e)}(),function(){const e={displayText:()=>pxt.U.lf("Help"),preconditionFn(e){const t=e.block;return("function"==typeof t.helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback(e){if(!e.block)return;const t=e.block,n="function"==typeof t.helpUrl?t.helpUrl():t.helpUrl;n&&(0,r.openHelpUrl)(n)},scopeType:i.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtHelpBlock",weight:s.Help};i.ContextMenuRegistry.registry.register(e)}();const e=i.ContextMenuRegistry.registry.getItem("blockDelete");e&&(e.weight=s.DeleteBlock);const t=i.ContextMenuRegistry.registry.getItem("blockComment");t&&(t.weight=s.AddComment)}},{"../external":25,blockly:176}],20:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setupWorkspaceContextMenu=n.initContextMenu=void 0;const i=e("blockly"),r=e("./workspaceItems"),s=e("../external"),o=e("./blockItems");let a=!1;n.initContextMenu=function(){const e=i.Msg;e.DUPLICATE_BLOCK=lf("{id:block}Duplicate"),e.DUPLICATE_COMMENT=lf("Duplicate Comment"),e.REMOVE_COMMENT=lf("Remove Comment"),e.ADD_COMMENT=lf("Add Comment"),e.EXTERNAL_INPUTS=lf("External Inputs"),e.INLINE_INPUTS=lf("Inline Inputs"),e.EXPAND_BLOCK=lf("Expand Block"),e.COLLAPSE_BLOCK=lf("Collapse Block"),e.ENABLE_BLOCK=lf("Enable Block"),e.DISABLE_BLOCK=lf("Disable Block"),e.DELETE_BLOCK=lf("Delete Block"),e.DELETE_X_BLOCKS=lf("Delete Blocks"),e.DELETE_ALL_BLOCKS=lf("Delete All Blocks"),e.HELP=lf("Help"),a||(a=!0,(0,r.registerWorkspaceItems)(),(0,o.registerBlockitems)())},n.setupWorkspaceContextMenu=function(e){try{i.ContextMenuItems.registerCommentOptions()}catch(e){}e.configureContextMenu=(t,n)=>{(0,s.onWorkspaceContextMenu)(e,t)}}},{"../external":25,"./blockItems":19,"./workspaceItems":22,blockly:176}],21:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./contextMenu"),n)},{"./contextMenu":20}],22:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.registerWorkspaceItems=n.WorkspaceContextWeight=void 0;const i=e("blockly"),r=e("../layout"),s=e("../external");var o;!function(e){e[e.Paste=10]="Paste",e[e.DeleteAll=20]="DeleteAll",e[e.FormatCode=30]="FormatCode",e[e.CollapseBlocks=40]="CollapseBlocks",e[e.ExpandBlocks=50]="ExpandBlocks",e[e.Snapshot=60]="Snapshot",e[e.Find=70]="Find"}(o=n.WorkspaceContextWeight||(n.WorkspaceContextWeight={})),n.registerWorkspaceItems=function(){!function(){const e={displayText:()=>pxt.U.lf("Format Code"),preconditionFn:e=>e.workspace.options.readOnly?"hidden":"enabled",callback(e){e.workspace&&(pxt.tickEvent("blocks.context.format",void 0,{interactiveConsent:!0}),(0,r.flow)(e.workspace,{useViewWidth:!0}))},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtFormatCode",weight:o.FormatCode};i.ContextMenuRegistry.registry.register(e)}(),function(){const e={displayText:()=>pxt.U.lf("Snapshot"),preconditionFn(e){if(!(0,r.screenshotEnabled)())return"hidden";const t=e.workspace,n=t.getTopBlocks(!1),i=t.getTopComments(!1);return 0===n.length&&0===i.length?"disabled":"enabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.screenshot",void 0,{interactiveConsent:!0}),(async()=>{var t,n;let i=await(0,r.screenshotAsync)(e.workspace,null,null===(t=pxt.appTarget.appTheme)||void 0===t?void 0:t.embedBlocksInSnapshot);pxt.BrowserUtils.isSafari()&&(i=await(0,r.screenshotAsync)(e.workspace,null,null===(n=pxt.appTarget.appTheme)||void 0===n?void 0:n.embedBlocksInSnapshot)),pxt.BrowserUtils.isSafari()&&(i=i.replace(/^data:image\/[^;]/,"data:application/octet-stream")),pxt.BrowserUtils.browserDownloadDataUri(i,`${pxt.appTarget.nickname||pxt.appTarget.id}-${lf("screenshot")}.png`)})())},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtSnapshotCode",weight:o.Snapshot};i.ContextMenuRegistry.registry.register(e)}(),function(){const e={displayText:()=>pxt.U.lf("Collapse Blocks"),preconditionFn(e){const t=e.workspace;if(t.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing)return"hidden";return t.getTopBlocks(!1).some(e=>e.isEnabled()&&!e.isCollapsed())?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.collapse",void 0,{interactiveConsent:!0}),(0,r.setCollapsedAll)(e.workspace,!0))},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtCollapseBlocks",weight:o.CollapseBlocks};i.ContextMenuRegistry.registry.register(e)}(),function(){const e={displayText:()=>pxt.U.lf("Expand Blocks"),preconditionFn(e){const t=e.workspace;if(t.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing)return"hidden";return t.getTopBlocks(!1).some(e=>e.isEnabled()&&e.isCollapsed())?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.expand",void 0,{interactiveConsent:!0}),(0,r.setCollapsedAll)(e.workspace,!1))},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtExpandBlocks",weight:o.ExpandBlocks};i.ContextMenuRegistry.registry.register(e)}(),function(){const e=e=>{const t=[],n=e=>{if(e.isDeletable())t.push(...e.getDescendants(!1));else for(const t of e.getChildren(!1))n(t)};for(const t of e.getTopBlocks())n(t);return t},t={displayText:t=>e(t.workspace).filter(e=>!e.isShadow()).length>1?pxt.U.lf("Delete All Blocks"):pxt.U.lf("Delete Block"),preconditionFn(t){if(t.workspace.options.readOnly)return"hidden";return 0===e(t.workspace).filter(e=>!e.isShadow()).length?"disabled":"enabled"},callback(t){if(!t.workspace)return;const n=e(t.workspace),r=n.filter(e=>!e.isShadow()).length,s=10;let o=i.utils.idGenerator.genUid();const a=()=>{let e=n.shift();e&&(e.isDeadOrDying()?a():(i.Events.setGroup(o),e.dispose(!1,!0),i.Events.setGroup(!1),setTimeout(a,s)))};pxt.tickEvent("blocks.context.delete",void 0,{interactiveConsent:!0}),r<2?a():i.dialog.confirm(lf("Delete all {0} blocks?",r),e=>{e&&a()})},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtDeleteAllBlocks",weight:o.DeleteAll};i.ContextMenuRegistry.registry.register(t)}(),function(){const e={displayText:()=>pxt.U.lf("Find"),preconditionFn:e=>e.workspace.options.readOnly||!pxt.appTarget.appTheme.workspaceSearch?"hidden":"enabled",callback(e){e.workspace&&(pxt.tickEvent("blocks.context.find",void 0,{interactiveConsent:!0}),(0,s.openWorkspaceSearch)())},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtWorkspaceFind",weight:o.Find};i.ContextMenuRegistry.registry.register(e)}(),i.ContextMenuRegistry.registry.unregister("workspaceDelete"),i.ContextMenuRegistry.registry.unregister("expandWorkspace"),i.ContextMenuRegistry.registry.unregister("collapseWorkspace"),i.ContextMenuRegistry.registry.unregister("cleanWorkspace"),i.ContextMenuRegistry.registry.unregister("redoWorkspace"),i.ContextMenuRegistry.registry.unregister("undoWorkspace")}},{"../external":25,"../layout":75,blockly:176}],23:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initAccessibleBlocksCopyPasteContextMenu=n.initCopyPaste=void 0;const i=e("blockly"),r=e("./external"),s=e("./contextMenu/blockItems"),o=e("./contextMenu/workspaceItems"),a=e("./plugins/duplicateOnDrag");let l,c,u;n.initCopyPaste=function(e,t=!1){if(!(0,r.getCopyPasteHandlers)())return;if(l&&!t)return;const n=i.ShortcutRegistry.registry.getRegistry();l=l||Object.assign({},n[i.ShortcutItems.names.COPY]),c=c||Object.assign({},n[i.ShortcutItems.names.CUT]),u=u||Object.assign({},n[i.ShortcutItems.names.PASTE]),i.ShortcutRegistry.registry.unregister(i.ShortcutItems.names.COPY),i.ShortcutRegistry.registry.unregister(i.ShortcutItems.names.CUT),i.ShortcutRegistry.registry.unregister(i.ShortcutItems.names.PASTE),function(){const e={name:i.ShortcutItems.names.COPY,preconditionFn:(e,t)=>f(e,t,l.preconditionFn),callback:p,keyCodes:l.keyCodes};i.ShortcutRegistry.registry.register(e)}(),function(){const e={name:i.ShortcutItems.names.CUT,preconditionFn:(e,t)=>f(e,t,c.preconditionFn),callback(e,t,n,i){var s;const o=null===(s=(0,r.getCopyPasteHandlers)())||void 0===s?void 0:s.cut;return o?o(e,t,n,i):c.callback(e,t,n,i)},keyCodes:c.keyCodes};i.ShortcutRegistry.registry.register(e)}(),function(){const e={name:i.ShortcutItems.names.PASTE,preconditionFn:(e,t)=>!e.isReadOnly()&&!e.isDragging()&&!i.getFocusManager().ephemeralFocusTaken(),callback:h,keyCodes:u.keyCodes};i.ShortcutRegistry.registry.register(e)}(),e||(function(){const e={displayText:()=>lf("Copy"),preconditionFn:e=>{const t=e.block;if(t.isInFlyout||!t.isMovable()||!t.isEditable())return"hidden";const n=(0,r.getCopyPasteHandlers)();return n?n.copyPrecondition(e):"enabled"},callback:function(e,t){const n=e.block;n&&(n.select(),p(n.workspace,t,void 0,e))},scopeType:i.ContextMenuRegistry.ScopeType.BLOCK,weight:s.BlockContextWeight.Copy,id:"makecode-copy-block"},t={displayText:()=>lf("Copy"),preconditionFn:e=>{const t=e.comment;if(!t.isMovable()||!t.isEditable())return"hidden";const n=(0,r.getCopyPasteHandlers)();return n?n.copyPrecondition(e):"enabled"},callback:function(e,t){const n=e.comment;n&&(n.select(),p(n.workspace,t,void 0,e))},scopeType:i.ContextMenuRegistry.ScopeType.COMMENT,weight:s.BlockContextWeight.Copy,id:"makecode-copy-comment"};i.ContextMenuRegistry.registry.getItem(e.id)&&i.ContextMenuRegistry.registry.unregister(e.id);i.ContextMenuRegistry.registry.getItem(t.id)&&i.ContextMenuRegistry.registry.unregister(t.id);i.ContextMenuRegistry.registry.register(e),i.ContextMenuRegistry.registry.register(t)}(),function(){const e={displayText:()=>lf("Paste"),preconditionFn:d,callback:function(e,t){const n=e.workspace;n&&h(n,t,void 0,e)},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,weight:o.WorkspaceContextWeight.Paste,id:"makecode-paste"};i.ContextMenuRegistry.registry.getItem(e.id)&&i.ContextMenuRegistry.registry.unregister(e.id);i.ContextMenuRegistry.registry.register(e)}())},n.initAccessibleBlocksCopyPasteContextMenu=function(){!function(){const e=i.ContextMenuRegistry.registry.getItem("blockPasteFromContextMenu");if("separator"in e)throw new Error(`RegistryItem ${e.id} is not of type ActionRegistryItem`);const t=Object.assign(Object.assign({},e),{preconditionFn:d});i.ContextMenuRegistry.registry.unregister("blockPasteFromContextMenu"),i.ContextMenuRegistry.registry.register(t)}(),function(){const e=i.ContextMenuRegistry.registry.getItem("blockCutFromContextMenu");if("separator"in e)throw new Error(`RegistryItem ${e.id} is not of type ActionRegistryItem`);const t=Object.assign(Object.assign({},e),{preconditionFn:e=>{const t=e.focusedNode;if(!t||!i.isCopyable(t))return"hidden";const n=t.workspace;return t.workspace.isFlyout?"hidden":n instanceof i.WorkspaceSvg&&c.preconditionFn(n,e)?"enabled":"hidden"}});i.ContextMenuRegistry.registry.unregister("blockCutFromContextMenu"),i.ContextMenuRegistry.registry.register(t)}()};const d=e=>{var t;if(pxt.shell.isReadOnly()||(null===(t=e.workspace)||void 0===t?void 0:t.options.readOnly))return"hidden";const n=(0,r.getCopyPasteHandlers)();return n?n.pastePrecondition(e):"enabled"},p=(e,t,n,i)=>{var s;const o=null===(s=(0,r.getCopyPasteHandlers)())||void 0===s?void 0:s.copy;return o?o(e,t,n,i):l.callback(e,t,n,i)},h=(e,t,n,i)=>{var s;const o=null===(s=(0,r.getCopyPasteHandlers)())||void 0===s?void 0:s.paste;return o?o(e,t,n,i):u.callback(e,t,n,i)};function f(e,t,n){const r=i.getFocusManager().getFocusedNode();r instanceof i.BlockSvg&&(0,a.shouldDuplicateOnDrag)(r)&&r.setDeletable(!0);const s=n(e,t);return(0,a.updateDuplicateOnDragState)(r),s}},{"./contextMenu/blockItems":19,"./contextMenu/workspaceItems":22,"./external":25,"./plugins/duplicateOnDrag":92,blockly:176}],24:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decompiledDiffAsync=n.mergeXml=n.diffXml=n.needsDecompiledDiff=void 0;const i=e("blockly"),r=e("./importer"),s=e("./render");n.needsDecompiledDiff=function(e,t){if(!e||!t)return!1;const n={};if(e.replace(/id="([^"]+)"/g,(e,t)=>(n[t]=!0,"")),!Object.keys(n).length)return!1;let i=0,r=0;return t.replace(/id="([^"]+)"/g,(e,t)=>(i++,n[t]&&r++,"")),i>0&&0==r},n.diffXml=function(e,t,n){return a((0,r.loadWorkspaceXml)(e,!0),(0,r.loadWorkspaceXml)(t,!0),n)};const o="#d0d0d0";function a(e,t,n){try{return i.Events.disable(),function(e,t,n){pxt.tickEvent("blocks.diff",{started:1}),n=n||{};const a=l();if(!e)return{ws:void 0,message:lf("All blocks are new."),added:0,deleted:0,modified:1};if(!t)return{ws:void 0,message:lf("The current blocks seem corrupted."),added:0,deleted:0,modified:1};const d=pxt.Util.toDictionary(e.getTopBlocks(!1),e=>u(e,!0));t.getTopBlocks(!1).forEach(t=>{const n=u(t,!0),i=e.getBlockById(t.id)||d[n];if(i){n==u(i,!0)&&(a("fast unmodified top ",t.id),t.dispose(!1),i.dispose(!1))}});const p=e.getAllBlocks(!1).filter(e=>e.isEnabled()),h=e.getTopBlocks(!1).filter(e=>e.isEnabled()),f=t.getAllBlocks(!1).filter(e=>e.isEnabled());if(a("blocks",f.map(e=>e.toDevString())),a(f),0==p.length&&0==f.length)return pxt.tickEvent("blocks.diff",{moves:1}),{ws:void 0,message:lf("Some blocks were moved or changed."),added:0,deleted:0,modified:1};const m=h.filter(e=>!t.getBlockById(e.id)),g=p.filter(e=>!t.getBlockById(e.id)),_=f.filter(t=>!e.getBlockById(t.id)),y=(0,s.initRenderingWorkspace)(),b=(0,r.saveWorkspaceXml)(t,!0);(0,r.domToWorkspaceNoEvents)(i.utils.xml.textToDom(b),y),y.getAllBlocks(!1).filter(e=>!e.isEnabled()).forEach(e=>{a("disabled ",e.toDevString()),e.dispose(!1)});const v=pxt.Util.toDictionary(y.getAllBlocks(!1),e=>e.id);a("todo blocks",v),O("start"),n.hideDeletedTopBlocks||(m.forEach(e=>{a(`deleted top ${e.toDevString()}`),N(e);const t=I(e);N(t),t.setDisabledReason(!0,c)}),O("deleted top"));_.map(e=>y.getBlockById(e.id)).filter(e=>!!e).forEach(e=>{a(`added ${e.toDevString()}`),N(e)}),O("added");const T={};if(!n.hideDeletedBlocks){const e=g.filter(e=>!(v[e.id]||w(e)||e.outputConnection&&e.outputConnection.isConnected()));e.forEach(e=>{const t=I(e);T[e.id]=t.id,a(`deleted block ${e.toDevString()}->${t.toDevString()}`)}),e.forEach(e=>S(e))}let k=0;if(pxt.Util.values(v).filter(e=>R(e)).forEach(e=>{a(`moved ${e.toDevString()}`),delete v[e.id],C(e),k++}),O("moved"),pxt.Util.values(v).filter(e=>L(e)).forEach(e=>{a(`changed ${e.toDevString()}`),delete v[e.id],C(e),k++}),O("changed"),y.getTopBlocks(!1).forEach(e=>{D(e)||(a(`unmodified top ${e.toDevString()}`),delete v[e.id],e.dispose(!1))}),O("cleaned"),pxt.Util.values(v).filter(e=>!!y.getBlockById(e.id)).forEach(e=>{P(e)}),O("unmodified"),!y.getAllBlocks(!1).length)return pxt.tickEvent("blocks.diff",{missed:1}),{ws:y,message:lf("Some blocks were changed."),deleted:g.length,added:_.length,modified:k};y.resize(),i.svgResize(y);const x=(0,s.renderWorkspace)(n.renderOptions||{emPixels:20,layout:4,aspectRatio:.5,useViewWidth:!0}),E={ws:y,svg:x,deleted:g.length,added:_.length,modified:k};return pxt.tickEvent("blocks.diff",{deleted:E.deleted,added:E.added,modified:E.modified}),E;function S(e){a(`stitching ${e.toDevString()}->${T[e.id]}`);const t=y.getBlockById(T[e.id]);t.setDisabledReason(!0,c),C(t),N(t);const n=e.getPreviousBlock();if(n){const r=y.getBlockById(T[n.id])||y.getBlockById(n.id);if(a(`previous ${e.id}->${t.toDevString()}: ${r.toDevString()}`),r)if(r.nextConnection)t.previousConnection.connect(r.nextConnection);else{const e=r.inputList.slice().reverse().find(e=>e.connection&&e.connection.type==i.NEXT_STATEMENT);e&&t.previousConnection.connect(e.connection)}}const r=e.getNextBlock();if(r){const n=y.getBlockById(T[r.id])||y.getBlockById(r.id);n&&(a(`next ${e.id}->${t.toDevString()}: ${n.toDevString()}`),t.nextConnection.connect(n.previousConnection))}}function C(e){e.__pxt_used=!0}function w(e){return!!e.__pxt_used}function I(e){const t=i.Xml.blockToDom(e,!1),n=i.Xml.domToBlock(t,y);return n.nextConnection&&n.nextConnection.targetConnection&&n.nextConnection.disconnect(),n.previousConnection&&n.previousConnection.targetConnection&&n.previousConnection.disconnect(),n}function A(e){e.inputList.forEach(e=>e.fieldRow.forEach(e=>{e.init()}))}function N(e){e.getDescendants(!1).forEach(e=>{delete v[e.id],C(e)})}function D(e){return!!e.getDescendants(!1).find(e=>w(e))}function O(e){a(`${e}:`,pxt.Util.values(v).map(e=>e.toDevString()))}function R(t){const n=e.getBlockById(t.id);if(!n)return!1;const i=t.getPreviousBlock();if(i&&!v[i.id])return!1;const r=t.getNextBlock();if(r&&!v[r.id])return!1;const s=n.getPreviousBlock();if(!s&&!i)return!1;if(!!s!=!!i||s.id!=i.id)return!0;const o=n.getNextBlock();return!(!o&&!r)&&(!!o!=!!r||o.id!=r.id)}function L(t){let n=e.getBlockById(t.id);if(!n)return!1;const i=u(n),r=u(t);return i!=r&&(a(`old ${n.toDevString()}`,i),a(`new ${t.toDevString()}`,r),!0)}function P(e){e.setColour(o),A(e),n.statementsOnly&&(e.inputList||[]).map(e=>e.type==i.inputs.inputTypes.VALUE&&e.connection&&e.connection.targetBlock()).filter(e=>!!e).forEach(e=>P(e))}}(e,t,n)}catch(e){return pxt.reportException(e),{ws:void 0,message:lf("Oops, we could not diff those blocks."),error:e,deleted:0,added:0,modified:0}}finally{i.Events.enable()}}function l(){return pxt.options.debug||window&&/diffdbg=1/.test(window.location.href)?pxt.log:(e,...t)=>{}}const c="disabled_for_diff";function u(e,t){const n=i.Xml.blockToDom(e,!0);return d(n),p(n,e=>{d(e),t||("next"==e.localName||"statement"==e.localName||"shadow"==e.localName)&&e.remove()}),i.Xml.domToText(n)}function d(e){e.removeAttribute("id"),e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("deletable"),e.removeAttribute("editable"),e.removeAttribute("movable")}function p(e,t){if(e){t(e);for(const n of pxt.Util.toArray(e.children))p(n,t)}}function h(e,t){if(!t)return;let n,i;for(let r=0;r<e.length;++r){let s=e[r];s.startPos<=t.start&&s.endPos>=t.start+t.length&&(!n||i>s.endPos-s.startPos)&&(n=s,i=s.endPos-s.startPos)}return n?n.id:void 0}n.mergeXml=function(e,t,n){return e==t?n:n==t?e:void 0},n.decompiledDiffAsync=function(e,t,n,i,s={}){const o=l(),c=t.outfiles[pxt.MAIN_BLOCKS];let u=i.outfiles[pxt.MAIN_BLOCKS];o(c),o(u);const d=pxt.diff.computeFormattedDiff(e,n,{ignoreWhitespace:!0,full:!0});o(d);const p={};let f=0,m=0;d.forEach((e,n)=>{const r=e[0],s=e.substr(2);let a=s.length;switch(r){case"-":f+=a+1;break;case"+":m+=a+1;break;default:const n=/^\s+/.exec(s);if(n){const e=n[0].length;f+=e,m+=e,a-=e}const r=h(i.blockSourceMap,{start:m,length:a});if(r&&!p[r]){const n=h(t.blockSourceMap,{start:f,length:a});n&&(o(e),o(`id ${f}:${s.length}>${n} ==> ${m}:${s.length}>${r}`),p[r]=n,u=u.replace(r,n))}f+=a+1,m+=a+1}});const g=(0,r.loadWorkspaceXml)(c,!0),_=(0,r.loadWorkspaceXml)(u,!0);return s.statementsOnly=!0,a(g,_,s)}},{"./importer":73,"./render":138,blockly:176}],25:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCopyPasteHandlers=n.setCopyPaste=n.openWorkspaceSearch=n.setOpenWorkspaceSearch=n.prompt=n.setPrompt=n.setOnWorkspaceContextMenu=n.onWorkspaceContextMenu=n.setOpenHelpUrl=n.openHelpUrl=n.setExtensionBlocklyPatch=n.extensionBlocklyPatch=n.setPromptTranslateBlock=n.promptTranslateBlock=void 0;const i=e("blockly");let r,s,o,a,l,c,u,d,p,h,f;n.promptTranslateBlock=function(e,t){r&&r(e,t)},n.setPromptTranslateBlock=function(e){r=e},n.extensionBlocklyPatch=function(e,t){s&&s(e,t)},n.setExtensionBlocklyPatch=function(e){s=e},n.openHelpUrl=function(e){o?o(e):window.open(e)},n.setOpenHelpUrl=function(e){o=e},n.onWorkspaceContextMenu=function(e,t){a&&a(e,t)},n.setOnWorkspaceContextMenu=function(e){a=e},n.setPrompt=function(e,t){t&&i.dialog.setPrompt(e),l=e},n.prompt=function(e,t,n,r){l?l(e,t,n,r):i.dialog.prompt(e,t,n)},n.setOpenWorkspaceSearch=function(e){c=e},n.openWorkspaceSearch=function(){c&&c()},n.setCopyPaste=function(e,t,n,i,r){u=e,d=t,p=n,h=i,f=r},n.getCopyPasteHandlers=function(){return u?{copy:u,cut:d,paste:p,copyPrecondition:h,pastePrecondition:f}:null}},{blockly:176}],26:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFieldEditor=n.registerFieldEditor=n.initFieldEditors=void 0;const i=e("./field_animation"),r=e("./field_tilemap"),s=e("./field_textinput"),o=e("./field_sprite"),a=e("./field_gridpicker"),l=e("./field_colour"),c=e("./field_images"),u=e("./field_textdropdown"),d=e("./field_numberdropdown"),p=e("./field_imagedropdown"),h=e("./field_note"),f=e("./field_melodySandbox"),m=e("./field_toggle"),g=e("./field_toggle_downup"),_=e("./field_toggle_highlow"),y=e("./field_toggle_onoff"),b=e("./field_toggle_updown"),v=e("./field_toggle_winlose"),T=e("./field_toggle_yesno"),k=e("./field_protractor"),x=e("./field_position"),E=e("./field_speed"),S=e("./field_tileset"),C=e("./field_turnratio"),w=e("./field_musiceditor"),I=e("./field_sound_effect"),A=e("./field_autocomplete"),N=e("./field_colorwheel"),D=e("./field_scopedvalueselector");let O={};function R(e,t,n){null==O[e]&&(O[e]={field:t,validator:n})}n.initFieldEditors=function(){var e;R("text",s.FieldTextInput),R("note",h.FieldNote),R("gridpicker",a.FieldGridPicker),R("textdropdown",u.FieldTextDropdown),R("numberdropdown",d.FieldNumberDropdown),R("imagedropdown",p.FieldImageDropdown),R("colorwheel",N.FieldColorWheel),R("toggle",m.FieldToggle),R("toggleonoff",y.FieldToggleOnOff),R("toggleyesno",T.FieldToggleYesNo),R("toggleupdown",b.FieldToggleUpDown),R("toggledownup",g.FieldToggleDownUp),R("togglehighlow",_.FieldToggleHighLow),R("togglewinlose",v.FieldToggleWinLose),R("colornumber",l.FieldColorNumber),R("images",c.FieldImages),R("sprite",o.FieldSpriteEditor),R("animation",i.FieldAnimationEditor),R("tilemap",r.FieldTilemap),R("tileset",S.FieldTileset),R("speed",E.FieldSpeed),R("turnratio",C.FieldTurnRatio),R("protractor",k.FieldProtractor),R("position",x.FieldPosition),R("melody",f.FieldCustomMelody),R("soundeffect",I.FieldSoundEffect),R("autocomplete",A.FieldAutoComplete),R("scopedvalueselector",D.FieldScopedValueSelector),(null===(e=pxt.appTarget.appTheme)||void 0===e?void 0:e.songEditor)&&R("musiceditor",w.FieldMusicEditor)},n.registerFieldEditor=R,n.createFieldEditor=function(e,t,n){if(null==O[e])return pxt.error(`Field editor ${e} not registered`),null;n||(n={}),pxt.Util.assert(null==n.lightMode,"lightMode is a reserved parameter for custom fields"),n.lightMode=pxt.options.light;let i=O[e];return new i.field(t,n,i.validator)}},{"./field_animation":27,"./field_autocomplete":30,"./field_colorwheel":32,"./field_colour":33,"./field_gridpicker":36,"./field_imagedropdown":37,"./field_images":39,"./field_melodySandbox":43,"./field_musiceditor":44,"./field_note":45,"./field_numberdropdown":46,"./field_position":47,"./field_protractor":49,"./field_scopedvalueselector":50,"./field_sound_effect":51,"./field_speed":52,"./field_sprite":53,"./field_textdropdown":55,"./field_textinput":56,"./field_tilemap":57,"./field_tileset":58,"./field_toggle":59,"./field_toggle_downup":60,"./field_toggle_highlow":61,"./field_toggle_onoff":62,"./field_toggle_updown":63,"./field_toggle_winlose":64,"./field_toggle_yesno":65,"./field_turnratio":67}],27:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldAnimationEditor=void 0;var i=pxt.svgUtil;const r=e("./field_asset"),s=e("./field_utils"),o=32;class a extends r.FieldAssetEditor{constructor(){super(...arguments),this.onMouseEnter=()=>{if(this.animateRef||!this.asset)return;const e=this.getParentInterval()||this.asset.interval,t=e>50?e:50;let n=0;this.animateRef=setInterval(()=>{this.preview&&this.frames[n]&&this.preview.src(this.frames[n]),n=(n+1)%this.frames.length},t)},this.onMouseLeave=()=>{this.animateRef&&clearInterval(this.animateRef),this.animateRef=void 0,this.preview&&this.frames[0]&&this.preview.src(this.frames[0])}}initView(){this.sourceBlock_.getSvgRoot().addEventListener("mouseenter",this.onMouseEnter),this.sourceBlock_.getSvgRoot().addEventListener("mouseleave",this.onMouseLeave)}showEditor_(){this.asset&&(this.asset.interval=this.getParentInterval()||this.asset.interval),super.showEditor_()}render_(){super.render_(),this.size_.height=42,this.size_.width=80}getAssetType(){return"animation"}createNewAsset(e){const t=pxt.react.getTilemapProject();if(e){const r=pxt.lookupProjectAssetByTSReference(e,t);if(r)return r;const s=(n=e,i=this.params.taggedTemplate,-1===n.indexOf("[")?null:(n=n.replace(/[\[\]]/gm,"")).split(",").map(e=>pxt.sprite.imageLiteralToBitmap(e,i).data()).filter(e=>e.height&&e.width));if(s&&s.length){return{internalID:-1,id:this.temporaryAssetId(),type:"animation",frames:s,interval:this.getParentInterval(),meta:{}}}const o=t.lookupAssetByName("animation",e.trim());if(o)return o}var n,i;return{internalID:-1,id:this.temporaryAssetId(),type:"animation",frames:[new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight).data()],interval:500,meta:{}}}onEditorClose(e){this.setParentInterval(e.interval)}getValueText(){return this.asset?this.isTemporaryAsset()?"["+this.asset.frames.map(e=>pxt.sprite.bitmapToImageLiteral(pxt.sprite.Bitmap.fromData(e),"typescript",this.params.taggedTemplate)).join(",")+"]":pxt.getTSReferenceForAsset(this.asset):this.valueText||"[]"}redrawPreview(){if(!this.fieldGroup_)return;pxsim.U.clear(this.fieldGroup_);const e=(new i.Rect).at(35,1).size(40,40).corner(4).setClass("blocklyAnimationField");this.fieldGroup_.appendChild(e.el);const t=new i.Text("").at(5,26).setClass("semanticIcon");this.fieldGroup_.appendChild(t.el),this.asset&&(this.frames=this.asset.frames.map(e=>(0,s.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e),o,this.lightMode)),this.preview=(new i.Image).src(this.frames[0]).at(39,5).size(o,o),this.fieldGroup_.appendChild(this.preview.el))}getParentIntervalBlock(){const e=this.sourceBlock_;if(e.getParent()){const t=e.getParent();for(const e of t.inputList)if("frameInterval"===e.name)return e.connection.targetBlock()}}setParentInterval(e){const t=this.getParentIntervalBlock();if(t){const n=l(t);n&&t.setFieldValue(String(e),n)}}getParentInterval(){const e=this.getParentIntervalBlock();if(e){const t=l(e);if(t)return Number(e.getFieldValue(t))}return 100}parseFieldOptions(e){return function(e){const t={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};if(!e)return t;t.lightMode=e.lightMode,e.filter&&(t.filter=e.filter);return t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t.taggedTemplate=e.taggedTemplate,t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(e)}}function l(e){return"math_number_minmax"===e.type?"SLIDER":"math_number"===(t=e.type)||"math_integer"===t||"math_whole_number"===t?"NUM":"timePicker"===e.type?"ms":null;var t}n.FieldAnimationEditor=a},{"./field_asset":29,"./field_utils":69}],28:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldArgumentVariable=void 0;const i=e("blockly");class r extends i.FieldVariable{constructor(e){super(e),this.menuGenerator_=this.generateMenu}generateMenu(){return i.FieldVariable.dropdownCreate.call(this).filter(e=>e[1]!=i.DELETE_VARIABLE_ID)}}n.FieldArgumentVariable=r},{blockly:176}],29:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BlocklyTilemapChange=n.FieldAssetEditor=void 0;const i=e("blockly");var r=pxt.svgUtil;const s=e("./field_base"),o=e("./field_utils"),a=32;class l extends s.FieldBase{constructor(e,t,n){super(e,t,n),this.pendingEdit=!1,this.isEmpty=!1,this.assetChangeListener=()=>{if(this.pendingEdit)return;const e=this.getBlockData();e&&(this.asset=pxt.react.getTilemapProject().lookupAsset(this.getAssetType(),e)),this.redrawPreview()},this.lightMode=t.lightMode,this.params=this.parseFieldOptions(t),this.blocksInfo=t.blocksInfo}onInit(){this.redrawPreview()}onValueChanged(e){return this.parseValueText(e),this.redrawPreview(),this.getValueText()}saveState(e){return this.asset&&!this.isTemporaryAsset()?(0,o.getAssetSaveState)(this.asset):super.saveState(e)}loadState(e){if("string"==typeof e)return void super.loadState(e);const t=(0,o.loadAssetFromSaveState)(e);super.loadState(pxt.getTSReferenceForAsset(t)),this.asset=t,this.setBlockData(this.asset.id)}showEditor_(){if(this.isGreyBlock)return;const e=Object.assign({},this.params);let t;switch(e.blocksInfo=this.blocksInfo,this.asset.type){case"tile":case"image":t="image-editor",e.temporaryAssets=(0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"image");break;case"animation":t="animation-editor",e.temporaryAssets=(0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"image").concat((0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"animation"));break;case"tilemap":t="tilemap-editor";const n=pxt.react.getTilemapProject();pxt.sprite.addMissingTilemapTilesAndReferences(n,this.asset);for(const e of(0,o.getTilesReferencedByTilesets)(this.sourceBlock_.workspace))-1===this.asset.data.projectReferences.indexOf(e.id)&&this.asset.data.projectReferences.push(e.id);break;case"song":t="music-editor",e.temporaryAssets=(0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"song"),(0,o.setMelodyEditorOpen)(this.sourceBlock_,!0)}this.isFullscreen()?this.showEditorFullscreen(t,e):this.showEditorInWidgetDiv(t,e)}getFieldDescription(){var e,t;return(null===(t=null===(e=this.asset)||void 0===e?void 0:e.meta)||void 0===t?void 0:t.displayName)||this.getAssetType().toString()}showEditorFullscreen(e,t){const n=pxt.react.getFieldEditorView(e,this.asset,t);this.undoRedoState&&n.restorePersistentData(this.undoRedoState),pxt.react.getTilemapProject().pushUndo(),n.onHide(()=>{this.onFieldEditorHide(n)}),n.show()}showEditorInWidgetDiv(e,t){let n,r={getScaledBBox:()=>n};i.WidgetDiv.show(r,this.sourceBlock_.RTL,()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),a.hide(),s.classList.remove("sound-effect-editor-widget"),s.style.transform="",s.style.position="",s.style.left="",s.style.top="",s.style.width="",s.style.height="",s.style.opacity="",s.style.transition="",s.style.alignItems="",this.onFieldEditorHide(a)});const s=i.WidgetDiv.getDiv(),a=pxt.react.getFieldEditorView(e,this.asset,t,s),l=this.sourceBlock_,c=l.getBoundingRectangle(),u=(0,o.workspaceToScreenCoordinates)(l.workspace,new i.utils.Coordinate(c.right,c.top)),d=u.x-400,p=u.y+60-20;s.style.opacity="0",s.classList.add("sound-effect-editor-widget"),s.style.position="absolute",s.style.left=d+"px",s.style.top=p+"px",s.style.width="50rem",s.style.height="34.25rem",s.style.display="flex",s.style.alignItems="center",s.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",s.style.borderRadius="",a.onHide(()=>{i.WidgetDiv.hideIfOwner(r)}),a.show();const h=s.getBoundingClientRect(),f=l.workspace.getInjectionDiv().getBoundingClientRect();h.height>f.height?(s.style.height="",s.style.top="calc(1rem - 20px)",s.style.bottom="calc(1rem + 20px)"):(h.bottom>f.bottom||h.top<f.top)&&(s.style.top=f.top+f.height/2-h.height/2-20+"px");const m=l.workspace.getToolbox().getWidth(),g=f.left+m;if(h.width>f.width-m)s.style.width="",s.style.left="1rem",s.style.right="1rem";else if(h.left+h.width>=f.right){const e=(0,o.workspaceToScreenCoordinates)(l.workspace,new i.utils.Coordinate(c.left,c.top));e.x-h.width-20>g?s.style.left=e.x-h.width-20+"px":s.style.left=g+(f.width-m)/2-h.width/2+"px"}else h.left<f.left&&(s.style.left=g+"px");const _=s.getBoundingClientRect();n=new i.utils.Rect(_.top,_.bottom,_.left,_.right),requestAnimationFrame(()=>{s.style.opacity="1",s.style.transform="translateY(20px)"})}onFieldEditorHide(e){var t;let n=e.getResult();const r=pxt.react.getTilemapProject();if("song"===this.asset.type&&(0,o.setMelodyEditorOpen)(this.sourceBlock_,!1),n){const s=this.getValue();if(pxt.assetEquals(this.asset,n))return;n=pxt.patchTemporaryAsset(this.asset,n,r);const o=c(this.asset)?null:this.asset.id,a=c(n)?null:n.id;this.pendingEdit=!0,(null===(t=n.meta)||void 0===t?void 0:t.displayName)&&this.disposeOfTemporaryAsset(),this.asset=n;const l=r.revision();if(this.onEditorClose(this.asset),this.updateAssetListener(),this.updateAssetMeta(),this.redrawPreview(),this.undoRedoState=e.getPersistentData(),this.sourceBlock_&&i.Events.isEnabled()){const e=new u(this.sourceBlock_,"field",this.name,s,this.getValue(),l,r.revision());o!==a&&(e.oldAssetId=o,e.newAssetId=a),i.Events.fire(e)}this.pendingEdit=!1}}render_(){this.isGreyBlock&&!this.textElement_&&this.createTextElement_(),super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=50)}getDisplayText_(){if(this.isGreyBlock){const e=pxt.Util.htmlUnescape(this.valueText);return e.substr(0,e.indexOf("("))+"(...)"}return""}updateEditable(){if(this.isGreyBlock&&this.fieldGroup_){const e=this.fieldGroup_;i.utils.dom.removeClass(e,"blocklyNonEditableText"),i.utils.dom.removeClass(e,"blocklyEditableText"),e.style.cursor=""}else super.updateEditable()}getValue(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.getValueText()}onDispose(){var e;(null===(e=this.sourceBlock_)||void 0===e?void 0:e.workspace)&&!this.sourceBlock_.workspace.rendered&&this.disposeOfTemporaryAsset(),pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener)}disposeOfTemporaryAsset(){this.isTemporaryAsset()&&(pxt.react.getTilemapProject().removeAsset(this.asset),this.setBlockData(null),this.asset=void 0)}clearTemporaryAssetData(){this.isTemporaryAsset()&&this.setBlockData(null)}isTemporaryAsset(){return c(this.asset)}getAsset(){return this.asset}updateAsset(e){this.asset=e,this.setValue(this.getValue())}onEditorClose(e){}redrawPreview(){if(!this.fieldGroup_)return;if(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock)return this.createTextElement_(),this.render_(),void this.updateEditable();const e=(new r.Rect).at(5,1).size(40,40).setClass("blocklySpriteField").stroke("#898989",1).corner(4);if(this.fieldGroup_.appendChild(e.el),this.asset){let e;switch(this.asset.type){case"image":case"tile":e=(0,o.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.bitmap),a,this.lightMode);break;case"animation":e=(0,o.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.frames[0]),a,this.lightMode);break;case"tilemap":e=(0,o.tilemapToImageURI)(this.asset.data,a,this.lightMode);break;case"song":e=(0,o.songToDataURI)(this.asset.song,60,20,this.lightMode)}if(e){const t=(new r.Image).src(e).at(9,5).size(a,a);this.fieldGroup_.appendChild(t.el)}}}parseValueText(e){if(e=pxt.Util.htmlUnescape(e),this.sourceBlock_){const t=pxt.react.getTilemapProject(),n=this.getBlockData(),i=t.lookupAsset(this.getAssetType(),n);!i||e&&this.isEmpty?(this.setBlockData(null),this.asset&&this.sourceBlock_&&this.asset.meta.blockIDs&&(this.asset.meta.blockIDs=this.asset.meta.blockIDs.filter(e=>e!==this.sourceBlock_.id),this.isTemporaryAsset()||t.updateAsset(this.asset)),this.isEmpty=!e,this.asset=this.createNewAsset(e)):this.asset=i,this.updateAssetMeta(),this.updateAssetListener()}}parseFieldOptions(e){const t={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};return e?(e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize),t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t.lightMode=e.lightMode,t):t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}updateAssetMeta(){if(this.asset){if(this.asset.meta||(this.asset.meta={}),this.asset.meta.blockIDs||(this.asset.meta.blockIDs=[]),this.sourceBlock_){if(-1===this.asset.meta.blockIDs.indexOf(this.sourceBlock_.id)){const e=this.asset.meta.blockIDs;e.length&&this.isTemporaryAsset()&&e.some(e=>this.sourceBlock_.workspace.getBlockById(e))&&(this.asset=pxt.cloneAsset(this.asset),this.asset.meta.blockIDs=[]),this.asset.meta.blockIDs.push(this.sourceBlock_.id)}this.setBlockData(this.isTemporaryAsset()?null:this.asset.id)}this.isTemporaryAsset()?this.asset.meta.temporaryInfo={blockId:this.sourceBlock_.id,fieldName:this.name}:pxt.react.getTilemapProject().updateAsset(this.asset)}}updateAssetListener(){pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener),this.asset&&!this.isTemporaryAsset()&&pxt.react.getTilemapProject().addChangeListener(this.asset,this.assetChangeListener)}isFullscreen(){return!0}temporaryAssetId(){return this.sourceBlock_.id+"_"+this.name}}function c(e){return e&&!e.meta.displayName}n.FieldAssetEditor=l;class u extends i.Events.BlockChange{constructor(e,t,n,i,r,s,o){super(e,t,n,i,r),this.oldRevision=s,this.newRevision=o,this.fieldName=n}isNull(){return this.oldRevision===this.newRevision&&super.isNull()}run(e){if(this.newAssetId||this.oldAssetId){const t=this.getEventWorkspace_().getBlockById(this.blockId);e?(0,o.setBlockDataForField)(t,this.fieldName,this.newAssetId):(0,o.setBlockDataForField)(t,this.fieldName,this.oldAssetId)}e?(pxt.react.getTilemapProject().redo(),super.run(e)):(pxt.react.getTilemapProject().undo(),super.run(e));const t=this.getEventWorkspace_(),n=new u(t.getBlockById(this.blockId),"tilemap-revision","revision",null,pxt.react.getTilemapProject().revision(),0,0);n.recordUndo=!1,i.Events.fire(n)}}n.BlocklyTilemapChange=u},{"./field_base":31,"./field_utils":69,blockly:176}],30:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldAutoComplete=void 0;const i=e("blockly"),r=e("./field_utils"),s=e("./field_textdropdown"),o=e("../plugins/text");class a extends s.FieldTextDropdown{constructor(e,t,n){super(e,t,n),this.isFieldCustom_=!0,this.key=t.key,this.isTextValid_=!0}isOptionListDynamic(){return!0}getDisplayText_(){return this.parsedValue||""}getFieldDescription(){return this.getDisplayText_()}doValueUpdate_(e){this.isDirty_=!0,null!==e&&(/['"`].*['"`]/.test(e)?this.parsedValue=JSON.parse(e):this.parsedValue=e,this.value_=this.parsedValue)}getValue(){return this.parsedValue?this.parsedValue:""}getOptions(){var e;const t=null===(e=this.sourceBlock_)||void 0===e?void 0:e.workspace;if(!t)return[];const n=[],i=(0,r.getAllFields)(t,e=>e instanceof a&&e.getKey()===this.key).map(e=>e.ref.getDisplayText_());for(const e of i)e.trim()&&!n.some(t=>t[0]===e)&&n.push([e,e]);return n.sort((e,t)=>e[0].localeCompare(t[0])),n}showDropdown_(){this.getOptions().length&&super.showDropdown_()}getKey(){return this.key?this.key:this.sourceBlock_?this.sourceBlock_.type:void 0}initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=i.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=i.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(){super.updateSize_();const e=Math.max(this.size_.width,1);let t=this.positionLeft(e+3);this.textElement_.setAttribute("x",t.toString()),t+=this.positionRight(t+e+3),this.size_.width=e+t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteRightX_=o.FieldString.quotePadding,t=this.quoteWidth_+o.FieldString.quotePadding):(this.quoteRightX_=e+o.FieldString.quotePadding,t=this.quoteWidth_+o.FieldString.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteLeftX_=e+this.quoteWidth_+2*o.FieldString.quotePadding,t=this.quoteWidth_+o.FieldString.quotePadding):(this.quoteLeftX_=0,t=this.quoteWidth_+o.FieldString.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}createSVGArrow(){}}n.FieldAutoComplete=a},{"../plugins/text":135,"./field_textdropdown":55,"./field_utils":69,blockly:176}],31:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldBase=void 0;const i=e("blockly"),r=e("./field_utils");class s extends i.Field{constructor(e,t,n){super(e,n),this.SERIALIZABLE=!0,this.options=t,e&&!this.valueText&&(this.valueText=e)}static enqueueInit(e){s.pendingInit.push(e),this.pendingTimeout||(s.pendingTimeout=setTimeout(()=>s.flushInitQueue()))}static flushInitQueue(){for(const e of s.pendingInit)e.onLoadedIntoWorkspace();s.pendingTimeout=void 0,s.pendingInit=[]}init(){super.init(),this.onInit(),s.enqueueInit(this)}dispose(){this.onDispose()}getValue(){return this.valueText}doValueUpdate_(e){null!==e&&(this.valueText=this.loaded?this.onValueChanged(e):e)}getDisplayText_(){return this.valueText}onLoadedIntoWorkspace(){this.loaded||(this.loaded=!0,this.valueText=this.onValueChanged(this.valueText))}getFieldDescription(){return this.getDisplayText_()}getAnchorDimensions(){const e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=s.CHECKMARK_OVERHANG:e.left-=s.CHECKMARK_OVERHANG,e}isInitialized(){return!!this.fieldGroup_}getBlockData(){return(0,r.getBlockDataForField)(this.sourceBlock_,this.name)}setBlockData(e){(0,r.setBlockDataForField)(this.sourceBlock_,this.name,e)}getSiblingBlock(e,t=!1){const n=t?this.sourceBlock_.getParent():this.sourceBlock_;if(n&&n.inputList)for(const t of n.inputList)if(t.name===e)return t.connection.targetBlock()}getSiblingField(e,t=!1){const n=t?this.sourceBlock_.getParent():this.sourceBlock_;if(n)return n.getField(e)}}n.FieldBase=s,s.CHECKMARK_OVERHANG=25,s.pendingInit=[]},{"./field_utils":69,blockly:176}],32:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldColorWheel=void 0;const i=e("../plugins/math");class r extends i.FieldSlider{constructor(e,t,n){super(String(e),"0","255","1","10","Color",n),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.channel&&(this.channel_=this.params.channel)}setBackground_(e){let t=this.createColourStops_().join(",");e.style.background=`linear-gradient(left, ${t})`,this.params.sliderWidth&&(e.style.width=`${this.params.sliderWidth}px`)}setReadout_(e,t){const n=this.colorWheel(parseInt(t),this.channel_),i=document.createElement("span");i.className="blocklyColorReadout",i.style.backgroundColor=`${n}`,pxsim.U.clear(e),e.appendChild(i)}createColourStops_(){let e=[];for(let t=0;t<=255;t+=20)e.push(this.colorWheel(t,this.channel_));return e}colorWheel(e,t){return"hsvfast"==t?this.hsvFast(e,255,255):(e=255-e)<85?this.hex(3*e,255,255-3*e):e<170?(e-=85,this.hex(255,255-3*e,3*e)):(e-=170,this.hex(255-3*e,3*e,255))}hsvFast(e,t,n){let i=e%255|0;i<0&&(i+=255),i=192*i/255|0;let r,s,o,a=n*(255-t)/255|0,l=n-a,c=i/64|0,u=i%64|0,d=(u*l/63.75|0)+a,p=((63-u)*l/63.75|0)+a;return c?1==c?(r=a,s=p,o=d):(r=d,s=a,o=p):(r=p,s=d,o=a),this.hex(r,s,o)}hex(e,t,n){return`#${this.componentToHex(255&e)}${this.componentToHex(255&t)}${this.componentToHex(255&n)}`}componentToHex(e){let t=e.toString(16);return 1==t.length?"0"+t:t}}n.FieldColorWheel=r},{"../plugins/math":120}],33:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldColorNumber=void 0;const i=e("@blockly/field-grid-dropdown"),r=e("blockly/core");class s extends i.FieldGridDropdown{constructor(e,t,n){var i;let r,s;const a=null!==(i=t.valueMode)&&void 0!==i?i:"rgb",l="#dedede";t.colours?(r=JSON.parse(t.colours),r.lastIndexOf(r[0])>0&&(r[0]=l)):pxt.appTarget.runtime&&pxt.appTarget.runtime.palette&&(r=pxt.Util.clone(pxt.appTarget.runtime.palette),r[0]=l,pxt.appTarget.runtime.paletteNames&&(s=pxt.Util.clone(pxt.appTarget.runtime.paletteNames),s[0]=lf("transparent"))),super(function(e,t,n){const i=t.map(n=>o(n,e,t));return i.map((e,i)=>{const r=document.createElement("div");return r.className="blocklyColourSwatch",r.style.backgroundColor=t[i],n&&i<n.length&&(r.title=n[i]),[r,e]})}(a,r,s),n,{primaryColour:"white",borderColour:"#dadce0",columns:t.columns?parseInt(t.columns):7}),this.isFieldCustom_=!0,this.isDirty_=!1,this.allColoursCSSFormat_=r,this.valueMode_=a,this.setValue(e)}trimOptions(e){return{options:e}}initView(){const e=this.getConstants();if(!e)throw Error("Constants not found");this.size_=new r.utils.Size(e.FIELD_COLOUR_DEFAULT_WIDTH,e.FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}showEditor_(e){super.showEditor_(e),r.DropDownDiv.getContentDiv().classList.add("blocklyFieldColour"),r.DropDownDiv.repositionForWindowResize()}isFullBlockField(){if(!this.getSourceBlock())throw new r.UnattachedFieldError;const e=this.getConstants();return this.blockIsSimpleReporter()&&Boolean(null==e?void 0:e.FIELD_COLOUR_FULL_BLOCK)}blockIsSimpleReporter(){const e=this.getSourceBlock();if(!e)throw new r.UnattachedFieldError;if(!e.outputConnection)return!1;for(const t of e.inputList)if(t.connection||t.fieldRow.length>1)return!1;return!0}applyColour(){const e=this.getSourceBlock();if(!e)throw new r.UnattachedFieldError;if(!this.fieldGroup_)return;const t=this.borderRect_;if(!t)throw new Error("The border rect has not been initialized");this.isFullBlockField()?(t.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getCSSValue()),e.pathObject.svgPath.setAttribute("stroke","#fff")):(t.style.display="block",t.style.fill=this.getCSSValue())}getSize(){var e;return(null===(e=this.getConstants())||void 0===e?void 0:e.FIELD_COLOUR_FULL_BLOCK)&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){this.updateSize_();const e=this.getSourceBlock();if(!e)throw new r.UnattachedFieldError;e.applyColour()}updateSize_(e){const t=this.getConstants();if(!t)return;let n,i;if(this.isFullBlockField()){n=2*(null!=e?e:0),i=t.FIELD_TEXT_HEIGHT}else n=t.FIELD_COLOUR_DEFAULT_WIDTH,i=t.FIELD_COLOUR_DEFAULT_HEIGHT;this.size_.height=i,this.size_.width=n,this.positionBorderRect_()}doClassValidation_(e){if(!this.allColoursCSSFormat_)return e;if("string"!=typeof e)return null;return o(a(e,this.allColoursCSSFormat_),this.valueMode_,this.allColoursCSSFormat_)}getText(){let e=this.getCSSValue();return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e}getFieldDescription(){const e=this.getCSSValue();return e?lf("color ${0}",e):lf("color")}getCSSValue(){return a(this.getValue(),this.allColoursCSSFormat_)}}function o(e,t,n){switch(t){case"hex":return`"${e}"`;case"rgb":return e.indexOf("#")>-1?`0x${e.replace(/^#/,"")}`:e;case"index":if(!e)return"-1";for(let t=0;t<n.length;t++)if(e.toUpperCase()===n[t].toUpperCase())return t+""}return e}function a(e,t){if(e){const n=/Colors\.([a-zA-Z]+)/.exec(e),i=/(0x|#)([0-9a-fA-F]+)/.exec(e);if(n)switch(n[1].toLocaleLowerCase()){case"red":return"#FF0000";case"orange":return"#FF7F00";case"yellow":return"#FFFF00";case"green":return"#00FF00";case"blue":return"#0000FF";case"indigo":return"#4B0082";case"violet":return"#8A2BE2";case"purple":return"#A033E5";case"pink":return"#FF007F";case"white":return"#FFFFFF";case"black":return"#000000";default:return e}else if(i){const e=i[2];if(3===e.length){let t="#";for(let n=0;n<e.length;n++){const i=e.charAt(n);t+=i+i}return t}if(6===e.length)return"#"+e}const r=parseInt(e);return isNaN(r)||null==t[r]?t[0]:t[r]}return e}n.FieldColorNumber=s,r.Css.register("\n.blocklyColourSwatch {\n    width: 22px;\n    height: 22px;\n}\n\n.blocklyFieldColour.blocklyFieldGridContainer {\n    padding: 0px;\n}\n\n.blocklyFieldColour .blocklyFieldGrid {\n    grid-gap: 0px;\n    row-gap: 0px;\n    outline: none;\n}\n\n.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItem {\n    padding: 0;\n    border: none;\n    margin: 2px;\n}\n\n.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItem .blocklyColourSwatch {\n    border: 2px solid rgba(0,0,0,.1);\n    border-radius: 4px;\n}\n\n.blocklyFieldColour .blocklyFieldGridItem:focus .blocklyColourSwatch {\n    box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);\n    border-color: #eee;\n    border-width: 1px;\n}\n\n.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItemSelected .blocklyColourSwatch {\n    outline: 1px solid #000;\n    border-color: #eee;\n    border-width: 1px;\n}\n")},{"@blockly/field-grid-dropdown":170,"blockly/core":175}],34:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldDropdown=void 0;const i=e("blockly"),r=e("../plugins/newVariableField/fieldDropdownMixin");class s extends i.FieldDropdown{constructor(){super(...arguments),this.svgRootBinding=null,this.fieldRootBinding=null}initView(){super.initView(),this.fieldGroup_&&this.fieldGroup_.classList.add("pxtFieldDropdown"),this.shouldAddBorderRect_()||(this.createBorderRect_(),this.clickTargetRect=this.borderRect_,this.clickTargetRect.setAttribute("stroke-opacity","0"),this.clickTargetRect.setAttribute("fill-opacity","0"),this.borderRect_=void 0)}shouldAddBorderRect_(){if("variables_get"===this.sourceBlock_.type)return!1;for(const e of this.sourceBlock_.inputList)for(const t of e.fieldRow)if(t!==this&&t.EDITABLE)return!0;return!this.sourceBlock_.getInputsInline()||super.shouldAddBorderRect_()}bindEvents_(){this.shouldAddBorderRect_()?super.bindEvents_():(this.svgRootBinding=i.browserEvents.conditionalBind(this.sourceBlock_.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length||this.onMouseDown_(e)},!1),this.fieldRootBinding=i.browserEvents.conditionalBind(this.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length&&this.onMouseDown_(e)},!1))}dispose(){super.dispose(),this.svgRootBinding&&(i.browserEvents.unbind(this.svgRootBinding),i.browserEvents.unbind(this.fieldRootBinding))}positionBorderRect_(){super.positionBorderRect_(),this.clickTargetRect&&(this.clickTargetRect.setAttribute("width",String(this.size_.width)),this.clickTargetRect.setAttribute("height",String(this.size_.height)),this.clickTargetRect.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.clickTargetRect.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}showEditor_(e){r.showEditorMixin.call(this,e)}}n.FieldDropdown=s,i.Css.register("\n.pxtFieldDropdown.blocklyActiveFocus > .blocklyFieldRect, .pxtFieldDropdown.blocklyPassiveFocus > .blocklyFieldRect {\n    stroke-opacity: 1;\n}\n")},{"../plugins/newVariableField/fieldDropdownMixin":122,blockly:176}],35:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldDropdownGrid=void 0;const i=e("blockly"),r=e("./field_dropdown");class s extends r.FieldDropdown{constructor(){super(...arguments),this.isFieldCustom_=!0,this.gridItems=[],this.keyDownBinding=null,this.pointerMoveBinding=null}setFocusedItem(e,t){this.lastUserInputAction="keymove",this.setFocusedItem_(e),e.setAttribute("aria-activedescendant",":"+this.activeDescendantIndex),t.preventDefault(),t.stopPropagation()}setOpeningPointerCoords(e){if(!e)return;const{pageX:t,pageY:n}=e;void 0!==t&&void 0!==n&&(this.openingPointerCoords={x:t,y:n})}addKeyDownHandler(e){const t=pxt.Util.isUserLanguageRtl()?"ArrowLeft":"ArrowRight",n=pxt.Util.isUserLanguageRtl()?"ArrowRight":"ArrowLeft";this.keyDownBinding=i.browserEvents.bind(e,"keydown",this,i=>{if(void 0===this.activeDescendantIndex){if("ArrowDown"===i.code||i.code===t||"Home"===i.code)return this.activeDescendantIndex=0,this.setFocusedItem(e,i);if("ArrowUp"===i.code||i.code===n||"End"===i.code)return this.activeDescendantIndex=this.gridItems.length-1,this.setFocusedItem(e,i)}const r=pxt.BrowserUtils.isMac()?i.metaKey:i.ctrlKey;switch(i.code){case"ArrowUp":this.activeDescendantIndex-this.columns_>=0&&(this.activeDescendantIndex-=this.columns_);break;case"ArrowDown":this.activeDescendantIndex+this.columns_<this.gridItems.length&&(this.activeDescendantIndex+=this.columns_);break;case t:this.activeDescendantIndex<this.gridItems.length-1&&this.activeDescendantIndex++;break;case n:0!==this.activeDescendantIndex&&this.activeDescendantIndex--;break;case"Home":if(r)this.activeDescendantIndex=0;else for(;this.activeDescendantIndex%this.columns_!==0;)this.activeDescendantIndex--;break;case"End":if(r)this.activeDescendantIndex=this.gridItems.length-1;else for(;this.activeDescendantIndex%this.columns_!==this.columns_-1&&this.activeDescendantIndex<this.gridItems.length-1;)this.activeDescendantIndex++;break;case"Enter":case"Space":return this.buttonClickAndClose_(this.gridItems[this.activeDescendantIndex].getAttribute("data-value")),i.preventDefault(),void i.stopPropagation();default:return}this.setFocusedItem(e,i)})}addPointerListener(e){this.pointerMoveBinding=i.browserEvents.bind(e,"pointermove",this,()=>{this.lastUserInputAction="pointermove"})}pointerMoveTriggeredByUser(){return this.openingPointerCoords&&!this.lastUserInputAction||"pointermove"===this.lastUserInputAction}pointerOutTriggeredByUser(){return"pointermove"===this.lastUserInputAction}disposeGrid(){this.keyDownBinding&&i.browserEvents.unbind(this.keyDownBinding),this.pointerMoveBinding&&i.browserEvents.unbind(this.pointerMoveBinding),this.keyDownBinding=null,this.pointerMoveBinding=null,this.openingPointerCoords=void 0,this.lastUserInputAction=void 0,this.activeDescendantIndex=void 0,this.gridItems=[]}}n.FieldDropdownGrid=s},{"./field_dropdown":34,blockly:176}],36:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldGridPicker=void 0;const i=e("blockly"),r=e("./field_utils"),s=e("./field_base"),o=e("./field_dropdowngrid");class a extends o.FieldDropdownGrid{constructor(e,t,n){super(t.data),this.tabKeyBind=null,this.buttonClick_=e=>{null!==e&&(this.setValue(e),this.closeModal_&&(this.close(),this.closeModal_=!1))},this.buttonClickAndClose_=e=>{this.closeModal_=!0,this.buttonClick_(e)},this.columns_=parseInt(t.columns)||4,this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||void 0,this.backgroundColour_=(0,r.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1);let i={xOffset:parseInt(t.tooltipsXOffset)||15,yOffset:parseInt(t.tooltipsYOffset)||-10};this.tooltipConfig_=i,this.hasSearchBar_=!!t.hasSearchBar||!1}setFocusedItem_(e){this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused","gridpicker-menuitem-highlight"));const t=this.gridItems[this.activeDescendantIndex];t.classList.add("gridpicker-option-focused"),i.utils.style.scrollIntoContainerView(t,this.scrollContainer);const n=t.getBoundingClientRect();if(this.gridTooltip_){const e=t.title||t.alt;this.gridTooltip_.textContent=e,this.gridTooltip_.style.visibility=e?"visible":"hidden",this.gridTooltip_.style.display=e?"":"none",this.gridTooltip_.style.top=`${n.bottom+5}px`,this.gridTooltip_.style.left=`${n.left}px`}this.addKeyboardNavigableClass()}dispose(){super.dispose(),this.disposeGrid(),this.disposeTooltip(),this.disposeIntersectionObserver()}createTooltip_(){this.gridTooltip_||(this.gridTooltip_=document.createElement("div"),this.gridTooltip_.className="blocklyGridPickerTooltip",this.gridTooltip_.style.position="absolute",this.gridTooltip_.style.display="none",this.gridTooltip_.style.visibility="hidden",document.body.appendChild(this.gridTooltip_))}populateTableContainer(e,t,n){this.gridItems=[],this.activeDescendantIndex=0,pxsim.U.removeChildren(t),0==e.length&&(this.firstItem_=void 0);for(let n=0;n<e.length/this.columns_;n++){let i=this.populateRow(n,e,t);t.appendChild(i)}}populateRow(e,t,n){const r=this.columns_,s=document.createElement("div");s.className="blocklyGridPickerRow";for(let o=r*e;o<Math.min(r*e+r,t.length);o++){let e=t[o][0];const r=t[o][1],l=document.createElement("div");l.className="gridpicker-menuitem gridpicker-option",l.setAttribute("id",":"+o),l.setAttribute("role","gridcell"),l.setAttribute("aria-selected","false"),l.style.userSelect="none",l.title=e.alt||e,l.setAttribute("data-value",r);const c=document.createElement("div");c.setAttribute("class","gridpicker-menuitem-content"),c.title=e.alt||e,c.setAttribute("data-value",r);const u="object"==typeof e;let d=this.backgroundColour_;if(r==this.getValue()&&(l.setAttribute("aria-selected","true"),this.activeDescendantIndex=o,pxt.BrowserUtils.addClass(l,"gridpicker-option-selected "+(this.openingPointerCoords?"":"gridpicker-option-focused")),d=this.sourceBlock_.getColourTertiary(),this.selectedItemDom=l,u&&!this.shouldShowTooltips()&&this.updateSelectedBar_(e,r)),l.style.backgroundColor=d,l.style.borderColor=this.borderColour_,u){const t=new Image(e.width,e.height);t.setAttribute("draggable","false"),"IntersectionObserver"in window?(t.src=a.DEFAULT_IMG,t.setAttribute("data-src",e.src),this.observer.observe(t)):t.src=e.src,t.alt=e.alt||"",t.setAttribute("data-value",r),c.appendChild(t)}else c.textContent=e;if(this.shouldShowTooltips()){i.browserEvents.conditionalBind(l,"click",this,()=>this.buttonClickAndClose_(r));const e=this.sourceBlock_.RTL?-this.tooltipConfig_.xOffset:this.tooltipConfig_.xOffset,t=this.tooltipConfig_.yOffset;i.browserEvents.bind(l,"pointermove",this,i=>{if(this.pointerMoveTriggeredByUser()){if(this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused")),this.activeDescendantIndex=o,u){this.gridTooltip_.style.top=`${i.clientY+t}px`,this.gridTooltip_.style.left=`${i.clientX+e}px`;const n=document.elementFromPoint(i.clientX,i.clientY),r=n.title||n.alt;this.gridTooltip_.textContent=r,this.gridTooltip_.style.visibility=r?"visible":"hidden",this.gridTooltip_.style.display=r?"":"none"}pxt.BrowserUtils.addClass(l,"gridpicker-menuitem-highlight"),n.setAttribute("aria-activedescendant",l.id)}}),i.browserEvents.bind(l,"pointerout",this,e=>{this.pointerOutTriggeredByUser()&&(this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused")),u&&(this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"),pxt.BrowserUtils.removeClass(l,"gridpicker-menuitem-highlight"),n.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)})}else u?(this.selectedBar_.style.display="",i.browserEvents.conditionalBind(l,"click",this,t=>{if(this.closeModal_)this.buttonClick_(r);else{const t=n.getElementsByClassName("gridpicker-menuitem-highlight");for(let e=0;e<t.length;e++)pxt.BrowserUtils.removeClass(t[e],"gridpicker-menuitem-highlight");pxt.BrowserUtils.addClass(l,"gridpicker-menuitem-highlight"),this.updateSelectedBar_(e,r)}})):(i.browserEvents.conditionalBind(l,"click",this,()=>this.buttonClickAndClose_(r)),i.browserEvents.conditionalBind(l,"mouseup",this,()=>this.buttonClickAndClose_(r)));l.appendChild(c),this.gridItems.push(l),s.appendChild(l),0==o&&(this.firstItem_=l)}return s}doClassValidation_(e){return e}getFieldDescription(){return this.getValue()}close(){this.disposeTooltip(),this.disposeGrid(),i.WidgetDiv.hideIfOwner(this),i.Events.setGroup(!1),this.tabKeyBind&&i.browserEvents.unbind(this.tabKeyBind)}highlightFirstItem(e){let t=e.childNodes;if(t.length&&t[0].childNodes){for(let e=0;e<t.length;++e){let n=t[e].childNodes.length;for(let i=0;i<n;++i){const n=t[e].childNodes[i];pxt.BrowserUtils.removeClass(n,"gridpicker-menuitem-highlight"),pxt.BrowserUtils.removeClass(n,"gridpicker-option-selected")}}t[0].childNodes[0].className+=" gridpicker-menuitem-highlight"}}highlightAndScrollSelected(e,t){this.selectedItemDom&&i.utils.style.scrollIntoContainerView(this.selectedItemDom,t,!0)}showEditor_(e){this.setOpeningPointerCoords(e),i.WidgetDiv.show(this,this.sourceBlock_.RTL,()=>{this.onClose_()}),this.setupIntersectionObserver_(),this.createTooltip_();const t=document.createElement("div");this.positionMenu_(t),t.focus(),e||this.addKeyboardNavigableClass()}positionMenu_(e){const t=i.utils.svgMath.getViewportBBox(),n=this.getAnchorDimensions_(),{paddingContainer:r,scrollContainer:s}=this.createWidget_(e);this.scrollContainer=s;const o={width:r.offsetWidth,height:r.offsetHeight},a=window.outerHeight||window.innerHeight;if(this.width_){const t=window.outerWidth||window.innerWidth;this.width_>t&&(this.width_=t),e.style.width=this.width_+"px"}let l=0;if(this.hasSearchBar_&&(l+=50),this.selectedBar_&&(l+=50),this.maxRows_){let t=e.children[0].offsetHeight*(this.maxRows_+.3);a<t+l&&(t=a-l),o.height>t&&(s.style.overflowY="auto",s.style.height=t+"px",o.height=t)}o.height+=l,i.WidgetDiv.positionWithAnchor(t,n,o,this.sourceBlock_.RTL),this.highlightAndScrollSelected(e,s)}shouldShowTooltips(){return!pxt.BrowserUtils.isMobile()}getAnchorDimensions_(){const e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=s.FieldBase.CHECKMARK_OVERHANG:e.left-=s.FieldBase.CHECKMARK_OVERHANG,e}createWidget_(e){const t=i.WidgetDiv.getDiv(),n=this.getOptions();e.setAttribute("role","grid"),e.setAttribute("tabindex","0"),this.addPointerListener(t),this.addKeyDownHandler(e);const r=document.createElement("div"),s=document.createElement("div");let o,a;if(s.style.border=`solid 1px ${this.borderColour_}`,e.style.backgroundColor=this.backgroundColour_,r.style.backgroundColor=this.backgroundColour_,s.style.backgroundColor=this.backgroundColour_,e.className="blocklyGridPickerMenu",r.className="blocklyGridPickerScroller",s.className="blocklyGridPickerPadder",s.appendChild(r),r.appendChild(e),t.appendChild(s),this.hasSearchBar_){const{searchBarDiv:t,searchBar:i}=this.createSearchBar_(e,r,n);s.insertBefore(t,s.childNodes[0]),o=i}if(!this.shouldShowTooltips()){const{selectedBar:e,cancelButton:t}=this.createSelectedBar_();this.selectedBar_=e,a=t,s.appendChild(this.selectedBar_)}return this.populateTableContainer(n,e,r),(this.hasSearchBar_||this.selectedBar_)&&(this.firstFocusableElement=o||e,this.lastFocusableElement=a||e,this.tabKeyBind=i.browserEvents.bind(t,"keydown",this,this.handleTabKey.bind(this))),{paddingContainer:s,scrollContainer:r}}createSearchBar_(e,t,n){const i=document.createElement("div");i.setAttribute("class","ui fluid icon input");const r=document.createElement("i");r.setAttribute("class","search icon");const s=document.createElement("input");return s.setAttribute("type","search"),s.setAttribute("id","search-bar"),s.setAttribute("class","blocklyGridPickerSearchBar"),s.setAttribute("placeholder",pxt.Util.lf("Search")),s.setAttribute("tabindex","0"),s.addEventListener("click",()=>{s.focus(),s.setSelectionRange(0,s.value.length)}),s.addEventListener("keyup",pxt.Util.debounce(i=>{if("Tab"===i.code)return;let r=s.value,o=new RegExp(r,"i"),a=n.filter(e=>{const t=e[0].alt,n=e[1];return t?o.test(t):o.test(n)});this.populateTableContainer(a,e,t),r?this.highlightFirstItem(e):this.highlightAndScrollSelected(e,t),this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"},300,!1)),s.addEventListener("keyup",t=>{if(13==t.which){const t=e.childNodes[0];if(t){const e=t.childNodes[0];e&&(this.closeModal_=!0,e.click())}}}),i.appendChild(s),i.appendChild(r),{searchBarDiv:i,searchBar:s}}createSelectedBar_(){const e=document.createElement("div");e.setAttribute("class","blocklyGridPickerSelectedBar"),e.style.display="none";const t=document.createElement("div"),n=document.createElement("div");n.className="blocklyGridPickerSelectedImage",t.appendChild(n),this.selectedImg_=document.createElement("img"),this.selectedImg_.setAttribute("width","30px"),this.selectedImg_.setAttribute("height","30px"),this.selectedImg_.setAttribute("draggable","false"),this.selectedImg_.style.display="none",this.selectedImg_.src=a.DEFAULT_IMG,n.appendChild(this.selectedImg_),this.selectedBarText_=document.createElement("span"),this.selectedBarText_.className="blocklyGridPickerTooltip",t.appendChild(this.selectedBarText_);const r=document.createElement("div"),s=document.createElement("div");s.className="ui buttons mini",r.appendChild(s);const o=document.createElement("button");o.className="ui button icon green";const l=document.createElement("i");l.className="icon check",o.appendChild(l),i.browserEvents.conditionalBind(o,"click",this,()=>{this.setValue(this.selectedBarValue_),this.close()});const c=document.createElement("button");c.className="ui button icon red";const u=document.createElement("i");return u.className="icon cancel",c.appendChild(u),i.browserEvents.conditionalBind(c,"click",this,()=>{this.close()}),s.appendChild(o),s.appendChild(c),e.appendChild(t),e.appendChild(r),{selectedBar:e,cancelButton:c}}updateSelectedBar_(e,t){e.src&&(this.selectedImg_.src=e.src,this.selectedImg_.style.display=""),this.selectedImg_.alt=e.alt||e,this.selectedBarText_.textContent=e.alt||e,this.selectedBarValue_=t}setupIntersectionObserver_(){if(!("IntersectionObserver"in window))return;this.disposeIntersectionObserver();this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.intersectionRatio>0&&(this.observer.unobserve(e.target),(e=>{const t=e.getAttribute("data-src");t&&(e.src=t,e.removeAttribute("data-src"))})(e.target))})},{rootMargin:"20px 0px",threshold:.01})}disposeIntersectionObserver(){this.observer&&(this.observer=null)}disposeTooltip(){this.gridTooltip_&&(pxsim.U.remove(this.gridTooltip_),this.gridTooltip_=null)}onClose_(){this.disposeTooltip(),this.disposeGrid()}handleTabKey(e){"Tab"===e.code&&(this.addKeyboardNavigableClass(),document.activeElement!==this.lastFocusableElement||e.shiftKey?document.activeElement===this.firstFocusableElement&&e.shiftKey&&(this.lastFocusableElement.focus(),e.preventDefault()):(this.firstFocusableElement.focus(),e.preventDefault()))}addKeyboardNavigableClass(){this.scrollContainer&&this.scrollContainer.classList.add("keyboardNavigable")}}n.FieldGridPicker=a,a.DEFAULT_IMG="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",i.Css.register("\n.blocklyGridPickerTooltip {\n    z-index: 995;\n}\n\n.blocklyGridPickerPadder {\n    outline: none;\n    box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, .3)\n}\n\n.blocklyWidgetDiv .blocklyGridPickerRow {\n    display: table-row;\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu {\n    display: table;\n    outline: none;\n    border-spacing: 7px;\n}\n\n.blocklyGridPickerScroller {\n    outline: none;\n    padding: 4px;\n    border-radius: 4px;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n}\n\n.blocklyGridPickerScroller.keyboardNavigable:has(:focus-visible) {\n    outline: 4px solid var(--pxt-focus-border);\n}\n\n.blocklyGridPickerPadder {\n    border-radius: 4px;\n    outline: none;\n    position: relative;\n}\n\n.blocklyGridPickerPadder .ui.input i.search.icon {\n    margin-top: -0.2rem;\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem {\n    background: white;\n    cursor: pointer;\n    min-width: unset;\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-highlight, .blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-hover {\n    background: #d6e9f8;\n    box-shadow: 0px 0px 0px 4px rgba(255, 255, 255, 0.2);\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-option {\n    border: solid 1px black;\n    border-radius: 4px;\n    color: #fff;\n    font-size: 12pt;\n    font-weight: bold;\n    display: table-cell;\n    padding: 8px;\n    text-align: center;\n    vertical-align: top;\n    -webkit-user-select: none;\n    -moz-user-select: -moz-none;\n    -ms-user-select: none;\n        user-select: none;\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-content {\n    color: #fff;\n    font-size: 13px;\n    font-family: var(--pxt-page-font);\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu .floatLeft {\n    float: left;\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-option.gridpicker-option-selected {\n    position: relative;\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem .gridpicker-menuitem-checkbox {\n    display: none;\n}\n\n.blocklyWidgetDiv .blocklyGridPickerMenu:focus .blocklyGridPickerRow .gridpicker-menuitem.gridpicker-option-focused {\n    outline: 3px solid var(--pxt-focus-border);\n}\n\n.blocklyGridPickerTooltip {\n    z-index: 995;\n}\n\n.blocklyGridPickerSelectedBar {\n    display: flex;\n    padding-top: 5px;\n    justify-content: space-between;\n}\n\n.blocklyGridPickerSelectedImage {\n    padding: 3px;\n    display: inline-block;\n    vertical-align: middle;\n}\n\n.ui.input input.blocklyGridPickerSearchBar {\n    background: none;\n    border: none;\n    color: white;\n}\n\n.ui.input input.blocklyGridPickerSearchBar::placeholder {\n    color: white;\n}\n\n.ui.input input.blocklyGridPickerSearchBar::-webkit-input-placeholder {\n    color: white;\n}\n\n.ui.input input.blocklyGridPickerSearchBar::-moz-placeholder {\n    color: white;\n}\n\n.ui.input input.blocklyGridPickerSearchBar:-ms-input-placeholder {\n    color: white;\n}\n\n.ui.input input.blocklyGridPickerSearchBar:-moz-placeholder {\n    color: white;\n}\n")},{"./field_base":31,"./field_dropdowngrid":35,"./field_utils":69,blockly:176}],37:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldImageDropdown=void 0;const i=e("blockly"),r=e("./field_utils"),s=e("./field_dropdowngrid");class o extends s.FieldDropdownGrid{constructor(e,t,n){super(t.data),this.buttonClickAndClose_=e=>{e&&(this.setValue(e),i.DropDownDiv.hide())},this.columns_=parseInt(t.columns),this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||300,this.backgroundColour_=(0,r.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1)}setFocusedItem_(e){this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton"));const t=this.gridItems[this.activeDescendantIndex],n=t.parentElement;t.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonFocus");const i=n.getBoundingClientRect(),r=e.parentElement.getBoundingClientRect();i.bottom>r.bottom?n.scrollIntoView({block:"end"}):i.top<r.top&&n.scrollIntoView({block:"start"})}createRow(){const e=document.createElement("div");return e.setAttribute("role","row"),e}showEditor_(e){if(this.setOpeningPointerCoords(e),i.DropDownDiv.hideIfOwner(this))return;i.DropDownDiv.hideWithoutAnimation(),(0,r.clearDropDownDiv)();let t=i.DropDownDiv.getContentDiv(),n=document.createElement("div");n.setAttribute("role","grid"),n.setAttribute("tabindex","0"),n.classList.add("blocklyMenu","blocklyDropdownMenu"),this.addPointerListener(t),this.addKeyDownHandler(n);const s=[];let o={height:0,width:0,items:[]};const l=this.getOptions(),c=this.columns_?this.width_/this.columns_-8:0;for(let e=0;e<l.length;e++){const t=l[e][0];let n=t.width,i=t.height;"placeholder"!=t.type&&this.columns_&&(n=c,i=c),o.height&&o.width+n+8>this.width_?(s.push(o),o={width:n+8,height:i+8,items:[l[e]]}):(o.width+=n+8,o.height=Math.max(o.height,i+8),o.items.push(l[e]))}let u;s.push(o);let d=0;for(const e of s){const t=this.createRow();t.style.width=e.width+"px",t.style.height=e.height+"px",n.appendChild(t);for(const r of e.items){const s=d;let o=r[0];const a=r[1];if("placeholder"==o.type){let n=document.createElement("span");n.setAttribute("class","blocklyDropDownPlaceholder"),n.style.width=o.width+"px",n.style.height=e.height+"px",t.appendChild(n);continue}const l=document.createElement("div");l.setAttribute("class","blocklyDropDownButtonContainer");const p=document.createElement("div");p.setAttribute("id",":"+s),p.setAttribute("role","gridcell"),p.setAttribute("aria-selected","false"),p.classList.add("blocklyDropDownButton"),p.title=o.alt,p.style.width=(c||o.width)+"px",p.style.height=(c||o.height)+"px";let h=this.backgroundColour_;a==this.getValue()&&(h=this.sourceBlock_.getColourTertiary(),p.setAttribute("aria-selected","true"),this.activeDescendantIndex=s,n.setAttribute("aria-activedescendant",p.id),p.setAttribute("class","blocklyDropDownButton "+(this.openingPointerCoords?"blocklyDropDownButtonHover":"blocklyDropDownButtonFocus")),u=l),p.style.backgroundColor=h,p.style.borderColor=this.borderColour_,i.browserEvents.bind(p,"click",this,()=>this.buttonClickAndClose_(a)),i.browserEvents.bind(p,"pointermove",this,()=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton")),this.activeDescendantIndex=s,p.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),n.setAttribute("aria-activedescendant",p.id))}),i.browserEvents.bind(p,"pointerout",this,()=>{this.pointerOutTriggeredByUser()&&(p.setAttribute("class","blocklyDropDownButton"),n.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)});let f=document.createElement("img");f.src=o.src,p.setAttribute("data-value",a),f.setAttribute("data-value",a),p.appendChild(f),this.gridItems.push(p),l.appendChild(p),t.append(l),d++}}if(t.appendChild(n),this.maxRows_){const e=a(s);let n=a(s.slice(0,this.maxRows_));s.length>this.maxRows_&&(n+=.4*s[this.maxRows_].height),t.style.maxHeight=n+"px",t.style.height=e+"px"}pxt.BrowserUtils.isFirefox()&&(t.style.paddingRight="20px"),i.DropDownDiv.setColour(this.backgroundColour_,this.borderColour_),i.DropDownDiv.showPositionedByField(this,this.onHide_.bind(this)),n.focus(),u&&u.scrollIntoView({block:"end"});let p=this.sourceBlock_;this.savedPrimary_=null==p?void 0:p.getColour(),(null==p?void 0:p.isShadow())?p.setColour(p.getColourTertiary()):this.borderRect_&&this.borderRect_.setAttribute("fill",p.getColourTertiary())}doValueUpdate_(e){this.selectedOption_=void 0,super.doValueUpdate_(e)}getFieldDescription(){return lf("image")}onHide_(){this.disposeGrid();let e=i.DropDownDiv.getContentDiv();e.removeAttribute("role"),e.removeAttribute("aria-activedescendant"),e.style.width="",e.style.paddingRight="",e.style.maxHeight="";let t=this.sourceBlock_;(null==t?void 0:t.isShadow())?this.sourceBlock_.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}}function a(e){return e.reduce((e,t)=>e+t.height,0)}n.FieldImageDropdown=o,i.Css.register("\n.blocklyDropDownButtonContainer,\n.blocklyDropDownButton {\n    display: inline-block;\n    float: left;\n    border-radius: 4px;\n    text-align: center;\n    margin: 0;\n}\n\n.blocklyDropDownButtonContainer {\n    padding: 4px;\n}\n\n.blocklyDropDownButton {\n    border: 1px solid;\n    transition: box-shadow .1s;\n    cursor: pointer;\n    outline: none;\n}\n\n.blocklyDropDownButtonHover {\n    box-shadow: 0px 0px 0px 4px rgba(255, 255, 255, 0.2);\n}\n\n.blocklyDropDownButtonFocus {\n    box-shadow: 0px 0px 0px 4px rgb(255, 255, 255);\n}\n\n.blocklyDropDownButton:active {\n    box-shadow: 0px 0px 0px 6px rgba(255, 255, 255, 0.2);\n}\n\n.blocklyDropDownButton > img {\n    width: 80%;\n    height: 80%;\n    position: relative;\n    top: 50%;\n    transform: translateY(-50%);\n}\n")},{"./field_dropdowngrid":35,"./field_utils":69,blockly:176}],38:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldImageNoText=void 0;const i=e("blockly");class r extends i.FieldImage{constructor(e,t,n,i,r,s,o){super(e,t,n,i,r,s,o),this.isFieldCustom_=!0}getFieldDescription(){}showEditor_(){super.showEditor_();this.getSourceBlock()instanceof i.BlockSvg&&i.getFocusManager().focusNode(this.getSourceBlock())}}n.FieldImageNoText=r},{blockly:176}],39:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldImages=void 0;const i=e("blockly"),r=e("./field_imagedropdown"),s=e("./field_utils");class o extends r.FieldImageDropdown{constructor(e,t,n){super(e,t,n),this.shouldSort_=t.sort,this.addLabel_=!!t.addLabel}showEditor_(e){if(this.setOpeningPointerCoords(e),i.DropDownDiv.hideIfOwner(this))return;let t=this.sourceBlock_;i.DropDownDiv.hideWithoutAnimation(),(0,s.clearDropDownDiv)();let n=i.DropDownDiv.getContentDiv(),r=document.createElement("div");r.setAttribute("role","grid"),r.setAttribute("tabindex","0"),r.setAttribute("class","blocklyMenu blocklyImageMenu"),this.addPointerListener(n),this.addKeyDownHandler(r);const o=this.getOptions();this.shouldSort_&&o.sort();let a=this.createRow();for(let e=0;e<o.length;e++){const n=o[e][0],s=o[e][1];if("placeholder"==n.type){let e=document.createElement("span");e.setAttribute("class","blocklyDropDownPlaceholder"),e.style.width=n.width+"px",e.style.height=n.height+"px",r.appendChild(e);continue}const l=document.createElement("div");l.setAttribute("class","blocklyDropDownButtonContainer");let c=document.createElement("div");c.setAttribute("id",":"+e),c.setAttribute("role","gridcell"),c.setAttribute("aria-selected","false"),c.setAttribute("class","blocklyDropDownButton"),c.title=n.alt,this.columns_?c.style.width=this.width_/this.columns_-8+"px":(c.style.width=n.width+"px",c.style.height=n.height+"px");let u=t.getColour();s==this.getValue()&&(u=t.getColourTertiary(),c.setAttribute("aria-selected","true"),this.activeDescendantIndex=e,r.setAttribute("aria-activedescendant",c.id),c.setAttribute("class","blocklyDropDownButton "+(this.openingPointerCoords?"blocklyDropDownButtonHover":"blocklyDropDownButtonFocus"))),c.style.backgroundColor=u,c.style.borderColor=t.getColourTertiary(),i.browserEvents.bind(c,"click",this,()=>this.buttonClickAndClose_(s)),i.browserEvents.bind(c,"pointermove",this,()=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton")),this.activeDescendantIndex=e,c.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),r.setAttribute("aria-activedescendant",c.id))}),i.browserEvents.bind(c,"pointerout",this,()=>{this.pointerOutTriggeredByUser()&&(c.setAttribute("class","blocklyDropDownButton"),r.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)});let d=document.createElement("img");if(d.src=n.src,c.setAttribute("data-value",s),d.setAttribute("data-value",s),c.appendChild(d),this.addLabel_){const e=this.createTextNode_(n.alt);e.setAttribute("data-value",s),c.appendChild(e)}this.gridItems.push(c),l.appendChild(c),a.append(l),a.childElementCount===this.columns_&&(r.appendChild(a),a=this.createRow())}a.childElementCount&&r.appendChild(a),r.style.width=this.width_+"px",n.appendChild(r),i.DropDownDiv.setColour(t.getColour(),t.getColourTertiary()),i.DropDownDiv.showPositionedByField(this,this.onHideCallback.bind(this)),r.focus(),this.savedPrimary_=null==t?void 0:t.getColour(),(null==t?void 0:t.isShadow())?t.setColour(t.style.colourTertiary):this.borderRect_&&this.borderRect_.setAttribute("fill",t.style.colourTertiary)}onHideCallback(){this.disposeGrid();const e=i.DropDownDiv.getContentDiv();e.removeAttribute("role"),e.removeAttribute("aria-activedescendant");let t=this.sourceBlock_;(null==t?void 0:t.isShadow())?t.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}createTextNode_(e){const t=document.createElement("span");return t.setAttribute("class","blocklyDropdownTextLabel"),t.textContent=e,t}}n.FieldImages=o,i.Css.register("\n.blocklyImageMenu .blocklyDropDownButton > img {\n    top: unset;\n    transform: unset;\n    margin-top: 4px;\n}\n.blocklyImageMenu .blocklyDropdownTextLabel {\n    line-height: 1.15;\n    margin-top: 2px;\n}\n")},{"./field_imagedropdown":37,"./field_utils":69,blockly:176}],40:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldKind=void 0;const i=e("blockly"),r=e("./field_utils"),s=e("../external"),o=e("./field_dropdown");class a extends o.FieldDropdown{constructor(e){super(function(e){return function(){const t=[],n=this.getSourceBlock();if((null==n?void 0:n.workspace)&&!n.isInFlyout){n.workspace.getVariableMap().getVariablesOfType(h(e.name)).forEach(e=>{t.push([e.getName(),e.getName()])})}else e.initialMembers.forEach(e=>t.push([e,e]));return t.push([lf("Add a new {0}...",e.memberName),"CREATE"]),t.push([void 0,"SEPARATOR"]),t.push([lf("Rename {0}...",e.memberName),"RENAME"]),t.push([lf("Delete {0}...",e.memberName),"DELETE"]),t}}(e)),this.opts=e}initView(){super.initView()}onItemSelected_(e,t){const n=t.getValue();if("CREATE"===n)c(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),e=>e&&this.setValue(e));else if("RENAME"===n){const e=this.sourceBlock_.workspace,t=e.getVariableMap().getVariable(this.value_,h(this.opts.name)),n=t.getName();if(-1!==this.opts.initialMembers.indexOf(n))return void i.dialog.alert(lf("The built-in {0} '{1}' cannot be renamed. Try creating a new kind instead!",this.opts.memberName,n));u(e,Object.assign(Object.assign({},this.opts),{toRename:t}),lf("Rename '{0}':",n),t=>{const i=(0,r.getAllFields)(e,e=>e instanceof a&&e.getValue()===n&&e.opts.name===this.opts.name);for(const e of i)e.ref.setValue(t)})}else if("DELETE"===n){const e=this.sourceBlock_.workspace,t=e.getVariableMap().getVariable(this.value_,h(this.opts.name)),n=t.getName();if(-1!==this.opts.initialMembers.indexOf(n))return void i.dialog.alert(lf("The built-in {0} '{1}' cannot be deleted.",this.opts.memberName,n));const s=(0,r.getAllFields)(e,e=>e instanceof a&&e.getValue()===n&&e.opts.name===this.opts.name);s.length>1?i.dialog.confirm(lf('Delete {0} uses of the "{1}" {2}?',s.length,n,this.opts.memberName),n=>{if(n){i.Events.setGroup(!0);for(const e of s)e.block.dispose(!0);e.getVariableMap().deleteVariable(t),this.setValue(this.opts.initialMembers[0]),i.Events.setGroup(!1)}}):(e.getVariableMap().deleteVariable(t),this.setValue(this.opts.initialMembers[0]))}else super.onItemSelected_(e,t)}doClassValidation_(e){var t,n;if("string"==typeof e&&(null===(t=this.sourceBlock_)||void 0===t?void 0:t.workspace)){d(this.sourceBlock_.workspace,this.opts.name).some(t=>t===e)||p(this.sourceBlock_.workspace,this.opts,e)}return(null===(n=this.opts)||void 0===n?void 0:n.initialMembers)&&!this.opts.initialMembers.find(t=>t==e)&&this.getOptions(),super.doClassValidation_(e)}getOptions(e){return this.initVariables(),super.getOptions(e)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){const e=this.sourceBlock_.workspace,t=d(e,this.opts.name);this.opts.initialMembers.forEach(n=>{-1===t.indexOf(n)&&p(e,this.opts,n)}),"CREATE"!==this.getValue()&&"RENAME"!==this.getValue()&&"DELETE"!==this.getValue()||this.opts.initialMembers.length&&this.setValue(this.opts.initialMembers[0])}}}function l(e,t,n,r,o){(0,s.prompt)(n,null,s=>{if(s){let a=!1;if(pxtc.isIdentifierStart(s.charCodeAt(0),2)){a=!0;for(let e=1;e<s.length;e++)pxtc.isIdentifierPart(s.charCodeAt(e),2)||(a=!1)}if(!a)return void i.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),()=>l(e,t,n,r,o));if(pxt.blocks.isReservedWord(s)||"CREATE"===s||"RENAME"===s||"DELETE"===s)return void i.dialog.alert(lf("'{0}' is a reserved word and cannot be used.",s),()=>l(e,t,n,r,o));const c=d(e,t.name);for(let a=0;a<c.length;a++){if(c[a]===s)return void i.dialog.alert(lf("A {0} named '{1}' already exists.",t.memberName,s),()=>l(e,t,n,r,o))}s===t.createFunctionName&&i.dialog.alert(lf("'{0}' is a reserved name.",t.createFunctionName),()=>l(e,t,n,r,o)),r(s)}},{placeholder:t.promptHint})}function c(e,t,n,i){l(e,t,n,n=>{i(p(e,t,n))},c)}function u(e,t,n,i){l(e,t,n,n=>{e.getVariableMap().renameVariable(t.toRename,n),i(n)},u)}function d(e,t){const n=e.getVariableMap().getVariablesOfType(h(t));return n&&n.length?n.map(e=>e.getName()):[]}function p(e,t,n){return i.Variables.getOrCreateVariablePackage(e,null,n,h(t.name)),n}function h(e){return"KIND_"+e}n.FieldKind=a},{"../external":25,"./field_dropdown":34,"./field_utils":69,blockly:176}],41:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldLedMatrix=void 0;const i=e("blockly"),r=e("./field_matrix"),s=/^.*[\.#].*$/;var o;!function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.Letter=2]="Letter"}(o||(o={}));class a extends r.FieldMatrix{constructor(e,t,n){if(super(e,n),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.onColor="#FFFFFF",this.scale=1,this.numMatrixCols=5,this.numMatrixRows=5,this.yAxisLabel=o.None,this.xAxisLabel=o.None,this.cellState=[],this.clearSelectionOnBlur=!0,this.forceFocusVisible=!0,this.dontHandleMouseEvent_=e=>{e.stopPropagation(),e.preventDefault()},this.clearLedDragHandler=e=>{const t=this.sourceBlock_.getSvgRoot();pxsim.pointerEvents.down.forEach(e=>t.removeEventListener(e,this.dontHandleMouseEvent_)),t.removeEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.removeEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.removeEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),i.Touch.clearTouchIdentifier(),this.matrixSvg.removeEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),e.stopPropagation(),e.preventDefault()},this.toggleCell=(e,t,n)=>{this.cellState[e][t]=null!=n?n:this.currentDragState_,this.updateValue()},this.handleRootMouseMoveListener=e=>{if(!this.sourceBlock_.isEditable())return;let t,n;e.changedTouches&&1==e.changedTouches.length?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):(t=e.clientX,n=e.clientY);const i=document.elementFromPoint(t,n);if(!i)return;const r=i.getAttribute("data-x"),s=i.getAttribute("data-y");null!=r&&null!=s&&this.toggleCell(parseInt(r),parseInt(s))},this.params=t,void 0!==this.params.rows){let e=parseInt(this.params.rows);isNaN(e)||(this.numMatrixRows=e)}if(void 0!==this.params.columns){let e=parseInt(this.params.columns);isNaN(e)||(this.numMatrixCols=e)}void 0!==this.params.onColor&&(this.onColor=this.params.onColor),void 0!==this.params.offColor&&(this.offColor=this.params.offColor),void 0!==this.params.scale?this.scale=Math.max(.6,Math.min(2,Number(this.params.scale))):Math.max(this.numMatrixCols,this.numMatrixRows)>15?this.scale=.85:Math.max(this.numMatrixCols,this.numMatrixRows)>10&&(this.scale=.9),this.size_.height=this.scale*Number(this.numMatrixRows)*(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)+2*a.CELL_VERTICAL_MARGIN+a.BOTTOM_MARGIN+this.getXAxisHeight(),this.size_.width=this.scale*Number(this.numMatrixCols)*(a.CELL_WIDTH+a.CELL_HORIZONTAL_MARGIN)+a.CELL_HORIZONTAL_MARGIN+this.getYAxisWidth()}getCellToggled(e,t){return this.cellState[e][t]}useTwoToneFocusIndicator(e,t){return this.getCellToggled(e,t)}showEditor_(){this.selected=[0,0];const e=this.matrixSvg.getBoundingClientRect(),t=i.WidgetDiv.getDiv();t.append(this.matrixSvg),this.addKeyboardFocusHandlers(),t.style.left=e.left+"px",t.style.top=e.top+"px",t.style.transform=`scale(${i.getMainWorkspace().getScale()})`,t.style.transformOrigin="0 0",i.WidgetDiv.show(this,this.sourceBlock_.RTL,()=>{this.removeKeyboardFocusHandlers(),this.clearCellSelection(),this.fieldGroup_.append(this.matrixSvg),t.style.left="",t.style.top="",t.style.transform="",t.style.transformOrigin=""}),this.matrixSvg.focus(),this.focusCell(0,0)}initMatrix(){if(!this.sourceBlock_.isInsertionMarker()){this.matrixSvg=pxsim.svg.parseString(`<svg xmlns="http://www.w3.org/2000/svg" id="field-matrix" class="blocklyMatrix" tabindex="-1" role="grid" width="${this.size_.width}" height="${this.size_.height}"/>`),this.matrixSvg.ariaLabel=lf("LED grid");const e=i.getMainWorkspace();this.matrixSvg.style.boxShadow=`rgba(255, 255, 255, 0.3) 0 0 0 ${4*e.getAbsoluteScale()}px`,this.matrixSvg.style.transition="box-shadow 0.25s",this.matrixSvg.style.borderRadius=4*e.getAbsoluteScale()+"px";for(let e=0;e<this.numMatrixCols;e++){this.cellState.push([]);for(let t=0;t<this.numMatrixRows;t++)this.cellState[e].push(!1)}if(this.restoreStateFromString(),this.createMatrixDisplay({cellWidth:a.CELL_WIDTH,cellHeight:a.CELL_WIDTH,cellLabel:lf("LED"),cellHorizontalMargin:a.CELL_HORIZONTAL_MARGIN,cellVerticalMargin:a.CELL_VERTICAL_MARGIN,cornerRadius:a.CELL_CORNER_RADIUS,cellFill:this.offColor,padLeft:this.getYAxisWidth(),scale:this.scale}),this.updateValue(),this.xAxisLabel!==o.None){const e=this.scale*this.numMatrixRows*(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)+2*a.CELL_VERTICAL_MARGIN+a.BOTTOM_MARGIN,t=pxsim.svg.child(this.matrixSvg,"g",{transform:`translate(0 ${e})`});for(let e=0;e<this.numMatrixCols;e++){const n=this.getYAxisWidth()+this.scale*e*(a.CELL_WIDTH+a.CELL_HORIZONTAL_MARGIN)+a.CELL_WIDTH/2+a.CELL_HORIZONTAL_MARGIN/2;pxsim.svg.child(t,"text",{x:n,class:"blocklyText"}).textContent=this.getLabel(e,this.xAxisLabel)}}if(this.yAxisLabel!==o.None){const e=pxsim.svg.child(this.matrixSvg,"g",{});for(let t=0;t<this.numMatrixRows;t++){const n=this.scale*t*(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)+a.CELL_WIDTH/2+2*a.CELL_VERTICAL_MARGIN;pxsim.svg.child(e,"text",{x:0,y:n,class:"blocklyText"}).textContent=this.getLabel(t,this.yAxisLabel)}}const t=i.utils.dom.createSvgElement("rect",{x:0,y:0,fill:"none",width:this.size_.width,height:this.size_.height},null);this.matrixSvg.append(t),this.fieldGroup_.classList.add("blocklyFieldLedMatrixGroup"),this.fieldGroup_.append(this.matrixSvg),this.attachEventHandlersToMatrix()}}getLabel(e,t){return t===o.Letter?String.fromCharCode(e+65):(e+1).toString()}updateEditable(){let e=this.fieldGroup_;this.EDITABLE&&e&&(this.sourceBlock_.isEditable()?this.fieldGroup_.setAttribute("cursor","pointer"):this.fieldGroup_.removeAttribute("cursor"),super.updateEditable())}attachPointerEventHandlersToCell(e,t,n){pxsim.pointerEvents.down.forEach(r=>n.addEventListener(r,n=>{if(!this.sourceBlock_.isEditable())return;const r=this.sourceBlock_.getSvgRoot();this.currentDragState_=!this.cellState[e][t],i.hideChaff(),i.common.setSelected(this.sourceBlock_),this.toggleCell(e,t),pxsim.pointerEvents.down.forEach(e=>r.addEventListener(e,this.dontHandleMouseEvent_)),r.addEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.addEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.addEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),this.matrixSvg.addEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),n.stopPropagation(),n.preventDefault(),this.returnEphemeralFocus()},!1))}getColor(e,t){return this.cellState[e][t]?this.onColor:this.offColor||a.DEFAULT_OFF_COLOR}getOpacity(e,t){const n=this.offColor?"1.0":"0.2";return this.cellState[e][t]?"1.0":n}updateCell(e,t){const n=this.cells[e][t];n.setAttribute("fill",this.getColor(e,t)),n.setAttribute("fill-opacity",this.getOpacity(e,t)),n.setAttribute("class","blocklyLed"+(this.cellState[e][t]?"On":"Off")),n.setAttribute("aria-checked",this.cellState[e][t].toString())}setValue(e,t=!0){const n=e!==this.value_;if(super.setValue(String(e),n),this.matrixSvg){t&&this.restoreStateFromString();for(let e=0;e<this.numMatrixCols;e++)for(let t=0;t<this.numMatrixRows;t++)this.updateCell(e,t)}}render_(){this.visible_?this.matrixSvg||this.initMatrix():this.markDirty()}getValue(){let e=function(e){const t=(e=(e||"").trim()).charAt(0);if(t===e.charAt(e.length-1)&&-1!==u.indexOf(t))return e.substr(1,e.length-2).trim();return e}(this.value_);return`\`\n${a.TAB}${e}\n${a.TAB}\``}getFieldDescription(){return lf("{0}x{1} LED Grid",this.numMatrixCols,this.numMatrixRows)}restoreStateFromString(){let e=this.value_;if(e){const t=e.split("\n").filter(e=>s.test(e));for(let e=0;e<t.length&&e<this.numMatrixRows;e++){let n=0;const i=t[e];for(let t=0;t<i.length&&n<this.numMatrixCols;t++)c(i[t])?(this.cellState[n][e]=!1,n++):l(i[t])&&(this.cellState[n][e]=!0,n++)}}}updateValue(){let e="";for(let t=0;t<this.numMatrixRows;t++){for(let n=0;n<this.numMatrixCols;n++)e+=(this.cellState[n][t]?"#":".")+" ";e+="\n"+a.TAB}this.setValue(e,!1)}getYAxisWidth(){return this.yAxisLabel===o.None?0:a.Y_AXIS_WIDTH}getXAxisHeight(){return this.xAxisLabel===o.None?0:a.X_AXIS_HEIGHT}}function l(e){return"#"===e||"*"===e||"1"===e}function c(e){return"."===e||"_"===e||"0"===e}n.FieldLedMatrix=a,a.CELL_WIDTH=25,a.CELL_HORIZONTAL_MARGIN=7,a.CELL_VERTICAL_MARGIN=5,a.CELL_CORNER_RADIUS=5,a.BOTTOM_MARGIN=9,a.Y_AXIS_WIDTH=9,a.X_AXIS_HEIGHT=10,a.TAB="        ",a.DEFAULT_OFF_COLOR="#000000";const u=["'",'"',"`"];i.Css.register("\n.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyEditableField:not(.blocklyEditing):hover>rect {\n    stroke: none;\n}\n.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyActiveFocus.blocklyEditableField:not(.blocklyEditing):hover>rect {\n    stroke: var(--blockly-active-node-color);\n    stroke-width: var(--blockly-selection-width);\n}\n.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyPassiveFocus.blocklyEditableField:not(.blocklyEditing):hover>rect {\n    stroke: var(--blockly-active-node-color);\n    stroke-dasharray: 5px 3px;\n    stroke-width: var(--blockly-selection-width);\n}\n.blocklyFieldLedMatrixGroup > .blocklyFieldRect {\n    fill: none !important;\n}")},{"./field_matrix":42,blockly:176}],42:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldMatrix=void 0;const i=e("blockly");class r extends i.Field{constructor(){super(...arguments),this.cells=[],this.keyDownBinding=null,this.blurBinding=null,this.selected=void 0,this.forceFocusVisible=!1,this.returnEphemeralFocusFn=void 0,this.getCellId=(e,t)=>`${this.sourceBlock_.id}:${e}-${t}`}createMatrixDisplay({cellWidth:e,cellHeight:t,cellLabel:n,cellHorizontalMargin:i,cellVerticalMargin:r,cornerRadius:s=0,cellFill:o,cellStroke:a,padLeft:l=0,scale:c=1}){for(let e=0;e<this.numMatrixCols;e++)this.cells.push([]);for(let u=0;u<this.numMatrixRows;u++){const d=pxsim.svg.child(this.matrixSvg,"g",{role:"row"});for(let p=0;p<this.numMatrixCols;p++){const h=c*p*(e+i)+i+l,f=c*u*(t+r)+r,m=pxsim.svg.child(d,"g",{transform:`translate(${h} ${f})`,role:"gridcell"}),g={id:this.getCellId(p,u),"aria-label":n,role:"switch","aria-checked":"false",width:c*e,height:c*t,fill:null!=o?o:"none",stroke:a,"data-x":p,"data-y":u,rx:Math.max(2,c*s)},_=pxsim.svg.child(m,"rect",g);this.cells[p][u]=_}}}handleArrowUp(e,t){this.selected=[e,t-1]}handleArrowDown(e,t){this.selected=[e,t+1]}handleArrowLeft(e,t){0!==e?this.selected=[e-1,t]:0!==t&&(this.selected=[this.numMatrixCols-1,t-1])}handleArrowRight(e,t){e!==this.cells.length-1?this.selected=[e+1,t]:t!==this.numMatrixRows-1&&(this.selected=[0,t+1])}addKeyDownHandler(){this.keyDownBinding=i.browserEvents.bind(this.matrixSvg,"keydown",this,e=>{if(!this.selected)return;const[t,n]=this.selected,i=pxt.BrowserUtils.isMac()?e.metaKey:e.ctrlKey;switch(e.code){case"ArrowUp":0!==n&&this.handleArrowUp(t,n);break;case"ArrowDown":n!==this.cells[0].length-1&&this.handleArrowDown(t,n);break;case"ArrowLeft":this.handleArrowLeft(t,n);break;case"ArrowRight":this.handleArrowRight(t,n);break;case"Home":this.selected=i?[0,0]:[0,n];break;case"End":this.selected=i?[this.numMatrixCols-1,this.numMatrixRows-1]:[this.numMatrixCols-1,n];break;case"Enter":case"Space":this.toggleCell(t,n,!this.getCellToggled(t,n));break;case"Escape":return this.sourceBlock_.workspace.markFocused(),void this.returnEphemeralFocus();default:return}const[r,s]=this.selected;this.focusCell(r,s),e.preventDefault(),e.stopPropagation()})}addBlurHandler(){this.blurBinding=i.browserEvents.bind(this.matrixSvg,"blur",this,e=>{this.clearSelectionOnBlur?(this.removeKeyboardFocusHandlers(),this.clearCellSelection()):this.clearFocusIndicator()})}focusCell(e,t){this.setCellSelection(e,t),this.setFocusIndicator(this.cells[e][t],this.useTwoToneFocusIndicator(e,t))}setCellSelection(e,t){this.matrixSvg.setAttribute("aria-activedescendant",this.getCellId(e,t))}clearCellSelection(){this.selected&&(this.clearFocusIndicator(),this.selected=void 0),this.matrixSvg.removeAttribute("aria-activedescendant")}setFocusIndicator(e,t){this.clearFocusIndicator();if(!this.matrixSvg.matches(":focus-visible")&&!this.forceFocusVisible)return;const n=e.parentNode,i=parseInt(e.getAttribute("width")),r=parseInt(e.getAttribute("rx"));pxsim.svg.child(n,"rect",{transform:"translate(-2, -2)",width:i+4,height:i+4,rx:`${Math.max(2,r)}px`,stroke:"#fff","stroke-width":4,fill:"none"}),t&&pxsim.svg.child(n,"rect",{transform:"translate(-1, -1)",width:i+2,height:i+2,rx:`${Math.max(2,r)}px`,stroke:"#000","stroke-width":2,fill:"none"})}clearFocusIndicator(){this.cells.forEach(e=>e.forEach(e=>{for(;e.nextElementSibling;)e.nextElementSibling.remove()}))}addKeyboardFocusHandlers(){this.sourceBlock_.isInFlyout||(this.addKeyDownHandler(),this.addBlurHandler())}attachEventHandlersToMatrix(){if(!this.sourceBlock_.isInFlyout)for(let e=0;e<this.numMatrixCols;++e)for(let t=0;t<this.numMatrixRows;++t)this.attachPointerEventHandlersToCell(e,t,this.cells[e][t])}returnEphemeralFocus(){if(this.returnEphemeralFocusFn){const e=this.returnEphemeralFocusFn;this.returnEphemeralFocusFn=void 0,e()}}removeKeyboardFocusHandlers(){this.keyDownBinding&&(i.browserEvents.unbind(this.keyDownBinding),this.keyDownBinding=void 0),this.blurBinding&&(i.browserEvents.unbind(this.blurBinding),this.blurBinding=void 0)}}n.FieldMatrix=r,i.Css.register("\n    .blocklyMatrix:focus-visible {\n        outline: none;\n    }\n")},{blockly:176}],43:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldCustomMelody=n.TOTAL_WIDTH=n.HEADER_HEIGHT=void 0;const i=e("blockly");var r=pxt.svgUtil;const s=e("./field_utils"),o=e("./field_matrix");n.HEADER_HEIGHT=50,n.TOTAL_WIDTH=300;class a extends o.FieldMatrix{constructor(e,t,n){super(e,n),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.soundingKeys=0,this.numMatrixRows=8,this.numMatrixCols=8,this.tempo=120,this.isPlaying=!1,this.timeouts=[],this.clearSelectionOnBlur=!1,this.matrixFocusBind=null,this.tabKeyBind=null,this.params=t,this.createMelodyIfDoesntExist()}init(){super.init(),this.onInit()}showEditor_(e){const t=!e;i.DropDownDiv.hideWithoutAnimation(),(0,s.clearDropDownDiv)(),i.DropDownDiv.setColour(this.getDropdownBackgroundColour(),this.getDropdownBorderColour());let n=i.DropDownDiv.getContentDiv();pxt.BrowserUtils.addClass(n,"melody-content-div"),pxt.BrowserUtils.addClass(n.parentElement,"melody-editor-dropdown"),this.gallery=new pxtmelody.MelodyGallery,this.renderEditor(n),this.addKeyboardFocusHandlers(),this.attachEventHandlersToMatrix(),this.matrixFocusBind=i.browserEvents.bind(this.matrixSvg,"focus",this,this.handleMatrixFocus.bind(this)),this.tabKeyBind=i.browserEvents.bind(n,"keydown",this,this.handleTabKey.bind(this)),this.prevString=this.getValue(),(0,s.setMelodyEditorOpen)(this.sourceBlock_,!0),i.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,()=>{this.onEditorClose(),pxt.BrowserUtils.removeClass(n,"melody-content-div"),pxt.BrowserUtils.removeClass(n.parentElement,"melody-editor-dropdown"),(0,s.setMelodyEditorOpen)(this.sourceBlock_,!1)}),t&&this.toggle.getRootElement().focus()}getValue(){return this.stringRep=this.getTypeScriptValue(),this.stringRep}doValueUpdate_(e){null==e||""==e||'""'==e||this.stringRep&&this.stringRep===e||(this.stringRep=e,this.parseTypeScriptValue(e),super.doValueUpdate_(this.getValue()))}getText_(){return this.invalidString?pxt.Util.lf("Invalid Input"):this.getValue()}getFieldDescription(){var e,t;return(null===(t=null===(e=this.melody.getStringRepresentation())||void 0===e?void 0:e.replace(/-/g,""))||void 0===t?void 0:t.trim())||lf("empty")}onInit(){this.render_(),this.createMelodyIfDoesntExist(),this.invalidString||(this.fieldGroup_||(this.fieldGroup_=i.utils.dom.createSvgElement("g",{},null)),this.visible_||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.updateFieldLabel())}render_(){super.render_(),this.invalidString||(this.size_.width=a.MUSIC_ICON_WIDTH+(a.COLOR_BLOCK_WIDTH+a.COLOR_BLOCK_SPACING)*this.numMatrixCols),this.size_.height=34,this.sourceBlock_.setColour("#ffffff")}renderEditor(e){let t=this.getDropdownBackgroundColour(),i=this.getDropdownBorderColour();this.topDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.topDiv,"melody-top-bar-div"),this.root=new r.SVG(this.topDiv).id("melody-editor-header-controls"),this.toggle=new d(this.root,{leftText:lf("Editor"),rightText:lf("Gallery"),baseColor:t}),this.toggle.onStateChange(e=>{e?this.hideGallery():this.showGallery()}),this.firstFocusableElement=this.toggle.getRootElement(),this.toggle.layout(),this.toggle.translate((n.TOTAL_WIDTH-this.toggle.width())/2,u),e.appendChild(this.topDiv),e.appendChild(this.gallery.getElement()),this.editorDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.editorDiv,"melody-editor-div"),this.editorDiv.style.setProperty("background-color",i),this.gridDiv=this.createGridDisplay(),this.editorDiv.appendChild(this.gridDiv),this.bottomDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.bottomDiv,"melody-bottom-bar-div"),this.doneButton=document.createElement("button"),pxt.BrowserUtils.addClass(this.doneButton,"melody-confirm-button"),this.doneButton.innerText=lf("Done"),this.doneButton.addEventListener("click",()=>this.onDone()),this.doneButton.style.setProperty("background-color",t),this.lastFocusableElement=this.doneButton,this.playButton=document.createElement("button"),this.playButton.id="melody-play-button",this.playButton.addEventListener("click",()=>this.togglePlay()),this.playIcon=document.createElement("i"),this.playIcon.id="melody-play-icon",pxt.BrowserUtils.addClass(this.playIcon,"play icon"),this.playButton.appendChild(this.playIcon),this.tempoInput=document.createElement("input"),pxt.BrowserUtils.addClass(this.tempoInput,"ui input"),this.tempoInput.type="number",this.tempoInput.title=lf("tempo"),this.tempoInput.id="melody-tempo-input",this.tempoInput.addEventListener("input",()=>this.setTempo(+this.tempoInput.value)),this.syncTempoField(!0),this.bottomDiv.appendChild(this.tempoInput),this.bottomDiv.appendChild(this.playButton),this.bottomDiv.appendChild(this.doneButton),this.editorDiv.appendChild(this.bottomDiv),e.appendChild(this.editorDiv)}onEditorClose(){this.stopMelody(),this.gallery&&this.gallery.stopMelody(),this.matrixFocusBind&&(i.browserEvents.unbind(this.matrixFocusBind),this.matrixFocusBind=void 0),this.tabKeyBind&&(i.browserEvents.unbind(this.tabKeyBind),this.tabKeyBind=void 0),this.clearCellSelection(),this.removeKeyboardFocusHandlers(),this.clearDomReferences(),this.sourceBlock_&&i.Events.isEnabled()&&this.getValue()!==this.prevString&&i.Events.fire(new i.Events.BlockChange(this.sourceBlock_,"field",this.name,this.prevString,this.getValue())),this.prevString=void 0}onDone(){i.DropDownDiv.hideIfOwner(this)}clearDomReferences(){this.topDiv=null,this.editorDiv=null,this.gridDiv=null,this.bottomDiv=null,this.doneButton=null,this.playButton=null,this.playIcon=null,this.tempoInput=null,this.matrixSvg=null,this.cells=[],this.toggle=null,this.root=null,this.firstFocusableElement=null,this.lastFocusableElement=null,this.gallery.clearDomReferences()}getTypeScriptValue(){return this.invalidString?this.invalidString:this.melody?'"'+this.melody.getStringRepresentation()+'"':""}parseTypeScriptValue(e){let t=e;try{e=(e=e.slice(1,-1)).trim(),this.createMelodyIfDoesntExist();let t=e.split(" ");t.forEach(e=>{if(!this.isValidNote(e))throw new Error(lf("Invalid note '{0}'. Notes can be C D E F G A B C5",e))}),this.melody.resetMelody();for(let e=0;e<t.length;e++)if("-"!=t[e]){let n=pxtmelody.noteToRow(t[e]);this.melody.updateMelody(n,e)}this.updateFieldLabel()}catch(e){pxt.log(e),this.invalidString=t}}isValidNote(e){switch(e){case"C":case"D":case"E":case"F":case"G":case"A":case"B":case"C5":case"-":return!0}return!1}getPreviewWidth(){return this.updateSize_(),this.size_.width}getPreviewHeight(){var e;return(null===(e=this.getConstants())||void 0===e?void 0:e.FIELD_BORDER_RECT_HEIGHT)||16}getDropdownBackgroundColour(){const e=this.sourceBlock_.getParent();return e?e.getColour():"#3D3D3D"}getDropdownBorderColour(){const e=this.sourceBlock_.getParent();return e?e.getColourTertiary():"#2A2A2A"}updateFieldLabel(){if(!this.fieldGroup_)return;pxsim.U.clear(this.fieldGroup_);let e=p("").appendClass("melody-editor-field-icon").at(6,15);this.fieldGroup_.appendChild(e.el);let t=this.melody.getStringRepresentation().trim().split(" ");for(let e=0;e<t.length;e++){let n=pxtmelody.getColorClass(pxtmelody.noteToRow(t[e]));const i=(new r.Rect).at((a.COLOR_BLOCK_WIDTH+a.COLOR_BLOCK_SPACING)*e+a.COLOR_BLOCK_X,a.COLOR_BLOCK_Y).size(a.COLOR_BLOCK_WIDTH,a.COLOR_BLOCK_HEIGHT).stroke("#898989",1).fill(h(pxtmelody.noteToRow(t[e]))).corners(3,2);pxt.BrowserUtils.addClass(i.el,n),this.fieldGroup_.appendChild(i.el)}}setTempo(e){(isNaN(e)||e<=0)&&this.tempoInput?this.tempoInput.value=this.tempo+"":this.tempo!=e&&(this.tempo=e,this.melody&&this.melody.setTempo(this.tempo),this.tempoInput&&(this.tempoInput.value=this.tempo+""),this.syncTempoField(!1))}syncTempoField(e){const t=this.sourceBlock_.getParent();if(t)for(const n of t.inputList)if("tempo"===n.name||"bpm"===n.name){const t=n.connection.targetBlock();t&&(e?t.getFieldValue("SLIDER")?(this.tempoInput.value=t.getFieldValue("SLIDER"),this.tempo=+this.tempoInput.value):this.tempoInput.value=this.tempo+"":("math_number_minmax"===t.type?t.setFieldValue(this.tempoInput.value,"SLIDER"):t.setFieldValue(this.tempoInput.value,"NUM"),this.tempoInput.focus()));break}}getDuration(){return 6e4/this.tempo}createMelodyIfDoesntExist(){return!this.melody&&(this.melody=new pxtmelody.MelodyArray,!0)}toggleCell(e,t){this.invalidString=null,this.melody.updateMelody(t,e),this.melody.getValue(t,e)&&!this.isPlaying&&this.playNote(t,e),this.updateGrid(),this.updateFieldLabel()}getCellToggled(e,t){return this.melody.getValue(t,e)}useTwoToneFocusIndicator(e,t){return!0}updateGrid(){for(let e=0;e<this.numMatrixRows;e++){const t=pxtmelody.getColorClass(e);for(let n=0;n<this.numMatrixCols;n++){const i=this.cells[n][e];this.melody.getValue(e,n)?(pxt.BrowserUtils.removeClass(i,"melody-default"),pxt.BrowserUtils.addClass(i,t)):(pxt.BrowserUtils.addClass(i,"melody-default"),pxt.BrowserUtils.removeClass(i,t))}}}playNote(e,t){let n=++this.soundingKeys;this.isPlaying?(this.timeouts.push(setTimeout(()=>{this.playToneCore(e)},t*this.getDuration())),this.timeouts.push(setTimeout(()=>{pxt.AudioContextManager.stop()},(t+1)*this.getDuration()))):(this.playToneCore(e),this.timeouts.push(setTimeout(()=>{this.soundingKeys==n&&pxt.AudioContextManager.stop()},this.getDuration())))}queueToneForColumn(e,t,n){const i=setTimeout(()=>{++this.soundingKeys,pxt.AudioContextManager.stop();for(let t=0;t<this.numMatrixRows;t++)this.melody.getValue(t,e)&&this.playToneCore(t);this.highlightColumn(e,!0),this.timeouts=this.timeouts.filter(e=>e!==i)},t),r=setTimeout(()=>{this.timeouts=this.timeouts.filter(e=>e!==r),this.highlightColumn(e,!1)},t+n);this.timeouts.push(i),this.timeouts.push(r)}playToneCore(e){let t=0;switch(e){case 0:t=523;break;case 1:t=494;break;case 2:t=440;break;case 3:t=392;break;case 4:t=349;break;case 5:t=330;break;case 6:t=294;break;case 7:t=262}pxt.AudioContextManager.tone(t)}highlightColumn(e,t){this.cells[e].forEach(e=>{t?pxt.BrowserUtils.addClass(e,"playing"):pxt.BrowserUtils.removeClass(e,"playing")})}createGridDisplay(){return a.VIEWBOX_WIDTH=(a.CELL_WIDTH+a.CELL_HORIZONTAL_MARGIN)*this.numMatrixCols+a.CELL_HORIZONTAL_MARGIN,pxt.BrowserUtils.isEdge()&&(a.VIEWBOX_WIDTH+=37),a.VIEWBOX_HEIGHT=(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)*this.numMatrixRows+a.CELL_VERTICAL_MARGIN,this.matrixSvg=pxsim.svg.parseString(`<svg xmlns="http://www.w3.org/2000/svg" class="melody-grid-div blocklyMatrix" role="grid" viewBox="0 0 ${a.VIEWBOX_WIDTH} ${a.VIEWBOX_HEIGHT}" tabindex="0" />`),this.matrixSvg.ariaLabel=lf("Melody grid"),this.createMatrixDisplay({cellWidth:a.CELL_WIDTH,cellHeight:a.CELL_WIDTH,cellLabel:lf("Note"),cellStroke:"white",cellHorizontalMargin:a.CELL_HORIZONTAL_MARGIN,cellVerticalMargin:a.CELL_VERTICAL_MARGIN,cornerRadius:a.CELL_CORNER_RADIUS}),this.updateGrid(),this.matrixSvg}handleMatrixFocus(e){var t;if(!this.selected){const e=null!==(t=this.getMelodyNote(0))&&void 0!==t?t:0;this.selected=[0,e]}const[n,i]=this.selected;this.focusCell(n,i)}handleTabKey(e){"Tab"===e.code&&(document.activeElement!==this.lastFocusableElement||e.shiftKey?document.activeElement===this.firstFocusableElement&&e.shiftKey&&(this.lastFocusableElement.focus(),e.preventDefault()):(this.firstFocusableElement.focus(),e.preventDefault()))}attachPointerEventHandlersToCell(e,t,n){pxsim.pointerEvents.down.forEach(i=>n.addEventListener(i,n=>{this.toggleCell(e,t),this.clearFocusIndicator(),n.stopPropagation(),n.preventDefault()},!1))}handleArrowUp(e,t){const n=void 0!==this.getMelodyNote(e);this.selected=[e,t-1],n&&this.toggleCell(this.selected[0],this.selected[1])}handleArrowDown(e,t){const n=void 0!==this.getMelodyNote(e);this.selected=[e,t+1],n&&this.toggleCell(this.selected[0],this.selected[1])}handleArrowLeft(e,t){var n;const i=(e+this.numMatrixCols-1)%this.numMatrixCols,r=null!==(n=this.getMelodyNote(i))&&void 0!==n?n:t;this.selected=[i,r]}handleArrowRight(e,t){var n;const i=(e+this.numMatrixCols+1)%this.numMatrixCols,r=null!==(n=this.getMelodyNote(i))&&void 0!==n?n:t;this.selected=[i,r]}getMelodyNote(e){for(let t=0;t<this.numMatrixRows;++t)if(this.melody.getValue(t,e))return t}togglePlay(){this.isPlaying?this.stopMelody():(this.isPlaying=!0,this.playMelody()),this.updatePlayButton()}updatePlayButton(){this.isPlaying?(pxt.BrowserUtils.removeClass(this.playIcon,"play icon"),pxt.BrowserUtils.addClass(this.playIcon,"stop icon")):(pxt.BrowserUtils.removeClass(this.playIcon,"stop icon"),pxt.BrowserUtils.addClass(this.playIcon,"play icon"))}playMelody(){if(this.isPlaying){for(let e=0;e<this.numMatrixCols;e++)this.queueToneForColumn(e,e*this.getDuration(),this.getDuration());this.timeouts.push(setTimeout(()=>this.playMelody(),this.numMatrixCols*this.getDuration()))}else this.stopMelody()}stopMelody(){if(this.isPlaying){for(;this.timeouts.length;)clearTimeout(this.timeouts.shift());pxt.AudioContextManager.stop(),this.isPlaying=!1,this.cells.forEach(e=>e.forEach(e=>pxt.BrowserUtils.removeClass(e,"playing")))}}showGallery(){this.stopMelody(),this.updatePlayButton(),this.gallery.show(e=>{e&&(this.melody.parseNotes(e),this.toggle.toggle(),this.toggle.getRootElement().focus(),this.updateFieldLabel(),this.updateGrid())}),this.lastFocusableElement=this.gallery.getLastFocusableElement()}hideGallery(){this.gallery.hide(),this.lastFocusableElement=this.doneButton}isFullBlockField(){return!0}}n.FieldCustomMelody=a,a.CELL_WIDTH=25,a.CELL_HORIZONTAL_MARGIN=5,a.CELL_VERTICAL_MARGIN=7,a.CELL_CORNER_RADIUS=5,a.COLOR_BLOCK_WIDTH=10,a.COLOR_BLOCK_HEIGHT=20,a.COLOR_BLOCK_X=20,a.COLOR_BLOCK_Y=5,a.COLOR_BLOCK_SPACING=2,a.MUSIC_ICON_WIDTH=20;const l=200,c=40,u=6;class d{constructor(e,t){this.props=function(e){e.baseColor||(e.baseColor="#e95153");e.backgroundColor||(e.backgroundColor="rgba(52,73,94,.2)");e.borderColor||(e.borderColor="rgba(52,73,94,.4)");e.selectedTextColor||(e.selectedTextColor=e.baseColor);e.unselectedTextColor||(e.unselectedTextColor="hsla(0,0%,100%,.9)");e.switchColor||(e.switchColor="#ffffff");return e}(t),this.root=e.group(),this.buildDom(),this.isLeft=!0}buildDom(){this.root.style().content("\n        .toggle-left {\n            transform: translateX(0px);\n            animation: mvleft 0.2s 0s ease;\n        }\n\n        .toggle-right {\n            transform: translateX(100px);\n            animation: mvright 0.2s 0s ease;\n        }\n\n        @keyframes mvright {\n            0% {\n                transform: translateX(0px);\n            }\n            100% {\n                transform: translateX(100px);\n            }\n        }\n\n        @keyframes mvleft {\n            0% {\n                transform: translateX(100px);\n            }\n            100% {\n                transform: translateX(0px);\n            }\n        }\n        ");this.root.def().create("clipPath","sprite-editor-toggle-border").clipPathUnits(!0).draw("rect").at(0,0).corners(.02,.1).size(1,1),this.root.draw("rect").size(l,c).fill(this.props.baseColor).stroke(this.props.borderColor,4).corners(4,4).clipPath("url(#sprite-editor-toggle-border)"),this.root.draw("rect").at(2,2).size(196,36).fill(this.props.backgroundColor).corners(4,4),this.switch=this.root.draw("rect").at(2,2).size(98,36).fill(this.props.switchColor).corners(4,4),this.leftElement=this.root.group(),this.leftText=p(this.props.leftText).appendClass("sprite-editor-text").fill(this.props.selectedTextColor),this.leftElement.appendChild(this.leftText),this.rightElement=this.root.group(),this.rightText=p(this.props.rightText).appendClass("sprite-editor-text").fill(this.props.unselectedTextColor),this.rightElement.appendChild(this.rightText),this.root.onClick(()=>this.toggle()),this.root.el.tabIndex=0,this.root.el.classList.add("melody-editor-toggle-buttons"),this.root.el.addEventListener("keydown",e=>{["Space","ArrowLeft","ArrowRight","Enter"].includes(e.code)&&(this.toggle(),e.preventDefault())})}toggle(e=!1){this.isLeft?(this.switch.removeClass("toggle-left"),this.switch.appendClass("toggle-right"),this.leftText.fill(this.props.unselectedTextColor),this.rightText.fill(this.props.selectedTextColor)):(this.switch.removeClass("toggle-right"),this.switch.appendClass("toggle-left"),this.leftText.fill(this.props.selectedTextColor),this.rightText.fill(this.props.unselectedTextColor)),this.isLeft=!this.isLeft,!e&&this.changeHandler&&this.changeHandler(this.isLeft)}onStateChange(e){this.changeHandler=e}layout(){this.leftText.moveTo(51,20),this.rightText.moveTo(149,20)}translate(e,t){this.root.translate(e,t)}height(){return c}width(){return l}getRootElement(){return this.root.el}}function p(e){return new r.Text(e).anchor("middle").setAttribute("dominant-baseline","middle").setAttribute("dy",pxt.BrowserUtils.isIE()||pxt.BrowserUtils.isEdge()?"0.3em":"0.1em")}function h(e){switch(e){case 0:return"#A80000";case 1:return"#D83B01";case 2:return"#FFB900";case 3:return"#107C10";case 4:return"#008272";case 5:return"#0078D7";case 6:return"#5C2D91";case 7:return"#B4009E"}return"#DCDCDC"}},{"./field_matrix":42,"./field_utils":69,blockly:176}],44:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldMusicEditor=void 0;var i=pxt.svgUtil;const r=e("./field_asset"),s=e("./field_utils");class o extends r.FieldAssetEditor{getAssetType(){return"song"}createNewAsset(e){const t=pxt.react.getTilemapProject();if(e){const n=pxt.lookupProjectAssetByTSReference(e,t);if(n)return n}if(this.getBlockData())return t.lookupAsset("song",this.getBlockData());let n;if(e){const t=/^\s*hex\s*`([a-fA-F0-9]+)`\s*(?:;?)\s*$/.exec(e);t&&(n=pxt.assets.music.decodeSongFromHex(t[1]))}else n=pxt.assets.music.getEmptySong(2);if(!n)return this.isGreyBlock=!0,void(this.valueText=e);pxt.assets.music.inflateSong(n);return{internalID:-1,id:this.temporaryAssetId(),type:"song",meta:{},song:n}}render_(){super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=18+this.previewWidth())}getValueText(){return this.asset&&!this.isTemporaryAsset()?pxt.getTSReferenceForAsset(this.asset):this.asset?`hex\`${pxt.assets.music.encodeSongToHex(this.asset.song)}\``:this.valueText||""}parseFieldOptions(e){return{}}redrawPreview(){var e;if(!this.fieldGroup_)return;if(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock)return void super.redrawPreview();const t=18+this.previewWidth(),n=(new i.Rect).at(5,1).size(8+this.previewWidth(),40).setClass("blocklySpriteField").stroke("#898989",1).corner(4);if(this.fieldGroup_.appendChild(n.el),this.asset){const e=(0,s.songToDataURI)(this.asset.song,this.previewWidth(),32,this.lightMode);if(e){const t=(new i.Image).src(e).at(9,5).size(this.previewWidth(),32);this.fieldGroup_.appendChild(t.el)}}(null===(e=this.size_)||void 0===e?void 0:e.width)!=t&&this.forceRerender()}previewWidth(){return 32*(this.asset?this.asset.song.measures:2)}}n.FieldMusicEditor=o},{"./field_asset":29,"./field_utils":69}],45:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldNote=void 0;const i=e("blockly"),r=e("./field_utils");var s;!function(e){e[e.C=262]="C",e[e.CSharp=277]="CSharp",e[e.D=294]="D",e[e.Eb=311]="Eb",e[e.E=330]="E",e[e.F=349]="F",e[e.FSharp=370]="FSharp",e[e.G=392]="G",e[e.GSharp=415]="GSharp",e[e.A=440]="A",e[e.Bb=466]="Bb",e[e.B=494]="B",e[e.C3=131]="C3",e[e.CSharp3=139]="CSharp3",e[e.D3=147]="D3",e[e.Eb3=156]="Eb3",e[e.E3=165]="E3",e[e.F3=175]="F3",e[e.FSharp3=185]="FSharp3",e[e.G3=196]="G3",e[e.GSharp3=208]="GSharp3",e[e.A3=220]="A3",e[e.Bb3=233]="Bb3",e[e.B3=247]="B3",e[e.C4=262]="C4",e[e.CSharp4=277]="CSharp4",e[e.D4=294]="D4",e[e.Eb4=311]="Eb4",e[e.E4=330]="E4",e[e.F4=349]="F4",e[e.FSharp4=370]="FSharp4",e[e.G4=392]="G4",e[e.GSharp4=415]="GSharp4",e[e.A4=440]="A4",e[e.Bb4=466]="Bb4",e[e.B4=494]="B4",e[e.C5=523]="C5",e[e.CSharp5=555]="CSharp5",e[e.D5=587]="D5",e[e.Eb5=622]="Eb5",e[e.E5=659]="E5",e[e.F5=698]="F5",e[e.FSharp5=740]="FSharp5",e[e.G5=784]="G5",e[e.GSharp5=831]="GSharp5",e[e.A5=880]="A5",e[e.Bb5=932]="Bb5",e[e.B5=988]="B5",e[e.C6=1047]="C6",e[e.CSharp6=1109]="CSharp6",e[e.D6=1175]="D6",e[e.Eb6=1245]="Eb6",e[e.E6=1319]="E6",e[e.F6=1397]="F6",e[e.FSharp6=1480]="FSharp6",e[e.G6=1568]="G6",e[e.GSharp6=1568]="GSharp6",e[e.A6=1760]="A6",e[e.Bb6=1865]="Bb6",e[e.B6=1976]="B6",e[e.C7=2093]="C7"}(s||(s={}));class o extends i.FieldNumber{constructor(e,t,n){super(null,0,null,null,n),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.isTextValid_=!0,this.nKeys_=36,this.minNote_=28,this.maxNote_=63,this.eps=2,this.keyHandler=e=>{const t="string"==typeof this.value_?parseFloat(this.value_):this.value_;if("ArrowUp"===e.code||"ArrowDown"===e.code){const{keyAbove:n,keyBelow:i}=this.getNeighboringKeys(t),r="ArrowUp"===e.code?n:i,s=this.getKeyFreq(r);this.setValue(s),this.playKey(this.piano[r-this.minNote_],s),this.noteLabel.textContent=this.getKeyName(r),e.stopPropagation(),e.preventDefault()}},this.setSpellcheck(!1),this.prepareNotes(),this.isExpanded=!1,this.currentPage=0,this.totalPlayCount=0,t.editorColour&&(this.primaryColour=(0,r.parseColour)(t.editorColour),this.borderColour=i.utils.colour.blend("#000000",this.primaryColour,.2));const s=parseInt(t.eps);!Number.isNaN(s)&&s>=0&&(this.eps=s);const o=parseInt(t.minNote)||this.minNote_,a=parseInt(t.maxNote)||this.maxNote_;o>=28&&a<=75&&a>o&&(this.minNote_=o,this.maxNote_=a,this.nKeys_=this.maxNote_-this.minNote_+1),this.setValue(e)}doClassValidation_(e){const t=/^Note\.(.+)$/.exec(e),n=t&&t.length>1?t[1]:null;if(null===(e=s[n]?s[n]:String(parseFloat(e||"0"))))return null;const i=parseFloat(e||"0");if(isNaN(i)||i<0)return null;const r=Math.floor(i)!=i;return Number(i.toFixed(r?2:0))}getValue(){return this.value_+""}doValueUpdate_(e){isNaN(Number(e))||Number(e)<0||(this.sourceBlock_&&i.Events.isEnabled()&&this.value_!=e&&i.Events.fire(new i.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,e)),this.value_=e,this.refreshText())}getText(){return this.isExpanded?""+this.value_:this.getNoteString()}getFieldDescription(){return this.getNoteString()||lf("note")}getNoteString(){const e=+this.value_;for(let t=0;t<this.nKeys_;t++)if(Math.abs(this.getKeyFreq(t+this.minNote_)-e)<this.eps)return this.getKeyName(t+this.minNote_);let t=e.toString();return isNaN(e)||(t+=" Hz"),t}refreshText(){this.forceRerender()}onFinishEditing_(e){this.refreshText()}onHide(){this.isExpanded=!1,this.refreshText()}widgetDispose_(){this.htmlInput_.removeEventListener("keydown",this.keyHandler),super.widgetDispose_()}showEditor_(e){this.isExpanded=!0,this.updateColor(),i.DropDownDiv.hideWithoutAnimation(),(0,r.clearDropDownDiv)();const t=pxt.BrowserUtils.isMobile()||pxt.BrowserUtils.isIOS();super.showEditor_(e,t),this.refreshText(),i.Events.setGroup(!0),this.piano=[],this.currentSelectedKey=void 0;const n=this.nKeys_-this.nKeys_/o.notesPerOctave*o.blackKeysPerOctave,s=o.notesPerOctave-o.blackKeysPerOctave;let l=o.keyWidth*n,c=o.keyHeight+o.labelHeight;const u=window.innerWidth<l;u&&(l=s*o.keyWidth,c=o.keyHeight+o.labelHeight+o.prevNextHeight);const d=a("blocklyPianoDiv",`width: ${l}px;\n            height: ${c}px;`);i.DropDownDiv.getContentDiv().appendChild(d),this.noteLabel=a("blocklyNoteLabel",`top: ${o.keyHeight}px;\n            width: ${l}px;\n            background-color: ${this.primaryColour};\n            border-color: ${this.primaryColour};`),d.appendChild(this.noteLabel),this.noteLabel.textContent="-";let p=0;for(let e=0;e<this.nKeys_;e++){const t=Math.floor(e/o.notesPerOctave);let n=this.getPosition(e+this.minNote_);u&&e>=o.notesPerOctave&&(n-=s*t*o.keyWidth);const i=this.getKeyDiv(e+this.minNote_,n);this.piano.push(i),d.appendChild(i),Math.abs(this.getKeyFreq(e+this.minNote_)-Number(this.getValue()))<this.eps&&(pxt.BrowserUtils.addClass(i,"selected"),this.currentSelectedKey=i,p=t)}u&&(this.setPage(p),d.appendChild(this.getNextPrevDiv(!0,l)),d.appendChild(this.getNextPrevDiv(!1,l))),i.DropDownDiv.setColour(this.primaryColour,this.borderColour),i.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,()=>this.onHide(),void 0,!1),this.htmlInput_.addEventListener("keydown",this.keyHandler)}playKey(e,t){const n=++this.totalPlayCount;this.currentSelectedKey!==e&&(this.currentSelectedKey&&pxt.BrowserUtils.removeClass(this.currentSelectedKey,"selected"),pxt.BrowserUtils.addClass(e,"selected"),this.setValue(t)),this.currentSelectedKey=e,this.htmlInput_.value=this.getText(),pxt.AudioContextManager.tone(t),setTimeout(()=>{this.totalPlayCount==n&&pxt.AudioContextManager.stop()},300)}dispose(){i.DropDownDiv.hideIfOwner(this),super.dispose()}updateColor(){const e=this.sourceBlock_.getParent();var t;e&&(this.sourceBlock_.isShadow()||1===(t=this.sourceBlock_).inputList.length&&1===t.inputList[0].fieldRow.length)?(this.primaryColour=e.getColour(),this.borderColour=e.getColourTertiary()):(this.primaryColour="#3D3D3D",this.borderColour="#2A2A2A")}setPage(e){const t=this.nKeys_/o.notesPerOctave;e=Math.max(Math.min(e,t-1),0),this.noteLabel.textContent=`Octave #${e+1}`;const n=e*o.notesPerOctave;for(let e=0;e<this.piano.length;++e){const t=e>=n&&e<n+o.notesPerOctave;this.piano[e].style.display=t?"block":"none"}this.currentPage=e}getNextPrevDiv(e,t){const n=e?0:t/2,r=a("blocklyNotePrevNext",`top: ${o.keyHeight+o.labelHeight}px;\n            left: ${n}px;\n            width: ${Math.ceil(t/2)}px;\n            ${e?"border-left-color":"border-right-color"}: ${this.primaryColour};\n            background-color: ${this.primaryColour};\n            border-bottom-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach(t=>{i.browserEvents.conditionalBind(r,t,this,()=>this.setPage(e?this.currentPage-1:this.currentPage+1),!0)}),r.textContent=e?"<":">",r}getKeyDiv(e,t){const n=a("blocklyNote "+(this.isWhite(e)?"":"black"),`width: ${this.getKeyWidth(e)}px;\n            height: ${this.getKeyHeight(e)}px;\n            left: ${t}px;\n            border-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach(t=>{i.browserEvents.conditionalBind(n,t,this,()=>this.playKey(n,this.getKeyFreq(e)),!0)}),i.browserEvents.conditionalBind(n,"mouseover",this,t=>{this.noteLabel.textContent=this.getKeyName(e),t.buttons&&this.playKey(n,this.getKeyFreq(e))},!0),n}isWhite(e){switch((e+=8)%12){case 1:case 3:case 6:case 8:case 10:return!1;default:return!0}}whiteKeysBefore(e){switch((e+=8)%12){case 0:return 0;case 1:case 2:return 1;case 3:case 4:return 2;case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5;case 10:case 11:return 6}return-1}getKeyWidth(e){return this.isWhite(e)?o.keyWidth:o.keyWidth/2}getKeyHeight(e){return this.isWhite(e)?o.keyHeight:o.keyHeight/2}getNeighboringKeys(e){let t,n;for(let i=this.minNote_;i<=this.maxNote_;++i){if(this.getKeyFreq(i)+this.eps>e){n=i;break}t=i}return t?n&&n!==this.maxNote_?(e<this.getKeyFreq(t)+this.eps?n=t:e>this.getKeyFreq(n)-this.eps&&(t=n),{keyAbove:t+1,keyBelow:n-1}):{keyAbove:this.maxNote_,keyBelow:e-this.eps<this.getKeyFreq(this.maxNote_)?this.maxNote_-1:this.maxNote_}:{keyAbove:e+this.eps>this.getKeyFreq(this.minNote_)?this.minNote_+1:this.minNote_,keyBelow:this.minNote_}}getKeyFreq(e){return this.getKeyNoteData(e).freq}getKeyName(e){const t=this.getKeyNoteData(e);let n=t.prefixedName;return this.nKeys_<=o.notesPerOctave?n=t.name:this.minNote_>=28&&this.maxNote_<=63&&(n=t.altPrefixedName||n),n}getKeyNoteData(e){return o.Notes[e]}getPosition(e){if(e===this.minNote_)return 0;const t=o.keyWidth/4,n=Math.floor((this.minNote_+8)/o.notesPerOctave),i=Math.floor((e+8)/o.notesPerOctave);let r=this.whiteKeysBefore(this.minNote_)*o.keyWidth;if(this.isWhite(this.minNote_)||(r-=t),i>n){const s=7*o.keyWidth,a=s-r+(i-n-1)*s;return this.whiteKeysBefore(e)*o.keyWidth+a-(this.isWhite(e)?0:t)}return this.whiteKeysBefore(e)*o.keyWidth-r-(this.isWhite(e)?0:t)}prepareNotes(){o.Notes||(o.Notes={28:{name:lf("{id:note}C"),prefixedName:lf("Low C"),freq:131},29:{name:lf("C#"),prefixedName:lf("Low C#"),freq:139},30:{name:lf("{id:note}D"),prefixedName:lf("Low D"),freq:147},31:{name:lf("D#"),prefixedName:lf("Low D#"),freq:156},32:{name:lf("{id:note}E"),prefixedName:lf("Low E"),freq:165},33:{name:lf("{id:note}F"),prefixedName:lf("Low F"),freq:175},34:{name:lf("F#"),prefixedName:lf("Low F#"),freq:185},35:{name:lf("{id:note}G"),prefixedName:lf("Low G"),freq:196},36:{name:lf("G#"),prefixedName:lf("Low G#"),freq:208},37:{name:lf("{id:note}A"),prefixedName:lf("Low A"),freq:220},38:{name:lf("A#"),prefixedName:lf("Low A#"),freq:233},39:{name:lf("{id:note}B"),prefixedName:lf("Low B"),freq:247},40:{name:lf("{id:note}C"),prefixedName:lf("Middle C"),freq:262},41:{name:lf("C#"),prefixedName:lf("Middle C#"),freq:277},42:{name:lf("{id:note}D"),prefixedName:lf("Middle D"),freq:294},43:{name:lf("D#"),prefixedName:lf("Middle D#"),freq:311},44:{name:lf("{id:note}E"),prefixedName:lf("Middle E"),freq:330},45:{name:lf("{id:note}F"),prefixedName:lf("Middle F"),freq:349},46:{name:lf("F#"),prefixedName:lf("Middle F#"),freq:370},47:{name:lf("{id:note}G"),prefixedName:lf("Middle G"),freq:392},48:{name:lf("G#"),prefixedName:lf("Middle G#"),freq:415},49:{name:lf("{id:note}A"),prefixedName:lf("Middle A"),freq:440},50:{name:lf("A#"),prefixedName:lf("Middle A#"),freq:466},51:{name:lf("{id:note}B"),prefixedName:lf("Middle B"),freq:494},52:{name:lf("{id:note}C"),prefixedName:lf("Tenor C"),altPrefixedName:lf("High C"),freq:523},53:{name:lf("C#"),prefixedName:lf("Tenor C#"),altPrefixedName:lf("High C#"),freq:554},54:{name:lf("{id:note}D"),prefixedName:lf("Tenor D"),altPrefixedName:lf("High D"),freq:587},55:{name:lf("D#"),prefixedName:lf("Tenor D#"),altPrefixedName:lf("High D#"),freq:622},56:{name:lf("{id:note}E"),prefixedName:lf("Tenor E"),altPrefixedName:lf("High E"),freq:659},57:{name:lf("{id:note}F"),prefixedName:lf("Tenor F"),altPrefixedName:lf("High F"),freq:698},58:{name:lf("F#"),prefixedName:lf("Tenor F#"),altPrefixedName:lf("High F#"),freq:740},59:{name:lf("{id:note}G"),prefixedName:lf("Tenor G"),altPrefixedName:lf("High G"),freq:784},60:{name:lf("G#"),prefixedName:lf("Tenor G#"),altPrefixedName:lf("High G#"),freq:831},61:{name:lf("{id:note}A"),prefixedName:lf("Tenor A"),altPrefixedName:lf("High A"),freq:880},62:{name:lf("A#"),prefixedName:lf("Tenor A#"),altPrefixedName:lf("High A#"),freq:932},63:{name:lf("{id:note}B"),prefixedName:lf("Tenor B"),altPrefixedName:lf("High B"),freq:988},64:{name:lf("{id:note}C"),prefixedName:lf("High C"),freq:1046},65:{name:lf("C#"),prefixedName:lf("High C#"),freq:1109},66:{name:lf("{id:note}D"),prefixedName:lf("High D"),freq:1175},67:{name:lf("D#"),prefixedName:lf("High D#"),freq:1245},68:{name:lf("{id:note}E"),prefixedName:lf("High E"),freq:1319},69:{name:lf("{id:note}F"),prefixedName:lf("High F"),freq:1397},70:{name:lf("F#"),prefixedName:lf("High F#"),freq:1478},71:{name:lf("{id:note}G"),prefixedName:lf("High G"),freq:1568},72:{name:lf("G#"),prefixedName:lf("High G#"),freq:1661},73:{name:lf("{id:note}A"),prefixedName:lf("High A"),freq:1760},74:{name:lf("A#"),prefixedName:lf("High A#"),freq:1865},75:{name:lf("{id:note}B"),prefixedName:lf("High B"),freq:1976}})}}function a(e,t){const n=document.createElement("div");return pxt.BrowserUtils.addClass(n,e),n.setAttribute("style",t.replace(/\s+/g," ")),n}n.FieldNote=o,o.keyWidth=22,o.keyHeight=90,o.labelHeight=24,o.prevNextHeight=20,o.notesPerOctave=12,o.blackKeysPerOctave=5},{"./field_utils":69,blockly:176}],46:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldNumberDropdown=void 0;const i=e("./field_textdropdown");class r extends i.BaseFieldTextDropdown{constructor(e,t,n,i,r,s){super(e+"",t,s),this.setConstraints(n,i,r)}setConstraints(e,t,n){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(n),this.setValue(this.getValue())}getValue(){return Number(super.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);-1!==t.indexOf("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const n=t.indexOf(".");this.decimalPlaces=-1===n?e?0:null:t.length-n-1}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=`${e}`).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);return isNaN(t)?null:(void 0!==this.min_&&(t=Math.max(t,this.min_)),void 0!==this.max_&&(t=Math.min(t,this.max_)),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!==this.decimalPlaces&&(t=Number(t.toFixed(this.decimalPlaces))),t+"")}}n.FieldNumberDropdown=class extends r{constructor(e,t,n){super(e,function(e){let t;if(e.values){const n=[],i=e.values.split(",");let r=!1;for(const e of i){const t=parseFloat(e);if(Number.isNaN(t)){r=!0;break}n.push([e,t])}r||(t=n)}else if(e.data)try{const n=JSON.parse(e.data);if(Array.isArray(n)&&n.length){if(function(e){for(const t of e)if("number"!=typeof t)return!1;return!0}(n))return n.map(e=>[""+e,e]);{let e=!1;for(const t of n)if(!Array.isArray(t)||"string"!=typeof t[0]||"number"!=typeof t[1]){e=!0;break}e||(t=n)}}}catch(e){}if(t)return t;pxt.warn("Could not parse numberdropdown data field");return[]}(t),t.min,t.max,t.precision,n),this.isFieldCustom_=!0}getOptions(){let e;return this.menuGenerator_&&("string"==typeof this.menuGenerator_&&(this.menuGenerator_=JSON.parse(this.menuGenerator_)),e=this.menuGenerator_.map(e=>"object"==typeof e?[pxt.Util.rlf(e[0]),e[1]]:[String(e),String(e)])),e}}},{"./field_textdropdown":55}],47:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldPosition=void 0;const i=e("blockly"),r=e("../plugins/math");class s extends r.FieldSlider{constructor(e,t,n){super(e,"0","100","1","1","Value",n),this.isFieldCustom_=!0,this.params=t,this.params.screenHeight||(this.params.screenHeight=120),this.params.screenWidth||(this.params.screenWidth=160),this.params.xInputName||(this.params.xInputName="x"),this.params.yInputName||(this.params.yInputName="y"),this.params.min&&(this.min_=parseInt(this.params.min)),this.params.max&&(this.max_=parseInt(this.params.max))}showEditor_(e){this.getFieldByName(this.params.xInputName)===this&&(this.max_=this.params.screenWidth,this.labelText_=this.params.xInputName);this.getFieldByName(this.params.yInputName)===this&&(this.max_=this.params.screenHeight,this.labelText_=this.params.yInputName),super.showEditor_(e),this.renderScreenPicker()}doValueUpdate_(e){super.doValueUpdate_(e),this.resetCrosshair&&this.resetCrosshair()}renderScreenPicker(){let e=i.DropDownDiv.getContentDiv();this.selectorDiv_=document.createElement("div"),this.selectorDiv_.className="blocklyCanvasOverlayOuter",e.appendChild(this.selectorDiv_);const t=document.createElement("div");t.className="blocklyCanvasOverlayDiv",this.selectorDiv_.appendChild(t);const n=document.createElement("div");n.className="cross-x",t.appendChild(n);const r=document.createElement("div");r.className="cross-y",t.appendChild(r);const s=document.createElement("div");s.className="label",t.appendChild(s);const o=1.5*this.params.screenWidth,a=1.5*this.params.screenHeight;t.style.height=a+"px",t.style.width=o+"px";const l=e.getElementsByClassName("goog-slider-horizontal")[0];if(l){l.style.width=o+"px";const e=Number(this.getValue());!isNaN(e)&&e>this.getMin()&&(this.setValue(e-1+""),this.setValue(e+""))}const c=(e,t)=>{e=Math.round(Math.max(0,Math.min(o,e))),t=Math.round(Math.max(0,Math.min(a,t))),n.style.top=t+"px",r.style.left=e+"px",e=Math.round(Math.max(0,Math.min(this.params.screenWidth,e/o*this.params.screenWidth))),t=Math.round(Math.max(0,Math.min(this.params.screenHeight,t/a*this.params.screenHeight))),isNaN(e)?s.textContent=`${this.params.yInputName}=${t}`:isNaN(t)?s.textContent=`${this.params.xInputName}=${e}`:s.textContent=`${this.params.xInputName}=${e} ${this.params.yInputName}=${t}`;const i=s.getBoundingClientRect();e>this.params.screenWidth/2?s.style.left=e*(o/this.params.screenWidth)-i.width-8+"px":s.style.left=e*(o/this.params.screenWidth)+4+"px",t>this.params.screenHeight/2?s.style.top=t*(a/this.params.screenHeight)-i.height-6+"px":s.style.top=t*(a/this.params.screenHeight)+"px"};this.resetCrosshair=()=>{const{currentX:e,currentY:t}=this.getXY();c(e/this.params.screenWidth*o,t/this.params.screenHeight*a)},this.resetCrosshair(),i.browserEvents.bind(this.selectorDiv_,"mousemove",this,e=>{const n=t.getBoundingClientRect(),i=e.clientX-n.left,r=e.clientY-n.top;c(i,r)}),i.browserEvents.bind(this.selectorDiv_,"mouseleave",this,this.resetCrosshair),i.browserEvents.bind(this.selectorDiv_,"click",this,e=>{const n=t.getBoundingClientRect(),i=e.clientX-n.left,r=e.clientY-n.top,s=Math.round(i/o*this.params.screenWidth),l=Math.round(r/a*this.params.screenHeight);this.close(),this.setXY(s,l)})}resizeHandler(){this.close()}setXY(e,t){const n=this.getFieldByName(this.params.xInputName);n&&"number"==typeof n.getValue()&&n.setValue(String(e));const i=this.getFieldByName(this.params.yInputName);i&&"number"==typeof i.getValue()&&i.setValue(String(t))}getFieldByName(e){const t=this.sourceBlock_.getParent();if(t)for(let n=0;n<t.inputList.length;n++){const i=t.inputList[n];if(i.name===e)return this.getTargetField(i)}}getXY(){let e,t;const n=this.getFieldByName(this.params.xInputName);n&&(e=n.getValue());const i=this.getFieldByName(this.params.yInputName);return i&&(t=i.getValue()),{currentX:parseInt(e),currentY:parseInt(t)}}getTargetField(e){const t=e.connection.targetBlock();if(!t)return null;const n=t.inputList[0];if(!n)return null;return n.fieldRow[0]}widgetDispose_(){super.widgetDispose_(),this.close(!0)}close(e){e||(i.WidgetDiv.hideIfOwner(this),i.DropDownDiv.hideIfOwner(this)),window.removeEventListener("resize",this.resizeHandler),this.resetCrosshair=void 0,this.selectorDiv_&&(i.utils.dom.removeNode(this.selectorDiv_),this.selectorDiv_=void 0)}}n.FieldPosition=s},{"../plugins/math":120,blockly:176}],48:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldProcedure=void 0;const i=e("./field_dropdown");class r extends i.FieldDropdown{constructor(e,t){super(function(){let e=[];if(this.sourceBlock_&&this.sourceBlock_.workspace){let t=this.sourceBlock_.workspace.getAllBlocks(!1);for(let n=0;n<t.length;n++)if(t[n].getProcedureDef){let i=t[n].getProcedureDef();e.push(i[0])}}let t=this.getValue();t&&-1==e.indexOf(t)&&e.push(t),e.sort((e,t)=>{const n=e.toLowerCase(),i=t.toLowerCase();return n===i?0:n>i?1:-1}),e.length||e.push("Temp"),this.rawValue&&-1===e.indexOf(this.rawValue)&&e.push(this.rawValue);let n=[];for(let t=0;t<e.length;t++)n[t]=[e[t],e[t]];return n},t),this.setValue(e||"")}getOptions(e){return this.menuGenerator_()}doClassValidation_(e){return void 0===e?null:e}doValueUpdate_(e){this.rawValue=e,super.doValueUpdate_(e)}init(){this.fieldGroup_||super.init.call(this)}setSourceBlock(e){pxt.Util.assert(!e.isShadow(),"Procedure fields are not allowed to exist on shadow blocks."),super.setSourceBlock.call(this,e)}}n.FieldProcedure=r},{"./field_dropdown":34}],49:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldProtractor=void 0;const i=e("../plugins/math");class r extends i.FieldSlider{constructor(e,t,n){super(String(e),"0","180","1","15",lf("Angle"),n),this.isFieldCustom_=!0,this.params=t}createLabelDom_(e){const t=document.createElement("div");this.circleSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.circleSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.circleSVG);pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"});this.circleBar=pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.circleSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"});const n=document.createElement("span");return n.setAttribute("class","blocklyFieldSliderReadout"),[t,n]}setReadout(e){this.updateAngle("string"==typeof e?parseFloat(e):e),this.reporter&&(this.reporter.textContent=`${e}`)}updateAngle(e){if(!this.circleBar)return;const t=(180-(e=Math.max(0,Math.min(180,e))))/180*Math.PI*90;this.circleBar.setAttribute("stroke-dashoffset",`${t}`)}}n.FieldProtractor=r},{"../plugins/math":120}],50:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldScopedValueSelector=void 0;const i=e("blockly"),r=e("./field_utils");class s extends i.FieldLabel{constructor(e,t){super(e),this.isFieldCustom_=!0,this.types=[],this.dragging=!1,this.onDragEvent=e=>{var t;if(!e.blocks.find(e=>e.id===this.sourceBlock_.id))return;if(this.dragging=e.isStart,e.isStart)return void this.forceRerender();const n=[];{let e=null===(t=this.sourceBlock_.getParent())||void 0===t?void 0:t.getParent();for(;e;)n.push(e),e=e.getParent()}const i=pxt.getBundledApiInfo(),r=e=>{const t=(e=>e.codeCard)(e);if(!t||!t.name)return null;for(const e of Object.values(i))if(e.apis.byQName[t.name])return e.apis.byQName[t.name]};this.scopedValue=null;for(const e of n){if("variables_set"===e.type){const t=e.inputList.find(e=>"VALUE"===e.name);if(!t)continue;const n=t.fieldRow;if(!n)continue;const i=n.find(e=>"VAR"===e.name);if(!i)continue;const r=i.getVariable();if(!r)continue;return this.setValue(r.getName())}const t=r(e);if(t)for(const e of t.parameters)if(e.handlerParameters)for(const t of e.handlerParameters)if(this.types.includes(t.type))return this.setValue(t.name)}this.setValue(this.defl)},this.onWorkspaceChange=e=>{if(this.sourceBlock_&&this.sourceBlock_.workspace&&!this.sourceBlock_.disposed)return e.type===i.Events.BLOCK_DRAG?this.onDragEvent(e):void 0},this.defl=t.defl,t.types?this.types=t.types.split(","):t.type&&(this.types=[t.type]),this.types=this.types.map(e=>e.trim().replace(/['"]+/g,""))}init(){super.init(),this.sourceBlock_&&(this.scopedValue=(0,r.getBlockDataForField)(this.sourceBlock_,"scopedValue"),this.sourceBlock_.workspace.addChangeListener(this.onWorkspaceChange))}dispose(){this.sourceBlock_&&this.sourceBlock_.workspace.removeChangeListener(this.onWorkspaceChange),super.dispose()}getValue(){var e;return(null===(e=this.sourceBlock_)||void 0===e?void 0:e.isInFlyout)?lf("(dynamic)"):this.dragging?lf("what will it be?"):(this.sourceBlock_&&!this.scopedValue&&(this.scopedValue=(0,r.getBlockDataForField)(this.sourceBlock_,"scopedValue")),this.scopedValue||this.defl||lf("unknown"))}setValue(e,t){this.scopedValue=e||this.defl||lf("unknown"),this.sourceBlock_&&(0,r.setBlockDataForField)(this.sourceBlock_,"scopedValue",this.scopedValue||""),super.setValue(this.scopedValue,t),this.forceRerender()}getFieldDescription(){return this.scopedValue||this.defl||lf("value")}}n.FieldScopedValueSelector=s},{"./field_utils":69,blockly:176}],51:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSoundEffect=void 0;const i=e("blockly");var r=pxt.svgUtil;const s=e("./field_base"),o=e("./field_utils"),a=160,l=40;class c extends s.FieldBase{constructor(){super(...arguments),this.registeredChangeListener=!1,this.onWorkspaceChange=e=>{if(e.type!==i.Events.CHANGE)return;const t=this.sourceBlock_.workspace.getBlockById(e.blockId);!t||t!==this.sourceBlock_&&t.getParent()!==this.sourceBlock_||this.redrawPreview()}}onInit(){this.options||(this.options={}),this.options.durationInputName||(this.options.durationInputName="duration"),this.options.startFrequencyInputName||(this.options.startFrequencyInputName="startFrequency"),this.options.endFrequencyInputName||(this.options.endFrequencyInputName="endFrequency"),this.options.startVolumeInputName||(this.options.startVolumeInputName="startVolume"),this.options.endVolumeInputName||(this.options.endVolumeInputName="endVolume"),this.options.waveFieldName||(this.options.waveFieldName="waveShape"),this.options.interpolationFieldName||(this.options.interpolationFieldName="interpolation"),this.options.effectFieldName||(this.options.effectFieldName="effect"),this.options.useMixerSynthesizer||(this.options.useMixerSynthesizer=!1),this.redrawPreview(),this.sourceBlock_.workspace&&(this.workspace=this.sourceBlock_.workspace,this.sourceBlock_.isShadow()||this.sourceBlock_.isInsertionMarker()||(this.registeredChangeListener=!0,this.workspace.addChangeListener(this.onWorkspaceChange)))}onDispose(){this.workspace&&this.registeredChangeListener&&(this.workspace.removeChangeListener(this.onWorkspaceChange),this.registeredChangeListener=!1)}onValueChanged(e){return e}redrawPreview(){if(!this.fieldGroup_)return;if(this.drawnSound){const e=this.readCurrentSound();if(e.startFrequency===this.drawnSound.startFrequency&&e.endFrequency===this.drawnSound.endFrequency&&e.startVolume===this.drawnSound.startVolume&&e.endVolume===this.drawnSound.endVolume&&e.wave===this.drawnSound.wave&&e.interpolation===this.drawnSound.interpolation)return}pxsim.U.clear(this.fieldGroup_);const e=(new r.Rect).at(5,4).size(a,l).setClass("blocklyFieldRect blocklySpriteField").stroke("#fff",1).fill("#dedede").corner(20),t="preview-clip-"+pxt.U.guidGen(),n=(new r.ClipPath).id(t).clipPathUnits(!1),i=(new r.Rect).size(115,l).fill("#FFF").at(0,0);n.appendChild(i),this.drawnSound=this.readCurrentSound();const s=(new r.Path).stroke("grey",2).fill("none").setD(pxt.assets.renderSoundPath(this.drawnSound,120,32)).clipPath("url('#"+t+"')"),o=(new r.Group).translate(35,7);o.appendChild(n),o.appendChild(s);const c=new r.Text("").appendClass("melody-editor-field-icon").setAttribute("alignment-baseline","middle").anchor("middle").at(20,24);this.fieldGroup_.appendChild(e.el),this.fieldGroup_.appendChild(c.el),this.fieldGroup_.appendChild(o.el)}showEditor_(e){const t=!e,n=this.readCurrentSound();let r;i.Events.disable();let s={getScaledBBox:()=>r};i.WidgetDiv.show(s,this.sourceBlock_.RTL,()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),c.hide(),a.classList.remove("sound-effect-editor-widget"),a.style.transform="",a.style.position="",a.style.left="",a.style.top="",a.style.width="",a.style.height="",a.style.opacity="",a.style.transition="",a.style.alignItems="",i.Events.enable(),i.Events.setGroup(!0),this.fireNumberInputUpdate(this.options.durationInputName,n.duration),this.fireNumberInputUpdate(this.options.startFrequencyInputName,n.startFrequency),this.fireNumberInputUpdate(this.options.endFrequencyInputName,n.endFrequency),this.fireNumberInputUpdate(this.options.startVolumeInputName,n.startVolume),this.fireNumberInputUpdate(this.options.endVolumeInputName,n.endVolume),this.fireFieldDropdownUpdate(this.options.waveFieldName,u[n.wave]),this.fireFieldDropdownUpdate(this.options.interpolationFieldName,p[n.interpolation]),this.fireFieldDropdownUpdate(this.options.effectFieldName,d[n.effect]),i.Events.setGroup(!1),this.mostRecentValue&&this.setBlockData(JSON.stringify(this.mostRecentValue))});const a=i.WidgetDiv.getDiv(),l={onClose:()=>{i.WidgetDiv.hideIfOwner(s),c.hide()},onSoundChange:e=>{this.mostRecentValue=e,this.updateSiblingBlocks(e),this.redrawPreview()},initialSound:n,useMixerSynthesizer:f(this.options.useMixerSynthesizer)},c=pxt.react.getFieldEditorView("soundeffect-editor",n,l,a,t),h=this.sourceBlock_,m=h.getBoundingRectangle(),g=(0,o.workspaceToScreenCoordinates)(h.workspace,new i.utils.Coordinate(m.right,m.top)),_=g.x+20,y=g.y-20;a.style.opacity="0",a.classList.add("sound-effect-editor-widget"),a.style.position="absolute",a.style.left=_+"px",a.style.top=y+"px",a.style.width="30rem",a.style.height="40rem",a.style.display="flex",a.style.alignItems="center",a.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",a.style.borderRadius="",c.onHide(()=>{}),c.show();const b=a.getBoundingClientRect(),v=h.workspace.getInjectionDiv().getBoundingClientRect();b.height>v.height?(a.style.height="",a.style.top="calc(1rem - 20px)",a.style.bottom="calc(1rem + 20px)"):(b.bottom>v.bottom||b.top<v.top)&&(a.style.top=v.top+v.height/2-b.height/2-20+"px");const T=h.workspace.getToolbox().getWidth();if(b.width>v.width-T)a.style.width="",a.style.left="1rem",a.style.right="1rem";else if(b.left+b.width>=v.right){const e=(0,o.workspaceToScreenCoordinates)(h.workspace,new i.utils.Coordinate(m.left,m.top)),t=v.left+T;e.x-b.width-20>t?a.style.left=e.x-b.width-20+"px":a.style.left=t+(v.width-T)/2-b.width/2+"px"}const k=a.getBoundingClientRect();r=new i.utils.Rect(k.top,k.bottom,k.left,k.right),requestAnimationFrame(()=>{a.style.opacity="1",a.style.transform="translateY(20px)"})}render_(){super.render_(),this.size_.height=48,this.size_.width=165}getFieldDescription(){return lf("sound effect")}updateSiblingBlocks(e){this.setNumberInputValue(this.options.durationInputName,e.duration),this.setNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),this.setNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),this.setNumberInputValue(this.options.startVolumeInputName,e.startVolume),this.setNumberInputValue(this.options.endVolumeInputName,e.endVolume),this.setFieldDropdownValue(this.options.waveFieldName,u[e.wave]),this.setFieldDropdownValue(this.options.interpolationFieldName,p[e.interpolation]),this.setFieldDropdownValue(this.options.effectFieldName,d[e.effect])}setNumberInputValue(e,t){const n=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);n&&("math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?n.setFieldValue(Math.round(t),"NUM"):"math_number_minmax"===n.type&&n.setFieldValue(Math.round(t),"SLIDER"))}getNumberInputValue(e,t){const n=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);return n?"math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?parseInt(n.getFieldValue("NUM")+""):"math_number_minmax"===n.type?parseInt(n.getFieldValue("SLIDER")+""):t:t}fireNumberInputUpdate(e,t){const n=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);if(!n)return;let r;"math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?r="NUM":"math_number_minmax"===n.type&&(r="SLIDER"),r&&i.Events.fire(new i.Events.BlockChange(n,"field",r,t,this.getNumberInputValue(e,t)))}setFieldDropdownValue(e,t){const n=this.getSiblingField(e)||this.getSiblingField(e,!0);n&&n.setValue(t)}getFieldDropdownValue(e){const t=this.getSiblingField(e)||this.getSiblingField(e,!0);if(t)return t.getValue()}fireFieldDropdownUpdate(e,t){const n=this.getSiblingField(e)||this.getSiblingField(e,!0);n&&i.Events.fire(new i.Events.BlockChange(n.getSourceBlock(),"field",n.name,t,this.getFieldDropdownValue(e)))}readCurrentSound(){const e=this.readBlockDataSound();return{duration:this.getNumberInputValue(this.options.durationInputName,e.duration),startFrequency:this.getNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),endFrequency:this.getNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),startVolume:this.getNumberInputValue(this.options.startVolumeInputName,e.startVolume),endVolume:this.getNumberInputValue(this.options.endVolumeInputName,e.endVolume),wave:h(u,this.getFieldDropdownValue(this.options.waveFieldName))||e.wave,interpolation:h(p,this.getFieldDropdownValue(this.options.interpolationFieldName))||e.interpolation,effect:h(d,this.getFieldDropdownValue(this.options.effectFieldName))||e.effect}}readBlockDataSound(){const e=this.getBlockData();let t;try{t=JSON.parse(e)}catch(e){t={duration:1e3,startFrequency:100,endFrequency:4800,startVolume:100,endVolume:0,wave:"sine",interpolation:"linear",effect:"none"}}return t}}n.FieldSoundEffect=c;const u={sine:"WaveShape.Sine",square:"WaveShape.Square",sawtooth:"WaveShape.Sawtooth",triangle:"WaveShape.Triangle",noise:"WaveShape.Noise"},d={none:"SoundExpressionEffect.None",vibrato:"SoundExpressionEffect.Vibrato",tremolo:"SoundExpressionEffect.Tremolo",warble:"SoundExpressionEffect.Warble"},p={linear:"InterpolationCurve.Linear",curve:"InterpolationCurve.Curve",logarithmic:"InterpolationCurve.Logarithmic"};function h(e,t){return Object.keys(e).find(n=>e[n]===t)}function f(e){if(!e)return!1;if("string"==typeof e)switch(e.toLowerCase().trim()){case"1":case"yes":case"y":case"on":case"true":return!0;default:return!1}return!!e}},{"./field_base":31,"./field_utils":69,blockly:176}],52:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSpeed=void 0;const i=e("../plugins/math");class r extends i.FieldSlider{constructor(e,t,n){super(String(e),"-100","100","1","10","Speed",n),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.format||(this.params.format="{0}%")}createLabelDom_(e){const t=document.createElement("div");this.speedSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.speedSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.speedSVG);pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"});this.circleBar=pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.speedSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:`font-size: ${Math.max(14,50-5*(this.params.format.length-4))}px`,class:"sim-text inverted number"});const n=document.createElement("span");return n.setAttribute("class","blocklyFieldSliderReadout"),[t,n]}setReadout(e){this.updateSpeed("string"==typeof e?parseFloat(e):e),this.params&&this.reporter&&(this.reporter.textContent=ts.pxtc.U.rlf(this.params.format,e))}updateSpeed(e){if(!this.circleBar)return;let t=this.sign(e);e=Math.abs(e)/100*50+50,-1==t&&(e=50-e);let n=(100-e)/100*(180*Math.PI);this.circleBar.setAttribute("stroke-dashoffset",`${n}`)}sign(e){return e?e<0?-1:1:0}}n.FieldSpeed=r},{"../plugins/math":120}],53:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSpriteEditor=void 0;const i=e("./field_asset");class r extends i.FieldAssetEditor{getAssetType(){return"image"}createNewAsset(e){const t=pxt.react.getTilemapProject();if(e){const n=pxt.lookupProjectAssetByTSReference(e,t);if(n)return n}if(this.getBlockData())return t.lookupAsset("image",this.getBlockData());const n=e?pxt.sprite.imageLiteralToBitmap(e,this.params.taggedTemplate):new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight);let i;if(!n){if(i=s(e),!i)return this.isGreyBlock=!0,void(this.valueText=e);this.qName=e}i||(i=n.data());return{internalID:-1,id:this.temporaryAssetId(),type:"image",jresData:pxt.sprite.base64EncodeBitmap(i),meta:{},bitmap:i}}getValueText(){if(!this.asset)return this.valueText||"";if(this.asset&&!this.isTemporaryAsset())return pxt.getTSReferenceForAsset(this.asset);if(this.qName){const e=s(this.qName);if(e&&pxt.sprite.bitmapEquals(e,this.asset.bitmap))return this.qName}return pxt.sprite.bitmapToImageLiteral(this.asset&&pxt.sprite.Bitmap.fromData(this.asset.bitmap),"typescript",this.params.taggedTemplate)}parseFieldOptions(e){return function(e){const t={initColor:1,initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};if(!e)return t;if(t.lightMode=e.lightMode,e.sizes){const n=e.sizes.split(";"),i=[];for(let e=0;e<n.length;e++){const t=n[e].split(",");if(2!==t.length)continue;let r=parseInt(t[0]),s=parseInt(t[1]);if(isNaN(r)||isNaN(s))continue;const o=pxt.appTarget.runtime&&pxt.appTarget.runtime.screenSize;r<0&&o&&(r=o.width),s<0&&o&&(s=o.height),i.push([r,s])}i.length>0&&(t.initWidth=i[0][0],t.initHeight=i[0][1])}e.filter&&(t.filter=e.filter);e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize);return t.initColor=n(e.initColor,t.initColor),t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t.taggedTemplate=e.taggedTemplate,t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(e)}}function s(e){const t=pxt.react.getTilemapProject().getGalleryAssets("image").filter(t=>t.id===e),n=t.length&&t[0];if(n)return n.bitmap}n.FieldSpriteEditor=r},{"./field_asset":29}],54:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldStyledLabel=void 0;const i=e("blockly");class r extends i.FieldLabel{constructor(e,t,n){super(e,function(e){if(e){if(e.bold&&e.italics)return"blocklyBoldItalicizedText";if(e.bold)return"blocklyBoldText";if(e.italics)return"blocklyItalicizedText"}return}(t)),this.isFieldCustom_=!0}getFieldDescription(){return this.getText()}}n.FieldStyledLabel=r},{blockly:176}],55:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTextDropdown=n.BaseFieldTextDropdown=void 0;const i=e("blockly"),r=e("./field_utils");class s extends i.FieldTextInput{constructor(e,t,n){super(e,n),this.menuGenerator_=t,this.selectedMenuItem=null,this.menu_=null,this.svgArrow=null,this.generatedOptions=null,this.menuItems=[],this.lastHighlightedMenuElement=null}initView(){super.initView(),this.createSVGArrow()}inputKeydownListener(e){"ArrowDown"===e.key&&(e.preventDefault(),this.menu_.focus(),this.selectedMenuItem?this.menu_.setHighlighted(this.selectedMenuItem):this.menu_.setHighlighted(this.menuItems[0]))}dropdownKeydownListener(e){const t=this.menu_.getElement().querySelector(".blocklyMenuItemHighlight");"ArrowUp"!==e.key||t!==this.lastHighlightedMenuElement&&this.lastHighlightedMenuElement||(e.preventDefault(),this.selectedMenuItem=null,this.menu_.setHighlighted(null),this.htmlInput_.focus()),this.lastHighlightedMenuElement=t}showEditor_(e,t){super.showEditor_(e,!0),this.dropDownOpen_||this.showDropdown_(),i.Touch.clearTouchIdentifier(),this.inputKeydownHandler=this.inputKeydownListener.bind(this),this.htmlInput_.addEventListener("keydown",this.inputKeydownHandler),t||this.htmlInput_.focus()}doValueUpdate_(e){(null==e?void 0:e.length)>1&&e.charAt(0)===e.charAt(e.length-1)&&("'"===e.charAt(0)||'"'===e.charAt(0))&&(e=e.slice(1,e.length-1)),super.doValueUpdate_(e)}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)?"string"!=typeof i[1]?(t=!0,pxt.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+i[1]+" in: ",i)):i[0]&&"string"!=typeof i[0]&&!(0,r.isImageProperties)(i[0])&&(t=!0,pxt.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+i[0]+" in: ",i)):(t=!0,pxt.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",i))}if(t)throw TypeError("Found invalid FieldDropdown options.")}(this.generatedOptions),this.generatedOptions)}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getFieldDescription(){return this.getText()}dropdownDispose_(){i.WidgetDiv.getDiv().removeEventListener("keydown",this.inputKeydownHandler),this.menu_.getElement().removeEventListener("keydown",this.dropdownKeydownHandler),this.dropDownOpen_=!1,this.menu_&&this.menu_.dispose(),this.menu_=null,this.selectedMenuItem=null,this.menuItems=[],this.applyColour()}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new i.UnattachedFieldError;const t=new i.Menu;t.setRole(i.utils.aria.Role.LISTBOX),this.menu_=t;const n=this.getOptions(!1);this.selectedMenuItem=null;for(let s=0;s<n.length;s++){const[o,a]=n[s],l=(()=>{if((0,r.isImageProperties)(o)){const e=new Image(o.width,o.height);return e.src=o.src,e.alt=o.alt,e}return o})(),c=new i.MenuItem(l,a);c.setRole(i.utils.aria.Role.OPTION),c.setRightToLeft(e.RTL),c.setCheckable(!0),t.addChild(c),c.setChecked(a===this.value_),a===this.value_&&(this.selectedMenuItem=c),c.onAction(this.handleMenuActionEvent,this),this.menuItems.push(c)}}showDropdown_(e){const t=this.getSourceBlock();if(!t)throw new i.UnattachedFieldError;this.dropdownCreate(),e&&"number"==typeof e.clientX?this.menu_.openingCoords=new i.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,(0,r.clearDropDownDiv)();const n=this.menu_.render(i.DropDownDiv.getContentDiv());i.utils.dom.addClass(n,"blocklyDropdownMenu");const s=t.getParent(),o=(s||t).getColour(),a=(s||t).style.colourTertiary;i.DropDownDiv.setColour(o,a),this.dropDownOpen_=!0,i.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this),void 0,!1),this.dropdownKeydownHandler=this.dropdownKeydownListener.bind(this),this.menu_.getElement().addEventListener("keydown",this.dropdownKeydownHandler),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),i.utils.style.scrollIntoContainerView(this.selectedMenuItem.getElement(),i.DropDownDiv.getContentDiv(),!0)),this.applyColour()}updateSize_(e){super.updateSize_(e);const t=this.positionSVGArrow(this.size_.width,this.size_.height/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2);if(this.sourceBlock_.RTL&&this.textElement_){const e=this.getConstants(),n=i.utils.dom.getFastTextWidth(this.textElement_,e.FIELD_TEXT_FONTSIZE,e.FIELD_TEXT_FONTWEIGHT,e.FIELD_TEXT_FONTFAMILY);this.positionTextElement_(-t,n)}this.size_.width+=t}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const n=this.getSourceBlock();if(!n)throw new i.UnattachedFieldError;const r=!!this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,s=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,o=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE,a=n.RTL?r/2:e+s;return this.svgArrow.setAttribute("transform","translate("+a+","+t+")"),o+s}createSVGArrow(){this.svgArrow=i.utils.dom.createSvgElement("image",{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(i.utils.dom.XLINK_NS,"xlink:href",o.DROPDOWN_SVG_DATAURI)}handleMenuActionEvent(e){i.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue()),i.WidgetDiv.hideIfOwner(this)}}n.BaseFieldTextDropdown=s,s.DROPDOWN_SVG_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiM1NzVFNzUiLz48L3N2Zz4K";class o extends s{constructor(e,t,n){super(e,function(e){if(e.values)return e.values.split(",").map(e=>[e,e]);if(e.data){let t;try{const n=JSON.parse(e.data);if(Array.isArray(n)&&n.length)if(a(n))t=n.map(e=>[e,e]);else{let e=!1;for(const t of n)if(!Array.isArray(t)||2!==t.length||!a(t)){e=!0;break}e||(t=n)}}catch(e){}if(t)return t;pxt.warn("Could not parse textdropdown data field")}return[]}(t),n),this.isFieldCustom_=!0}}function a(e){for(const t of e)if("string"!=typeof t)return!1;return!0}n.FieldTextDropdown=o},{"./field_utils":69,blockly:176}],56:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTextInput=void 0;const i=e("blockly");class r extends i.FieldTextInput{constructor(e,t,n){super(e,n),this.isFieldCustom_=!0}getFieldDescription(){return this.getValue()}}n.FieldTextInput=r},{blockly:176}],57:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTilemap=void 0;const i=e("./field_asset");class r extends i.FieldAssetEditor{getInitText(){return this.initText}getTileset(){var e;return null===(e=this.asset)||void 0===e?void 0:e.data.tileset}getAssetType(){return"tilemap"}createNewAsset(e=""){var t;e&&(e=e.replace(/&#96;/g,"`"));const n=pxt.react.getTilemapProject(),i=pxt.lookupProjectAssetByTSReference(e,n);if(i)return i;if(null===(t=this.sourceBlock_)||void 0===t?void 0:t.isInFlyout)return;const r=pxt.sprite.decodeTilemap(e,"typescript",n)||n.blankTilemap(this.params.tileWidth,this.params.initWidth,this.params.initHeight);let s;if(function(e){return!!(e&&e.tilemap&&e.tilemap.width&&e.tilemap.height)&&(!(!e.layers||e.layers.width!==e.tilemap.width||e.layers.height!==e.tilemap.height)&&!!e.tileset)}(r)){this.initText=e,this.isGreyBlock=!1;const[t]=n.createNewTilemapFromData(r);s=n.getTilemap(t)}else e.trim()&&(this.isGreyBlock=!0,this.valueText=e);return s}onEditorClose(e){pxt.sprite.updateTilemapReferencesFromResult(pxt.react.getTilemapProject(),e)}getValueText(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.asset?pxt.getTSReferenceForAsset(this.asset):this.initText?this.getInitText():this.valueText||""}parseFieldOptions(e){return function(e){const t={initWidth:16,initHeight:16,disableResize:!1,tileWidth:16,lightMode:!1};if(!e)return t;t.lightMode=e.lightMode,e.filter&&(t.filter=e.filter);if(e.tileWidth)if("number"==typeof e.tileWidth)switch(e.tileWidth){case 4:t.tileWidth=4;break;case 8:t.tileWidth=8;break;case 16:t.tileWidth=16;break;case 32:t.tileWidth=32}else{switch(e.tileWidth.trim().toLowerCase()){case"4":case"four":t.tileWidth=4;break;case"8":case"eight":t.tileWidth=8;break;case"16":case"sixteen":t.tileWidth=16;break;case"32":case"thirtytwo":t.tileWidth=32}}return t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(e)}}n.FieldTilemap=r},{"./field_asset":29}],58:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTileset=void 0;const i=e("./field_images"),r=e("./field_utils"),s=32;class o extends i.FieldImages{constructor(e,t,n){super(e,t,n),this.isFieldCustom_=!0,this.menuGenerator_=()=>{var e,t;return(null===(e=this.sourceBlock_)||void 0===e?void 0:e.workspace)&&(0,r.needsTilemapUpgrade)(null===(t=this.sourceBlock_)||void 0===t?void 0:t.workspace)?[a()]:o.getReferencedTiles(this.sourceBlock_.workspace)},this.assetChangeListener=()=>{this.doValueUpdate_(this.getValue()),this.forceRerender()},this.blocksInfo=t.blocksInfo}static getReferencedTiles(e){const t=pxt.react.getTilemapProject(),n=pxt.appTarget.runtime.palette?pxt.appTarget.runtime.palette.join(""):void 0;if(n!==o.cachedPalette&&(this.bitmapCache.clear(),this.cachedPalette=n,this.cachedRevision=-1),o.cachedRevision!==t.revision()){o.cachedRevision=t.revision();const n=(0,r.getAllReferencedTiles)(e),i=[16,4,8,32];for(const e of i){const i=t.getProjectTiles(e,16===e);if(i)for(const e of i.tiles)n.find(t=>t.id===e.id)||n.push(e)}let a={};n.sort((e,t)=>e.id===t.id?0:e.bitmap.width!==t.bitmap.width?e.bitmap.width-t.bitmap.width:e.isProjectTile!==t.isProjectTile?e.isProjectTile?-1:1:(a[e.id]||(a[e.id]=c(e.id)))-(a[t.id]||(a[t.id]=c(t.id)))),o.referencedTiles=n.map(e=>[{src:o.getTileImage(e),width:s,height:s,alt:u(e)||e.id},e.id,e])}return o.referencedTiles}static getTileImage(e){const t=pxt.U.toHex(e.bitmap.data)+"-"+e.bitmap.width+"-"+e.bitmap.height;return this.bitmapCache.has(t)||(c(e.id)<=2?this.bitmapCache.set(t,l(e.bitmap.width)):this.bitmapCache.set(t,(0,r.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e.bitmap),s,!1))),this.bitmapCache.get(t)}initView(){super.initView(),this.sourceBlock_&&this.sourceBlock_.isInFlyout&&this.setValue(this.getOptions()[0][1])}getValue(){const e=pxt.react.getTilemapProject();if(this.selectedOption_){let t=this.selectedOption_[2];return t=e.lookupAsset(t.type,t.id),t?pxt.getTSReferenceForAsset(t):super.getValue()}const t=super.getValue();if("string"==typeof t){if(-1!==t.indexOf(".")){const n=e.lookupAsset("tile",t);if(n)return pxt.getTSReferenceForAsset(n)}if(-1===t.indexOf("`"))return`img\`${t}\``}return t}getText(){const e=this.getValue();return"string"==typeof e&&-1!==e.indexOf("`")?e:super.getText()}render_(){if(this.value_&&this.selectedOption_&&this.selectedOption_[1]!==this.value_){const e=pxt.react.getTilemapProject().resolveTile(this.value_);e&&(this.selectedOption_=[{src:(0,r.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e.bitmap),s,!1),width:s,height:s,alt:u(e)||e.id},this.value_,e])}super.render_()}doValueUpdate_(e){let t=!1;const n=this.getOptions(!0);if(e){const i=pxt.parseAssetTSReference(e);i&&(e=i.name),e=e.trim();for(const i of n)if(e===i[2].id||e===i[2].meta.displayName||e===pxt.getShortIDForAsset(i[2]))return this.selectedOption_=i,this.value_=this.getValue(),this.updateAssetListener(),super.doValueUpdate_(i[1]),void(t=!0);t||super.doValueUpdate_(e),this.selectedOption_=null,this.updateAssetListener()}}doClassValidation_(e){if(!this.getOptions(!0).some(([t,n])=>n===e)){if(e){const t=pxt.react.getTilemapProject(),n=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(e);let i;if(i=n?t.lookupAssetByName("tile",n[1]):e.startsWith(pxt.sprite.TILE_NAMESPACE)?t.lookupAsset("tile",e.trim()):t.lookupAssetByName("tile",e.trim()),i)return this.localTile=i,pxt.getTSReferenceForAsset(i,!1)}return this.sourceBlock_&&pxt.warn(`Trying to set tile reference to nonexistent tile. Block type: ${this.sourceBlock_.type}, Field name: ${this.name}, Value: ${e}`),null}return this.localTile=void 0,e}getOptions(e){if("function"!=typeof this.menuGenerator_){this.transparent=a();const e=[this.transparent];return this.localTile&&e.push([{src:(0,r.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.localTile.bitmap),s,!1),width:s,height:s,alt:u(this.localTile)||this.localTile.id},this.localTile.id,this.localTile]),e}return this.menuGenerator_.call(this)}dispose(){super.dispose(),pxt.react.getTilemapProject().removeChangeListener("tile",this.assetChangeListener)}updateAssetListener(){const e=pxt.react.getTilemapProject();e.removeChangeListener("tile",this.assetChangeListener),this.selectedOption_&&e.addChangeListener(this.selectedOption_[2],this.assetChangeListener)}saveState(e){var t;let n=this.localTile||(null===(t=this.selectedOption_)||void 0===t?void 0:t[2]);const i=pxt.react.getTilemapProject();if(!n){const e=this.getValue(),t=pxt.parseAssetTSReference(e);t&&(n=i.lookupAssetByName("tile",t.name)),n||(n=i.lookupAsset("tile",e))}return(null==n?void 0:n.isProjectTile)?(0,r.getAssetSaveState)(n):super.saveState(e)}loadState(e){if("string"==typeof e)return void super.loadState(e);const t=(0,r.loadAssetFromSaveState)(e);this.localTile=t,super.loadState(pxt.getTSReferenceForAsset(t))}getFieldDescription(){return lf("tile")}}function a(){const e=pxt.react.getTilemapProject().getTransparency(16);return[{src:l(16),width:s,height:s,alt:pxt.U.lf("transparency")},e.id,e]}function l(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.width=e,t.height=e,n.fillStyle="#aeaeae",n.fillRect(0,0,e,e),n.fillStyle="#dedede";for(let t=0;t<e;t+=4)for(let i=0;i<e;i+=4)t+i>>2&1&&n.fillRect(t,i,4,4);return t.toDataURL()}function c(e){switch(e){case"myTiles.transparency16":return 1;case"myTiles.transparency4":case"myTiles.transparency8":case"myTiles.transparency32":return 2;default:if(e.startsWith("myTiles.tile")){const t=parseInt(e.slice(12));if(!Number.isNaN(t))return t+2}return 9999999999}}function u(e){return e.meta.displayName||pxt.getShortIDForAsset(e)}n.FieldTileset=o,o.cachedRevision=-1,o.bitmapCache=new Map},{"./field_images":39,"./field_utils":69}],59:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggle=n.BaseFieldToggle=void 0;const i=e("blockly"),r=e("../constants");class s extends i.FieldNumber{constructor(e,t,n,i,r){super(e,void 0,void 0,void 0,r),this.trueText=n,this.falseText=i,this.isFieldCustom_=!0,this.CURSOR="pointer",this.params=t,this.setValue(e),this.type_=t.type}initView(){if(!this.fieldGroup_)return;this.clickTarget_=this.sourceBlock_.getSvgRoot(),!this.sourceBlock_.isShadow()&&this.sourceBlock_.inputList&&this.sourceBlock_.inputList.length>1&&(this.borderRect_=i.utils.dom.createSvgElement("rect",{rx:this.getConstants().CORNER_RADIUS,ry:this.getConstants().CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,fill:this.sourceBlock_.getColour(),stroke:this.sourceBlock_.getColourTertiary()},null),this.fieldGroup_.insertBefore(this.borderRect_,this.textElement_));const e=this.getSize();switch(this.checkElement_=i.utils.dom.createSvgElement("g",{class:"blocklyToggle "+(this.state_?"blocklyToggleOn":"blocklyToggleOff"),transform:`translate(8, ${e.height/2})`},this.fieldGroup_),this.getOutputShape()){case r.provider.SHAPES.HEXAGONAL:this.toggleThumb_=i.utils.dom.createSvgElement("polygon",{class:"blocklyToggleRect",points:"-7,-14 -21,0 -7,14 7,14 21,0 7,-14",cursor:"pointer"},this.checkElement_);break;case r.provider.SHAPES.ROUND:this.toggleThumb_=i.utils.dom.createSvgElement("rect",{class:"blocklyToggleCircle",x:-6,y:-14,height:28,width:28,rx:14,ry:14,cursor:"pointer"},this.checkElement_);break;case r.provider.SHAPES.SQUARE:this.toggleThumb_=i.utils.dom.createSvgElement("rect",{class:"blocklyToggleRect",x:-6,y:-14,height:28,width:28,rx:3,ry:3,cursor:"pointer"},this.checkElement_)}let t=this.sourceBlock_.RTL?-e.width/2:e.width/2;this.textElement_=i.utils.dom.createSvgElement("text",{class:"blocklyText",x:t,dy:"0.6ex",y:e.height/2},this.fieldGroup_),this.updateEditable(),this.switchToggle(this.state_),this.setValue(this.getValue()),this.markDirty()}getDisplayText_(){return this.state_?this.getTrueText():this.getFalseText()}getTrueText(){return this.trueText}getFalseText(){return this.falseText}getFieldDescription(){return this.getDisplayText_()}updateSize_(){switch(this.getOutputShape()){case r.provider.SHAPES.ROUND:this.size_.width=2*this.getInnerWidth()-7;break;case r.provider.SHAPES.HEXAGONAL:this.size_.width=2*this.getInnerWidth()+8-Math.floor(this.getInnerWidth()/2);break;case r.provider.SHAPES.SQUARE:this.size_.width=9+2*this.getInnerWidth()}}getInnerWidth(){return 10*this.getMaxLength()}getMaxLength(){return Math.max(this.getTrueText().length,this.getFalseText().length)}getOutputShape(){return this.sourceBlock_.isShadow()?this.sourceBlock_.getOutputShape():r.provider.SHAPES.SQUARE}doClassValidation_(e){return"boolean"==typeof this.fromVal(e)?e:"false"}applyColour(){let e=this.sourceBlock_.getColourTertiary();this.borderRect_?this.borderRect_.setAttribute("stroke",e):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e)}getValue(){return this.toVal(this.state_)}doValueUpdate_(e){let t=this.fromVal(e);this.state_!==t&&(this.sourceBlock_&&i.Events.isEnabled()&&i.Events.fire(new i.Events.BlockChange(this.sourceBlock_,"field",this.name,this.state_,t)),this.state_=t,this.switchToggle(this.state_),this.isDirty_=!0)}switchToggle(e){if(this.checkElement_){this.updateSize_();const t=this.getSize(),n=this.getInnerWidth();e?(pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOff")):(pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOff"));const i=this.getOutputShape();let s=0,o=0,a=0,l=0;switch(i){case r.provider.SHAPES.HEXAGONAL:s=t.width/2,o=s/2,a=-o,l=o-n,this.toggleThumb_.setAttribute("points",`0,-14 -14,0 0,14 ${s},14 ${s+14},0 ${s},-14`);break;case r.provider.SHAPES.ROUND:case r.provider.SHAPES.SQUARE:s=5+n,o=s/2,this.toggleThumb_.setAttribute("width",""+s),this.toggleThumb_.setAttribute("x",`-${o}`),a=l=i==r.provider.SHAPES.SQUARE?2:-6}this.checkElement_.setAttribute("transform",`translate(${e?l+n+o:o+a}, ${t.height/2})`)}}render_(){if(this.visible_&&this.textElement_){for(;this.textElement_.firstChild;)this.textElement_.firstChild.remove();let e=document.createTextNode(this.getDisplayText_());this.textElement_.appendChild(e),pxt.BrowserUtils.addClass(this.textElement_,"blocklyToggleText"),this.updateSize_();let t=this.size_.width,n=(this.state_?t+t/8:t/2)-t/2;this.textElement_.setAttribute("x",`${n}`)}this.borderRect_&&(this.borderRect_.setAttribute("width",`${this.size_.width}`),this.borderRect_.setAttribute("height",`${this.size_.height}`))}showEditor_(){let e=!this.state_;null!==e&&this.setValue(this.toVal(e))}toVal(e){return"number"==this.type_?String(e?"1":"0"):String(e?"true":"false")}fromVal(e){return"string"==typeof e?"1"==e||"TRUE"==e.toUpperCase():!!e}}n.BaseFieldToggle=s;n.FieldToggle=class extends s{constructor(e,t,n){super(e,t,lf("True"),lf("False"),n)}}},{"../constants":18,blockly:176}],60:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleDownUp=void 0;const i=e("./field_toggle");class r extends i.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("DOWN"),lf("UP"),n)}}n.FieldToggleDownUp=r},{"./field_toggle":59}],61:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleHighLow=void 0;const i=e("./field_toggle");class r extends i.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("HIGH"),lf("LOW"),n)}}n.FieldToggleHighLow=r},{"./field_toggle":59}],62:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleOnOff=void 0;const i=e("./field_toggle");class r extends i.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("ON"),lf("OFF"),n)}}n.FieldToggleOnOff=r},{"./field_toggle":59}],63:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleUpDown=void 0;const i=e("./field_toggle");class r extends i.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("UP"),lf("DOWN"),n)}}n.FieldToggleUpDown=r},{"./field_toggle":59}],64:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleWinLose=void 0;const i=e("./field_toggle");class r extends i.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("WIN"),lf("LOSE"),n)}}n.FieldToggleWinLose=r},{"./field_toggle":59}],65:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleYesNo=void 0;const i=e("./field_toggle");class r extends i.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("Yes"),lf("No"),n)}}n.FieldToggleYesNo=r},{"./field_toggle":59}],66:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTsExpression=void 0;const i=e("blockly");class r extends i.FieldTextInput{constructor(){super(...arguments),this.isFieldCustom_=!0,this.pythonMode=!1}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(pxt.BrowserUtils.addClass(e,"blocklyEditableText"),pxt.BrowserUtils.removeClass(e,"blocklyGreyExpressionBlockText")):(pxt.BrowserUtils.addClass(e,"blocklyGreyExpressionBlockText"),pxt.BrowserUtils.removeClass(e,"blocklyEditableText")))}setPythonEnabled(e){e!==this.pythonMode&&(this.pythonMode=e,this.forceRerender())}getText(){return this.pythonMode?pxt.Util.lf("<python code>"):this.getValue()}getFieldDescription(){return this.pythonMode?pxt.Util.lf("<python code>"):pxt.Util.lf("<typescript code>")}applyColour(){var e;this.sourceBlock_&&(null===(e=this.getConstants())||void 0===e?void 0:e.FULL_BLOCK_FIELDS)&&this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourPrimary),this.borderRect_.setAttribute("fill",this.sourceBlock_.style.colourPrimary))}}n.FieldTsExpression=r},{blockly:176}],67:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTurnRatio=void 0;const i=e("blockly"),r=e("../plugins/math");class s extends r.FieldSlider{constructor(e,t,n){super(String(e),"-200","200","1","10","TurnRatio",n),this.isFieldCustom_=!0,this.params=t,this.sliderColor_="#a8aaa8"}createLabelDom_(e){let t=document.createElement("div"),n=i.utils.dom.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:s.HALF+s.HANDLE_RADIUS+10+"px",width:2*s.HALF+"px"},t),r=i.utils.dom.createSvgElement("defs",{},n),o=i.utils.dom.createSvgElement("marker",{id:"head",orient:"auto",markerWidth:"2",markerHeight:"4",refX:"0.1",refY:"1.5"},r);i.utils.dom.createSvgElement("path",{d:"M0,0 V3 L1.5,1.5 Z",fill:"#f12a21"},o);this.reporter_=pxsim.svg.child(n,"text",{x:s.HALF,y:96,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"}),this.path_=i.utils.dom.createSvgElement("path",{x1:s.HALF,y1:s.HALF,"marker-end":"url(#head)",style:"fill: none; stroke: #f12a21; stroke-width: 10"},n),this.updateGraph_();let a=document.createElement("span");return a.setAttribute("class","blocklyFieldSliderReadout"),[t,a]}updateGraph_(){if(!this.path_)return;let e=Math.min(Math.max(Number(this.getValue())||0,-200),200);const t=e/100,n=Math.max(-1,Math.min(1,t)),i=Math.max(n)*Math.PI/2,r=s.RADIUS-6;let o=s.HALF;const a=s.HALF-22;Math.abs(t)>1&&(o-=(t-(t>0?1:-1))*r/2);const l=.2+.5*Math.abs(n),c=r*l,u=r*Math.sin(Math.PI/2-i),d=r*Math.cos(Math.PI/2-i),p=u-r*l*Math.cos(2*i),h=`M ${o} ${a} C ${o} ${a-c} ${o+(d-r*l*Math.sin(2*i))} ${a-p} ${o+d} ${a-u}`;this.path_.setAttribute("d",h),this.reporter_.textContent=`${e}`}setReadout(e){this.updateGraph_()}}n.FieldTurnRatio=s,s.HALF=80,s.HANDLE_RADIUS=30,s.RADIUS=s.HALF-s.HANDLE_RADIUS-1},{"../plugins/math":120,blockly:176}],68:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNextValue=n.FieldUserEnum=void 0;const i=e("blockly"),r=e("../external"),s=e("./field_dropdown");class o extends s.FieldDropdown{constructor(e){super(function(e){return function(){const t=[];if(this.sourceBlock_&&this.sourceBlock_.workspace){this.sourceBlock_.workspace.getVariableMap().getVariablesOfType(e.name).forEach(e=>{const n=e.getName().replace(/^\d+/,"");t.push([n,e.getName()])})}else e.initialMembers.forEach(e=>t.push([e,e]));return t.push([lf("Add a new {0}...",e.memberName),"CREATE"]),t}}(e)),this.opts=e}init(){super.init(),this.initVariables()}onItemSelected_(e,t){"CREATE"===t.getValue()?a(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),e=>e&&this.setValue(e)):super.onItemSelected_(e,t)}doClassValidation_(e){var t;return(null===(t=this.opts)||void 0===t?void 0:t.initialMembers)&&!this.opts.initialMembers.find(t=>t==e)&&this.getOptions(),super.doClassValidation_(e)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){const e=this.sourceBlock_.workspace,t=c(e,this.opts.name);if(this.opts.initialMembers.forEach(n=>{t.some(([e,t])=>e===n)||d(e,this.opts,n)}),"CREATE"===this.getValue()){const t=function(e,t,n){const i=e.getVariableMap().getVariablesOfType(t);if(i&&i.length)for(let e=0;e<i.length;e++){const[t]=l(i[e]);if(t===n)return i[e].getName()}return}(e,this.opts.name,this.opts.initialMembers[0]);t&&this.setValue(t)}}}}function a(e,t,n,s){(0,r.prompt)(n,null,r=>{if(r){let o=!1;if(pxtc.isIdentifierStart(r.charCodeAt(0),2)){o=!0;for(let e=1;e<r.length;e++)pxtc.isIdentifierPart(r.charCodeAt(e),2)||(o=!1)}if(!o)return void i.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),()=>a(e,t,n,s));const l=c(e,t.name);for(let o=0;o<l.length;o++){const[c,u]=l[o];if(c===r)return void i.dialog.alert(lf("A {0} named '{1}' already exists.",t.memberName,r),()=>a(e,t,n,s))}s(d(e,t,r))}},{placeholder:t.promptHint})}function l(e){const t=/^(\d+)([^0-9].*)$/.exec(e.getName());return t?[t[2],parseInt(t[1])]:[e.getName(),-1]}function c(e,t){const n=e.getVariableMap().getVariablesOfType(t);return n&&n.length?n.map(l):[]}function u(e,t){const n=e.map(([e,t])=>t);if(t.isBitMask){for(let e=0;e<n.length;e++){let t=1<<e;if(n.indexOf(t)<0)return t}return 1<<n.length}if(t.isHash)return 0;{const e=t.firstValue||0;for(let t=0;t<n.length;t++)if(n.indexOf(e+t)<0)return e+t;return e+n.length}}function d(e,t,n){const r=u(c(e,t.name),t)+n;return i.Variables.getOrCreateVariablePackage(e,null,r,t.name),r}n.FieldUserEnum=o,n.getNextValue=u},{"../external":25,"./field_dropdown":34,blockly:176}],69:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isImageProperties=n.clearDropDownDiv=n.deleteBlockDataForField=n.getBlockDataForField=n.setBlockDataForField=n.setBlockData=n.getBlockData=n.workspaceToScreenCoordinates=n.setMelodyEditorOpen=n.FieldEditorOpenEvent=n.FIELD_EDITOR_OPEN_EVENT_TYPE=n.loadAssetFromSaveState=n.getAssetSaveState=n.getTemporaryAssets=n.getTilesReferencedByTilesets=n.getAllReferencedTiles=n.getAllFields=n.updateTilemapXml=n.needsTilemapUpgrade=n.getAllBlocksWithTilesets=n.getAllBlocksWithTilemaps=n.songToDataURI=n.tilemapToImageURI=n.bitmapToImageURI=n.parseColour=n.svg=void 0;const i=e("blockly"),r=e("./field_tilemap"),s=e("./field_animation"),o=e("./field_musiceditor"),a=e("./field_sprite"),l=e("./field_tileset");function c(e){return d(e,e=>e instanceof r.FieldTilemap&&!e.isGreyBlock)}function u(e){return d(e,e=>e instanceof l.FieldTileset)}function d(e,t){const n=[];return e.getTopBlocks(!1).forEach(e=>i(e)),n;function i(e){for(const r of e.inputList){for(const i of r.fieldRow)t(i)&&n.push({block:e,field:i.name,ref:i});r.connection&&r.connection.targetBlock()&&i(r.connection.targetBlock())}e.nextConnection&&e.nextConnection.targetBlock()&&i(e.nextConnection.targetBlock())}}!function(e){e.hasClass=function(e,t){return pxt.BrowserUtils.containsClass(e,t)},e.addClass=function(e,t){pxt.BrowserUtils.addClass(e,t)},e.removeClass=function(e,t){pxt.BrowserUtils.removeClass(e,t)}}(n.svg||(n.svg={})),n.parseColour=function(e){const t=Number(e);return isNaN(t)?"string"==typeof e&&e.match(/^#[0-9a-fA-F]{6}$/)?e:"#000":i.utils.colour.hueToHex(t)},n.bitmapToImageURI=function(e,t,n){const i=pxt.appTarget.runtime.palette.slice(1),r=document.createElement("canvas");r.width=t,r.height=t;const s=Math.min(t/e.width,t/e.height),o=Math.max(Math.floor(t*(1-e.width/e.height)/2),0),a=Math.max(Math.floor(t*(1-e.height/e.width)/2),0);let l;n?(l=r.getContext("2d",{alpha:!1}),l.fillStyle="#dedede",l.fillRect(0,0,t,t)):l=r.getContext("2d");for(let t=0;t<e.width;t++)for(let r=0;r<e.height;r++){const c=e.get(t,r);c?(l.fillStyle=i[c-1],l.fillRect(o+t*s,a+r*s,s,s)):n&&(l.fillStyle="#dedede",l.fillRect(o+t*s,a+r*s,s,s))}return r.toDataURL()},n.tilemapToImageURI=function(e,t,n){const i=pxt.appTarget.runtime.palette.slice(),r=document.createElement("canvas");r.width=t,r.height=t;const s=Math.min(t/e.tilemap.width,t/e.tilemap.height),o=Math.max(Math.floor(t*(1-e.tilemap.width/e.tilemap.height)/2),0),a=Math.max(Math.floor(t*(1-e.tilemap.height/e.tilemap.width)/2),0);let l;n?(l=r.getContext("2d",{alpha:!1}),l.fillStyle="#dedede",l.fillRect(0,0,t,t)):l=r.getContext("2d");let c=[];for(let t=0;t<e.tilemap.width;t++)for(let r=0;r<e.tilemap.height;r++){const u=e.tilemap.get(t,r);if(u){if(!c[u]){const t=e.tileset.tiles[u];c[u]=t?pxt.sprite.computeAverageColor(pxt.sprite.Bitmap.fromData(t.bitmap),i):"#dedede"}l.fillStyle=c[u],l.fillRect(o+t*s,a+r*s,s,s)}else n&&(l.fillStyle="#dedede",l.fillRect(o+t*s,a+r*s,s,s))}return r.toDataURL()},n.songToDataURI=function(e,t,n,i,r){const s=pxt.appTarget.runtime.palette.slice(),o=document.createElement("canvas");let a;o.width=t,o.height=n,i?(a=o.getContext("2d",{alpha:!1}),a.fillStyle="#dedede",a.fillRect(0,0,t,n)):a=o.getContext("2d");const l=[5,11,5,4,2,6,14,2,5,1];r=r||e.measures;const c=Math.max(Math.floor(t/(e.beatsPerMeasure*r*2)),1),u=Math.floor(t/c),d=Math.max(Math.floor(n/12),1),p=Math.floor(n/d);for(const t of e.tracks)for(const n of t.notes){const i=Math.floor(n.startTick/(e.ticksPerBeat/2));if(i>u)break;for(const r of n.notes){const n=12-r.note%12;n>p||(a.fillStyle=s[l[t.id||e.tracks.indexOf(t)]],a.fillRect(i*c,n*d,c,d))}}return o.toDataURL()},n.getAllBlocksWithTilemaps=c,n.getAllBlocksWithTilesets=u,n.needsTilemapUpgrade=function(e){return!!e.getVariableMap().getVariablesOfType(pxt.sprite.BLOCKLY_TILESET_TYPE).map(e=>pxt.sprite.legacy.blocklyVariableToTile(e.getName())).length},n.updateTilemapXml=function(e,t){let n=!1;const i={};for(const r of e.children)if("variables"===r.tagName.toLowerCase()){const e=[];for(const s of r.children)if(s.getAttribute("type")===pxt.sprite.BLOCKLY_TILESET_TYPE){n=!0;const r=s.textContent,o=pxt.sprite.legacy.blocklyVariableToTile(r);if(!o.qualifiedName){const e="myTiles.tile"+o.projectId,n=t.createNewTile(o.data,e);i[e]=n}e.push(s)}for(const t of e)t.remove()}if(n)for(const n of e.getElementsByTagName("field")){const e=n.textContent,r=e.trim();if(i[r])n.textContent=pxt.getTSReferenceForAsset(i[r]);else if(r.startsWith("tiles.createTilemap(")){const r=pxt.sprite.legacy.decodeTilemap(e,"typescript"),s=[],o=new pxt.sprite.TilemapData(r.tilemap,{tileWidth:r.tileset.tileWidth,tiles:r.tileset.tiles.map((e,n)=>null!=e.projectId?i["myTiles.tile"+e.projectId]:(s[n]||(s[n]=t.resolveTile(e.qualifiedName)),s[n]))},r.layers),[a]=t.createNewTilemapFromData(o),l=t.lookupAsset("tilemap",a);n.textContent=pxt.getTSReferenceForAsset(l)}}},n.getAllFields=d,n.getAllReferencedTiles=function(e,t){var n;let i={};const r=c(e),s=pxt.react.getTilemapProject();for(const e of r)if(e.block.id!==t)for(const t of(null===(n=e.ref.getTileset())||void 0===n?void 0:n.tiles)||[])i[t.id]=s.lookupAsset("tile",t.id);const o=s.getAssets("tilemap");for(const e of o)for(const t of e.data.tileset.tiles)i[t.id]=s.lookupAsset("tile",t.id);const a=u(e);for(const e of a){const t=e.ref.getValue(),n=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(t);if(n){const e=s.lookupAssetByName("tile",n[1]);e&&!i[e.id]&&(i[e.id]=e)}else i[t]||(i[t]=s.resolveTile(t))}return Object.keys(i).map(e=>i[e]).filter(e=>!!e)},n.getTilesReferencedByTilesets=function(e){let t={};const n=pxt.react.getTilemapProject(),i=u(e);for(const e of i){const i=e.ref.getValue(),r=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(i);if(r){const e=n.lookupAssetByName("tile",r[1]);e&&!t[e.id]&&(t[e.id]=e)}else t[i]||(t[i]=n.resolveTile(i))}return Object.keys(t).map(e=>t[e]).filter(e=>!!e)},n.getTemporaryAssets=function(e,t){switch(t){case"image":return d(e,e=>e instanceof a.FieldSpriteEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());case"animation":return d(e,e=>e instanceof s.FieldAnimationEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());case"song":return d(e,e=>e instanceof o.FieldMusicEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());default:return[]}},n.getAssetSaveState=function(e){const t={version:1,assetType:e.type,assetId:e.id,jres:{}},n=pxt.react.getTilemapProject();if("tilemap"===e.type){const i=n.getProjectTilesetJRes();for(const t of Object.keys(i)){if("*"===t)continue;const n=i[t];if(n.mimeType===pxt.TILEMAP_MIME_TYPE)n.id!==e.id&&delete i[t];else{const n=m(i["*"].namespace)+t;e.data.tileset.tiles.some(e=>e.id===n)||delete i[t]}}t.jres=i}else{const i="tile"===e.type?n.getProjectTilesetJRes():n.getProjectAssetsJRes();t.jres["*"]=i["*"];const[r,s]=g(i,e.id);t.jres[r]=s}return t},n.loadAssetFromSaveState=function(e){let t=e.assetId;e.jres=function(e){const t=e["*"],n={"*":t};for(const i of Object.keys(e)){if("*"===i)continue;const r=e[i];n[i]="string"==typeof r?{id:void 0,data:r,mimeType:t.mimeType}:r}return n}(e.jres);const n=pxt.react.getTilemapProject(),i=n.lookupAsset(e.assetType,e.assetId);if(i){const r=new pxt.TilemapProject;r.loadGallerySnapshot(n.saveGallerySnapshot()),"tilemap"===e.assetType||"tile"===e.assetType?r.loadTilemapJRes(e.jres):r.loadAssetsJRes(e.jres);const s=r.lookupAsset(e.assetType,e.assetId);if(pxt.assetEquals(s,i,!0))return i;{const i=n.lookupAssetByValue(s.type,s);if(i)return i;t=n.generateNewID(e.assetType);const[r,o]=g(e.jres,e.assetId);if(delete e.jres[r],"tilemap"===e.assetType)o.id=t,e.jres[t]=o;else{const[n,i]=t.split(".");m(n)!==m(e.jres["*"].namespace)&&(o.namespace=m(n)),o.id=t,e.jres[i]=o}}}return"tilemap"===e.assetType||"tile"===e.assetType?n.loadTilemapJRes(e.jres,!0):n.loadAssetsJRes(e.jres),n.lookupAsset(e.assetType,t)},n.FIELD_EDITOR_OPEN_EVENT_TYPE="field_editor_open";class p extends i.Events.UiBase{constructor(e,t){super(e.workspace.id),this.type=n.FIELD_EDITOR_OPEN_EVENT_TYPE,this.blockId=e.id,this.isOpen=t}}function h(e){return e.data?/^(?:\d+;?)+$/.test(e.data)?{commentRefs:e.data.split(";"),fieldData:{}}:JSON.parse(e.data):{commentRefs:[],fieldData:{}}}function f(e,t){e.data=JSON.stringify(t)}function m(e){return e.endsWith(".")?e:e+"."}function g(e,t){const n=e["*"].namespace;for(const i of Object.keys(e)){if("*"===i)continue;const r=e[i];let s;if(s=r.id?r.namespace?m(r.namespace)+r.id:r.id:r.namespace?m(r.namespace)+i:m(n)+i,s===t)return[i,e[i]]}}n.FieldEditorOpenEvent=p,n.setMelodyEditorOpen=function(e,t){i.Events.fire(new p(e,t))},n.workspaceToScreenCoordinates=function(e,t){const n=t.scale(e.scale),r=e.getOriginOffsetInPixels(),s=i.utils.Coordinate.sum(n,r),o=e.getInjectionDiv().getBoundingClientRect();return new i.utils.Coordinate(s.x+o.left,s.y+o.top)},n.getBlockData=h,n.setBlockData=f,n.setBlockDataForField=function(e,t,n){const i=h(e);i.fieldData[t]=n,f(e,i)},n.getBlockDataForField=function(e,t){return h(e).fieldData[t]},n.deleteBlockDataForField=function(e,t){const n=h(e);delete n.fieldData[t],f(e,n)},n.clearDropDownDiv=function(){i.DropDownDiv.clearContent(),i.DropDownDiv.getContentDiv().style.height=""},n.isImageProperties=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height}},{"./field_animation":27,"./field_musiceditor":44,"./field_sprite":53,"./field_tilemap":57,"./field_tileset":58,blockly:176}],70:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./field_utils"),n),r(e("./fieldEditorRegistry"),n),r(e("./field_animation"),n),r(e("./field_argumentvariable"),n),r(e("./field_kind"),n),r(e("./field_asset"),n),r(e("./field_ledmatrix"),n),r(e("./field_styledlabel"),n),r(e("./field_base"),n),r(e("./field_tsexpression"),n),r(e("./field_textinput"),n),r(e("./field_tilemap"),n),r(e("./field_userenum"),n),r(e("./field_procedure"),n),r(e("./field_sprite"),n),r(e("./field_imagedropdown"),n),r(e("./field_protractor"),n),r(e("./field_toggle_highlow"),n),r(e("./field_images"),n),r(e("./field_sound_effect"),n),r(e("./field_toggle_onoff"),n),r(e("./field_speed"),n),r(e("./field_toggle_updown"),n),r(e("./field_toggle_winlose"),n),r(e("./field_autocomplete"),n),r(e("./field_melodySandbox"),n),r(e("./field_toggle_yesno"),n),r(e("./field_musiceditor"),n),r(e("./field_textdropdown"),n),r(e("./field_note"),n),r(e("./field_turnratio"),n),r(e("./field_colorwheel"),n),r(e("./field_numberdropdown"),n),r(e("./field_colour"),n),r(e("./field_position"),n),r(e("./field_tileset"),n),r(e("./field_gridpicker"),n),r(e("./field_toggle"),n)},{"./fieldEditorRegistry":26,"./field_animation":27,"./field_argumentvariable":28,"./field_asset":29,"./field_autocomplete":30,"./field_base":31,"./field_colorwheel":32,"./field_colour":33,"./field_gridpicker":36,"./field_imagedropdown":37,"./field_images":39,"./field_kind":40,"./field_ledmatrix":41,"./field_melodySandbox":43,"./field_musiceditor":44,"./field_note":45,"./field_numberdropdown":46,"./field_position":47,"./field_procedure":48,"./field_protractor":49,"./field_sound_effect":51,"./field_speed":52,"./field_sprite":53,"./field_styledlabel":54,"./field_textdropdown":55,"./field_textinput":56,"./field_tilemap":57,"./field_tileset":58,"./field_toggle":59,"./field_toggle_highlow":61,"./field_toggle_onoff":62,"./field_toggle_updown":63,"./field_toggle_winlose":64,"./field_toggle_yesno":65,"./field_tsexpression":66,"./field_turnratio":67,"./field_userenum":68,"./field_utils":69}],71:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getBlockText=void 0;const i=e("blockly");n.getBlockText=function e(t){const n=[];for(const r of t.inputList)if(r.isVisible()){if(r.fieldRow.length>0)for(const e of r.fieldRow){if(!e.isVisible())continue;const t=e.getFieldDescription?e.getFieldDescription():e.getText();t&&n.push(t)}if(r.connection&&r.connection.targetBlock()&&r.connection.type===i.INPUT_VALUE){const t=e(r.connection.targetBlock());t&&n.push(`[${t}]`)}}return n.join(" ")}},{blockly:176}],72:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.attachCardInfo=n.mkCard=n.installHelpResources=n.setHelpResources=n.installBuiltinHelpInfo=n.setBuiltinHelpInfo=void 0;const i=e("blockly"),r=e("./xml"),s=e("./external"),o=e("./toolbox"),a=e("./plugins/duplicateOnDrag");function l(e,t,n,i,o,l,c,u,d){!i||"string"!=typeof i&&"function"!=typeof i||e.setTooltip(i),o&&e.setHelpUrl(o),l&&e.setColour(l),d&&e.setDeletable(!1),(0,a.setDuplicateOnDragStrategy)(e);let p=document.getElementById("blocklyToolboxDefinition"),h=p?(0,r.getFirstChildWithAttr)(p,"block","type",t):void 0;e.codeCard={header:n,name:n,software:1,description:"function"==typeof i?i(e):i,blocksXml:h?'<xml xmlns="http://www.w3.org/1999/xhtml">'+((0,r.cleanOuterHTML)(h)||`<block type="${t}"></block>`)+"</xml>":void 0,url:o},pxt.Util.isTranslationMode()&&(e.customContextMenu=n=>{const i=pxt.blocks.getBlockDefinition(e.type);i&&i.translationIds&&n.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,s.promptTranslateBlock)(t,i.translationIds)}})})}function c(e,t,n,r,s,o,a){let c=i.Blocks[e],u=c.init;u&&(c.init=function(){u.call(this),l(this,e,t,n,r,s)})}function u(e,t){return{name:e.namespace+"."+e.name,shortName:e.name,description:e.attributes.jsDoc,url:e.attributes.help?"reference/"+e.attributes.help.replace(/^\//,""):void 0,blocksXml:`<xml xmlns="http://www.w3.org/1999/xhtml">${(0,r.cleanOuterHTML)(t)}</xml>`}}n.setBuiltinHelpInfo=function(e,t){const n=pxt.blocks.getBlockDefinition(t);l(e,t,n.name,n.tooltip,n.url,pxt.toolbox.getNamespaceColor(n.category))},n.installBuiltinHelpInfo=function(e){const t=pxt.blocks.getBlockDefinition(e);c(e,t.name,t.tooltip,t.url,pxt.toolbox.getNamespaceColor(t.category))},n.setHelpResources=l,n.installHelpResources=c,n.mkCard=u,n.attachCardInfo=function(e,t){const n=e.apis.byQName[t];if(n){const t=pxt.blocks.compileInfo(n);return u(n,(0,o.createToolboxBlock)(e,n,t))}}},{"./external":25,"./plugins/duplicateOnDrag":92,"./toolbox":140,"./xml":142,blockly:176}],73:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateAllReferencedBlocksExist=n.patchShadows=n.patchCommentIds=n.importXml=n.loadWorkspaceXml=n.loadBlocksXml=n.getFirstChildWithAttr=n.getChildrenWithAttr=n.getBlocksWithType=n.getDirectChildren=n.saveBlocksXml=n.workspaceToDom=n.saveWorkspaceXml=n.clearWithoutEvents=n.domToWorkspaceNoEvents=void 0;const i=e("blockly"),r=e("./loader"),s=e("./external"),o=e("./fields");function a(e,t,n){pxt.tickEvent("blocks.domtow");let r=[];f(e),_(e,!1),pxt.react.getTilemapProject&&(0,o.updateTilemapXml)(e,pxt.react.getTilemapProject());try{i.Events.disable(),r=i.Xml.domToWorkspace(e,t),o.FieldBase.flushInitQueue();for(const e of t.getAllBlocks())e.afterWorkspaceLoad&&e.afterWorkspaceLoad.call(e);!function(e,t){e.getAllBlocks(!1).filter(e=>!!e.getCommentText()).forEach(n=>{var i,r;const s=n.getCommentText();if(/@hide/.test(s)&&(null==t?void 0:t.applyHideMetaComment))return void n.dispose(!0);let o=s;/@highlight/.test(o)&&(o=o.replace(/@highlight/g,"").trim(),null===(r=(i=e).highlightBlock)||void 0===r||r.call(i,n.id,!0)),/@collapsed/.test(o)&&!n.getParent()&&(o=o.replace(/@collapsed/g,"").trim(),n.setCollapsed(!0)),o=o.replace(/@validate-\S+/g,"").trim(),s===o||(null==t?void 0:t.keepMetaComments)||n.setCommentText(o||null)})}(t,n)}catch(e){pxt.reportException(e)}finally{i.Events.enable()}return r.filter(e=>!!t.getBlockById(e))}function l(e,t){const n=i.Xml.workspaceToDom(e,t),r=i.Xml.variablesToDom(e.getVariableMap().getAllVariables()),s=u(n,"variables");for(const e of s)e.remove();return c(n.getElementsByTagName("block")),c(n.getElementsByTagName("shadow")),c(n.getElementsByTagName("comment")),n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),n}function c(e){for(let t=0;t<e.length;t++){const n=e.item(t);n.hasAttribute("editable")&&n.removeAttribute("editable"),n.hasAttribute("movable")&&n.removeAttribute("movable")}}function u(e,t){const n=[];for(let i=0;i<e.childNodes.length;i++){const r=e.childNodes.item(i);r.tagName===t&&n.push(r)}return n}function d(e,t){return p(e,"block","type",t).concat(p(e,"shadow","type",t))}function p(e,t,n,i){return pxt.Util.toArray(e.getElementsByTagName(t)).filter(e=>e.getAttribute(n)===i)}function h(e,t,n,i){const r=p(e,t,n,i);return r.length?r[0]:void 0}function f(e){const t=u(e,"comment");for(const e of t)e.hasAttribute("id")||e.setAttribute("id",i.utils.idGenerator.genUid());for(const t of e.querySelectorAll("comment:not([h])"))t.setAttribute("h","80"),t.setAttribute("w","160")}function m(e){if(2===e.parentElement.childElementCount)return void e.remove();const t=g(e);return e.parentElement.appendChild(t),e.remove(),t}function g(e){const t=i.utils.xml.createElement("block");for(const n of e.getAttributeNames())t.setAttribute(n,e.getAttribute(n));for(const n of e.childNodes)t.appendChild(n.cloneNode(!0));return t}function _(e,t){var n;if("shadow"===e.tagName)if("xml"===(null===(n=e.parentElement)||void 0===n?void 0:n.tagName)){pxt.warn(`Shadow block of type '${e.getAttribute("type")}' found at top level. Converting to non-shadow block`),pxt.tickEvent("blocks.import.topLevelShadow",{blockId:e.getAttribute("type")});const t=g(e);e.parentElement.insertBefore(t,e),e.remove();const n=u(e=t,"mutation")[0];(null==n?void 0:n.hasAttribute("dupliacteondrag"))&&n.removeAttribute("dupliacteondrag")}else{const t=e.getAttribute("type");let n=!1;switch(t){case"variables_get_reporter":case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":n=!0}if(n){if(!(e=m(e)))return;let t=u(e,"mutation")[0];t?t.setAttribute("duplicateondrag","true"):(t=i.utils.xml.createElement("mutation"),t.setAttribute("duplicateondrag","true"),e.appendChild(t))}else("variables_get"===t||y(e))&&(e=m(e))}if(e)for(const n of e.children)_(n,t||"shadow"===e.tagName)}function y(e){for(const t of e.children)if("block"===t.tagName.toLowerCase()||y(t))return!0;return!1}function b(e,t,n){var s;let o=n.getAttribute("type"),a=i.Blocks[o],l=(0,r.blockSymbol)(o);if(!l||!a)return;let c=pxt.blocks.compileInfo(l);null===(s=l.parameters)||void 0===s||s.forEach((i,r)=>{let s=e.apis.byQName[i.type];if(s&&6==s.kind){let e=h(n,"field","name",c.actualNameToParam[i.name].definitionName);if(e){let n=t[s.name+"."+e.textContent];n&&(e.textContent=n)}}})}n.domToWorkspaceNoEvents=a,n.clearWithoutEvents=function(e){if(pxt.tickEvent("blocks.clear"),e)try{i.Events.disable(),e.clear(),e.clearUndo()}finally{i.Events.enable()}},n.saveWorkspaceXml=function(e,t){const n=l(e,!t);return i.Xml.domToText(n)},n.workspaceToDom=l,n.saveBlocksXml=function(e,t){return e.getTopBlocks(!1).map(e=>i.Xml.domToText(i.Xml.blockToDom(e,!t)))},n.getDirectChildren=u,n.getBlocksWithType=d,n.getChildrenWithAttr=p,n.getFirstChildWithAttr=h,n.loadBlocksXml=function(e,t){let n=i.utils.xml.textToDom(t),r=i.Xml.domToBlock(n,e);if(e.getMetrics){let t=e.getMetrics(),n=r.getHeightWidth();r.moveBy(t.viewLeft+t.viewWidth/2-n.width/2,t.viewTop+t.viewHeight/2-n.height/2)}},n.loadWorkspaceXml=function(e,t=!1,n){const r=new i.Workspace;try{return a(i.utils.xml.textToDom(e),r,n),r}catch(e){return t||pxt.reportException(e),null}},n.importXml=function(e,t,n,i=!1){try{(0,r.initializeAndInject)(n);const i=(new DOMParser).parseFromString(t,"application/xml"),a=pxt.patching.computePatches(e);a&&(a.filter(e=>"blockId"==e.type).forEach(e=>Object.keys(e.map).forEach(t=>{d(i,t).forEach(n=>{n.setAttribute("type",e.map[t]),pxt.debug(`patched block ${t} -> ${e.map[t]}`)})})),a.filter(e=>"blockValue"==e.type).forEach(e=>Object.keys(e.map).forEach(t=>{const n=t.split("."),r=n[0];n[1];d(i,r).reduce((e,t)=>e.concat(u(t,"value")),[]).forEach(n=>{n.setAttribute("name",e.map[t]),pxt.debug(`patched block value ${t} -> ${e.map[t]}`)})})),a.filter(e=>"userenum"==e.type).forEach(e=>Object.keys(e.map).forEach(t=>{p(i,"variable","type",t).forEach(n=>{n.setAttribute("type",e.map[t]),pxt.debug(`patched enum variable type ${t} -> ${e.map[t]}`)})})));const l=u(i.children.item(0),"shadow");for(const e of l){const t=i.createElement("block");e.getAttributeNames().forEach(n=>t.setAttribute(n,e.getAttribute(n)));for(let n=0;n<e.childNodes.length;n++)t.appendChild(e.childNodes.item(n));e.replaceWith(t)}_(i.documentElement,!1),f(i.documentElement);const c={};Object.keys(n.apis.byQName).forEach(e=>{let t=n.apis.byQName[e];7==t.kind&&(c[t.namespace+"."+(t.attributes.blockImportId||t.attributes.block||t.attributes.blockId||t.name)]=t.namespace+"."+t.name)});const h=i.getElementsByTagName("block");for(let e=0;e<h.length;++e)b(n,c,h[e]);return function(e,t){const n=d(e,ts.pxtc.ON_START_TYPE);let i=n.length?n[0]:void 0;if(i)return void i.removeAttribute("deletable");let s=[];const o=t.blocksById;let a,l=e.firstElementChild;for(;l;){const t=l.nextElementSibling,n=l.getAttribute("type");if(!l.getAttribute("disabled")&&!l.getElementsByTagName("statement").length&&(r.buildinBlockStatements[n]||o[n]&&"void"==o[n].retType&&!(0,r.hasArrowFunction)(o[n])))if(a){const t=e.ownerDocument.createElement("next");t.appendChild(l),a.appendChild(t),l.removeAttribute("x"),l.removeAttribute("y"),a=l}else a=e.ownerDocument.createElement("statement"),a.setAttribute("name","HANDLER"),i||(i=e.ownerDocument.createElement("block"),i.setAttribute("type",ts.pxtc.ON_START_TYPE),s.push(i)),i.appendChild(a),a.appendChild(l),l.removeAttribute("x"),l.removeAttribute("y"),a=l;l=t}s.forEach(t=>e.appendChild(t))}(i.documentElement,n),o=i.documentElement,pxt.U.toArray(o.querySelectorAll("block[type=procedures_defnoreturn]")).forEach(e=>{e.setAttribute("type","function_definition"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")}),pxt.U.toArray(o.querySelectorAll("block[type=procedures_callnoreturn]")).forEach(e=>{e.setAttribute("type","function_call"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")}),(0,s.extensionBlocklyPatch)(e,i.documentElement),(new XMLSerializer).serializeToString(i)}catch(e){return i||pxt.reportException(e),t}var o},n.patchCommentIds=f,n.patchShadows=_,n.validateAllReferencedBlocksExist=function(e){pxt.U.assert(!!(null==i?void 0:i.Blocks),"Called validateAllReferencedBlocksExist before initializing Blockly");const t=i.utils.xml.textToDom(e),n=t.querySelectorAll("block");for(let e=0;e<n.length;e++)if(!i.Blocks[n.item(e).getAttribute("type")])return!1;const r=t.querySelectorAll("shadow");for(let e=0;e<r.length;e++)if(!i.Blocks[r.item(e).getAttribute("type")])return!1;return!0}},{"./external":25,"./fields":70,"./loader":77,blockly:176}],74:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.external=n.contextMenu=void 0,r(e("./plugins/arrays"),n),r(e("./plugins/functions"),n),r(e("./plugins/logic"),n),r(e("./plugins/math"),n),r(e("./plugins/text"),n),r(e("./plugins/renderer"),n),r(e("./plugins/flyout"),n),r(e("./plugins/newVariableField"),n),r(e("./plugins/comments"),n),r(e("./compiler/compiler"),n),r(e("./compiler/environment"),n),r(e("./loader"),n),r(e("./layout"),n),r(e("./render"),n),r(e("./toolbox"),n),r(e("./fields"),n),r(e("./sourceMap"),n),r(e("./importer"),n),r(e("./diff"),n),r(e("./legacyMutations"),n),r(e("./blockDragger"),n),r(e("./workspaceSearch"),n),r(e("./monkeyPatches"),n),r(e("./getBlockText"),n);const s=e("./contextMenu");n.contextMenu=s;const o=e("./external");n.external=o,r(e("./breakpointIcon"),n)},{"./blockDragger":1,"./breakpointIcon":2,"./compiler/compiler":12,"./compiler/environment":13,"./contextMenu":21,"./diff":24,"./external":25,"./fields":70,"./getBlockText":71,"./importer":73,"./layout":75,"./legacyMutations":76,"./loader":77,"./monkeyPatches":81,"./plugins/arrays":84,"./plugins/comments":87,"./plugins/flyout":98,"./plugins/functions":112,"./plugins/logic":118,"./plugins/math":120,"./plugins/newVariableField":124,"./plugins/renderer":130,"./plugins/text":135,"./render":138,"./sourceMap":139,"./toolbox":140,"./workspaceSearch":141}],75:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.documentToSvg=n.blocklyToSvgAsync=n.cleanUpBlocklySvg=n.serializeSvgString=n.serializeNode=n.toSvgAsync=n.toPngAsync=n.screenshotAsync=n.screenshotEnabled=n.flow=n.setCollapsedAll=n.verticalAlign=n.splitSvg=n.patchBlocksFromOldWorkspace=void 0;const i=e("blockly"),r=e("./compiler/environment"),s=e("./fields"),o=e("./compiler/compiler"),a=e("./importer");function l(e){return(e=e.replace(/\n/g,"")).trim()}n.patchBlocksFromOldWorkspace=function(e,t,n){const s=(0,a.loadWorkspaceXml)(n,!0);!function(e,t,n){let i,s;const a=t.getTopBlocks(!1).filter(e=>e.isEnabled()),c=n.getTopBlocks(!1);let u;const d=t.getTopComments(!1),p=n.getTopComments(!1);for(const n of a){const a=n.getRelativeToSurfaceXY();if(!a||0==a.x||0==a.y)continue;if(!i){i=(0,r.mkEnv)(t,e),s={};for(const e of c){const t=(0,o.callKey)(i,e),n=s[t]||[];n.push(e),s[t]=n}}const l=(s[(0,o.callKey)(i,n)]||[]).shift();if(l){const e=l.getRelativeToSurfaceXY();e.x=a.x,e.y=a.y}}for(const e of d){const t=e.getRelativeToSurfaceXY();if(!t||0==t.x||0==t.y)continue;if(!u){u={};for(const e of p){const t=l(e.getText()),n=u[t]||[];n.push(e),u[t]=n}}const n=(u[l(e.getText())]||[]).shift();if(n){const i=e.getSize();n.setText(e.getText()),n.setSize(i);const r=n.getRelativeToSurfaceXY();r.x=t.x,r.y=t.y}}}(e,t,s);const c=(0,a.workspaceToDom)(t,!0),u=(0,a.workspaceToDom)(s,!0);for(const e of c.childNodes)pxt.BrowserUtils.isElement(e)&&"block"===e.localName&&"true"===e.getAttribute("disabled")&&u.appendChild(u.ownerDocument.importNode(e,!0));return i.Xml.domToText(u)},n.splitSvg=function(e,t,n=18){const i=t.getTopComments(!0),r=t.getTopBlocks(!0);if(i.length+r.length<2)return e;const s=document.createElement("div");function o(t,i,r,o,a,l,c){const u=e.cloneNode(!0),d=u.querySelector(`g.blocklyWorkspace > g.${t}`),p=u.querySelector(`g.blocklyWorkspace > g.${i}`),h=pxt.Util.toArray(d.querySelectorAll(`g.blocklyWorkspace > g.${t} > ${c?"."+c:"g[transform]"}`)),f=h.splice(r,1)[0];if(!f)return void pxt.log("missing block, did block failed to load?");h.filter(e=>e!=f).forEach(e=>{e.parentNode.removeChild(e)}),d.removeAttribute("transform"),p.parentNode.removeChild(p),f.setAttribute("transform",`translate(${a.x}, ${a.y})`);const m=o.width/n+"em",g=o.height/n+"em";u.setAttribute("viewBox",`0 0 ${o.width} ${o.height}`),u.style.width=m,u.style.height=g,u.setAttribute("width",m),u.setAttribute("height",g),u.setAttribute("aria-label",l),s.appendChild(u)}return s.className=`blocks-svg-list ${t.getInjectionDiv().className}`,i.forEach((e,t)=>o("blocklyBubbleCanvas","blocklyBlockCanvas",t,e.getSize(),{x:0,y:0},lf("blockly comment"),"blocklyComment")),r.forEach((e,t)=>{const i=e.getHeightWidth(),r={x:0,y:0};e.hat&&(i.height+=n,r.y+=n);o("blocklyBlockCanvas","blocklyBubbleCanvas",t,i,r,`${e.toString()} blocks`)}),s},n.verticalAlign=function(e,t){let n=0;e.getTopComments(!0).forEach(e=>{e.moveBy(0,n),n+=e.getSize().height,n+=t}),e.getTopBlocks(!0).forEach((e,i)=>{e.hat&&(n+=t),e.moveBy(0,n),n+=e.getHeightWidth().height,n+=t})},n.setCollapsedAll=function(e,t){e.getTopBlocks(!1).filter(e=>e.isEnabled()).forEach(e=>e.setCollapsed(t))};const c=20;function u(e,t,n){let i;n&&(i={target:pxt.appTarget.id,versions:pxt.appTarget.versions,xml:(0,a.saveBlocksXml)(e).map(e=>pxt.Util.htmlEscape(e))});const r=0|t||4;return h(e,r).then(e=>e?pxt.BrowserUtils.encodeToPngAsync(e.xml,{width:e.width,height:e.height,pixelDensity:r,text:n?JSON.stringify(i,null,2):null}):Promise.resolve(void 0)).catch(e=>{pxt.reportException(e)})}n.flow=function(e,t){if(t){if(t.useViewWidth){const t=e.getMetrics();if(t.viewHeight>t.viewWidth)return T(e.getTopComments(!0),e.getTopBlocks(!0),void 0,t.viewWidth),void e.scroll(c,20)}T(e.getTopComments(!0),e.getTopBlocks(!0),t.ratio)}else T(e.getTopComments(!0),e.getTopBlocks(!0));e.scroll(c,20)},n.screenshotEnabled=function(){return pxt.BrowserUtils.hasFileAccess()&&!pxt.BrowserUtils.isIE()},n.screenshotAsync=function(e,t,n){return u(e,t,n)},n.toPngAsync=u;const d="http://www.w3.org/1999/xlink",p=12e7;function h(e,t){if(!e)return Promise.resolve(void 0);const n=e.getBlocksBoundingBox(),r=e.getParentSvg().cloneNode(!0);g(r);for(const t of e.getAllBlocks())if(t.hasIcon(i.icons.IconType.COMMENT)){const e=t.getIcon(i.icons.IconType.COMMENT),r=e.getBubbleLocation();if(!r)continue;const s=e.getBubbleSize();n.left=Math.min(r.x,n.left),n.top=Math.min(r.y,n.top),n.right=Math.max(r.x+s.width,n.right),n.bottom=Math.max(r.y+s.height,n.bottom)}n.left-=1,n.top-=1,n.right+=1,n.bottom+=1;let s=n.right-n.left,o=n.bottom-n.top,a=1;const l=s*o*Math.pow(t,2);return l>p&&(a=Math.sqrt(p/l)),_(r,n.left,n.top,s,o,a)}function f(e){return m((new XMLSerializer).serializeToString(e))}function m(e){return e.replace(new RegExp("&nbsp;","g"),"&#160;")}function g(e){pxt.BrowserUtils.removeClass(e,"blocklySvg"),pxt.BrowserUtils.addClass(e,"blocklyPreview pxt-renderer classic-theme"),pxt.U.toArray(e.querySelectorAll(".blocklyMainBackground,.blocklyScrollbarBackground")).forEach(e=>{e&&e.parentNode.removeChild(e)}),pxt.U.toArray(e.querySelectorAll(".blocklyConnectionIndicator,.blocklyInputConnectionIndicator")).forEach(e=>{e&&e.parentNode.removeChild(e)}),e.removeAttribute("width"),e.removeAttribute("height"),pxt.U.toArray(e.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach(e=>e.removeAttribute("transform")),e.querySelectorAll("[tabindex]").forEach(e=>{e.removeAttribute("tabindex")});const t=new DOMParser;return pxt.U.toArray(e.querySelectorAll(".blocklyTextarea")).forEach(e=>{const n=t.parseFromString("<!doctype html><body>"+pxt.docs.html2Quote(e.value),"text/html");e.textContent=n.body.textContent}),e}async function _(e,t,n,i,r,s){var o,a;if(!e.childNodes[0])return;e.removeAttribute("width"),e.removeAttribute("height"),e.removeAttribute("transform");let l=Math.round(i*(s||1)),c=Math.round(r*(s||1));const u=f(e).replace(/^\s*<svg[^>]+>/i,"").replace(/<\/svg>\s*$/i,""),p=`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="${d}" width="${l}" height="${c}" viewBox="${t} ${n} ${i} ${r}" class="pxt-renderer classic-theme injectionDiv">${u}</svg>`,h=(new DOMParser).parseFromString(p,"image/svg+xml"),m=h.createElementNS("http://www.w3.org/1999/xhtml","style"),g=pxt.Util.isUserLanguageRtl(),_=document.getElementById(`style-${g?"rtl":""}blockly.css`).href,T=pxt.Util.toArray(document.head.getElementsByTagName("link")).filter(e=>pxt.Util.endsWith(e.getAttribute("href"),"semantic.css"))[0].href,k=await Promise.all([pxt.BrowserUtils.loadAjaxAsync(_),pxt.BrowserUtils.loadAjaxAsync(T)]),x=pxt.Util.toArray(document.head.querySelectorAll("style")).filter(e=>/\.blocklySvg/.test(e.innerText))[0];k.unshift((null===(o=document.getElementById("blockly-common-style"))||void 0===o?void 0:o.innerText)||""),k.unshift((null===(a=document.getElementById("blockly-renderer-style-pxt-classic"))||void 0===a?void 0:a.innerText)||"");const E=(x?x.innerText:"")+"\n\n"+k.map(e=>e+"\n\n");return m.appendChild(h.createCDATASection(E)),h.documentElement.insertBefore(m,h.documentElement.firstElementChild),await async function(e){b||(b={});const t=pxt.Util.toArray(e.getElementsByTagName("image")),n=t.filter(e=>{const t=e.getAttributeNS(d,"href");return t&&!/^data:/.test(t)});for(const e of n){const t=e.getAttributeNS(d,"href");let n=b[t];if(!n)try{const i=await pxt.BrowserUtils.loadImageAsync(e.getAttributeNS(d,"href")),r=document.createElement("canvas"),s=r.getContext("2d");let o=i.width,a=i.height;r.width=o,r.height=a,s.drawImage(i,0,0,o,a,0,0,r.width,r.height),n=r.toDataURL("image/png"),b[t]=n}catch(e){pxt.debug(`svg render: failed to load ${t}`),n=""}e.setAttributeNS(d,"href",t)}const i=t.filter(e=>{const t=e.getAttribute("href");return(null==t?void 0:t.endsWith(".svg"))&&(t.startsWith("/")||t.startsWith(pxt.webConfig.cdnUrl))});for(const e of i){const t=e.getAttribute("href");let n=24,i=24;e.hasAttribute("width")&&e.hasAttribute("height")?(n=parseInt(e.getAttribute("width").replace(/[^0-9]/g,"")),i=parseInt(e.getAttribute("height").replace(/[^0-9]/g,""))):e.classList.contains("blocklyResizeHandle")&&(n=12,i=12);let r=b[t];r||(r=await pxt.BrowserUtils.encodeToPngAsync(t,{width:n,height:i,pixelDensity:2})),b[t]=r,e.setAttribute("href",r)}}(h),await async function(e){v||(v={});if(!pxt.BrowserUtils.isEdge())return;const t=pxt.Util.toArray(e.getElementsByTagName("image")).filter(e=>/^data:image\/svg\+xml/.test(e.getAttributeNS(d,"href")));for(const e of t){const t=e.getAttributeNS(d,"href"),n=parseInt(e.getAttribute("width").replace(/[^0-9]/g,"")),i=parseInt(e.getAttribute("height").replace(/[^0-9]/g,""));let r=v[t];r||(r=await pxt.BrowserUtils.encodeToPngAsync(t,{width:n,height:i,pixelDensity:2}),pxt.log(`HREF: ${r}`)),v[t]=r,e.setAttributeNS(d,"href",r)}}(h),{width:l,height:c,svg:f(h).replace('<style xmlns="http://www.w3.org/1999/xhtml">',"<style>"),xml:y(h),css:E}}function y(e){const t=(new XMLSerializer).serializeToString(e);return"data:image/svg+xml;base64,"+ts.pxtc.encodeBase64(unescape(encodeURIComponent(t)))}let b,v;function T(e,t,n=1.62,i){const r=[],o={};let a;e.forEach(e=>{const t=e.data;null!=t&&(o[t]=e)}),t.sort((e,t)=>e.isEnabled()===t.isEnabled()?e.type===t.type?0:"function_definition"===e.type?1:"function_definition"===t.type?-1:e.type.localeCompare(t.type):e.isEnabled()?-1:1),t.forEach(e=>{const t=(0,s.getBlockData)(e).commentRefs;if(t.length){const n=[];for(let e=0;e<t.length;e++){const i=o[t[e]];i&&(n.push(k(i)),delete o[t[e]])}if(n.length)return void r.push({value:e,width:-1,height:-1,children:n})}const n=k(e);!a&&e.isEnabled()&&e.type===pxtc.ON_START_TYPE?a=n:r.push(n)}),a&&r.unshift(a),Object.keys(o).sort((e,t)=>e.length===t.length?e>t?-1:1:e.length>t.length?-1:1).forEach(e=>{o[e]&&r.push(k(o[e]))}),e.forEach(e=>{null==e.data&&r.push(k(e))});let l,u=0;for(let e=0;e<r.length;e++){const t=r[e];if(t.children){const e=t.value.getHeightWidth();t.x=0,t.y=0;let n=e.width+13,i=0;for(let e=0;e<t.children.length;e++){const r=t.children[e];r.x=n,r.y=i,i+=r.height+13,t.width=Math.max(t.width,n+r.width)}t.height=Math.max(i-13,e.height)}u+=(t.height+13)*(t.width+13)}l=i>c?i-c:Math.sqrt(u)*n;let d=c,p=20,h=0;for(let e=0;e<r.length;e++){const t=r[e];if(t.children){f(t,d+t.x,p+t.y);for(let e=0;e<t.children.length;e++){const n=t.children[e];f(n,d+n.x,p+n.y)}}else f(t,d,p);d+=t.width+45,h=Math.max(h,p+t.height+45),d>l&&(d=c,p=h)}function f(e,t,n){const i=e.value.getBoundingRectangle();e.value.moveBy(t-i.left,n-i.top)}}function k(e){const t=e instanceof i.BlockSvg?e.getHeightWidth():e.getSize();return{value:e,height:t.height,width:t.width}}n.toSvgAsync=h,n.serializeNode=f,n.serializeSvgString=m,n.cleanUpBlocklySvg=g,n.blocklyToSvgAsync=_,n.documentToSvg=y},{"./compiler/compiler":12,"./compiler/environment":13,"./fields":70,"./importer":73,blockly:176}],76:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mutateToolboxBlock=n.addMutation=n.MutatorTypes=void 0;const i=e("blockly"),r=e("./compiler/util"),s=e("./compiler/compiler"),o=e("./loader"),a=e("./plugins/newVariableField/fieldVariable");var l;!function(e){e.ObjectDestructuringMutator="objectdestructuring",e.RestParameterMutator="restparameter",e.DefaultInstanceMutator="defaultinstance"}(l=n.MutatorTypes||(n.MutatorTypes={})),n.addMutation=function(e,t,n){let i;switch(n){case l.ObjectDestructuringMutator:if(!t.parameters||t.parameters.length<1)pxt.error("Destructuring mutations require at least one parameter");else{let e=!1;for(const n of t.parameters)if(-1!==n.type.indexOf("=>")){if(!n.properties||0===n.properties.length)return void pxt.error("Destructuring mutations only supported for functions with an event parameter that has multiple properties");e=!0}if(!e)return void pxt.error("Destructuring mutations must have an event parameter")}i=new u(e,t);break;case l.RestParameterMutator:i=new d(e,t);break;case l.DefaultInstanceMutator:i=new p(e,t);break;default:return void pxt.warn("Ignoring unknown mutation type: "+n)}e.mutationToDom=i.mutationToDom.bind(i),e.domToMutation=i.domToMutation.bind(i),e.compose=i.compose.bind(i),e.decompose=i.decompose.bind(i),e.mutation=i},n.mutateToolboxBlock=function(e,t,n){const i=document.createElement("mutation");switch(t){case l.ObjectDestructuringMutator:i.setAttribute(u.propertiesAttributeName,n);break;case l.RestParameterMutator:i.setAttribute(d.countAttributeName,n);break;case l.DefaultInstanceMutator:i.setAttribute(p.attributeName,n);default:return void pxt.warn("Ignoring unknown mutation type: "+t)}e.appendChild(i)};class c{constructor(e,t){this.info=t,this.block=e,this.topBlockType=this.block.type+"_mutator";const n=this.getSubBlockNames();this.initializeMutatorTopBlock(),this.initializeMutatorSubBlocks(n);const r=n.map(e=>e.type);this.block.setMutator(new i.icons.MutatorIcon(r,e))}compose(e){const t=e.getDescendants(!1).map(e=>({type:e.type,name:e.inputList[0].name}));t.shift(),this.updateBlock(t)}decompose(e){const t=e.newBlock(this.topBlockType);t.initSvg();for(const n of t.inputList)if(n.name===c.mutatorStatmentInput){let t=n.connection;this.getVisibleBlockTypes().forEach(n=>{const i=e.newBlock(n);i.initSvg(),t.connect(i.previousConnection),t=i.nextConnection});break}return t}compileMutation(e,t){}getDeclaredVariables(){}isDeclaredByMutation(e){return!1}initializeMutatorSubBlock(e,t,n){e.appendDummyInput(t).appendField(t),e.setColour(n),e.setNextStatement(!0),e.setPreviousStatement(!0)}initializeMutatorTopBlock(){const e=this.info.attributes.mutateText,t=this.block.getColour();i.Blocks[this.topBlockType]=i.Blocks[this.topBlockType]||{init:function(){const n=this;n.appendDummyInput().appendField(e),n.setColour(t),n.appendStatementInput(c.mutatorStatmentInput)}}}initializeMutatorSubBlocks(e){const t=this.block.getColour(),n=this.initializeMutatorSubBlock.bind(this);e.forEach(e=>{i.Blocks[e.type]=i.Blocks[e.type]||{init:function(){n(this,e.name,t)}}})}}c.mutatorStatmentInput="PROPERTIES",c.mutatedVariableInputName="properties";class u extends c{constructor(e,t){super(e,t),this.currentlyVisible=[],this.parameterRenames={},this.prefix=this.info.attributes.mutatePrefix,this.block.appendDummyInput(c.mutatedVariableInputName),this.block.appendStatementInput("HANDLER").setCheck("null")}getMutationType(){return l.ObjectDestructuringMutator}compileMutation(e,t){if(!this.info.attributes.mutatePropertyEnum&&!this.parameters.length)return;const n=`function ({ ${this.parameters.map(t=>{const n=this.block.getField(t),i=n&&n.getText(),s=(0,r.escapeVarName)(t,e);return i!==t?(this.parameterRenames[t]=i,`${t}: ${(0,r.escapeVarName)(i,e)}`):s}).join(", ")} })`;return this.info.attributes.mutatePropertyEnum?pxt.blocks.mkText(` [${this.parameters.map(e=>`${this.info.attributes.mutatePropertyEnum}.${e}`).join(", ")}],${n}`):pxt.blocks.mkText(n)}getDeclaredVariables(){const e={};return this.parameters.forEach(t=>{e[this.getVarFieldValue(t)]=this.parameterTypes[t]}),e}isDeclaredByMutation(e){return this.parameters.some(t=>this.getVarFieldValue(t)===e)}mutationToDom(){const e=document.createElement("mutation"),t=this.parameters.map(e=>{const t=this.getVarFieldValue(e);return t!==e&&(this.parameterRenames[e]=pxt.Util.htmlEscape(t)),pxt.Util.htmlEscape(e)}).join(",");e.setAttribute(u.propertiesAttributeName,t);for(const e in this.parameterRenames)e===this.parameterRenames[e]&&delete this.parameterRenames[e];return e.setAttribute(u.renameAttributeName,JSON.stringify(this.parameterRenames)),e}domToMutation(e){const t=e.getAttribute(u.propertiesAttributeName);if(t){const n=t.split(","),i=[];if(void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),n.forEach(e=>{const t=e.split(":");this.info.parameters[this.paramIndex].properties.some(e=>e.name===t[0])&&i.push({property:t[0],newName:t[1]})}),this.parameterRenames=void 0,e.hasAttribute(u.renameAttributeName))try{this.parameterRenames=JSON.parse(e.getAttribute(u.renameAttributeName))}catch(e){pxt.warn("Ignoring invalid rename map in saved block mutation")}this.parameterRenames=this.parameterRenames||{},this.parameters=[],i.forEach(e=>{this.parameters.push(e.property),e.newName&&e.newName!==e.property&&(this.parameterRenames[e.property]=e.newName)}),this.updateVisibleProperties(),i.filter(e=>!!e.newName).forEach(e=>this.setVarFieldValue(e.property,e.newName))}}getVarFieldValue(e){const t=this.block.getField(e);return t&&t.getText()}setVarFieldValue(e,t){this.block.getField(e);this.block.getField(e)&&(0,o.setVarFieldValue)(this.block,e,t)}updateBlock(e){this.parameters=[],e.forEach(e=>{-1===this.parameters.indexOf(e.name)&&this.parameters.push(e.name)}),this.updateVisibleProperties()}getSubBlockNames(){return this.parameters=[],this.parameterTypes={},void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),this.info.parameters[this.paramIndex].properties.map(e=>(this.parameterTypes[e.name]=e.type,{type:this.propertyId(e.name),name:e.name}))}getVisibleBlockTypes(){return this.currentlyVisible.map(e=>this.propertyId(e))}updateVisibleProperties(){if(pxt.Util.listsEqual(this.currentlyVisible,this.parameters))return;const e=this.block.inputList.find(e=>e.name===c.mutatedVariableInputName);this.prefix&&0===this.currentlyVisible.length&&e.appendField(this.prefix,u.prefixLabel),this.currentlyVisible.forEach(t=>{if(-1===this.parameters.indexOf(t)){const n=this.getVarFieldValue(t);n!==t&&(this.parameterRenames[t]=n),e.removeField(t)}}),this.parameters.forEach(t=>{if(-1===this.currentlyVisible.indexOf(t)){const n=this.parameterRenames[t]||t;e.appendField(new a.FieldVariable(n),t)}}),this.prefix&&0===this.parameters.length&&e.removeField(u.prefixLabel),this.currentlyVisible=this.parameters}propertyId(e){return this.block.type+"_"+e}getParameterIndex(){for(let e=0;e<this.info.parameters.length;e++)if(-1!==this.info.parameters[e].type.indexOf("=>"))return e}}u.propertiesAttributeName="callbackproperties",u.renameAttributeName="renamemap",u.prefixLabel="0prefix_label_";class d extends c{constructor(){super(...arguments),this.count=0}getMutationType(){return l.RestParameterMutator}compileMutation(e,t){const n=[];return this.forEachInput(i=>n.push((0,s.compileExpression)(e,i,t))),pxt.blocks.mkGroup(n)}mutationToDom(){const e=document.createElement("mutation");return e.setAttribute(d.countAttributeName,this.count.toString()),e}domToMutation(e){const t=e.getAttribute(d.countAttributeName);if(t){try{this.count=parseInt(t)}catch(e){return}for(let e=0;e<this.count;e++)this.addNumberField(!1,e)}}updateBlock(e){if(e){const t=Math.abs(this.count-e.length);if(this.count<e.length)for(let e=0;e<t;e++)this.addNumberField(!0,this.count);else if(this.count>e.length)for(let e=0;e<t;e++)this.removeNumberField()}}getSubBlockNames(){return[{name:"Value",type:d.entryTypeName}]}getVisibleBlockTypes(){const e=[];return this.forEachInput(()=>e.push(d.entryTypeName)),e}addNumberField(e,t){const n=this.block.appendValueInput(d.valueInputPrefix+t).setCheck("Number");if(e){const e=this.block.workspace.newBlock("math_number");e.initSvg(),e.setShadow(!0),n.connection.connect(e.outputConnection),this.block.workspace.render(),this.count++}}removeNumberField(){this.count>0&&this.block.removeInput(d.valueInputPrefix+(this.count-1)),this.count--}forEachInput(e){for(let t=0;t<this.count;t++)e(this.block.getInputTargetBlock(d.valueInputPrefix+t),t)}}d.countAttributeName="count",d.entryTypeName="entry",d.valueInputPrefix="value_input_";class p extends c{constructor(){super(...arguments),this.showing=!1}getMutationType(){return l.DefaultInstanceMutator}compileMutation(e,t){if(this.showing){const n=this.block.getInputTargetBlock(p.instanceInputName);if(n)return(0,s.compileExpression)(e,n,t)}}mutationToDom(){const e=document.createElement("mutation");return e.setAttribute(p.attributeName,this.showing?"true":"false"),e}domToMutation(e){const t=e.getAttribute(p.attributeName);t?this.updateShape("true"===t):this.updateShape(!1)}updateBlock(e){this.updateShape(!(!e||!e.length))}getSubBlockNames(){return[{name:"Instance",type:p.instanceSubBlockType}]}getVisibleBlockTypes(){const e=[];return this.showing&&e.push(p.instanceSubBlockType),e}updateShape(e){this.showing!==e&&(e&&!this.block.getInputTargetBlock(p.instanceInputName)?this.block.appendValueInput(p.instanceInputName):this.block.removeInput(p.instanceInputName),this.showing=e)}}p.attributeName="showing",p.instanceInputName="__instance__",p.instanceSubBlockType="instance"},{"./compiler/compiler":12,"./compiler/util":15,"./loader":77,"./plugins/newVariableField/fieldVariable":123,blockly:176}],77:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setVarFieldValue=n.generateIcons=n.getFixedInstanceDropdownValues=n.setOutputCheck=n.getBlocklyCheckForType=n.initAccessibleBlocksContextMenuItems=n.initialize=n.initializeAndInject=n.cleanBlocks=n.hasArrowFunction=n.injectBlocks=n.blockSymbol=n.cachedBlockInfo=n.buildinBlockStatements=n.builtinBlocks=n.isTupleType=n.DRAGGABLE_PARAM_INPUT_PREFIX=n.initCopyPaste=void 0;const i=e("blockly"),r=e("./constants"),s=e("./composableMutations"),o=e("./legacyMutations"),a=e("./builtins/math"),l=e("./fields"),c=e("./builtins/functions"),u=e("./builtins/lists"),d=e("./builtins/logic"),p=e("./builtins/loops"),h=e("./builtins/text"),f=e("./toolbox"),m=e("./help"),g=e("./fields"),_=e("./fields"),y=e("./fields"),b=e("./fields"),v=e("./external"),T=e("./builtins/variables"),k=e("./builtins/misc"),x=e("./contextMenu"),E=e("./codecardRenderer"),S=e("./fields/field_dropdown"),C=e("./plugins/duplicateOnDrag"),w=e("./copyPaste");var I=e("./copyPaste");Object.defineProperty(n,"initCopyPaste",{enumerable:!0,get:function(){return I.initCopyPaste}});const A=e("./plugins/newVariableField/fieldVariable"),N=e("./plugins/functions"),D=e("./plugins/functions/utils"),O=e("./compiler/util"),R=e("./compiler/compiler");let L;function P(){return L||(L={},Object.keys(i.Blocks).forEach(e=>L[e]={block:i.Blocks[e]})),L}n.DRAGGABLE_PARAM_INPUT_PREFIX="HANDLER_DRAG_PARAM_",n.isTupleType=function(e){let t=/^\[(.+)\]$/.exec(e);return t?t[1].split(/,\s*/):void 0},n.builtinBlocks=P,n.buildinBlockStatements={controls_if:!0,controls_for:!0,pxt_controls_for:!0,controls_simple_for:!0,controls_repeat_ext:!0,pxt_controls_for_of:!0,controls_for_of:!0,variables_set:!0,variables_change:!0,device_while:!0};let M={};function F(e){return n.cachedBlockInfo=e,(0,C.setDraggableShadowBlocks)(e.blocks.filter(e=>e.attributes.duplicateShadowOnDrag).map(e=>e.attributes.blockId)),(0,N.setArgumentReporterLocalizeFunction)((t,n)=>function(e,t,n){var i;let r;const s=n.getLocalizationName();if(s){const e=pxt.U.rlf(s);r=e!==s?e:pxtc.getBlockTranslationsCacheKey(s)}const o=(0,D.getArgumentReporterParent)(n,n);if(!o||(0,O.isFunctionDefinition)(o))return r;const a=e.blocksById[o.type];if(!a)return r;const l=pxt.blocks.compileInfo(a),c=null===(i=l.handlerArgs)||void 0===i?void 0:i.find(e=>e.name===t.getValue());if(c)return pxtc.getBlockTranslationsCacheKey(c.localizationKey);return r}(e,t,n)),e.blocks.map(t=>{const a=pxt.blocks.compileInfo(t),c=(0,f.createToolboxBlock)(e,t,a,!1,2);if(t.attributes.blockBuiltin){pxt.Util.assert(!!P()[t.attributes.blockId]);const e=P()[t.attributes.blockId];e.symbol=t,e.block.codeCard=(0,m.mkCard)(t,c)}else!function(e,t,a,c){let u=t.attributes.blockId;if(P()[u])return pxt.reportError("blocks","trying to override builtin block",{details:u}),!1;let d=JSON.stringify(t);if(M[u]&&M[u].hash==d)return!0;if(i.Blocks[t.attributes.blockId])return pxt.error("duplicate block definition: "+u),!1;let p={hash:d,fn:t,block:{codeCard:(0,m.mkCard)(t,c),init:function(){!function(e,t,a,c){var u,d;const p=(a.attributes.blockNamespace||a.namespace).split(".")[0];let h=1==a.kind||2==a.kind;"boolean"!=typeof a.isInstance||(null===(u=a.attributes)||void 0===u?void 0:u.defaultInstance)||(h=a.isInstance);const f=t.apis.byQName[p],m=a.attributes.blockNamespace&&f&&f.attributes.color||a.attributes.color||f&&f.attributes.color||pxt.toolbox.getNamespaceColor(p)||255,v=pxt.blocks.getHelpUrl(a);v&&e.setHelpUrl(v);(0,C.setDuplicateOnDragStrategy)(e),e.setColour("string"==typeof m?pxt.toolbox.getAccessibleBackground(m):m);let T=r.provider.SHAPES.ROUND;"boolean"==a.retType&&(T=r.provider.SHAPES.HEXAGONAL);e.setOutputShape(T),a.attributes.undeletable&&e.setDeletable(!1);D(a.attributes._def);let k=!1,x=!1;if(a.attributes.mutate)(0,o.addMutation)(e,a,a.attributes.mutate);else if(a.attributes.defaultInstance)(0,o.addMutation)(e,a,o.MutatorTypes.DefaultInstanceMutator);else if(a.attributes._expandedDef&&"disabled"!==a.attributes.expandableArgumentMode){const n="toggle"===a.attributes.expandableArgumentMode;(0,s.initExpandableBlock)(t,e,a.attributes._expandedDef,c,n,()=>D(a.attributes._expandedDef,!0))}else if(c.handlerArgs.length)if(k=!0,a.attributes.optionalVariableArgs)"reporter"===a.attributes.draggableParameters?x=!0:(0,s.initVariableArgsBlock)(e,c.handlerArgs);else if(a.attributes.draggableParameters)c.handlerArgs.filter(e=>!e.inBlockDef).forEach(i=>{const r=e.appendValueInput(n.DRAGGABLE_PARAM_INPUT_PREFIX+i.name);"reporter"==a.attributes.draggableParameters?r.setCheck(V(i.type,t)):r.setCheck("Variable")}),c.handlerArgs.forEach(t=>{(0,C.setDuplicateOnDrag)(e.type,n.DRAGGABLE_PARAM_INPUT_PREFIX+t.name)});else{let t=e.appendDummyInput();c.handlerArgs.filter(e=>!e.inBlockDef).forEach(e=>{t.appendField(new A.FieldVariable(e.name),"HANDLER_"+e.name)})}(0,s.appendMutation)(e,{mutationToDom:t=>(e.inputList.forEach(e=>{e.fieldRow.forEach(e=>{if(e.isFieldCustom_&&e.saveOptions){const n=e.saveOptions();n&&t.setAttribute("customfield",JSON.stringify(n))}})}),t),domToMutation:t=>{e.inputList.forEach(e=>{e.fieldRow.forEach(e=>{if(e.isFieldCustom_&&e.restoreOptions){const n=JSON.parse(t.getAttribute("customfield"));n&&e.restoreOptions(n)}})})}});const E=a.attributes.imageLiteral||a.attributes.gridLiteral;if(E){const t=(a.attributes.imageLiteralColumns||5)*E,n=a.attributes.imageLiteralRows||5,i=a.attributes.imageLiteralScale,r=a.attributes.gridLiteralOnColor,s=a.attributes.gridLiteralOffColor;e.appendDummyInput().appendField(new g.FieldLedMatrix("",{columns:t,rows:n,scale:i,onColor:r,offColor:s}),"LEDS")}"external"===a.attributes.inlineInputMode?e.setInputsInline(!1):"inline"===a.attributes.inlineInputMode?e.setInputsInline(!0):e.setInputsInline(!a.parameters||a.parameters.length<4&&!E);const w=null===(d=a.parameters)||void 0===d?void 0:d.find(e=>pxtc.parameterTypeIsArrowFunction(e));(w||k)&&(e.appendStatementInput("HANDLER").setCheck(null),e.setInputsInline(!0));const I=B(a),N=!!a.attributes.handlerStatement||!!a.attributes.forceStatement||"void"===a.retType&&!I;N||H(e,a.retType,t);e.setPreviousStatement(N),e.setNextStatement(N),x&&(0,s.initVariableReporterArgs)(e,c.handlerArgs,t);function D(s,o=!1){let u=0,d=!o&&!!c.thisParameter;const p=function(e){const t=[];let n=[];return e.parts.forEach(e=>{switch(e.kind){case"break":i();break;case"param":n.push(e),i();break;case"image":case"label":n.push(e)}}),i(),t;function i(){n.length&&(t.push(n),n=[])}}(s),f=new pxt.ImageConverter;if(("ENUM_GET"===a.attributes.shim||"KIND_GET"===a.attributes.shim)&&(c.parameters.length>1||c.thisParameter))return void pxt.warn(`Enum blocks may only have 1 parameter but ${a.attributes.blockId} has ${c.parameters.length}`);const g=t=>{var n;return null===(n=e.inputList)||void 0===n?void 0:n.some(e=>e.name===t)};p.forEach(s=>{const p=[];let v,T,k,x=!1;if(s.forEach(e=>{if("param"!==e.kind){const t=function(e){if("image"===e.kind)return function(e){let t=j[e];if(!t)return void pxt.log(`missing jres icon ${e}`);return new i.FieldImage(t,40,40,"",null,pxt.Util.isUserLanguageRtl())}(e.uri);const t=function(e){if(" "===e)return"";if(e.length>1){const t=" "==e.charAt(0),n=" "==e.charAt(e.length-1);if(t||n)return e.substring(t?1:0,n?e.length-1:e.length)}return e}(e.text);if(!t)return;return e.cssClass?new i.FieldLabel(t,e.cssClass):e.style.length?new _.FieldStyledLabel(t,{bold:-1!==e.style.indexOf("bold"),italics:-1!==e.style.indexOf("italics"),blocksInfo:void 0}):new i.FieldLabel(t,void 0)}(e);t&&p.push({field:t})}else{if("ENUM_GET"===a.attributes.shim)return pxt.Util.assert(!!a.attributes.enumName,"Trying to create an ENUM_GET block without a valid enum name"),void p.push({name:"MEMBER",field:new y.FieldUserEnum(t.enumsByName[a.attributes.enumName])});if("KIND_GET"===a.attributes.shim)return void p.push({name:"MEMBER",field:new l.FieldKind(t.kindsByName[a.attributes.kindNamespace||a.attributes.blockNamespace||a.namespace])});{let o=function(e,t,n=!1){if(e.ref){const n="this"===e.name?t.thisParameter:t.actualNameToParam[e.name];if(!n){let n;if(t.handlerArgs.forEach(t=>{t.name===e.name&&(n=t)}),n)return n}return n}return n?t.thisParameter:t.definitionNameToParam[e.name]}(e,c,d);if(d=!1,!o)return void pxt.error("block "+a.attributes.blockId+": unknown parameter "+e.name+(e.ref?` (${e.ref})`:""));if(!o.definitionName)return v=n.DRAGGABLE_PARAM_INPUT_PREFIX+o.name,void(T="reporter"===a.attributes.draggableParameters?V(o.type,t):"Variable");let l=pxt.Util.lookup(t.apis.byQName,o.type);x=!0;const u=o.definitionName,g=o.actualName;let _=l&&6==l.kind,y=l&&!!l.attributes.fixedInstances&&!o.shadowBlockId,k=!!a.attributes.constantShim,E="@combined@"==o.type,C=o.fieldEditor,w=u.charAt(0).toUpperCase()+u.slice(1),I=o.type;if(_||y||k||E){let e;_?(r=t.apis,s=o.type,e=pxt.Util.values(r.byQName).filter(e=>e.namespace===s&&!e.attributes.blockHidden)):e=y?z(t.apis,l.qName):E?a.combinedProperties.map(e=>pxt.Util.lookup(t.apis.byQName,e)):function(e,t){return pxt.Util.values(e.byQName).filter(e=>e.attributes.blockIdentity===t)}(t.apis,a.qName),0==e.length&&pxt.error(`no instances of ${l.qName} found`);const n=e.map(e=>{let t=e.attributes.block||e.attributes.blockId||e.name,n=e.attributes.blockCombine;return e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=f.convert(e.attributes.jresURL)),n&&(t=t.replace(/@set/,"")),[e.attributes.iconURL||e.attributes.blockImage?{src:e.attributes.iconURL||pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,`blocks/${e.namespace.toLowerCase()}/${e.name.toLowerCase()}.png`),alt:t,width:36,height:36,value:e.name}:t,e.namespace+"."+e.name]});if(o.defaultValue){let e=-1;if(n.some((t,n)=>t[1]===o.defaultValue&&(e=n,!0)),e>-1){const t=n.splice(e,1)[0];n.unshift(t)}}if(C){let e=a.attributes.paramDefl[g]||"";const i={data:n,colour:m,label:w,type:I,blocksInfo:t};pxt.Util.jsonMergeFrom(i,a.attributes.paramFieldEditorOptions&&a.attributes.paramFieldEditorOptions[g]||{}),p.push(K((0,b.createFieldEditor)(C,e,i),u))}else p.push(K(new S.FieldDropdown(n),u))}else if(C){const e=a.attributes.paramDefl[o.actualName]||"",n={colour:m,label:w,type:I,blocksInfo:t};pxt.Util.jsonMergeFrom(n,a.attributes.paramFieldEditorOptions&&a.attributes.paramFieldEditorOptions[o.actualName]||{}),p.push(K((0,b.createFieldEditor)(C,e,n),o.definitionName))}else v=u,h&&"this"===e.name?T=o.type:"number"==o.type&&o.shadowBlockId&&"value"==o.shadowBlockId?(v=void 0,p.push(K(new i.FieldNumber("0"),u))):T="string"==o.type&&o.shadowOptions&&o.shadowOptions.toString?null:V(o.type,t)}}var r,s}),v){if(g(v))return;k=e.appendValueInput(v),k.setAlign(i.inputs.Align.LEFT)}else if(o){const t=x?r.optionalInputWithFieldPrefix:r.optionalDummyInputPrefix;if(v=t+u++,g(v))return;k=e.appendDummyInput(v)}else k=e.appendDummyInput();T&&k.setCheck(T),p.forEach(e=>k.appendField(e.field,e.name))}),f.logTime()}e.setTooltip(/^__/.test(a.namespace)?"":a.attributes.jsDoc)}(this,e,t,a)}}};pxt.Util.isTranslationMode()&&(p.block.customContextMenu=e=>{t.attributes.translationId&&e.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,v.promptTranslateBlock)(u,[t.attributes.translationId])}})});M[u]=p,i.Blocks[u]=p.block}(e,t,a,c);return t})}function B(e){var t;return!!(null===(t=e.parameters)||void 0===t?void 0:t.some(e=>pxtc.parameterTypeIsArrowFunction(e)))}n.blockSymbol=function(e){let t=M[e];return t?t.fn:void 0},n.injectBlocks=F,n.hasArrowFunction=B,n.cleanBlocks=function(){pxt.debug("removing all custom blocks");for(const e in M)G(M[e].fn)},n.initializeAndInject=function(e){U(e),(0,x.initContextMenu)(),(0,w.initCopyPaste)(!1),F(e)},n.initialize=function(e){U(e),function(e){j={};const t=e.apis.jres;if(!t)return;Object.keys(t).forEach(e=>{const n=t[e];n&&n.icon&&(j[e]=n.icon)})}(e)};let $=!1;function U(e){$||($=!0,(0,b.initFieldEditors)(),(0,k.initOnStart)(),(0,a.initMath)(e),(0,T.initVariables)(),(0,c.initFunctions)(),(0,u.initLists)(),(0,p.initLoops)(),(0,d.initLogic)(),(0,h.initText)(),i.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="",function(){const e=e=>{var t;if(null===(t=e.hasDisabledReason)||void 0===t?void 0:t.call(e,R.AUTO_DISABLED_REASON))return lf("This block is disabled and will not run. Attach this block to an event to enable it.");let n=e.tooltip;for(;"function"==typeof n;)n=n(e);return n};i.Tooltip.setCustomTooltip((t,n)=>{if(n.codeCard){const i=(0,E.renderCodeCard)({header:e(n)});t.appendChild(i)}else{let r=e(n);r=i.utils.string.wrap(r,i.Tooltip.LIMIT);let s=r.split("\n");for(let e=0;e<s.length;e++){let n=document.createElement("div");n.appendChild(document.createTextNode(s[e])),t.appendChild(n)}}})}(),pxt.BrowserUtils.isSafari()&&pxt.BrowserUtils.isIOS()&&document.addEventListener("pointerup",e=>{setTimeout(()=>{i.Touch.checkTouchIdentifier(e)&&i.Touch.clearTouchIdentifier()})}))}function V(e,t){const n=e.split(/\s*\|\s*/),i=[];for(const e of n)switch(e){case"number":i.push("Number");break;case"string":i.push("String");break;case"boolean":i.push("Boolean");break;case"T":case"any":return null;case"void":return;default:if((0,f.isArrayType)(e)){if(n.length>1)return null;i.push("Array")}const r=t.apis.byQName[e];r&&r.extendsTypes&&0<r.extendsTypes.length?i.push(...r.extendsTypes):i.push(e)}return i}function H(e,t,n){const i=V(t,n);(i||null===i)&&e.setOutput(!0,i)}function G(e){delete i.Blocks[e.attributes.blockId],delete M[e.attributes.blockId]}n.initAccessibleBlocksContextMenuItems=function(){(0,w.initAccessibleBlocksCopyPasteContextMenu)()},n.getBlocklyCheckForType=V,n.setOutputCheck=H;let j={};function K(e,t){return{field:e,name:t}}function z(e,t){return pxt.Util.values(e.byQName).filter(n=>4===n.kind&&n.attributes.fixedInstance&&function(e,t,n){if(t==n)return!0;let i=e.byQName[t];return!(!i||!i.extendsTypes)&&i.extendsTypes.indexOf(n)>=0}(e,n.retType,t)).sort((e,t)=>(t.attributes.weight||50)-(e.attributes.weight||50))}n.getFixedInstanceDropdownValues=z,n.generateIcons=function(e){const t=new pxt.ImageConverter;e.forEach(e=>{e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=t.convert(e.attributes.jresURL))})},n.setVarFieldValue=function(e,t,n){const i=e.getField(t),r=e.workspace.getVariableMap().getAllVariables();let s=!1;if(r&&r.length)for(let e=0;e<r.length;e++){const t=r[e];t.getName()===n&&(i.setValue(t.getId()),s=!0)}if(!s){i.initModel();const e=i.getVariable();e.setName(n),i.setValue(e.getId())}}},{"./builtins/functions":3,"./builtins/lists":4,"./builtins/logic":5,"./builtins/loops":6,"./builtins/math":7,"./builtins/misc":8,"./builtins/text":9,"./builtins/variables":10,"./codecardRenderer":11,"./compiler/compiler":12,"./compiler/util":15,"./composableMutations":17,"./constants":18,"./contextMenu":21,"./copyPaste":23,"./external":25,"./fields":70,"./fields/field_dropdown":34,"./help":72,"./legacyMutations":76,"./plugins/duplicateOnDrag":92,"./plugins/functions":112,"./plugins/functions/utils":115,"./plugins/newVariableField/fieldVariable":123,"./toolbox":140,blockly:176}],78:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.monkeyPatchBlockSvg=void 0;const i=e("blockly"),r=e("../fields/field_imagenotext"),s=e("../plugins/renderer/constants");n.monkeyPatchBlockSvg=function(){const e=i.BlockSvg.prototype.setCollapsed;i.BlockSvg.prototype.setCollapsed=function(t){if(t!==this.isCollapsed()&&(e.call(this,t),this.isCollapsed())){const e=this.getInput(i.constants.COLLAPSED_INPUT_NAME),t=s.ConstantProvider.EXPAND_IMAGE_DATAURI;t&&e.appendField(new r.FieldImageNoText(t,24,24,"",()=>{this.setCollapsed(!1)},!1))}}}},{"../fields/field_imagenotext":38,"../plugins/renderer/constants":127,blockly:176}],79:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.monkeyPatchGesture=void 0;const i=e("blockly");n.monkeyPatchGesture=function(){if(!pxt.BrowserUtils.isAndroid()||!pxt.BrowserUtils.isInGame())return;const e=i.Gesture.prototype.doStart;i.Gesture.prototype.doStart=function(t){if(this.id)return t.stopPropagation(),void t.preventDefault();this.id=t.pointerId,e.call(this,t)},i.Gesture.prototype.bindMouseEvents=function(e){this.boundEvents_||(this.boundEvents_=[]);const t=e=>{const t=new PointerEvent(e.type,Object.assign(Object.assign({},e),{clientX:e.clientX,clientY:e.clientY,pointerId:this.id}));return t.stopPropagation=()=>e.stopPropagation(),t.stopImmediatePropagation=()=>e.stopImmediatePropagation(),t.preventDefault=()=>e.preventDefault(),t},n=e=>n=>{if("pointerup"===n.type)n=t(n);else if(n.pointerId!==this.id)return;try{e.call(this,n)}catch(n){pxt.error("Uncaught error while executing gesture handler",n),this.cancel(),this.dispose()}};this.boundEvents_.push(i.browserEvents.conditionalBind(document,"pointerdown",null,n(this.handleStart),!0)),this.boundEvents_.push(i.browserEvents.conditionalBind(document,"pointermove",null,n(this.handleMove),!0)),this.boundEvents_.push(i.browserEvents.conditionalBind(document,"pointerup",null,n(this.handleUp),!0)),e.preventDefault(),e.stopPropagation()};const t=i.Gesture.prototype.dispose;i.Gesture.prototype.dispose=function(){if(t.call(this),this.boundEvents_){for(const e of this.boundEvents_)i.browserEvents.unbind(e);this.boundEvents_.length=0}}}},{blockly:176}],80:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.monkeyPatchGrid=void 0;const i=e("blockly");n.monkeyPatchGrid=function(){var e,t;const n=null===(e=pxt.appTarget.appTheme.blocklyOptions)||void 0===e?void 0:e.grid;if(!(null===(t=null==n?void 0:n.image)||void 0===t?void 0:t.path))return;const r=[];i.Grid.createDom=function(e,t,s,o){const a="blocklyGridPattern"+e,l=i.utils.dom.createSvgElement(i.utils.Svg.PATTERN,{id:a,patternUnits:"userSpaceOnUse",width:n.image.width,height:n.image.height},s);r.push(a);return i.utils.dom.createSvgElement(i.utils.Svg.IMAGE,{width:n.image.width,height:n.image.height,opacity:n.image.opacity},l).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n.image.path),o&&o.style.setProperty("--blocklyGridPattern",`url(#${l.id})`),l};const s=i.Grid.prototype.update;i.Grid.prototype.update=function(e){s.call(this,e);const t=[];for(const i of r){const r=document.getElementById(i);r?(r.setAttribute("width",n.image.width),r.setAttribute("height",n.image.height),r.setAttribute("patternTransform","scale("+e+")")):t.push(i)}for(const e of t)r.splice(r.indexOf(e),1)}}},{blockly:176}],81:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.applyMonkeyPatches=void 0;const i=e("./blockSvg"),r=e("./gesture"),s=e("./grid"),o=e("./shortcut_registry");n.applyMonkeyPatches=function(){(0,i.monkeyPatchBlockSvg)(),(0,s.monkeyPatchGrid)(),(0,r.monkeyPatchGesture)(),(0,o.monkeyPatchAddKeyMapping)()}},{"./blockSvg":78,"./gesture":79,"./grid":80,"./shortcut_registry":82}],82:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.monkeyPatchAddKeyMapping=void 0;const i=e("blockly");n.monkeyPatchAddKeyMapping=function(){const e=i.ShortcutRegistry.prototype.addKeyMapping;i.ShortcutRegistry.prototype.addKeyMapping=function(t,n,r){i.ShortcutRegistry.registry.getShortcutNamesByKeyCode(t.toString()).includes(n)||e.call(this,t,n,r)}}},{blockly:176}],83:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("../functions/constants"),s=e("../../fields/field_imagenotext"),o={valueConnections_:[],horizontalAfter_:3,itemCount_:3,mutationToDom:function(){const e=i.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),this.horizontalAfter_&&e.setAttribute("horizontalafter",this.horizontalAfter_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10);const t=e.getAttribute("horizontalafter");t&&(this.horizontalAfter_=parseInt(t,10)),this.updateShape_()},storeConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreConnections_:function(){var e;for(let t=0;t<this.itemCount_;t++)null===(e=this.valueConnections_[t])||void 0===e||e.reconnect(this,"ADD"+t)},addItem_:function(){this.storeConnections_();if(this.update_(()=>{this.itemCount_++}),this.restoreConnections_(),this.itemCount_>1){const s=this.getInput("ADD0");if(s&&s.connection.targetConnection){const o=this.getInput("ADD"+(this.itemCount_-1)),a=s.connection.getShadowDom(),l=a&&a.getAttribute("type");if(l){const i=n("shadow",l),r=e(a,"value");for(let n=0;n<r.length;n++){const s=r[n],o=s.getAttribute("name"),a=e(s,"shadow")[0];t(i,o,a&&a.getAttribute("type"))}o.connection.setShadowDom(i)}const c=s.connection.targetConnection,u=c&&c.getSourceBlock(),d=u&&u.type;if(d&&d!==l){const e=n("block",d);if(u)if(d===r.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){const t=i.utils.xml.createElement("mutation");t.setAttribute("name",u.getName()),e.appendChild(t)}else if(u.inputList)for(let n=0;n<u.inputList.length;n++){const i=u.inputList[n],r=i.connection&&i.connection.getShadowDom(),s=r&&r.getAttribute("type");t(e,i.name,s)}const s=i.Xml.domToBlock(e,this.workspace);o.connection.connect(s.outputConnection)}else o.connection.setShadowDom(o.connection.getShadowDom())}}function e(e,t){const n=[];if(!e||!e.children)return n;for(let i=0;i<e.children.length;i++){const r=e.children[i];r.tagName===t&&n.push(r)}return n}function t(e,t,r){if(!t||!r)return;const s=i.utils.xml.createElement("value");s.setAttribute("name",t),s.appendChild(n("shadow",r)),e.appendChild(s)}function n(e,t){const n=i.utils.xml.createElement(e);return n.setAttribute("type",t),n.setAttribute("id",i.utils.idGenerator.genUid()),n}},removeItem_:function(){this.storeConnections_();this.update_(()=>{this.itemCount_--}),this.restoreConnections_()},update_:function(e){i.Events.setGroup(!0);const t=this,n=t.mutationToDom(),r=n&&i.Xml.domToText(n);e&&e.call(this),this.updateShape_(),t instanceof i.BlockSvg&&t.initSvg();const s=i.Events.getGroup(),o=t.mutationToDom(),a=o&&i.Xml.domToText(o);r!=a&&(i.Events.fire(new i.Events.BlockChange(t,"mutation",null,r,a)),setTimeout(function(){i.Events.setGroup(s),t.bumpNeighbours(),i.Events.setGroup(!1)},i.config.bumpDelay)),t.rendered&&t instanceof i.BlockSvg&&t.queueRender(),i.Events.setGroup(!1)},updateShape_:function(){const e=()=>{this.removeItem_()};this.itemCount_?(this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(i.Msg.LISTS_CREATE_WITH_INPUT_WITH)):(this.getInput("TITLE")&&this.removeInput("TITLE"),this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(i.Msg.LISTS_CREATE_EMPTY_TITLE));let t=0;for(t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||this.appendValueInput("ADD"+t);for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");const n=this.appendDummyInput("BUTTONS");this.itemCount_>0&&n.appendField(new s.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",e,!1)),n.appendField(new s.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",()=>{this.addItem_()},!1));const r=this.itemCount_<=this.horizontalAfter_;if(this.setInputsInline(r),this.workspace instanceof i.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(r?e.getConstants().SHAPES.ROUND:e.getConstants().SHAPES.SQUARE)}}};i.Blocks.lists_create_with=Object.assign(Object.assign({},o),{init:function(){if(i.Extensions.apply("inline-svgs",this,!1),this.setHelpUrl(i.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.updateShape_(),this.setOutput(!0,"Array"),this.workspace instanceof i.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(e.getConstants().SHAPES.ROUND)}this.setInputsInline(!0),this.setTooltip(i.Msg.LISTS_CREATE_WITH_TOOLTIP)}})},{"../../fields/field_imagenotext":38,"../functions/constants":106,blockly:176}],84:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./createList"),n)},{"./createList":83}],85:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CommentIcon=void 0;const i=e("blockly"),r=e("./textinput_bubble"),s=e("../../fields"),o=i.Events,a="~commentOffsetX",l="~commentOffsetY";class c extends i.icons.Icon{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new i.utils.Size(160,80),this.bubbleVisiblity=!1}getType(){return c.TYPE}initView(e){this.svgRoot||(super.initView(e),i.utils.dom.createSvgElement(i.utils.Svg.PATH,{class:"blocklyIconShape",d:"m 2,2 0,9.2211 3.0026599,0 1.6008929,1.5989 1.8138195,-1.5989 6.6046683,0 0,-9.2211 -13.0220406,0 z",style:"fill: #fff;"},this.svgRoot),i.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"4",y:"8",height:"1",width:"6",style:"fill: #575E75;"},this.svgRoot),i.utils.dom.createSvgElement(i.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"4",y:"6",height:"1",width:"6",style:"fill: #575E75;"},this.svgRoot),i.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"4",y:"4",height:"1",width:"8",style:"fill: #575E75;"},this.svgRoot),i.utils.dom.addClass(this.svgRoot,"blockly-icon-comment"))}dispose(){var e;super.dispose(),null===(e=this.textInputBubble)||void 0===e||e.dispose()}getWeight(){return c.WEIGHT}getSize(){return new i.utils.Size(17,17)}applyColour(){var e;super.applyColour();const t=this.sourceBlock.style.colourPrimary,n=this.sourceBlock.style.colourTertiary;null===(e=this.textInputBubble)||void 0===e||e.setColour(t,n)}async updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(await this.setBubbleVisible(!1),await this.setBubbleVisible(!0))}onLocationChange(e){var t;super.onLocationChange(e);const n=this.getAnchorLocation();null===(t=this.textInputBubble)||void 0===t||t.setAnchorLocation(n)}setText(e){var t;this.text||e||this.clearSavedOffsetData();const n=this.text;o.fire(new(o.get(o.BLOCK_CHANGE))(this.sourceBlock,"comment",null,n,e)),this.text=e,null===(t=this.textInputBubble)||void 0===t||t.setText(this.text)}getText(){return this.text}setBubbleSize(e){var t;this.bubbleSize=e,null===(t=this.textInputBubble)||void 0===t||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){var t,n,r,s;this.text=null!==(t=e.text)&&void 0!==t?t:"",this.bubbleSize=new i.utils.Size(null!==(n=e.width)&&void 0!==n?n:160,null!==(r=e.height)&&void 0!==r?r:80),this.bubbleVisiblity=null!==(s=e.pinned)&&void 0!==s&&s,this.setBubbleVisible(this.bubbleVisiblity)}setBubbleLocation(e){}getBubbleLocation(){var e;if(this.bubbleIsVisible())return null===(e=this.textInputBubble)||void 0===e?void 0:e.getRelativeToSurfaceXY()}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(!this.textInputBubble)return;const e=this.textInputBubble.getText();this.text!==e&&(o.fire(new(o.get(o.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onPositionChange(){if(this.textInputBubble){const e=this.textInputBubble.getPositionRelativeToAnchor();(0,s.setBlockDataForField)(this.sourceBlock,a,e.x+""),(0,s.setBlockDataForField)(this.sourceBlock,l,e.y+"")}}bubbleIsVisible(){return this.bubbleVisiblity}async setBubbleVisible(e){this.bubbleVisiblity!==e&&(e&&this.textInputBubble||(e||this.textInputBubble)&&(this.bubbleVisiblity=e,!this.sourceBlock.rendered||this.sourceBlock.isInFlyout||this.sourceBlock.isInsertionMarker()||(await i.renderManagement.finishQueuedRenders(),!this.sourceBlock.rendered||this.sourceBlock.isInFlyout||this.sourceBlock.isInsertionMarker()||(e?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),this.sourceBlock.isEditable()&&o.fire(new(o.get(o.BUBBLE_OPEN))(this.sourceBlock,e,"comment"))))))}getBubble(){return this.textInputBubble}showEditableBubble(){const e=this.getSavedOffsetData();this.textInputBubble=new r.TextInputBubble(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addPositionChangeListener(()=>this.onPositionChange()),this.textInputBubble.setDeleteHandler(()=>{this.setBubbleVisible(!1),this.sourceBlock.setCommentText(null),this.clearSavedOffsetData()}),this.textInputBubble.setCollapseHandler(()=>{this.setBubbleVisible(!1)}),e&&this.textInputBubble.setPositionRelativeToAnchor(e.x,e.y),i.getFocusManager().focusNode(this.textInputBubble)}showNonEditableBubble(){const e=this.getSavedOffsetData();this.textInputBubble=new r.TextInputBubble(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect(),!0),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.setCollapseHandler(()=>{this.setBubbleVisible(!1)}),e&&this.textInputBubble.setPositionRelativeToAnchor(e.x,e.y),i.getFocusManager().focusNode(this.textInputBubble)}hideBubble(){var e;null===(e=this.textInputBubble)||void 0===e||e.dispose(),this.textInputBubble=null,i.getFocusManager().focusNode(this.getSourceBlock())}getAnchorLocation(){return i.utils.Coordinate.sum(this.workspaceLocation,new i.utils.Coordinate(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new i.utils.Rect(e.y,e.y+e.height,e.x,e.x+e.width)}getSavedOffsetData(){const e=(0,s.getBlockDataForField)(this.sourceBlock,a),t=(0,s.getBlockDataForField)(this.sourceBlock,l);return e&&t?new i.utils.Coordinate(parseFloat(e),parseFloat(t)):new i.utils.Coordinate(16,16)}clearSavedOffsetData(){(0,s.deleteBlockDataForField)(this.sourceBlock,a),(0,s.deleteBlockDataForField)(this.sourceBlock,l)}}n.CommentIcon=c,c.TYPE=i.icons.IconType.COMMENT,c.WEIGHT=3,i.icons.registry.unregister(c.TYPE.toString()),i.icons.registry.register(c.TYPE,c)},{"../../fields":70,"./textinput_bubble":88,blockly:176}],86:[function(e,t,n){var i;Object.defineProperty(n,"__esModule",{value:!0}),n.Bubble=void 0;const r=e("blockly");var s=r.utils.dom;class o{constructor(e,t,n,i){this.workspace=e,this.anchor=t,this.ownerRect=n,this.size=new r.utils.Size(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeTop=0,this.relativeLeft=0,this.dragStrategy=new r.dragging.BubbleDragStrategy(this,this.workspace),this.id=r.utils.idGenerator.getNextUniqueId(),this.svgRoot=s.createSvgElement(r.utils.Svg.G,{class:"blocklyBubble"},e.getBubbleCanvas());const a=s.createSvgElement(r.utils.Svg.G,{},this.svgRoot);this.tail=s.createSvgElement(r.utils.Svg.LINE,{"stroke-width":"3","stroke-linecap":"round"},a),this.background=s.createSvgElement(r.utils.Svg.RECT,{class:"blocklyDraggable","stroke-width":"3",x:0,y:0},a),this.contentContainer=s.createSvgElement(r.utils.Svg.G,{},this.svgRoot),this.topBar=s.createSvgElement(r.utils.Svg.RECT,{class:"blocklyCommentTopbarBackground",x:o.BORDER_WIDTH,y:o.BORDER_WIDTH},a),this.deleteIcon=s.createSvgElement(r.utils.Svg.IMAGE,{class:"blocklyDeleteIcon",href:`${e.options.pathToMedia}delete-icon.svg`},a),this.collapseIcon=s.createSvgElement(r.utils.Svg.IMAGE,{class:"blocklyFoldoutIcon",href:`${e.options.pathToMedia}foldout-icon.svg`},a),this.focusableElement=null!=i?i:this.svgRoot,this.focusableElement.setAttribute("id",this.id),r.browserEvents.conditionalBind(this.background,"pointerdown",this,this.onMouseDown),r.browserEvents.conditionalBind(this.topBar,"pointerdown",this,this.onMouseDown),r.browserEvents.conditionalBind(this.collapseIcon,"pointerdown",this,this.onCollapseDown),r.browserEvents.conditionalBind(this.deleteIcon,"pointerdown",this,this.onDeleteDown)}dispose(){this.disposed||(s.removeNode(this.svgRoot),this.disposed=!0,this.isDragDelete&&this.deleteHandler&&this.deleteHandler())}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getPositionRelativeToAnchor(){return new r.utils.Coordinate(this.relativeLeft,this.relativeTop)}getSize(){return this.size}setSize(e,t=!1){const n=this.topBar.getBBox(),i=this.deleteIcon.getBBox(),r=this.collapseIcon.getBBox();e.width=Math.max(e.width,o.MIN_SIZE),e.height=Math.max(e.height,o.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),this.topBar.setAttribute("width",""+(e.width-o.DOUBLE_BORDER)),this.updateDeleteIconPosition(e,n,i),this.updateFoldoutIconPosition(n,r),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e,t){this.colour=e,this.tail.setAttribute("stroke",t||e),this.background.setAttribute("fill",t||e),this.background.setAttribute("stroke",t||e),this.svgRoot.setAttribute("style",`--commentBorderColour: ${e}`)}onMouseDown(e){var t;null===(t=this.workspace.getGesture(e))||void 0===t||t.handleBubbleStart(e,this),r.common.setSelected(this),r.getFocusManager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;this.workspace.RTL?e-=this.relativeLeft+this.size.width:e+=this.relativeLeft;const t=this.relativeTop+this.anchor.y;this.moveTo(e,t)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new r.utils.Rect(0,0,0,0)){const t=this.workspace.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft(t),i=this.getOptimalRelativeTop(t),s={x:n,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},o={x:-this.size.width-30,y:i},a={x:e.getWidth(),y:i},l={x:n,y:e.getHeight()},c=e.getWidth()<e.getHeight()?a:l,u=e.getWidth()<e.getHeight()?l:a,d=this.getOverlap(s,t),p=this.getOverlap(o,t),h=this.getOverlap(c,t),f=this.getOverlap(u,t),m=Math.max(d,p,h,f);return d===m?(this.relativeLeft=s.x,this.relativeTop=s.y,void this.positionRelativeToAnchor()):p===m?(this.relativeLeft=o.x,this.relativeTop=o.y,void this.positionRelativeToAnchor()):h===m?(this.relativeLeft=c.x,this.relativeTop=c.y,void this.positionRelativeToAnchor()):(this.relativeLeft=u.x,this.relativeTop=u.y,void this.positionRelativeToAnchor())}getOverlap(e,t){const n={x:this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x,y:e.y+this.anchor.y},i={x:n.x+this.size.width,y:n.y+this.size.height},r={x:t.left,y:t.top},s={x:t.left+t.width,y:t.top+t.height},o=Math.min(i.x,s.x)-Math.max(n.x,r.x),a=Math.min(i.y,s.y)-Math.max(n.y,r.y);return Math.max(0,Math.min(1,o*a/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;const n=this.getWorkspaceViewRect(e);if(this.workspace.RTL){const e=this.anchor.x-t;e-this.size.width<n.left?t=-(n.left-this.anchor.x+this.size.width):e>n.right&&(t=-(n.right-this.anchor.x))}else{const e=t+this.anchor.x,i=e+this.size.width;e<n.left?t=n.left-this.anchor.x:i>n.right&&(t=n.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const n=this.anchor.y+t,i=n+this.size.height,r=this.getWorkspaceViewRect(e);return n<r.top?t=r.top-this.anchor.y:i>r.bottom&&(t=r.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let n=e.top+e.height,i=e.left,s=e.left+e.width;return n-=this.getScrollbarThickness(),this.workspace.RTL?i-=this.getScrollbarThickness():s-=this.getScrollbarThickness(),new r.utils.Rect(t,n,i,s)}getScrollbarThickness(){return r.Scrollbar.scrollbarThickness/this.workspace.scale}renderTail(){const e=this.size.width/2,t=this.size.height/2;let n=-this.relativeLeft,i=-this.relativeTop;const r=Math.atan2(t-i,e-n);n+=o.ANCHOR_RADIUS*Math.cos(r),i+=o.ANCHOR_RADIUS*Math.sin(r),this.tail.setAttribute("x1",e+""),this.tail.setAttribute("y1",t+""),this.tail.setAttribute("x2",n+""),this.tail.setAttribute("y2",i+"")}bringToFront(){var e;const t=null===(e=this.svgRoot)||void 0===e?void 0:e.parentNode;return!(!this.svgRoot||(null==t?void 0:t.lastChild)===this.svgRoot)&&(null==t||t.appendChild(this.svgRoot),!0)}getRelativeToSurfaceXY(){return new r.utils.Coordinate(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.workspace.RTL?this.relativeLeft=this.anchor.x-e.x-this.size.width:this.relativeLeft=e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){this.isDragDelete=e,e?s.addClass(this.getSvgRoot(),"blocklyDraggingDelete"):s.removeClass(this.getSvgRoot(),"blocklyDraggingDelete")}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){r.common.fireSelectedEvent(this)}unselect(){r.common.fireSelectedEvent(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}contentTop(){const e=this.topBar.getBBox();return o.BORDER_WIDTH+e.height}setDeleteHandler(e){this.deleteHandler=e}setCollapseHandler(e){this.collapseHandler=e}onDeleteDown(e){r.browserEvents.isRightButton(e)||this.deleteHandler&&(e.preventDefault(),this.deleteHandler()),e.stopPropagation()}onCollapseDown(e){r.browserEvents.isRightButton(e)||this.collapseHandler&&(e.preventDefault(),this.collapseHandler()),e.stopPropagation()}updateDeleteIconPosition(e,t,n){const i=this.calcDeleteMargin(t,n);this.deleteIcon.setAttribute("y",`${i}`),this.deleteIcon.setAttribute("x",""+(e.width-n.width-i))}updateFoldoutIconPosition(e,t){const n=this.calcFoldoutMargin(e,t);this.collapseIcon.setAttribute("y",`${n}`),this.collapseIcon.setAttribute("x",`${n}`)}calcDeleteMargin(e,t){return(e.height-t.height)/2+o.BORDER_WIDTH}calcFoldoutMargin(e,t){return(e.height-t.height)/2+o.BORDER_WIDTH}}n.Bubble=o,i=o,o.BORDER_WIDTH=0,o.DOUBLE_BORDER=2*i.BORDER_WIDTH,o.MIN_SIZE=i.DOUBLE_BORDER,o.ANCHOR_RADIUS=8,r.Css.register("\n.blocklyBubble .blocklyDeleteIcon, .blocklyBubble .blocklyFoldoutIcon {\n    filter: grayscale(100%) brightness(100000);\n}\n\n.blocklyBubble .blocklyTextarea.blocklyText {\n    color: #575E75;\n}\n")},{blockly:176}],87:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./blockComment"),n)},{"./blockComment":85}],88:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TextInputBubble=void 0;const i=e("./bubble.js"),r=e("blockly");var s=r.utils.dom,o=r.browserEvents;class a extends i.Bubble{constructor(e,t,n,l){super(e,t,n,a.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=n,this.readOnly=l,this.resizePointerUpListener=null,this.resizePointerMoveListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.positionChangeListeners=[],this.text="",this.DEFAULT_SIZE=new r.utils.Size(160+i.Bubble.DOUBLE_BORDER,80+i.Bubble.DOUBLE_BORDER),this.MIN_SIZE=new r.utils.Size(45+i.Bubble.DOUBLE_BORDER,20+i.Bubble.DOUBLE_BORDER),s.addClass(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0),l&&(this.deleteIcon.style.display="none"),o.conditionalBind(this.textArea,"keydown",this,this.onKeyDown)}getText(){return this.text}moveTo(e,t){super.moveTo(e,t),this.onPositionChange()}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addPositionChangeListener(e){this.positionChangeListeners.push(e)}static createTextArea(){const e=document.createElementNS(s.HTML_NS,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){const n=s.createSvgElement(r.utils.Svg.FOREIGNOBJECT,{x:i.Bubble.BORDER_WIDTH,y:this.contentTop()},e);setTimeout(()=>{n.setAttribute("y",this.contentTop()+"")});const o=document.createElementNS(s.HTML_NS,"body");return o.setAttribute("xmlns",s.HTML_NS),o.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),o.appendChild(t),n.appendChild(o),this.bindTextAreaEvents(t),n}bindTextAreaEvents(e){o.conditionalBind(e,"wheel",this,e=>{e.stopPropagation()}),o.conditionalBind(e,"pointerdown",this,e=>{e.stopPropagation(),r.Touch.clearTouchIdentifier()}),o.conditionalBind(e,"change",this,this.onTextChange)}createResizeHandle(e,t){const n=s.createSvgElement(r.utils.Svg.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e);return o.conditionalBind(n,"pointerdown",this,this.onResizePointerDown),n}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height+this.contentTop());const n=e.width-i.Bubble.DOUBLE_BORDER,r=e.height-this.contentTop()-i.Bubble.BORDER_WIDTH;this.inputRoot.setAttribute("width",`${n}`),this.inputRoot.setAttribute("height",`${r}`),this.textArea.style.width="100%",this.textArea.style.height="100%";const s=this.resizeGroup.getBBox();this.workspace.RTL?this.resizeGroup.setAttribute("transform",`translate(${i.Bubble.BORDER_WIDTH}, ${e.height-i.Bubble.BORDER_WIDTH-s.height}) scale(-1 1)`):this.resizeGroup.setAttribute("transform",`translate(${n-s.width}, ${e.height-i.Bubble.BORDER_WIDTH-s.height})`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}isDeletable(){return!this.readOnly}onResizePointerDown(e){this.bringToFront(),o.isRightButton(e)||(this.workspace.startDrag(e,new r.utils.Coordinate(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=o.conditionalBind(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=o.conditionalBind(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){r.Touch.clearTouchIdentifier(),this.resizePointerUpListener&&(o.unbind(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(o.unbind(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){const t=this.workspace.moveDrag(e);this.setSize(new r.utils.Size(this.workspace.RTL?-t.x:t.x,t.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}onPositionChange(){for(const e of this.positionChangeListeners)e()}onKeyDown(e){"Escape"===e.key&&(this.collapseHandler(),e.stopPropagation())}}n.TextInputBubble=a,r.Css.register("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n")},{"./bubble.js":86,blockly:176}],89:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DuplicateOnDragConnectionChecker=void 0;const i=e("blockly"),r=e("./duplicateOnDrag"),s=e("../functions/utils"),o=[];o[i.ConnectionType.INPUT_VALUE]=i.ConnectionType.OUTPUT_VALUE,o[i.ConnectionType.OUTPUT_VALUE]=i.ConnectionType.INPUT_VALUE,o[i.ConnectionType.NEXT_STATEMENT]=i.ConnectionType.PREVIOUS_STATEMENT,o[i.ConnectionType.PREVIOUS_STATEMENT]=i.ConnectionType.NEXT_STATEMENT;class a extends i.ConnectionChecker{doDragChecks(e,t,n){if(!super.doDragChecks(e,t,n))return!1;const i=t.targetBlock();return!(i&&(0,r.shouldDuplicateOnDrag)(i)&&(!i.isShadow()||!(0,r.isAllowlistedShadow)(i)))&&!!(0,s.doArgumentReporterDragChecks)(e,t,n)}doSafetyChecks(e,t){if(!e||!t)return i.Connection.REASON_TARGET_NULL;let n,r,s,a;return e.isSuperior()?(n=e.getSourceBlock(),r=t.getSourceBlock(),s=e,a=t):(r=e.getSourceBlock(),n=t.getSourceBlock(),a=e,s=t),n===r?i.Connection.REASON_SELF_CONNECTION:a.type!==o[s.type]?i.Connection.REASON_WRONG_TYPE:n.workspace!==r.workspace?i.Connection.REASON_DIFFERENT_WORKSPACES:a.type===i.ConnectionType.OUTPUT_VALUE&&r.previousConnection&&r.previousConnection.isConnected()||a.type===i.ConnectionType.PREVIOUS_STATEMENT&&r.outputConnection&&r.outputConnection.isConnected()?i.Connection.REASON_PREVIOUS_AND_OUTPUT:i.Connection.CAN_CONNECT}}n.DuplicateOnDragConnectionChecker=a},{"../functions/utils":115,"./duplicateOnDrag":91,blockly:176}],90:[function(e,t,n){
/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */
Object.defineProperty(n,"__esModule",{value:!0}),n.setDuplicateOnDragStrategy=n.DuplicateOnDragStrategy=void 0;const i=e("blockly"),r=e("./duplicateOnDrag");var s=i.Events,o=i.utils.Coordinate,a=i.utils.dom;class l{constructor(e){this.block=e,this.startParentConn=null,this.startChildConn=null,this.startLoc=null,this.connectionCandidate=null,this.connectionPreviewer=null,this.dragging=!1,this.originalEventGroup="",this.dragOffset=new o(0,0),this.workspace=e.workspace}isMovable(){var e,t;return this.block.isShadow()?null!==(t=null===(e=this.block.getParent())||void 0===e?void 0:e.isMovable())&&void 0!==t&&t:this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.options.readOnly&&!this.block.isInFlyout}startDrag(e){var t;if(this.block.isShadow()&&!(0,r.isAllowlistedShadow)(this.block))return void this.startDraggingShadow(e);this.dragging=!0,s.getGroup()||s.setGroup(!0),this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY();const n=i.registry.getClassFromOptions(i.registry.Type.CONNECTION_PREVIEWER,this.workspace.options);this.connectionPreviewer=new n(this.block),a.startTextWidthCache(),this.workspace.setResizesEnabled(!1),i.blockAnimations.disconnectUiStop();const o=!!e&&(e.altKey||e.ctrlKey||e.metaKey);this.shouldDisconnect(o)&&this.disconnectBlock(o),this.block.setDragging(!0),null===(t=this.workspace.getLayerManager())||void 0===t||t.moveToDragLayer(this.block)}startDraggingShadow(e){const t=this.block.getParent();if(!t)throw new Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=o.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){var t,n,s,o;let a,l,c;const u=this.block.isShadow();if(u&&this.block.setShadow(!1),(0,r.shouldDuplicateOnDrag)(this.block)){const e=this.block.outputConnection;if(!(null==e?void 0:e.targetConnection))return;c=i.Xml.blockToDom(this.block,!0),u||(a=i.Xml.domToBlock(c,this.block.workspace)),l=e.targetConnection}this.startParentConn=null!==(n=null===(t=this.block.outputConnection)||void 0===t?void 0:t.targetConnection)&&void 0!==n?n:null===(s=this.block.previousConnection)||void 0===s?void 0:s.targetConnection,e&&(this.startChildConn=null===(o=this.block.nextConnection)||void 0===o?void 0:o.targetConnection),l&&u&&l.setShadowDom(c),this.block.unplug(e),i.blockAnimations.disconnectUiEffect(this.block),(0,r.updateDuplicateOnDragState)(this.block),l&&a&&l.connect(a.outputConnection)}fireDragStartEvent(){const e=new(s.get(s.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));s.fire(e)}fireDragEndEvent(){const e=new(s.get(s.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));s.fire(e)}fireMoveEvent(){if(this.block.isDeadOrDying())return;const e=new(s.get(s.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),s.fire(e)}drag(e){var t;this.block.isShadow()?null===(t=this.block.getParent())||void 0===t||t.drag(o.sum(e,this.dragOffset)):(this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,o.difference(e,this.startLoc)))}updateConnectionPreview(e,t){const n=this.connectionCandidate,r=this.getConnectionCandidate(e,t);if(!r)return this.connectionPreviewer.hidePreview(),void(this.connectionCandidate=null);const s=n&&this.currCandidateIsBetter(n,t,r)?n:r;this.connectionCandidate=s;const{local:o,neighbour:a}=s,l=o.type===i.ConnectionType.OUTPUT_VALUE||o.type===i.ConnectionType.PREVIOUS_STATEMENT,c=a.isConnected()&&!a.targetBlock().isInsertionMarker();l&&c&&!this.orphanCanConnectAtEnd(e,a.targetBlock(),o.type)?this.connectionPreviewer.previewReplacement(o,a,a.targetBlock()):this.connectionPreviewer.previewConnection(o,a)}orphanCanConnectAtEnd(e,t,n){const r=n===i.ConnectionType.OUTPUT_VALUE?t.outputConnection:t.previousConnection;return!!i.Connection.getConnectionForOrphanedConnection(e,r)}currCandidateIsBetter(e,t,n){const{local:r,neighbour:s}=e,a=new o(r.x,r.y),l=new o(s.x,s.y),c=o.distance(o.sum(a,t),l);return n.distance>c-i.config.currentConnectionPreference}getConnectionCandidate(e,t){const n=this.getLocalConnections(e);let r=this.connectionCandidate?i.config.connectingSnapRadius:i.config.snapRadius,s=null;for(const e of n){const{connection:n,radius:i}=e.closest(r,t);n&&(s={local:e,neighbour:n,distance:i},r=i)}return s}getLocalConnections(e){const t=e.getConnections_(!1),n=e.lastConnectionInStack(!0);return n&&n!==e.nextConnection&&t.push(n),t}endDrag(e){var t,n;this.block.isShadow()?null===(t=this.block.getParent())||void 0===t||t.endDrag(e):(this.originalEventGroup=s.getGroup(),this.fireDragEndEvent(),this.fireMoveEvent(),a.stopTextWidthCache(),i.blockAnimations.disconnectUiStop(),this.connectionPreviewer.hidePreview(),!this.block.isDeadOrDying()&&this.dragging&&(null===(n=this.workspace.getLayerManager())||void 0===n||n.moveOffDragLayer(this.block,i.layers.BLOCK),this.block.setDragging(!1)),this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep()))}disposeStep(){const e=s.getGroup();s.setGroup(this.originalEventGroup),this.block.snapToGrid(),this.connectionPreviewer.dispose(),this.workspace.setResizesEnabled(!0),s.setGroup(e)}applyConnections(e){const{local:t,neighbour:n}=e;t.connect(n);const r=t.isSuperior()?n:t,s=this.block.getRootBlock();i.renderManagement.finishQueuedRenders().then(()=>{i.blockAnimations.connectionUiEffect(r.getSourceBlock()),setTimeout(()=>{s.bringToFront()},0)})}revertDrag(){var e,t,n;if(this.block.isShadow())null===(e=this.block.getParent())||void 0===e||e.revertDrag();else{if(null===(t=this.startChildConn)||void 0===t||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case i.ConnectionType.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case i.ConnectionType.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else this.block.moveTo(this.startLoc,["drag"]),null===(n=this.workspace.getLayerManager())||void 0===n||n.moveOffDragLayer(this.block,50),i.bumpObjects.bumpIntoBounds(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block);this.startChildConn=null,this.startParentConn=null,this.connectionPreviewer.hidePreview(),this.connectionCandidate=null,this.block.setDragging(!1),this.dragging=!1}}}n.DuplicateOnDragStrategy=l,n.setDuplicateOnDragStrategy=function(e){var t,n;null===(n=(t=e).setDragStrategy)||void 0===n||n.call(t,new l(e))}},{"./duplicateOnDrag":91,blockly:176}],91:[function(e,t,n){let i,r;function s(e){return!(!i||-1===i.indexOf(e.type))}function o(e){var t,n;if(e.isShadow()&&s(e))return!0;if(r){const i=null===(t=e.outputConnection)||void 0===t?void 0:t.targetBlock();if(i){const t=r.filter(e=>e.parentBlockType===i.type);for(const i of t)if(i&&(!i.childBlockType||i.childBlockType===e.type)){if(!i.inputName)return!0;if((null===(n=e.outputConnection.targetConnection.getParentInput())||void 0===n?void 0:n.name)===i.inputName)return!0}}}return!1}Object.defineProperty(n,"__esModule",{value:!0}),n.updateDuplicateOnDragState=n.shouldDuplicateOnDrag=n.isAllowlistedShadow=n.setDuplicateOnDrag=n.setDraggableShadowBlocks=void 0,n.setDraggableShadowBlocks=function(e){i=e},n.setDuplicateOnDrag=function(e,t,n){r||(r=[]),r.some(i=>i.parentBlockType===e&&i.inputName===t&&i.childBlockType===n)||r.push({parentBlockType:e,inputName:t,childBlockType:n})},n.isAllowlistedShadow=s,n.shouldDuplicateOnDrag=o,n.updateDuplicateOnDragState=function(e){setTimeout(()=>{const t=o(e);e.pathObject&&e.pathObject.setHasDottedOutlineOnHover(t),e.setDeletable(!t)})}},{}],92:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./duplicateOnDrag"),n),r(e("./variablesGetReporter"),n),r(e("./connectionChecker"),n),r(e("./dragStrategy"),n)},{"./connectionChecker":89,"./dragStrategy":90,"./duplicateOnDrag":91,"./variablesGetReporter":93}],93:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("./duplicateOnDrag");i.Blocks.variables_get_reporter={init:function(){this.jsonInit({type:"variables_get_reporter",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]}],output:null,colour:"%{BKY_VARIABLES_HUE}",outputShape:(new i.zelos.ConstantProvider).SHAPES.ROUND,helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableReporter"]}),(0,r.updateDuplicateOnDragState)(this)}}},{"./duplicateOnDrag":91,blockly:176}],94:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultiFlyoutRecyclableBlockInflater=n.HIDDEN_CLASS_NAME=void 0;const i=e("blockly");n.HIDDEN_CLASS_NAME="pxtFlyoutHidden";class r extends i.BlockFlyoutInflater{constructor(){super(...arguments),this.keyToBlock=new Map,this.blockToKey=new Map}static register(){i.registry.register(i.registry.Type.FLYOUT_INFLATER,"block",r,!0)}isBlockRecycleable(e){switch(e.type){case"variables_get":case"variables_set":case"variables_change":return!1}return!0}createBlock(e,t){const r=function(e){if(e.blockxml)return"string"==typeof e.blockxml?e.blockxml:i.Xml.domToText(e.blockxml);return e.type}(e);if(!r)return super.createBlock(e,t);let s;return this.keyToBlock.has(r)&&(s=this.keyToBlock.get(r),this.keyToBlock.delete(r)),s=null!=s?s:super.createBlock(e,t),this.blockToKey.set(s,r),s.removeClass(n.HIDDEN_CLASS_NAME),s.setDisabledReason(!1,n.HIDDEN_CLASS_NAME),s}disposeItem(e){const t=e.getElement();if(t instanceof i.BlockSvg&&this.blockToKey.has(t)){if(this.isBlockRecycleable(t))return void this.recycleBlock(t);this.blockToKey.delete(t)}super.disposeItem(e)}clearCache(){this.blockToKey=new Map,this.keyToBlock=new Map}recycleBlock(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),e.addClass(n.HIDDEN_CLASS_NAME),e.setDisabledReason(!0,n.HIDDEN_CLASS_NAME);const i=this.blockToKey.get(e);this.keyToBlock.set(i,e),this.removeListeners(e.id)}}n.MultiFlyoutRecyclableBlockInflater=r,i.Css.register(`\n.${n.HIDDEN_CLASS_NAME} {\n    display: none;\n}\n`)},{blockly:176}],95:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ButtonFlyoutInflater=void 0;const i=e("blockly"),r=e("./flyoutButton"),s="button";class o extends i.ButtonFlyoutInflater{static register(){i.registry.register(i.registry.Type.FLYOUT_INFLATER,s,o,!0)}load(e,t){const n=e,o=new r.FlyoutButton(t.getWorkspace(),t.targetWorkspace,n,!1);return n.id&&o.getSvgRoot().setAttribute("id",n.id),o.show(),new i.FlyoutItem(o,s)}}n.ButtonFlyoutInflater=o},{"./flyoutButton":97,blockly:176}],96:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CachingFlyout=void 0;const i=e("blockly"),r=e("./blockInflater");class s extends i.VerticalFlyout{constructor(){super(...arguments),this.forceOpen=!1}clearBlockCache(){const e=this.getInflaterForType("block");e instanceof r.MultiFlyoutRecyclableBlockInflater&&e.clearCache()}getFlyoutElement(){return this.svgGroup_}setForceOpen(e){this.forceOpen=e}}n.CachingFlyout=s},{"./blockInflater":94,blockly:176}],97:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FlyoutButton=void 0;const i=e("blockly"),r={"":"usb","":"accessible-icon","":"adn","":"pied-piper-pp","":"steam","":"bluetooth-b","":"rebel","":"maxcdn","":"joomla","":"sellsy","":"connectdevelop","":"github-alt"};class s extends i.FlyoutButton{constructor(e,t,n,s){super(e,t,n,s);const o=this.getSvgRoot();if(!s){const e=17.5,t=14,n=this.height;this.width+=2*(e-i.FlyoutButton.TEXT_MARGIN_X),this.height+=2*(t-i.FlyoutButton.TEXT_MARGIN_Y);const r=o.getElementsByClassName("blocklyFlyoutButtonShadow").item(0),s=o.getElementsByClassName("blocklyFlyoutButtonBackground").item(0),a=o.getElementsByTagName("text").item(0);return r.setAttribute("width",String(this.width)),r.setAttribute("height",String(this.height)),s.setAttribute("width",String(this.width)),s.setAttribute("height",String(this.height)),a.setAttribute("x",String(this.width/2)),void a.setAttribute("y",String(parseFloat(a.getAttribute("y"))-n/2+this.height/2))}const a=n;a["web-class"]&&o.classList.add(a["web-class"]);const l=a["web-icon"],c=a["web-icon-class"],u=a["web-icon-color"];if(l||c){const e=Object.keys(r).includes(l)?"brandIcon":"",t=i.utils.dom.createSvgElement("text",{class:`blocklyFlyoutLabelIcon${c?" "+c:""}${e?" "+e:""}`,x:0,y:0,"text-anchor":"start"},o);l&&(t.textContent=l),u&&t.setAttribute("style","fill: "+u);const n=this.getTargetWorkspace();t.setAttribute("dominant-baseline","central"),t.setAttribute("dy","0"),t.setAttribute("x",(n.RTL?this.width+i.FlyoutButton.TEXT_MARGIN_X:0)+""),t.setAttribute("y",this.height/2+i.FlyoutButton.TEXT_MARGIN_Y+"");const s=i.utils.dom.getTextWidth(t)+2*i.FlyoutButton.TEXT_MARGIN_X;this.width+=s;const a=o.getElementsByClassName("blocklyFlyoutLabelBackground").item(0);a.setAttribute("width",String(this.width));for(let e=0;e<o.children.length;e++){const n=o.children.item(e);if(n!==t&&n!==a){const e=Number(n.getAttribute("x"));n.setAttribute("x",e+s+"")}}}const d=a["web-line"],p=a["web-line-width"];if(d){const e=i.utils.dom.createSvgElement("line",{class:"blocklyFlyoutLine","stroke-dasharray":d,"text-anchor":"middle"},o);e.setAttribute("x1","0"),e.setAttribute("x2",null!=p?p:this.width+""),e.setAttribute("y1",this.height+10+""),e.setAttribute("y2",this.height+10+"")}}isDisposed(){return null===this.getSvgRoot().parentNode}}n.FlyoutButton=s},{blockly:176}],98:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.registerFlyoutInflaters=n.MultiFlyoutRecyclableBlockInflater=n.LabelFlyoutInflater=n.ButtonFlyoutInflater=void 0;const s=e("./buttonFlyoutInflater");Object.defineProperty(n,"ButtonFlyoutInflater",{enumerable:!0,get:function(){return s.ButtonFlyoutInflater}});const o=e("./labelFlyoutInflater");Object.defineProperty(n,"LabelFlyoutInflater",{enumerable:!0,get:function(){return o.LabelFlyoutInflater}});const a=e("./blockInflater");Object.defineProperty(n,"MultiFlyoutRecyclableBlockInflater",{enumerable:!0,get:function(){return a.MultiFlyoutRecyclableBlockInflater}}),r(e("./cachingFlyout"),n),n.registerFlyoutInflaters=function(){s.ButtonFlyoutInflater.register(),o.LabelFlyoutInflater.register(),a.MultiFlyoutRecyclableBlockInflater.register()}},{"./blockInflater":94,"./buttonFlyoutInflater":95,"./cachingFlyout":96,"./labelFlyoutInflater":99}],99:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LabelFlyoutInflater=void 0;const i=e("blockly"),r=e("./flyoutButton"),s="label";class o extends i.LabelFlyoutInflater{static register(){i.registry.register(i.registry.Type.FLYOUT_INFLATER,s,o,!0)}load(e,t){const n=new r.FlyoutButton(t.getWorkspace(),t.targetWorkspace,e,!0);return n.show(),new i.FlyoutItem(n,s)}}n.LabelFlyoutInflater=o},{"./flyoutButton":97,blockly:176}],100:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("../constants"),s={typeName_:"",getTypeName(){return this.typeName_},removeFieldCallback(e){const t=this.getParent();(null==t?void 0:t.removeFieldCallback)&&t.removeFieldCallback(e)}};i.Blocks[r.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"bool"}],extensions:["output_boolean","text_field_color"]}),this.typeName_="boolean"}}),i.Blocks[r.ARGUMENT_EDITOR_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"text"}],extensions:["output_string","text_field_color"]}),this.typeName_="string"}}),i.Blocks[r.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"num"}],extensions:["output_number","text_field_color"]}),this.typeName_="number"}}),i.Blocks[r.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"list"}],extensions:["output_array","text_field_color"]}),this.typeName_="Array"}}),i.Blocks[r.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"arg"}],outputShape:(new i.zelos.ConstantProvider).SHAPES.ROUND,extensions:["text_field_color"]}),this.typeName_="any"},mutationToDom(){const e=i.utils.xml.createElement("mutation");return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_)}})},{"../constants":106,blockly:176}],101:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LOCALIZATION_NAME_MUTATION_KEY=void 0;const i=e("blockly"),r=e("../constants"),s=e("../msg"),o=e("../../duplicateOnDrag");n.LOCALIZATION_NAME_MUTATION_KEY="localizationname";const a={typeName_:"",localizationName_:"",getTypeName(){return this.typeName_},getLocalizationName(){return this.localizationName_||this.getFieldValue("VALUE")},mutationToDom(){const e=i.utils.xml.createElement("mutation");return this.localizationName_&&e.setAttribute(n.LOCALIZATION_NAME_MUTATION_KEY,this.localizationName_),e},domToMutation(e){e.hasAttribute(n.LOCALIZATION_NAME_MUTATION_KEY)&&(this.localizationName_=e.getAttribute(n.LOCALIZATION_NAME_MUTATION_KEY))}};function l(e){(0,o.setDuplicateOnDragStrategy)(e),(0,o.updateDuplicateOnDragState)(e)}i.Blocks[r.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:i.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_boolean"]}),this.typeName_="boolean",l(this)}}),i.Blocks[r.ARGUMENT_REPORTER_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:i.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_string"]}),this.typeName_="string",l(this)}}),i.Blocks[r.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:i.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_number"]}),this.typeName_="number",l(this)}}),i.Blocks[r.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:i.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_array"]}),this.typeName_="Array",l(this)}}),i.Blocks[r.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:i.Msg[s.MsgKey.REPORTERS_HUE],inputsInline:!0,outputShape:(new i.zelos.ConstantProvider).SHAPES.ROUND,output:null}),this.typeName_="",l(this)},mutationToDom(){const e=a.mutationToDom.call(this);return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_),a.domToMutation.call(this,e)}})},{"../../duplicateOnDrag":92,"../constants":106,"../msg":113,blockly:176}],102:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("../commonFunctionMixin"),s=e("../constants"),o=e("../utils"),a=e("../msg"),l=Object.assign(Object.assign({},r.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,n){let r=null,s=null;if(t&&e.id in t){const n=t[e.id];r=n.block,s=n.shadow}const o=null==r?void 0:r.workspace.connectionChecker;i.Events.disable();try{if(r&&!r.isDisposed()&&t&&(null==o?void 0:o.canConnectWithReason(null==r?void 0:r.outputConnection,n.connection,!1))===i.Connection.CAN_CONNECT){let o;r.outputConnection.connect(n.connection),o=r.isShadow()?i.Xml.blockToDom(r):s||this.buildShadowDom_(e.type),"variables_get"!==o.getAttribute("type")&&n.connection.setShadowDom(o),delete t[n.name]}else this.attachShadow_(n,e.type)}finally{i.Events.enable()}},afterWorkspaceLoad:function(){var e;for(const t of this.inputList){if(t.type!==i.inputs.inputTypes.VALUE)continue;const n=null===(e=t.connection)||void 0===e?void 0:e.targetBlock();n&&n.isShadow()&&n.getVarModels().length&&n.setShadow(!1);const r=t.connection&&t.getShadowDom();(0,o.isVariableBlockType)(null==r?void 0:r.getAttribute("type"))&&t.setShadowDom(null)}},addFunctionLabel_:function(e){this.appendDummyInput("function_name").appendField(new i.FieldLabel(e,"functionNameText"),"function_name")},updateFunctionLabel_:function(e){this.getField("function_name").setValue(e)},attachShadow_(e,t){const n=(0,o.getShadowBlockInfoFromType_)(t,this.workspace),r=n[0],s=n[1],a=n[2];i.Events.disable();let l=null;try{l=this.workspace.newBlock(r),l.setFieldValue(a,s),l.setShadow("variables_get"!==r),!this.isInsertionMarker()&&l instanceof i.BlockSvg&&(l.initSvg(),l.queueRender())}finally{i.Events.enable()}l&&(l.setShadow(!0),l.outputConnection.connect(e.connection))},buildShadowDom_(e){const t=i.utils.xml.createElement("shadow"),n=(0,o.getShadowBlockInfoFromType_)(e,this.workspace),r=n[0],s=n[1],a=n[2],l="variables_get"===r;t.setAttribute("type",r);const c=i.utils.xml.createElement("field");if(c.textContent=a,l){c.setAttribute("id",a);const e=this.workspace.getVariableMap().getVariableById(a);c.textContent=e?e.getName():""}return c.setAttribute("name",s),t.appendChild(c),t},onchange(e){var t;if(this.workspace&&!this.workspace.isFlyout)if(e.type==i.Events.BLOCK_CREATE&&-1!=(null===(t=e.ids)||void 0===t?void 0:t.indexOf(this.id))){const t=this.getName(),n=(0,o.getDefinition)(t,this.workspace);if(n){const e=n.getArguments().slice(),t=this.arguments_.slice();JSON.stringify(t)!==JSON.stringify(e)&&(0,o.mutateCallersAndDefinition)(n.getName(),this.workspace,n.mutationToDom()),this.functionId_=n.functionId_}else{i.Events.setGroup(e.group);const t=i.utils.xml.createElement("xml"),n=i.utils.xml.createElement("block");n.setAttribute("type",s.FUNCTION_DEFINITION_BLOCK_TYPE);const r=this.getRelativeToSurfaceXY(),o=r.x+i.config.snapRadius*(this.RTL?-1:1),a=r.y+2*i.config.snapRadius;n.setAttribute("x",o+""),n.setAttribute("y",a+"");const l=this.mutationToDom();n.appendChild(l),t.appendChild(n),i.Xml.domToWorkspace(t,this.workspace),i.Events.setGroup(!1)}}else if(e.type==i.Events.BLOCK_DELETE){const t=this.getName();(0,o.getDefinition)(t,this.workspace)||(i.Events.setGroup(e.group),this.dispose(!0),i.Events.setGroup(!1))}},serializeChangedInputs(e){const t=[],n=(0,o.getArgMap)(e,!0);for(const e of this.arguments_){if(n[e.id])continue;const i=this.getInput(e.id).connection,r=i.targetBlock();r.isShadow()?t.push({inputName:e.id,connectedShadow:i.getShadowState(!0)}):t.push({inputName:e.id,connectedBlock:r.id})}return t}});i.Blocks[s.FUNCTION_CALL_BLOCK_TYPE]=Object.assign(Object.assign({},l),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(i.Msg[a.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(i.Msg[a.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(i.Msg[a.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}}),i.Blocks[s.FUNCTION_CALL_OUTPUT_BLOCK_TYPE]=Object.assign(Object.assign({},l),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0,null),this.setOutputShape((new i.zelos.ConstantProvider).SHAPES.ROUND),this.setColour(i.Msg[a.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(i.Msg[a.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(i.Msg[a.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}})},{"../commonFunctionMixin":105,"../constants":106,"../msg":113,"../utils":115,blockly:176}],103:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.newFunctionMutation=void 0;const i=e("blockly"),r=e("../commonFunctionMixin"),s=e("../constants"),o=e("../utils"),a=e("../fields/fieldAutocapitalizeTextInput"),l=e("../functionManager"),c=e("../msg"),u=Object.assign(Object.assign({},r.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,n){const i=this.createArgumentEditor_(e.type,e.name);n.connection.connect(i.outputConnection)},addFunctionLabel_:function(e){const t=new a.FieldAutocapitalizeTextInput(e||"",void 0,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(t,"function_name")},updateFunctionLabel_:function(e){i.Events.disable(),this.getField("function_name").setValue(e),i.Events.enable()},createArgumentEditor_:function(e,t){let n;i.Events.disable();try{let r="";switch(e){case"boolean":r=s.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE;break;case"number":r=s.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE;break;case"string":r=s.ARGUMENT_EDITOR_STRING_BLOCK_TYPE;break;case"Array":r=s.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE;break;default:r=s.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE}n=r==s.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE?(0,o.createCustomArgumentEditor)(e,this.workspace):this.workspace.newBlock(r),n.setFieldValue(t,"TEXT"),n.setShadow(!0),!this.isInsertionMarker()&&n instanceof i.BlockSvg&&(n.initSvg(),n.queueRender())}finally{i.Events.enable()}return n},async focusLastEditorAsync_(){if(await i.renderManagement.finishQueuedRenders(),this.inputList.length>0){let e=this.inputList[this.inputList.length-2];if(e.type==i.inputs.inputTypes.DUMMY){const t=this.workspace;t instanceof i.WorkspaceSvg&&t.centerOnBlock(this.id,!0),e.fieldRow[0].showEditor()}else if(e.type==i.inputs.inputTypes.VALUE){const t=e.connection.targetBlock(),n=t.workspace;n instanceof i.WorkspaceSvg&&n.centerOnBlock(t.id,!0),t.getField("TEXT").showEditor()}}},removeFieldCallback(e){let t=null;for(let n=0;n<this.inputList.length&&!t;n++){let i=this.inputList[n];if(i.connection){let n=i.connection.targetBlock();if(!n)continue;n.getField(e.name)===e&&(t=i.name)}else for(let n=0;n<i.fieldRow.length;n++)i.fieldRow[n]==e&&(t=i.name)}t&&(i.WidgetDiv.hide(),this.removeInput(t),this.updateFunctionSignature(),this.updateDisplay_())},addParam_(e,t){i.WidgetDiv.hide();const n=(0,o.findUniqueParamName)(t,this.arguments_.map(e=>e.name));this.arguments_.push({id:i.utils.idGenerator.genUid(),name:n,type:e}),this.updateDisplay_(),this.focusLastEditorAsync_()},addBooleanExternal(){this.addParam_("boolean",i.Msg[c.MsgKey.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME])},addStringExternal(){this.addParam_("string",i.Msg[c.MsgKey.FUNCTIONS_DEFAULT_STRING_ARG_NAME])},addNumberExternal(){this.addParam_("number",i.Msg[c.MsgKey.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME])},addArrayExternal(){this.addParam_("Array",i.Msg[c.MsgKey.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME])},addCustomExternal(e){this.addParam_(e,l.FunctionManager.getInstance().getArgumentNameForType(e))},updateFunctionSignature(){this.arguments_=[];for(let e=1;e<this.inputList.length;e++){const t=this.inputList[e];switch(t.type){case i.inputs.inputTypes.STATEMENT:break;case i.inputs.inputTypes.DUMMY:this.name_=t.fieldRow[0].getValue()||t.fieldRow[0].getText();break;case i.inputs.inputTypes.VALUE:const e=t.connection.targetBlock();this.arguments_.push({id:t.name,name:e.getFieldValue("TEXT"),type:e.getTypeName()});break;default:pxt.warn("Unexpected input type on a function mutator root: "+t.type)}}}});n.newFunctionMutation=function(e){const t=(0,o.findLegalName)(i.Msg[c.MsgKey.FUNCTIONS_DEFAULT_FUNCTION_NAME],e),n=i.utils.xml.createElement("mutation");return n.setAttribute("name",t),n.setAttribute("functionid",i.utils.idGenerator.genUid()),n},i.Blocks[s.FUNCTION_DECLARATION_BLOCK_TYPE]=Object.assign(Object.assign({},u),{init:function(){this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(i.Msg[c.MsgKey.PROCEDURES_HUE]),this.setStatements_(!0),this.setDeletable(!1),this.setMovable(!1),this.contextMenu=!1,this.setInputsInline(!0)}})},{"../commonFunctionMixin":105,"../constants":106,"../fields/fieldAutocapitalizeTextInput":110,"../functionManager":111,"../msg":113,"../utils":115,blockly:176}],104:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("../commonFunctionMixin"),s=e("../constants"),o=e("../utils"),a=e("../fields/fieldAutocapitalizeTextInput"),l=e("../msg"),c=e("../functionManager"),u=e("../svgs"),d=e("../../duplicateOnDrag"),p=e("../../../fields/field_imagenotext"),h=Object.assign(Object.assign({},r.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,n){let i,r=null;if(null==t?void 0:t[e.id]){r=t[e.id].block}t&&r&&!r.isDisposed()?(i=r,i.setFieldValue(e.name,"VALUE"),delete t[n.name]):i=this.createArgumentReporter_(e),n.connection.connect(i.outputConnection)},afterWorkspaceLoad:function(){for(const e of this.inputList){if(e.type!==i.inputs.inputTypes.VALUE)continue;const t=this.arguments_.find(t=>t.id===e.name);if(!t)continue;let n=e.connection.targetBlock();n||(this.populateArgument_(t,null,e),n=e.connection.targetBlock()),n.setFieldValue(t.name,"VALUE"),n.isShadow()&&n.setShadow(!1),e.setShadowDom(null)}},addFunctionLabel_:function(e){const t=new a.FieldAutocapitalizeTextInput(e||"",o.rename,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(t,"function_name")},updateFunctionLabel_:function(e){i.Events.disable(),this.getField("function_name").setValue(e),i.Events.enable()},createArgumentReporter_:function(e){let t,n="";switch(e.type){case"boolean":n=s.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE;break;case"number":n=s.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE;break;case"string":n=s.ARGUMENT_REPORTER_STRING_BLOCK_TYPE;break;case"Array":n=s.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE;break;default:n=s.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}i.Events.disable();try{t=n==s.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE?(0,o.createCustomArgumentReporter)(e.type,this.workspace):this.workspace.newBlock(n),t.setFieldValue(e.name,"VALUE"),t.setShadow(!0),!this.isInsertionMarker()&&t instanceof i.BlockSvg&&(t.initSvg(),t.queueRender())}finally{i.Events.enable()}return t},customContextMenu:function(e){var t,n;this.isInFlyout||(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly)||(e.push(this.makeEditOption()),e.push(this.makeCallOption()))},makeEditOption:function(){var e,t;return{enabled:!(null===(t=null===(e=this.workspace)||void 0===e?void 0:e.options)||void 0===t?void 0:t.readOnly),text:i.Msg.FUNCTIONS_EDIT_OPTION,callback:()=>{!function(e){if(e.type==s.FUNCTION_CALL_BLOCK_TYPE||e.type==s.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){const t=e.workspace;e=(0,o.getDefinition)(e.getName(),t)}i.hideChaff(),i.getSelected()&&i.getSelected().unselect();c.FunctionManager.getInstance().editFunctionExternal(e.mutationToDom(),t=>{t&&((0,o.mutateCallersAndDefinition)(e.getName(),e.workspace,t),e.updateDisplay_()),setTimeout(()=>{e.afterWorkspaceLoad&&e.afterWorkspaceLoad()})})}(this)}}},makeCallOption:function(){var e,t;const n=this.getName(),r=i.utils.xml.createElement("mutation");r.setAttribute("name",n);const o=i.utils.xml.createElement("block");return o.appendChild(r),o.setAttribute("type",s.FUNCTION_CALL_BLOCK_TYPE),{enabled:this.workspace.remainingCapacity()>0&&!(null===(t=null===(e=this.workspace)||void 0===e?void 0:e.options)||void 0===t?void 0:t.readOnly),text:i.Msg.FUNCTIONS_CREATE_CALL_OPTION.replace("%1",n),callback:i.ContextMenu.callbackFactory(this,o)}}});i.Blocks[s.FUNCTION_DEFINITION_BLOCK_TYPE]=Object.assign(Object.assign({},h),{init:function(){if(this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(i.Msg[l.MsgKey.PROCEDURES_HUE]),this.setTooltip(i.Msg[l.MsgKey.PROCEDURES_DEFNORETURN_TOOLTIP]),this.setHelpUrl(i.Msg[l.MsgKey.PROCEDURES_DEFNORETURN_HELPURL]),this.setStatements_(!0),this.setInputsInline(!0),this.workspace.options.collapse){const e=u.COLLAPSE_IMAGE_DATAURI;this.appendDummyInput("function_collapse").appendField(new p.FieldImageNoText(e,24,24,"",()=>{this.setCollapsed(!0)},!1))}}}),(0,d.setDuplicateOnDrag)(s.FUNCTION_DEFINITION_BLOCK_TYPE)},{"../../../fields/field_imagenotext":38,"../../duplicateOnDrag":92,"../commonFunctionMixin":105,"../constants":106,"../fields/fieldAutocapitalizeTextInput":110,"../functionManager":111,"../msg":113,"../svgs":114,"../utils":115,blockly:176}],105:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.COMMON_FUNCTION_MIXIN=void 0;const i=e("blockly"),r=e("./constants"),s=e("./utils"),o=e("./msg");n.COMMON_FUNCTION_MIXIN={name_:"",functionId_:"",arguments_:[],mutationToDom:function(){this.ensureIds_();const e=i.utils.xml.createElement("mutation");return e.setAttribute("name",this.name_),e.setAttribute("functionid",this.functionId_),this.arguments_.forEach(function(t){const n=i.utils.xml.createElement("arg");n.setAttribute("name",t.name),n.setAttribute("id",t.id),n.setAttribute("type",t.type),e.appendChild(n)}),e},domToMutation:function(e){const t=[];for(let n=0;n<e.childNodes.length;++n){const i=e.childNodes[n];"arg"==i.nodeName.toLowerCase()&&t.push({id:i.getAttribute("id"),name:i.getAttribute("name"),type:i.getAttribute("type")})}this.arguments_=t,this.name_=e.getAttribute("name"),this.restoreSavedFunctionId(e.getAttribute("functionid"))},saveExtraState:function(){return{name:this.name_,functionid:this.functionId_,arguments:this.arguments_.slice()}},loadExtraState:function(e){this.arguments_=e.arguments.slice(),this.name_=e.name,this.restoreSavedFunctionId(e.functionid)},restoreSavedFunctionId:function(e){(0,s.idsInUse)(this.workspace).indexOf(e)<0&&(this.functionId_=e),this.ensureIds_();let t=null;this instanceof i.BlockSvg&&(t=this.getHeightWidth()),this.type!==r.FUNCTION_DEFINITION_BLOCK_TYPE||t&&!t.height&&!t.width?this.updateDisplay_():!this.getFieldValue("function_name")&&this.name_&&(this.setFieldValue(this.name_,"function_name"),this.updateDisplay_())},getName:function(){return this.name_},getFunctionId:function(){return this.functionId_},getArguments:function(){return this.arguments_},removeValueInputs_:function(){const e=[];for(let t,n=0;t=this.inputList[n];n++)t.type==i.inputs.inputTypes.VALUE?t.dispose():e.push(t);this.inputList=e},createAllInputs_:function(){let e=!1,t=!1;if(this.inputList.forEach(function(n){"function_title"==n.name?e=!0:"function_name"==n.name&&(t=!0)}),!e){let e="";switch(this.type){case r.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case r.FUNCTION_CALL_BLOCK_TYPE:e=i.Msg[o.MsgKey.FUNCTIONS_CALL_TITLE];break;case r.FUNCTION_DEFINITION_BLOCK_TYPE:case r.FUNCTION_DECLARATION_BLOCK_TYPE:e=i.Msg[o.MsgKey.FUNCTIONS_DEFNORETURN_TITLE]}this.appendDummyInput("function_title").appendField(e,"function_title")}t?this.updateFunctionLabel_(this.getName()):this.addFunctionLabel_(this.getName()),this.updateArgumentInputs_()},updateArgumentInputs_(){var e;for(const e of this.inputList)if(e.type===i.inputs.inputTypes.VALUE&&!this.arguments_.some(t=>t.id===e.name)){if(this.type===r.FUNCTION_DEFINITION_BLOCK_TYPE){const t=e.connection.targetBlock();t&&t.dispose()}this.removeInput(e.name)}let t=this.inputList.findIndex(e=>e.type===i.inputs.inputTypes.VALUE);-1===t&&(t=this.inputList.length);for(const n of this.arguments_){let i=this.inputList.find(e=>e.name===n.id);const r=!i;r&&(i=this.appendValueInput(n.id)),this.inputList.indexOf(i)!==t&&this.moveInputBefore(i.name,null===(e=this.inputList[t+1])||void 0===e?void 0:e.name),(0,s.isCustomType)(n.type)?i.setCheck(n.type):i.setCheck(n.type.charAt(0).toUpperCase()+n.type.slice(1)),!this.isInsertionMarker()&&r&&this.populateArgument_(n,void 0,i),t++}this.inputList.some(e=>"function_collapse"===e.name)&&this.moveInputBefore("function_collapse",null),this.hasStatements_&&this.moveInputBefore("STACK",null)},updateDisplay_:function(){let e=this.rendered;this.createAllInputs_(),e&&!this.isInsertionMarker()&&this instanceof i.BlockSvg&&(this.initSvg(),this.queueRender())},setStatements_:function(e){this.hasStatements_!==e&&(e?this.appendStatementInput("STACK"):this.removeInput("STACK",!0),this.hasStatements_=e)},ensureIds_:function(){switch(this.type){case r.FUNCTION_DEFINITION_BLOCK_TYPE:this.functionId_&&"null"!=this.functionId_||(this.functionId_=i.utils.idGenerator.genUid());for(let e=0;e<this.arguments_.length;++e)this.arguments_[e].id||(this.arguments_[e].id=i.utils.idGenerator.genUid());break;case r.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case r.FUNCTION_CALL_BLOCK_TYPE:const e=(0,s.getDefinition)(this.name_,this.workspace);if(e){this.functionId_=e.getFunctionId();const t=e.getArguments();for(let e=0;e<this.arguments_.length;++e)for(let n=0;n<t.length;++n)if(t[n].name==this.arguments_[e].name){this.arguments_[e].id=t[n].id;break}}}}}},{"./constants":106,"./msg":113,"./utils":115,blockly:176}],106:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE=n.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE=n.ARGUMENT_EDITOR_STRING_BLOCK_TYPE=n.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE=n.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE=n.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE=n.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE=n.ARGUMENT_REPORTER_STRING_BLOCK_TYPE=n.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE=n.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE=n.FUNCTION_CALL_OUTPUT_BLOCK_TYPE=n.FUNCTION_CALL_BLOCK_TYPE=n.FUNCTION_DECLARATION_BLOCK_TYPE=n.FUNCTION_DEFINITION_BLOCK_TYPE=void 0,n.FUNCTION_DEFINITION_BLOCK_TYPE="function_definition",n.FUNCTION_DECLARATION_BLOCK_TYPE="function_declaration",n.FUNCTION_CALL_BLOCK_TYPE="function_call",n.FUNCTION_CALL_OUTPUT_BLOCK_TYPE="function_call_output",n.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE="argument_reporter_boolean",n.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE="argument_reporter_number",n.ARGUMENT_REPORTER_STRING_BLOCK_TYPE="argument_reporter_string",n.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE="argument_reporter_array",n.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE="argument_reporter_custom",n.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE="argument_editor_boolean",n.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE="argument_editor_number",n.ARGUMENT_EDITOR_STRING_BLOCK_TYPE="argument_editor_string",n.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE="argument_editor_array",n.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE="argument_editor_custom"},{}],107:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("./utils"),s=e("./msg"),o=e("./svgs"),a=new i.zelos.ConstantProvider;const l={customContextMenu:function(e){var t,n;const o={enabled:!(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly),text:i.Msg[s.MsgKey.FUNCTIONS_GO_TO_DEFINITION_OPTION],callback:()=>{const e=this.getField("function_name").getText(),t=(0,r.getDefinition)(e,this.workspace);t&&this.workspace instanceof i.WorkspaceSvg&&this.workspace.centerOnBlock(t.id,!0)}};e.push(o)}},c={customContextMenu:function(e){if(this.isCollapsed())return;const t={text:i.Msg.RENAME_VARIABLE,enabled:!this.workspace.options.readOnly,callback:()=>{const e=this.workspace,t=this.getField("VAR").getVariable();i.Variables.renameVariable(e,t)}};if(e.unshift(t),!this.isInFlyout){const t=this.workspace.getVariableMap().getVariablesOfType("");for(const n of t){const t={enabled:!this.workspace.options.readOnly,text:n.getName(),callback:()=>{let e=this.getField("VAR");e||pxt.log("Tried to get a variable field on the wrong type of block."),e.setValue(n.getId())}};e.unshift(t)}}}};i.Extensions.registerMixin("function_contextmenu_edit",l),i.Extensions.registerMixin("contextMenu_variableReporter",c),i.Extensions.register("output_number",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"Number")}),i.Extensions.register("output_string",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"String")}),i.Extensions.register("output_boolean",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.HEXAGONAL),this.setOutput(!0,"Boolean")}),i.Extensions.register("output_array",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"Array")}),i.Extensions.register("text_field_color",function(){if(this.workspace instanceof i.WorkspaceSvg){const e=this.workspace.getRenderer().getConstants();this.setColour(e.FIELD_BORDER_RECT_COLOUR)}else this.setColour("#fff")}),i.Extensions.register("inline-svgs",function(){this.ADD_IMAGE_DATAURI=o.ADD_IMAGE_DATAURI,this.REMOVE_IMAGE_DATAURI=o.REMOVE_IMAGE_DATAURI})},{"./msg":113,"./svgs":114,"./utils":115,blockly:176}],108:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldArgumentEditor=void 0;const i=e("blockly"),r=e("../functionManager");class s extends i.FieldTextInput{constructor(e,t,n){super(e,t,n)}showEditor(e){var t,n;super.showEditor(e);const o=i.WidgetDiv.getDiv();o.className+=" argumentEditorInput";const a=document.createElement("img");a.setAttribute("class","argumentEditorRemoveIcon"),a.setAttribute("src",s.REMOVE_ARG_URI),this.removeButtonMouseWrapper_=i.browserEvents.conditionalBind(a,"mousedown",this,this.removeCallback),o.appendChild(a);const l=null===(t=this.sourceBlock_)||void 0===t?void 0:t.getTypeName();if(l&&(null===(n=this.sourceBlock_)||void 0===n?void 0:n.workspace)){const e=r.FunctionManager.getInstance().getIconForType(l);if(e){const t=e+" icon argumentEditorTypeIcon",n=document.createElement("i");n.className=t,o.appendChild(n)}}}removeCallback(){var e,t;const n=null===(e=this.sourceBlock_)||void 0===e?void 0:e.getParent();if(!n)return;let r;for(const e of n.inputList){if((null===(t=e.connection)||void 0===t?void 0:t.targetBlock())===this.sourceBlock_){r=e.name;break}}r&&(i.WidgetDiv.hide(),n.removeInput(r))}}n.FieldArgumentEditor=s,s.REMOVE_ARG_URI="data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='UTF-8' standalone='no'?%3e%3csvg width='20px' height='20px' viewBox='0 0 20 20' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3c!-- Generator: Sketch 48.1 (47250) - http://www.bohemiancoding.com/sketch --%3e%3ctitle%3edelete-argument v2%3c/title%3e%3cdesc%3eCreated with Sketch.%3c/desc%3e%3cdefs%3e%3c/defs%3e%3cg id='Page-1' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e%3cg id='delete-argument-v2' stroke='%23FF661A'%3e%3cg id='Group' transform='translate(3.000000, 2.500000)'%3e%3cpath d='M1,3 L13,3 L11.8900496,14.0995037 C11.8389294,14.6107055 11.4087639,15 10.8950124,15 L3.10498756,15 C2.59123611,15 2.16107055,14.6107055 2.10995037,14.0995037 L1,3 Z' id='Rectangle' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M7,11 L7,6' id='Line' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M9.5,11 L9.5,6' id='Line-Copy' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M4.5,11 L4.5,6' id='Line-Copy-2' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3crect id='Rectangle-2' fill='%23FF661A' x='0' y='2.5' width='14' height='1' rx='0.5'%3e%3c/rect%3e%3cpath d='M6,0 L8,0 C8.55228475,-1.01453063e-16 9,0.44771525 9,1 L9,3 L5,3 L5,1 C5,0.44771525 5.44771525,1.01453063e-16 6,0 Z' id='Rectangle-3' stroke-width='1.5'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",i.fieldRegistry.register("field_argument_editor",s),i.Css.register("\n\n.argumentEditorInput {\n    overflow: visible;\n}\n\n.functioneditor i.argumentEditorTypeIcon {\n    color: var(--pxt-target-foreground1);\n    position: absolute;\n    width: 24px;\n    height: 24px;\n    top: 40px;\n    left: 50%;\n    margin-left: -12px;\n}\n\n.argumentEditorRemoveIcon {\n    position: absolute;\n    width: 24px;\n    height: 24px;\n    top: -40px;\n    left: 50%;\n    margin-left: -12px;\n    cursor: pointer;\n}\n\n")},{"../functionManager":111,blockly:176}],109:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setArgumentReporterLocalizeFunction=n.FieldArgumentReporter=void 0;const i=e("blockly"),r=e("../utils");let s;class o extends i.FieldLabelSerializable{getDisplayText_(){const e=this.getSourceBlock();if(e&&(0,r.isFunctionArgumentReporter)(e)&&s){const t=s(this,e);if(t)return t}return super.getDisplayText_()}}n.FieldArgumentReporter=o,n.setArgumentReporterLocalizeFunction=function(e){s=e},i.registry.register(i.registry.Type.FIELD,"field_argument_reporter",o)},{"../utils":115,blockly:176}],110:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldAutocapitalizeTextInput=void 0;const i=e("blockly");class r extends i.FieldTextInput{constructor(e,t,n){super(e,t,n),this.disableAutocapitalize=!1}setAutocapitalize(e){this.disableAutocapitalize=!e,this.htmlInput_&&(this.disableAutocapitalize?this.htmlInput_.setAttribute("autocapitalize","none"):this.htmlInput_.removeAttribute("autocapitalize"))}configure_(e){super.configure_(e),void 0!==e.disableAutocapitalize&&(this.disableAutocapitalize=e.disableAutocapitalize)}widgetCreate_(){const e=super.widgetCreate_();return this.disableAutocapitalize&&e.setAttribute("autocapitalize","none"),e}}n.FieldAutocapitalizeTextInput=r,i.fieldRegistry.register("field_autocapitalize_text_input",r)},{blockly:176}],111:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FunctionManager=void 0;const i=e("blockly"),r=e("./msg");class s{constructor(){this.typeIcons={},this.typeArgumentNames={}}static getInstance(){return s.instance}getIconForType(e){return this.typeIcons[e]}setIconForType(e,t){this.typeIcons[e]=t}setArgumentNameForType(e,t){this.typeArgumentNames[e]=t}getArgumentNameForType(e){return this.typeArgumentNames[e]?this.typeArgumentNames[e]:i.Msg[r.MsgKey.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME]}setEditFunctionExternal(e){this._editFunctionExternal=e}editFunctionExternal(e,t){this._editFunctionExternal?this._editFunctionExternal(e,t):pxt.warn("External function editor must be overriden: Blockly.Functions.editFunctionExternalHandler",e,t)}}n.FunctionManager=s,s.instance=new s},{"./msg":113,blockly:176}],112:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.validateFunctionExternal=n.getAllFunctionDefinitionBlocks=n.getDefinition=n.flyoutCategory=void 0,r(e("./msg"),n),r(e("./extensions"),n),r(e("./fields/fieldArgumentEditor"),n),r(e("./fields/fieldArgumentReporter"),n),r(e("./fields/fieldAutocapitalizeTextInput"),n),r(e("./blocks/argumentEditorBlocks"),n),r(e("./blocks/argumentReporterBlocks"),n),r(e("./blocks/functionDeclarationBlock"),n),r(e("./blocks/functionDefinitionBlock"),n),r(e("./blocks/functionCallBlocks"),n),r(e("./functionManager"),n);var s=e("./utils");Object.defineProperty(n,"flyoutCategory",{enumerable:!0,get:function(){return s.flyoutCategory}}),Object.defineProperty(n,"getDefinition",{enumerable:!0,get:function(){return s.getDefinition}}),Object.defineProperty(n,"getAllFunctionDefinitionBlocks",{enumerable:!0,get:function(){return s.getAllFunctionDefinitionBlocks}}),Object.defineProperty(n,"validateFunctionExternal",{enumerable:!0,get:function(){return s.validateFunctionExternal}})},{"./blocks/argumentEditorBlocks":100,"./blocks/argumentReporterBlocks":101,"./blocks/functionCallBlocks":102,"./blocks/functionDeclarationBlock":103,"./blocks/functionDefinitionBlock":104,"./extensions":107,"./fields/fieldArgumentEditor":108,"./fields/fieldArgumentReporter":109,"./fields/fieldAutocapitalizeTextInput":110,"./functionManager":111,"./msg":113,"./utils":115}],113:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MsgKey=void 0;const i=e("blockly");var r;function s(e,t){i.Msg[e]||(i.Msg[e]=t)}!function(e){e.REPORTERS_HUE="REPORTERS_HUE",e.FUNCTIONS_CALL_TITLE="FUNCTIONS_CALL_TITLE",e.FUNCTIONS_DEFNORETURN_TITLE="FUNCTIONS_DEFNORETURN_TITLE",e.FUNCTIONS_GO_TO_DEFINITION_OPTION="FUNCTIONS_GO_TO_DEFINITION_OPTION",e.FUNCTION_CALL_TOOLTIP="FUNCTION_CALL_TOOLTIP",e.PROCEDURES_HUE="PROCEDURES_HUE",e.PROCEDURES_CALLNORETURN_HELPURL="PROCEDURES_CALLNORETURN_HELPURL",e.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME="FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME",e.FUNCTIONS_DEFAULT_STRING_ARG_NAME="FUNCTIONS_DEFAULT_STRING_ARG_NAME",e.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME="FUNCTIONS_DEFAULT_NUMBER_ARG_NAME",e.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME="FUNCTIONS_DEFAULT_ARRAY_ARG_NAME",e.PROCEDURES_DEFNORETURN_TOOLTIP="PROCEDURES_DEFNORETURN_TOOLTIP",e.PROCEDURES_DEFNORETURN_HELPURL="PROCEDURES_DEFNORETURN_HELPURL",e.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME="FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME",e.FUNCTIONS_DEFAULT_FUNCTION_NAME="FUNCTIONS_DEFAULT_FUNCTION_NAME",e.FUNCTION_CREATE_NEW="FUNCTION_CREATE_NEW",e.FUNCTION_FLYOUT_LABEL="FUNCTION_FLYOUT_LABEL",e.FUNCTIONS_EDIT_OPTION="FUNCTIONS_EDIT_OPTION",e.FUNCTIONS_CREATE_CALL_OPTION="FUNCTIONS_CREATE_CALL_OPTION"}(r=n.MsgKey||(n.MsgKey={})),s(r.REPORTERS_HUE,"#A80000"),s(r.FUNCTIONS_CALL_TITLE,"call"),s(r.FUNCTIONS_DEFNORETURN_TITLE,"function"),s(r.FUNCTIONS_GO_TO_DEFINITION_OPTION,"Go to Definition"),s(r.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME,"bool"),s(r.FUNCTIONS_DEFAULT_STRING_ARG_NAME,"text"),s(r.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME,"num"),s(r.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME,"array"),s(r.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME,"value"),s(r.FUNCTIONS_DEFAULT_FUNCTION_NAME,"doSomething"),s(r.FUNCTION_CREATE_NEW,"Make a Function"),s(r.FUNCTION_FLYOUT_LABEL,"Your Functions"),s(r.FUNCTIONS_EDIT_OPTION,"Edit Function"),s(r.FUNCTIONS_CREATE_CALL_OPTION,"Create 'call %1'")},{blockly:176}],114:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.REMOVE_IMAGE_DATAURI=n.ADD_IMAGE_DATAURI=n.COLLAPSE_IMAGE_DATAURI=void 0,n.COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",n.ADD_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJhZGQuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjQ4MjEiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NjkiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjEyLjkxNTI1NCIKICAgICBpbmtzY2FwZTpjeT0iMTYuMDY3Nzk2IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjAiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0icmVwZWF0IiAvPjxzdHlsZQogICAgIHR5cGU9InRleHQvY3NzIgogICAgIGlkPSJzdHlsZTMiPgoJLnN0MHtmaWxsOiNDRjhCMTc7fQoJLnN0MXtmaWxsOiNGRkZGRkY7fQo8L3N0eWxlPjx0aXRsZQogICAgIGlkPSJ0aXRsZTUiPnJlcGVhdDwvdGl0bGU+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMiCiAgICAgd2lkdGg9IjQuMDUwMDAwMiIKICAgICBoZWlnaHQ9IjEyLjM5NzA1IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSItMTguMTk4NTI2IgogICAgIHJ4PSIwLjgxIgogICAgIHJ5PSIwLjgxIgogICAgIHRyYW5zZm9ybT0ic2NhbGUoMSwtMSkiIC8+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMtMSIKICAgICB3aWR0aD0iNC4wNTAwMDAyIgogICAgIGhlaWdodD0iMTIuMzk3MTE5IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSI1LjgwMTQ0MDciCiAgICAgcng9IjAuODEiCiAgICAgcnk9IjAuODEiCiAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMCwxLDEsMCwwLDApIiAvPjxjaXJjbGUKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6I2ZmZmZmZjtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICBpZD0icGF0aDQxMzYiCiAgICAgY3g9IjEyIgogICAgIGN5PSIxMiIKICAgICByPSIxMC41MDMxOTEiIC8+PC9zdmc+",n.REMOVE_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJyZW1vdmUuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjFhZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NTAiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjAuMDUwODQ3NTIxIgogICAgIGlua3NjYXBlOmN5PSI5Ljk2NjEwMTciCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJyZXBlYXQiIC8+PHN0eWxlCiAgICAgdHlwZT0idGV4dC9jc3MiCiAgICAgaWQ9InN0eWxlMyI+Cgkuc3Qwe2ZpbGw6I0NGOEIxNzt9Cgkuc3Qxe2ZpbGw6I0ZGRkZGRjt9Cjwvc3R5bGU+PHRpdGxlCiAgICAgaWQ9InRpdGxlNSI+cmVwZWF0PC90aXRsZT48cmVjdAogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eTowLjA3ODQzMTM3IgogICAgIGlkPSJyZWN0NDE0My0xIgogICAgIHdpZHRoPSI0LjA1MDAwMDIiCiAgICAgaGVpZ2h0PSIxMi4zOTcxMTkiCiAgICAgeD0iOS45NzUwMDA0IgogICAgIHk9IjUuODAxNDQwNyIKICAgICByeD0iMC44MSIKICAgICByeT0iMC44MSIKICAgICB0cmFuc2Zvcm09Im1hdHJpeCgwLDEsMSwwLDAsMCkiIC8+PGNpcmNsZQogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTojZmZmZmZmO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgIGlkPSJwYXRoNDEzNiIKICAgICBjeD0iMTIiCiAgICAgY3k9IjEyIgogICAgIHI9IjEwLjUwMzE5MSIgLz48L3N2Zz4="},{}],115:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isVariableBlockType=n.validateFunctionExternal=n.flyoutCategory=n.getShadowBlockInfoFromType_=n.findUniqueParamName=n.getArgumentReporterParent=n.doArgumentReporterDragChecks=n.isFunctionArgumentReporter=n.getArgMap=n.mutateCallersAndDefinition=n.idsInUse=n.findLegalName=n.createCustomArgumentEditor=n.createCustomArgumentReporter=n.isCustomType=n.getAllFunctionDefinitionBlocks=n.getDefinition=n.rename=void 0;const i=e("blockly"),r=e("./constants"),s=e("./functionManager"),o=e("./msg"),a=e("./blocks/functionDeclarationBlock"),l=e("../../compiler/util"),c=e("../../loader");function u(e,t){for(const n of t.getTopBlocks(!1))if(n.type===r.FUNCTION_DEFINITION_BLOCK_TYPE){const t=n;if(t.getName()===e)return t}return null}function d(e){return e.getTopBlocks(!1).filter(e=>e.type===r.FUNCTION_DEFINITION_BLOCK_TYPE)}function p(e,t,n){const r=n.newBlock(e),s=i.utils.xml.createElement("mutation");return s.setAttribute("typename",t),r.domToMutation(s),r}function h(e,t,n){if(null==n?void 0:n.isInFlyout)return e;const i=f(t,n);for(;i[e];)e=m(e);return e}function f(e,t,n){const i={};return e.getVariableMap().getAllVariables().forEach(function(e){i[e.getName()]=!0}),e.getAllBlocks(!1).forEach(function(e){const s=e;s==t||n&&s.getFunctionId&&s.getFunctionId()==n||(s.type==r.FUNCTION_DEFINITION_BLOCK_TYPE?i[s.getName()]=!0:"procedures_defreturn"==e.type||e.type)}),i}function m(e){const t=e.match(/^(.*?)(\d+)$/);return t?e=t[1]+(parseInt(t[2],10)+1):e+="2",e}function g(e,t,n){const s=u(e,t);if(s){const o=s.mutationToDom(),a=_(o,!1),l=_(n,!0),c=[];for(const e of s.getDescendants(!1)){if(!y(e))continue;const t=b(e,e);if(t&&t!==s)continue;const n=e.getFieldValue("VALUE"),i=l[a[n]];if(n===i)continue;const r=e.outputConnection.targetBlock().id,o=e.outputConnection.targetConnection.getParentInput().name;c.push({id:e.id,type:e.type,oldName:n,newName:i,targetBlockId:r,targetInputName:o})}const u=function(e,t){const n=[];for(const i of t.getAllBlocks(!1))if(i.type===r.FUNCTION_CALL_BLOCK_TYPE||i.type===r.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){const t=i;t.getName()===e&&n.push(t)}return n}(e,s.workspace).map(e=>({id:e.id,oldMutation:i.utils.xml.domToText(e.mutationToDom()),shadows:e.serializeChangedInputs(n)})),d=new T(s.id,u,i.Xml.domToText(o),i.Xml.domToText(n),c);d.workspaceId=t.id,d.run(!0),i.Events.fire(d)}else pxt.warn("Attempted to change function "+e+", but no definition block was found on the workspace")}function _(e,t){const n={};for(let i=0;i<e.childNodes.length;++i){const r=e.childNodes[i],s=t?r.getAttribute("id"):r.getAttribute("name"),o=t?r.getAttribute("name"):r.getAttribute("id");n[s]=o}return n}function y(e){return e.type==r.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE||e.type==r.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE||e.type==r.ARGUMENT_REPORTER_STRING_BLOCK_TYPE||e.type==r.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE||e.type==r.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}function b(e,t){pxt.U.assert(y(e));const n=e.getFieldValue("VALUE"),i=e.getTypeName();for(;t.getSurroundParent();){t=t.getSurroundParent();for(const e of t.inputList){if(!e.connection||!e.name.startsWith(c.DRAGGABLE_PARAM_INPUT_PREFIX))continue;if(e.name.slice(c.DRAGGABLE_PARAM_INPUT_PREFIX.length)!==n)continue;let r=i;return"string"!==r&&"number"!==r&&"boolean"!==r||(r=r.charAt(0).toUpperCase()+r.slice(1)),-1!==e.connection.getCheck().indexOf(r)?t:void 0}}if(!t.isEnabled())return t;if((0,l.isFunctionDefinition)(t)){if(t.getArguments().some(e=>e.name===n&&e.type===i))return t}}function v(e,t){return!t||-1==t.indexOf(e)}n.rename=function(e){e=e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");const t=this.sourceBlock_,n=h(e,t.workspace,t),i=this.getValue();if(!e)return i;if(!n)return e;if(!i)return t.name_=n,n;if(i!=e&&i!=n){t.name_=n;const e=t.mutationToDom();t.name_=i,g(i,t.workspace,e)}return n},n.getDefinition=u,n.getAllFunctionDefinitionBlocks=d,n.isCustomType=function(e){return!("boolean"==e||"string"==e||"number"==e)},n.createCustomArgumentReporter=function(e,t){return p(r.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE,e,t)},n.createCustomArgumentEditor=function(e,t){return p(r.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE,e,t)},n.findLegalName=h,n.idsInUse=function(e){const t=[];return e.getAllBlocks(!1).forEach(function(e){e.type==r.FUNCTION_DEFINITION_BLOCK_TYPE&&t.push(e.getFunctionId())}),t},n.mutateCallersAndDefinition=g,n.getArgMap=_,n.isFunctionArgumentReporter=y,n.doArgumentReporterDragChecks=function(e,t,n){const i=e.getSourceBlock();if(!y(i))return!0;const r=t.getSourceBlock();return!r||!!b(i,r)},n.getArgumentReporterParent=b,n.findUniqueParamName=function(e,t){for(;!v(e,t);)e=m(e);return e},n.getShadowBlockInfoFromType_=function(e,t){let n="",r="",o="";switch(e){case"boolean":n="logic_boolean",r="BOOL",o="TRUE";break;case"number":n="math_number",r="NUM",o="1";break;case"string":n="text",r="TEXT",o="abc";break;case"Array":n="variables_get",r="VAR",o=i.Variables.getOrCreateVariablePackage(t,null,"list","").getId();break;default:n="variables_get",r="VAR",o=i.Variables.getOrCreateVariablePackage(t,null,s.FunctionManager.getInstance().getArgumentNameForType(e),"").getId()}return[n,r,o]},n.flyoutCategory=function(e){const t=[],n=document.createElement("button"),l=i.Msg[o.MsgKey.FUNCTION_CREATE_NEW],c="CREATE_FUNCTION";n.setAttribute("text",l),n.setAttribute("callbackKey",c),e.registerButtonCallback(c,()=>{!function(e){i.hideChaff(),i.getSelected()&&i.getSelected().unselect();s.FunctionManager.getInstance().editFunctionExternal((0,a.newFunctionMutation)(e),function(e){return function(t){if(t){const n='<xml><block type="'+r.FUNCTION_DEFINITION_BLOCK_TYPE+'">'+i.Xml.domToText(t)+"</block></xml>",s=i.utils.xml.textToDom(n);i.Events.setGroup(!0);const o=i.Xml.domToBlock(s.firstChild,e);if(o.updateDisplay_(),e.getMetrics){const t=e.getMetrics(),n=o.getHeightWidth();o.moveBy(t.viewLeft+t.viewWidth/2-n.width/2,t.viewTop+t.viewHeight/2-n.height/2),o.scheduleSnapAndBump()}e.centerOnBlock(o.id,!0),i.Events.setGroup(!1),setTimeout(()=>{o.afterWorkspaceLoad&&o.afterWorkspaceLoad()})}}}(e))}(e)}),t.push(n);for(const n of d(e)){const e=n.getName(),r=n.getArguments(),s=i.utils.xml.createElement("block");s.setAttribute("type","function_call"),s.setAttribute("gap","16");const o=i.utils.xml.createElement("mutation");o.setAttribute("name",e),s.appendChild(o);for(let e=0;e<r.length;e++){const t=i.utils.xml.createElement("arg");t.setAttribute("name",r[e].name),t.setAttribute("type",r[e].type),t.setAttribute("id",r[e].id),o.appendChild(t)}t.push(s)}return t},n.validateFunctionExternal=function(e,t){const n=e.getAttribute("name");if(!n)return i.dialog.alert(i.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;const r={};for(let t=0;t<e.childNodes.length;++t){const n=e.childNodes[t].getAttribute("name");if(!n)return i.dialog.alert(i.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;if(r[n])return i.dialog.alert(i.Msg.FUNCTION_WARNING_DUPLICATE_ARG),!1;r[n]=!0}return r[n]?(i.dialog.alert(i.Msg.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME),!1):!f(t,null,e.getAttribute("functionid"))[n]||(i.dialog.alert(i.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",n)),!1)},n.isVariableBlockType=function(e){switch(e){case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":case"variables_get_reporter":case"variables_get":return!0}return!1};class T extends i.Events.Abstract{constructor(e,t,n,i,r){super(),this.definition=e,this.callers=t,this.oldMutation=n,this.newMutation=i,this.descendantChanges=r,this.type="pxt_mutate_function"}static fromJson(e,t,n){const i=n=super.fromJson(e,t,n||new T(e.definition,e.callers,e.oldMutation,e.newMutation,e.descendantChanges));return i.definition=e.definition,i.callers=e.callers,i.oldMutation=e.oldMutation,i.newMutation=e.newMutation,i.descendantChanges=e.descendantChanges,n}toJson(){return{type:this.type,group:this.group,definition:this.definition,callers:this.callers,oldMutation:this.oldMutation,newMutation:this.newMutation,descendantChanges:this.descendantChanges}}run(e){const t=this.getEventWorkspace_(),n=i.utils.xml.textToDom(e?this.newMutation:this.oldMutation),r=t.getBlockById(this.definition);i.Events.disable(),r.domToMutation(n),r.updateArgumentInputs_(),r.afterWorkspaceLoad();for(const r of this.callers){const s=t.getBlockById(r.id);if(e)s.domToMutation(n);else{s.domToMutation(i.utils.xml.textToDom(r.oldMutation));for(const e of r.shadows)if(e.connectedBlock){const n=t.getBlockById(e.connectedBlock);s.getInput(e.inputName).connection.connect(n.outputConnection)}else s.getInput(e.inputName).connection.setShadowState(e.connectedShadow)}}for(const n of this.descendantChanges)if(n.newName){t.getBlockById(n.id).setFieldValue(e?n.newName:n.oldName,"VALUE")}else if(e){const e=t.getBlockById(n.id);e&&e.dispose()}else{const e=t.newBlock(n.type,n.id);e.setFieldValue(n.oldName,"VALUE"),e.initSvg();const i=t.getBlockById(n.targetBlockId).getInput(n.targetInputName).connection,r=i.targetBlock();r&&(r.isShadow()||r.dispose()),i.connect(e.outputConnection)}i.Events.enable()}}},{"../../compiler/util":15,"../../loader":77,"./blocks/functionDeclarationBlock":103,"./constants":106,"./functionManager":111,"./msg":113,blockly:176}],116:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly");i.Extensions.unregister("logic_compare"),i.Extensions.register("logic_compare",function(){})},{blockly:176}],117:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("../../fields/field_imagenotext"),s={elseifCount_:0,elseCount_:0,valueConnections_:[],statementConnections_:[],elseStatementConnection_:null,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=i.utils.xml.createElement("mutation");return this.elseifCount_&&e.setAttribute("elseif",this.elseifCount_+""),this.elseCount_&&e.setAttribute("else","1"),e},domToMutation:function(e){e&&(this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_())},storeConnections_:function(e){e||(e=0),this.valueConnections_=[null],this.statementConnections_=[null],this.elseStatementConnection_=null;for(let t=1;t<=this.elseifCount_;t++)e!=t&&(this.valueConnections_.push(this.getInput("IF"+t).connection.targetConnection),this.statementConnections_.push(this.getInput("DO"+t).connection.targetConnection));this.getInput("ELSE")&&(this.elseStatementConnection_=this.getInput("ELSE").connection.targetConnection)},restoreConnections_:function(){var e,t;for(let t=1;t<=this.elseifCount_;t++)this.reconnectValueConnection_(t,this.valueConnections_),null===(e=this.statementConnections_[t])||void 0===e||e.reconnect(this,"DO"+t);this.getInput("ELSE")&&(null===(t=this.elseStatementConnection_)||void 0===t||t.reconnect(this,"ELSE"))},addElse_:function(){this.update_(()=>{this.elseCount_++})},removeElse_:function(){this.update_(()=>{this.elseCount_--})},addElseIf_:function(){this.update_(()=>{this.elseifCount_++})},removeElseIf_:function(e){this.update_(()=>{this.elseifCount_--},e)},update_:function(e,t){i.Events.setGroup(!0),this.storeConnections_(t);const n=this,r=n.mutationToDom(),s=r&&i.Xml.domToText(r);e&&e.call(this),this.updateShape_(),n instanceof i.BlockSvg&&n.initSvg();const o=i.Events.getGroup(),a=n.mutationToDom(),l=a&&i.Xml.domToText(a);s!=l&&(i.Events.fire(new i.Events.BlockChange(n,"mutation",null,s,l)),setTimeout(function(){i.Events.setGroup(o),n.bumpNeighbours(),i.Events.setGroup(!1)},i.config.bumpDelay)),n.rendered&&n instanceof i.BlockSvg&&n.queueRender(),this.restoreConnections_(),i.Events.setGroup(!1)},updateShape_:function(){this.getInput("ELSE")&&(this.removeInput("ELSE"),this.removeInput("ELSETITLE"),this.removeInput("ELSEBUTTONS"));let e=1;for(;this.getInput("IF"+e);)this.removeInput("IF"+e),this.removeInput("IFTITLE"+e),this.removeInput("IFBUTTONS"+e),this.removeInput("DO"+e),e++;for(let e=1;e<=this.elseifCount_;e++){const n=function(e){return function(){t.removeElseIf_(e)}}(e);this.appendValueInput("IF"+e).setCheck("Boolean").appendField(i.Msg.CONTROLS_IF_MSG_ELSEIF).setShadowDom(o()),this.appendDummyInput("IFTITLE"+e).appendField(i.Msg.CONTROLS_IF_MSG_THEN),this.appendDummyInput("IFBUTTONS"+e).appendField(new r.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",n,!1)).setAlign(i.inputs.Align.RIGHT),this.appendStatementInput("DO"+e)}this.elseCount_&&(this.appendDummyInput("ELSETITLE").appendField(i.Msg.CONTROLS_IF_MSG_ELSE),this.appendDummyInput("ELSEBUTTONS").setAlign(i.inputs.Align.RIGHT).appendField(new r.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",this.removeElse_.bind(this),!1)),this.appendStatementInput("ELSE")),this.getInput("ADDBUTTON")&&this.removeInput("ADDBUTTON");const t=this,n=function(){0==t.elseCount_?t.addElse_():(t.elseifCount_||(t.elseifCount_=0),t.addElseIf_())};this.appendDummyInput("ADDBUTTON").appendField(new r.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",n,!1))},rebuildShape_:function(){const e=[null],t=[null];let n=null;this.getInput("ELSE")&&(n=this.getInput("ELSE").connection.targetConnection);let i=1;for(;this.getInput("IF"+i);){const n=this.getInput("IF"+i),r=this.getInput("DO"+i);e.push(n.connection.targetConnection),t.push(r.connection.targetConnection),i++}this.updateShape_(),this.reconnectChildBlocks_(e,t,n)},reconnectChildBlocks_:function(e,t,n){var i;for(let n=1;n<=this.elseifCount_;n++)this.reconnectValueConnection_(n,e),null===(i=t[n])||void 0===i||i.reconnect(this,"DO"+n);null==n||n.reconnect(this,"ELSE")},reconnectValueConnection_:function(e,t){var n;const i=null===(n=this.getInput("IF"+e))||void 0===n?void 0:n.connection.targetBlock();t[e]&&(t[e].reconnect(this,"IF"+e),i&&!i.getParent()&&i.dispose())}};function o(){const e=document.createElement("shadow");e.setAttribute("type","logic_boolean");const t=document.createElement("field");return t.setAttribute("name","BOOL"),t.textContent="FALSE",e.appendChild(t),e}i.Blocks.controls_if=Object.assign(Object.assign({},s),{init(){if(i.Extensions.apply("inline-svgs",this,!1),this.elseifCount_=0,this.elseCount_=0,this.setHelpUrl(i.Msg.CONTROLS_IF_HELPURL),this.appendValueInput("IF0").setCheck("Boolean").appendField(i.Msg.CONTROLS_IF_MSG_IF),this.appendDummyInput("THEN0").appendField(i.Msg.CONTROLS_IF_MSG_THEN),this.appendStatementInput("DO0"),this.workspace instanceof i.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(e.getConstants().SHAPES.HEXAGONAL)}this.updateShape_(),this.setInputsInline(!0),this.setColour(i.Msg.LOGIC_HUE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(()=>this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?i.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?i.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?i.Msg.CONTROLS_IF_TOOLTIP_4:"":i.Msg.CONTROLS_IF_TOOLTIP_1)}})},{"../../fields/field_imagenotext":38,blockly:176}],118:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./extensions"),n),r(e("./ifElse"),n)},{"./extensions":116,"./ifElse":117}],119:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSlider=void 0;const i=e("blockly");class r extends i.FieldNumber{constructor(e,t,n,i,r,s,o,a){super(e,t,n,i,o,a),this.keyboardControlActive=!1,"string"==typeof r?this.step_=parseFloat(r):"number"==typeof r&&(this.step_=r),this.labelText_=s}hasMin(){return this.getMin()>-1/0}hasMax(){return this.getMax()<1/0}getStep(){return this.step_}getLabel(){return this.labelText_}setLabel(e){this.labelText_=e}setOptions(e,t,n,i){this.setConstraints(e,t,i),this.step_=parseFloat(n)||void 0}getFieldDescription(){return this.getValue()+""}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=`${e}`).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);if(isNaN(t))return null;this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_);let n=String(this.precision_);-1!==n.indexOf("e")&&(n=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const i=n.indexOf(".");let r;return r=-1===i?this.precision_?0:null:n.length-i-1,null!==r&&(t=Number(t.toFixed(r))),t}widgetDispose_(){this.removeEventListeners(),super.widgetDispose_()}addEventListeners(){this.inputKeydownHandler=this.inputKeydownListener.bind(this),this.htmlInput_.addEventListener("keydown",this.inputKeydownHandler),this.sliderKeydownHandler=this.sliderKeydownListener.bind(this),this.slider_.addEventListener("keydown",this.sliderKeydownHandler),this.sliderBlurHandler=this.sliderBlurListener.bind(this),this.slider_.addEventListener("blur",this.sliderBlurHandler),this.sliderPointerdownHandler=this.sliderPointerdownListener.bind(this),this.slider_.addEventListener("pointerdown",this.sliderPointerdownHandler)}removeEventListeners(){this.htmlInput_.removeEventListener("keydown",this.inputKeydownHandler),this.slider_.removeEventListener("keydown",this.sliderKeydownHandler),this.slider_.removeEventListener("blur",this.sliderBlurHandler),this.slider_.removeEventListener("pointerdown",this.sliderPointerdownHandler)}inputKeydownListener(e){"ArrowDown"===e.key&&(e.preventDefault(),this.keyboardControlActive=!0,this.slider_.focus())}sliderPointerdownListener(e){this.keyboardControlActive=!1}sliderKeydownListener(e){switch(e.key){case"ArrowUp":e.preventDefault(),this.htmlInput_.focus();break;case"Enter":case" ":e.preventDefault(),e.stopPropagation(),i.hideChaff()}}sliderBlurListener(e){this.keyboardControlActive=!1}showEditor_(e,t){super.showEditor_(e,!0),i.DropDownDiv.hideWithoutAnimation(),i.DropDownDiv.clearContent(),i.DropDownDiv.getContentDiv().style.height="";const n=i.DropDownDiv.getContentDiv();n.setAttribute("role","menu"),n.setAttribute("aria-haspopup","true"),this.addSlider_(n),i.DropDownDiv.setColour("#ffffff","#dddddd"),i.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,void 0,void 0,!1),this.addEventListeners(),t||(this.htmlInput_.focus(),this.htmlInput_.select())}addSlider_(e){if(this.labelText_){let t=this.createLabelDom_(this.labelText_);e.appendChild(t[0]),this.readout_=t[1],this.setReadout(this.value_)}this.slider_=this.createSlider(),e.appendChild(this.slider_);const t=()=>{pxt.BrowserUtils.isFirefox()||this.keyboardControlActive||this.htmlInput_.focus()};i.browserEvents.bind(this.slider_,"input",this,e=>{const n=parseFloat(this.slider_.value)||0;if(null!==n){this.setValue(n);const e=this.htmlInput_;e&&(e.value=n+"",t())}}),i.browserEvents.bind(this.slider_,"focus",this,e=>{t()})}setValue(e,t){super.setValue(e,t),this.updateDom(),this.slider_&&(this.slider_.value=this.getValue()+"")}createSlider(){const e=document.createElement("input");let t;return e.setAttribute("class","blocklyFieldSlider"),e.type="range",e.min=this.getMin()+"",e.max=this.getMax()+"",e.value=this.getValue()+"",this.sourceBlock_ instanceof i.BlockSvg&&("#ffffff"===this.sourceBlock_.getColour()?this.sourceBlock_.getParent()&&(t=this.sourceBlock_.getParent().getColourTertiary()):t=this.sourceBlock_.getColourTertiary()),t&&e.setAttribute("style",`--blocklyFieldSliderBackgroundColor: ${t}`),Number.isNaN(this.step_)||(e.step=this.step_+""),e}updateDom(){this.setReadout(this.getValue())}setReadout(e){this.readout_&&(this.readout_.innerText=e+"")}createLabelDom_(e){const t=document.createElement("div");t.setAttribute("class","blocklyFieldSliderLabel");const n=document.createElement("span");n.setAttribute("class","blocklyFieldSliderReadout");const i=document.createElement("span");return i.setAttribute("class","blocklyFieldSliderLabelText"),i.innerText=e,t.appendChild(i),t.appendChild(n),[t,n]}}n.FieldSlider=r,i.fieldRegistry.register("field_slider",r),i.Css.register('\n:root {\n    --blocklyFieldSliderBackgroundColor: #547AB2;\n}\n.blocklyFieldSliderLabel {\n    font-family: "Helvetica Neue", "Segoe UI", Helvetica, sans-serif;\n    font-size: 0.65rem;\n    color: $colour_toolboxText;\n    margin: 8px;\n}\n.blocklyFieldSliderLabelText {\n    font-weight: bold;\n}\n.blocklyFieldSliderReadout {\n    margin-left: 10px;\n}\n\ninput[type=range].blocklyFieldSlider {\n    -webkit-appearance: none;\n    width: 100%;\n}\ninput[type=range].blocklyFieldSlider:focus {\n    outline: none;\n}\ninput[type=range].blocklyFieldSlider::-webkit-slider-runnable-track {\n    -webkit-appearance: none;\n    margin: 8px;\n    height: 22px;\n    width: 150px;\n    outline: none;\n    border-radius: 11px;\n    margin-bottom: 20px;\n    background: var(--blocklyFieldSliderBackgroundColor);\n}\ninput[type=range].blocklyFieldSlider::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 26px;\n    height: 26px;\n    margin-top: -1px;\n    background-color: white;\n    border-radius: 100%;\n    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    cursor: pointer;\n}\ninput[type=range].blocklyFieldSlider:focus-visible::-webkit-slider-thumb {\n    outline: 2px solid white; \n    outline-offset: 3px;\n    -webkit-box-shadow: 0 0 0 3px var(--pxt-focus-border);\n    -moz-box-shadow: 0 0 0 3px var(--pxt-focus-border);\n    box-shadow: 0 0 0 3px var(--pxt-focus-border);\n}\ninput[type=range].blocklyFieldSlider::-moz-range-track {\n    margin: 8px;\n    height: 22px;\n    width: 95%;\n    outline: none;\n    border-radius: 11px;\n    margin-bottom: 20px;\n    background: #547AB2;\n}\ninput[type=range].blocklyFieldSlider::-moz-range-thumb {\n    width: 26px;\n    height: 26px;\n    margin-top: -1px;\n    background-color: white;\n    border-radius: 100%;\n    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    cursor: pointer;\n}\n')},{blockly:176}],120:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./fieldSlider"),n),r(e("./numberBlocks"),n)},{"./fieldSlider":119,"./numberBlocks":121}],121:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=new i.zelos.ConstantProvider;i.defineBlocksWithJsonArray([{type:"math_integer",message0:"%1",args0:[{type:"field_number",name:"NUM",precision:1}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_whole_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0,precision:1}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_positive_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_number_minmax",message0:"%1",args0:[{type:"field_slider",name:"SLIDER",value:0,step:1,labelText:"Number"}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",mutator:"math_number_minmax_mutator",extensions:["parent_tooltip_when_inline"]}]);const s={mutationToDom:function(){const e=this.inputList[0].fieldRow[0];let t=i.utils.xml.createElement("mutation");return e.hasMin()&&t.setAttribute("min",e.getMin()+""),e.hasMax()&&t.setAttribute("max",e.getMax()+""),null!=e.getLabel()&&t.setAttribute("label",e.getLabel()),null!=e.getStep()&&t.setAttribute("step",e.getStep()+""),null!=e.getPrecision()&&t.setAttribute("precision",e.getPrecision()+""),t},domToMutation:function(e){const t=this.inputList[0].fieldRow[0],n=e.getAttribute("min"),i=e.getAttribute("max"),r=e.getAttribute("step"),s=e.getAttribute("label"),o=e.getAttribute("precision");t.setLabel(s),t.setOptions(n,i,r,o)}};i.Extensions.registerMutator("math_number_minmax_mutator",s)},{blockly:176}],122:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.showEditorMixin=void 0;const i=e("blockly"),r=e("../../fields");n.showEditorMixin=function(e){const t=this.getSourceBlock();if(!t)throw new i.UnattachedFieldError;const n=new i.Menu;n.setRole(i.utils.aria.Role.LISTBOX),this.menu_=n;const o=this.getOptions(!1);let a=null;const l=e=>{i.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)};for(let e=0;e<o.length;e++){const[c,u]=o[e];if("SEPARATOR"===u){const e=new s("");n.addChild(e);continue}const d=(()=>{if((0,r.isImageProperties)(c)){const e=new Image(c.width,c.height);return e.src=c.src,e.alt=c.alt||"",e}return c})(),p=new i.MenuItem(d,u);p.setRole(i.utils.aria.Role.OPTION),p.setRightToLeft(t.RTL),p.setCheckable(!0),n.addChild(p),p.setChecked(u===this.value_),p.onAction(l,this),u===this.value_&&(a=p)}e&&"number"==typeof e.clientX?this.menu_.openingCoords=new i.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,i.DropDownDiv.clearContent(),i.DropDownDiv.getContentDiv().style.height="";const c=this.menu_.render(i.DropDownDiv.getContentDiv());if(i.utils.dom.addClass(c,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){const e=t.getColour(),n=this.sourceBlock_.style.colourTertiary;i.DropDownDiv.setColour(e,n)}i.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),i.DropDownDiv.getContentDiv().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),a&&this.menu_.setHighlighted(a),this.applyColour()};class s extends i.MenuItem{createDom(){const e=document.createElement("div");return e.id=i.utils.idGenerator.getNextUniqueId(),this.element_=e,e.className="blockly-menuseparator",e.setAttribute("role","separator"),e}getElement(){return this.element_}getId(){return this.element_.id}isEnabled(){return!1}}i.Css.register("\n.blockly-menuseparator {\n    border-top: 1px solid rgba(0, 0, 0, 0.2);\n    margin: 4px 0;\n    padding: 0;\n}\n")},{"../../fields":70,blockly:176}],123:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldVariable=void 0;const i=e("blockly"),r=e("./fieldDropdownMixin");class s extends i.FieldVariable{constructor(e,t,n,i,r){super(e,t,n,i,r),this.svgRootBinding=null,this.fieldRootBinding=null,this.menuGenerator_=s.dropdownCreate}static dropdownCreate(){const e=i.FieldVariable.dropdownCreate.call(this),t=e.findIndex(e=>"RENAME_VARIABLE_ID"===e[1]);return e.splice(t,0,[i.Msg.NEW_VARIABLE_DROPDOWN,s.CREATE_VARIABLE_ID],[void 0,"SEPARATOR"]),e}onItemSelected_(e,t){if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(t.getValue()===s.CREATE_VARIABLE_ID)return void i.Variables.createVariableButtonHandler(this.sourceBlock_.workspace,e=>{const t=this.sourceBlock_.workspace.getVariableMap().getVariable(e);t&&this.setValue(t.getId())})}super.onItemSelected_(e,t)}initView(){super.initView(),this.shouldAddBorderRect_()||(this.createBorderRect_(),this.clickTargetRect=this.borderRect_,this.clickTargetRect.setAttribute("stroke-opacity","0"),this.clickTargetRect.setAttribute("fill-opacity","0"),this.borderRect_=void 0)}shouldAddBorderRect_(){if("variables_get"===this.sourceBlock_.type)return!1;for(const e of this.sourceBlock_.inputList)for(const t of e.fieldRow)if(t!==this&&t.EDITABLE)return!0;return!this.sourceBlock_.getInputsInline()||super.shouldAddBorderRect_()}bindEvents_(){this.shouldAddBorderRect_()?super.bindEvents_():(this.svgRootBinding=i.browserEvents.conditionalBind(this.sourceBlock_.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length||this.onMouseDown_(e)},!1),this.fieldRootBinding=i.browserEvents.conditionalBind(this.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length&&this.onMouseDown_(e)},!1))}dispose(){super.dispose(),this.svgRootBinding&&(i.browserEvents.unbind(this.svgRootBinding),i.browserEvents.unbind(this.fieldRootBinding))}positionBorderRect_(){super.positionBorderRect_(),this.clickTargetRect&&(this.clickTargetRect.setAttribute("width",String(this.size_.width)),this.clickTargetRect.setAttribute("height",String(this.size_.height)),this.clickTargetRect.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.clickTargetRect.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}showEditor_(e){r.showEditorMixin.call(this,e)}getValue(){var e,t;const n=super.getValue();if(null===(e=this.sourceBlock_)||void 0===e?void 0:e.isInFlyout){if((null===(t=this.sourceBlock_.workspace)||void 0===t?void 0:t.getPotentialVariableMap()).getVariableById(n))return"potential_"+n}return n}}n.FieldVariable=s,s.CREATE_VARIABLE_ID="CREATE_VARIABLE",i.fieldRegistry.unregister("field_variable"),i.fieldRegistry.register("field_variable",s)},{"./fieldDropdownMixin":122,blockly:176}],124:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./fieldVariable"),n)},{"./fieldVariable":123}],125:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isCollapsedInputRow=n.CollapsedInputRow=void 0;const i=e("blockly");class r extends i.blockRendering.InputRow{constructor(e){super(e),this.type|=i.blockRendering.Types.INPUT_ROW|i.blockRendering.Types.getType("COLLAPSED_INPUT_ROW")}measure(){this.width=this.minWidth,this.height=this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT}}n.CollapsedInputRow=r,n.isCollapsedInputRow=function(e){return!!(e.type&i.blockRendering.Types.getType("COLLAPSED_INPUT_ROW"))}},{blockly:176}],126:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionPreviewer=void 0;const i=e("blockly");class r extends i.InsertionMarkerPreviewer{previewConnection(e,t){super.previewConnection(e,t),t.type!==i.ConnectionType.INPUT_VALUE&&t.type!==i.ConnectionType.OUTPUT_VALUE||this.showDraggedIndicatorWithLine(e,t)}previewReplacement(e,t,n){super.previewReplacement(e,t,n),this.showDraggedIndicatorWithLine(e,t)}showDraggedIndicatorWithLine(e,t){if(!this.connectionLine){this.connectionLine=i.utils.dom.createSvgElement("line",{class:"blocklyConnectionLine",x1:0,y1:0,x2:0,y2:0},e.sourceBlock_.getSvgRoot()),this.draggedConnectionIndicator=this.createConnectionIndicator(e.sourceBlock_.getSvgRoot(),e);const n=t.sourceBlock_.getSvgRoot().querySelector(":scope>.blocklyConnectionIndicatorParent");this.staticConnectionIndicator=this.createConnectionIndicator(n,t)}this.staticConnectionIndicator.parentElement.appendChild(this.staticConnectionIndicator);const n=r.CONNECTION_INDICATOR_RADIUS,s=e.getOffsetInBlock(),o=i.utils.Coordinate.sum(e.sourceBlock_.getRelativeToSurfaceXY(),s),a=i.utils.Coordinate.sum(t.sourceBlock_.getRelativeToSurfaceXY(),t.getOffsetInBlock()),l=a.x-o.x,c=a.y-o.y,u=Math.atan2(c,l),d=Math.sqrt(l*l+c*c),p=i.Gesture.inProgress();d<2*n+1||!p?i.utils.dom.addClass(this.connectionLine,"hidden"):p&&(i.utils.dom.removeClass(this.connectionLine,"hidden"),this.connectionLine.setAttribute("x1",String(s.x+Math.cos(u)*n)),this.connectionLine.setAttribute("y1",String(s.y+Math.sin(u)*n)),this.connectionLine.setAttribute("x2",String(s.x+l-Math.cos(u)*n)),this.connectionLine.setAttribute("y2",String(s.y+c-Math.sin(u)*n)))}hidePreview(){super.hidePreview(),this.connectionLine&&(this.connectionLine.remove(),this.connectionLine=null,this.draggedConnectionIndicator.remove(),this.draggedConnectionIndicator=null,this.staticConnectionIndicator.remove(),this.staticConnectionIndicator=null,this.staticConnection=null)}createConnectionIndicator(e,t){const n=i.utils.dom.createSvgElement("g",{class:"blocklyInputConnectionIndicator"},e);i.utils.dom.createSvgElement("circle",{r:r.CONNECTION_INDICATOR_RADIUS},n);const s=t.getOffsetInBlock();return n.setAttribute("transform","translate("+s.x+","+s.y+")"),n}}n.ConnectionPreviewer=r,r.CONNECTION_INDICATOR_RADIUS=9},{blockly:176}],127:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConstantProvider=void 0;const i=e("blockly");class r extends i.zelos.ConstantProvider{constructor(){super(...arguments),this.FIELD_TEXT_FONTFAMILY='"Consolas", "Monaco", "Menlo", "Ubuntu Mono", "source-code-pro", monospace',this.FIELD_TEXT_FONTWEIGHT="600",this.HIGHLIGHT_GLOW_COLOUR="#FFF200",this.ERROR_HIGHLIGHT_GLOW_COLOR="#FF0000",this.HIGHLIGHT_GLOW_SIZE=1.1,this.ELLIPSES_RADIUS=6,this.ELLIPSES_SPACING=8,this.ellipses=this.makeEllipses()}createDom(e,t,n,r){super.createDom(e,t,n,r);const s=i.utils.dom.createSvgElement(i.utils.Svg.DEFS,{},e);this.highlightOutlineFilter=this.createHighlight(s,"blocklyHighlightedGlowFilter",this.HIGHLIGHT_GLOW_COLOUR),this.highlightOutlineFilterId=this.highlightOutlineFilter.id,this.errorOutlineFilter=this.createHighlight(s,"blocklyErrorHighlightedGlowFilter",this.ERROR_HIGHLIGHT_GLOW_COLOR),this.errorOutlineFilterId=this.errorOutlineFilter.id,this.embossFilterOverride=this.createOutline(s,"blocklyBubbleEmbossGlowFilter"),this.embossFilterId=this.embossFilterOverride.id}dispose(){super.dispose(),this.highlightOutlineFilter&&i.utils.dom.removeNode(this.highlightOutlineFilter)}makeEllipses(){const e=this.ELLIPSES_RADIUS,t=this.ELLIPSES_SPACING;let n="";for(let r=0;r<3;r++)n+=i.utils.svgPaths.moveBy(t,0)+i.utils.svgPaths.arc("a","180 1,1",e,i.utils.svgPaths.point(2*e,0));for(let r=0;r<3;r++)n+=i.utils.svgPaths.arc("a","180 1,1",e,i.utils.svgPaths.point(2*-e,0))+i.utils.svgPaths.moveBy(-t,0);return n}getCSS_(e){return super.getCSS_(e).concat([e+" .blocklyConnectionIndicator, "+e+" .blocklyInputConnectionIndicator {","fill: #ff0000;","stroke: #ffff00;","stroke-width: 3px;","}",e+" .blocklyConnectionIndicator {","display: none;","}",e+" .blocklyBlockDragSurface > g > .blocklyDraggable > .blocklyConnectionIndicator {","display: block;","}",e+" .blocklyConnectionLine {","stroke: #ffff00;","stroke-width: 4px;","}",e+" .blocklyConnectionLine.hidden {","display: none;","}",e+" .blocklyFlyoutHeading .blocklyFlyoutLabelText {font-size: 1.5rem;","}",`${e} .blocklyText::selection {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>text::selection,`,`${e} .blocklyEditableField>text::selection,`,`${e} .blocklyNonEditableField>g>text::selection,`,`${e} .blocklyEditableField>g>text::selection {`,"fill: #575E75;","}",`${e} .blocklyDropdownText::selection {`,"fill: #fff !important;","}"])}createHighlight(e,t,n){const r=i.utils.dom.createSvgElement(i.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e);i.utils.dom.createSvgElement(i.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.HIGHLIGHT_GLOW_SIZE},r);const s=i.utils.dom.createSvgElement(i.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},r);return i.utils.dom.createSvgElement(i.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},s),i.utils.dom.createSvgElement(i.utils.Svg.FEFLOOD,{"flood-color":n,"flood-opacity":1,result:"outColor"},r),i.utils.dom.createSvgElement(i.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},r),r}createOutline(e,t){const n=i.utils.dom.createSvgElement(i.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e);i.utils.dom.createSvgElement(i.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:.92},n);const r=i.utils.dom.createSvgElement(i.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},n);i.utils.dom.createSvgElement(i.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),i.utils.dom.createSvgElement(i.utils.Svg.FEFLOOD,{"flood-color":"#000000","flood-opacity":.5,result:"outColor"},n),i.utils.dom.createSvgElement(i.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},n);const s=i.utils.dom.createSvgElement("feMerge",{},n);return i.utils.dom.createSvgElement("feMergeNode",{in:"outBlur"},s),i.utils.dom.createSvgElement("feMergeNode",{in:"outGlow"},s),i.utils.dom.createSvgElement("feMergeNode",{in:"SourceGraphic"},s),n}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case i.ConnectionType.INPUT_VALUE:case i.ConnectionType.OUTPUT_VALUE:return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case i.ConnectionType.PREVIOUS_STATEMENT:case i.ConnectionType.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}}n.ConstantProvider=r,r.COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",r.EXPAND_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.654)'%3E%3Cpath d='m1611 832q0-53-37-90l-651-651q-38-38-91-38-54 0-90 38l-651 651q-38 36-38 90 0 53 38 91l74 75q39 37 91 37 53 0 90-37l486-486 486 486q37 37 90 37 52 0 91-37l75-75q37-39 37-91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A"},{blockly:176}],128:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});e("blockly").Css.register("\n.blocklyDropdownMenu .blocklyMenuItemCheckbox {\n    filter: contrast(0) brightness(100);\n}\n\n.blocklyVerticalMarker {\n    fill: none;\n}\n")},{blockly:176}],129:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Drawer=void 0;const i=e("blockly"),r=e("./collapsedInputRow");class s extends i.zelos.Drawer{drawCollapsedStack_(e){const t=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.constants_.INSIDE_CORNERS.width,n=this.constants_.STATEMENT_INPUT_PADDING_LEFT+2*this.constants_.INSIDE_CORNERS.width+i.utils.svgPaths.lineOnAxis("h",-this.constants_.INSIDE_CORNERS.width)+this.constants_.INSIDE_CORNERS.pathTop,r=e.height-2*this.constants_.INSIDE_CORNERS.height,s=this.constants_.INSIDE_CORNERS.pathBottom+i.utils.svgPaths.lineOnAxis("h",this.constants_.INSIDE_CORNERS.width),o=this.constants_.ellipses;this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.bottomRight+i.utils.svgPaths.lineOnAxis("H",t)+n+i.utils.svgPaths.lineOnAxis("v",r/2)+o+i.utils.svgPaths.lineOnAxis("v",r/2)+s+i.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.constants_.OUTSIDE_CORNERS.rightHeight)+this.constants_.OUTSIDE_CORNERS.topRight}drawOutline_(){if(this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection)this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_();else{this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):(0,r.isCollapsedInputRow)(t)?this.drawCollapsedStack_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}}drawLeft_(){super.drawLeft_();if(this.info_.rows.find(function(e){return(0,r.isCollapsedInputRow)(e)})){let e=this.info_.startY;i.blockRendering.Types.isLeftRoundedCorner(this.info_.topRow.elements[0])&&(e+=this.constants_.OUTSIDE_CORNERS.rightHeight),this.outlinePath_=this.outlinePath_.slice(0,-1),this.outlinePath_+=i.utils.svgPaths.lineOnAxis("V",e)}}}n.Drawer=s},{"./collapsedInputRow":125,blockly:176}],130:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./renderer"),n),r(e("./connectionPreviewer"),n),r(e("./css"),n)},{"./connectionPreviewer":126,"./css":128,"./renderer":133}],131:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RenderInfo=void 0;const i=e("blockly"),r=e("./collapsedInputRow");class s extends i.zelos.RenderInfo{measure(){if(this.block_)for(const e of this.block_.inputList)e.init();super.measure()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new i.blockRendering.InputRow(this.constants_);this.inputRows.push(e);const t=this.block_.getIcons();for(let n,r=0;n=t[r];r++){const t=new i.blockRendering.Icon(this.constants_,n);this.isCollapsed&&!n.isShownWhenCollapsed()||e.elements.push(t)}let n;for(let t,r=0;t=this.block_.inputList[r];r++)if(t.isVisible()){this.shouldStartNewRow_(t,n)&&(this.rows.push(e),e=new i.blockRendering.InputRow(this.constants_),this.inputRows.push(e));for(let n,r=0;n=t.fieldRow[r];r++)e.elements.push(new i.blockRendering.Field(this.constants_,n,t));this.addInput_(t,e),n=t}if(this.isCollapsed){this.block_.inputList.find(function(e){return e.type==i.inputs.inputTypes.STATEMENT})?e=this.addCollapsedRow_(e):(e.hasJaggedEdge=!0,e.elements.push(new i.blockRendering.JaggedEdge(this.constants_)))}(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection;const e=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof i.inputs.StatementInput||this.rows.some(e=>(0,r.isCollapsedInputRow)(e));this.bottomRow.minHeight=e?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT;this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new i.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new i.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new i.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection));this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new i.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new i.blockRendering.RoundCorner(this.constants_,"right"))}addCollapsedRow_(e){this.rows.push(e);const t=new r.CollapsedInputRow(this.constants_);return t.hasDummyInput=!0,t}}n.RenderInfo=s},{"./collapsedInputRow":125,blockly:176}],132:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PathObject=void 0;const i=e("blockly"),r="blockly-dotted-outline-on-hover",s="hover";class o extends i.zelos.PathObject{constructor(){super(...arguments),this.connectionPointIndicators=new WeakMap}setPath(e){super.setPath(e),this.svgPathHighlighted&&this.svgPathHighlighted.setAttribute("d",e)}updateHighlighted(e){if(e){if(!this.svgPathHighlighted){const e=this.constants,t=this.hasError?e.errorOutlineFilterId:e.highlightOutlineFilterId;this.svgPathHighlighted=this.svgPath.cloneNode(!0),this.svgPathHighlighted.classList.add("pxtRendererHighlight"),this.svgPathHighlighted.setAttribute("fill","none"),this.svgPathHighlighted.setAttribute("filter","url(#"+t+")"),this.svgRoot.appendChild(this.svgPathHighlighted)}}else this.svgPathHighlighted&&(this.svgRoot.removeChild(this.svgPathHighlighted),this.svgPathHighlighted=null)}updateSelected(e){e&&this.svgPath.classList.remove(s),super.updateSelected(e)}addConnectionHighlight(e,t,n,r){const s=super.addConnectionHighlight(e,t,n,r);return this.staticConnectionIndicatorParentGroup?this.svgRoot.appendChild(this.staticConnectionIndicatorParentGroup):this.staticConnectionIndicatorParentGroup=i.utils.dom.createSvgElement("g",{class:"blocklyConnectionIndicatorParent"},this.svgRoot),s}removeConnectionHighlight(e){var t;null===(t=this.staticConnectionIndicatorParentGroup)||void 0===t||t.remove(),super.removeConnectionHighlight(e)}applyColour(e){if(super.applyColour(e),e.outputConnection){let t=!1;const n=e.getParent();if(n)if(e.isShadow()){const e=n.style.colourTertiary,r=function(e){return(.2126*e[0]+.7152*e[1]+.0722*e[2])/255}(i.utils.colour.hexToRgb(e));r<.15&&(this.svgPath.setAttribute("stroke",i.utils.colour.blend("#ffffff",e,.3)),t=!0)}else{const r=n.style.colourPrimary,s=e.style.colourPrimary;if(r===s){const e=.6,n=i.utils.colour.blend("#0000000",s,e),o=i.utils.colour.blend("#ffffff",s,e);pxt.contrastRatio(n,r)>pxt.contrastRatio(o,r)?this.svgPath.setAttribute("stroke",n):this.svgPath.setAttribute("stroke",o),t=!0}}t||this.svgPath.setAttribute("stroke",e.style.colourTertiary)}}setHasDottedOutlineOnHover(e){this.hasDottedOutlineOnHover=e,e?(this.svgPath.classList.add(r),this.mouseOverData||(this.mouseOverData=i.browserEvents.bind(this.svgRoot,"mouseover",this,()=>{this.svgPath.classList.add(s)}),this.mouseLeaveData=i.browserEvents.bind(this.svgRoot,"mouseleave",this,()=>{this.svgPath.classList.remove(s)}))):(this.svgPath.classList.remove(r),this.mouseOverData&&(i.browserEvents.unbind(this.mouseOverData),i.browserEvents.unbind(this.mouseLeaveData),this.mouseOverData=void 0,this.mouseLeaveData=void 0),this.svgPath.classList.remove(r))}setHasError(e){this.hasError=e}isHighlighted(){return!!this.svgPathHighlighted}}n.PathObject=o,o.CONNECTION_INDICATOR_RADIUS=9,i.Css.register("\n.blockly-dotted-outline-on-hover {\n    transition: stroke .4s;\n}\n.blockly-dotted-outline-on-hover.hover {\n    stroke-dasharray: 2;\n    stroke: white;\n    stroke-width: 2;\n}\n.blocklyDisabledPattern>.blocklyPath.pxtRendererHighlight {\n    fill: none;\n}\n")},{blockly:176}],133:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Renderer=void 0;const i=e("blockly"),r=e("./pathObject"),s=e("./constants"),o=e("./info"),a=e("./drawer");class l extends i.zelos.Renderer{makePathObject(e,t){return new r.PathObject(e,t,this.getConstants())}makeConstants_(){return new s.ConstantProvider}makeRenderInfo_(e){return new o.RenderInfo(this,e)}makeDrawer_(e,t){return new a.Drawer(e,t)}render(e){e.updateBeforeRender&&e.updateBeforeRender(),super.render(e)}}n.Renderer=l,i.blockRendering.register("pxt",l)},{"./constants":127,"./drawer":129,"./info":131,"./pathObject":132,blockly:176}],134:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldString=void 0;const i=e("blockly");class r extends i.FieldTextInput{initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=i.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=i.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(e){super.updateSize_(e);const t=this.value_?this.size_.width:1;let n=this.positionLeft(t+3);this.textElement_.setAttribute("x",n+""),n+=this.positionRight(n+t+3),this.size_.width=t+n}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteLeftX_=e+this.quoteWidth_+2*r.quotePadding,t=this.quoteWidth_+r.quotePadding):(this.quoteLeftX_=0,t=this.quoteWidth_+r.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteRightX_=r.quotePadding,t=this.quoteWidth_+r.quotePadding):(this.quoteRightX_=e+r.quotePadding,t=this.quoteWidth_+r.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}}n.FieldString=r,r.quotePadding=0,i.Css.register("\n.field-text-quote {\n    fill: #a31515 !important;\n}\n"),i.fieldRegistry.register("field_string",r)},{blockly:176}],135:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./fieldString"),n),r(e("./text"),n),r(e("./join"),n)},{"./fieldString":134,"./join":136,"./text":137}],136:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly"),r=e("../../fields/field_imagenotext"),s={itemCount_:0,valueConnections_:[],mutationToDom:function(){const e=i.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},storeValueConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreValueConnections_:function(){var e;for(let t=0;t<this.itemCount_;t++)null===(e=this.valueConnections_[t])||void 0===e||e.reconnect(this,"ADD"+t)},addItem_:function(){this.storeValueConnections_();if(this.update_(()=>{this.itemCount_++}),this.restoreValueConnections_(),this.itemCount_>1){const e=this.getInput("ADD0");if(e&&e.connection.targetConnection){const t=this.getInput("ADD"+(this.itemCount_-1)),n=e.connection.getShadowDom();if(n){const e=i.utils.xml.createElement("shadow"),r=n.getAttribute("type");e.setAttribute("type",r),e&&(e.setAttribute("id",i.utils.idGenerator.genUid()),t.connection.setShadowDom(e))}}}},removeItem_:function(){this.storeValueConnections_();this.update_(()=>{this.itemCount_--}),this.restoreValueConnections_()},update_:function(e){i.Events.setGroup(!0);const t=this,n=t.mutationToDom(),r=n&&i.Xml.domToText(n);e&&e.call(this),this.updateShape_(),t instanceof i.BlockSvg&&t.initSvg();const s=i.Events.getGroup(),o=t.mutationToDom(),a=o&&i.Xml.domToText(o);r!=a&&(i.Events.fire(new i.Events.BlockChange(t,"mutation",null,r,a)),setTimeout(function(){i.Events.setGroup(s),t.bumpNeighbours(),i.Events.setGroup(!1)},i.config.bumpDelay)),t.rendered&&t instanceof i.BlockSvg&&t.queueRender(),i.Events.setGroup(!1)},updateShape_:function(){const e=this,t=function(){e.removeItem_()};let n;for(this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(i.Msg.TEXT_JOIN_TITLE_CREATEWITH),n=0;n<this.itemCount_;n++)if(!this.getInput("ADD"+n)){this.appendValueInput("ADD"+n).setAlign(i.inputs.Align.LEFT)}for(;this.getInput("ADD"+n);)this.removeInput("ADD"+n),n++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");const s=this.appendDummyInput("BUTTONS");this.itemCount_>1&&s.appendField(new r.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",t,!1)),s.appendField(new r.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",function(){e.addItem_()},!1));const o=this.itemCount_<=4;if(this.setInputsInline(o),this.workspace instanceof i.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(o?e.getConstants().SHAPES.ROUND:e.getConstants().SHAPES.SQUARE)}}};i.Extensions.registerMutator("pxt_text_join_mutator",s,function(){i.Extensions.apply("inline-svgs",this,!1),this.itemCount_=2,this.updateShape_()}),i.defineBlocksWithJsonArray([{type:"text_join",message0:"",output:"String",outputShape:(new i.zelos.ConstantProvider).SHAPES.ROUND,style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"pxt_text_join_mutator"}])},{"../../fields/field_imagenotext":38,blockly:176}],137:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("blockly");i.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_string",name:"TEXT",text:""}],output:"String",outputShape:(new i.zelos.ConstantProvider).SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}])},{blockly:176}],138:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.blocksMetrics=n.render=n.renderWorkspace=n.cleanRenderingWorkspace=n.initRenderingWorkspace=void 0;const i=e("blockly"),r=e("./layout"),s=e("./importer");let o,a;function l(){return o||(a=document.createElement("div"),a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="1px",a.style.height="1px",document.body.appendChild(a),o=i.inject(a,{move:{scrollbars:!1},readOnly:!0,sounds:!1,media:pxt.webConfig.commitCdnUrl+"blockly/media/",rtl:pxt.Util.isUserLanguageRtl(),renderer:"pxt"})),(0,s.clearWithoutEvents)(o),o}function c(){o&&o.dispose(),o=void 0}function u(e={emPixels:18,layout:1}){switch(e.splitSvg?1:e.layout||4){case 1:(0,r.verticalAlign)(o,e.emPixels||18);break;case 4:(0,r.flow)(o,{ratio:e.aspectRatio,useViewWidth:e.useViewWidth});break;case 3:o.cleanUp_&&o.cleanUp_()}let t=o.getMetrics();const n=a.querySelectorAll("svg")[0].cloneNode(!0);return(0,r.cleanUpBlocklySvg)(n),pxt.U.toArray(n.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach(e=>e.setAttribute("transform",`translate(${-t.contentLeft}, ${-t.contentTop}) scale(1)`)),n.setAttribute("viewBox",`0 0 ${t.contentWidth} ${t.contentHeight}`),e.emPixels&&(n.style.width=t.contentWidth/e.emPixels+"em",n.style.height=t.contentHeight/e.emPixels+"em"),e.splitSvg?(0,r.splitSvg)(n,o,e.emPixels):n}n.initRenderingWorkspace=l,n.cleanRenderingWorkspace=c,n.renderWorkspace=u,n.render=function(e,t={emPixels:18,layout:1}){l();try{let n=e||'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',r=i.utils.xml.textToDom(n);return(0,s.domToWorkspaceNoEvents)(r,o,{applyHideMetaComment:!0}),u(t)}catch(e){return void pxt.reportException(e)}finally{c()}},n.blocksMetrics=function(e){const t=e.getTopBlocks(!1);if(!t.length)return{width:0,height:0};let n;return t.forEach(e=>{const t=e.getBoundingRectangle();n?(n.l=Math.min(n.l,t.left),n.r=Math.max(n.r,t.right),n.t=Math.min(n.t,t.top),n.b=Math.min(n.b,t.bottom)):n={l:t.left,r:t.right,t:t.top,b:t.bottom}}),{width:n.r-n.l,height:n.b-n.t}}},{"./importer":73,"./layout":75,blockly:176}],139:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.findBlockIdByLine=n.findBlockIdByPosition=void 0,n.findBlockIdByPosition=function(e,t){if(!t)return;let n,i;for(let r=0;r<e.length;++r){let s=e[r];s.startPos<=t.start&&s.endPos>=t.start+t.length&&(!n||i>s.endPos-s.startPos)&&(n=s,i=s.endPos-s.startPos)}return n?n.id:void 0},n.findBlockIdByLine=function(e,t){if(!t)return;let n,i;for(let r=0;r<e.length;++r){let s=e[r];s.startLine<=t.start&&s.endLine>t.start+t.length&&(!n||i>s.endLine-s.startLine)&&(n=s,i=s.endLine-s.startLine)}return n?n.id:void 0}},{}],140:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFunctionsFlyoutCategory=n.mkReturnStatementBlock=n.mkVariableFieldBlock=n.mkFieldBlock=n.mkPredicateBlock=n.createToolboxBlock=n.createFlyoutGap=n.createFlyoutButton=n.createFlyoutGroupLabel=n.createFlyoutHeadingLabel=n.createShadowValue=n.isArrayType=void 0;const i=e("blockly"),r=e("./plugins/functions"),s=e("./loader"),o=/^(string|number|boolean)$/,a={string:{field:"TEXT",block:"text",defaultValue:""},number:{field:"NUM",block:"math_number",defaultValue:"0"},boolean:{field:"BOOL",block:"logic_boolean",defaultValue:"false"},Array:{field:"VAR",block:"variables_get",defaultValue:"list"}};function l(e){let t=/^(?:Array<(.+)>)|(?:(.+)\[\])|(?:\[.+\])$/.exec(e);return t?t[1]?t[1]:t[2]:void 0}function c(e,t,n,i,r,s=0){let o;if(i=i||t.defaultValue,!(n=n||t.shadowBlockId)&&t.range&&(n="math_number_minmax"),o=i&&'"'==i.slice(0,1)?JSON.parse(i):i,"number"==t.type&&"value"==n){const e=document.createElement("field");return e.setAttribute("name",t.definitionName),e.appendChild(document.createTextNode("0")),e}if(t.fieldEditor){if(t.defaultValue){const e=document.createElement("field");return e.setAttribute("name",t.definitionName),e.appendChild(document.createTextNode(t.defaultValue)),e}return}let c=pxt.Util.lookup(e.apis.byQName,t.type),d=6==(null==c?void 0:c.kind),p=c&&!!c.attributes.fixedInstances&&!t.shadowBlockId,h="@combined@"==t.type;if(!n&&(d||p||h)){if(i){const e=document.createElement("field");return e.setAttribute("name",t.definitionName),e.appendChild(document.createTextNode(i)),e}return}const m="variables_get"==n,g="text"==n,_=document.createElement("value");_.setAttribute("name",t.definitionName);const y="lists_create_with"!==n&&n?void 0:l(t.type),b=document.createElement(!m&&!y||r?"shadow":"block");_.appendChild(b);const v=a[y||t.type];if(b.setAttribute("type",n||(y?"lists_create_with":v&&v.block||t.type)),b.setAttribute("colour","#fff"),y){if(v&&!n){let e;switch(y){case"number":e=["0","1"];break;case"string":e=["a","b","c"];break;case"boolean":e=["FALSE","FALSE","FALSE"]}return u(b,v.block,v.field,e),_}if(n&&o)return u(b,o),_}if(!v||n&&v.block!==n&&"math_number_minmax"!==n){if(o){const i=document.createElement("field");if(i.textContent=o,m)i.setAttribute("name","VAR"),b.appendChild(i);else if(g)i.setAttribute("name","TEXT"),b.appendChild(i);else if(n){const t=e.blocksById[n];if(t&&t.attributes._def&&t.attributes._def.parameters.length){const e=t.attributes._def.parameters[0];i.setAttribute("name",e.name),b.appendChild(i)}}else i.setAttribute("name",t.definitionName),b.appendChild(i)}}else{const e=document.createElement("field");let i,r;switch(b.appendChild(e),n){case"variables_get":i="VAR";break;case"math_number_minmax":i="SLIDER";break;default:i=v.field}e.setAttribute("name",i),r="boolean"==t.type?document.createTextNode((o||v.defaultValue).toUpperCase()):document.createTextNode(o||v.defaultValue),e.appendChild(r)}let T;if(t.range&&(T=document.createElement("mutation"),T.setAttribute("min",t.range.min.toString()),T.setAttribute("max",t.range.max.toString()),T.setAttribute("label",t.actualName.charAt(0).toUpperCase()+t.actualName.slice(1)),t.fieldOptions&&(t.fieldOptions.step&&T.setAttribute("step",t.fieldOptions.step),t.fieldOptions.color&&T.setAttribute("color",t.fieldOptions.color),t.fieldOptions.precision&&T.setAttribute("precision",t.fieldOptions.precision))),t.fieldOptions&&(T||(T=document.createElement("mutation")),T.setAttribute("customfield",JSON.stringify(t.fieldOptions))),T&&b.appendChild(T),s){const t=pxt.Util.toArray(_.getElementsByTagName("shadow"));for(const n of t)if(!n.innerHTML){const t=e.blocks.find(e=>e.attributes.blockId===n.getAttribute("type"));if(t){const i=f(e,t,pxt.blocks.compileInfo(t),!0,s-1);for(;i.firstChild;)n.appendChild(i.firstChild.cloneNode(!0)),i.firstChild.remove()}}}return _}function u(e,t,n,i){const r=i?i.length:2,s=document.createElement("mutation");s.setAttribute("items",""+r),s.setAttribute("horizontalafter",""+r),e.appendChild(s);for(let s=0;s<r;s++){const r=document.createElement("value");r.setAttribute("name","ADD"+s);const o=document.createElement("shadow");if(o.setAttribute("type",t),n){const e=document.createElement("field");e.setAttribute("name",n),i&&e.appendChild(document.createTextNode(i[s])),o.appendChild(e)}r.appendChild(o),e.appendChild(r)}}function d(e,t,n,i){const r=h(e,pxt.toolbox.convertColor(t),n,i);return r.setAttribute("web-class","blocklyFlyoutHeading"),r}function p(e,t,n,i){const r=h(e,void 0,t);return r.setAttribute("web-class","blocklyFlyoutGroup"),r.setAttribute("web-line","1.5"),n&&r.setAttribute("web-line-width",n),i&&(r.setAttribute("web-help-button","true"),r.setAttribute("callbackKey",i)),r}function h(e,t,n,r){let s=i.utils.xml.createElement("label");return s.setAttribute("text",e),t&&s.setAttribute("web-icon-color",pxt.toolbox.convertColor(t)),n&&(1===n.length?(s.setAttribute("web-icon",n),r&&s.setAttribute("web-icon-class",r)):s.setAttribute("web-icon-class",`blocklyFlyoutIcon${e}`)),s}function f(e,t,n,i=!1,a=0){var u,d;let p,h;if(t.attributes.toolboxParent){const n=e.blocksById[t.attributes.toolboxParent];if(n){const r=pxt.blocks.compileInfo(n);if(p=f(e,n,r,i),t.attributes.toolboxParentArgument)h=p.querySelector(`value[name=${t.attributes.toolboxParentArgument}]`),!h&&r.parameters.some(e=>e.definitionName===t.attributes.toolboxParentArgument)&&(h=document.createElement("value"),h.setAttribute("name",t.attributes.toolboxParentArgument),p.appendChild(h));else if(h=p.querySelector("value"),!h)for(const e of r.parameters)if(!p.querySelector(`field[name=${e.definitionName}]`)){h=document.createElement("value"),h.setAttribute("name",e.definitionName),p.appendChild(h);break}if(h)for(;h.firstChild;)h.removeChild(h.firstChild);else p=void 0}}let m=document.createElement(p||i?"shadow":"block");if(m.setAttribute("type",t.attributes.blockId),t.attributes.blockGap?m.setAttribute("gap",t.attributes.blockGap):pxt.appTarget.appTheme&&pxt.appTarget.appTheme.defaultBlockGap&&m.setAttribute("gap",pxt.appTarget.appTheme.defaultBlockGap.toString()),n.thisParameter){const t=n.thisParameter,r=!!(null===(u=e.apis.byQName[t.type])||void 0===u?void 0:u.attributes.fixedInstances);let s=t.shadowBlockId,o=t.defaultValue;r||s&&"variables_get"!==s||(s="variables_get",o=o||t.definitionName);const l=c(e,t,s,o,i,a);l&&m.appendChild(l)}if("ENUM_GET"===t.attributes.shim||"KIND_GET"===t.attributes.shim){if(null===(d=t.parameters)||void 0===d?void 0:d.length){const e=t.parameters[0].default;if(e){const t=document.createElement("field");t.setAttribute("name","MEMBER"),t.textContent=e,m.appendChild(t)}}}else t.parameters&&(n.parameters.filter(e=>o.test(e.type)||o.test(l(e.type))||e.shadowBlockId||e.defaultValue).forEach(t=>{const n=c(e,t,void 0,void 0,i,a);n&&m.appendChild(n)}),t.attributes.draggableParameters?n.handlerArgs.forEach(e=>{const n="reporter"===t.attributes.draggableParameters,i=document.createElement("value");i.setAttribute("name",s.DRAGGABLE_PARAM_INPUT_PREFIX+e.name);const o=n?pxt.blocks.reporterTypeForArgType(e.type):"variables_get_reporter",a=document.createElement("block");a.setAttribute("type",o);const l=document.createElement("mutation");a.appendChild(l),n&&"argument_reporter_custom"===o&&l.setAttribute("typename",e.type),l.setAttribute(r.LOCALIZATION_NAME_MUTATION_KEY,e.localizationKey);const c=document.createElement("field");c.setAttribute("name",n?"VALUE":"VAR"),c.textContent=pxt.Util.htmlEscape(e.name),a.appendChild(c),i.appendChild(a),m.appendChild(i)}):n.handlerArgs.forEach(e=>{const t=document.createElement("field");t.setAttribute("name","HANDLER_"+e.name),t.textContent=e.name,m.appendChild(t)}));if(t.attributes.expandArgumentsInToolbox){let e;for(const t of m.children)if("mutation"===t.tagName){e=t;break}e||(e=document.createElement("mutation"),m.appendChild(e)),e.setAttribute("_expanded",""+t.attributes._expandedDef.parameters.length)}return p?(h.appendChild(m),p):m}function m(e,t,n,i){const r=document.createElement(i?"shadow":"block");r.setAttribute("type",pxt.Util.htmlEscape(e));const s=document.createElement("field");return s.setAttribute("name",pxt.Util.htmlEscape(t)),s.textContent=pxt.Util.htmlEscape(n),r.appendChild(s),r}function g(){const e=document.createElement("block");e.setAttribute("type","function_return");const t=document.createElement("value");t.setAttribute("name","RETURN_VALUE"),e.appendChild(t);const n=m("math_number","NUM","0",!0);return t.appendChild(n),e}n.isArrayType=l,n.createShadowValue=c,n.createFlyoutHeadingLabel=d,n.createFlyoutGroupLabel=p,n.createFlyoutButton=function(e,t){let n=i.utils.xml.createElement("button");return n.setAttribute("text",t),n.setAttribute("callbackKey",e),n},n.createFlyoutGap=function(e){const t=i.utils.xml.createElement("sep");return t.setAttribute("gap",e+""),t},n.createToolboxBlock=f,n.mkPredicateBlock=function(e){const t=document.createElement("block");t.setAttribute("type",e);const n=document.createElement("value");n.setAttribute("name","PREDICATE"),t.appendChild(n);const i=m("logic_boolean","BOOL","TRUE",!0);return n.appendChild(i),t},n.mkFieldBlock=m,n.mkVariableFieldBlock=function(e,t,n,i,r){const s=document.createElement(r?"shadow":"block");s.setAttribute("type",pxt.Util.htmlEscape(e));const o=document.createElement("field");return o.setAttribute("name","VAR"),o.id=t,o.setAttribute("variabletype",pxt.Util.htmlEscape(n)),o.textContent=pxt.Util.htmlEscape(i),s.appendChild(o),s},n.mkReturnStatementBlock=g,n.createFunctionsFlyoutCategory=function(e){const t=(0,r.flyoutCategory)(e);if(t.length>1){let e=g();t.splice(1,0,p(lf("Your Functions"))),t.splice(1,0,e)}const n=(0,r.getAllFunctionDefinitionBlocks)(e).filter(e=>e.getDescendants(!1).some(e=>"function_return"===e.type&&e.getInputTargetBlock("RETURN_VALUE"))).map(e=>e.getField("function_name").getText()),i=d(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions");t.unshift(i);const s=[];for(const e of t)if(s.push(e),"function_call"===e.getAttribute("type")){const t=e.children.item(0);if(t){const i=t.getAttribute("name");if(n.some(e=>e===i)){const t=e.cloneNode(!0);t.setAttribute("type","function_call_output"),s.push(t)}}}return s}},{"./loader":77,"./plugins/functions":112,blockly:176}],141:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PxtWorkspaceSearch=void 0;const i=e("blockly"),r=e("@blockly/plugin-workspace-search");class s extends r.WorkspaceSearch{constructor(e){super(e),this.injectionDiv=e.getInjectionDiv()}highlightSearchGroup(e){e.forEach(e=>{const t=e.pathObject.svgPath;i.utils.dom.addClass(t,"blockly-ws-search-highlight-pxt")})}unhighlightSearchGroup(e){e.forEach(e=>{const t=e.pathObject.svgPath;i.utils.dom.removeClass(t,"blockly-ws-search-highlight-pxt")})}open(){super.open(),i.utils.dom.addClass(this.injectionDiv,"blockly-ws-searching")}close(){super.close(),i.utils.dom.removeClass(this.injectionDiv,"blockly-ws-searching")}}n.PxtWorkspaceSearch=s,i.Css.register("\n.blockly-ws-search {\n    background: var(--pxt-neutral-background1);\n    color: var(--pxt-neutral-foreground1);\n    border: solid var(--pxt-neutral-alpha50) 1px;\n    border-top: none;\n    border-right: none;\n    box-shadow: 0px 2px 15px var(--pxt-neutral-alpha50);\n}\n\n.blockly-ws-search input {\n    -webkit-tap-highlight-color: transparent;\n    background: var(--pxt-neutral-background1);\n    color: var(--pxt-neutral-foreground1);\n    border: none;\n}\n\n.blockly-ws-search input::-webkit-input-placeholder {\n    color: var(--pxt-neutral-alpha50);\n}\n\n.blockly-ws-search input::-moz-placeholder {\n    color: var(--pxt-neutral-alpha50);\n}\n\n.blockly-ws-search input::-ms-input-placeholder {\n    color: var(--pxt-neutral-alpha50);\n}\n\n.blockly-ws-search input:active,\n.blockly-ws-search input:focus {\n    border-color: var(--pxt-neutral-alpha50);\n    background: var(--pxt-neutral-background1);\n    color: var(--pxt-neutral-foreground1);\n}\n\n.blockly-ws-search input::selection {\n    color: var(--pxt-neutral-foreground1);\n}\n\n.blockly-ws-search button {\n    padding-left: 6px;\n    padding-right: 6px;\n    color: var(--pxt-neutral-foreground1);\n}")},{"@blockly/plugin-workspace-search":171,blockly:176}],142:[function(e,t,n){function i(e,t,n,i){return pxt.Util.toArray(e.getElementsByTagName(t)).filter(e=>e.getAttribute(n)===i)}Object.defineProperty(n,"__esModule",{value:!0}),n.cleanOuterHTML=n.getDirectChildren=n.getFirstChildWithAttr=n.getChildrenWithAttr=n.getBlocksWithType=void 0,n.getBlocksWithType=function(e,t){return i(e,"block","type",t).concat(i(e,"shadow","type",t))},n.getChildrenWithAttr=i,n.getFirstChildWithAttr=function(e,t,n,r){const s=i(e,t,n,r);return s.length?s[0]:void 0},n.getDirectChildren=function(e,t){const n=[];for(let i=0;i<e.childNodes.length;i++){const r=e.childNodes.item(i);r.tagName===t&&n.push(r)}return n},n.cleanOuterHTML=function(e){return e.outerHTML.replace(/^<\?[^>]*>/,"")}},{}],143:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNestedChildBlocks=void 0,n.getNestedChildBlocks=function(e){return e.getDescendants(!0).filter(t=>t.isEnabled()&&t.getSurroundParent()===e)}},{}],144:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./runValidatorPlan"),n),r(e("./validateBlocksExist"),n),r(e("./validateBlocksInSetExist"),n),r(e("./validateCommentsExist"),n),r(e("./validateSpecificBlockCommentsExist"),n)},{"./runValidatorPlan":145,"./validateBlocksExist":147,"./validateBlocksInSetExist":148,"./validateCommentsExist":149,"./validateSpecificBlockCommentsExist":150}],145:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.runValidatorPlan=void 0;const i=e("./validateBlockFieldValueExists"),r=e("./validateBlocksExist"),s=e("./validateBlocksInSetExist"),o=e("./validateCommentsExist"),a=e("./validateSpecificBlockCommentsExist"),l=e("./getNestedChildBlocks"),c=e("./validateVariableUsage");function u(e,t){const n=t.blockCounts.reduce((e,t)=>(e[t.blockId]=t.count,e),{}),i=(0,r.validateBlocksExist)({usedBlocks:e,requiredBlockCounts:n});let s=[];if(i.passed)for(const e of t.blockCounts){const t=e.blockId;s.push(...i.successfulBlocks[t])}return[s,i.passed]}function d(e,t){return(0,o.validateBlockCommentsExist)({usedBlocks:e,numRequired:t.count}).passed}function p(e,t){return(0,a.validateSpecificBlockCommentsExist)({usedBlocks:e,blockType:t.blockType}).passed}function h(e,t){const n=(0,s.validateBlocksInSetExist)({usedBlocks:e,blockIdsToCheck:t.blocks,count:t.count});return[n.successfulBlocks,n.passed]}function f(e,t){const n=(0,i.validateBlockFieldValueExists)({usedBlocks:e,fieldType:t.fieldType,fieldValue:t.fieldValue,specifiedBlock:t.blockType});return[n.successfulBlocks,n.passed]}function m(e,t){const n=(0,c.validateVariableUsage)({usedBlocks:e,count:t.count,name:t.name}),i=[];for(const e of n.passingVarDefinitions.values())i.push(...e);return[i,n.passed]}n.runValidatorPlan=function e(t,n,i){const r=Date.now();let s=0,o=[];for(const r of n.checks){let n=!1;switch(r.validator){case"blocksExist":[o,n]=[...u(t,r)];break;case"blockCommentsExist":n=d(t,r);break;case"specificBlockCommentsExist":n=p(t,r);break;case"blocksInSetExist":[o,n]=[...h(t,r)];break;case"blockFieldValueExists":[o,n]=[...f(t,r)];break;case"variableUsage":[o,n]=[...m(t,r)];break;default:return pxt.debug(`Unrecognized validator: ${r.validator}`),pxt.tickEvent("validation.unrecognized_validator",{validator:r.validator}),{executionSuccess:!1,executionErrorMsg:lf("Unrecognized evaluation rule")}}if(n&&r.childValidatorPlans)for(const t of r.childValidatorPlans){let r=0;for(const n of o){const s=(0,l.getNestedChildBlocks)(n),o=i.find(e=>e.name===t);r+=e(s,o,i)?1:0}n=n&&r>0}s+=n?1:0}const a=s>=n.threshold;return pxt.tickEvent("validation.evaluation_complete",{plan:n.name,durationMs:Date.now()-r,passed:`${a}`}),{result:a,executionSuccess:!0}}},{"./getNestedChildBlocks":143,"./validateBlockFieldValueExists":146,"./validateBlocksExist":147,"./validateBlocksInSetExist":148,"./validateCommentsExist":149,"./validateSpecificBlockCommentsExist":150,"./validateVariableUsage":151}],146:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlockFieldValueExists=void 0,n.validateBlockFieldValueExists=function({usedBlocks:e,fieldType:t,fieldValue:n,specifiedBlock:i}){const r=e.filter(e=>e.isEnabled()&&e.type===i).filter(e=>{var i;return"VAR"===t?(null===(i=e.getVarModels())||void 0===i?void 0:i[0].getName())===n:e.getFieldValue(t)===n});return{successfulBlocks:r,passed:r.length>0}}},{}],147:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlocksExist=void 0,n.validateBlocksExist=function({usedBlocks:e,requiredBlockCounts:t}){let n=[],i=[],r=[],s={};const o=null==e?void 0:e.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+(t.isEnabled()?1:0),e),{});for(const[a,l]of Object.entries(t||{})){const t=o[a],c=e.filter(e=>e.isEnabled()&&e.type===a);c.length>0&&(s[a]=c),void 0===t?n.push(a):t?t<l&&r.push(a):i.push(a)}return{missingBlocks:n,disabledBlocks:i,insufficientBlocks:r,successfulBlocks:s,passed:0===n.length&&0===i.length&&0===r.length}}},{}],148:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlocksInSetExist=void 0,n.validateBlocksInSetExist=function({usedBlocks:e,blockIdsToCheck:t,count:n,requireUnique:i}){const r=[],s=e.filter(e=>e.isEnabled());for(const e of t){const t=s.filter(t=>t.type===e);i&&t.length>=1?r.push(t[0]):r.push(...t)}return{successfulBlocks:r,passed:r.length>=n}}},{}],149:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlockCommentsExist=void 0,n.validateBlockCommentsExist=function({usedBlocks:e,numRequired:t}){const n=e.filter(e=>!!e.getCommentText());return{commentedBlocks:n,passed:n.length>=t}}},{}],150:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSpecificBlockCommentsExist=void 0,n.validateSpecificBlockCommentsExist=function({usedBlocks:e,blockType:t}){const n=e.filter(e=>e.type===t),i=n.filter(e=>!e.getCommentText());return{uncommentedBlocks:i,passed:0!==n.length&&0===i.length}}},{}],151:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateVariableUsage=void 0,n.validateVariableUsage=function({usedBlocks:e,count:t,name:n}){const i=new Map,r=new Set;for(const t of e){if(!t.isEnabled())continue;const e=t.getVarModels();for(const s of null!=e?e:[]){const e=s.getName();n&&e!==n||("variables_set"===t.type||"variables_change"===t.type?(i.has(e)||i.set(e,[]),i.get(e).push(t)):r.add(e))}}const s=new Map;for(const[e,t]of i)r.has(e)&&s.set(e,t);return{passingVarDefinitions:s,passed:s.size>=t}}},{}],152:[function(e,t,n){let i;Object.defineProperty(n,"__esModule",{value:!0}),n.isBlocks=n.initEditorExtensionsAsync=n.HELP_IMAGE_URI=void 0,n.HELP_IMAGE_URI="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjYiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCAyNiAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTMiIGN5PSIxMyIgcj0iMTMiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNy45NTIgOS4xODQwMkMxNy45NTIgMTAuMjU2IDE3LjgxNiAxMS4wNzIgMTcuNTQ0IDExLjYzMkMxNy4yODggMTIuMTkyIDE2Ljc1MiAxMi43OTIgMTUuOTM2IDEzLjQzMkMxNS4xMiAxNC4wNzIgMTQuNTc2IDE0LjU4NCAxNC4zMDQgMTQuOTY4QzE0LjA0OCAxNS4zMzYgMTMuOTIgMTUuNzM2IDEzLjkyIDE2LjE2OFYxNi45NkgxMS44MDhDMTEuNDI0IDE2LjQ2NCAxMS4yMzIgMTUuODQgMTEuMjMyIDE1LjA4OEMxMS4yMzIgMTQuNjg4IDExLjM4NCAxNC4yODggMTEuNjg4IDEzLjg4OEMxMS45OTIgMTMuNDg4IDEyLjUzNiAxMi45NjggMTMuMzIgMTIuMzI4QzE0LjEwNCAxMS42NzIgMTQuNjI0IDExLjE2OCAxNC44OCAxMC44MTZDMTUuMTM2IDEwLjQ0OCAxNS4yNjQgOS45NjgwMiAxNS4yNjQgOS4zNzYwMkMxNS4yNjQgOC4yMDgwMiAxNC40MTYgNy42MjQwMiAxMi43MiA3LjYyNDAyQzExLjc2IDcuNjI0MDIgMTAuNzUyIDcuNzM2MDIgOS42OTYgNy45NjAwMkw5LjE0NCA4LjA4MDAyTDkgNi4wODgwMkMxMC40ODggNS41NjAwMiAxMS44NCA1LjI5NjAyIDEzLjA1NiA1LjI5NjAyQzE0LjczNiA1LjI5NjAyIDE1Ljk2OCA1LjYwODAyIDE2Ljc1MiA2LjIzMjAyQzE3LjU1MiA2Ljg0MDAyIDE3Ljk1MiA3LjgyNDAyIDE3Ljk1MiA5LjE4NDAyWk0xMS40IDIyVjE4LjY0SDE0LjE4NFYyMkgxMS40WiIgZmlsbD0iIzU5NUU3NCIvPgo8L3N2Zz4K",n.initEditorExtensionsAsync=function(){if(!i&&(i=Promise.resolve(),pxt.appTarget&&pxt.appTarget.appTheme&&pxt.appTarget.appTheme.extendFieldEditors)){const e={};i=i.then(()=>pxt.BrowserUtils.loadBlocklyAsync()).then(()=>pxt.BrowserUtils.loadScriptAsync("fieldeditors.js")).then(()=>pxt.editor.initFieldExtensionsAsync(e)).then(e=>{e.fieldEditors&&e.fieldEditors.forEach(e=>{pxt.blocks.registerFieldEditor(e.selector,e.editor,e.validator)})})}return i},n.isBlocks=function(e){return pxt.U.endsWith(e.name,".blocks")}},{}],153:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.postHostMessageAsync=n.shouldPostHostMessages=n.enableControllerAnalytics=n.bindEditorMessages=void 0;const i=e("./code-validation/runValidatorPlan"),r=e("../pxtservices/iframeEmbeddedClient"),s=e("./projectImport"),o={};let a;n.bindEditorMessages=function(e){const t=pxt.appTarget.appTheme.allowParentController||pxt.shell.isControllerMode(),n=pxt.appTarget.appTheme.allowPackageExtensions,l=pxt.appTarget.appTheme.allowSimulatorTelemetry;if(!t&&!n&&!l)return;a=new r.IFrameEmbeddedClient(r=>{const a=r.data;if(!a||!/^pxt(host|editor|pkgext|sim)$/.test(a.type))return!1;if("pxtpkgext"===a.type&&n)e().then(e=>{e.handleExtensionRequest(a)});else if("pxtsim"===a.type&&l){const e=a;"event"===e.action&&(e.category||e.message?pxt.reportError(e.category,e.message,e.data):pxt.tickEvent(e.tick,e.data))}else if(t){let t,n=Promise.resolve();if("pxthost"==a.type){const e=o[a.id];e?n=n.then(()=>e.resolve(a)):pxt.debug(`pxthost: unknown request ${a.id}`)}else"pxteditor"==a.type&&(n=n.then(()=>e().then(e=>{const n=a;switch(pxt.debug(`pxteditor: ${n.action}`),n.action.toLowerCase()){case"switchjavascript":return Promise.resolve().then(()=>e.openJavaScript());case"switchpython":return Promise.resolve().then(()=>e.openPython());case"switchblocks":return Promise.resolve().then(()=>e.openBlocks());case"startsimulator":return Promise.resolve().then(()=>e.startSimulator());case"restartsimulator":return Promise.resolve().then(()=>e.restartSimulator());case"hidesimulator":return Promise.resolve().then(()=>e.collapseSimulator());case"showsimulator":return Promise.resolve().then(()=>e.expandSimulator());case"closeflyout":return Promise.resolve().then(()=>e.closeFlyout());case"unloadproject":return Promise.resolve().then(()=>e.unloadProjectAsync());case"saveproject":return e.saveProjectAsync();case"compile":return e.compile();case"redo":return Promise.resolve().then(()=>{const t=e.editor;t&&t.hasRedo()&&t.redo()});case"undo":return Promise.resolve().then(()=>{const t=e.editor;t&&t.hasUndo()&&t.undo()});case"setscale":{const t=a;return Promise.resolve().then(()=>e.editor.setScale(t.scale))}case"stopsimulator":{const t=a;return Promise.resolve().then(()=>e.stopSimulator(t.unload))}case"newproject":{const t=a;return Promise.resolve().then(()=>e.newProject(t.options))}case"importproject":{const t=a;return Promise.resolve().then(()=>e.importProjectAsync(t.project,{filters:t.filters,searchBar:t.searchBar}))}case"importexternalproject":{const e=a;return(0,s.saveProjectAsync)(e.project).then(e=>{const n=location.origin+location.pathname+`#embedimport:${e}`;t={importUrl:n}})}case"openheader":{const t=a;return e.openProjectByHeaderIdAsync(t.headerId)}case"startactivity":{const t=a;let n,i=t.path;return/^([jt]s|py|blocks?):/i.test(i)&&(n=/^py:/i.test(i)?pxt.PYTHON_PROJECT_NAME:/^[jt]s:/i.test(i)?pxt.JAVASCRIPT_PROJECT_NAME:pxt.BLOCKS_PROJECT_NAME,i=i.substr(i.indexOf(":")+1)),Promise.resolve().then(()=>e.startActivity({activity:t.activityType,path:i,title:t.title,editor:n,previousProjectHeaderId:t.previousProjectHeaderId,carryoverPreviousCode:t.carryoverPreviousCode}))}case"importtutorial":{const t=a;return Promise.resolve().then(()=>e.importTutorialAsync(t.markdown))}case"proxytosim":{const t=a;return Promise.resolve().then(()=>e.proxySimulatorMessage(t.content))}case"renderblocks":{const n=a;return Promise.resolve().then(()=>e.renderBlocksAsync(n)).then(e=>e.xml.then(e=>{t=e.xml}))}case"renderxml":{const n=a;return Promise.resolve().then(()=>e.renderXml(n).resultXml.then(e=>{t=e.xml}))}case"renderbyblockid":{const n=a;return Promise.resolve().then(()=>e.renderByBlockIdAsync(n)).then(e=>e.resultXml.then(e=>{t=e.xml}))}case"runeval":{const n=a,r=n.validatorPlan,s=n.planLib;return Promise.resolve().then(()=>{const t=e.getBlocks();return(0,i.runValidatorPlan)(t,r,s)}).then(e=>{t=e})}case"gettoolboxcategories":{const n=a;return Promise.resolve().then(()=>{t=e.getToolboxCategories(n.advanced)})}case"getblockastext":{const n=a;return Promise.resolve().then(()=>{const i=e.getBlockAsText(n.blockId);t={blockAsText:i}})}case"renderpython":{const n=a;return Promise.resolve().then(()=>e.renderPythonAsync(n)).then(e=>{t=e.python})}case"toggletrace":{const t=a;return Promise.resolve().then(()=>e.toggleTrace(t.intervalSpeed))}case"settracestate":{const t=a;return Promise.resolve().then(()=>e.setTrace(t.enabled,t.intervalSpeed))}case"setsimulatorfullscreen":{const t=a;return Promise.resolve().then(()=>e.setSimulatorFullScreen(t.enabled))}case"showthemepicker":return Promise.resolve().then(()=>e.showThemePicker());case"togglehighcontrast":return Promise.resolve().then(()=>e.toggleHighContrast());case"sethighcontrast":{const t=a;return Promise.resolve().then(()=>e.setHighContrast(t.on))}case"togglegreenscreen":return Promise.resolve().then(()=>e.toggleGreenScreen());case"togglekeyboardcontrols":return Promise.resolve().then(()=>e.toggleAccessibleBlocks("editormessage"));case"print":return Promise.resolve().then(()=>e.printCode());case"pair":return e.pairAsync().then(()=>{});case"info":return Promise.resolve().then(()=>{t={versions:pxt.appTarget.versions,locale:ts.pxtc.Util.userLanguage(),availableLocales:pxt.appTarget.appTheme.availableLocales,keyboardControls:e.isAccessibleBlocks()}});case"shareproject":{const n=a;return e.anonymousPublishHeaderByIdAsync(n.headerId,n.projectName).then(e=>{t=e})}case"savelocalprojectstocloud":{const n=a;return e.saveLocalProjectsToCloudAsync(n.headerIds).then(e=>{t={headerIdMap:e}})}case"requestprojectcloudstatus":{const t=a;return e.requestProjectCloudStatus(t.headerIds)}case"convertcloudprojectstolocal":{const t=a;return e.convertCloudProjectsToLocal(t.userId)}case"setlanguagerestriction":{const t=a;if("no-blocks"===t.restriction)throw pxt.warn("no-blocks language restriction is not supported"),new Error("no-blocks language restriction is not supported");return e.setLanguageRestrictionAsync(t.restriction)}case"precachetutorial":{const e=a,t=e.data,n=e.lang||pxt.Util.userLanguage();return pxt.github.db.cacheReposAsync(t).then(async()=>{if("string"==typeof t.markdown){const e=await pxt.BrowserUtils.translationDbAsync();await e.setAsync(n,t.path,void 0,void 0,t.markdown)}})}case"setcolorthemebyid":{const t=a;return e.setColorThemeById(t.colorThemeId,!!t.savePreference),Promise.resolve()}}return Promise.resolve()})));n.then(()=>c(a,t,!0,void 0),e=>c(a,t,!1,e))}return!0})};let l=!1;function c(e,t,n,i){if(e.response){const r={type:e.type,id:e.id,resp:t,success:n,error:i};a?a.postMessage(r):window.parent.postMessage(r,"*")}}function u(e){return new Promise((t,n)=>{const i=pxt.Util.clone(e);if(i.id=ts.pxtc.Util.guidGen(),e.response&&(o[i.id]={resolve:t,reject:n}),a?a.postMessage(i):window.parent.postMessage(i,"*"),pxt.commands.onPostHostMessage)try{pxt.commands.onPostHostMessage(i)}catch(e){pxt.reportException(e)}e.response||t(void 0)})}n.enableControllerAnalytics=function(){if(l)return;const e=!!pxt.commands.onPostHostMessage,t=pxt.appTarget.appTheme.allowParentController,n=pxt.BrowserUtils.isIFrame();if(!(e||t&&n))return;const i=pxt.tickEvent;pxt.tickEvent=function(e,t,n){i&&i(e,t,n),u({type:"pxthost",action:"event",tick:e,response:!1,data:t})};const r=pxt.reportException;pxt.reportException=function(e,t){r&&r(e,t);try{u({type:"pxthost",action:"event",tick:"error",message:e.message,response:!1,data:t})}catch(e){}};const s=pxt.reportError;pxt.reportError=function(e,t,n){s&&s(e,t,n),u({type:"pxthost",action:"event",tick:"error",category:e,message:t,data:n})},l=!0},n.shouldPostHostMessages=function(){return pxt.appTarget.appTheme.allowParentController&&pxt.BrowserUtils.isIFrame()},n.postHostMessageAsync=u},{"../pxtservices/iframeEmbeddedClient":169,"./code-validation/runValidatorPlan":145,"./projectImport":164}],154:[function(e,t,n){function i(e){return`experiments-${"object"==typeof e?e.id:e}`}let r;function s(){const e=pxt.savedAppTheme(),t={},n=o();return n.forEach(n=>{const i=a(n);e[n.id]=!!i,i&&(t[n.id]=i?1:0)}),n.length&&Object.keys(t).length&&(pxt.tickEvent("experiments.loaded",t),pxt.reloadAppTargetVariant()),pxt.appTarget.appTheme}function o(){const e=pxt.appTarget.appTheme.experiments;if(!e)return[];return[{id:"print",name:lf("Print Code"),description:lf("Print the code from the current project"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4740"},{id:"greenScreen",name:lf("Green screen"),description:lf("Display a webcam video stream or a green background behind the code."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4738"},{id:"allowPackageExtensions",name:lf("Editor Extensions"),description:lf("Allow Extensions to add buttons in the editor."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4741"},{id:"instructions",name:lf("Wiring Instructions"),description:lf("Generate step-by-step assembly instructions for breadboard wiring."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4739"},{id:"debugger",name:lf("Debugger"),description:lf("Step through code and inspect variables in the debugger"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4729"},{id:"bluetoothUartConsole",name:"Bluetooth Console",description:lf("Receives UART message through Web Bluetooth"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4796"},{id:"bluetoothPartialFlashing",name:"Bluetooth Download",description:lf("Download code via Web Bluetooth"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4807"},{id:"simScreenshot",name:lf("Simulator Screenshots"),description:lf("Download screenshots of the simulator"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5232"},{id:"python",name:lf("Static Python"),description:lf("Use Static Python to code your device"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5390"},{id:"simGif",name:lf("Simulator Gifs"),description:lf("Download gifs of the simulator"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5297"},{id:"qrCode",name:lf("Shared QR Code"),description:lf("Generate a QR Code form the shared project url"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5456"},{id:"importExtensionFiles",name:lf("Import Extension Files"),description:lf("Import Extensions from compiled project files")},{id:"debugExtensionCode",name:lf("Debug Extension Code"),description:lf("Use the JavaScript debugger to debug extension code")},{id:"advancedBlockDebugger",name:lf("Advanced Blocks Debugger"),description:lf("Enables extra options and variables in the Blocks debugger")},{id:"snippetBuilder",name:lf("Snippet Builder"),description:lf("Try out the new snippet dialogs.")},{id:"experimentalHw",name:lf("Experimental Hardware"),description:lf("Enable support for hardware marked 'experimental' in the hardware seletion dialog")},{id:"checkForHwVariantWebUSB",name:lf("Detect Hardware with WebUSB"),description:lf("When compiling, use WebUSB to detect hardware configuration.")},{id:"githubEditor",name:lf("GitHub editor"),description:lf("Review, commit and push to GitHub."),feedbackUrl:"https://github.com/microsoft/pxt/issues/6419",enableOnline:!0},{id:"githubCompiledJs",name:lf("GitHub Pages JavaScript"),description:lf("Commit compiled javascript when creating a release"),enableOnline:!0},{id:"blocksCollapsing",name:lf("Collapse blocks"),description:lf("Collapse and expand functions or event blocks")},{id:"tutorialBlocksDiff",name:lf("Tutorial Block Diffs"),description:lf("Automatially render blocks diff in tutorials")},{id:"openProjectNewTab",name:lf("Open in New Tab"),description:lf("Open an editor in a new tab.")},{id:"openProjectNewDependentTab",name:lf("Open in New Connected Tab"),description:lf("Open connected editors in different browser tabs.")},{id:"errorList",name:lf("Error List"),description:lf("Show an error list panel for JavaScript and Python.")},{id:"timeMachine",name:lf("Time Machine"),description:lf("Save and restore past versions of a project")},{id:"forceEnableAiErrorHelp",name:lf("AI Error Explainer"),description:lf("Get AI's help explaining errors in your code"),feedbackUrl:"https://github.com/microsoft/pxt/issues/10694",enableOnline:!0}].filter(t=>e.indexOf(t.id)>-1).concat(r||[]).filter(e=>!(pxt.BrowserUtils.isPxtElectron()&&e.enableOnline))}function a(e){return!!pxt.storage.getLocal(i(e))}function l(e,t){t!=a(e)&&(t?pxt.storage.setLocal(i(e),"1"):pxt.storage.removeLocal(i(e)),s())}Object.defineProperty(n,"__esModule",{value:!0}),n.setState=n.state=n.toggle=n.isEnabled=n.someEnabled=n.clear=n.all=n.syncTheme=n.setEditorExtensionExperiments=void 0,n.setEditorExtensionExperiments=function(e){r=e},n.syncTheme=s,n.all=o,n.clear=function(){o().forEach(e=>pxt.storage.removeLocal(i(e))),s()},n.someEnabled=function(){return o().some(e=>a(e))},n.isEnabled=a,n.toggle=function(e){e.onClick?e.onClick():l(e,!a(e))},n.state=function(){const e={};return o().forEach(t=>e[t.id]=a(t)),JSON.stringify(e)},n.setState=l},{}],155:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.patchConfigEditorVersion=n.getTextAtTime=n.updateShareHistory=n.pushSnapshotOnHistory=n.updateHistory=n.parseHistoryFile=n.applySnapshot=n.createSnapshot=n.applyDiff=n.diffScriptText=n.collapseHistory=void 0;const i=18e5,r=864e5;function s(e,t,n,i,r){const s=[],l=e.entries.slice();let c=Object.assign({},t),{interval:u,minTime:d,maxTime:p}=n;void 0===d&&(d=0),void 0===p&&(p=e.lastSaveTime);let h=Object.assign({},c),f=e.lastSaveTime;for(;l.length;){const e=l.pop();c=a(c,e,r),e.timestamp>p?(s.unshift(e),h=Object.assign({},c),f=e.timestamp):e.timestamp<d?h?(s.unshift({timestamp:e.timestamp,editorVersion:e.editorVersion,changes:o(c,h,e.timestamp,i).changes}),h=void 0):s.unshift(e):f-e.timestamp>=u&&(s.unshift({timestamp:e.timestamp,editorVersion:e.editorVersion,changes:o(c,h,e.timestamp,i).changes}),h=Object.assign({},c),f=e.timestamp)}return h&&f>e.entries[0].timestamp&&s.unshift({timestamp:e.entries[0].timestamp,editorVersion:e.entries[0].editorVersion,changes:o(c,h,e.entries[0].timestamp,i).changes}),Object.assign(Object.assign({},e),{entries:s})}function o(e,t,n,i){var r,s;const o=[];for(const n of Object.keys(e))(n.endsWith(".ts")||n.endsWith(".jres")||n.endsWith(".py")||n.endsWith(".blocks")||"pxt.json"===n)&&(null==t[n]?o.push({type:"removed",filename:n,value:e[n]}):e[n]!==t[n]&&o.push({type:"edited",filename:n,patch:i(t[n],e[n])}));for(const n of Object.keys(t))(n.endsWith(".ts")||n.endsWith(".jres")||n.endsWith(".py")||n.endsWith(".blocks")||"pxt.json"===n)&&null==e[n]&&o.push({type:"added",filename:n,value:t[n]});if(o.length)return{timestamp:n,editorVersion:null===(s=null===(r=pxt.appTarget)||void 0===r?void 0:r.versions)||void 0===s?void 0:s.target,changes:o}}function a(e,t,n){const i=Object.assign({},e);for(const r of t.changes)"added"===r.type?delete i[r.filename]:"removed"===r.type?i[r.filename]=r.value:i[r.filename]=n(r.patch,e[r.filename]);return i}function l(e){let t;try{t={};const n=JSON.parse(e[pxt.CONFIG_NAME]);for(const i of n.files)i===pxt.IMAGES_CODE||i===pxt.TILEMAP_CODE?t[i]="":t[i]=e[i];if(t[pxt.CONFIG_NAME]=e[pxt.CONFIG_NAME],n.preferredEditor===pxt.BLOCKS_PROJECT_NAME?t[pxt.MAIN_BLOCKS]&&(t[pxt.MAIN_TS]=""):n.preferredEditor===pxt.PYTHON_PROJECT_NAME&&t[pxt.MAIN_PY]&&(t[pxt.MAIN_TS]=""),n.testFiles)for(const i of n.testFiles)t[i]=e[i]}catch(n){t=Object.assign({},e)}return t[pxt.HISTORY_FILE]&&delete t[pxt.HISTORY_FILE],t}function c(e){const t=JSON.parse(e);return t.entries||(t.entries=[]),t.shares||(t.shares=[]),t.snapshots||(t.snapshots=[]),t}function u(e,t){e=Object.assign({},e);try{const n=JSON.parse(e[pxt.CONFIG_NAME]);n.targetVersions&&(n.targetVersions.target=t),e[pxt.CONFIG_NAME]=JSON.stringify(n,null,4)}catch(e){}return{files:e,editorVersion:t}}function d(e,t){return{timestamp:t,editorVersion:pxt.appTarget.versions.target,text:l(e)}}function p(){var e,t;return null!=(null===(t=null===(e=pxt.appTarget)||void 0===e?void 0:e.appTheme)||void 0===t?void 0:t.timeMachineDiffInterval)?pxt.appTarget.appTheme.timeMachineDiffInterval:3e5}n.collapseHistory=function(e,t,n,i){if(!e[pxt.HISTORY_FILE])return;const r=s(c(e[pxt.HISTORY_FILE]),e,t,n,i);e[pxt.HISTORY_FILE]=JSON.stringify(r)},n.diffScriptText=o,n.applyDiff=a,n.createSnapshot=l,n.applySnapshot=function(e,t){var n;try{const i=Object.assign({},t),r=JSON.parse(e[pxt.CONFIG_NAME]);for(const t of Object.keys(e))t!==pxt.HISTORY_FILE&&(-1!==r.files.indexOf(t)||-1!==(null===(n=r.testFiles)||void 0===n?void 0:n.indexOf(t))||i[t]||(i[t]=e[t]));return i}catch(n){const i=Object.assign({},e);for(const e of Object.keys(t))i[e]=t[e];return i}},n.parseHistoryFile=c,n.updateHistory=function(e,t,n,l,u,h,f=!1){let m;e[pxt.HISTORY_FILE]?(m=c(e[pxt.HISTORY_FILE]),void 0===m.lastSaveTime&&(m.lastSaveTime=n)):m={entries:[],snapshots:[d(e,n-1)],shares:[],lastSaveTime:n};const g=m.lastSaveTime;for(const e of l)m.shares.some(t=>t.id===e.id)||m.shares.push({id:e.id,timestamp:n});if(function(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const r of n){if(-1===i.indexOf(r))return!1;if(e[r]!==t[r])return!1}return!0}(e,t))return void(t[pxt.HISTORY_FILE]=JSON.stringify(m));let _=!1;if(1===m.entries.length){n-m.entries[m.entries.length-1].timestamp<p()&&(_=!0)}else if(m.entries.length>1){const e=m.entries[m.entries.length-1].timestamp,t=m.entries[m.entries.length-2].timestamp;n-e<p()&&e-t<p()&&(_=!0)}if(_){const n=m.entries.pop(),i=o(a(e,n,h),t,n.timestamp,u);i&&m.entries.push(i)}else{const n=o(e,t,m.lastSaveTime,u);n&&m.entries.push(n)}if(f&&Math.floor(g/r)!==Math.floor(n/r)&&(m=s(m,t,{interval:72e5,maxTime:n-r},u,h)),m.lastSaveTime=n,0==m.snapshots.length)m.snapshots.push(d(e,n-1));else if(n-m.snapshots[m.snapshots.length-1].timestamp>=function(){var e,t;if(null!=(null===(t=null===(e=pxt.appTarget)||void 0===e?void 0:e.appTheme)||void 0===t?void 0:t.timeMachineSnapshotInterval))return pxt.appTarget.appTheme.timeMachineSnapshotInterval;return i}()){m.snapshots.push(d(e,n));const t=[];let i=Math.floor(n/r)*r;for(let e=0;e<m.snapshots.length;e++){const s=m.snapshots[m.snapshots.length-1-e];n-s.timestamp<r||e===m.snapshots.length-1?t.unshift(s):s.timestamp<i&&(t.unshift(s),i=Math.floor(s.timestamp/r)*r)}m.snapshots=t}for(const e of m.snapshots)e.text[pxt.HISTORY_FILE]&&delete e.text[pxt.HISTORY_FILE];t[pxt.HISTORY_FILE]=JSON.stringify(m)},n.pushSnapshotOnHistory=function(e,t){let n;n=e[pxt.HISTORY_FILE]?c(e[pxt.HISTORY_FILE]):{entries:[],snapshots:[],shares:[],lastSaveTime:t},n.snapshots.push(d(e,t)),e[pxt.HISTORY_FILE]=JSON.stringify(n)},n.updateShareHistory=function(e,t,n){let i;i=e[pxt.HISTORY_FILE]?c(e[pxt.HISTORY_FILE]):{entries:[],snapshots:[],shares:[],lastSaveTime:t};for(const e of n)i.shares.some(t=>t.id===e.id)||i.shares.push({id:e.id,timestamp:t});e[pxt.HISTORY_FILE]=JSON.stringify(i)},n.getTextAtTime=function(e,t,n,i){let r=Object.assign({},e);for(let e=0;e<t.entries.length;e++){const s=t.entries.length-1-e,o=t.entries[s];if(r=a(r,o,i),o.timestamp===n){return u(r,s>0?t.entries[s-1].editorVersion:o.editorVersion)}}return{files:r,editorVersion:pxt.appTarget.versions.target}},n.patchConfigEditorVersion=u},{}],156:[function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.importDb=n.validation=n.experiments=n.workspace=n.monaco=n.history=void 0;const s=e("./history");n.history=s;const o=e("./monaco");n.monaco=o;const a=e("./workspace");n.workspace=a;const l=e("./experiments");n.experiments=l;const c=e("./code-validation");n.validation=c;const u=e("./projectImport");n.importDb=u,r(e("./editor"),n),r(e("./editorcontroller"),n),r(e("./monaco-fields/monacoFieldEditor"),n),r(e("./monaco-fields/field_tilemap"),n),r(e("./monaco-fields/field_musiceditor"),n),r(e("./monaco-fields/field_soundEffect"),n),r(e("./monaco-fields/field_sprite"),n),r(e("./monaco-fields/field_react"),n)},{"./code-validation":144,"./editor":152,"./editorcontroller":153,"./experiments":154,"./history":155,"./monaco":163,"./monaco-fields/field_musiceditor":157,"./monaco-fields/field_react":158,"./monaco-fields/field_soundEffect":159,"./monaco-fields/field_sprite":160,"./monaco-fields/field_tilemap":161,"./monaco-fields/monacoFieldEditor":162,"./projectImport":164,"./workspace":165}],157:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.songEditorDefinition=n.MonacoSongEditor=void 0;const i=e("./field_react"),r=e("./monacoFieldEditor"),s="music-editor";class o extends i.MonacoReactFieldEditor{textToValue(e){this.isPython=-1===e.indexOf("`"),this.text=e;const t=pxt.parseAssetTSReference(e);if(t){const{name:e}=t,n=e.trim(),i=pxt.react.getTilemapProject();this.isAsset=!0;const r=i.lookupAssetByName("song",n);if(r)return this.editing=r,r;{const e=i.createNewSong(pxt.assets.music.getEmptySong(2));return n&&!i.isNameTaken("song",n)&&pxt.validateAssetName(n)&&(e.meta.displayName=n),this.editing=e,e}}const n=/hex\s*(?:`|\(""")\s*([a-fA-F0-9]*)\s*(?:`|"""\))\s*(?:;?)/m.exec(e);if(n){const e=n[1].trim();return this.editing=a(e?pxt.assets.music.decodeSongFromHex(e):pxt.assets.music.getEmptySong(2)),this.editing}}resultToText(e){var t;const n=pxt.react.getTilemapProject();if(n.pushUndo(),null===(t=(e=pxt.patchTemporaryAsset(this.editing,e,n)).meta)||void 0===t?void 0:t.displayName)return e=this.isAsset||n.lookupAsset(e.type,e.id)?n.updateAsset(e):n.createNewSong(e.song,e.meta.displayName),this.isAsset=!0,pxt.getTSReferenceForAsset(e,this.isPython);let i=pxt.assets.music.encodeSongToHex(e.song);return i=this.isPython?`hex("""${i}""")`:"hex`"+i+"`",this.text.replace(/hex\s*(?:`|\(""")\s*([a-fA-F0-9]*)\s*(?:`|"""\))\s*(?:;?)/m,i)}getFieldEditorId(){return s}getOptions(){return{blocksInfo:this.host.blocksInfo()}}}function a(e){return{type:"song",id:"",internalID:0,meta:{},song:e}}n.MonacoSongEditor=o,n.songEditorDefinition={id:s,foldMatches:!0,glyphCssClass:"fas fa-music sprite-focus-hover",heightInPixels:510,matcher:{searchString:'(?:(?:assets\\s*\\.\\s*song)|(?:music\\s*\\.\\s*create(?:S|_s)ong\\s*\\(\\s*hex))\\s*(?:`|\\(\\s*""")(?:(?:[^(){}:\\[\\]"\';?/,+\\-=*&|^%!`~]|\\n)*)\\s*(?:`|"""\\s*\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:o},(0,r.registerMonacoFieldEditor)(s,n.songEditorDefinition)},{"./field_react":158,"./monacoFieldEditor":162}],158:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MonacoReactFieldEditor=void 0;n.MonacoReactFieldEditor=class{getId(){return"image-editor"}showEditorAsync(e,t,n){return this.fileType=e,this.editrange=t,this.host=n,this.initAsync().then(()=>{const e=this.textToValue(n.getText(t));return e?(this.fv=pxt.react.getFieldEditorView(this.getFieldEditorId(),e,this.getOptions()),this.fv.onHide(()=>{this.onClosed()}),this.fv.show(),new Promise((e,t)=>{this.resolver=e,this.rejecter=t})):Promise.resolve(null)})}onClosed(){this.resolver&&(this.resolver({range:this.editrange,replacement:this.resultToText(this.fv.getResult())}),this.editrange=void 0,this.resolver=void 0,this.rejecter=void 0)}dispose(){this.onClosed()}initAsync(){return Promise.resolve()}textToValue(e){return null}resultToText(e){return e+""}getFieldEditorId(){return""}getOptions(){return null}}},{}],159:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.soundEditorDefinition=n.MonacoSoundEffectEditor=void 0;const i=e("./field_react"),r=e("./monacoFieldEditor"),s="soundeffect-editor";class o extends i.MonacoReactFieldEditor{textToValue(e){const t={wave:"sine",startFrequency:5e3,endFrequency:0,startVolume:255,endVolume:0,duration:500,effect:"none",interpolation:"linear"};this.value=t;const n=/\(([^)]*)\)/.exec(e)[1].split(",").map(e=>e.replace(/\s/g,""));if(8!==n.length)return t;switch(n[0]){case"WaveShape.Sawtooth":t.wave="sawtooth";break;case"WaveShape.Square":t.wave="square";break;case"WaveShape.Noise":t.wave="noise";break;case"WaveShape.Triangle":t.wave="triangle";break;default:t.wave="sine"}const i=(e,t)=>isNaN(e)?t:e;switch(t.startFrequency=i(parseInt(n[1]),t.startFrequency),t.endFrequency=i(parseInt(n[2]),t.endFrequency),t.startVolume=i(parseInt(n[3]),t.startVolume),t.endVolume=i(parseInt(n[4]),t.endVolume),t.duration=i(parseInt(n[5]),t.duration),n[6]){case"SoundExpressionEffect.Vibrato":t.effect="vibrato";break;case"SoundExpressionEffect.Tremolo":t.effect="tremolo";break;case"SoundExpressionEffect.Warble":t.effect="warble";break;default:t.effect="none"}switch(n[7]){case"InterpolationCurve.Logarithmic":t.interpolation="logarithmic";break;case"InterpolationCurve.Curve":t.interpolation="curve";break;default:t.interpolation="linear"}return t}resultToText(e){let t,n,i;switch((e=this.value).wave){case"sine":t="WaveShape.Sine";break;case"square":t="WaveShape.Square";break;case"triangle":t="WaveShape.Triangle";break;case"noise":t="WaveShape.Noise";break;case"sawtooth":t="WaveShape.Sawtooth"}switch(e.effect){case"vibrato":n="SoundExpressionEffect.Vibrato";break;case"tremolo":n="SoundExpressionEffect.Tremolo";break;case"warble":n="SoundExpressionEffect.Warble";break;case"none":n="SoundExpressionEffect.None"}switch(e.interpolation){case"curve":i="InterpolationCurve.Curve";break;case"linear":i="InterpolationCurve.Linear";break;case"logarithmic":i="InterpolationCurve.Logarithmic"}return`music.createSoundEffect(${t}, ${Math.round(e.startFrequency)}, ${Math.round(e.endFrequency)}, ${Math.round(e.startVolume)}, ${Math.round(e.endVolume)}, ${Math.round(e.duration)}, ${n}, ${i})`}getFieldEditorId(){return s}getOptions(){return{onClose:()=>this.fv.hide(),onSoundChange:e=>this.value=e,initialSound:this.value,useFlex:!0,useMixerSynthesizer:"microbit"!==pxt.appTarget.id}}}n.MonacoSoundEffectEditor=o,n.soundEditorDefinition={id:s,foldMatches:!0,glyphCssClass:"fas fa-music sprite-focus-hover",heightInPixels:510,matcher:{searchString:"music\\s*\\.\\s*createSoundEffect\\s*\\(",isRegex:!0,matchCase:!0,matchWholeWord:!1,validateRange:function(e,t){let n=e.startLineNumber,i=0,r=!1,s=0;const o="createSoundEffect",a=t.getLineCount();for(;n<a;){const a=t.getLineContent(n),l=a.indexOf(o);if(-1!==l&&(r=!0,i=l+17),r)for(;i<a.length;){const r=a.charAt(i);if("("===r)s++;else if(")"===r&&(s--,0===s))return new monaco.Range(e.startLineNumber,e.startColumn,n,i+t.getLineMinColumn(n)+1);i++}i=0,n++}}},proto:o},(0,r.registerMonacoFieldEditor)(s,n.soundEditorDefinition)},{"./field_react":158,"./monacoFieldEditor":162}],160:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.spriteEditorDefinition=n.MonacoSpriteEditor=void 0;const i=e("./field_react"),r=e("./monacoFieldEditor"),s="image-editor";class o extends i.MonacoReactFieldEditor{textToValue(e){this.isPython=-1===e.indexOf("`"),this.template=e.startsWith("bmp")?"bmp":"img";const t=pxt.parseAssetTSReference(e);if(t){const{name:e}=t,n=e.trim(),i=pxt.react.getTilemapProject();this.isAsset=!0;const r=i.lookupAssetByName("image",n);if(r)return this.editing=r,r;{const e=i.createNewImage();return n&&!i.isNameTaken("image",n)&&pxt.validateAssetName(n)&&(e.meta.displayName=n),this.editing=e,e}}return this.editing={type:"image",id:"",internalID:0,bitmap:pxt.sprite.imageLiteralToBitmap(e,this.template).data(),meta:{},jresData:""},this.editing}resultToText(e){var t;const n=pxt.react.getTilemapProject();return n.pushUndo(),(null===(t=(e=pxt.patchTemporaryAsset(this.editing,e,n)).meta)||void 0===t?void 0:t.displayName)?(e=this.isAsset||n.lookupAsset(e.type,e.id)?n.updateAsset(e):n.createNewProjectImage(e.bitmap,e.meta.displayName),this.isAsset=!0,pxt.getTSReferenceForAsset(e,this.isPython)):pxt.sprite.bitmapToImageLiteral(pxt.sprite.Bitmap.fromData(e.bitmap),this.isPython?"python":"typescript",this.template)}getFieldEditorId(){return"image-editor"}getOptions(){return{initWidth:16,initHeight:16,blocksInfo:this.host.blocksInfo()}}}n.MonacoSpriteEditor=o,n.spriteEditorDefinition={id:s,foldMatches:!0,glyphCssClass:"sprite-editor-glyph sprite-focus-hover",heightInPixels:510,matcher:{searchString:'(?:img|bmp|assets\\s*\\.\\s*image)\\s*(?:`|\\(\\s*""")(?:(?:[^(){}:\\[\\]"\';?/,+\\-=*&|^%!`~]|\\n)*)\\s*(?:`|"""\\s*\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:o},(0,r.registerMonacoFieldEditor)(s,n.spriteEditorDefinition)},{"./field_react":158,"./monacoFieldEditor":162}],161:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.tilemapEditorDefinition=n.MonacoTilemapEditor=void 0;const i=e("./field_react"),r=e("./monacoFieldEditor"),s="tilemap-editor";class o extends i.MonacoReactFieldEditor{textToValue(e){const t=this.readTilemap(e),n=pxt.react.getTilemapProject();return pxt.sprite.addMissingTilemapTilesAndReferences(n,t),this.editing=t,t}readTilemap(e){const t=pxt.react.getTilemapProject();if(/^\s*tiles\s*\./.test(e)&&(this.isTilemapLiteral=!1,e)){try{return function(e){return{type:"tilemap",id:"",internalID:0,meta:{},data:e}}(pxt.sprite.decodeTilemap(e,"typescript",t))}catch(e){}return null}this.isTilemapLiteral=!0;const n=/^\s*(tilemap(?:4|8|16|32)?)\s*(?:`([^`]*)`)|(?:\(\s*"""([^"]*)"""\s*\))\s*$/.exec(e),i=(n[2]||n[3]||"").trim();let r,s;if(this.tilemapLiteral=n[1],i&&(s=ts.pxtc.escapeIdentifier(i),r=t.getTilemap(s)||t.lookupAssetByName("tilemap",i)),!r){let e=16;"tilemap8"===this.tilemapLiteral?e=8:"tilemap32"===this.tilemapLiteral?e=32:"tilemap4"===this.tilemapLiteral&&(e=4);const[n]=t.createNewTilemap(s,e,16,16);r=t.getTilemap(n),s=n}return r}resultToText(e){const t=pxt.react.getTilemapProject();return t.pushUndo(),e=pxt.patchTemporaryAsset(this.editing,e,t),pxt.sprite.updateTilemapReferencesFromResult(t,e),this.isTilemapLiteral?(t.updateAsset(e),pxt.getTSReferenceForAsset(e,"python"===this.fileType)):pxt.sprite.encodeTilemap(e.data,"typescript"===this.fileType?"typescript":"python")}getFieldEditorId(){return"tilemap-editor"}getOptions(){return{initWidth:16,initHeight:16,blocksInfo:this.host.blocksInfo()}}getCreateTilemapRange(){const e=this.editrange.getStartPosition();let t,n=this.editrange.getEndPosition(),i=1;for(;;){t=new monaco.Range(n.lineNumber,n.column,n.lineNumber+1,0);const r=this.host.getText(t);for(let t=0;t<r.length;t++)if("("===r.charAt(t))i++;else if(")"===r.charAt(t)&&(i--,0===i)){const i=new monaco.Position(n.lineNumber,n.column+t+2);return monaco.Range.fromPositions(e,i)}if(n=t.getEndPosition(),n.lineNumber>e.lineNumber+20)return null}}}n.MonacoTilemapEditor=o,n.tilemapEditorDefinition={id:s,foldMatches:!0,alwaysBuildOnClose:!0,glyphCssClass:"sprite-focus-hover ms-Icon ms-Icon--Nav2DMapView",heightInPixels:510,weight:5,matcher:{searchString:'(?:tilemap(?:8|16|32)?\\s*(?:`|\\(""")(?:[ a-zA-Z0-9_]|\\n)*\\s*(?:`|"""\\)))|(?:tiles\\s*\\.\\s*createTilemap\\s*\\([^\\)]+\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:o},(0,r.registerMonacoFieldEditor)(s,n.tilemapEditorDefinition)},{"./field_react":158,"./monacoFieldEditor":162}],162:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMonacoFieldEditor=n.registerMonacoFieldEditor=void 0;const i={};n.registerMonacoFieldEditor=function(e,t){i[e]=t},n.getMonacoFieldEditor=function(e){return i[e]}},{}],163:[function(e,t,n){function i(e){const t=pxt.appTarget.appTheme.invertedMonaco,n=!(!pxt.appTarget.appTheme.monacoFieldEditors||!pxt.appTarget.appTheme.monacoFieldEditors.length);let i=monaco.editor.create(e,{model:null,ariaLabel:pxt.Util.lf("JavaScript editor"),fontFamily:"'Consolas', 'Monaco', 'Menlo', 'Ubuntu Mono', 'source-code-pro', 'monospace'",scrollBeyondLastLine:!0,language:"typescript",mouseWheelZoom:!1,wordBasedSuggestions:!0,lineNumbersMinChars:3,formatOnPaste:!0,folding:n,glyphMargin:n||pxt.appTarget.appTheme.debugger,minimap:{enabled:!1},fixedOverflowWidgets:!0,autoIndent:"full",useTabStops:!0,dragAndDrop:!0,matchBrackets:"always",occurrencesHighlight:!1,quickSuggestionsDelay:200,theme:t?"vs-dark":"vs",renderIndentGuides:!0,accessibilityHelpUrl:"",quickSuggestions:{other:!0,comments:!0,strings:!0},acceptSuggestionOnCommitCharacter:!0,acceptSuggestionOnEnter:"on",accessibilitySupport:"on"});return i.layout(),i}Object.defineProperty(n,"__esModule",{value:!0}),n.createEditor=n.initMonacoAsync=n.syncModels=void 0,n.syncModels=function(e,t,n,i){if(i)return;let r=monaco.languages.typescript.typescriptDefaults.getExtraLibs(),s={};e.sortedDeps().forEach(e=>{e.getFiles().forEach(i=>{let r=e.id+"/"+i;if(/\.(ts)$/.test(i)&&r!=n){if(!monaco.languages.typescript.typescriptDefaults.getExtraLibs()[r]){let n=e.readFile(i)||"\n";t[r]=monaco.languages.typescript.typescriptDefaults.addExtraLib(n,r)}s[r]="1"}})}),Object.keys(r).filter(e=>/\.(ts)$/.test(e)&&!s[e]).forEach(e=>{t[e].dispose()})},n.initMonacoAsync=function(e){return new Promise((t,n)=>{if("object"==typeof window.monaco)return void t(i(e));let r=window.MonacoPaths,s=()=>{let n=window.require;n.config({paths:r}),n(["vs/editor/editor.main"],()=>{monaco.languages.register({id:"asm",extensions:[".asm"]}),monaco.languages.setMonarchTokensProvider("asm",{tokenPostfix:"",keywords:["movs","mov","adds","add","adcs","adr","subs","sbcs","sub","rsbs","muls","cmp","cmn","ands","eors","orrs","bics","mvns","tst","lsls","lsrs","asrs","rors","ldr","ldrh","ldrb","ldrsh","ldrsb","ldm","str","strh","strb","stm","push","pop","cbz","cbnz","b","bl","bx","blx","sxth","sxtb","uxth","uxtb","rev","rev16","revsh","svc","cpsid","cpsie","setend","bkpt","nop","sev","wfe","wfi","yield","beq","bne","bcs","bhs","bcc","blo","bmi","bpl","bvs","bvc","bhi","bls","bge","blt","bgt","ble","bal","r0","r1","r2","r3","r4","r5","r6","r7","r8","r9","r10","r11","r12","r13","r14","r15","pc","sp","lr"],typeKeywords:[".startaddr",".hex",".short",".space",".section",".string",".byte"],operators:[],symbols:/[:\*]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/(\.)?[a-z_$\.][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/@\s*[a-zA-Z_\$][\w\$]*/,{token:"annotation"}],[/(#|(0[xX]))?[0-9a-fA-F]+/,"number"],[/[;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/;.*$/,"comment"]]}}),monaco.languages.typescript&&(monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0}),monaco.languages.typescript.typescriptDefaults.setWorkerOptions({customWorkerPath:pxt.webConfig.typeScriptWorkerJs}),monaco.languages.typescript.typescriptDefaults.setCompilerOptions({allowUnreachableCode:!0,noImplicitAny:!0,allowJs:!1,allowUnusedLabels:!0,target:monaco.languages.typescript.ScriptTarget.ES5,outDir:"built",rootDir:".",noLib:!0,mouseWheelZoom:!1})),t(i(e))})};if(window.require)s();else{let e=document.createElement("script");e.type="text/javascript",e.src=r["vs/loader"],e.addEventListener("load",s),document.body.appendChild(e)}})},n.createEditor=i},{}],164:[function(e,t,n){let i;Object.defineProperty(n,"__esModule",{value:!0}),n.removeProjectAsync=n.saveProjectAsync=void 0;const r="projects";async function s(){if(i)return i;const e=pxt.appTarget.id+"-import";return i=new pxt.BrowserUtils.IDBWrapper(e,1,(e,t)=>{t.result.createObjectStore(r,{keyPath:"importId"})}),await i.openAsync(),i}n.saveProjectAsync=async function(e){const t={importId:pxt.U.guidGen(),project:e},n=await s();return await n.deleteAllAsync(r),await n.setAsync(r,t),t.importId},n.removeProjectAsync=async function(e){const t=await s(),n=await t.getAsync(r,e);return await t.deleteAllAsync(r),null==n?void 0:n.project}},{}],165:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.freshHeader=void 0,n.freshHeader=function(e,t){return{target:pxt.appTarget.id,targetVersion:pxt.appTarget.versions.target,name:e,meta:{},editor:pxt.JAVASCRIPT_PROJECT_NAME,pubId:"",pubCurrent:!1,_rev:null,id:pxt.U.guidGen(),recentUse:t,modificationTime:t,cloudUserId:null,cloudCurrent:!1,cloudVersion:null,cloudLastSyncTime:0,isDeleted:!1}}},{}],166:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const i=e("./runner"),r=e("./renderer"),s=e("../pxteditor");window.pxt||(window.pxt={}),window.pxt.runner=Object.assign(Object.assign({},i),r),window.pxt.editor=Object.assign({},s),function(){let e=window.ksRunnerWhenLoaded;e&&e()}()},{"../pxteditor":156,"./renderer":167,"./runner":168}],167:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.renderAsync=n.fireClickOnEnter=n.defaultClientRenderOptions=void 0;const i=e("./runner"),r=e("blockly"),s=e("../pxtblocks"),o=e("../pxtblocks/codecardRenderer");function a(){return{blocksAspectRatio:window.innerHeight<window.innerWidth?1.62:1/1.62,snippetClass:"lang-blocks",signatureClass:"lang-sig",blocksClass:"lang-block",blocksXmlClass:"lang-blocksxml",diffBlocksXmlClass:"lang-diffblocksxml",diffClass:"lang-diff",diffStaticPythonClass:"lang-diffspy",diffBlocksClass:"lang-diffblocks",staticPythonClass:"lang-spy",simulatorClass:"lang-sim",linksClass:"lang-cards",namespacesClass:"lang-namespaces",apisClass:"lang-apis",codeCardClass:"lang-codecard",packageClass:"lang-package",jresClass:"lang-jres",assetJSONClass:"lang-assetsjson",projectClass:"lang-project",snippetReplaceParent:!0,simulator:!0,showEdit:!0,hex:!0,tutorial:!1,showJavaScript:!1,hexName:pxt.appTarget.id}}function l(e){"undefined"!=typeof hljs&&(e.hasClass("highlight")?hljs.highlightBlock(e[0]):e.find("code.highlight").each(function(e,t){hljs.highlightBlock(t)}),c(e))}function c(e){e.find("span.hljs-comment:contains(@highlight)").each((e,t)=>{try{!function(e){const t=$(e),n=document.createElement("span");n.className="highlight-line";let i=e.nextSibling;if(!i||i.nodeType!=Node.TEXT_NODE)return;let r=i.textContent,s=r.indexOf("\n");if(s<0)return;i.textContent=r.substring(0,s+1),$(document.createTextNode(r.substring(s+1).replace(/^\s+/,""))).insertAfter($(i)),i=i.nextSibling;for(;i;){let e=i.nextSibling;if(i.nodeType==Node.TEXT_NODE){r=i.textContent;const t=r.indexOf("\n");if(!(t<0)){n.appendChild(document.createTextNode(r.substring(0,t))),i.textContent=r.substring(t+1);break}n.appendChild(i),i=e}else n.appendChild(i),i=e}$(n).insertAfter(t),t.remove()}(t)}catch(e){pxt.reportException(e)}})}function u(e,t){e.append($('<div class="ui content blocks"/>').append(t))}function d(e,t,n){e.append($('<div class="ui content js"><div class="subheading"><i class="ui icon xicon js"></i>JavaScript</div></div>').append(t)),l(t)}function p(e,t,n){e.append($('<div class="ui content py"><div class="subheading"><i class="ui icon xicon python"></i>Python</div></div>').append(t)),l(t)}function h(e,t){const n=$('<a class="item" role="button" tabindex="0"><i role="presentation" aria-hidden="true"></i><span class="ui desktop only"></span></a>');return n.attr("aria-label",e),n.attr("title",e),n.find("i").attr("class",t),n.find("span").text(e),n.keypress(f),n}function f(e){const t="number"==typeof e.which?e.which:e.keyCode;13!==t&&32!==t||(e.preventDefault(),e.currentTarget.click())}n.defaultClientRenderOptions=a,n.fireClickOnEnter=f;let m=!1;function g(e,t,n,i,r,s,o={}){let a=$('<div class="ui bottom attached tabular icon small compact menu hideprint"> <div class="right icon menu"></div></div>'),l=$('<div class="ui top attached segment codewidget"></div>'),c=a.find(".right.menu");const f=pxt.appTarget.appTheme||{};if(o.showEdit&&!f.hideDocsEdit&&s){const t=h(lf("Edit"),"edit icon"),{package:n,compileBlocks:o,compilePython:a}=s,l=n.host();if(r&&o?(n.setPreferredEditor(pxt.BLOCKS_PROJECT_NAME),l.writeFile(n,pxt.MAIN_BLOCKS,o.outfiles[pxt.MAIN_BLOCKS])):i&&a?(n.setPreferredEditor(pxt.PYTHON_PROJECT_NAME),l.writeFile(n,pxt.MAIN_PY,o.outfiles[pxt.MAIN_PY])):n.setPreferredEditor(pxt.JAVASCRIPT_PROJECT_NAME),e.assetJSON)for(const t of Object.keys(e.assetJSON))n.config.files.indexOf(t)<0&&n.config.files.push(t),l.writeFile(n,t,e.assetJSON[t]);const u=n.compressToFileAsync();t.click(()=>{pxt.tickEvent("docs.btn",{button:"edit"}),u.then(t=>{window.open(`${function(e){const t=e.pxtUrl||pxt.appTarget.appTheme.homeUrl;return(t||"").replace(/\/$/,"")}(e)}/#project:${ts.pxtc.encodeBase64(pxt.Util.uint8ArrayToString(t))}`,"pxt")})}),c.append(t)}if(e.showJavaScript||!r&&!i?(l.append(n),_(),b()):r?(l.append(r),y(),b()):i&&(l.append(i),_(),y()),o.run&&!f.hideDocsSimulator){let t=h(lf("Run"),"play icon").click(()=>{if(pxt.tickEvent("docs.btn",{button:"sim"}),l.find(".sim")[0])l.find(".sim").remove(),v(l);else{m||(m=!0,window.addEventListener("message",e=>{const t=e.data;if("aspectratio"!==t.type)return;const n=t.frameid,i=t.value,r=document.querySelector(`iframe[data-frameid="${n}"]`);(null==r?void 0:r.parentElement)&&(r.parentElement.style.paddingBottom=100/i+"%")}));let t="81.97%";pxt.appTarget.simulator&&(t=100/pxt.appTarget.simulator.aspectRatio+"%");const i=e.package?"&deps="+encodeURIComponent(e.package):"",r=C(e)+"#nofooter=1"+i,s=e.assetJSON?`data-assets="${encodeURIComponent(JSON.stringify(e.assetJSON))}"`:"",o=encodeURIComponent(n.text()),a=`sim-${pxt.Util.guidGen()}`;let c=$(`<div class="ui card sim"><div class="ui content"><div style="position:relative;height:0;padding-bottom:${t};overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${r}" data-code="${o}" data-frameid="${a}" ${s} allowfullscreen="allowfullscreen" sandbox="allow-popups allow-forms allow-scripts allow-same-origin" frameborder="0"></iframe></div></div></div>`);l.append(c),v(c)}});c.append(t)}if(o.hexname&&o.hex){let e=h(lf("Download"),"download icon").click(()=>{pxt.tickEvent("docs.btn",{button:"hex"}),pxt.BrowserUtils.browserDownloadBinText(o.hex,o.hexname,{contentType:pxt.appTarget.compile.hexMimeType})});c.append(e)}let g=$("<div class=codesnippet></div>");function _(){if(!r)return;const e=h(lf("Blocks"),"icon xicon blocks").click(()=>{pxt.tickEvent("docs.btn",{button:"blocks"}),l.find(".blocks")[0]?(l.find(".blocks").remove(),v(l)):(u(n?n.parent():l,r),v(r))});c.append(e)}function y(){if(n)if(o.showJs)d(l,n);else{const e=h("JavaScript","icon xicon js").click(()=>{pxt.tickEvent("docs.btn",{button:"js"}),l.find(".js")[0]?(l.find(".js").remove(),v(l)):(d(r?r.parent():l,n),v(n))});c.append(e)}}function b(){if(i)if(o.showPy)p(l,i);else{const e=h("Python","icon xicon python").click(()=>{pxt.tickEvent("docs.btn",{button:"py"}),l.find(".py")[0]?(l.find(".py").remove(),v(l)):(p(r?r.parent():l,i),v(i))});c.append(e)}}function v(e){var t;null===(t=e[0])||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"})}c.children().length&&g.append(a),g.append(l),t.replaceWith(g)}let _,y=[];function b(e,t,n){if(!e)return Promise.resolve();let i=$("."+e).first();return i[0]?(n.emPixels||(n.emPixels=18),n.layout||(n.layout=1),n.splitSvg=!0,y.push({el:i,source:i.text(),options:n,render:t}),i.addClass("lang-shadow"),i.removeClass(e),b(e,t,n)):Promise.resolve()}function v(e){if(!e||e.kind!=ts.SyntaxKind.ExpressionStatement)return null;let t=e;if(!t.expression||t.expression.kind!=ts.SyntaxKind.CallExpression)return null;let n=t.expression;return pxtc.pxtInfo(n).callInfo}function T(e){return _||(_=(0,i.decompileSnippetAsync)("",e)),_}function k(e,t){if(!t)return;const n=/^\/(v\d+)/.exec(t.url),i=/^\/(v\d+)/.exec(window.location.pathname),r=/#doc/i.test(window.location.href);t.url&&!n&&i&&!r&&(t.url=`/${i[1]}/${t.url}`);const s=document.createElement("div");s.setAttribute("role","listitem"),s.append((0,o.renderCodeCard)(t,{hideHeader:!0,shortName:!0})),e.append(s)}function x(e,t,n){const i=t.attributes,s=!i.blockHidden&&r.Blocks[i.blockId];if(null==s?void 0:s.codeCard){const t=pxt.U.clone(s.codeCard);n&&(t.style=n),k(e,t)}else k(e,{name:t.qName,description:i.jsDoc,url:i.help||void 0,style:n})}function E(e,t,n,i){return b(t,(e,t)=>{const s=t.compileProgram;if(!s)return;const o=s.getSourceFile(pxt.MAIN_TS).statements.slice(0),a=document.createElement("div");a.setAttribute("role","list"),a.className="card-list",o.forEach(e=>{const n=e.kind,s=v(e);if(s&&t.apiInfo&&t.apiInfo.byQName[s.qName]){const e=t.apiInfo.byQName[s.qName],n=e.attributes,o=r.Blocks[n.blockId];if(i){const i=e,r=t.compileBlocks.blocksInfo.apis.byQName[i.namespace];k(a,{name:r.attributes.blockNamespace||r.name,url:r.attributes.help||"reference/"+(r.attributes.blockNamespace||r.name).toLowerCase(),description:r.attributes.jsDoc,blocksXml:o&&o.codeCard?o.codeCard.blocksXml:n.blockId?`<xml xmlns="http://www.w3.org/1999/xhtml"><block type="${n.blockId}"></block></xml>`:void 0})}else x(a,e)}else switch(n){case ts.SyntaxKind.ExpressionStatement:{const t=e;switch(t.expression.kind){case ts.SyntaxKind.TrueKeyword:case ts.SyntaxKind.FalseKeyword:k(a,{name:"Boolean",url:"blocks/logic/boolean",description:lf("True or false values"),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="logic_boolean"><field name="BOOL">TRUE</field></block></xml>'});break;default:pxt.debug(`card expr kind: ${t.expression.kind}`)}break}case ts.SyntaxKind.IfStatement:k(a,{name:i?"Logic":"if",url:"blocks/logic"+(i?"":"/if"),description:lf(i?"Logic operators and constants":"Conditional statement"),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_if"></block></xml>'});break;case ts.SyntaxKind.WhileStatement:k(a,{name:i?"Loops":"while",url:"blocks/loops"+(i?"":"/while"),description:lf(i?"Loops and repetition":"Repeat code while a condition is true."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="device_while"></block></xml>'});break;case ts.SyntaxKind.ForOfStatement:k(a,{name:i?"Loops":"for of",url:"blocks/loops"+(i?"":"/for-of"),description:lf(i?"Loops and repetition":"Repeat code for each item in a list."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_for_of"></block></xml>'});break;case ts.SyntaxKind.BreakStatement:k(a,{name:i?"Loops":"break",url:"blocks/loops"+(i?"":"/break"),description:lf(i?"Loops and repetition":"Break out of the current loop."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="break_keyword"></block></xml>'});break;case ts.SyntaxKind.ContinueStatement:k(a,{name:i?"Loops":"continue",url:"blocks/loops"+(i?"":"/continue"),description:lf(i?"Loops and repetition":"Skip iteration and continue the current loop."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="continue_keyboard"></block></xml>'});break;case ts.SyntaxKind.ForStatement:{let t=e,n=!0;3==t.condition.getChildCount()&&(n=!("0"==t.condition.getChildAt(0).getText()||t.condition.getChildAt(1).kind==ts.SyntaxKind.LessThanToken)),k(a,n?{name:i?"Loops":"for",url:"blocks/loops"+(i?"":"/for"),description:lf(i?"Loops and repetition":"Repeat code for a given number of times using an index."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_simple_for"></block></xml>'}:{name:i?"Loops":"repeat",url:"blocks/loops"+(i?"":"/repeat"),description:lf(i?"Loops and repetition":"Repeat code for a given number of times."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_repeat_ext"></block></xml>'});break}case ts.SyntaxKind.VariableStatement:k(a,{name:i?"Variables":"variable declaration",url:"blocks/variables"+(i?"":"/assign"),description:lf(i?"Variables":"Assign a value to a named variable."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="variables_set"></block></xml>'});break;default:pxt.debug(`card kind: ${n}`)}}),n&&(e=e.parent()),e.replaceWith(a)},{package:e.package,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}function S(e,t){if(!e)return Promise.resolve();let n=$("."+e).first();if(!n[0])return Promise.resolve();n.removeClass(e);const i=pxt.gallery.parseCodeCardsHtml(n[0]);return i||n.append($("<div/>").addClass("ui segment warning").text("invalid codecard format")),t.snippetReplaceParent&&(n=n.parent()),function(e,t,n){if(!t||0==t.length)return Promise.resolve();if(0==t.length){let i=(0,o.renderCodeCard)(t[0],n);e.replaceWith(i)}else{let i=document.createElement("div");i.className="card-list",i.setAttribute("role","list"),i.setAttribute("aria-label",n.cardCategory||lf("Content cards")),t.forEach(e=>{const t=/^\/(v\d+)/.exec(e.url),r=/^\/(v\d+)/.exec(window.location.pathname),s=/#doc/i.test(window.location.href);e.url&&!t&&r&&!s&&(e.url=`/${r[1]}${e.url}`);const a=(0,o.renderCodeCard)(e,n),l=document.createElement("div");if(l.setAttribute("role","listitem"),l.appendChild(a),i.appendChild(l),"package"==e.cardType){const t=pxt.github.parseRepoId((e.url||"").replace(/^\/pkg\//,""));t&&pxt.packagesConfigAsync().then(i=>{switch(pxt.github.repoStatus(t,i)){case pxt.github.GitRepoStatus.Banned:a.remove();break;case pxt.github.GitRepoStatus.Approved:e.imageUrl=pxt.github.mkRepoIconUrl(t),l.insertBefore((0,o.renderCodeCard)(e,n),a),a.remove()}}).catch(t=>{pxt.reportException(t),pxt.debug(`failed to load repo ${e.url}`)})}}),e.replaceWith(i)}return Promise.resolve()}(n,i,{hideHeader:!0,cardCategory:t.hexName}).then(()=>pxt.U.delay(1,S(e,t)))}function C(e){return e.pxtUrl?e.pxtUrl+"/--run":pxt.webConfig&&pxt.webConfig.runUrl?pxt.webConfig.runUrl:"/--run"}function w(e){const t={showEdit:!!e.showEdit,run:!!e.simulator};$("code.lang-python").each((n,i)=>{!function(n,i){"undefined"!=typeof hljs&&($(n).text($(n).text().replace(/^\s*\r?\n/,"")),hljs.highlightBlock(n),c($(n)));const r=pxt.U.clone(t);i&&(r.run=!1,r.showEdit=!1),g(e,$(n).parent(),$(n),void 0,void 0,void 0,r)}(i,!1),$(i).removeClass("lang-python")})}function I(e,t){t.snippetReplaceParent&&(e=e.parent()),e.remove()}function A(e,t,n){$(`code.lang-${e}\\.${t}`).each((e,t)=>{I($(t),n)})}n.renderAsync=function(e){return pxt.analytics.enable(pxt.Util.userLanguage()),e||(e=a()),e.pxtUrl&&(e.pxtUrl=e.pxtUrl.replace(/\/$/,"")),e.showEdit&&(e.showEdit=!pxt.BrowserUtils.isIFrame()),function(e){e.packageClass&&($("."+e.packageClass).each((t,n)=>{let i=$(n),r=i.text().split("\n").map(e=>e.replace(/\s*/g,"")).filter(e=>!!e).join(",");e.package=e.package?`${e.package},${r}`:r,e.snippetReplaceParent&&(i=i.parent()),i.remove()}),$(".lang-config").each((t,n)=>{let i=$(n);e.snippetReplaceParent&&(i=i.parent()),i.remove()}))}(e),function(e){let t,n;e.jresClass&&$(`.${e.jresClass}`).each((e,t)=>{const i=$(t);n=i.text(),t.parentElement.remove()}),e.assetJSONClass&&$(`.${e.assetJSONClass}`).each((e,n)=>{const i=$(n);t=i.text(),n.parentElement.remove()}),e.assetJSON=function(e,t){if(!e&&!t)return;const n=pxt.tutorial.parseAssetJson(e)||{};if(t){const e=JSON.parse(t);n[pxt.TILEMAP_JRES]=JSON.stringify(e),n[pxt.TILEMAP_CODE]=pxt.emitTilemapsFromJRes(e)}return n}(t,n)}(e),y=[],function(e){I($("code.lang-ghost"),e)}(e),function(e){A("blockconfig","local",e),A("blockconfig","global",e)}(e),function(e){I($("code.lang-template"),e)}(e),function(e){A("validation","local",e),A("validation","global",e)}(e),function(e){e.simulatorClass&&$("."+e.simulatorClass).each((t,n)=>{var i;let r=$(n),s="81.97%";pxt.appTarget.simulator&&(s=100/pxt.appTarget.simulator.aspectRatio+"%");const o=lf("MakeCode {0} Simulator",(null===(i=pxt.appTarget.appTheme)||void 0===i?void 0:i.boardName)||pxt.appTarget.name);let a=$(`\n            <div class="ui card">\n                <div class="ui content">\n                    <div style="position:relative;height:0;padding-bottom:${s};overflow:hidden;">\n                        <iframe\n                            style="position:absolute;top:0;left:0;width:100%;height:100%;"\n                            allowfullscreen="allowfullscreen"\n                            frameborder="0"\n                            sandbox="allow-popups allow-forms allow-scripts allow-same-origin"\n                            title="${pxt.U.htmlEscape(o)}"\n                        ></iframe>\n                    </div>\n                </div>\n            </div>\n        `);const l=e.package?"&deps="+encodeURIComponent(e.package):"",c=C(e)+"#nofooter=1"+l,u=encodeURIComponent(r.text().trim()),d=a.find("iframe");d.attr("src",c),d.attr("data-code",u),e.assetJSON&&d.attr("data-assets",JSON.stringify(e.assetJSON)),e.snippetReplaceParent&&(r=r.parent()),r.replaceWith(a)})}(e),function(e){const t={showEdit:!!e.showEdit,run:!!e.simulator};function n(n,i){"undefined"!=typeof hljs&&($(n).text($(n).text().replace(/^\s*\r?\n/,"")),hljs.highlightBlock(n),c($(n)));const r=pxt.U.clone(t);i&&(r.run=!1,r.showEdit=!1),g(e,$(n).parent(),$(n),void 0,void 0,void 0,r)}$("code.lang-typescript").each((e,t)=>{n(t,!1),$(t).removeClass("lang-typescript")}),$("code.lang-typescript-ignore").each((e,t)=>{$(t).removeClass("lang-typescript-ignore"),$(t).addClass("lang-typescript"),n(t,!0),$(t).removeClass("lang-typescript")}),$("code.lang-typescript-invalid").each((e,t)=>{$(t).removeClass("lang-typescript-invalid"),$(t).addClass("lang-typescript"),n(t,!0),$(t).removeClass("lang-typescript"),$(t).parent("div").addClass("invalid"),$(t).parent("div").prepend($("<i>",{class:"icon ban"})),$(t).addClass("invalid")}),$("code.lang-typescript-valid").each((e,t)=>{$(t).removeClass("lang-typescript-valid"),$(t).addClass("lang-typescript"),n(t,!0),$(t).removeClass("lang-typescript"),$(t).parent("div").addClass("valid"),$(t).parent("div").prepend($("<i>",{class:"icon check"})),$(t).addClass("valid")})}(e),w(e),Promise.resolve().then(()=>S(e.codeCardClass,e)).then(()=>async function(e){if("core"==pxt.appTarget.id)return;const t=(await T(e)).compileBlocks.blocksInfo;let n={};for(const e of t.blocks){const i=(e.attributes.blockNamespace||e.namespace).split(".")[0];if(!n[i]){const e=t.apis.byQName[i];e&&e.attributes.color&&(n[i]=e.attributes.color)}}let i="";for(const e of Object.keys(n)){const t=n[e];i+=`\n                span.docs.${e.toLowerCase()} {\n                    --inline-namespace-color: ${t};\n                }\n            `}for(const e of Object.keys(pxt.toolbox.blockColors)){const t=pxt.toolbox.getNamespaceColor(e);i+=`\n                span.docs.${e.toLowerCase()} {\n                    --inline-namespace-color: ${t};\n                }\n            `}let r=document.createElement("style");r.id="namespaceColors",r.type="text/css",(document.head||document.getElementsByTagName("head")[0]).appendChild(r),r.appendChild(document.createTextNode(i))}(e)).then(()=>function(e){(e=pxt.Util.clone(e)).emPixels=18,e.snippetMode=!0;const t=$(":not(pre) > code");let n=0;return function r(){if(n>=t.length)return Promise.resolve();const s=$(t[n++]),o=s.text(),a=/^(\|+)([^\|]+)\|+$/.exec(o);if(a){const e=/^(([^\:\.]*?)[\:\.])?(.*)$/.exec(a[2]),t=(e[2]?e[2].trim().toLowerCase():"").replace(/\(.*?\)/g,""),n=1==a[1].length?`docs inlinebutton ${t}`:`docs inlineblock ${t}`,i=e[3].trim();return s.replaceWith($(`<span class="${n}"/>`).text(pxt.U.rlf(i))),r()}const l=/^\[(.+)\]$/.exec(o);if(!l)return r();const c=l[1];return(0,i.decompileSnippetAsync)(c,e).then(e=>{if(e.blocksSvg){let t=$('<span class="block"/>').append(e.blocksSvg);const n=v(e.compileProgram.getSourceFile(pxt.MAIN_TS).statements[0]);if(n&&e.apiInfo){const i=e.apiInfo.byQName[n.qName];i&&i.attributes.help&&(t=$('<a class="ui link"/>').attr("href",`/reference/${i.attributes.help}`).append(t))}s.replaceWith(t)}return pxt.U.delay(1,r())})}()}(e)).then(()=>E(e,e.linksClass,e.snippetReplaceParent,!1)).then(()=>E(e,e.namespacesClass,e.snippetReplaceParent,!0)).then(()=>function(e,t){const n=e.apisClass;if(!n)return Promise.resolve();const i=$("."+n);return i.length?T(e).then(e=>{const n=e.compileBlocks.blocksInfo,s=pxt.Util.values(n.apis.byQName).filter(e=>!(e.attributes.hidden||e.attributes.deprecated||e.attributes.blockAliasFor||!e.attributes.jsDoc||!e.attributes.block||/^__/.test(e.name)));i.each((e,n)=>{let i=$(n);const o=pxt.Util.toDictionary(i.text().split("\n"),e=>e),a=s.filter(e=>!!o[e.attributes.blockNamespace||e.namespace]);if(!a.length)return;a.sort((e,t)=>{const n=!e.attributes.blockHidden&&r.Blocks[e.attributes.blockId],i=!t.attributes.blockHidden&&r.Blocks[t.attributes.blockId];return!!n!=!!i?(i?1:0)-(n?1:0):e.name.localeCompare(t.name)});const l=document.createElement("div");l.className="ui divided items",l.setAttribute("role","list"),a.forEach(e=>x(l,e,"item")),t&&(i=i.parent()),i.replaceWith(l)})}):Promise.resolve()}(e,e.snippetReplaceParent)).then(()=>function(e){return b(e.signatureClass,(t,n)=>{var i,o,a,l;let c=n.compileProgram;if(!c)return;let u=v(c.getSourceFile(pxt.MAIN_TS).statements[0]);if(!u||!n.apiInfo)return;const d=n.apiInfo.byQName[u.qName];if(!d)return;let p=r.Blocks[d.attributes.blockId],h=(null===(i=null==p?void 0:p.codeCard)||void 0===i?void 0:i.blocksXml)||void 0;const f=h?(0,s.render)(h):(null===(o=n.compileBlocks)||void 0===o?void 0:o.success)?n.blocksSvg:void 0,m=f?$(f):void 0;let _=ts.pxtc.service.displayStringForSymbol(d,!1,n.apiInfo).split("\n")[1]+";";const y=$('<code class="lang-typescript highlight"/>').text(_),b=(null===(l=null===(a=pxt.appTarget)||void 0===a?void 0:a.appTheme)||void 0===l?void 0:l.python)&&ts.pxtc.service.displayStringForSymbol(d,!0,n.apiInfo).split("\n")[1],T=b&&$('<code class="lang-python highlight"/>').text(b);if(e.snippetReplaceParent&&(t=t.parent()),pxt.Util.isTranslationMode()){const e=$('<div class="ui segment" />');e.append($('<div class="ui header"><i class="ui xicon globe"></i></div>')),d.attributes.translationId&&e.append($('<div class="ui message">').text(d.attributes.translationId)),d.attributes.jsDoc&&e.append($('<div class="ui message">').text(d.attributes.jsDoc)),e.insertAfter(t)}g(e,t,y,T,m,n,{showJs:!0,showPy:!0,hideGutter:!0})},{package:e.package,snippetMode:!0,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}(e)).then(()=>function(e){if(e.tutorial)return b(e.snippetClass,(t,n)=>{const i=n.blocksSvg;e.snippetReplaceParent&&(t=t.parent());const r=$('<div class="ui segment codewidget"/>').append(i);t.replaceWith(r)},{package:e.package,snippetMode:!1,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON});let t=0;return b(e.snippetClass,(n,i)=>{const r=i.compileBlocks&&i.compileBlocks.success?$(i.blocksSvg):void 0,s=i.compilePython&&i.compilePython.success&&i.compilePython.outfiles[pxt.MAIN_PY],o=$('<code class="lang-typescript highlight"/>').text(n.text().trim()),a=s?$('<code class="lang-python highlight"/>').text(s.trim()):void 0;e.snippetReplaceParent&&(n=n.parent());const l=i.compileJS&&i.compileJS.success,c=e.hex&&l&&i.compileJS.outfiles[pxtc.BINARY_HEX]?i.compileJS.outfiles[pxtc.BINARY_HEX]:void 0,u=`${pxt.appTarget.nickname||pxt.appTarget.id}-${e.hexName||""}-${t++}.hex`;g(e,n,o,a,r,i,{showEdit:e.showEdit,run:e.simulator,hexname:u,hex:c})},{package:e.package,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}(e)).then(()=>function(e){return b(e.blocksClass,(t,n)=>{const i=n.blocksSvg;e.snippetReplaceParent&&(t=t.parent());const r=$('<div class="ui segment codewidget"/>').append(i);t.replaceWith(r)},{package:e.package,snippetMode:!0,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}(e)).then(()=>{return(t=e).blocksXmlClass?function e(t,n,r){let s=$("."+t).first();return s[0]?(r.emPixels||(r.emPixels=18),r.splitSvg=!0,(0,i.compileBlocksAsync)(s.text(),r).then(i=>{try{n(s,i)}catch(e){pxt.reportException(e),s.append($("<div/>").addClass("ui segment warning").text(e.message))}return s.removeClass(t),pxt.U.delay(1,e(t,n,r))})):Promise.resolve()}(t.blocksXmlClass,(e,n)=>{const i=n.blocksSvg;t.snippetReplaceParent&&(e=e.parent());const r=$('<div class="ui segment codewidget"/>').append(i);e.replaceWith(r)},{package:t.package,snippetMode:!0,aspectRatio:t.blocksAspectRatio,assets:t.assetJSON}):Promise.resolve();var t}).then(()=>{return(t=e).diffBlocksXmlClass?function e(t,n,r){let o=$("."+t).first();if(!o[0])return Promise.resolve();r.emPixels||(r.emPixels=18),r.splitSvg=!0;const a=o.text().split(/-{10,}/),l=a[0],c=a[1];return(0,i.compileBlocksAsync)("",r).then(i=>{o.removeClass(t);try{const e=(0,s.diffXml)(l,c);e?(i.blocksSvg=e.svg,n(o,i)):o.text("no changes")}catch(e){pxt.reportException(e),o.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,e(t,n,r))})}(t.diffBlocksXmlClass,(e,n)=>{const i=n.blocksSvg;t.snippetReplaceParent&&(e=e.parent());const r=$('<div class="ui segment codewidget"/>').append(i);e.replaceWith(r)},{package:t.package,snippetMode:!0,aspectRatio:t.blocksAspectRatio,assets:t.assetJSON}):Promise.resolve();var t}).then(()=>{return(t=e).diffBlocksClass?function e(n){let r=$("."+n).first();if(!r[0])return Promise.resolve();const{fileA:o,fileB:a}=pxt.diff.split(r.text(),{removeTrailingSemiColumns:!0});return pxt.U.promiseMapAllSeries([o,a],e=>(0,i.decompileSnippetAsync)(e,{generateSourceMap:!0})).then(i=>{try{const e=(0,s.decompiledDiffAsync)(o,i[0].compileBlocks,a,i[1].compileBlocks,{hideDeletedTopBlocks:!0,hideDeletedBlocks:!0}),n=pxt.diff.render(o,a,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0});let l;const[c,u]=i.map(e=>e.compilePython&&e.compilePython.outfiles&&e.compilePython.outfiles[pxt.MAIN_PY]);c&&u&&(l=pxt.diff.render(c,u,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0})),g(t,r.parent(),$(n),l&&$(l),$(e.svg),void 0,{showEdit:!1,run:!1,hexname:void 0,hex:void 0})}catch(e){pxt.reportException(e),r.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,e(n))})}(t.diffBlocksClass):Promise.resolve();var t}).then(()=>{return(t=e).diffClass?function e(n){let i=$("."+n).first();if(!i[0])return Promise.resolve();const{fileA:r,fileB:s}=pxt.diff.split(i.text());try{const e=pxt.diff.render(r,s,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0});t.snippetReplaceParent&&(i=i.parent());const o=$('<div class="ui segment codewidget"/>').append(e);i.removeClass(n),i.replaceWith(o)}catch(e){pxt.reportException(e),i.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,e(n))}(t.diffClass):Promise.resolve();var t}).then(()=>function(e){const t={showEdit:!!e.showEdit,run:!!e.simulator};return b(e.staticPythonClass,(n,i)=>{const r=i.compilePython;if(r&&r.success){const s=n.clone().removeClass("lang-shadow").addClass("highlight"),o=s.clone().addClass("lang-python").text(r.outfiles[pxt.MAIN_PY]);s.addClass("lang-typescript"),l(o),g(e,n.parent(),s,o,void 0,i,t)}},{package:e.package,snippetMode:!0,assets:e.assetJSON})}(e)).then(()=>function(e){return e.projectClass?function t(){let n=$("."+e.projectClass).first(),r=n[0];if(!r)return Promise.resolve();n.removeClass(e.projectClass);let s=pxt.Cloud.parseScriptId(r.innerText);if(s){if(e.snippetReplaceParent){r=r.parentElement;let e=document.createElement("div");r.parentElement.insertBefore(e,r),r.parentElement.removeChild(r),r=e}return(0,i.renderProjectAsync)(r,s).then(()=>t())}return t()}():Promise.resolve()}(e)).then(()=>function(){const e={};return function t(){const n=y.shift();if(!n)return Promise.resolve();const{el:r,options:s,render:o}=n;return(0,i.decompileSnippetAsync)(r.text(),s).then(t=>{const n=t.compileJS&&t.compileJS.diagnostics&&t.compileJS.diagnostics.filter(e=>e.category==pxtc.DiagnosticCategory.Error);n&&n.length&&n.forEach(e=>pxt.reportError("docs.decompile",""+e.messageText,{code:e.code+""})),t.blocksSvg.querySelectorAll("defs *").forEach(t=>{e[t.id]?t.remove():e[t.id]=!0}),o(r,t)},e=>{pxt.reportException(e),r.append($("<div/>").addClass("ui segment warning").text(e.message))}).finally(()=>(r.removeClass("lang-shadow"),t()))}().then(()=>{r.Workspace.getAll().forEach(e=>e.dispose()),(0,s.cleanRenderingWorkspace)()})}())}},{"../pxtblocks":74,"../pxtblocks/codecardRenderer":11,"./runner":168,blockly:176}],168:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.init=n.setInitCallbacks=n.compileBlocksAsync=n.decompileSnippetAsync=n.renderMarkdownAsync=n.renderProjectFilesAsync=n.renderProjectAsync=n.startDocsServer=n.startRenderServer=n.setEditorContextAsync=n.editorLanguageMode=n.LanguageMode=n.buildSimJsInfo=n.fetchSimJsInfo=n.postSimMessage=n.currentDriver=n.preloadSim=n.simulateAsync=n.generateVMFileAsync=n.generateHexFileAsync=n.showError=n.initFooter=n.initHost=n.mainPkg=void 0;const i=e("../pxtblocks"),r=e("../pxteditor/editor"),s=e("./renderer"),o=e("../pxtblocks"),a=e("blockly");pxt.blocks.requirePxtBlockly=()=>o,pxt.blocks.requireBlockly=()=>a,pxt.blocks.registerFieldEditor=(e,t,n)=>o.registerFieldEditor(e,t,n);class l{constructor(e,t){this.ksPkg=e,this.topPkg=t,this.files={}}getKsPkg(){return this.ksPkg}getPkgId(){return this.ksPkg?this.ksPkg.id:this.id}isTopLevel(){return this.ksPkg&&0==this.ksPkg.level}setFiles(e){this.files=e}getAllFiles(){return pxt.Util.mapMap(this.files,(e,t)=>t)}}class c{constructor(){this.githubPackageCache={}}readFile(e,t){let n=m(e);return pxt.U.lookup(n.files,t)}writeFile(e,t,n){m(e).files[t]=n}getHexInfoAsync(e){return pxt.hexloader.getHexInfoAsync(this,e)}cacheStoreAsync(e,t){return Promise.resolve()}cacheGetAsync(e){return Promise.resolve(null)}patchDependencies(e,t,n){if(!n)return!1;const i=pxt.github.parseRepoId(n);if(!i)return!1;for(const t of Object.keys(e.dependencies)){const r=e.dependencies[t],s=pxt.github.parseRepoId(r);if(s&&i.fullName==s.fullName)return pxt.semver.strcmp(i.tag,s.tag)<0&&(e.dependencies[t]=n),!0}return!1}downloadPackageAsync(e,t){let n,i=e.verProtocol();"github"==i&&(n=this.githubPackageCache[e._verspec]);let r=m(e);return(n?Promise.resolve(n):e.commonDownloadAsync()).then(s=>{if(s)return"github"!=i||n||(this.githubPackageCache[e._verspec]=pxt.Util.clone(s)),r.setFiles(s),Promise.resolve();if("empty"==i){if(0==Object.keys(r.files).length&&r.setFiles(g()),t&&t.length){const n=m(e).files,i=JSON.parse(n[pxt.CONFIG_NAME]);t.forEach(e=>{f(i,e)}),n[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(i)}return Promise.resolve()}if("docs"==i){let t=g(),n=JSON.parse(t[pxt.CONFIG_NAME]);return e.verArgument().split(",").forEach(e=>{f(n,e)}),n.yotta||(n.yotta={}),n.yotta.ignoreConflicts=!0,t[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(n),r.setFiles(t),Promise.resolve()}return"invalid"==i?(pxt.log(`skipping invalid pkg ${e.id}`),Promise.resolve()):Promise.reject(`Cannot download ${e.version()}; unknown protocol`)})}}let u,d,p,h;function f(e,t){let n=/^([a-zA-Z0-9_-]+)(=(.+))?$/.exec(t);return n?e.dependencies[n[1]]=n[3]||"*":pxt.warn(`unknown package syntax ${t}`),!0}function m(e){let t=e._editorPkg;if(t)return t;let i=null;e!=n.mainPkg&&(i=m(n.mainPkg));let r=new l(e,i);return e==n.mainPkg&&(r.topPkg=r),e._editorPkg=r,r}function g(){let e=pxt.appTarget.tsprj,t=pxt.U.clone(e.files);return t[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(e.config),t[pxt.MAIN_BLOCKS]="",t}function _(){pxt.setAppTarget(window.pxtTargetBundle),pxt.analytics.enable(pxt.Util.userLanguage()),pxt.Util.assert(!!pxt.appTarget);const e=window.location.href;let t,n=!1;if(/[&?]translate=1/.test(e)&&!pxt.BrowserUtils.isIE())t=ts.pxtc.Util.TRANSLATION_LOCALE,n=!0,pxt.Util.enableLiveLocalizationUpdates();else{const i=/PXT_LANG=(.*?)(?:;|$)/.exec(document.cookie),r=/(live)?(force)?lang=([a-z]{2,}(-[A-Z]+)?)/i.exec(e);t=r?r[3]:i&&i[1]||pxt.appTarget.appTheme.defaultLocale||navigator.userLanguage||navigator.language;const s=pxt.appTarget.appTheme.defaultLocale,o=null==t?void 0:t.toLocaleLowerCase(),a=pxt.BrowserUtils.isLocalHostDev()&&(!o||(s?s.toLocaleLowerCase()===o:"en"===o||"en-us"===o));(pxt.BrowserUtils.isPxtElectron()||a||pxt.appTarget.appTheme.disableLiveTranslations)&&!(null==r?void 0:r[1])||pxt.Util.enableLiveLocalizationUpdates(),n=!!r&&!!r[2]}pxt.appTarget.versions;$&&$.fn&&$.fn.embed&&$.fn.embed.settings&&$.fn.embed.settings.sources&&$.fn.embed.settings.sources.youtube&&($.fn.embed.settings.sources.youtube.url="//www.youtube.com/embed/{id}?rel=0");const i=pxt.webConfig;return pxt.Util.updateLocalizationAsync({targetId:pxt.appTarget.id,baseUrl:i.commitCdnUrl,code:t,force:n}).then(()=>y())}function y(){n.mainPkg=new pxt.MainPackage(new c)}function b(e){pxt.error(e)}function v(e,t,i){const r=e?/\w+:\w+/.test(e)?e:"pub:"+e:"empty:tsprj";let s,o,a;return d&&d._verspec==r?(n.mainPkg=d,s=n.mainPkg.host(),o=Promise.resolve(),a=Promise.resolve()):(s=n.mainPkg.host(),n.mainPkg=new pxt.MainPackage(s),n.mainPkg._verspec=e?/\w+:\w+/.test(e)?e:"pub:"+e:"empty:tsprj",o=s.downloadPackageAsync(n.mainPkg,i),a=n.mainPkg.installAllAsync(),d=n.mainPkg),o.then(()=>s.readFile(n.mainPkg,pxt.CONFIG_NAME)).then(e=>e?a.then(()=>{if(t){let e=m(n.mainPkg);e.files[pxt.MAIN_TS]=t;let i=JSON.parse(e.files[pxt.CONFIG_NAME]);i.name=window.location.href.split("/").pop().split(/[?#]/)[0],e.files[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(i),n.mainPkg.config.name=i.name,-1==n.mainPkg.config.files.indexOf(pxt.MAIN_BLOCKS)&&n.mainPkg.config.files.push(pxt.MAIN_BLOCKS)}}).catch(e=>{b(lf("Cannot load extension: {0}",e.message))}):Promise.resolve())}function T(e){let t=n.mainPkg.getTargetOptions();return t.isNative=!!e,t.hasHex=!!e,n.mainPkg.getCompileOptionsAsync(t)}function k(e,t){return T(e).then(e=>{t&&t(e);let n=pxtc.compile(e);return n.diagnostics&&n.diagnostics.length>0&&n.diagnostics.forEach(e=>{pxt.error(e.messageText)}),n})}function x(e,t,i){var r,s;p&&t.embedId&&h===t.embedId?p.container=e:(p=new pxsim.SimulatorDriver(e),h=t.embedId);const{fnArgs:o,parts:a,usedBuiltinParts:l}=i||{};let c=pxt.appTarget.simulator.boardDefinition,u=C(t.id),d={debug:t.debug,mute:t.mute,boardDefinition:c,parts:a,builtinParts:l,fnArgs:o,cdnUrl:pxt.webConfig.commitCdnUrl,localizedStrings:pxt.Util.getLocalizedStrings(),partDefinitions:null===n.mainPkg||void 0===n.mainPkg?void 0:n.mainPkg.computePartDefinitions(a),highContrast:t.highContrast,storedState:u,light:t.light,single:t.single,hideSimButtons:t.hideSimButtons,autofocus:t.autofocus,queryParameters:t.additionalQueryParameters,mpRole:t.mpRole,theme:null===(r=n.mainPkg.config)||void 0===r?void 0:r.theme};if(pxt.appTarget.simulator&&!t.fullScreen&&(d.aspectRatio=a.length&&pxt.appTarget.simulator.partsAspectRatio?pxt.appTarget.simulator.partsAspectRatio:pxt.appTarget.simulator.aspectRatio),window.parent&&d.aspectRatio&&d.aspectRatio!==pxt.appTarget.simulator.aspectRatio){const e=null===(s=window.frameElement)||void 0===s?void 0:s.getAttribute("data-frameid");e&&window.parent.postMessage({type:"aspectratio",frameid:e,value:d.aspectRatio},"*")}return p.setRunOptions(d),d}async function E(e){try{const t=Date.now(),n=await pxt.Cloud.downloadBuiltSimJsInfoAsync(e.id);return pxt.tickEvent("perfMeasurement",{durationMs:Date.now()-t,operation:"fetchSimJsInfo"}),n}catch(e){return void pxt.debug(e.toString())}}async function S(e){var t,i,r;const s=Date.now();await v(e.id,e.code,e.dependencies);let o=!1;const a=pxt.appTarget.versions.target;let l=await k(!1,t=>{var i;if(t.computeUsedParts=!0,t.computeUsedSymbols=!0,e.debug&&(t.breakpoints=!0),e.assets){const n=JSON.parse(e.assets);for(const e of Object.keys(n)){const i=n[e];if(t.fileSystem[e]=i,t.sourceFiles.indexOf(e)<0&&t.sourceFiles.push(e),/\.jres$/.test(e)){const e=JSON.parse(i);t.jres=pxt.inflateJRes(e,t.jres)}}}if(e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code),t.target.preferredEditor===pxt.PYTHON_PROJECT_NAME){t.target.preferredEditor=pxt.JAVASCRIPT_PROJECT_NAME,t.ast=!0;const e=F(pxtc.compile(t).ast,t);t.apisInfo=e,t.target.preferredEditor=pxt.PYTHON_PROJECT_NAME}const r=null===(i=n.mainPkg.config.targetVersions)||void 0===i?void 0:i.target;if(r&&a&&pxt.semver.cmp(pxt.semver.parse(r),pxt.semver.parse(a))<0)for(const e of Object.keys(t.fileSystem))!pxt.Util.startsWith(e,"pxt_modules")&&pxt.Util.endsWith(e,".ts")&&(o=!0,t.fileSystem[e]=pxt.patching.patchJavaScript(r,t.fileSystem[e]))});(null===(t=l.diagnostics)||void 0===t?void 0:t.length)>0&&o&&(pxt.log("Compile with upgrade rules failed, trying again with original code"),l=await k(!1,t=>{e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code)})),l.diagnostics&&l.diagnostics.length>0&&pxt.error("Diagnostics",l.diagnostics);const c=pxtc.buildSimJsInfo(l),u=(null===(r=null===(i=pxt.appTarget.simulator)||void 0===i?void 0:i.boardDefinition)||void 0===r?void 0:r.onboardComponents)||[];return c.allParts=l.usedParts||[],c.usedBuiltinParts=l.usedParts.filter(e=>-1!==u.indexOf(e)),c.parts=l.usedParts.filter(e=>-1===u.indexOf(e)),pxt.tickEvent("perfMeasurement",{durationMs:Date.now()-s,operation:"buildSimJsInfo"}),c}function C(e){let t={};try{let n=window.localStorage.getItem(e);n&&(t=JSON.parse(n))}catch(e){}return t}var w;function I(e,t){if(n.editorLanguageMode=e,t!=pxt.Util.localeInfo()){const e=/^live-/;return e.test(t)&&pxt.Util.enableLiveLocalizationUpdates(),pxt.Util.updateLocalizationAsync({targetId:pxt.appTarget.id,baseUrl:pxt.webConfig.commitCdnUrl,code:t.replace(e,"")})}return Promise.resolve()}function A(e){let t=e.data;if(t)switch(t.type){case"fileloaded":let e=t,n=e.name,i=w.Blocks;/\.ts$/i.test(n)?i=w.TypeScript:/\.py$/i.test(n)&&(i=w.Python),I(i,e.locale);break;case"popout":let r=/((\/v[0-9+])\/)?[^\/]*#(doc|md):([^&?:]+)/i.exec(window.location.href);if(r){const e=pxt.webConfig.docsUrl||"/--docs";let t=r[2]||"",n="doc"==r[3]?pxt.webConfig.isStatic?`/docs${r[4]}.html`:`${r[4]}`:`${e}?md=${r[4]}`;window.parent&&window.parent.postMessage({type:"opendoc",url:pxt.BrowserUtils.urlJoin(t,n)},"*")}break;case"localtoken":let s=t;s&&s.localToken&&(pxt.Cloud.localToken=s.localToken,U.forEach(e=>e()),U=[])}}function N(e,t){return pxt.Cloud.privateGetTextAsync(t+"/text").then(e=>JSON.parse(e)).then(n=>D(e,n,t))}function D(e,t,i=null,r=!1){const s=JSON.parse(t[pxt.CONFIG_NAME])||{};let o=`# ${s.name} ${s.version?s.version:""}\n\n`;const a="README.md";t[a]&&(o+=t[a].replace(/^#+/,"$0#")+"\n"),s.files.filter(e=>e!=pxt.CONFIG_NAME&&e!=a).filter(e=>function(e,t){switch(t){case w.Blocks:return/\.blocks?$/.test(e);case w.TypeScript:return/\.ts?$/.test(e);case w.Python:return/\.py?$/.test(e)}}(e,n.editorLanguageMode)).forEach(e=>{/^main\.(ts|blocks)$/.test(e)||(o+=`\n## ${e}\n`),/\.ts$/.test(e)?o+=`\`\`\`typescript\n${t[e]}\n\`\`\`\n`:/\.blocks?$/.test(e)?o+=`\`\`\`blocksxml\n${t[e]}\n\`\`\`\n`:o+=`\`\`\`${e.substr(e.indexOf("."))}\n${t[e]}\n\`\`\`\n`});const l=s&&s.dependencies&&Object.keys(s.dependencies).filter(e=>e!=pxt.appTarget.corepkg);if(l&&l.length&&(o+=`\n## ${lf("Extensions")} #extensions\n\n${l.map(e=>`* ${e}, ${s.dependencies[e]}`).join("\n")}\n\n\`\`\`package\n${l.map(e=>`${e}=${s.dependencies[e]}`).join("\n")}\n\`\`\`\n`),i){let e=(pxt.appTarget.appTheme.shareUrl||"https://makecode.com/")+i;r&&(e="`"+e+"`"),o+=`\n${e}\n\n`}pxt.debug(`print md: ${o}`);return R(e,o,{print:!0})}pxt.react.getTilemapProject||(pxt.react.getTilemapProject=()=>(u||(u=new pxt.TilemapProject,u.loadPackage(n.mainPkg)),u)),n.initHost=y,n.initFooter=function(e,t){if(!e)return;let n=pxt.appTarget.appTheme,i=$("body"),r=$(e),s=$("<a/>").attr("href",n.homeUrl).attr("target","_blank");r.append(s),n.organizationLogo?s.append($("<img/>").attr("src",pxt.Util.toDataUri(n.organizationLogo))):s.append(lf("powered by {0}",n.title)),i.mouseenter(e=>r.fadeOut()),i.mouseleave(e=>r.fadeIn())},n.showError=b,n.generateHexFileAsync=function(e){return v(e.id).then(()=>k(!0,t=>{e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code)})).then(e=>(e.diagnostics&&e.diagnostics.length>0&&pxt.error("Diagnostics",e.diagnostics),e.outfiles[pxtc.BINARY_HEX]))},n.generateVMFileAsync=function(e){return pxt.setHwVariant("vm"),v(e.id).then(()=>k(!0,t=>{e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code)})).then(e=>(pxt.log(e),e))},n.simulateAsync=async function(e,t){var n,i;const r=t.builtJsInfo||await E(t)||await S(t),{js:s}=r;if(!s)return void pxt.error("Program failed to compile");const o=x(e,t,r);return p.options.messageSimulators=null===(i=null===(n=pxt.appTarget)||void 0===n?void 0:n.simulator)||void 0===i?void 0:i.messageSimulators,p.options.onSimulatorCommand=e=>{"restart"===e.command?(o.storedState=C(t.id),p.run(s,o)):"setstate"===e.command?e.stateKey&&function(e,t,n){let i=C(e);if(!e)return;null!=n?i[t]=n:delete i[t];try{window.localStorage.setItem(e,JSON.stringify(i))}catch(e){}}(t.id,e.stateKey,e.stateValue):"single"===e.command&&p.setSingleSimulator()},r.breakpoints&&t.debug&&p.setBreakpoints(r.breakpoints),p.run(s,o),r},n.preloadSim=function(e,t){var n,i;x(e,t),p.preload((null===(i=null===(n=pxt.appTarget)||void 0===n?void 0:n.simulator)||void 0===i?void 0:i.aspectRatio)||1,!0)},n.currentDriver=function(){return p},n.postSimMessage=function(e){null==p||p.postMessage(e)},n.fetchSimJsInfo=E,n.buildSimJsInfo=S,function(e){e[e.Blocks=0]="Blocks",e[e.TypeScript=1]="TypeScript",e[e.Python=2]="Python"}(w=n.LanguageMode||(n.LanguageMode={})),n.editorLanguageMode=w.Blocks,n.setEditorContextAsync=I,n.startRenderServer=function(){pxt.tickEvent("renderer.ready");const e=[];let t;function n(){if(t)return;const r=e.shift();if(!r)return;const s=r.options||{};s.splitSvg=!1,pxt.tickEvent("renderer.job");const o=/^\s*<xml/.test(r.code);t=(async()=>{const e=(o?await B(r.code,s):await M(r.code,r.options)).blocksSvg,t=e.viewBox.baseVal.width,n=e.viewBox.baseVal.height,a=e?await(0,i.blocklyToSvgAsync)(e,0,0,t,n):void 0;let l;try{l=a?await pxt.BrowserUtils.encodeToPngAsync(a.xml,{width:t,height:n}):void 0}catch(e){pxt.warn(e)}window.parent.postMessage({source:"makecode",type:"renderblocks",id:r.id,width:null==a?void 0:a.width,height:null==a?void 0:a.height,svg:null==a?void 0:a.svg,uri:l||(null==a?void 0:a.xml),css:null==a?void 0:a.css},"*")})().catch(e=>{window.parent.postMessage({source:"makecode",type:"renderblocks",id:r.id,error:e.message},"*")}).finally(()=>{t=void 0,n()})}(0,r.initEditorExtensionsAsync)().then(()=>{window.addEventListener("message",function(t){const i=t.data;"renderblocks"==i.type&&(e.push(i),n())},!1),window.parent.postMessage({source:"makecode",type:"renderready",versions:pxt.appTarget.versions},"*")})},n.startDocsServer=function(e,t,n){pxt.tickEvent("docrenderer.ready");const i=[];function o(i,r){pxt.debug(`rendering ${i}`),n&&$(n).hide(),$(t).hide(),$(e).show(),pxt.U.delay(100).then(()=>{switch(i){case"print":const e=window.localStorage.printjob;return delete window.localStorage.printjob,D(t,JSON.parse(e),void 0,!0).then(()=>pxsim.print(1e3));case"project":return D(t,JSON.parse(r)).then(()=>pxsim.print(1e3));case"projectid":return N(t,JSON.parse(r)).then(()=>pxsim.print(1e3));case"doc":return async function(e,t){t=t.replace(/^\//,"");const n=await pxt.Cloud.markdownAsync(t,void 0,!0);try{await R(e,n,{path:t})}catch(e){pxt.warn(e)}}(t,r);case"book":return function(e,t){t=t.replace(/^\//,""),pxt.tickEvent("book",{id:t}),pxt.log(`rendering book from ${t}`);let n;return $("#loading").find(".loader").addClass("text").text(lf("Compiling your book (this may take a minute)")),pxt.U.delay(100).then(()=>pxt.Cloud.markdownAsync(t,void 0,!0)).then(e=>{n=pxt.docs.buildTOC(e),pxt.log(`TOC: ${JSON.stringify(n,null,2)}`);const t=[];return pxt.docs.visitTOC(n,e=>{/^\//.test(e.path)&&!/^\/pkg\//.test(e.path)&&t.push(e)}),pxt.U.promisePoolAsync(4,t,async e=>{try{const t=await pxt.Cloud.markdownAsync(e.path,void 0,!0);e.markdown=t}catch(t){e.markdown=`_${e.path} failed to load._`}})}).then(t=>{let i=n[0].name;return pxt.docs.visitTOC(n,e=>{e.markdown&&(i+="\n\n"+e.markdown)}),R(e,i)})}(t,r);default:return R(t,r)}}).catch(e=>{$(t).html(`\n                <img style="height:4em;" src="${pxt.appTarget.appTheme.docsLogo}" />\n                <h1>${lf("Oops")}</h1>\n                <h3>${lf("We could not load the documentation, please check your internet connection.")}</h3>\n                <button class="ui button primary" id="tryagain">${lf("Try Again")}</button>`),$(t).find("#tryagain").click(()=>{o(i,r)}),window.parent&&window.parent.postMessage({type:"docfailed",docType:i,src:r},"*")}).finally(()=>{$(e).hide(),n&&$(n).show(),$(t).show()}).then(()=>{})}function a(e,t){t?(pxsim.U.addClass(e,"disabled"),e.setAttribute("aria-disabled","true")):(pxsim.U.removeClass(e,"disabled"),e.setAttribute("aria-disabled","false"))}async function l(){let e=/^#(doc|md|tutorial|book|project|projectid|print):([^&?:]+)(:([^&?:]+):([^&?:]+))?/i.exec(window.location.hash);if(e){if(n&&(i.push(window.location.hash),i.length>10&&i.shift(),i.length>1&&a(n,!1)),e[4]){let t=w.TypeScript;/^blocks$/i.test(e[4])?t=w.Blocks:/^python$/i.test(e[4])&&(t=w.Python),await I(t,e[5])}o(e[1],decodeURIComponent(e[2]))}}n&&(n.addEventListener("click",()=>{!function(){if(!n)return;i.length>1&&(i.pop(),window.location.hash=i.pop());i.length<=1&&a(n,!0)}()}),n.addEventListener("keydown",s.fireClickOnEnter),a(n,!0)),(0,r.initEditorExtensionsAsync)().then(()=>{window.addEventListener("message",A,!1),window.addEventListener("hashchange",()=>{l()},!1),parent.postMessage({type:"sidedocready"},"*"),setTimeout(()=>l(),1)})},n.renderProjectAsync=N,n.renderProjectFilesAsync=D;const O='\n<aside id=button class=box>\n<a class="ui primary button" href="@ARGS@">@BODY@</a>\n</aside>\n\n<aside id=vimeo>\n<div class="ui two column stackable grid container">\n<div class="column">\n<div class="ui embed mdvid" data-source="vimeo" data-id="@ARGS@" data-placeholder="/thumbnail/1024/vimeo/@ARGS@" data-icon="video play">\n</div>\n</div></div>\n</aside>\n\n<aside id=youtube>\n<div class="ui two column stackable grid container">\n<div class="column">\n<div class="ui embed mdvid" data-source="youtube" data-id="@ARGS@" data-placeholder="https://img.youtube.com/vi/@ARGS@/0.jpg">\n</div>\n</div></div>\n</aside>\n\n<aside id=section>\n\x3c!-- section @ARGS@ --\x3e\n</aside>\n\n<aside id=hide class=box>\n<div style=\'display:none\'>\n    @BODY@\n</div>\n</aside>\n\n<aside id=avatar class=box>\n<div class=\'avatar @ARGS@\'>\n    <div class=\'avatar-image\'></div>\n    <div class=\'ui compact message\'>\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=hint class=box>\n<div class="ui info message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=codecard class=box>\n<pre><code class="lang-codecard">@BODY@</code></pre>\n</aside>\n\n<aside id=tutorialhint class=box>\n<div class="ui hint message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=reminder class=box>\n<div class="ui warning message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=alert class=box>\n<div class="ui negative message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=tip class=box>\n<div class="ui positive message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n\x3c!-- wrapped around ordinary content --\x3e\n<aside id=main-container class=box>\n<div class="ui text">\n    @BODY@\n</div>\n</aside>\n\n\x3c!-- used for \'column\' box - they are collected and wrapped in \'column-container\' --\x3e\n<aside id=column class=aside>\n<div class=\'column\'>\n    @BODY@\n</div>\n</aside>\n<aside id=column-container class=box>\n<div class="ui three column stackable grid text">\n    @BODY@\n</div>\n</aside>\n@breadcrumb@\n@body@';function R(e,t,i={}){const r=pxt.docs.renderMarkdown({template:O,markdown:t,theme:pxt.appTarget.appTheme});let o=i.blocksAspectRatio||window.innerHeight<window.innerWidth?1.62:1/1.62;$(e).html(r),$(e).find("a").attr("target","_blank");const a=(0,s.defaultClientRenderOptions)();return a.tutorial=!!i.tutorial,a.blocksAspectRatio=o||a.blocksAspectRatio,a.showJavaScript=n.editorLanguageMode==w.TypeScript,i.print&&(a.showEdit=!1,a.simulator=!1),(0,s.renderAsync)(a).then(()=>{$(e).find('a[href^="/"]').removeAttr("target").each((e,t)=>{$(t).attr("href","#doc:"+$(t).attr("href").replace(/^\//,""))}),$(e).find(".ui.embed").embed()})}let L,P;function M(e,t){const{assets:r,forceCompilation:s,snippetMode:o,generateSourceMap:a}=t||{};return v(t&&t.packageId?"pub:"+t.packageId:t&&t.package?"docs:"+t.package:null,e).then(()=>T(!!pxt.appTarget.compile&&pxt.appTarget.compile.hasHex)).then(l=>{if(e&&(l.fileSystem[pxt.MAIN_TS]=e),l.ast=!0,r)for(const e of Object.keys(r))l.sourceFiles.indexOf(e)<0&&l.sourceFiles.push(e),l.fileSystem[e]=r[e];let c,d,p;s?(c=pxtc.compile(l),d=c&&c.ast):d=pxtc.getTSProgram(l,L),L=d,pxt.appTarget.appTheme.python&&(p=ts.pxtc.transpile.tsToPy(d,pxt.MAIN_TS));let h=F(d,l);return ts.pxtc.localizeApisAsync(h,n.mainPkg).then(()=>{let e=pxtc.getBlocksInfo(h);(0,i.initializeAndInject)(e);const s=null==r?void 0:r[pxt.TILEMAP_JRES],l=null==r?void 0:r[pxt.IMAGES_JRES];(s||l)&&(u=new pxt.TilemapProject,u.loadPackage(n.mainPkg),s&&u.loadTilemapJRes(JSON.parse(s),!0),l&&u.loadAssetsJRes(JSON.parse(l)));let f=pxtc.decompiler.decompileToBlocks(e,d.getSourceFile(pxt.MAIN_TS),{snippetMode:o,generateSourceMap:a});if(f.diagnostics&&f.diagnostics.length>0&&f.diagnostics.forEach(e=>pxt.error(e.messageText)),!f.success)return{package:n.mainPkg,compileProgram:d,compileJS:c,compileBlocks:f,apiInfo:h};pxt.debug(f.outfiles[pxt.MAIN_BLOCKS]);const m=(0,i.render)(f.outfiles[pxt.MAIN_BLOCKS],t);return(s||l)&&(u=null),{package:n.mainPkg,compileProgram:d,compileJS:c,compileBlocks:f,compilePython:p,apiInfo:h,blocksSvg:m}})})}function F(e,t){P||(P={});const n=Object.keys(t.fileSystem).sort().join(";");return P[n]||(P[n]=pxtc.getApiInfo(e,t.jres)),P[n]}function B(e,t){const{assets:r}=t||{};return v(t&&t.packageId?"pub:"+t.packageId:t&&t.package?"docs:"+t.package:null,"").then(()=>T(!!pxt.appTarget.compile&&pxt.appTarget.compile.hasHex)).then(s=>{if(s.ast=!0,r)for(const e of Object.keys(r))s.sourceFiles.indexOf(e)<0&&s.sourceFiles.push(e),s.fileSystem[e]=r[e];const o=F(pxtc.compile(s).ast,s);return ts.pxtc.localizeApisAsync(o,n.mainPkg).then(()=>{const s=pxtc.getBlocksInfo(o);(0,i.initializeAndInject)(s);const a=null==r?void 0:r[pxt.TILEMAP_JRES],l=null==r?void 0:r[pxt.IMAGES_JRES];(a||l)&&(u=new pxt.TilemapProject,u.loadPackage(n.mainPkg),a&&u.loadTilemapJRes(JSON.parse(a),!0),l&&u.loadAssetsJRes(JSON.parse(l)));const c=(0,i.render)(e,t);return(a||l)&&(u=null),{package:n.mainPkg,blocksSvg:c,apiInfo:o}})})}n.renderMarkdownAsync=R,n.decompileSnippetAsync=M,n.compileBlocksAsync=B;let U=[];let V=[];n.setInitCallbacks=function(e){V=e},n.init=function(){_().then(()=>{for(let e=0;e<V.length;++e)V[e]()})}},{"../pxtblocks":74,"../pxteditor/editor":152,"./renderer":167,blockly:176}],169:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.IFrameEmbeddedClient=void 0;n.IFrameEmbeddedClient=class{constructor(e){this.messageHandler=e,this.onMessageReceived=e=>{const t=e.data;if(t){if("iframeclientsetmessageport"===t.type)return this.port=e.ports[0],this.port.onmessage=this.onMessageReceived,void this.postMessage({type:"iframeclientsetmessageport"});if("iframeclientready"===t.type)return void this.sendReadyMessage()}this.messageHandler(e)},this.frameId=function(){const e=/frameid=([a-zA-Z0-9\-]+)/i.exec(window.location.href);if(e)return e[1];return}(),window.addEventListener("message",this.onMessageReceived),this.sendReadyMessage()}dispose(){window.removeEventListener("message",this.onMessageReceived),this.port&&this.port.close()}postMessage(e){this.postMessageCore(e)}postMessageCore(e){this.frameId&&(e.frameId=this.frameId),this.port?this.port.postMessage(e):window.acquireVsCodeApi?window.acquireVsCodeApi().postMessage(e):window.parent&&window.parent!==window&&window.parent.postMessage(e,"*")}sendReadyMessage(){this.postMessage({type:"iframeclientready"})}}},{}],170:[function(e,t,n){
/*! For license information please see index.js.LICENSE.txt */
!function(i,r){if("object"==typeof n&&"object"==typeof t)t.exports=r(e("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],r);else{var s=r("object"==typeof n?e("blockly/core"):i.Blockly);for(var o in s)("object"==typeof n?n:i)[o]=s[o]}}(this,e=>(()=>{var t={370:t=>{t.exports=e}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,i),s.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};i.r(r),i.d(r,{FieldGridDropdown:()=>l});var s=i(370);class o{constructor(e,t,n,i){this.value=n,this.selected=!1,this.selectionCallback=i,this.element=document.createElement("button"),this.element.id=s.utils.idGenerator.getNextUniqueId(),this.element.className="blocklyFieldGridItem",this.clickHandler=s.browserEvents.conditionalBind(this.element,"click",this,this.onClick,!0),e.appendChild(this.element);const r="string"==typeof t?document.createTextNode(t):t;this.element.appendChild(r),s.utils.aria.setRole(this.element,s.utils.aria.Role.GRIDCELL)}dispose(){this.selectionCallback=null,this.element.remove(),this.clickHandler&&(s.browserEvents.unbind(this.clickHandler),this.clickHandler=null)}getId(){return this.element.id}getValue(){return this.value}isSelected(){return this.selected}setSelected(e){this.selected=e,s.utils.aria.setState(this.element,s.utils.aria.State.SELECTED,this.selected),this.element.classList.toggle("blocklyFieldGridItemSelected",this.selected),this.isSelected()&&this.focus()}onClick(){var e;this.setSelected(!0),null===(e=this.selectionCallback)||void 0===e||e.call(this,this)}focus(){this.element.focus({preventScroll:!0});const e=this.element.offsetParent;if(!e)return;const t=this.element.offsetTop,n=e.scrollTop,i=this.getInterItemSpacing();t<n?e.scrollTo(0,t-i):t+this.element.offsetHeight>n+e.clientHeight&&e.scrollBy(0,t+this.element.clientHeight-(n+e.clientHeight)+i)}getInterItemSpacing(){const e=this.element.closest(".blocklyFieldGrid");if(!e)return 0;const t=[...e.querySelectorAll(".blocklyFieldGridItem")];if(!t.length)return 0;const n=t[0].offsetTop,i=t[0].offsetHeight;for(const e of t)if(e.offsetTop!==n)return e.offsetTop-i-n;return 0}}class a{constructor(e,t,n,i,r){if(this.columns=n,this.rtl=i,this.itemIndices=new Map,this.items=new Array,this.keyDownHandler=null,this.pointerMoveHandler=null,this.selectionCallback=r,this.root=document.createElement("div"),this.root.className="blocklyFieldGrid",this.root.tabIndex=0,s.utils.aria.setRole(this.root,s.utils.aria.Role.GRID),e.appendChild(this.root),this.populateItems(t),this.keyDownHandler=s.browserEvents.conditionalBind(this.root,"keydown",this,this.onKeyDown),this.pointerMoveHandler=s.browserEvents.conditionalBind(this.root,"pointermove",this,this.onPointerMove,!0),!(n>=1))throw new Error(`Number of columns must be >= 1; got ${n}`);this.columns=n,this.root.style.setProperty("--grid-columns",`${this.columns}`)}populateItems(e){let t=document.createElement("div");for(const[n,i]of e.entries()){if(i===s.FieldDropdown.SEPARATOR)continue;n%this.columns===0&&(t=document.createElement("div"),t.className="blocklyFieldGridRow",s.utils.aria.setRole(t,s.utils.aria.Role.ROW),this.root.appendChild(t));const[e,r]=i,a=(()=>{if((t=e)&&"object"==typeof t&&"src"in t&&"string"==typeof t.src&&"alt"in t&&"string"==typeof t.alt&&"width"in t&&"number"==typeof t.width&&"height"in t&&"number"==typeof t.height){const t=new Image(e.width,e.height);return t.src=e.src,t.alt=e.alt||"",t}var t;return e})(),l=new o(t,a,r,e=>{var t;this.setSelectedValue(e.getValue()),null===(t=this.selectionCallback)||void 0===t||t.call(this,e)});this.itemIndices.set(l.getId(),this.itemIndices.size),this.items.push(l)}}dispose(){this.selectionCallback=void 0;for(const e of this.items)e.dispose();this.itemIndices.clear(),this.items.length=0,this.keyDownHandler&&(s.browserEvents.unbind(this.keyDownHandler),this.keyDownHandler=null),this.pointerMoveHandler&&(s.browserEvents.unbind(this.pointerMoveHandler),this.pointerMoveHandler=null),this.root.remove()}onKeyDown(e){if(!(!this.items.length||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){switch(e.key){case"ArrowUp":this.moveFocus(-1*this.columns,!0);break;case"ArrowDown":this.moveFocus(this.columns,!0);break;case"ArrowLeft":this.moveFocus(-1*(this.rtl?-1:1),!0);break;case"ArrowRight":this.moveFocus(1*(this.rtl?-1:1),!0);break;case"PageUp":case"Home":this.moveFocus(0,!1);break;case"PageDown":case"End":this.moveFocus(this.items.length-1,!1);break;case"Enter":case"Space":return void e.stopPropagation();default:return}e.preventDefault(),e.stopPropagation()}}onPointerMove(e){if(!e.movementX&&!e.movementY||!(e.target instanceof Element))return;const t=e.target.closest(".blocklyFieldGridItem");if(!t)return;const n=t.id,i=this.itemIndices.get(n);void 0!==i&&this.moveFocus(i,!1)}setSelectedValue(e){for(const[t,n]of this.items.entries()){const i=n.getValue()===e;n.setSelected(i),i&&this.moveFocus(t,!1)}}moveFocus(e,t){let n=e;if(t){const e=this.getFocusedItem();if(!e)return;n+=this.indexOfItem(e)}const i=this.itemAtIndex(n);i&&(i.focus(),s.utils.aria.setState(this.root,s.utils.aria.State.ACTIVEDESCENDANT,i.getId()))}indexOfItem(e){var t;return null!==(t=this.itemIndices.get(e.getId()))&&void 0!==t?t:-1}itemAtIndex(e){return this.items[e]}getFocusedItem(){var e;const t=null!==(e=this.root.querySelector(".blocklyFieldGridItem:focus"))&&void 0!==e?e:this.root.querySelector(".blocklyFieldGridItem");if(!t||!t.id)return;const n=this.itemIndices.get(t.id);return void 0!==n?this.itemAtIndex(n):void 0}}class l extends s.FieldDropdown{constructor(e,t,n){super(e,t,n),this.columns=3,(null==n?void 0:n.columns)&&this.setColumns(parseInt(`${n.columns}`)),n&&n.primaryColour&&(this.primaryColour=n.primaryColour),n&&n.borderColour&&(this.borderColour=n.borderColour)}static fromJson(e){if(!e.options)throw new Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}setColumns(e){var t;!isNaN(e)&&e>=1&&(this.columns=e,s.DropDownDiv.getOwner()===this&&s.DropDownDiv.isVisible()&&(null===(t=this.grid)||void 0===t||t.dispose(),this.showEditor_()))}showEditor_(e){var t;s.DropDownDiv.clearContent();const n=!!(null===(t=this.getSourceBlock())||void 0===t?void 0:t.workspace.RTL);this.grid=new a(s.DropDownDiv.getContentDiv(),this.getOptions(!1),this.columns,n,e=>{s.DropDownDiv.hideIfOwner(this),this.setValue(e.getValue())}),s.DropDownDiv.getContentDiv().classList.add("blocklyFieldGridContainer");const i=this.getColours();i&&i.border&&s.DropDownDiv.setColour(i.primary,i.border),s.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this));const r=this.getValue();r&&this.grid.setSelectedValue(r)}doValueUpdate_(e){var t;super.doValueUpdate_(e),null===(t=this.grid)||void 0===t||t.setSelectedValue(e)}getColours(){var e,t;if(this.primaryColour&&this.borderColour)return{primary:this.primaryColour,border:this.borderColour};const n=this.getSourceBlock();if(!(n instanceof s.BlockSvg))return;const i=n.isShadow()?n.getParent():n;return i?{primary:null!==(e=this.primaryColour)&&void 0!==e?e:i.getColour(),border:null!==(t=this.borderColour)&&void 0!==t?t:i.getColourTertiary()}:void 0}}return s.fieldRegistry.register("field_grid_dropdown",l),s.Css.register("\n   .blocklyFieldGridContainer {\n     padding: 7px;\n     overflow: auto;\n   }\n   \n  .blocklyFieldGrid {\n    display: grid;\n    grid-gap: 7px;\n    grid-template-columns: repeat(var(--grid-columns), min-content);\n  }\n\n .blocklyFieldGrid .blocklyFieldGridItem {\n   border: 1px solid rgba(1, 1, 1, 0.5);\n   border-radius: 4px;\n   color: white;\n   min-width: auto;\n   background: none;\n   white-space: nowrap;\n   cursor: pointer;\n   padding: 6px 15px;\n }\n \n .blocklyFieldGrid .blocklyFieldGridRow {\n   display: contents;\n }\n \n .blocklyFieldGrid .blocklyFieldGridItem.blocklyFieldGridItemSelected {\n   background-color: rgba(1, 1, 1, 0.25);\n }\n\n .blocklyFieldGrid .blocklyFieldGridItem:focus {\n   box-shadow: 0 0 0 4px hsla(0, 0%, 100%, .2);\n   outline: none;\n }\n "),r})())},{"blockly/core":175}],171:[function(e,t,n){
/*! For license information please see index.js.LICENSE.txt */
!function(i,r){if("object"==typeof n&&"object"==typeof t)t.exports=r(e("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],r);else{var s=r("object"==typeof n?e("blockly/core"):i.Blockly);for(var o in s)("object"==typeof n?n:i)[o]=s[o]}}(this,e=>(()=>{var t={370:t=>{t.exports=e}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,i),s.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};i.r(r),i.d(r,{WorkspaceSearch:()=>a});var s=i(370);const o=function(){let e=!1;return function(){if(e)return;e=!0;const t=document.createElement("style");t.id="blockly-ws-search-style";const n=document.createTextNode("path.blocklyPath.blockly-ws-search-highlight {\n    fill: #000;\n  }\n  path.blocklyPath.blockly-ws-search-highlight.blockly-ws-search-current {\n    fill: grey;\n  }\n  .blockly-ws-search-close-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=) no-repeat top left;\n  }\n  .blockly-ws-search-next-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSA4LjU5TDEyIDEzLjE3bDQuNTktNC41OEwxOCAxMGwtNiA2LTYtNiAxLjQxLTEuNDF6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PC9zdmc+) no-repeat top left;\n  }\n  .blockly-ws-search-previous-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSAxNS40MUwxMiAxMC44M2w0LjU5IDQuNThMMTggMTRsLTYtNi02IDZ6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==) no-repeat top left;\n  }\n  .blockly-ws-search {\n    background: #fff;\n    border: solid lightgrey 0.5px;\n    box-shadow: 0px 10px 20px grey;\n    justify-content: center;\n    padding: 0.25em;\n    position: absolute;\n    z-index: 70;\n  }\n  .blockly-ws-search-input input {\n    border: none;\n  }\n  .blockly-ws-search button {\n    border: none;\n    padding-left: 6px;\n    padding-right: 6px;\n  }\n  .blockly-ws-search-actions {\n    display: flex;\n  }\n  .blockly-ws-search-container {\n    display: flex;\n  }\n  .blockly-ws-search-content {\n    display: flex;\n  }");t.appendChild(n),document.head.insertBefore(t,document.head.firstChild)}}();class a{constructor(e){this.workspace=e,this.id="workspaceSearch",this.htmlDiv=null,this.actionDiv=null,this.inputElement=null,this.textInputPlaceholder="Search",this.blocks=[],this.lastHighlighted=null,this.currentBlockIndex=-1,this.searchText="",this.searchOnInput=!0,this.caseSensitive=!1,this.preserveSelected=!0,this.boundEvents=[]}init(){this.workspace.getComponentManager().addComponent({component:this,weight:0,capabilities:[s.ComponentManager.Capability.POSITIONABLE]}),o(),this.createDom(),this.setVisible(!1),this.workspace.resize()}dispose(){for(const e of this.boundEvents)s.browserEvents.unbind(e);this.boundEvents.length=0,this.htmlDiv&&(this.htmlDiv.remove(),this.htmlDiv=null),this.actionDiv=null,this.inputElement=null}createDom(){const e=this.workspace.getInjectionDiv();this.addEvent(e,"keydown",this,e=>this.onWorkspaceKeyDown(e)),this.htmlDiv=document.createElement("div"),s.utils.dom.addClass(this.htmlDiv,"blockly-ws-search");const t=document.createElement("div");s.utils.dom.addClass(t,"blockly-ws-search-container");const n=document.createElement("div");s.utils.dom.addClass(n,"blockly-ws-search-content"),t.appendChild(n);const i=document.createElement("div");s.utils.dom.addClass(i,"blockly-ws-search-input"),this.inputElement=this.createTextInput(),this.addEvent(this.inputElement,"keydown",this,e=>this.onKeyDown(e)),this.addEvent(this.inputElement,"input",this,()=>this.onInput()),this.addEvent(this.inputElement,"click",this,()=>{var e;this.searchAndHighlight(this.searchText,this.preserveSelected),null===(e=this.inputElement)||void 0===e||e.select()}),i.appendChild(this.inputElement),n.appendChild(i),this.actionDiv=document.createElement("div"),s.utils.dom.addClass(this.actionDiv,"blockly-ws-search-actions"),n.appendChild(this.actionDiv);const r=this.createNextBtn();r&&this.addActionBtn(r,()=>this.next());const o=this.createPreviousBtn();o&&this.addActionBtn(o,()=>this.previous());const a=this.createCloseBtn();a&&(this.addBtnListener(a,()=>this.close()),t.appendChild(a)),this.htmlDiv.appendChild(t),e.insertBefore(this.htmlDiv,this.workspace.getParentSvg())}addEvent(e,t,n,i){const r=s.browserEvents.conditionalBind(e,t,n,i);this.boundEvents.push(r)}addActionBtn(e,t){var n;this.addBtnListener(e,t),null===(n=this.actionDiv)||void 0===n||n.appendChild(e)}createTextInput(){const e=document.createElement("input");return e.type="text",e.setAttribute("placeholder",this.textInputPlaceholder),e}createNextBtn(){return this.createBtn("blockly-ws-search-next-btn","Find next")}createPreviousBtn(){return this.createBtn("blockly-ws-search-previous-btn","Find previous")}createCloseBtn(){return this.createBtn("blockly-ws-search-close-btn","Close search bar")}createBtn(e,t){const n=document.createElement("button");return s.utils.dom.addClass(n,e),n.setAttribute("aria-label",t),n}addBtnListener(e,t){this.addEvent(e,"click",this,t),this.addEvent(e,"keydown",this,e=>{"Enter"===e.key?(t(e),e.preventDefault()):"Escape"===e.key&&this.close(),e.stopPropagation()})}getBoundingRectangle(){return null}position(e,t){this.htmlDiv&&(this.workspace.RTL?this.htmlDiv.style.left=e.absoluteMetrics.left+"px":e.toolboxMetrics.position===s.TOOLBOX_AT_RIGHT?this.htmlDiv.style.right=e.toolboxMetrics.width+"px":this.htmlDiv.style.right="0",this.htmlDiv.style.top=e.absoluteMetrics.top+"px")}onInput(){if(this.searchOnInput&&this.inputElement){const e=this.inputElement.value.trim();e!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}}onKeyDown(e){if("Escape"===e.key)this.close();else if("Enter"===e.key)if(this.searchOnInput)e.shiftKey?this.previous():this.next();else{if(!this.inputElement)return;const e=this.inputElement.value.trim();e!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}}onWorkspaceKeyDown(e){(e.ctrlKey||e.metaKey)&&"f"===e.key&&(this.open(),e.preventDefault(),e.stopPropagation())}previous(){this.setCurrentBlock(this.currentBlockIndex-1)}next(){this.setCurrentBlock(this.currentBlockIndex+1)}setSearchPlaceholder(e){this.textInputPlaceholder=e,this.inputElement&&this.inputElement.setAttribute("placeholder",this.textInputPlaceholder)}setCurrentBlock(e){if(!this.blocks.length)return;let t=this.blocks[this.currentBlockIndex];t&&this.unhighlightCurrentSelection(t),this.currentBlockIndex=(e%this.blocks.length+this.blocks.length)%this.blocks.length,t=this.blocks[this.currentBlockIndex],this.highlightCurrentSelection(t),this.workspace.centerOnBlock(t.id,!1),this.lastHighlighted=t}open(){var e,t;this.setVisible(!0),null===(e=this.inputElement)||void 0===e||e.focus(),null===(t=this.inputElement)||void 0===t||t.select(),this.searchText&&this.searchAndHighlight(this.searchText)}close(){this.setVisible(!1);const e=s.FocusManager.getFocusManager();this.lastHighlighted&&!this.lastHighlighted.isDisposed()?e.focusNode(this.lastHighlighted):e.focusTree(this.workspace),this.clearBlocks(),this.lastHighlighted=null}setVisible(e){this.htmlDiv&&(this.htmlDiv.style.display=e?"flex":"none")}searchAndHighlight(e,t){const n=this.blocks[this.currentBlockIndex];this.searchText=e.trim(),this.clearBlocks(),this.blocks=this.getMatchingBlocks(this.workspace,this.searchText,this.caseSensitive),this.highlightSearchGroup(this.blocks);let i=0;t&&(i=this.blocks.indexOf(n),i=i>-1?i:0),this.setCurrentBlock(i)}getSearchPool(e){return e.getAllBlocks(!0).filter(e=>{const t=e.getSurroundParent();return!t||!t.isCollapsed()})}isBlockMatch(e,t,n){let i="";if(e.isCollapsed())i=e.toString();else{const t=[];e.inputList.forEach(e=>{e.fieldRow.forEach(e=>{t.push(e.getText())})}),i=t.join(" ").trim()}return n||(i=i.toLowerCase()),i.indexOf(t)>-1}getMatchingBlocks(e,t,n){return t?(this.caseSensitive||(t=t.toLowerCase()),this.getSearchPool(e).filter(e=>this.isBlockMatch(e,t,n))):[]}clearBlocks(){this.unhighlightSearchGroup(this.blocks);const e=this.blocks[this.currentBlockIndex];e&&this.unhighlightCurrentSelection(e),this.currentBlockIndex=-1,this.blocks=[]}highlightCurrentSelection(e){const t=e.pathObject.svgPath;s.utils.dom.addClass(t,"blockly-ws-search-current")}unhighlightCurrentSelection(e){const t=e.pathObject.svgPath;s.utils.dom.removeClass(t,"blockly-ws-search-current")}highlightSearchGroup(e){e.forEach(e=>{const t=e.pathObject.svgPath;s.utils.dom.addClass(t,"blockly-ws-search-highlight")})}unhighlightSearchGroup(e){e.forEach(e=>{const t=e.pathObject.svgPath;s.utils.dom.removeClass(t,"blockly-ws-search-highlight")})}}return r})())},{"blockly/core":175}],172:[function(e,t,n){(function(e){(function(){var i,r;i=this,r=function(){var t,n,i,r,s,o,a,l,c,u,d,p,h,f,m,g,_,y,b,v,T,k,x,E,S,C,w,I,A,N,D,O,R,L,P,M,F,B,$,U,V,H,G,j,K,z,W,q,J,Y,X,Z,Q,ee,te,ne,ie,re,se,oe,ae,le,ce,ue,de,pe,he,fe,me,ge,_e,ye,be,ve,Te,ke,xe,Ee,Se,Ce,we,Ie,Ae,Ne,De,Oe,Re,Le,Pe,Me,Fe,Be,$e,Ue,Ve,He,Ge,je,Ke,ze,We,qe,Je,Ye,Xe,Ze,Qe,et,tt,nt,it,rt,st,ot,at,lt,ct,ut,dt,pt,ht,ft,mt,gt,_t,yt,bt,vt,Tt,kt,xt,Et,St,Ct,wt,It,At,Nt,Dt,Ot,Rt,Lt,Pt,Mt,Ft,Bt,$t,Ut,Vt,Ht,Gt,jt,Kt,zt,Wt,qt,Jt,Yt,Xt,Zt,Qt,en,tn,nn,rn,sn,on,an,ln,cn,un,dn,pn,hn,fn,mn,gn,_n,yn,bn,vn,Tn,kn,xn,En,Sn,Cn,wn,In,An,Nn,Dn,On,Rn,Ln,Pn,Mn,Fn,Bn,$n,Un,Vn,Hn,Gn,jn,Kn,zn,Wn,qn,Jn,Yn,Xn,Zn,Qn,ei,ti,ni,ii,ri,si,oi,ai,li,ci,ui,di,pi,hi,fi,mi,gi,_i,yi,bi,vi,Ti,ki,xi,Ei,Si,Ci,wi,Ii,Ai,Ni,Di,Oi,Ri,Li,Pi,Mi,Fi,Bi,$i,Ui,Vi,Hi,Gi,ji,Ki,zi,Wi,qi,Ji,Yi,Xi,Zi,Qi,er,tr,nr,ir,rr,sr,or,ar,lr,cr,ur,dr,pr,hr,fr,mr,gr,_r,yr,br,vr,Tr,kr,xr,Er,Sr,Cr,wr,Ir,Ar,Nr,Dr,Or,Rr,Lr,Pr,Mr,Fr,Br,$r,Ur,Vr,Hr,Gr,jr,Kr,zr,Wr,qr,Jr,Yr,Xr,Zr,Qr,es,ts,ns,is,rs,ss,os,as,ls,cs,us,ds,ps,hs,fs,ms,gs,_s,ys,bs,vs,Ts,ks,xs,Es,Ss,Cs,ws,Is,As,Ns,Ds,Os,Rs,Ls,Ps,Ms,Fs,Bs,$s,Us,Vs,Hs,Gs,js,Ks,zs,Ws,qs,Js,Ys,Xs,Zs,Qs,eo,to,no,io,ro,so,oo,ao,lo,co,uo,po,ho,fo,mo,go,_o,yo,bo,vo,To,ko,xo,Eo,So,Co,wo,Io,Ao,No,Do,Oo,Ro,Lo,Po,Mo,Fo,Bo,$o,Uo,Vo,Ho,Go,jo,Ko,zo,Wo,qo,Jo,Yo,Xo,Zo,Qo,ea,ta,na,ia,ra,sa,oa,aa,la,ca,ua,da,pa,ha,fa,ma,ga,_a,ya,ba,va,Ta,ka,xa,Ea,Sa,Ca,wa,Ia,Aa,Na,Da,Oa,Ra,La,Pa,Ma,Fa={};t=function(e,t,i,r){if(!(e instanceof Ha)&&"string"!=typeof e||""===`${e}`.trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),"string"!=typeof t||""===t.trim())throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const s=t.toLowerCase();if(!i)throw Error("Can not register a null value");let o=Ba[e],a=Ua[e];if(o||(o=Ba[e]=Object.create(null),a=Ua[e]=Object.create(null)),n(e,i),!r&&o[s]&&o[s]!==i)throw Error('Name "'+s+'" with type "'+e+'" already registered.');o[s]=i,a[s]=t},n=function(e,t){if(e===String(Ha.FIELD)&&"function"!=typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},i=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();const n=Ba[e];n&&n[t]?(delete Ba[e][t],delete Ua[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},r=function(e,t,n){e=`${e}`.toLowerCase(),t=t.toLowerCase();const i=Ba[e];if(!i||!i[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",n)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return i[t]},s=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),!!(e=Ba[e])&&!!e[t]},o=function(e,t,n){return r(e,t,n)},a=function(e,t,n){return r(e,t,n)},l=function(e,t,n){e=`${e}`.toLowerCase();var i=Ba[e];if(!i){if(i=`Unable to find [${e}] in the registry.`,n)throw Error(`${i} You must require or register a ${e} plugin.`);return console.warn(i),null}if(!t)return i;e=Ua[e],n=Object.create(null);for(const t of Object.keys(i))n[e[t]]=i[t];return n},c=function(e,t,n){return"function"==typeof(t=t.plugins[String(e)]||Va)?t:o(e,t,n)},u=function(e,t){d(),sl=setTimeout(function(){t&&t.handleRightClick(e)},tl)},d=function(){sl&&(clearTimeout(sl),sl=0)},p=function(){il=null},h=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&m(e)},f=function(e){return`${e.pointerId}`},m=function(e){const t=f(e);return il?il===t:"pointerdown"===e.type&&(il=t,!0)},g=function(e,t,n,i,r){function s(e){(r||h(e))&&(n?i.call(n,e):i(e))}const o=[];if(t in rl)for(let n=0;n<rl[t].length;n++){const i=rl[t][n];e.addEventListener(i,s,!1),o.push([e,i,s])}else e.addEventListener(t,s,!1),o.push([e,t,s]);return o},_=function(e,t,n,i){function r(e){n?i.call(n,e):i(e)}const s=[];if(t in rl)for(let n=0;n<rl[t].length;n++){const i=rl[t][n];e.addEventListener(i,r,!1),s.push([e,i,r])}else e.addEventListener(t,r,!1),s.push([e,t,r]);return s},y=function(e){const t=e[e.length-1][2];for(;e.length;){const[t,n,i]=e.pop();t.removeEventListener(n,i,!1)}return t},b=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},v=function(e){return!(!e.ctrlKey||!fl)||2===e.button},T=function(e,t,n){const i=t.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,n||(n=t.getScreenCTM().inverse()),i.matrixTransform(n)},k=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*_l,y:e.deltaY*_l};case 2:return{x:e.deltaX*yl,y:e.deltaY*yl}}},x=function(){return"blockly-"+(xl++).toString(36)},E=function(){return kl.genUid()},S=function(e){return e.type===al.BLOCK_CREATE},C=function(e){return e.type===al.BLOCK_DELETE},w=function(e){return e.type===al.BLOCK_CHANGE},I=function(e){return e.type===al.BLOCK_FIELD_INTERMEDIATE_CHANGE},A=function(e){return e.type===al.BLOCK_MOVE},N=function(e){return e.type===al.VAR_CREATE},D=function(e){return e.type===al.VAR_DELETE},O=function(e){return e.type===al.VAR_RENAME},R=function(e){return e.type===al.BLOCK_DRAG},L=function(e){return e.type===al.SELECTED},P=function(e){return e.type===al.CLICK},M=function(e){return e.type===al.BUBBLE_OPEN},F=function(e){return e.type===al.TRASHCAN_OPEN},B=function(e){return e.type===al.TOOLBOX_ITEM_SELECT},$=function(e){return e.type===al.THEME_CHANGE},U=function(e){return e.type===al.VIEWPORT_CHANGE},V=function(e){return e.type===al.COMMENT_CREATE},H=function(e){return e.type===al.COMMENT_DELETE},G=function(e){return e.type===al.COMMENT_CHANGE},j=function(e){return e.type===al.COMMENT_MOVE},K=function(e){return e.type===al.COMMENT_RESIZE},z=function(e){return e.type===al.COMMENT_DRAG},W=function(e){return e.type===al.COMMENT_COLLAPSE},q=function(e){return e.type===al.FINISHED_LOADING},Fa.setRecordUndo$$module$build$src$core$events$utils=function(e){wl=e},J=function(){return wl},Y=function(e){Dl.fireInternal(e)},X=function(e){if(ne()){if(!Nl.length)try{requestAnimationFrame(()=>{setTimeout(Z,0)})}catch(e){setTimeout(Z,0)}Q(e)}},Z=function(){const e=ee(Nl);Nl.length=0;for(const t of e){if(!t.workspaceId)continue;let e;null==(e=Se(t.workspaceId))||e.fireChangeListener(t)}},Q=function(e){if(w(e)&&"mutation"===e.element){let t;for(t=Nl.length;t>0;t--){const n=Nl[t-1];if(n.group!==e.group||n.workspaceId!==e.workspaceId||!A(n)||n.newParentId!==e.blockId)break}Nl.splice(t,0,e)}else Nl.push(e)},ee=function(e){const t=[];for(const n of e)if(e=t[t.length-1],!n.isNull())if(e&&e.workspaceId===n.workspaceId&&e.group===n.group)if(A(n)&&A(e)&&n.blockId===e.blockId){if(e.newParentId=n.newParentId,e.newInputName=n.newInputName,e.newCoordinate=n.newCoordinate,e.reason||n.reason){let t,i;e.reason=Array.from(new Set((null!=(t=e.reason)?t:[]).concat(null!=(i=n.reason)?i:[])))}}else w(n)&&w(e)&&n.blockId===e.blockId&&n.element===e.element&&n.name===e.name?e.newValue=n.newValue:U(n)&&U(e)?(e.viewTop=n.viewTop,e.viewLeft=n.viewLeft,e.scale=n.scale,e.oldScale=n.oldScale):P(n)&&M(e)||t.push(n);else t.push(n);return t.filter(e=>!e.isNull())},te=function(){for(let e,t=0;e=Nl[t];t++)e.recordUndo=!1},Fa.disable$$module$build$src$core$events$utils=function(){Il++},Fa.enable$$module$build$src$core$events$utils=function(){Il--},ne=function(){return 0===Il},Fa.getGroup$$module$build$src$core$events$utils=function(){return Cl},Fa.setGroup$$module$build$src$core$events$utils=function(e){Dl.setGroupInternal(e)},ie=function(e){Cl="boolean"==typeof e?e?E():"":e},re=function(e){const t=[];e=e.getDescendants(!1);for(let n,i=0;n=e[i];i++)t[i]=n.id;return t},se=function(e,t){const n=oe(e.type);if(!n)throw Error("Unknown event type.");return n.fromJson(e,t)},oe=function(e){const t=o(Ha.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},ae=function(e){if((A(e)||S(e))&&e.workspaceId){var t=Se(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const n=wl;try{wl=!1;const n=e.getParent();if(n&&!n.hasDisabledReason(Al)){const t=e.getDescendants(!1);for(let e,n=0;e=t[n];n++)e.setDisabledReason(!1,Al)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do{e.setDisabledReason(!0,Al),e=e.getNextBlock()}while(e)}finally{wl=n}}}},le=function(e,t,n){e=document.createElementNS(Ll,`${e}`);for(const n in t)e.setAttribute(n,`${t[n]}`);return n&&n.appendChild(e),e},ce=function(e,t){return!(t=t.split(" ")).every(t=>e.classList.contains(t))&&(e.classList.add(...t),!0)},ue=function(e,t){e.classList.remove(...t.split(" "))},de=function(e,t){return!(t=t.split(" ")).every(t=>!e.classList.contains(t))&&(e.classList.remove(...t),!0)},pe=function(e,t){return e.classList.contains(t)},he=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},fe=function(e,t){const n=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");n?t.insertBefore(e,n):t.appendChild(e)},me=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},ge=function(){Bl++,Fl||(Fl=Object.create(null))},_e=function(){--Bl||(Fl=null)},ye=function(e){const t=e.textContent+"\n"+e.className.baseVal;var n;return Fl&&(n=Fl[t])||(n=window.getComputedStyle(e),n=ve(e,n.fontSize,n.fontWeight,n.fontFamily),Fl&&(Fl[t]=n)),n},be=function(e,t,n,i){return ve(e,t+"pt",n,i)},ve=function(e,t,n,i){const r=e.textContent;var s;return e=r+"\n"+e.className.baseVal,Fl&&(s=Fl[e])||($l||((s=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(s),$l=s.getContext("2d")),r&&$l?($l.font=n+" "+t+" "+i,s=$l.measureText(r).width):s=0,Fl&&(Fl[e]=s)),s},Te=function(e,t,n,i){const r=document.createElement("span");r.style.font=n+" "+t+" "+i,r.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(r),t.appendChild(e),document.body.appendChild(t),n={height:0,baseline:0};try{t.style.alignItems="baseline",n.baseline=e.offsetTop-r.offsetTop,t.style.alignItems="flex-end",n.height=e.offsetTop-r.offsetTop}finally{document.body.removeChild(t)}return n},Fa.getFocusManager$$module$build$src$core$focus_manager=function(){return Gl.getFocusManager()},ke=function(e){return e&&"function"==typeof e.getFocusableElement&&"function"==typeof e.getFocusableTree&&"function"==typeof e.onNodeFocus&&"function"==typeof e.onNodeBlur&&"function"==typeof e.canBeFocused},xe=function(e){return ke(e)&&"string"==typeof e.id&&"object"==typeof e.workspace&&"function"==typeof e.select&&"function"==typeof e.unselect},Ee=function(e,t){for(const n in t)null!==t[n]&&Array.isArray(t[n])?e[n]=Ee(e[n]||[],t[n]):e[n]=null!==t[n]&&"object"==typeof t[n]?Ee(e[n]||Object.create(null),t[n]):t[n];return e},Se=function(e){return Jl[e]||null},Ce=function(){const e=[];for(const t in Jl)e.push(Jl[t]);return e},we=function(e){Jl[e.id]=e},Ie=function(e){delete Jl[e.id]},Ae=function(){return Wl},Ne=function(e){Wl=e},De=function(){const e=Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&xe(e)?e:null},Oe=function(e){Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},Re=function(e){const t=De();let n,i,r,s;const o=new(oe(al.SELECTED))(null!=(n=null==t?void 0:t.id)?n:null,null!=(i=null==e?void 0:e.id)?i:null,null!=(s=null!=(r=null==e?void 0:e.workspace.id)?r:null==t?void 0:t.workspace.id)?s:"");Y(o)},Le=function(){return ql},Pe=function(e){ql=e},Me=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),n=e.getCachedParentSvgSize();var i=t.parentElement;if(i instanceof HTMLElement){var r=i.offsetWidth;i=i.offsetHeight,n.width!==r&&(t.setAttribute("width",r+"px"),e.setCachedParentSvgSize(r,null)),n.height!==i&&(t.setAttribute("height",i+"px"),e.setCachedParentSvgSize(null,i)),e.resize()}},Fe=function(e,t){const n=Object.create(null),i=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=i.indexOf(e),i.splice(e,i.length-e));for(let e,t=0;e=i[t];t++)n[e.type]?n[e.type]++:n[e.type]=1;return n},Be=function(e){return function(){this.jsonInit(e)}},$e=function(e){Xl.defineBlocksWithJsonArrayInternal(e)},Ue=function(e){Fa.defineBlocks$$module$build$src$core$common(Fa.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},Fa.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let n=0;n<e.length;n++){const i=e[n];if(!i){console.warn(`Block definition #${n} in JSON array is ${i}. Skipping`);continue}const r=i.type;r?t[r]={init:Be(i)}:console.warn(`Block definition #${n} in JSON array is missing a type attribute. Skipping.`)}return t},Fa.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const n=e[t];t in el&&console.warn(`Block definition "${t}" overwrites previous definition.`),el[t]=n}},Ve=function(e){let t=Ae();const n=Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(const e of Ce())if(n===e){t=e;break}b(e)||!t||t.rendered&&!t.isFlyout&&!t.isVisible()||zl.registry.onKeyDown(t,e)},He=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},Ge=function(e){if(cc)throw Error("CSS already injected");uc+="\n"+e},je=function(e,t){cc||(cc=!0,e&&(e=t.replace(/[\\/]$/,""),t=uc.replace(/<<<PATH>>>/g,e),uc="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},Ke=function(e){return gc.getSizeInternal(e)},ze=function(e){if("none"!==qe(e,"display"))return We(e);const t=e.style,n=t.display,i=t.visibility,r=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const s=e.offsetWidth;return e=e.offsetHeight,t.display=n,t.position=r,t.visibility=i,new mc(s,e)},We=function(e){return new mc(e.offsetWidth,e.offsetHeight)},qe=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},Je=function(e){const t=new pc(0,0);e=e.getBoundingClientRect();var n=document.documentElement;return n=new pc(window.pageXOffset||n.scrollLeft,window.pageYOffset||n.scrollTop),t.x=e.left+n.x,t.y=e.top+n.y,t},Ye=function(){const e=document.body,t=document.documentElement;return new pc(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},Xe=function(e){const t=parseFloat(qe(e,"borderLeftWidth")),n=parseFloat(qe(e,"borderRightWidth")),i=parseFloat(qe(e,"borderTopWidth"));return e=parseFloat(qe(e,"borderBottomWidth")),new fc(i,e,t,n)},Ze=function(e,t,n){e=Qe(e,t,n),t.scrollLeft=e.x,t.scrollTop=e.y},Qe=function(e,t,n){var i=Je(e),r=Je(t),s=Xe(t);const o=i.x-r.x-s.left;return i=i.y-r.y-s.top,r=We(e),e=t.clientWidth-r.width,r=t.clientHeight-r.height,s=t.scrollLeft,t=t.scrollTop,n?(s+=o-e/2,t+=i-r/2):(s+=Math.min(o,Math.max(o-e,0)),t+=Math.min(i,Math.max(i-r,0))),new pc(s,t)},et=function(e){const t=new pc(0,0);var n=e.x&&e.getAttribute("x");const i=e.y&&e.getAttribute("y");return n&&(t.x=parseInt(n)),i&&(t.y=parseInt(i)),(n=(n=e.getAttribute("transform"))&&n.match(yc))&&(t.x+=Number(n[1]),n[3]&&(t.y+=Number(n[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(bc))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},tt=function(e){let t=0,n=0;for(;e;){const i=et(e);if(t+=i.x,n+=i.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new pc(t,n)},nt=function(){const e=Ye();return new fc(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},it=function(){const e=document.documentElement,t=window;return new pc(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},rt=function(e,t){var n=t.x;t=t.y;const i=e.getInjectionDiv().getBoundingClientRect();return n=new pc(n-i.left,t-i.top),t=e.getOriginOffsetInPixels(),pc.difference(n,t).scale(1/e.scale)},st=function(e,t){var n=t.scale(e.scale);t=n.x,n=n.y;const i=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new pc(t+i.left+e.x,n+i.top+e.y)},ot=function(e){({document:Ec=Ec,DOMParser:Sc=Sc,XMLSerializer:Cc=Cc}=e),kc=new Sc,xc=new Cc},Fa.createElement$$module$build$src$core$utils$xml=function(e){return Ec.createElementNS(wc,e)},Fa.createTextNode$$module$build$src$core$utils$xml=function(e){return Ec.createTextNode(e)},Fa.textToDom$$module$build$src$core$utils$xml=function(e){let t=kc.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=kc.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},at=function(e){return lt(xc.serializeToString(e))},lt=function(e){return e.replace(Ic,e=>`&#${e.charCodeAt(0)};`)},ct=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=yt(e),e=mt(e)),ut(e),e):null},ut=function(e){const t=e.kind;if(e=e.contents,t&&t!==Oc&&t!==Dc)throw Error("Invalid toolbox kind "+t+". Please supply either "+Oc+" or "+Dc);if(!e)throw Error("Toolbox must have a contents attribute.")},dt=function(e){return e?e.contents?e.contents:Array.isArray(e)&&e.length>0&&!e[0].nodeType?e:gt(e):[]},pt=function(e){return Mc.hasCategoriesInternal(e)},ht=function(e){if(!e)return!1;const t=e.kind;return t?t===Dc:!!e.contents.filter(e=>"CATEGORY"===e.kind.toUpperCase()).length},ft=function(e){return!(!e||!e.contents||!e.contents.filter(function(e){return"CATEGORY"===e.kind.toUpperCase()}).length)},mt=function(e){const t={contents:gt(e)};return e instanceof Node&&_t(e,t),t},gt=function(e){const t=[];let n=e.childNodes;n||(n=e);for(let i,r=0;i=n[r];r++){if(!i.tagName)continue;e={};const n=i.tagName.toUpperCase();e.kind=n,"BLOCK"===n?e.blockxml=i:i.childNodes&&i.childNodes.length>0&&(e.contents=gt(i)),_t(i,e),t.push(e)}return t},_t=function(e,t){for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n];i.nodeName.includes("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[i.nodeName.replace("css-","")]=i.value):t[i.nodeName]=i.value}},yt=function(e){let t=null;if(e)if("string"==typeof e){if(t=Fa.textToDom$$module$build$src$core$utils$xml(e),"xml"!==t.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},bt=function(e,t,n,i,r,s){const o=s.scrollbar&&s.scrollbar.canScrollVertically();return e.horizontal===Lc.LEFT?(n=r.absoluteMetrics.left+n,o&&s.RTL&&(n+=Tc.scrollbarThickness)):(n=r.absoluteMetrics.left+r.viewMetrics.width-t.width-n,o&&!s.RTL&&(n-=Tc.scrollbarThickness)),e.vertical===Rc.TOP?e=r.absoluteMetrics.top+i:(e=r.absoluteMetrics.top+r.viewMetrics.height-t.height-i,s.scrollbar&&s.scrollbar.canScrollHorizontally()&&(e-=Tc.scrollbarThickness)),new fc(e,e+t.height,n,n+t.width)},vt=function(e,t){return{horizontal:t.toolboxMetrics.position===Nc.LEFT||e.horizontalLayout&&!e.RTL?Lc.RIGHT:Lc.LEFT,vertical:t.toolboxMetrics.position===Nc.BOTTOM?Rc.TOP:Rc.BOTTOM}},Tt=function(e,t,n,i){const r=e.left,s=e.right-e.left,o=e.bottom-e.top;for(let a=0;a<i.length;a++){const l=i[a];e.intersects(l)&&(e=n===Pc.UP?l.top-o-t:l.bottom+t,e=new fc(e,e+o,r,r+s),a=-1)}return e},kt=function(e,n){t(Ha.SERIALIZER,e,n)},xt=function(e){i(Ha.SERIALIZER,e)},Et=function(e,{addCoordinates:t=!1,saveIds:n=!0}={}){const i=e.workspace,r=Object.create(null);return r.height=e.getSize().height,r.width=e.getSize().width,n&&(r.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),r.x=i.RTL?i.getWidth()-t.x:t.x,r.y=t.y),e.getText()&&(r.text=e.getText()),e.isCollapsed()&&(r.collapsed=!0),e.isOwnEditable()||(r.editable=!1),e.isOwnMovable()||(r.movable=!1),e.isOwnDeletable()||(r.deletable=!1),r},St=function(e,t,{recordUndo:n=!1}={}){const i=J();if(Fa.setRecordUndo$$module$build$src$core$events$utils(n),n=t.newComment(e.id),void 0!==e.text&&n.setText(e.text),void 0!==e.x||void 0!==e.y){const i=n.getRelativeToSurfaceXY();let s,o=null!=(s=e.x)?s:i.x;var r;o=t.RTL?t.getWidth()-o:o,t=null!=(r=e.y)?r:i.y,n.moveTo(new pc(o,t))}if(void 0!==e.width||e.height){let t,i;r=n.getSize(),n.setSize(new mc(null!=(t=e.width)?t:r.width,null!=(i=e.height)?i:r.height))}return void 0!==e.collapsed&&n.setCollapsed(e.collapsed),void 0!==e.editable&&n.setEditable(e.editable),void 0!==e.movable&&n.setMovable(e.movable),void 0!==e.deletable&&n.setDeletable(e.deletable),Fa.setRecordUndo$$module$build$src$core$events$utils(i),n},Ct=function(e,n){t(Ha.PASTER,e,n)},wt=function(e){i(Ha.PASTER,e)},It=function(e){const t=e.workspace,n=e.getRelativeToSurfaceXY(),i=new pc(0,0),r=t.getTopComments(!1).filter(t=>t.id!==e.id).map(e=>e.getRelativeToSurfaceXY());for(;At(pc.sum(n,i),r);)i.translate(t.RTL?-30:30,30);e.moveTo(pc.sum(n,i))},At=function(e,t){return t.some(t=>Math.abs(t.x-e.x)<=1&&Math.abs(t.y-e.y)<=1)},Nt=function(e,t){e.setAttribute(Yc,t)},Dt=function(e,t,n){Array.isArray(n)&&(n=n.join(" ")),e.setAttribute(Jc+t,`${n}`)},Ot=function(e){return e&&"function"==typeof e.saveState&&"function"==typeof e.loadState},Rt=function(e){return Ft(e),Mt()?(Bt(),Promise.resolve()):(uu||(uu=new Promise(e=>{du=e,pu=window.requestAnimationFrame(()=>{Bt(),e()})})),uu)},Lt=function(){return uu||Promise.resolve()},Pt=function(e){e||window.cancelAnimationFrame(pu),Bt(e),!e&&du&&du()},Mt=function(){return cl},Ft=function(e){lu.add(e),cu.set(e,Fa.getGroup$$module$build$src$core$events$utils());const t=e.getParent();t?Ft(t):au.add(e)},Bt=function(e){const t=e?new Set([e]):new Set([...au].map(e=>e.workspace)),n=[...au].filter(Ut).filter(e=>t.has(e.workspace));for(var i of n)Vt(i);for(const e of t)e.resizeContents();for(var r of n)i=r.getRelativeToSurfaceXY(),r.updateComponentLocations(i);for(const e of n)r=Fa.getGroup$$module$build$src$core$events$utils(),(i=cu.get(e))&&Fa.setGroup$$module$build$src$core$events$utils(i),e.bumpNeighbours(),Fa.setGroup$$module$build$src$core$events$utils(r);for(const e of n)$t(e);e||(uu=null)},$t=function(e){au.delete(e),lu.delete(e),cu.delete(e);for(const t of e.getChildren(!1))$t(t)},Ut=function(e){return!e.isDisposed()&&!e.getParent()},Vt=function(e){if(lu.has(e)&&e.initialized){for(const t of e.getChildren(!1))Vt(t);e.renderEfficiently()}},Ht=function(e,t){bu(e,t)},Gt=function(e=yu){bu=e},jt=function(e,t){Tu(e,t)},Kt=function(e=vu){Tu=e},zt=function(e,t,n){xu(e,t,n)},Wt=function(e=ku){xu=e},qt=function(e,t){Su(e,t)},Jt=function(e=Eu){Su=e},Yt=function(e){return e&&"function"==typeof e.getProcedureDef},Xt=function(e){return e&&"function"==typeof e.getProcedureCall&&"function"==typeof e.renameProcedure},Zt=function(e){return void 0!==e.getVariableModel},Qt=function(e,t,n,i){e=e+" was deprecated in "+t+" and will be deleted in "+n+".",i&&(e+="\nUse "+i+" instead."),Iu.has(e)||(Iu.add(e),console.warn(e))},Fa.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let n=0;n<e.length;n++){const i=e[n].getVarModels();if(i)for(let e=0;e<i.length;e++){const n=i[e];n.getId()&&t.add(n)}}return Array.from(t.values())},Fa.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let i,r=0;i=e[r];r++){var n=i.getDeveloperVariables;if(n){n=n();for(let e=0;e<n.length;e++)t.add(n[e])}}return Array.from(t.values())},en=function(e){return tn(e,!1)},tn=function(e,t=!0){return el.variables_set||el.variables_get||console.warn("There are no variable blocks, but there is a variable category."),t?(Qt("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),sn(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(e){un(e.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...rn(e,e.getVariableMap().getVariablesOfType(""),!0)])},nn=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},rn=function(e,t,n,i="variables_get",r="variables_set"){n&&(n=el.math_change),e=[];const s=t.slice(-1)[0];return s&&(el[r]&&e.push({kind:"block",type:r,gap:n?8:24,fields:nn(s)}),n&&e.push({kind:"block",type:"math_change",gap:el[i]?20:8,fields:nn(s),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}})),el[i]&&e.push(...t.sort(vn).map(e=>({kind:"block",type:i,gap:8,fields:nn(e)}))),e},sn=function(e){let t=[];const n=document.createElement("button");return n.setAttribute("text","%{BKY_NEW_VARIABLE}"),n.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(e){un(e.getTargetWorkspace())}),t.push(n),e=on(e),t.concat(e)},on=function(e){const t=[];if((e=e.getVariableMap().getVariablesOfType("")).length>0){var n=e[e.length-1];if(el.variables_set){var i=Fa.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","variables_set"),i.setAttribute("gap",el.math_change?"8":"24"),i.appendChild(_n(n)),t.push(i)}if(el.math_change&&((i=Fa.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),i.setAttribute("gap",el.variables_get?"20":"8"),i.appendChild(_n(n)),n=Fa.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),i.appendChild(n),t.push(i)),el.variables_get){e.sort(vn);for(let i,r=0;i=e[r];r++)(n=Fa.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),n.setAttribute("gap","8"),n.appendChild(_n(i)),t.push(n)}}return t},an=function(e){return Ou.generateUniqueNameInternal(e)},ln=function(e){return cn(Du.charAt(0),e.getVariableMap().getAllVariables().map(e=>e.getName()))},cn=function(e,t){if(!t.length)return e;const n=Du;let i="",r=n.indexOf(e);for(;;){let s=!1;for(let n=0;n<t.length;n++)if(t[n].toLowerCase()===e){s=!0;break}if(!s)break;r++,r===n.length&&(r=0,i=`${Number(i)+1}`),e=n.charAt(r)+i}return e},un=function(e,t,n){const i=n||"";!function n(r){dn(Fa.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,r,function(r){if(r){var s=hn(r,e);if(s){if(s.getType()===i)var o=Fa.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",s.getName());else o=(o=Fa.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",s.getName()).replace("%2",s.getType());Ht(o,function(){n(r)})}else e.getVariableMap().createVariable(r,i),t&&t(r)}else t&&t(null)})}("")},Fa.renameVariable$$module$build$src$core$variables=function(e,t,n){!function i(r){const s=Fa.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.getName());dn(s,r,function(r){if(r){var s=pn(r,t.getType(),e),o=fn(t.getName(),r,e);if(s||o){var a="";s?a=Fa.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",s.getName()).replace("%2",s.getType()):o&&(a=Fa.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",r).replace("%2",o)),Ht(a,function(){i(r)})}else e.getVariableMap().renameVariable(t,r),n&&n(r)}else n&&n(null)})}("")},dn=function(e,t,n){zt(e,t,function(e){e&&((e=e.replace(/[\s\xa0]+/g," ").trim())===Fa.Msg$$module$build$src$core$msg.RENAME_VARIABLE||e===Fa.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(e=null),n(e)})},pn=function(e,t,n){n=n.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let i,r=0;i=n[r];r++)if(i.getName().toLowerCase()===e&&i.getType()!==t)return i;return null},hn=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let n,i=0;n=t[i];i++)if(n.getName().toLowerCase()===e)return n;return null},fn=function(e,t,n){return n.getProcedureMap().getProcedures().length?mn(e,t,n):gn(e,t,n)},mn=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getProcedureMap().getProcedures();for(const r of n){var i=r.getParameters().filter(Zt).map(e=>e.getVariableModel().getName());if(i&&(n=i.some(t=>t.toLowerCase()===e),i=i.some(e=>e.toLowerCase()===t),n&&i))return r.getName()}return null},gn=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getAllBlocks(!1);for(const r of n){if(!Yt(r))continue;var i=(n=r.getProcedureDef())[1];const s=i.some(t=>t.toLowerCase()===e);if(i=i.some(e=>e.toLowerCase()===t),s&&i)return n[0]}return null},_n=function(e){const t=Fa.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.getType()),e=Fa.createTextNode$$module$build$src$core$utils$xml(e.getName()),t.appendChild(e),t},Fa.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,n,i){let r=Fa.getVariable$$module$build$src$core$variables(e,t,n,i);return r||(r=yn(e,t,n,i)),r},Fa.getVariable$$module$build$src$core$variables=function(e,t,n,i){const r=e.getPotentialVariableMap();let s=null;if(t&&(s=e.getVariableById(t),!s&&r&&(s=r.getVariableById(t)),s))return s;if(n){if(void 0===i)throw Error("Tried to look up a variable by name without a type");s=e.getVariable(n,i),!s&&r&&(s=r.getVariable(n,i))}return s},yn=function(e,t,n,i){const r=e.getVariableMap(),s=e.getPotentialVariableMap();return n||(n=an(e.isFlyout?e.targetWorkspace:e)),s?s.createVariable(n,i,null!=t?t:void 0):r.createVariable(n,i,t)},bn=function(e,t){e=e.getAllVariables();const n=[];if(t.length!==e.length)for(let i=0;i<e.length;i++){const r=e[i];t.includes(r)||n.push(r)}return n},vn=function(e,t){return e.getName().localeCompare(t.getName(),void 0,{sensitivity:"base"})},Tn=function(e,t){const n=[];e=e.getAllBlocks(!1);for(let i=0;i<e.length;i++){const r=e[i].getVarModels();if(r)for(let s=0;s<r.length;s++)r[s].getId()===t&&n.push(e[i])}return n},Fa.deleteVariable$$module$build$src$core$variables=function(e,t,n){var i=t.getName();const r=Tn(e,t.getId());for(let e=r.length-1;e>=0;e--){const t=r[e];if("procedures_defnoreturn"===t.type||"procedures_defreturn"===t.type)return n=String(t.getFieldValue("NAME")),i=Fa.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",i).replace("%2",n),void Ht(i);t===n&&r.splice(e,1)}n&&r.length||r.length>1?(i=Fa.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length+(n&&!n.workspace.isFlyout?1:0))).replace("%2",i),jt(i,n=>{n&&t&&e.getVariableMap().deleteVariable(t)})):e.getVariableMap().deleteVariable(t)},kn=function(e,{addCoordinates:t=!1,addInputBlocks:n=!0,addNextBlocks:i=!0,doFullSerialization:r=!0,saveIds:s=!0}={}){if(e.isInsertionMarker())return null;const o={type:e.type,id:s?e.id:void 0};return t&&En(e,o),xn(e,o),Sn(e,o,r),Cn(e,o,r),wn(e,o,r),n&&In(e,o,r,s),i&&An(e,o,r,s),o},xn=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},En=function(e,t){const n=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(n.RTL?n.getWidth()-e.x:e.x),t.y=Math.round(e.y)},Sn=function(e,t,n){e.saveExtraState?null!==(e=e.saveExtraState(n))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=$r(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},Cn=function(e,t,n){const i=Object.create(null);for(const t of e.getIcons())Ot(t)&&(e=t.saveState(n))&&(i[t.getType().toString()]=e);Object.keys(i).length&&(t.icons=i)},wn=function(e,t,n){const i=Object.create(null);for(const t of e.getFields())t.isSerializable()&&(i[t.name]=t.saveState(n));Object.keys(i).length&&(t.fields=i)},In=function(e,t,n,i){const r=Object.create(null);for(let t=0;t<e.inputList.length;t++){const s=e.inputList[t];if(!s.connection)continue;const o=Nn(s.connection,n,i);o&&(r[s.name]=o)}Object.keys(r).length&&(t.inputs=r)},An=function(e,t,n,i){e.nextConnection&&(e=Nn(e.nextConnection,n,i))&&(t.next=e)},Nn=function(e,t,n){const i=e.getShadowState(!0);if(e=e.targetBlock(),!i&&!e)return null;const r=Object.create(null);return i&&(r.shadow=i),e&&!e.isShadow()&&(r.block=kn(e,{doFullSerialization:t,saveIds:n})),r},Dn=function(e,t,{recordUndo:n=!1}={}){return e=On(e,t,{recordUndo:n}),t.rendered&&Pt(),e},On=function(e,t,{parentConnection:n,isShadow:i=!1,recordUndo:r=!1}={}){const s=J();Fa.setRecordUndo$$module$build$src$core$events$utils(r),(r=Fa.getGroup$$module$build$src$core$events$utils())||Fa.setGroup$$module$build$src$core$events$utils(!0),Fa.disable$$module$build$src$core$events$utils();const o=t.getAllVariables();let a;try{a=Rn(e,t,{parentConnection:n,isShadow:i})}finally{Fa.enable$$module$build$src$core$events$utils()}if(Ln(t,o),ne()&&Y(new(oe(al.BLOCK_CREATE))(a)),Fa.setGroup$$module$build$src$core$events$utils(r),Fa.setRecordUndo$$module$build$src$core$events$utils(s),t.rendered){const e=a;setTimeout(()=>{e.disposed||e.setConnectionTracking(!0)},1)}return a},Rn=function(e,t,{parentConnection:n,isShadow:i=!1}={}){if(!e.type)throw new Pu(e);const r=t.newBlock(e.type,e.id);return r.setShadow(i),Pn(r,e),Mn(r,e),Fn(r,e),Bn(n,r,e),$n(r,e),Un(r,e),Vn(r,e),Hn(r,e),jn(r,t.rendered),r},Ln=function(e,t){if(ne())for(e=bn(e,t),t=0;t<e.length;t++){const n=e[t];Y(new(oe(al.VAR_CREATE))(n))}},Pn=function(e,t){let n=void 0===t.x?0:t.x;t=void 0===t.y?0:t.y;const i=e.workspace;n=i.RTL?i.getWidth()-n:n,e.moveBy(n,t)},Mn=function(e,t){if(t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setDisabledReason(!0,iu),Array.isArray(t.disabledReasons))for(const n of t.disabledReasons)e.setDisabledReason(!0,n);void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},Fn=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(Fa.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Bn=function(e,t,n){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new Bu(n);if(e.type===Fa.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var i=t.outputConnection;if(!i)throw new Mu("output",t,n)}else if(!(i=t.previousConnection))throw new Mu("previous",t,n);if(!e.connect(i)){const r=t.workspace.connectionChecker;throw new Fu(r.getErrorMessage(r.canConnectWithReason(i,e,!1),i,e),e.type===Fa.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,n)}}},$n=function(e,t){if(t.icons){var n=Object.keys(t.icons);for(const r of n){n=t.icons[r];var i=e.getIcon(r);if(!i){if(!(i=o(Ha.ICON,r,!1)))throw new $u(r,e,t);i=new i(e),e.addIcon(i)}Ot(i)&&i.loadState(n)}}},Un=function(e,t){if(t.fields){var n=Object.keys(t.fields);for(let i=0;i<n.length;i++){const r=n[i],s=t.fields[r],o=e.getField(r);o?o.loadState(s):console.warn(`Ignoring non-existant field ${r} in block ${e.type}`)}}},Vn=function(e,t){if(t.inputs){var n=Object.keys(t.inputs);for(let i=0;i<n.length;i++){const r=n[i],s=e.getInput(r);if(!s||!s.connection)throw new Mu(r,e,t);Gn(s.connection,t.inputs[r])}}},Hn=function(e,t){if(t.next){if(!e.nextConnection)throw new Mu("next",e,t);Gn(e.nextConnection,t.next)}},Gn=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Rn(t.block,e.getSourceBlock().workspace,{parentConnection:e})},jn=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const t of e.getIcons())t.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},Kn=function(e){return"function"==typeof e.bubbleIsVisible&&"function"==typeof e.setBubbleVisible&&"function"==typeof e.getBubble},zn=function(e){return e*Math.PI/180},Wn=function(e){return 180*e/Math.PI},qn=function(e,t,n){if(n<e){const t=n;n=e,e=t}return Math.max(e,Math.min(t,n))},Jn=function(){document.querySelector(".blocklyDropDownDiv")||((Wu=document.createElement("div")).className="blocklyDropDownDiv",Wu.tabIndex=-1,(Le()||document.body).appendChild(Wu),(qu=document.createElement("div")).className="blocklyDropDownContent",Wu.appendChild(qu),cd=g(qu,"keydown",null,Ve),(Ju=document.createElement("div")).className="blocklyDropDownArrow",Wu.appendChild(Ju),Wu.style.opacity="0",Wu.style.transition="transform "+ed+"s, opacity "+ed+"s")},Yn=function(e){sd=e},Xn=function(){return od},Zn=function(){return qu},Qn=function(){cd&&(y(cd),cd=null),Wu.remove(),Jn()},ei=function(e,t){Wu.style.backgroundColor=e,Wu.style.borderColor=t},ti=function(e,t,n,i,r=!0){return si(ii(t),e,r,n,i)},ni=function(e,t,n,i=!0){return ad=!0,si(ri(e),e,i,t,n)},ii=function(e){var t=e.getSvgRoot();const n=e.workspace.scale,i=e.height*n;return e=e.width*n,t=Je(t),new fc(t.y,t.y+i,t.x,t.x+e)},ri=function(e){return e=e.getScaledBBox(),new fc(e.top,e.bottom,e.left,e.right)},si=function(e,t,n,i,r){const s=e.left+(e.right-e.left)/2,o=e.bottom;e=e.top,r&&(e+=r);let a=(r=t.getSourceBlock()).workspace;for(;a.options.parentWorkspace;)a=a.options.parentWorkspace;return Yn(a.getParentSvg().parentNode),oi(t,r.RTL,s,o,s,e,n,i)},oi=function(e,t,n,i,r,s,o,a){return od=e,nd=a||null,Wu.style.direction=t?"rtl":"ltr",e=Ae(),id=e.getRenderer().getClassName(),rd=e.getTheme().getClassName(),ce(Wu,id),ce(Wu,rd),n=mi(n,i,r,s),o&&(ld=Fa.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(Wu)),n},ai=function(e,t,n,i){return{initialX:(e=ui(e,n.left,n.right,i.width)).divX,initialY:t,finalX:e.divX,finalY:t+Qu,arrowX:e.arrowX,arrowY:-(Yu/2+Xu),arrowAtTop:!0,arrowVisible:!0}},li=function(e,t,n,i){return{initialX:(e=ui(e,n.left,n.right,i.width)).divX,initialY:t-i.height,finalX:e.divX,finalY:t-i.height-Qu,arrowX:e.arrowX,arrowY:i.height-2*Xu-Yu/2,arrowAtTop:!1,arrowVisible:!0}},ci=function(e,t,n){return{initialX:(e=ui(e,t.left,t.right,n.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},ui=function(e,t,n,i){return t=qn(t,e-i/2,n-i),{arrowX:e=qn(n=Zu,e=e-Yu/2-t,i-n-Yu),divX:t}},di=function(){return!!od},pi=function(e,t){return od===e&&(t?fi():hi(),!0)},hi=function(){Wu.style.transform="translate(0, 0)",Wu.style.opacity="0",td=setTimeout(function(){fi()},1e3*ed),nd&&(nd(),nd=null)},fi=function(){di()&&(td&&clearTimeout(td),nd&&(nd(),nd=null),Qn(),od=null,Ae().markFocused(),ld&&(ld(),ld=null))},mi=function(e,t,n,i){(e=ud.getPositionMetrics(e,t,n,i)).arrowVisible?(t=e.arrowX,n=e.arrowY,i=e.arrowAtTop?45:225,Ju.style.display="",Ju.style.transform=`translate(${t}px, ${n}px) rotate(${i}deg)`,Ju.setAttribute("class","blocklyDropDownArrow")):Ju.style.display="none",t=Math.floor(e.initialX),n=Math.floor(e.initialY),i=Math.floor(e.finalX);const r=Math.floor(e.finalY);return Wu.style.left=t+"px",Wu.style.top=n+"px",Wu.style.display="block",Wu.style.opacity="1",Wu.style.transform="translate("+(i-t)+"px,"+(r-n)+"px)",!!e.arrowAtTop},gi=function(){if(od){var e=od.getSourceBlock();const t=(e=ad?ri(od):ii(e)).left+(e.right-e.left)/2;mi(t,e.bottom,t,e.top)}else hi()},_i=function(e){return e.length?e.reduce(function(e,t){return e.length<t.length?e:t}).length:0},yi=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,i=0;for(t=t||_i(e),n=0;n<t;n++){for(var r=e[0][n],s=1;s<e.length;s++)if(r!==e[s][n])return i;" "===r&&(i=n+1)}for(r=1;r<e.length;r++)if((s=e[r][n])&&" "!==s)return i;return t},bi=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,i=0;for(t=t||_i(e),n=0;n<t;n++){for(var r=e[0].substr(-n-1,1),s=1;s<e.length;s++)if(r!==e[s].substr(-n-1,1))return i;" "===r&&(i=n+1)}for(r=1;r<e.length;r++)if((s=e[r].charAt(e[r].length-n-1))&&" "!==s)return i;return t},Fa.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split("\n");for(let n=0;n<e.length;n++)e[n]=vi(e[n],t);return e.join("\n")},vi=function(e,t){if(e.length<=t)return e;const n=e.trim().split(/\s+/);for(var i=0;i<n.length;i++)n[i].length>t&&(t=n[i].length);var r=-1/0;let s,o=1;do{i=r,s=e,e=[],r=n.length/o;let a=1;for(let t=0;t<n.length-1;t++)a<(t+1.5)/r?(a++,e[t]=!0):e[t]=!1;e=ki(n,e,t),r=Ti(n,e,t),e=xi(n,e),o++}while(r>i);return s},Ti=function(e,t,n){const i=[0],r=[];for(var s=0;s<e.length;s++)i[i.length-1]+=e[s].length,!0===t[s]?(i.push(0),r.push(e[s].charAt(e[s].length-1))):!1===t[s]&&i[i.length-1]++;for(e=Math.max(...i),t=0,s=0;s<i.length;s++)t-=2*Math.pow(Math.abs(n-i[s]),1.5),t-=Math.pow(e-i[s],1.5),".?!".includes(r[s])?t+=n/3:",;)]}".includes(r[s])&&(t+=n/4);return i.length>1&&i[i.length-1]<=i[i.length-2]&&(t+=.5),t},ki=function(e,t,n){let i,r=Ti(e,t,n);for(let s=0;s<t.length-1;s++){if(t[s]===t[s+1])continue;const o=[].concat(t);o[s]=!o[s],o[s+1]=!o[s+1];const a=Ti(e,o,n);a>r&&(r=a,i=o)}return i?ki(e,i,n):t},xi=function(e,t){const n=[];for(let i=0;i<e.length;i++)n.push(e[i]),void 0!==t[i]&&n.push(t[i]?"\n":" ");return n.join("")},Fa.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Ei=function(e){hd=e},Si=function(){return hd},Ci=function(){return fd},wi=function(){return Id},Ii=function(e){if(e=Ai(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},Ai=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},Ni=function(){document.querySelector(".blocklyTooltipDiv")||((Id=document.createElement("div")).className="blocklyTooltipDiv",(Le()||document.body).appendChild(Id))},Di=function(e){e.mouseOverWrapper_=_(e,"pointerover",null,Ri),e.mouseOutWrapper_=_(e,"pointerout",null,Li),e.addEventListener("pointermove",Pi,!1)},Oi=function(e){e&&(y(e.mouseOverWrapper_),y(e.mouseOutWrapper_),e.removeEventListener("pointermove",Pi))},Ri=function(e){md||(e=Ai(e.currentTarget),Td!==e&&(Fi(),kd=null,Td=e),clearTimeout(_d))},Li=function(e){md||(_d=setTimeout(function(){kd=Td=null,Fi()},1),clearTimeout(yd),yd=0)},Pi=function(e){if(Td&&Td.tooltip&&!md)if(fd){const t=bd-e.pageX;e=vd-e.pageY,Math.sqrt(t*t+e*e)>Sd&&Fi()}else kd!==Td&&(clearTimeout(yd),bd=e.pageX,vd=e.pageY,yd=setTimeout(Gi,Cd))},Mi=function(){kd=Td=null,Fi()},Fi=function(){fd&&(fd=!1,Id&&(Id.style.display="none")),yd&&(clearTimeout(yd),yd=0)},Bi=function(){Fi(),md=!0},$i=function(){md=!1},Ui=function(){Id&&Td&&("function"==typeof hd?hd(Id,Td):Vi())},Vi=function(){var e=Ii(Td);e=(e=Fa.wrap$$module$build$src$core$utils$string(e,gd)).split("\n");for(let t=0;t<e.length;t++){const n=document.createElement("div");n.appendChild(document.createTextNode(e[t])),Id.appendChild(n)}},Hi=function(e){const t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;let i=bd;i=e?i-(xd+Id.offsetWidth):i+xd;let r=vd+Ed;return r+Id.offsetHeight>n+window.scrollY&&(r-=Id.offsetHeight+2*Ed),e?i=Math.max(wd-window.scrollX,i):i+Id.offsetWidth>t+window.scrollX-2*wd&&(i=t-Id.offsetWidth-2*wd),{x:i,y:r}},Gi=function(){if(!md&&(kd=Td,Id)){Id.textContent="",Ui();var e=Td.RTL;Id.style.direction=e?"rtl":"ltr",Id.style.display="block",fd=!0;var{x:t,y:n}=Hi(e);Id.style.left=t+"px",Id.style.top=n+"px"}},ji=function(){return Nd},Ki=function(e){Nd=e},zi=function(){return Dd},Wi=function(e){Dd=e},qi=function(e){e=`${e}`.toLowerCase().trim();var t=Od[e];if(t)return t;if(t="#"===(t="0x"===e.substring(0,2)?"#"+e.substring(2):e)[0]?t:"#"+t,/^#[0-9a-f]{6}$/.test(t))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var n=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return n&&(e=Number(n[1]),t=Number(n[2]),n=Number(n[3]),e>=0&&e<256&&t>=0&&t<256&&n>=0&&n<256)?Ji(e,t,n):null},Ji=function(e,t,n){return t=e<<16|t<<8|n,e<16?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Yi=function(e){return(e=qi(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},Xi=function(e,t,n){let i=0,r=0,s=0;if(0===t)s=r=i=n;else{const o=Math.floor(e/60),a=e/60-o;e=n*(1-t);const l=n*(1-t*a);switch(t=n*(1-t*(1-a)),o){case 1:i=l,r=n,s=e;break;case 2:i=e,r=n,s=t;break;case 3:i=e,r=l,s=n;break;case 4:i=t,r=e,s=n;break;case 5:i=n,r=e,s=l;break;case 6:case 0:i=n,r=t,s=e}}return Ji(Math.floor(i),Math.floor(r),Math.floor(s))},Zi=function(e,t,n){return(e=qi(e))&&(t=qi(t))?(e=Yi(e),t=Yi(t),Ji(Math.round(t[0]+n*(e[0]-t[0])),Math.round(t[1]+n*(e[1]-t[1])),Math.round(t[2]+n*(e[2]-t[2])))):null},Qi=function(e){return Xi(e,Nd,255*Dd)},er=function(e,t,n){const i=[];var r=e.split("");r.push("");var s=0;e=[];let o=null;for(let c=0;c<r.length;c++){var a=r[c];if(0===s)if("%"===a)(s=e.join(""))&&i.push(s),e.length=0,s=1;else if(n&&"\n"===a){const t=e.join("");t&&i.push(t),e.length=0,i.push(a)}else e.push(a);else if(1===s)"%"===a?(e.push(a),s=0):t&&"0"<=a&&a<="9"?(s=2,o=a,(a=e.join(""))&&i.push(a),e.length=0):"{"===a?s=3:(e.push("%",a),s=0);else if(2===s)if("0"<=a&&a<="9")o+=a;else{var l=void 0;i.push(parseInt(null!=(l=o)?l:"",10)),c--,s=0}else 3===s&&(""===a?(e.splice(0,0,"%{"),c--,s=0):"}"!==a?e.push(a):(s=e.join(""),/[A-Z]\w*/i.test(s)&&(a=(a=s.toUpperCase()).startsWith("BKY_")?a.substring(4):null)&&a in Fa.Msg$$module$build$src$core$msg?"string"==typeof(s=Fa.Msg$$module$build$src$core$msg[a])?Array.prototype.push.apply(i,er(s,t,n)):t?i.push(`${s}`):i.push(s):i.push("%{"+s+"}"),s=e.length=0))}for((t=e.join(""))&&i.push(t),l=[],e.length=0,r=0;r<i.length;r++)"string"!=typeof i[r]||n&&"\n"===i[r]?((t=e.join(""))&&l.push(t),e.length=0,l.push(i[r])):e.push(i[r]);return(t=e.join(""))&&l.push(t),e.length=0,l},tr=function(e){return er(e,!0,!0)},nr=function(e){return"string"!=typeof e?e:(e=er(e,!1,!1)).length?String(e[0]):""},ir=function(e){let t=!0;const n=Fa.Msg$$module$build$src$core$msg,i=e.match(/%{BKY_[A-Z]\w*}/gi);if(i)for(let r=0;r<i.length;r++)void 0===n[i[r].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+i[r]+" in "+e),t=!1);return t},rr=function(e){const t="string"==typeof e?nr(e):e;var n=Number(t);if(!isNaN(n)&&0<=n&&n<=360)return{hue:n,hex:Xi(n,ji(),255*zi())};if(n=qi(t))return{hue:null,hex:n};throw n='Invalid colour: "'+t+'"',e!==t&&(n+=' (from "'+e+'")'),Error(n)},sr=function(){return Bd},or=function(e){if(Bd=e,null===e){let e;null==(e=document.querySelector("."+Hd))||e.remove()}},ar=function(){const e=Le()||document.body,t=document.querySelector("div."+Hd);t?Bd=t:((Bd=document.createElement("div")).className=Hd,Bd.tabIndex=-1),g(Bd,"keydown",null,Ve),e.appendChild(Bd)},lr=function(e,t,n,i,r=!0){if(cr(),$d=e,Vd=n,n=Bd){if(n.style.direction=t?"rtl":"ltr",n.style.display="block",!i&&e instanceof Pd){let t;i=null==(t=e.getSourceBlock())?void 0:t.workspace}var s,o;Ud=null!=(s=i)?s:null,e=null!=(o=i)?o:Ae(),Gd=e.getRenderer().getClassName(),jd=e.getTheme().getClassName(),Gd&&ce(n,Gd),jd&&ce(n,jd),r&&(Kd=Fa.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(n))}},cr=function(){if(ur()){$d=null;var e=Bd;e&&(e.style.display="none",e.style.left="",e.style.top="",Vd&&(Vd(),Vd=null),e.textContent="",Gd&&(de(e,Gd),Gd=""),jd&&(de(e,jd),jd=""),Ae().markFocused(),Kd&&(Kd(),Kd=null))}},ur=function(){return!!$d},dr=function(e){$d===e&&cr()},pr=function(e){let t=null===Ud,n=e;for(;!t&&n;){if(n===e){t=!0;break}n=e.options.parentWorkspace}t&&cr()},hr=function(e,t,n){Bd.style.left=e+"px",Bd.style.top=t+"px",Bd.style.height=n+"px"},fr=function(e,t,n,i){const r=gr(e,t,n);e=mr(e,t,n,i),r<0?hr(e,0,n.height+r):hr(e,r,n.height)},mr=function(e,t,n,i){return i?Math.min(Math.max(t.right-n.width,e.left),e.right-n.width):Math.max(Math.min(t.left,e.right-n.width),e.left)},gr=function(e,t,n){return t.bottom+n.height>=e.bottom?t.top-n.height:t.bottom},_r=function(e){return!(null==e||!e.repositionForWindowResize)},yr=function(){_r($d)&&$d.repositionForWindowResize()||cr()},br=function(){return Wd},vr=function(e){Wd=e},Tr=function(e,t,n,i,r){if(lr(qd,n,wr,i),t.length){r||(e instanceof PointerEvent?r=new pc(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),r=new pc(0,0)));var s=kr(t,n,e,r);Jd=s,xr(s,n,r),setTimeout(function(){s.focus()},1),Wd=null}else Cr()},kr=function(e,t,n,i){const r=new Qc;r.setRole(Wc.MENU);for(let s=0;s<e.length;s++){const o=e[s];if(o.separator){r.addChild(new eu);continue}const a=new Zc(o.text);a.setRightToLeft(t),a.setRole(Wc.MENUITEM),r.addChild(a),a.setEnabled(o.enabled),o.enabled&&a.onAction(function(e,t){Cr(),requestAnimationFrame(()=>{setTimeout(()=>{o.callback(o.scope,n,t,i)},0)})},{})}return r},xr=function(e,t,n){const i=nt();n=new fc(n.y+i.top,n.y+i.top,n.x+i.left,n.x+i.left),Er(e);const r=e.getSize();t&&(n.left+=r.width,n.right+=r.width,i.left+=r.width,i.right+=r.width),fr(i,n,r,t),e.focus()},Er=function(e){var t=sr();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),ce(t,"blocklyContextMenu"),g(t,"contextmenu",null,Sr),e.focus()},Sr=function(e){e.preventDefault(),e.stopPropagation()},Cr=function(){dr(qd),Wd=null},wr=function(){Jd&&(Jd.dispose(),Jd=null)},Fa.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{let n;Fa.disable$$module$build$src$core$events$utils();try{n=t instanceof Element?jr(t,e.workspace):On(t,e.workspace);const i=e.getRelativeToSurfaceXY();i.x=e.RTL?i.x-Fa.config$$module$build$src$core$config.snapRadius:i.x+Fa.config$$module$build$src$core$config.snapRadius,i.y+=2*Fa.config$$module$build$src$core$config.snapRadius,n.moveBy(i.x,i.y)}finally{Fa.enable$$module$build$src$core$events$utils()}return ne()&&!n.isShadow()&&Y(new(oe(al.BLOCK_CREATE))(n)),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(n),n}},Ir=function(e,t){return(t=T(t,e.getParentSvg(),e.getInverseScreenCTM())).x/=e.scale,t.y/=e.scale,t},Ar=function(e,t,n){t=Ir(e,t),rp.set(e,pc.difference(n,t))},Nr=function(e,t){if(t=Ir(e,t),!(e=rp.get(e)))throw Error("Drag not initialized");return pc.sum(e,t)},Dr=function(e,t=!1){const n=Fa.createElement$$module$build$src$core$utils$xml("xml");var i=Rr(Fa.allUsedVarModels$$module$build$src$core$variables(e));i.hasChildNodes()&&n.appendChild(i);for(const i of e.getTopComments())n.appendChild(Or(i,t));for(e=e.getTopBlocks(!0),i=0;i<e.length;i++)n.appendChild(Lr(e[i],t));return n},Or=function(e,t=!1){const n=Fa.createElement$$module$build$src$core$utils$xml("comment");t||n.setAttribute("id",e.id),t=e.workspace;const i=e.getRelativeToSurfaceXY();return i.x=t.RTL?t.getWidth()-i.x:i.x,n.setAttribute("x",`${i.x}`),n.setAttribute("y",`${i.y}`),n.setAttribute("w",`${e.getSize().width}`),n.setAttribute("h",`${e.getSize().height}`),e.getText()&&(n.textContent=e.getText()),e.isCollapsed()&&n.setAttribute("collapsed","true"),e.isOwnEditable()||n.setAttribute("editable","false"),e.isOwnMovable()||n.setAttribute("movable","false"),e.isOwnDeletable()||n.setAttribute("deletable","false"),n},Rr=function(e){const t=Fa.createElement$$module$build$src$core$utils$xml("variables");for(let n=0;n<e.length;n++){const i=e[n],r=Fa.createElement$$module$build$src$core$utils$xml("variable");r.appendChild(Fa.createTextNode$$module$build$src$core$utils$xml(i.getName())),i.getType()&&r.setAttribute("type",i.getType()),r.id=i.getId(),t.appendChild(r)}return t},Lr=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let n=0;if(e.workspace.RTL&&(n=e.workspace.getWidth()),t=Fr(e,t),is(t)){const i=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?n-i.x:i.x))),t.setAttribute("y",String(Math.round(i.y)))}return t},Pr=function(e){if(e.isSerializable()){const t=Fa.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},Mr=function(e,t){for(const n of e.getFields())(e=Pr(n))&&t.appendChild(e)},Fr=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?Fr(t):new DocumentFragment;const n=Fa.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(n.setAttribute("type",e.type),t||(n.id=e.id),e.mutationToDom){var i=e.mutationToDom();i&&(i.hasChildNodes()||i.hasAttributes())&&n.appendChild(i)}if(Mr(e,n),i=e.getCommentText()){var r=e.getIcon(Gu.COMMENT),s=r.getBubbleSize(),o=r.bubbleIsVisible();r=r.getBubbleLocation();var a=Fa.createElement$$module$build$src$core$utils$xml("comment");a.appendChild(Fa.createTextNode$$module$build$src$core$utils$xml(i)),a.setAttribute("pinned",`${o}`),a.setAttribute("h",`${s.height}`),a.setAttribute("w",`${s.width}`),r&&(a.setAttribute("x",`${e.workspace.RTL?e.workspace.getWidth()-(r.x+s.width):r.x}`),a.setAttribute("y",`${r.y}`)),n.appendChild(a)}for(e.data&&((i=Fa.createElement$$module$build$src$core$utils$xml("data")).appendChild(Fa.createTextNode$$module$build$src$core$utils$xml(e.data)),n.appendChild(i)),i=0;i<e.inputList.length;i++){var l=void 0;o=!0,(s=e.inputList[i]).type!==Fa.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&s.type!==Fa.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(r=s.connection.targetBlock(),s.type===Fa.inputTypes$$module$build$src$core$inputs$input_types.VALUE?l=Fa.createElement$$module$build$src$core$utils$xml("value"):s.type===Fa.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(l=Fa.createElement$$module$build$src$core$utils$xml("statement")),!(a=s.connection.getShadowDom())||r&&r.isShadow()||l.appendChild(Br(a,t)),r&&(r=Fr(r,t)).nodeType===Rl.ELEMENT_NODE&&(l.appendChild(r),o=!1),l.setAttribute("name",s.name),o||n.appendChild(l))}let c;return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&n.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&n.setAttribute("collapsed","true"),e.isEnabled()||n.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||n.setAttribute("deletable","false"),e.isOwnMovable()||n.setAttribute("movable","false"),e.isOwnEditable()||n.setAttribute("editable","false"),(l=e.getNextBlock())&&(i=Fr(l,t)).nodeType===Rl.ELEMENT_NODE&&(c=Fa.createElement$$module$build$src$core$utils$xml("next"),c.appendChild(i),n.appendChild(c)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||l&&l.isShadow()||c.appendChild(Br(e,t)),n},Br=function(e,t){let n,i=e=e.cloneNode(!0);for(;i;)if(t&&"shadow"===i.nodeName&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){let e;n=i,i=i.parentNode,n.nodeType===Rl.TEXT_NODE&&""===n.data.trim()&&(null==(e=i)?void 0:e.firstChild)!==n&&he(n)}i&&(n=i,i=i.nextSibling,n.nodeType===Rl.TEXT_NODE&&""===n.data.trim()&&he(n))}return e},$r=function(e){return at(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Ur=function(e){e=$r(e).split("<");let t="";for(let n=1;n<e.length;n++){const i=e[n];"/"===i[0]&&(t=t.substring(2)),e[n]=t+"<"+i,"/"!==i[0]&&"/>"!==i.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Vr=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=Fa.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},Fa.domToWorkspace$$module$build$src$core$xml=function(e,t){let n=0;t.RTL&&(n=t.getWidth());const i=[];ge();const r=Fa.getGroup$$module$build$src$core$events$utils();r||Fa.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let s=!0;try{for(let r,o=0;r=e.childNodes[o];o++){const e=r.nodeName.toLowerCase(),o=r;if("block"===e||"shadow"===e&&!J()){const e=jr(o,t);let r;i.push(e.id);const a=parseInt(null!=(r=o.getAttribute("x"))?r:"10",10);let l;const c=parseInt(null!=(l=o.getAttribute("y"))?l:"10",10);isNaN(a)||isNaN(c)||e.moveBy(t.RTL?n-a:a,c,["create"]),s=!1}else{if("shadow"===e)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===e)Hr(o,t);else if("variables"===e){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Kr(o,t),s=!1}}}}finally{Fa.setGroup$$module$build$src$core$events$utils(r),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&Pt(),_e()}return Y(new(oe(al.FINISHED_LOADING))(t)),i},Hr=function(e,t){var n;const i=null!=(n=e.getAttribute("id"))?n:void 0;var r,s;let o;var a;let l;return(n=t.rendered?new mp(t,i):new fp(t,i)).setText(null!=(r=e.textContent)?r:""),r=parseInt(null!=(s=e.getAttribute("x"))?s:"",10),s=parseInt(null!=(o=e.getAttribute("y"))?o:"",10),isNaN(r)||isNaN(s)||(r=t.RTL?t.getWidth()-r:r,n.moveTo(new pc(r,s))),t=parseInt(null!=(a=e.getAttribute("w"))?a:"",10),a=parseInt(null!=(l=e.getAttribute("h"))?l:"",10),isNaN(t)||isNaN(a)||n.setSize(new mc(t,a)),"true"===e.getAttribute("collapsed")&&n.setCollapsed(!0),"false"===e.getAttribute("editable")&&n.setEditable(!1),"false"===e.getAttribute("movable")&&n.setMovable(!1),"false"===e.getAttribute("deletable")&&n.setDeletable(!1),n},Gr=function(e,t){if(!t.getBlocksBoundingBox)return Fa.domToWorkspace$$module$build$src$core$xml(e,t);var n=t.getBlocksBoundingBox();if(e=Fa.domToWorkspace$$module$build$src$core$xml(e,t),n&&n.top!==n.bottom){var i=n.bottom;n=t.RTL?n.right:n.left;var r=1/0;let s=-1/0,o=1/0;for(let n=0;n<e.length;n++){const i=t.getBlockById(e[n]).getRelativeToSurfaceXY();i.y<o&&(o=i.y),i.x<r&&(r=i.x),i.x>s&&(s=i.x)}for(i=i-o+10,n=t.RTL?n-s:n-r,r=0;r<e.length;r++)t.getBlockById(e[r]).moveBy(n,i,["create"])}return e},Fa.domToBlock$$module$build$src$core$xml=function(e,t){return e=jr(e,t),t.rendered&&Pt(),e},jr=function(e,t){Fa.disable$$module$build$src$core$events$utils();var n=t.getAllVariables();let i;try{if(i=es(e,t),t.rendered){const e=i,n=i.getDescendants(!1);e.setConnectionTracking(!1);for(let e=n.length-1;e>=0;e--)n[e].initSvg();for(let e=n.length-1;e>=0;e--)n[e].queueRender();setTimeout(function(){e.disposed||e.setConnectionTracking(!0)},1),t.resizeContents()}else{const e=i.getDescendants(!1);for(let t=e.length-1;t>=0;t--)e[t].initModel()}}finally{Fa.enable$$module$build$src$core$events$utils()}if(ne()){for(e=bn(t,n),t=0;t<e.length;t++)n=e[t],Y(new(oe(al.VAR_CREATE))(n));Y(new(oe(al.BLOCK_CREATE))(i))}return i},Kr=function(e,t){for(let i=0;i<e.children.length;i++){var n=e.children[i];const r=n.getAttribute("type"),s=n.getAttribute("id");if(!(n=n.textContent))break;let o;t.getVariableMap().createVariable(n,null!=(o=r)?o:void 0,s)}},zr=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let n=0;n<e.children.length;n++){const i=e.children[n];if(i.nodeType!==Rl.TEXT_NODE)switch(i.nodeName.toLowerCase()){case"mutation":t.mutation.push(i);break;case"comment":t.comment.push(i);break;case"data":t.data.push(i);break;case"title":case"field":t.field.push(i);break;case"value":case"statement":t.input.push(i);break;case"next":t.next.push(i);break;default:console.warn("Ignoring unknown tag: "+i.nodeName)}}return t},Wr=function(e,t){let n=!1;for(let i=0;i<e.length;i++){const r=e[i];t.domToMutation&&(t.domToMutation(r),t.initSvg&&(n=!0))}return n},qr=function(e,t){for(let n=0;n<e.length;n++){const i=e[n],r=i.textContent,s="true"===i.getAttribute("pinned");let o;const a=parseInt(null!=(o=i.getAttribute("w"))?o:"50",10);let l;const c=parseInt(null!=(l=i.getAttribute("h"))?l:"50",10);let u,d,p=parseInt(null!=(u=i.getAttribute("x"))?u:"",10);const h=parseInt(null!=(d=i.getAttribute("y"))?d:"",10);t.setCommentText(r);const f=t.getIcon(Gu.COMMENT);isNaN(a)||isNaN(c)||f.setBubbleSize(new mc(a,c)),f.setBubbleVisible(s),setTimeout(()=>{isNaN(p)||isNaN(h)||(p=t.workspace.RTL?t.workspace.getWidth()-(p+a):p,f.setBubbleLocation(new pc(p,h))),f.setBubbleVisible(s)},1)}},Jr=function(e,t){for(let n=0;n<e.length;n++)t.data=e[n].textContent},Yr=function(e,t){for(let n=0;n<e.length;n++){const i=e[n],r=i.getAttribute("name");r?ts(t,r,i):console.warn(`Ignoring unnamed field in block ${t.type}`)}},Xr=function(e){let t=null,n=null;for(let i=0;i<e.childNodes.length;i++){const r=e.childNodes[i];is(r)&&("block"===r.nodeName.toLowerCase()?t=r:"shadow"===r.nodeName.toLowerCase()&&(n=r))}return{childBlockElement:t,childShadowElement:n}},Zr=function(e,t,n,i){for(let s=0;s<e.length;s++){var r=e[s];const o=r.getAttribute("name"),a=o?n.getInput(o):null;if(!a){console.warn("Ignoring non-existent input "+o+" in block "+i);break}if((r=Xr(r)).childBlockElement){if(!a.connection)throw TypeError("Input connection does not exist.");es(r.childBlockElement,t,a.connection,!1)}if(r.childShadowElement){let e;null==(e=a.connection)||e.setShadowDom(r.childShadowElement)}}},Qr=function(e,t,n){for(let i=0;i<e.length;i++){const r=Xr(e[i]);if(r.childBlockElement){if(!n.nextConnection)throw TypeError("Next statement does not exist.");if(n.nextConnection.isConnected())throw TypeError("Next statement is already connected.");es(r.childBlockElement,t,n.nextConnection,!0)}r.childShadowElement&&n.nextConnection&&n.nextConnection.setShadowDom(r.childShadowElement)}},es=function(e,t,n,i){var r;const s=e.getAttribute("type");if(!s)throw TypeError("Block type unspecified: "+e.outerHTML);var o=null!=(r=e.getAttribute("id"))?r:void 0;r=t.newBlock(s,o),o=zr(e);const a=Wr(o.mutation,r);if(qr(o.comment,r),Jr(o.data,r),n)if(i){if(!r.previousConnection)throw TypeError("Next block does not have previous statement.");n.connect(r.previousConnection)}else if(r.outputConnection)n.connect(r.outputConnection);else{if(!r.previousConnection)throw TypeError("Child block does not have output or previous statement.");n.connect(r.previousConnection)}if(Yr(o.field,r),Zr(o.input,t,r,s),Qr(o.next,t,r),a&&r.initSvg(),(t=e.getAttribute("inline"))&&r.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&r.setDisabledReason("true"===t||"disabled"===t,iu),null!==(t=e.getAttribute("disabled-reasons")))for(var l of t.split(","))r.setDisabledReason(!0,decodeURIComponent(l));if((l=e.getAttribute("deletable"))&&r.setDeletable("true"===l),(l=e.getAttribute("movable"))&&r.setMovable("true"===l),(l=e.getAttribute("editable"))&&r.setEditable("true"===l),(l=e.getAttribute("collapsed"))&&r.setCollapsed("true"===l),"shadow"===e.nodeName.toLowerCase()){for(e=r.getChildren(!1),l=0;l<e.length;l++)if(!e[l].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");r.setShadow(!0)}return r},ts=function(e,t,n){const i=e.getField(t);i?i.fromXml(n):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},ns=function(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if("next"===n.nodeName.toLowerCase()){e.removeChild(n);break}}},is=function(e){return e.nodeType===Rl.ELEMENT_NODE},rs=function(e,n){t(Ha.FIELD,e,n)},ss=function(e){i(Ha.FIELD,e)},Fa.fromJson$$module$build$src$core$field_registry=function(e){return Sp.fromJsonInternal(e)},os=function(e){const t=a(Ha.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},as=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height},Fa.register$$module$build$src$core$extensions=function(e,t){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(Mp[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof t)throw Error('Error: Extension "'+e+'" must be a function');Mp[e]=t},Fa.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!=typeof t)throw Error('Error: Mixin "'+e+'" must be a object');Fa.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},Fa.registerMutator$$module$build$src$core$extensions=function(e,t,n,i){const r='Error when registering mutator "'+e+'": ';gs(r,t);const s=fs(t,r);if(n&&"function"!=typeof n)throw Error(r+'Extension "'+e+'" is not a function');Fa.register$$module$build$src$core$extensions(e,function(){s&&this.setMutator(new Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon(i||[],this)),this.mixin(t),n&&n.apply(this)})},ls=function(e){cs(e)?delete Mp[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},cs=function(e){return!!Mp[e]},us=function(e,t,n){const i=Mp[e];if("function"!=typeof i)throw Error('Error: Extension "'+e+'" not found.');let r;if(n?ds(e,t):r=_s(t),i.apply(t),n)gs('Error after applying mutator "'+e+'": ',t);else if(!ys(r,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},ds=function(e,t){if(_s(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},ps=function(e,t){return ms(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},hs=function(e,t){return ms(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},fs=function(e,t){return ms(e.compose,e.decompose,t+" compose/decompose")},ms=function(e,t,n){if(e&&t){if("function"!=typeof e||"function"!=typeof t)throw Error(n+" must be a function");return!0}if(!e&&!t)return!1;throw Error(n+"Must have both or neither functions")},gs=function(e,t){const n=ps(t,e),i=hs(t,e);if(!n&&!i)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");fs(t,e)},_s=function(e){const t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},ys=function(e,t){if((t=_s(t)).length!==e.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},bs=function(e){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{const t=setInterval(function(){"complete"===document.readyState&&(clearInterval(t),e())},10)}},Fa.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const n=[];return function(){n.includes(this.type)||(vs(this,e,t),n.push(this.type)),this.setTooltip(function(){const n=String(this.getFieldValue(e));return nr(t[n])}.bind(this))}},vs=function(e,t,n){var i=e.getField(t);if(i instanceof wp&&!i.isOptionListDynamic()){i=i.getOptions();for(const r of i)r!==wp.SEPARATOR&&([,i]=r,void 0===n[i]&&console.warn(`No tooltip mapping for value ${i} of field ${t} of block type ${e.type}.`))}},Fa.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const n=this.getField(t);return nr(e).replace("%1",n?n.getText():"")}.bind(this))}},Ts=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},ks=function(e,t){return" "+e+","+t+" "},xs=function(e,t){return" "+e+t.join("")},Es=function(e,t){return" M "+e+","+t+" "},Ss=function(e,t){return" m "+e+","+t+" "},Cs=function(e,t){return" l "+e+","+t+" "},ws=function(e){return" l"+e.join("")},Is=function(e,t){return" "+e+" "+t+" "},As=function(e,t,n,i){return e+" "+n+" "+n+" "+t+i},Ns=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},Ds=function(e,t){let n=null;const i=null==(t=t.outputConnection)?void 0:t.getConnectionChecker();for(let r,s=0;r=e.inputList[s];s++){const e=r.connection;let s;if(e&&null!=(s=i)&&s.canConnect(t,e,!1)){if(n)return null;n=e}}return n},Os=function(e,t){let n;for(;n=Ds(e,t);)if(!(e=n.targetBlock())||e.isShadow())return n;return null},Rs=function(e){return ke(e)&&"function"==typeof e.getType&&"function"==typeof e.initView&&"function"==typeof e.dispose&&"function"==typeof e.getWeight&&"function"==typeof e.getSize&&"function"==typeof e.applyColour&&"function"==typeof e.hideForInsertionMarker&&"function"==typeof e.updateEditable&&"function"==typeof e.updateCollapsed&&"function"==typeof e.isShownWhenCollapsed&&"function"==typeof e.setOffsetInBlock&&"function"==typeof e.onLocationChange&&"function"==typeof e.onClick},Ls=function(e){return Rs(e)&&Kn(e)&&Ot(e)&&"function"==typeof e.setText&&"function"==typeof e.getText&&"function"==typeof e.setBubbleSize&&"function"==typeof e.getBubbleSize&&"function"==typeof e.setBubbleLocation&&"function"==typeof e.getBubbleLocation&&e.getType()===Gu.COMMENT},Ps=function(e){if(!(e.getDescendants(!1).length>100)){var t=e.workspace,n=e.getSvgRoot();t.getAudioManager().play("delete");var i,r=e.getRelativeToSurfaceXY(),s=n.cloneNode(!0);s.setAttribute("transform","translate("+r.x+","+r.y+")"),null==(i=t.getLayerManager())||i.appendToAnimationLayer({getSvgRoot:()=>s}),Ms(s,{x:r.x,y:r.y,width:e.width,height:e.height},t.RTL,new Date)}},Ms=function(e,t,n,i){const r=((new Date).getTime()-i.getTime())/150;r>1?he(e):(e.setAttribute("transform","translate("+(t.x+(n?-1:1)*t.width/2*r)+","+(t.y+t.height/2*r)+") scale("+(1-r)+")"),setTimeout(Ms,10,e,t,n,i))},Fs=function(e){var t=e.workspace;const n=t.scale;if(t.getAudioManager().play("click"),!(n<1)){var i=t.getSvgXY(e.getSvgRoot());e.outputConnection?(i.x+=(e.RTL?3:-3)*n,i.y+=13*n):e.previousConnection&&(i.x+=(e.RTL?-23:23)*n,i.y+=3*n);var r=le(hc.CIRCLE,{cx:i.x,cy:i.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=le(hc.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*n},r),t=le(hc.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},r),e.beginElement(),t.beginElement(),setTimeout(()=>{he(r)},150)}},Bs=function(e){if(Us(),e.workspace.getAudioManager().play("disconnect"),!(e.workspace.scale<1)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),rh=e,$s(e,t,new Date,0)}},$s=function(e,t,n,i){const r=[.66,1,.66,0,-.66,-1,-.66,0];let s="";n.getTime()+200>(new Date).getTime()&&(s=`skewX(${Math.round(r[i%r.length]*t)})`,ih=setTimeout($s,15,e,t,n,i+1)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${s}`)},Us=function(){rh&&(ih&&(clearTimeout(ih),ih=null),rh.getSvgRoot().setAttribute("transform",rh.getTranslation()),rh=null)},Vs=function(e,t){const n=e.workspace,i=Fa.config$$module$build$src$core$config.snapRadius,r=pc.difference(t,e.getRelativeToSurfaceXY()),s=new pc(0,0),o=n.getAllBlocks(!1).filter(t=>t.id!=e.id).map(e=>e.getRelativeToSurfaceXY());for(;Hs(pc.sum(t,s),o)||Gs(e,pc.sum(r,s),i);)n.RTL?s.translate(-i,2*i):s.translate(i,2*i);e.moveTo(pc.sum(t,s))},Hs=function(e,t){return t.some(t=>Math.abs(t.x-e.x)<=1&&Math.abs(t.y-e.y)<=1)},Gs=function(e,t,n){return e.getConnections_(!1).some(e=>!!e.closest(n,t).connection)},js=function(e,t,n){const i=n.getBoundingRectangle(),r=i.right-i.left,s=qn(t.top,i.top,t.top+t.height-(i.bottom-i.top))-i.top;let o=t.left;return t=t.left+t.width-r,e.RTL?o=Math.min(t,o):t=Math.max(o,t),!(!(e=qn(o,i.left,t)-i.left)&&!s||(n.moveBy(e,s,["inbounds"]),0))},Ks=function(e){return t=>{var n,i=e.getMetricsManager();if(i.hasFixedEdges()&&!e.isDragging())if(vl.includes(null!=(n=t.type)?n:"")){n=i.getScrollMetrics(!0);const r=zs(e,t);r&&(i=Fa.getGroup$$module$build$src$core$events$utils()||!1,Fa.setGroup$$module$build$src$core$events$utils(t.group),js(e,n,r)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),Fa.setGroup$$module$build$src$core$events$utils(i))}else U(t)&&t.scale&&t.oldScale&&t.scale>t.oldScale&&Ws(e)}},zs=function(e,t){let n=null;switch(t.type){case al.BLOCK_CREATE:case al.BLOCK_MOVE:(n=e.getBlockById(t.blockId))&&(n=n.getRootBlock());break;case al.COMMENT_CREATE:case al.COMMENT_MOVE:case al.COMMENT_RESIZE:n=e.getCommentById(t.commentId)}return n},Ws=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var n=e.getTopBoundedElements();for(let i,r=0;i=n[r];r++)js(e,t,i)}},qs=function(e){return e&&"function"==typeof e.isDeletable&&"function"==typeof e.dispose&&"function"==typeof e.setDeleteStyle},Js=function(e,t){const n=e.getIcons();for(const i of e.inputList){if(!i.isVisible())continue;let r;if(n.push(...i.fieldRow),null!=(r=i.connection)&&r.targetBlock())if(e=i.connection.targetBlock(),i.connection.type!==vp.NEXT_STATEMENT||t)n.push(e);else{let t;(e=null==(t=e.lastConnectionInStack(!1))?void 0:t.getSourceBlock())&&n.push(e)}else{let e;(null==(e=i.connection)?void 0:e.type)===vp.INPUT_VALUE&&n.push(i.connection)}}return n},Ys=function(e,t){const n=e.workspace.getTopBoundedElements(!0).filter(e=>ke(e));let i=null;if((e=n.indexOf(e instanceof ph?e.getRootBlock():e)+t)>=0&&e<n.length?i=n[e]:e<0?i=n[n.length-1]:e>=n.length&&(i=n[0]),t<0&&i instanceof ph){let e,t;return null!=(t=null==(e=i.lastConnectionInStack(!1))?void 0:e.getSourceBlock())?t:i}return i},Xs=function(e,t){var n;let i;const r=e instanceof ph?null!=(i=null==(n=e.outputConnection)?void 0:n.targetBlock())?i:e.getSurroundParent():e.getSourceBlock();return r instanceof ph?-1===(e=(n=Js(r,t>0)).indexOf(e))?null:(t=e+t)>=0&&t<n.length?n[t]:null:null},Zs=function(e){return e&&"function"==typeof e.getRelativeToSurfaceXY&&"function"==typeof e.isMovable&&"function"==typeof e.startDrag&&"function"==typeof e.drag&&"function"==typeof e.endDrag&&"function"==typeof e.revertDrag},Qs=function(e){return e&&"function"==typeof e.autoHide},eo=function(e,n){t(Ha.ICON,e.toString(),n)},to=function(e){i(Ha.ICON,e)},no=function(e){return"function"==typeof e.getProcedureModel&&"function"==typeof e.doProcedureUpdate&&"function"==typeof e.isProcedureDef},io=function(e){return e&&"function"==typeof e.startPublishing&&"function"==typeof e.stopPublishing},ro=function(e){const t=e.getProcedureMap().getProcedures().filter(e=>!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(e=>{!no(e)&&Yt(e)&&t.push(e.getProcedureDef())});const n=e.getProcedureMap().getProcedures().filter(e=>!!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(e=>{!no(e)&&Yt(e)&&n.push(e.getProcedureDef())}),t.sort(so),n.sort(so),[t,n]},so=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},Fa.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||Fa.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!oo(e,t.workspace,t);){const t=e.match(/^(.*?)(\d+)$/);e=t?t[1]+(parseInt(t[2])+1):e+"2"}return e},oo=function(e,t,n){return!ao(e,t,n)},ao=function(e,t,n){for(const i of t.getAllBlocks(!1))if(i!==n&&Yt(i)&&Fa.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return!0;n=n&&no(n)?null==n?void 0:n.getProcedureModel():void 0;for(const i of t.getProcedureMap().getProcedures())if(i!==n&&Fa.Names$$module$build$src$core$names.equals(i.getName(),e))return!0;return!1},Fa.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new Md;e=e.trim();const n=Fa.findLegalName$$module$build$src$core$procedures(e,t);no(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(n);const i=this.getValue();if(i!==e&&i!==n)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const r=e[t];r.renameProcedure&&r.renameProcedure(i,n)}return n},lo=function(e){function t(e,t){for(let r=0;r<e.length;r++){var i=e[r][0];const s=e[r][1],o=Fa.createElement$$module$build$src$core$utils$xml("block");o.setAttribute("type",t),o.setAttribute("gap","16");const a=Fa.createElement$$module$build$src$core$utils$xml("mutation");for(a.setAttribute("name",i),o.appendChild(a),i=0;i<s.length;i++){const e=Fa.createElement$$module$build$src$core$utils$xml("arg");e.setAttribute("name",s[i]),a.appendChild(e)}n.push(o)}}const n=[];if(el.procedures_defnoreturn){var i=Fa.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_defnoreturn"),i.setAttribute("gap","16");var r=Fa.createElement$$module$build$src$core$utils$xml("field");r.setAttribute("name","NAME"),r.appendChild(Fa.createTextNode$$module$build$src$core$utils$xml(Fa.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),i.appendChild(r),n.push(i)}return el.procedures_defreturn&&((i=Fa.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),i.setAttribute("gap","16"),(r=Fa.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),r.appendChild(Fa.createTextNode$$module$build$src$core$utils$xml(Fa.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),i.appendChild(r),n.push(i)),el.procedures_ifreturn&&((i=Fa.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),i.setAttribute("gap","16"),n.push(i)),n.length&&n[n.length-1].setAttribute("gap","24"),t((e=ro(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),n},co=function(e){return uo(e,!1)},uo=function(e,t=!0){function n(e,t){for(const[n,r]of e)i.push({kind:"block",type:t,gap:16,extraState:{name:n,params:r}})}if(t)return Qt("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),lo(e);const i=[];return el.procedures_defnoreturn&&i.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:Fa.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),el.procedures_defreturn&&i.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:Fa.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),el.procedures_ifreturn&&i.push({kind:"block",type:"procedures_ifreturn",gap:16}),i.length&&(i[i.length-1].gap=24),n((e=ro(e))[0],"procedures_callnoreturn"),n(e[1],"procedures_callreturn"),i},po=function(e){var t=[],n=e.getBlocksByType("procedures_mutatorarg",!1);for(let e,i=0;e=n[i];i++)t.push(e.getFieldValue("NAME"));n=Fa.createElement$$module$build$src$core$utils$xml("xml");const i=Fa.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_mutatorarg");const r=Fa.createElement$$module$build$src$core$utils$xml("field");r.setAttribute("name","NAME"),t=cn(Fa.DEFAULT_ARG$$module$build$src$core$procedures,t),t=Fa.createTextNode$$module$build$src$core$utils$xml(t),r.appendChild(t),i.appendChild(r),n.appendChild(i),e.updateToolbox(n)},ho=function(e){if(M(e)&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var t=(e=Se(e.workspaceId).getBlockById(e.blockId)).type;"procedures_defnoreturn"!==t&&"procedures_defreturn"!==t||(e=e.getIcon(Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),po(e),e.addChangeListener(fo))}},fo=function(e){(S(e)||C(e)||w(e)||I(e))&&(e=Se(e.workspaceId),po(e))},mo=function(e,t){return t.getAllBlocks(!1).filter(t=>go(t,e)||Xt(t)&&Fa.Names$$module$build$src$core$names.equals(t.getProcedureCall(),e))},go=function(e,t){return no(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&Fa.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},Fa.mutateCallers$$module$build$src$core$procedures=function(e){const t=J();var n=e.getProcedureDef()[0];const i=e.mutationToDom(!0);e=mo(n,e.workspace);for(let s,o=0;s=e[o];o++){n=(n=s.mutationToDom())&&at(n),s.domToMutation&&s.domToMutation(i);var r=s.mutationToDom();n!==(r=r&&at(r))&&(Fa.setRecordUndo$$module$build$src$core$events$utils(!1),Y(new(oe(al.BLOCK_CHANGE))(s,"mutation",null,n,r)),Fa.setRecordUndo$$module$build$src$core$events$utils(t))}},Fa.getDefinition$$module$build$src$core$procedures=function(e,t){for(const n of t.getAllBlocks(!1))if(no(n)&&n.isProcedureDef()&&Fa.Names$$module$build$src$core$names.equals(n.getProcedureModel().getName(),e)||Yt(n)&&Fa.Names$$module$build$src$core$names.equals(n.getProcedureDef()[0],e))return n;return null},_o=function(e){return e.isDynamic},yo=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},bo=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},vo=function(e,n){t(Ha.RENDERER,e,n)},To=function(e){i(Ha.RENDERER,e)},ko=function(e,t,n){return(e=new(o(Ha.RENDERER,e))(e)).init(t,n),e},xo=function(e){un(e.getTargetWorkspace(),void 0,"String")},Eo=function(e){un(e.getTargetWorkspace(),void 0,"Number")},So=function(e){un(e.getTargetWorkspace(),void 0,"Colour")},Co=function(e){return wo(e,!1)},wo=function(e,t=!0){return el.variables_set_dynamic||el.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),t?(Qt("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),Io(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",xo),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Eo),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",So),[{kind:"button",text:Fa.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:Fa.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:Fa.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...rn(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},Io=function(e){let t=[],n=document.createElement("button");return n.setAttribute("text",Fa.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(n),n=document.createElement("button"),n.setAttribute("text",Fa.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(n),n=document.createElement("button"),n.setAttribute("text",Fa.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(n),e.registerButtonCallback("CREATE_VARIABLE_STRING",xo),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Eo),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",So),e=Ao(e),t.concat(e)},Ao=function(e){const t=[];if((e=e.getVariableMap().getAllVariables()).length>0){if(el.variables_set_dynamic){var n=e[e.length-1];const i=Fa.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","variables_set_dynamic"),i.setAttribute("gap","24"),i.appendChild(_n(n)),t.push(i)}if(el.variables_get_dynamic){e.sort(vn);for(let i,r=0;i=e[r];r++)(n=Fa.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),n.setAttribute("gap","8"),n.appendChild(_n(i)),t.push(n)}}return t},No=function(e){e.resizeContents()},Do=function(e,t){const n=e.toCopyData();return om=n,am=xe(e)&&e.workspace instanceof Mf?e.workspace:null,lm=t,n},Oo=function(){return om},Ro=function(e){om=e},Lo=function(){return am},Po=function(e){am=e},Mo=function(){return lm},Fo=function(e){lm=e},Bo=function(e,t,n){return e&&t?$o(e,t,n):om&&am?$o(om,am,lm):null},$o=function(e,t,n){let i,r,s;return t=t.isMutator?t:null!=(i=t.options.parentWorkspace)?i:t,null!=(s=null==(r=a(Ha.PASTER,e.paster,!1))?void 0:r.paste(e,t,n))?s:null},Uo=function(e){return e&&"function"==typeof e.toCopyData},Vo=function(){zl.registry.register({name:um.ESCAPE,preconditionFn:e=>!e.isReadOnly(),callback:e=>(e.hideChaff(),!0),keyCodes:[Bp.ESC]})},Ho=function(){zl.registry.register({name:um.DELETE,preconditionFn:(e,t)=>(t=t.focusedNode,!e.isReadOnly()&&null!=t&&qs(t)&&t.isDeletable()&&!e.isDragging()&&!Fa.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()),callback:(e,t,n,i)=>(t.preventDefault(),(e=i.focusedNode)instanceof ph?e.checkAndDelete():qs(e)&&e.isDeletable()&&(Fa.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),Fa.setGroup$$module$build$src$core$events$utils(!1)),!0),keyCodes:[Bp.DELETE,Bp.BACKSPACE]})},Go=function(e){return!!(Uo(e)&&qs(e)&&Zs(e))&&(e.isCopyable?e.isCopyable():e instanceof ph||e instanceof mp?e.isOwnDeletable()&&e.isOwnMovable():e.isDeletable()&&e.isMovable())},jo=function(e){return Go(e)&&qs(e)&&e.isDeletable()},Ko=function(){const e=zl.registry.createSerializedKey(Bp.C,[Bp.CTRL]),t=zl.registry.createSerializedKey(Bp.C,[Bp.META]);zl.registry.register({name:um.COPY,preconditionFn:(e,t)=>(t=t.focusedNode,e=e.isFlyout?e.targetWorkspace:e,!!t&&!!e&&!e.isDragging()&&!Fa.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&Go(t)),callback:(e,t,n,i)=>(t.preventDefault(),!!((t=i.focusedNode)&&Uo(t)&&Go(t))&&!!(e=e.isFlyout?e.targetWorkspace:e)&&(t.workspace.isFlyout||e.hideChaff(),e=Zs(t)&&t.workspace==e?t.getRelativeToSurfaceXY():void 0,!!Do(t,e))),keyCodes:[e,t]})},zo=function(){const e=zl.registry.createSerializedKey(Bp.X,[Bp.CTRL]),t=zl.registry.createSerializedKey(Bp.X,[Bp.META]);zl.registry.register({name:um.CUT,preconditionFn:(e,t)=>!!(t=t.focusedNode)&&!e.isReadOnly()&&!e.isDragging()&&!Fa.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&jo(t),callback:(e,t,n,i)=>!!((e=i.focusedNode)&&jo(e)&&Uo(e))&&(t=Zs(e)?e.getRelativeToSurfaceXY():void 0,t=Do(e,t),e instanceof ph?e.checkAndDelete():qs(e)&&e.dispose(),!!t),keyCodes:[e,t]})},Wo=function(){const e=zl.registry.createSerializedKey(Bp.V,[Bp.CTRL]),t=zl.registry.createSerializedKey(Bp.V,[Bp.META]);zl.registry.register({name:um.PASTE,preconditionFn(){var e=Lo();return!(!e||!e.rendered||(e=e.isFlyout?e.targetWorkspace:e,!Oo()||!e||e.isReadOnly()||e.isDragging()||Fa.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()))},callback(e,t){if(!(e=Oo()))return!1;var n=Lo();if(!n)return!1;if(!(n=n.isFlyout?n.targetWorkspace:n)||n.isReadOnly())return!1;if(t instanceof PointerEvent)return t=rt(n,new pc(t.clientX,t.clientY)),!!Bo(e,n,t);if(!(t=Mo()))return!!Bo(e,n);const{left:i,top:r,width:s,height:o}=n.getMetricsManager().getViewMetrics(!0);return new fc(r,r+o,i,i+s).contains(t.x,t.y)?!!Bo(e,n):(t=new pc(i+s/2,r+o/2),!!Bo(e,n,t))},keyCodes:[e,t]})},qo=function(){const e=zl.registry.createSerializedKey(Bp.Z,[Bp.CTRL]),t=zl.registry.createSerializedKey(Bp.Z,[Bp.META]);zl.registry.register({name:um.UNDO,preconditionFn:e=>!e.isReadOnly()&&!e.isDragging()&&!Fa.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(e,t)=>(e.hideChaff(),e.undo(!1),t.preventDefault(),!0),keyCodes:[e,t]})},Jo=function(){const e=zl.registry.createSerializedKey(Bp.Z,[Bp.CTRL,Bp.SHIFT]),t=zl.registry.createSerializedKey(Bp.Z,[Bp.META,Bp.SHIFT]),n=zl.registry.createSerializedKey(Bp.Y,[Bp.CTRL]);zl.registry.register({name:um.REDO,preconditionFn:e=>!e.isDragging()&&!e.isReadOnly()&&!Fa.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(e,t)=>(e.hideChaff(),e.undo(!0),t.preventDefault(),!0),keyCodes:[e,t,n]})},Yo=function(){Vo(),Ho(),Ko(),zo(),Wo(),qo(),Jo()},Xo=function(e){const t=e.saveState();return e.getParameters().length?(t.parameters=e.getParameters().map(e=>e.saveState()),t):t},Zo=function(e,t,n,i){if(e=e.loadState(n,i),!n.parameters)return e;for(const[r,s]of n.parameters.entries())e.insertParameter(t.loadState(s,i),r);return e},Qo=function(e){const t=Object.create(null),n=l(Ha.SERIALIZER,!0);for(const i in n){let r;const s=null==(r=n[i])?void 0:r.save(e);s&&(t[i]=s)}return t},ea=function(e,t,{recordUndo:n=!1}={}){var i=l(Ha.SERIALIZER,!0);if(i){i=Object.entries(i).sort((e,t)=>t[1].priority-e[1].priority);var r=J();Fa.setRecordUndo$$module$build$src$core$events$utils(n),(n=Fa.getGroup$$module$build$src$core$events$utils())||Fa.setGroup$$module$build$src$core$events$utils(!0),ge(),t instanceof Mf&&t.setResizesEnabled(!1);for(const[,e]of i.reverse()){let n;null==(n=e)||n.clear(t)}for(const[n,r]of i.reverse())if(e[n]){let i;null==(i=r)||i.load(e[n],t)}t instanceof Mf&&t.setResizesEnabled(!0),_e(),Y(new(oe(al.FINISHED_LOADING))(t)),Fa.setGroup$$module$build$src$core$events$utils(n),Fa.setRecordUndo$$module$build$src$core$events$utils(r)}},ta=function(e,t){let n=null;var i;if(n="string"==typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(n)&&document!==(null==(i=n)?void 0:i.ownerDocument))throw Error("Error: container is not in current document");e=new Dp(t||{}),i=document.createElement("div"),ce(i,"injectionDiv"),null!=t&&t.rtl&&ce(i,"blocklyRTL"),n.appendChild(i),t=na(i,e);const r=ia(i,t,e);return ra(r),Ne(r),Me(r),i.addEventListener("focusin",function(){Ne(r)}),g(i,"keydown",null,Ve),r},na=function(e,t){e.setAttribute("dir","LTR"),je(t.hasCss,t.pathToMedia);const n=le(hc.SVG,{xmlns:Ll,"xmlns:html":Pl,"xmlns:xlink":Ml,version:"1.1",class:"blocklySvg"},e),i=le(hc.DEFS,{},n),r=String(Math.random()).substring(2);return t.gridPattern=Hh.createDom(r,t.gridOptions,i,e),n},ia=function(e,t,n){n.parentWorkspace=null;const i=(n=new Mf(n)).options;n.scale=i.zoomOptions.startScale,t.appendChild(n.createDom("blocklyMainBackground",e));var r=n.getRenderer().getClassName();return r&&ce(e,r),(r=n.getTheme().getClassName())&&ce(e,r),!i.hasCategories&&i.languageTree&&(e=n.addFlyout(hc.SVG),fe(e,t)),i.hasTrashcan&&n.addTrashcan(),i.zoomOptions&&i.zoomOptions.controls&&n.addZoomControls(),n.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),n.translate(0,0),n.addChangeListener(Ks(n)),Me(n),ar(),Jn(),Ni(),n},ra=function(e){const t=e.options;var n=e.getParentSvg();if(g(n.parentNode,"contextmenu",null,function(e){b(e)||e.preventDefault()}),n=g(window,"resize",null,function(){Fi(),e.hideComponents(!0),gi(),yr(),Me(e),Ws(e)}),e.setResizeHandlerWrapper(n),sa(),t.languageTree){n=e.getToolbox();const i=e.getFlyout(!0);n?n.init():i&&(i.init(e),i.show(t.languageTree),"function"==typeof i.scrollToStart&&i.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new Rh(e,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.horizontal,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&oa(t.pathToMedia,e)},sa=function(){Rm||(g(document,"scroll",null,function(){const e=Ce();for(let t,n=0;t=e[n];n++)t instanceof Mf&&t.updateInverseScreenCTM()}),_(document,"touchend",null,d),_(document,"touchcancel",null,d)),Rm=!0},oa=function(e,t){function n(){for(;r.length;){const e=r.pop();e&&y(e)}i.preload()}const i=t.getAudioManager();i.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),i.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),i.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const r=[];r.push(g(document,"pointermove",null,n,!0)),r.push(g(document,"touchstart",null,n,!0))},aa=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>e.workspace.getUndoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:Xd.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},la=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>e.workspace.getRedoStack().length>0?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:Xd.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},ca=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?e.workspace.getTopBlocks(!1).length>1?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:Xd.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},ua=function(e,t){function n(t){r--,t.setCollapsed(e),0===r&&Fa.setGroup$$module$build$src$core$events$utils(!1)}let i=0,r=0;Fa.setGroup$$module$build$src$core$events$utils(!0);for(let e=0;e<t.length;e++){let s=t[e];for(;s;)r++,setTimeout(n.bind(null,s),i),s=s.getNextBlock(),i+=10}},da=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(!n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){ua(!0,e.workspace.getTopBlocks(!0))},scopeType:Xd.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},pa=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){ua(!1,e.workspace.getTopBlocks(!0))},scopeType:Xd.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},ha=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let n=0;n<e.length;n++)ha(e[n],t)}},fa=function(e){const t=[];e=e.getTopBlocks(!0);for(let n=0;n<e.length;n++)ha(e[n],t);return t},ma=function(e,t){t?Fa.setGroup$$module$build$src$core$events$utils(t):(Fa.setGroup$$module$build$src$core$events$utils(!0),t=Fa.getGroup$$module$build$src$core$events$utils());const n=e.shift();n&&(n.isDeadOrDying()?ma(e,t):(n.dispose(!1,!0),setTimeout(ma,10,e,t))),Fa.setGroup$$module$build$src$core$events$utils(!1)},ga=function(){Xd.registry.register({displayText:e=>e.workspace?1===(e=fa(e.workspace).length)?Fa.Msg$$module$build$src$core$msg.DELETE_BLOCK:Fa.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`):"",preconditionFn:e=>e.workspace&&fa(e.workspace).length>0?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=fa(e.workspace);t.length<2?ma(t):jt(Fa.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(e){e&&ma(t)})}},scopeType:Xd.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},_a=function(){aa(),la(),ca(),da(),pa(),ga()},ya=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var t=e.block.toCopyData();t&&Bo(t,e.block.workspace)}},scopeType:Xd.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},ba=function(){Xd.registry.register({displayText:e=>e.block.hasIcon(Jh.TYPE)?Fa.Msg$$module$build$src$core$msg.REMOVE_COMMENT:Fa.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(Jh.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:Xd.ScopeType.BLOCK,id:"blockComment",weight:2})},va=function(){Xd.registry.register({displayText:e=>e.block.getInputsInline()?Fa.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:Fa.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof Sm||e.inputList[t]instanceof Sm))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:Xd.ScopeType.BLOCK,id:"blockInline",weight:3})},Ta=function(){Xd.registry.register({displayText:e=>e.block.isCollapsed()?Fa.Msg$$module$build$src$core$msg.EXPAND_BLOCK:Fa.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:Xd.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},ka=function(){Xd.registry.register({displayText:e=>e.block.hasDisabledReason(iu)?Fa.Msg$$module$build$src$core$msg.ENABLE_BLOCK:Fa.Msg$$module$build$src$core$msg.DISABLE_BLOCK,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()){var t=e.getDisabledReasons();return t=t.size>(t.has(iu)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;const t=Fa.getGroup$$module$build$src$core$events$utils();t||Fa.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(iu),iu),Fa.setGroup$$module$build$src$core$events$utils(t)},scopeType:Xd.ScopeType.BLOCK,id:"blockDisable",weight:5})},xa=function(){Xd.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?Fa.Msg$$module$build$src$core$msg.DELETE_BLOCK:Fa.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:Xd.ScopeType.BLOCK,id:"blockDelete",weight:6})},Ea=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:Xd.ScopeType.BLOCK,id:"blockHelp",weight:7})},Sa=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let t;return null!=(t=e.comment)&&t.isDeletable()?"enabled":"hidden"},callback(e){let t;Fa.setGroup$$module$build$src$core$events$utils(!0),null==(t=e.comment)||t.dispose(),Fa.setGroup$$module$build$src$core$events$utils(!1)},scopeType:Xd.ScopeType.COMMENT,id:"commentDelete",weight:6})},Ca=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let t;return null!=(t=e.comment)&&t.isMovable()?"enabled":"hidden"},callback(e){if(e.comment){var t=e.comment.toCopyData();t&&Bo(t,e.comment.workspace)}},scopeType:Xd.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},wa=function(){Xd.registry.register({displayText:()=>Fa.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>{let t;return null!=(t=e.workspace)&&t.isMutator?"hidden":"enabled"},callback:(e,t,n,i)=>{(e=e.workspace)&&(Fa.setGroup$$module$build$src$core$events$utils(!0),(t=new mp(e)).setPlaceholderText(Fa.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),t.moveTo(Ia(new pc(i.x,i.y),e)),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),Fa.setGroup$$module$build$src$core$events$utils(!1))},scopeType:Xd.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},Ia=function(e,t){var n=t.getInjectionDiv().getBoundingClientRect();return e=new pc(e.x-n.left,e.y-n.top),n=t.getOriginOffsetInPixels(),(e=pc.difference(e,n)).scale(1/t.scale),e},Aa=function(){ya(),ba(),va(),Ta(),ka(),xa(),Ea()},Na=function(){Ca(),Sa(),wa()},Da=function(){_a(),Aa()},Oa=function(e){return e&&"function"==typeof e.paste},Ra=function(e){return e&&"function"==typeof e.getSvgRoot},La=function(e){return e.isSelectable()},Pa=function(e){Ae().hideChaff(e)},(Ma=Ma||{}).scope={},Ma.ASSUME_ES5=!1,Ma.ASSUME_ES6=!1,Ma.ASSUME_ES2020=!1,Ma.ASSUME_NO_NATIVE_MAP=!1,Ma.ASSUME_NO_NATIVE_SET=!1,Ma.ISOLATE_POLYFILLS=!1,Ma.FORCE_POLYFILL_PROMISE=!1,Ma.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Ma.INSTRUMENT_ASYNC_CONTEXT=!0,Ma.objectCreate=Ma.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){var t=function(){};return t.prototype=e,new t},Ma.defineProperty=Ma.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},Ma.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof e&&e];for(var n=0;n<t.length;++n){var i=t[n];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},Ma.global=Ma.ASSUME_ES2020?globalThis:Ma.getGlobal(this),Ma.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),Ma.TRUST_ES6_POLYFILLS=!Ma.ISOLATE_POLYFILLS||Ma.IS_SYMBOL_NATIVE,Ma.polyfills={},Ma.propertyToPolyfillSymbol={},Ma.POLYFILL_PREFIX="$jscp$",Ma.polyfill=function(e,t,n,i){t&&(Ma.ISOLATE_POLYFILLS?Ma.polyfillIsolated(e,t,n,i):Ma.polyfillUnisolated(e,t,n,i))},Ma.polyfillUnisolated=function(e,t,n,i){for(n=Ma.global,e=e.split("."),i=0;i<e.length-1;i++){var r=e[i];if(!(r in n))return;n=n[r]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&Ma.defineProperty(n,e,{configurable:!0,writable:!0,value:t})},Ma.polyfillIsolated=function(e,t,n,i){var r=e.split(".");e=1===r.length,i=r[0],i=!e&&i in Ma.polyfills?Ma.polyfills:Ma.global;for(var s=0;s<r.length-1;s++){var o=r[s];if(!(o in i))return;i=i[o]}r=r[r.length-1],null!=(t=t(n=Ma.IS_SYMBOL_NATIVE&&"es6"===n?i[r]:null))&&(e?Ma.defineProperty(Ma.polyfills,r,{configurable:!0,writable:!0,value:t}):t!==n&&(void 0===Ma.propertyToPolyfillSymbol[r]&&(n=1e9*Math.random()>>>0,Ma.propertyToPolyfillSymbol[r]=Ma.IS_SYMBOL_NATIVE?Ma.global.Symbol(r):Ma.POLYFILL_PREFIX+n+"$"+r),Ma.defineProperty(i,Ma.propertyToPolyfillSymbol[r],{configurable:!0,writable:!0,value:t})))},Ma.getConstructImplementation=function(){if(Ma.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(function(){function e(){}return new e,Reflect.construct(e,[],function(){}),new e instanceof e}())return Reflect.construct;var e=Reflect.construct;return function(t,n,i){return t=e(t,n),i&&Reflect.setPrototypeOf(t,i.prototype),t}}return function(e,t,n){return void 0===n&&(n=e),n=Ma.objectCreate(n.prototype||Object.prototype),Function.prototype.apply.call(e,n,t)||n}},Ma.construct=Ma.getConstructImplementation(),Ma.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},Ma.setPrototypeOf=Ma.ASSUME_ES6||Ma.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:Ma.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,Ma.inherits=function(e,t){if(e.prototype=Ma.objectCreate(t.prototype),e.prototype.constructor=e,Ma.ASSUME_ES6||Ma.setPrototypeOf){var n=Ma.setPrototypeOf;n(e,t)}else for(n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.superClass_=t.prototype},Ma.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},Ma.arrayIterator=function(e){return{next:Ma.arrayIteratorImpl(e)}},Ma.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return Ma.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},Ma.arrayFromIterator=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n},Ma.arrayFromIterable=function(e){return e instanceof Array?e:Ma.arrayFromIterator(Ma.makeIterator(e))},Ma.generator={},Ma.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},Ma.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},Ma.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},Ma.generator.Context.prototype.stop_=function(){this.isRunning_=!1},Ma.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},Ma.generator.Context.prototype.next_=function(e){this.yieldResult=e},Ma.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},Ma.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},Ma.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},Ma.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},Ma.generator.Context.prototype.yieldAll=function(e,t){var n=(e=Ma.makeIterator(e)).next();if(Ma.generator.ensureIteratorResultIsObject_(n),!n.done)return this.yieldAllIterator_=e,this.yield(n.value,t);this.yieldResult=n.value,this.nextAddress=t},Ma.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},Ma.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},Ma.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},Ma.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},Ma.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},Ma.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},Ma.generator.Context.prototype.enterFinallyBlock=function(e,t,n){n?this.finallyContexts_[n]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},Ma.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},Ma.generator.Context.prototype.forIn=function(e){return new Ma.generator.Context.PropertyIterator(e)},Ma.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},Ma.generator.Context.PropertyIterator.prototype.getNext=function(){for(;this.properties_.length>0;){var e=this.properties_.pop();if(e in this.object_)return e}return null},Ma.generator.Engine_=function(e){this.context_=new Ma.generator.Context,this.program_=e},Ma.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},Ma.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(e){return{value:e,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},Ma.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},Ma.generator.Engine_.prototype.yieldAllStep_=function(e,t,n){try{var i=e.call(this.context_.yieldAllIterator_,t);if(Ma.generator.ensureIteratorResultIsObject_(i),!i.done)return this.context_.stop_(),i;var r=i.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}return this.context_.yieldAllIterator_=null,n.call(this.context_,r),this.nextStep_()},Ma.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(e){this.context_.yieldResult=void 0,this.context_.throw_(e)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},Ma.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},Ma.generator.createGenerator=function(e,t){return t=new Ma.generator.Generator_(new Ma.generator.Engine_(t)),Ma.setPrototypeOf&&e.prototype&&Ma.setPrototypeOf(t,e.prototype),t},Ma.asyncExecutePromiseGenerator=function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise(function(i,r){!function e(s){s.done?i(s.value):Promise.resolve(s.value).then(t,n).then(e,r)}(e.next())})},Ma.asyncExecutePromiseGeneratorFunction=function(e){return Ma.asyncExecutePromiseGenerator(e())},Ma.asyncExecutePromiseGeneratorProgram=function(e){return Ma.asyncExecutePromiseGenerator(new Ma.generator.Generator_(new Ma.generator.Engine_(e)))},Ma.polyfill("globalThis",function(e){return e||Ma.global},"es_2020","es3"),Ma.polyfill("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length;for((t=t||0)<0&&(t=Math.max(t+i,0));t<i;t++){var r=n[t];if(r===e||Object.is(r,e))return!0}return!1}},"es7","es3"),Ma.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new Ma.global.Proxy(e,{get:function(n,i,r){return n==e&&"q"==i&&r==t}}));return!0===t.q}catch(e){return!1}},Ma.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,Ma.ES6_CONFORMANCE=Ma.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&Ma.checkEs6ConformanceViaProxy(),Ma.initSymbol=function(){},Ma.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},Ma.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Ma.MapEntry=function(){},Ma.polyfill("Set.prototype.difference",function(e){return e||function(e){Ma.checkIsSetInstance(this),Ma.checkIsSetLike(e);var t=Ma.getSmallerAndLargerSets(this,e);e=new Set(this);var n=t.smallerSetIterator;t=t.largerSet;for(var i=n.next();!i.done;)t.has(i.value)&&e.delete(i.value),i=n.next();return e}},"es_next","es6"),Ma.checkIsSetLike=function(e){if("object"!=typeof e||null===e||"number"!=typeof e.size||e.size<0||"function"!=typeof e.keys||"function"!=typeof e.has)throw new TypeError("Argument must be set-like")},Ma.checkIsValidIterator=function(e){if("object"!=typeof e||null===e||"function"!=typeof e.next)throw new TypeError("Invalid iterator.");return e},Ma.getSmallerAndLargerSets=function(e,t){return e.size<=t.size?{smallerSetIterator:e.keys(),largerSet:t}:{smallerSetIterator:Ma.checkIsValidIterator(t.keys()),largerSet:e}},Ma.checkIsSetInstance=function(e){if(!(e instanceof Set))throw new TypeError("Method must be called on an instance of Set.")},Ma.iteratorFromArray=function(e,t){if(Ma.ASSUME_ES6)return e[Symbol.iterator]();e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r},Ma.polyfill("Array.prototype.values",function(e){return e||function(){return Ma.iteratorFromArray(this,function(e,t){return t})}},"es8","es3"),Ma.polyfill("Array.prototype.flatMap",function(e){return e||function(e,t){var n=[];return Array.prototype.forEach.call(this,function(i,r){i=e.call(t,i,r,this),Array.isArray(i)?n.push.apply(n,i):n.push(i)}),n}},"es9","es5"),Ma.polyfill("Array.prototype.flat",function(e){return e||function(e){e=void 0===e?1:e;var t=[];return Array.prototype.forEach.call(this,function(n){Array.isArray(n)&&e>0?(n=Array.prototype.flat.call(n,e-1),t.push.apply(t,n)):t.push(n)}),t}},"es9","es5"),Ma.polyfill("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Ma.owns(e,t)&&n.push([t,e[t]]);return n}},"es8","es3"),Ma.polyfill("Object.values",function(e){return e||function(e){var t,n=[];for(t in e)Ma.owns(e,t)&&n.push(e[t]);return n}},"es8","es3");var Ba=Object.create(null),$a={typeMap:Ba},Ua=Object.create(null),Va="default",Ha=class{constructor(e){this.name=e}toString(){return this.name}};Ha.CONNECTION_CHECKER=new Ha("connectionChecker"),Ha.CONNECTION_PREVIEWER=new Ha("connectionPreviewer"),Ha.CURSOR=new Ha("cursor"),Ha.EVENT=new Ha("event"),Ha.FIELD=new Ha("field"),Ha.INPUT=new Ha("input"),Ha.RENDERER=new Ha("renderer"),Ha.TOOLBOX=new Ha("toolbox"),Ha.THEME=new Ha("theme"),Ha.TOOLBOX_ITEM=new Ha("toolboxItem"),Ha.FLYOUTS_VERTICAL_TOOLBOX=new Ha("flyoutsVerticalToolbox"),Ha.FLYOUTS_HORIZONTAL_TOOLBOX=new Ha("flyoutsHorizontalToolbox"),Ha.FLYOUT_INFLATER=new Ha("flyoutInflater"),Ha.METRICS_MANAGER=new Ha("metricsManager"),Ha.BLOCK_DRAGGER=new Ha("blockDragger"),Ha.SERIALIZER=new Ha("serializer"),Ha.ICON=new Ha("icon"),Ha.PASTER=new Ha("paster"),Ha.VARIABLE_MODEL=new Ha("variableModel"),Ha.VARIABLE_MAP=new Ha("variableMap");var Ga={DEFAULT:Va,TEST_ONLY:$a};Ga.Type=Ha,Ga.getAllItems=l,Ga.getClass=o,Ga.getClassFromOptions=c,Ga.getObject=a,Ga.hasItem=s,Ga.register=t,Ga.unregister=i;var ja,Ka,za,Wa,qa,Ja,Ya,Xa,Za,Qa,el=Object.create(null),tl=750,nl="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),il=null,rl={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},sl=0,ol={TOUCH_ENABLED:nl,TOUCH_MAP:rl};ol.checkTouchIdentifier=m,ol.clearTouchIdentifier=p,ol.getTouchIdentifierFromEvent=f,ol.longStart=u,ol.longStop=d,ol.shouldHandleEvent=h,function(e){function t(e){return n.includes(e.toUpperCase())}const n=(ja=e).toUpperCase();Ka=t("JavaFX"),za=t("WebKit"),Wa=t("Gecko")&&!za,qa=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Ja=t("iPad")||t("Macintosh")&&e>0,Ya=t("iPhone")&&!Ja,Xa=t("Macintosh"),Za=Ja||qa&&!t("Mobile")||t("Silk"),Qa=!Za&&(Ya||qa)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var al,ll,cl=Ka,ul=Wa,dl=qa,pl=Ja,hl=Ya,fl=Xa,ml=Qa,gl={ANDROID:dl,GECKO:ul,IPAD:pl,IPHONE:hl,JavaFx:cl,MAC:fl,MOBILE:ml,raw:ja},_l=40,yl=125,bl={};bl.bind=_,bl.conditionalBind=g,bl.getScrollDeltaPixels=k,bl.isRightButton=v,bl.isTargetInput=b,bl.mouseToSvg=T,bl.unbind=y,(ll=al||(al={})).BLOCK_CREATE="create",ll.BLOCK_DELETE="delete",ll.BLOCK_CHANGE="change",ll.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",ll.BLOCK_MOVE="move",ll.VAR_CREATE="var_create",ll.VAR_DELETE="var_delete",ll.VAR_RENAME="var_rename",ll.VAR_TYPE_CHANGE="var_type_change",ll.UI="ui",ll.BLOCK_DRAG="drag",ll.SELECTED="selected",ll.CLICK="click",ll.MARKER_MOVE="marker_move",ll.BUBBLE_OPEN="bubble_open",ll.TRASHCAN_OPEN="trashcan_open",ll.TOOLBOX_ITEM_SELECT="toolbox_item_select",ll.THEME_CHANGE="theme_change",ll.VIEWPORT_CHANGE="viewport_change",ll.COMMENT_CREATE="comment_create",ll.COMMENT_DELETE="comment_delete",ll.COMMENT_CHANGE="comment_change",ll.COMMENT_MOVE="comment_move",ll.COMMENT_RESIZE="comment_resize",ll.COMMENT_DRAG="comment_drag",ll.COMMENT_COLLAPSE="comment_collapse",ll.FINISHED_LOADING="finished_loading";var vl=[al.BLOCK_CREATE,al.BLOCK_MOVE,al.COMMENT_CREATE,al.COMMENT_MOVE];({BUMP_EVENTS:vl}).EventType=al;var Tl="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",kl={genUid:()=>{const e=[];for(let t=0;t<20;t++)e[t]=Tl.charAt(88*Math.random());return e.join("")}},xl=0,El={TEST_ONLY:kl};El.genUid=E,El.getNextUniqueId=x;var Sl={};Sl.isBlockChange=w,Sl.isBlockCreate=S,Sl.isBlockDelete=C,Sl.isBlockDrag=R,Sl.isBlockFieldIntermediateChange=I,Sl.isBlockMove=A,Sl.isBubbleOpen=M,Sl.isClick=P,Sl.isCommentChange=G,Sl.isCommentCollapse=W,Sl.isCommentCreate=V,Sl.isCommentDelete=H,Sl.isCommentDrag=z,Sl.isCommentMove=j,Sl.isCommentResize=K,Sl.isFinishedLoading=q,Sl.isSelected=L,Sl.isThemeChange=$,Sl.isToolboxItemSelect=B,Sl.isTrashcanOpen=F,Sl.isVarCreate=N,Sl.isVarDelete=D,Sl.isVarRename=O,Sl.isViewportChange=U;var Cl="",wl=!0,Il=0,Al="ORPHANED_BLOCK",Nl=[],Dl={FIRE_QUEUE:Nl,enqueueEvent:Q,fireNow:Z,fireInternal:X,setGroupInternal:ie},Ol={TEST_ONLY:Dl};Ol.clearPendingUndo=te,Ol.disable=Fa.disable$$module$build$src$core$events$utils,Ol.disableOrphans=ae,Ol.enable=Fa.enable$$module$build$src$core$events$utils,Ol.filter=ee,Ol.fire=Y,Ol.fromJson=se,Ol.get=oe,Ol.getDescendantIds=re,Ol.getGroup=Fa.getGroup$$module$build$src$core$events$utils,Ol.getRecordUndo=J,Ol.isEnabled=ne,Ol.setGroup=Fa.setGroup$$module$build$src$core$events$utils,Ol.setRecordUndo=Fa.setRecordUndo$$module$build$src$core$events$utils;var Rl,Ll="http://www.w3.org/2000/svg",Pl="http://www.w3.org/1999/xhtml",Ml="http://www.w3.org/1999/xlink";!function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE"}(Rl||(Rl={}));var Fl=null,Bl=0,$l=null,Ul={HTML_NS:Pl};Ul.NodeType=Rl,Ul.SVG_NS=Ll,Ul.XLINK_NS=Ml,Ul.addClass=ce,Ul.createSvgElement=le,Ul.getFastTextWidth=be,Ul.getFastTextWidthWithSizeString=ve,Ul.getTextWidth=ye,Ul.hasClass=pe,Ul.insertAfter=fe,Ul.measureFontMetrics=Te,Ul.removeClass=de,Ul.removeClasses=ue,Ul.removeNode=he,Ul.setCssTransform=me,Ul.startTextWidthCache=ge,Ul.stopTextWidthCache=_e;var Vl=class{static findFocusedNode(e){var t=e.getRootFocusableNode();if(!t.canBeFocused())return null;var n=t.getFocusableElement();return pe(n,Vl.ACTIVE_CLASS_NAME)||pe(n,Vl.PASSIVE_CSS_CLASS_NAME)||((t=n.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||t instanceof SVGElement)&&(t=Vl.findFocusableNodeFor(t,e))?t:((n=n.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||n instanceof SVGElement)&&(e=Vl.findFocusableNodeFor(n,e))?e:null}static findFocusableNodeFor(e,t){if(!e.id||"null"===e.id||-1!==t.getNestedTrees().map(t=>Vl.findFocusableNodeFor(e,t)).findIndex(e=>!!e))return null;var n,i=t.getRootFocusableNode();return i.canBeFocused()&&e===i.getFocusableElement()||(i=null!=(n=t.lookUpFocusableNode(e.id))?n:null)?i:(n=e.parentElement,!i&&n?Vl.findFocusableNodeFor(n,t):null)}};Vl.ACTIVE_CLASS_NAME="blocklyActiveFocus",Vl.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",Vl.ACTIVE_FOCUS_NODE_CSS_SELECTOR=`.${Vl.ACTIVE_CLASS_NAME}`,Vl.PASSIVE_FOCUS_NODE_CSS_SELECTOR=`.${Vl.PASSIVE_CSS_CLASS_NAME}`;var Hl=class{constructor(e,t){this.tree=e,this.rootShouldBeAutoTabbable=t}},Gl=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;const t=e=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!e;var t=null;if(e instanceof HTMLElement||e instanceof SVGElement)for(var n of this.registeredTrees)if(t=Vl.findFocusableNodeFor(e,n.tree))break;if(t&&t.canBeFocused()){let i;e=t.getFocusableTree(),n=null==(i=this.focusedNode)?void 0:i.getFocusableTree(),t===e.getRootFocusableNode()&&e!==n?this.focusTree(e):this.focusNode(t)}else this.defocusCurrentFocusedNode()}};e("focusin",e=>{e instanceof FocusEvent&&t(document.activeElement)}),e("focusout",e=>{e instanceof FocusEvent&&t(e.relatedTarget)})}registerTree(e,t=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new Hl(e,t));const n=e.getRootFocusableNode().getFocusableElement();if(!n.id||"null"===n.id)throw Error(`Attempting to register a tree with a root element that has an invalid ID: ${e}.`);t&&(n.tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(e){let t;return null!=(t=this.registeredTrees.find(t=>t.tree===e))?t:null}unregisterTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to unregister not registered tree: ${e}.`);var t=this.registeredTrees.findIndex(t=>t.tree===e);const n=this.registeredTrees[t];this.registeredTrees.splice(t,1),t=Vl.findFocusedNode(e);const i=e.getRootFocusableNode();t&&this.removeHighlight(t),this.focusedNode!==t&&this.focusedNode!==i||this.updateFocusedNode(null),this.removeHighlight(i),n.rootShouldBeAutoTabbable&&e.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){let e,t;return null!=(t=null==(e=this.focusedNode)?void 0:e.getFocusableTree())?t:null}getFocusedNode(){return this.focusedNode}focusTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);const t=Vl.findFocusedNode(e),n=e.getRestoredFocusableNode(t);let i;e=e.getRootFocusableNode(),this.focusNode(null!=(i=null!=n?n:t)?i:e)}focusNode(e){this.ensureManagerIsUnlocked();const t=!this.currentlyHoldsEphemeralFocus;t&&(this.isUpdatingFocusedNode=!0);var n,i=(null==(n=this.focusedNode)?void 0:n.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||i)if(e.canBeFocused()){if(n=e.getFocusableTree(),!this.isRegistered(n))throw Error(`Attempted to focus unregistered node: ${e}.`);(i=e.getFocusableElement()).id&&"null"!==i.id||console.warn("Trying to focus a node that has an invalid ID.");var r=Vl.findFocusableNodeFor(i,n);i=Vl.findFocusedNode(n);var s,o=e;r!==e&&(o=n.getRestoredFocusableNode(i),e=n.getRootFocusableNode(),o=null!=(s=null!=o?o:i)?s:e),s=null==(e=this.focusedNode)?void 0:e.getFocusableTree(),e&&this.passivelyFocusNode(e,n),n=n.getRootFocusableNode(),i&&this.removeHighlight(i),n!==o&&this.removeHighlight(n),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(o,null!=s?s:null),this.updateFocusedNode(o)}else console.warn("Trying to focus a node that can't be focused.");t&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error(`Attempted to take ephemeral focus when it's already held, with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus();let t=!1;return()=>{if(t)throw Error(`Attempted to finish ephemeral focus twice for element: ${e}.`);if(t=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);const e=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===e&&this.recentlyLostAllFocus&&this.focusNode(e)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,t){this.lockFocusStateChanges=!0;const n=e.getFocusableTree(),i=e.getFocusableElement();let r;const s=null==(r=this.lookUpRegistration(n))?void 0:r.rootShouldBeAutoTabbable;n!==t&&(n.onTreeFocus(e,t),s&&(n.getRootFocusableNode().getFocusableElement().tabIndex=-1)),e.onNodeFocus(),this.lockFocusStateChanges=!1,s&&e===n.getRootFocusableNode()||i.hasAttribute("tabindex")||(i.tabIndex=-1),this.setNodeToVisualActiveFocus(e),i.focus()}passivelyFocusNode(e,t){this.lockFocusStateChanges=!0;const n=e.getFocusableTree();if(n!==t){let e;n.onTreeBlur(t),null!=(e=this.lookUpRegistration(n))&&e.rootShouldBeAutoTabbable&&(n.getRootFocusableNode().getFocusableElement().tabIndex=0)}e.onNodeBlur(),this.lockFocusStateChanges=!1,n!==t&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){e=e.getFocusableElement(),ce(e,Gl.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),de(e,Gl.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e=e.getFocusableElement(),de(e,Gl.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),ce(e,Gl.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e=e.getFocusableElement(),de(e,Gl.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),de(e,Gl.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return Gl.focusManager||(Gl.focusManager=new Gl(document.addEventListener)),Gl.focusManager}};Gl.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",Gl.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",Gl.focusManager=null;var jl={};jl.FocusManager=Gl,jl.getFocusManager=Fa.getFocusManager$$module$build$src$core$focus_manager;var Kl={};Kl.deepMerge=Ee;var zl=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),null!=(t=e.keyCodes)&&t.length)for(const n of t)this.addKeyMapping(n,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,n){e=`${e}`;const i=this.keyMap.get(e);if(i&&!n)throw Error(`Shortcut named "${t}" collides with shortcuts "${i}"`);i&&n?i.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,n){const i=this.keyMap.get(e);if(!i)return n||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;const r=i.indexOf(t);return r>-1?(i.splice(r,1),0===i.length&&this.keyMap.delete(e),!0):(n||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,n]of this.keyMap)e[t]=n;return e}getRegistry(){const e=Object.create(null);for(const[t,n]of this.shortcuts)e[t]=n;return Ee(Object.create(null),e)}onKeyDown(e,t){var n=this.serializeKeyEvent(t);if(!(n=this.getShortcutNamesByKeyCode(n)))return!1;for(const i of n){let r,s,o,a;if((n=this.shortcuts.get(i))&&(!n.preconditionFn||n.preconditionFn(e,{focusedNode:null!=(r=Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?r:void 0}))&&null!=(o=(s=n).callback)&&o.call(s,e,t,n,{focusedNode:null!=(a=Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?a:void 0}))return!0}return!1}getShortcutNamesByKeyCode(e){let t;return(null==(t=this.keyMap.get(e))?void 0:t.slice())||[]}getKeyCodesByShortcutName(e){const t=[];for(const[n,i]of this.keyMap)i.indexOf(e)>-1&&t.push(n);return t}serializeKeyEvent(e){let t="";for(const n in zl.modifierKeys)e.getModifierState(n)&&(""!==t&&(t+="+"),t+=n);return""!==t&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(const t of e)if(!(t in zl.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let n="";if(t){this.checkModifiers(t);for(const e in zl.modifierKeys)t.includes(zl.modifierKeys[e])&&(""!==n&&(n+="+"),n+=e)}return""!==n&&e?n+="+"+e:e&&(n=`${e}`),n}};zl.registry=new zl,function(e){(e=e.modifierKeys||(e.modifierKeys={}))[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(zl||(zl={}));var Wl,ql,Jl=Object.create(null),Yl=[],Xl={defineBlocksWithJsonArrayInternal:Ue},Zl={TEST_ONLY:Xl};Zl.createBlockDefinitionsFromJsonArray=Fa.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,Zl.defineBlocks=Fa.defineBlocks$$module$build$src$core$common,Zl.defineBlocksWithJsonArray=$e,Zl.draggingConnections=Yl,Zl.fireSelectedEvent=Re,Zl.getAllWorkspaces=Ce,Zl.getBlockTypeCounts=Fe,Zl.getMainWorkspace=Ae,Zl.getParentContainer=Le,Zl.getSelected=De,Zl.getWorkspaceById=Se,Zl.globalShortcutHandler=Ve,Zl.registerWorkspace=we,Zl.setMainWorkspace=Ne,Zl.setParentContainer=Pe,Zl.setSelected=Oe,Zl.svgResize=Me,Zl.unregisterWorkpace=Ie;var Ql,ec=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=Fa.getGroup$$module$build$src$core$events$utils(),this.recordUndo=J()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,n){return n.isBlank=!1,n.group=e.group||"",n.workspaceId=t.id,n}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=Se(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},tc=class extends ec{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=void 0===e,this.workspaceId=e||""}},nc=class extends tc{constructor(e,t,n){null===(t=e?e.workspace.id:t)&&(t=void 0),super(t),this.type=al.CLICK,this.blockId=e?e.id:void 0,this.targetType=n}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new nc)).targetType=e.targetType,t.blockId=e.blockId,t}};!function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"}(Ql||(Ql={})),t(Ha.EVENT,al.CLICK,nc);var ic={};ic.Click=nc,ic.ClickTarget=Ql;var rc={};rc.removeElem=He;var sc=class{constructor(e){this.name=e}toString(){return this.name}};sc.POSITIONABLE=new sc("positionable"),sc.DRAG_TARGET=new sc("drag_target"),sc.DELETE_AREA=new sc("delete_area"),sc.AUTOHIDEABLE=new sc("autohideable");var oc=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const n=e.component.id;var i;if(!t&&this.componentData.has(n))throw Error('Plugin "'+n+'" with capabilities "'+(null==(i=this.componentData.get(n))?void 0:i.capabilities)+'" already added.');for(this.componentData.set(n,e),t=[],i=0;i<e.capabilities.length;i++){const r=String(e.capabilities[i]).toLowerCase();if(t.push(r),this.capabilityToComponentIds.has(r)){let e;null==(e=this.capabilityToComponentIds.get(r))||e.push(n)}else this.capabilityToComponentIds.set(r,[n])}this.componentData.get(n).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let n=0;n<t.capabilities.length;n++){const i=String(t.capabilities[n]).toLowerCase();He(this.capabilityToComponentIds.get(i),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var n,i;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t=`${t}`.toLowerCase(),null==(n=this.componentData.get(e))||n.capabilities.push(t),null==(i=this.capabilityToComponentIds.get(t))||i.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),He(this.componentData.get(e).capabilities,t),He(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){let t;return null==(t=this.componentData.get(e))?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];const n=[];if(t){const t=[];e.forEach(e=>{t.push(this.componentData.get(e))}),t.sort(function(e,t){return e.weight-t.weight}),t.forEach(function(e){n.push(e.component)})}else e.forEach(e=>{n.push(this.componentData.get(e).component)});return n}};oc.Capability=sc,function(e){(e=e.ComponentWeight||(e.ComponentWeight={}))[e.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",e[e.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",e[e.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",e[e.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT"}(oc||(oc={}));var ac=oc.ComponentWeight,lc={};lc.ComponentManager=oc,lc.ComponentWeight=ac;var cc=!1,uc='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',dc={};dc.inject=je,dc.register=Ge;var pc=class{constructor(e,t){this.x=e,this.y=t}clone(){return new pc(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){const n=e.x-t.x;return e=e.y-t.y,Math.sqrt(n*n+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new pc(e.x-t.x,e.y-t.y)}static sum(e,t){return new pc(e.x+t.x,e.y+t.y)}},hc=class{constructor(e){this.tagName=e}toString(){return this.tagName}};hc.ANIMATE=new hc("animate"),hc.CIRCLE=new hc("circle"),hc.CLIPPATH=new hc("clipPath"),hc.DEFS=new hc("defs"),hc.FECOMPOSITE=new hc("feComposite"),hc.FECOMPONENTTRANSFER=new hc("feComponentTransfer"),hc.FEFLOOD=new hc("feFlood"),hc.FEFUNCA=new hc("feFuncA"),hc.FEGAUSSIANBLUR=new hc("feGaussianBlur"),hc.FEPOINTLIGHT=new hc("fePointLight"),hc.FESPECULARLIGHTING=new hc("feSpecularLighting"),hc.FILTER=new hc("filter"),hc.FOREIGNOBJECT=new hc("foreignObject"),hc.G=new hc("g"),hc.IMAGE=new hc("image"),hc.LINE=new hc("line"),hc.PATH=new hc("path"),hc.PATTERN=new hc("pattern"),hc.POLYGON=new hc("polygon"),hc.RECT=new hc("rect"),hc.SVG=new hc("svg"),hc.TEXT=new hc("text"),hc.TSPAN=new hc("tspan");var fc=class{constructor(e,t,n,i){this.top=e,this.bottom=t,this.left=n,this.right=i}static from(e){return new fc(e.y,e.y+e.height,e.x,e.x+e.width)}clone(){return new fc(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new pc(this.left,this.top)}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t||!(!e||!t)&&e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right}static createFromPoint(e,t,n){const i=e.x;return e=e.y,new fc(e,e+n,i,i+t)}},mc=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}static max(e,t){return new mc(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new mc(Math.min(e.width,t.width),Math.min(e.height,t.height))}},gc={getSizeInternal:ze},_c={TEST_ONLY:gc};_c.getBorderBox=Xe,_c.getComputedStyle=qe,_c.getContainerOffsetToScrollInto=Qe,_c.getPageOffset=Je,_c.getSize=Ke,_c.getViewportPageOffset=Ye,_c.scrollIntoContainerView=Ze;var yc=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,bc=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,vc={TEST_ONLY:{XY_REGEX:yc,XY_STYLE_REGEX:bc}};vc.getDocumentScroll=it,vc.getInjectionDivXY=tt,vc.getRelativeXY=et,vc.getViewportBBox=nt,vc.screenToWsCoordinates=rt,vc.wsToScreenCoordinates=st;var Tc=class{constructor(e,t,n,i,r){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new pc(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new pc(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=n||!1,this.margin=void 0!==r?r:Tc.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),i&&(e+=" "+i),this.outerSvg=le(hc.SVG,{class:e}),i=le(hc.G,{},this.outerSvg),this.svgBackground=le(hc.RECT,{class:"blocklyScrollbarBackground"},i),e=Math.floor((Tc.scrollbarThickness-5)/2),this.svgHandle=le(hc.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},i),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),fe(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=g(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=g(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Tc.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),y(this.onMouseDownBarWrapper_),y(this.onMouseDownHandleWrapper_),he(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,me(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){(e||(e=this.workspace.getMetrics()))&&(this.oldHostMetrics&&Tc.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics()))}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=Tc.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=Tc.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-Tc.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var n=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=Tc.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Tc.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var n=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),p(),this.cleanUp(),v(e))e.stopPropagation();else{var t=T(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var n=tt(this.svgHandle);n=this.horizontal?n.x:n.y;var i=this.handlePosition,r=.95*this.handleLength;t<=n?i-=r:t>=n+this.handleLength&&(i+=r),this.setHandlePosition(this.constrainHandlePosition(i)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),v(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=g(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=g(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){p(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(y(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(y(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||void 0===t)&&this.updateMetrics()}setOrigin(e,t){this.origin=new pc(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};Tc.scrollbarThickness=nl?25:15,Tc.DEFAULT_SCROLLBAR_MARGIN=.5;var kc={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},xc={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Ec,DOMParser:Sc,XMLSerializer:Cc}=globalThis;Sc&&(kc=new Sc),Cc&&(xc=new Cc);var wc="https://developers.google.com/blockly/xml",Ic=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Ac={NAME_SPACE:wc};Ac.createElement=Fa.createElement$$module$build$src$core$utils$xml,Ac.createTextNode=Fa.createTextNode$$module$build$src$core$utils$xml,Ac.domToText=at,Ac.injectDependencies=ot,Ac.textToDom=Fa.textToDom$$module$build$src$core$utils$xml;var Nc,Dc="categoryToolbox",Oc="flyoutToolbox";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(Nc||(Nc={}));var Rc,Lc,Pc,Mc={hasCategoriesInternal:ht},Fc={};Fc.Position=Nc,Fc.TEST_ONLY=Mc,Fc.convertFlyoutDefToJsonArray=dt,Fc.convertToolboxDefToJson=ct,Fc.hasCategories=pt,Fc.isCategoryCollapsible=ft,Fc.parseToolboxTree=yt,function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"}(Rc||(Rc={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(Lc||(Lc={})),function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(Pc||(Pc={}));var Bc={};Bc.bumpDirection=Pc,Bc.bumpPositionRect=Tt,Bc.getCornerOppositeToolbox=vt,Bc.getStartPositionRect=bt,Bc.horizontalPosition=Lc,Bc.verticalPosition=Rc;var $c={width:96,height:124,url:"sprites.png"},Uc=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=le(hc.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:oc.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[oc.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&he(this.svgGroup);for(const e of this.boundEvents)y(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new fc(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var n,i=vt(this.workspace,e),r=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(r+=this.LARGE_SPACING+this.HEIGHT),e=bt(i,new mc(this.WIDTH,r),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),i=i.vertical,t=Tt(e,this.MARGIN_VERTICAL,i===Rc.TOP?Pc.DOWN:Pc.UP,t),i===Rc.TOP){var s,o=this.SMALL_SPACING+this.HEIGHT;null==(s=this.zoomInGroup)||s.setAttribute("transform","translate(0, "+o+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(o+this.LARGE_SPACING+this.HEIGHT)+")")}else{let e;s=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==(e=this.zoomInGroup)||e.setAttribute("transform","translate(0, "+s+")"),s=s+this.SMALL_SPACING+this.HEIGHT,null==(o=this.zoomOutGroup)||o.setAttribute("transform","translate(0, "+s+")")}this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=le(hc.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=le(hc.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);le(hc.RECT,{width:32,height:32},t),le(hc.IMAGE,{width:$c.width,height:$c.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(Ml,"xlink:href",this.workspace.options.pathToMedia+$c.url),this.boundEvents.push(g(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=le(hc.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=le(hc.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);le(hc.RECT,{width:32,height:32},t),le(hc.IMAGE,{width:$c.width,height:$c.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(Ml,"xlink:href",this.workspace.options.pathToMedia+$c.url),this.boundEvents.push(g(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),p(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=le(hc.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=le(hc.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);le(hc.RECT,{width:32,height:32},t),le(hc.IMAGE,{width:$c.width,height:$c.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(Ml,"xlink:href",this.workspace.options.pathToMedia+$c.url),this.boundEvents.push(g(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),p(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(oe(al.CLICK))(null,this.workspace.id,"zoom_controls");Y(e)}};Ge("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var Vc={BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25},Hc={};Hc.register=kt,Hc.unregister=xt;var Gc=class{constructor(){this.priority=25}save(e){const t=[];for(const n of e.getTopComments())(e=Et(n,{addCoordinates:!0,saveIds:!0}))&&t.push(e);return t.length?t:null}load(e,t){for(const n of e)St(n,t,{recordUndo:J()})}clear(e){for(const t of e.getTopComments())t.dispose()}};kt("workspaceComments",new Gc);var jc={};jc.WorkspaceCommentSerializer=Gc,jc.append=St,jc.save=Et;var Kc={};Kc.register=Ct,Kc.unregister=wt;var zc=class{paste(e,t,n){let i;e=e.commentState,n&&(e.x=n.x,e.y=n.y),Fa.disable$$module$build$src$core$events$utils();try{i=St(e,t),It(i)}finally{Fa.enable$$module$build$src$core$events$utils()}return i?(ne()&&Y(new(oe(al.COMMENT_CREATE))(i)),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(i),i):null}};zc.TYPE="workspace-comment",Ct(zc.TYPE,new zc),Fa.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250},Fa.config$$module$build$src$core$config;var Wc,qc,Jc="aria-",Yc="role";!function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem",e.SEPARATOR="separator",e.STATUS="status"}(Wc||(Wc={})),function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin",e.LIVE="live",e.HIDDEN="hidden"}(qc||(qc={}));var Xc={};Xc.Role=Wc,Xc.State=qc,Xc.setRole=Nt,Xc.setState=Dt;var Zc=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=x(),this.element=e,e.className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent",this.checkable){var n=document.createElement("div");n.className="blocklyMenuItemCheckbox ",t.appendChild(n)}return n=this.content,"string"==typeof this.content&&(n=document.createTextNode(this.content)),t.appendChild(n),e.appendChild(t),this.roleName&&Nt(e,this.roleName),Dt(e,qc.SELECTED,this.checkable&&this.checked||!1),Dt(e,qc.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?ce(t,"blocklyMenuItemHighlight"):de(t,"blocklyMenuItemHighlight"))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,t){this.actionHandler=e.bind(t)}},Qc=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu",t.tabIndex=0,this.roleName&&Nt(t,this.roleName),this.element=t;for(let e,n=0;e=this.menuItems[n];n++)t.appendChild(e.createDom());return this.pointerMoveHandler=g(t,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=g(t,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=g(t,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=g(t,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=g(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){const e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(y(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(y(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(y(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(y(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(y(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e,t=0;e=this.menuItems[t];t++)e.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){const t=this.getMenuItems();for(let n,i=0;n=t[i];i++)if(n.getElement()===e)return n}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;if(t&&(t.setHighlighted(!1),this.highlightedItem=null),e){e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement();const n=e.getElement();t&&n&&(Ze(n,t),Dt(t,qc.ACTIVEDESCENDANT,e.getId()))}}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e<0?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){let n;e+=t;const i=this.getMenuItems();for(;n=i[e];){if(n.isEnabled()){this.setHighlighted(n);break}e+=t}}handlePointerMove(e){0!==Math.max(Math.abs(e.movementX),Math.abs(e.movementY))&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var t=this.openingCoords;if(this.openingCoords=null,t&&"number"==typeof e.clientX){const n=new pc(e.clientX,e.clientY);if(pc.distance(t,n)<1)return}(t=this.getMenuItem(e.target))&&t.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=Ke(e);return t.height=e.scrollHeight,t}getMenuItems(){return this.menuItems.filter(e=>e instanceof Zc)}},eu=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",Nt(this.element,Wc.SEPARATOR),this.element}dispose(){let e;null==(e=this.element)||e.remove(),this.element=null}},tu="_TEMP_COLLAPSED_INPUT",nu="_TEMP_COLLAPSED_FIELD",iu="MANUALLY_DISABLED",ru={COLLAPSED_FIELD_NAME:nu,COLLAPSED_INPUT_NAME:tu,MANUALLY_DISABLED:iu};!function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"}(Fa.inputTypes$$module$build$src$core$inputs$input_types||(Fa.inputTypes$$module$build$src$core$inputs$input_types={})),Fa.inputTypes$$module$build$src$core$inputs$input_types;var su,ou,au=new Set,lu=new WeakSet,cu=new WeakMap,uu=null,du=null,pu=0,hu={};hu.finishQueuedRenders=Lt,hu.queueRender=Rt,hu.triggerQueuedRenders=Pt,Fa.Msg$$module$build$src$core$msg=Object.create(null),su=function(e){Object.keys(e).forEach(function(t){Fa.Msg$$module$build$src$core$msg[t]=e[t]})},ou={Msg:Fa.Msg$$module$build$src$core$msg,setLocale:su};var fu="blocklyToast",mu="blocklyToastMessage",gu="blocklyToastCloseButton",_u=class{static show(e,t){if(t.oncePerSession&&t.id){if(this.shownIds.has(t.id))return;this.shownIds.add(t.id)}this.hide(e);const n=this.createDom(e,t);requestAnimationFrame(()=>{n.style.bottom="2rem"})}static createDom(e,t){const{message:n,duration:i=5,assertiveness:r=_u.Assertiveness.POLITE}=t,s=document.createElement("div");e.getInjectionDiv().appendChild(s),s.dataset.toastId=t.id,s.className=fu,Nt(s,Wc.STATUS),Dt(s,qc.LIVE,r),(t=s.appendChild(document.createElement("div"))).className=mu,t.innerText=n,(t=s.appendChild(document.createElement("button"))).className=gu,Dt(t,qc.LABEL,Fa.Msg$$module$build$src$core$msg.CLOSE);var o=le(hc.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},t);let a;return Dt(o,qc.HIDDEN,!0),le(hc.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},o),le(hc.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},o),t.addEventListener("click",()=>{s.remove(),e.markFocused()}),t=()=>{a=setTimeout(()=>s.remove(),1e3*i)},o=()=>clearTimeout(a),s.addEventListener("focusin",o),s.addEventListener("focusout",t),s.addEventListener("mouseenter",o),s.addEventListener("mousemove",o),s.addEventListener("mouseleave",t),t(),s}static hide(e,t){(e=e.getInjectionDiv().querySelector(`.${fu}`))instanceof HTMLElement&&(!t||t===e.dataset.toastId)&&e.remove()}};_u.shownIds=new Set,function(e){(e=e.Assertiveness||(e.Assertiveness={})).ASSERTIVE="assertive",e.POLITE="polite"}(_u||(_u={})),Ge(`\n.${fu} {\n  font-size: 1.2rem;\n  position: absolute;\n  bottom: -10rem;\n  right: 2rem;\n  padding: 1rem;\n  color: black;\n  background-color: white;\n  border: 2px solid black;\n  border-radius: 0.4rem;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  gap: 0.8rem;\n  line-height: 1.5;\n  transition: bottom 0.3s ease-out;\n}\n\n.${fu} .${mu} {\n  maxWidth: 18rem;\n}\n\n.${fu} .${gu} {\n  margin: 0;\n  padding: 0.2rem;\n  background-color: transparent;\n  color: black;\n  border: none;\n  cursor: pointer;\n}\n`);var yu=function(e,t){window.alert(e),t&&t()},bu=yu,vu=function(e,t){t(window.confirm(e))},Tu=vu,ku=function(e,t,n){n(window.prompt(e,t))},xu=ku,Eu=_u.show.bind(_u),Su=Eu,Cu={};Cu.alert=Ht,Cu.confirm=jt,Cu.prompt=zt,Cu.setAlert=Gt,Cu.setConfirm=Kt,Cu.setPrompt=Wt,Cu.setToast=Jt,Cu.toast=qt;var wu={};wu.isLegacyProcedureCallBlock=Xt,wu.isLegacyProcedureDefBlock=Yt;var Iu=new Set,Au={};Au.warn=Qt;var Nu="VARIABLE",Du="ijkmnopqrstuvwxyzabcdefgh",Ou={generateUniqueNameInternal:ln},Ru={CATEGORY_NAME:Nu,TEST_ONLY:Ou,VAR_LETTER_OPTIONS:Du};Ru.allDeveloperVariables=Fa.allDeveloperVariables$$module$build$src$core$variables,Ru.allUsedVarModels=Fa.allUsedVarModels$$module$build$src$core$variables,Ru.compareByName=vn,Ru.createVariableButtonHandler=un,Ru.deleteVariable=Fa.deleteVariable$$module$build$src$core$variables,Ru.flyoutCategory=tn,Ru.flyoutCategoryBlocks=on,Ru.generateUniqueName=an,Ru.generateUniqueNameFromOptions=cn,Ru.generateVariableFieldDom=_n,Ru.getAddedVariables=bn,Ru.getOrCreateVariablePackage=Fa.getOrCreateVariablePackage$$module$build$src$core$variables,Ru.getVariable=Fa.getVariable$$module$build$src$core$variables,Ru.getVariableUsesById=Tn,Ru.internalFlyoutCategory=en,Ru.jsonFlyoutCategoryBlocks=rn,Ru.nameUsedWithAnyType=hn,Ru.nameUsedWithConflictingParam=fn,Ru.promptName=dn,Ru.renameVariable=Fa.renameVariable$$module$build$src$core$variables;var Lu=class extends Error{},Pu=class extends Lu{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},Mu=class extends Lu{constructor(e,t,n){super(`The block ${t.toDevString()} is missing a(n) ${e}\nconnection`),this.block=t,this.state=n}},Fu=class extends Lu{constructor(e,t,n,i){super(`The block ${n.toDevString()} could not connect its\n${t} to its parent, because: ${e}`),this.childBlock=n,this.childState=i}},Bu=class extends Lu{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},$u=class extends Lu{constructor(e,t,n){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=n}},Uu={};Uu.BadConnectionCheck=Fu,Uu.DeserializationError=Lu,Uu.MissingBlockType=Pu,Uu.MissingConnection=Mu,Uu.RealChildOfShadow=Bu,Uu.UnregisteredIcon=$u;var Vu=class{constructor(){this.priority=50}save(e){const t=[];for(const n of e.getTopBlocks(!1))(e=kn(n,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const n of e)Dn(n,t,{recordUndo:J()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};kt("blocks",new Vu);var Hu={};Hu.BlockSerializer=Vu,Hu.append=Dn,Hu.appendInternal=On,Hu.save=kn;var Gu=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};Gu.MUTATOR=new Gu("mutator"),Gu.WARNING=new Gu("warning"),Gu.COMMENT=new Gu("comment");var ju=class extends ec{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new ju)).blockId=e.blockId,t}},Ku=class extends ju{constructor(e,t,n,i,r){super(e),this.type=al.BLOCK_CHANGE,e&&(this.element=t,this.name=n||void 0,this.oldValue=i,this.newValue=r)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ku)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,void 0!==e.disabledReason&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const n=t.getIcon(Gu.MUTATOR);switch(n&&Kn(n)&&n.bubbleIsVisible()&&n.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":var i;t.setDisabledReason(!!e,null!=(i=this.disabledReason)?i:iu);break;case"inline":t.setInputsInline(!!e);break;case"mutation":i=Ku.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(Fa.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),Y(new Ku(t,"mutation",null,i,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?$r(e):""}};t(Ha.EVENT,al.BLOCK_CHANGE,Ku);var zu={};zu.clamp=qn,zu.toDegrees=Wn,zu.toRadians=zn;var Wu,qu,Ju,Yu=16,Xu=1,Zu=12,Qu=16,ed=.25,td=null,nd=null,id="",rd="",sd=null,od=null,ad=null,ld=null,cd=null,ud={getBoundsInfo:function(){const e=Je(sd),t=Ke(sd);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,n,i){const r=ud.getBoundsInfo(),s=Ke(Wu);return t+s.height<r.bottom?ai(e,t,r,s):i-s.height>r.top?li(n,i,r,s):t+s.height<document.documentElement.clientHeight?ai(e,t,r,s):i-s.height>document.documentElement.clientTop?li(n,i,r,s):ci(e,r,s)}},dd={ANIMATION_TIME:ed,ARROW_HORIZONTAL_PADDING:Zu,ARROW_SIZE:Yu,BORDER_SIZE:Xu,PADDING_Y:Qu,TEST_ONLY:ud};dd.clearContent=Qn,dd.createDom=Jn,dd.getContentDiv=Zn,dd.getOwner=Xn,dd.getPositionX=ui,dd.hide=hi,dd.hideIfOwner=pi,dd.hideWithoutAnimation=fi,dd.isVisible=di,dd.repositionForWindowResize=gi,dd.setBoundsElement=Yn,dd.setColour=ei,dd.show=oi,dd.showPositionedByBlock=ti,dd.showPositionedByField=ni;var pd={};pd.commonWordPrefix=yi,pd.commonWordSuffix=bi,pd.isNumber=Fa.isNumber$$module$build$src$core$utils$string,pd.shortestStringLength=_i,pd.wrap=Fa.wrap$$module$build$src$core$utils$string;var hd=void 0,fd=!1,md=!1,gd=50,_d=0,yd=0,bd=0,vd=0,Td=null,kd=null,xd=0,Ed=10,Sd=10,Cd=750,wd=5,Id=null,Ad={HOVER_MS:Cd,LIMIT:gd,MARGINS:wd,OFFSET_X:xd,OFFSET_Y:Ed,RADIUS_OK:Sd};Ad.bindMouseEvents=Di,Ad.block=Bi,Ad.createDom=Ni,Ad.dispose=Mi,Ad.getCustomTooltip=Si,Ad.getDiv=wi,Ad.getTooltipOfObject=Ii,Ad.hide=Fi,Ad.isVisible=Ci,Ad.setCustomTooltip=Ei,Ad.unbindMouseEvents=Oi,Ad.unblock=$i;var Nd=.45,Dd=.65,Od={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Rd={};Rd.blend=Zi,Rd.getHsvSaturation=ji,Rd.getHsvValue=zi,Rd.hexToRgb=Yi,Rd.hsvToHex=Xi,Rd.hueToHex=Qi,Rd.names=Od,Rd.parse=qi,Rd.rgbToHex=Ji,Rd.setHsvSaturation=Ki,Rd.setHsvValue=Wi;var Ld={};Ld.checkMessageReferences=ir,Ld.parseBlockColour=rr,Ld.replaceMessageReferences=nr,Ld.tokenizeInterpolation=tr;var Pd=class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,t,n){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new mc(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new mc(0,0),e!==Pd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(nr(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");if(this.sourceBlock_=e,e.id.includes("_field"))throw Error(`Field ID indicator is contained in block ID. This may cause problems with focus: ${e.id}.`);this.id_=`${e.id}_field_${x()}`}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=le(hc.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&ce(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=le(hc.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=le(hc.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");Di(e),this.mouseDownWrapper=g(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(Pd))?e:this.getValue()}loadState(e){this.loadLegacyState(Pd,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=Fa.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),at(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(Fa.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){let e;pi(this),dr(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||he(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(ce(e,"blocklyEditableField"),de(e,"blocklyNonEditableField")):(ce(e,"blocklyNonEditableField"),de(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Pd.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();let n=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),i=t.FIELD_TEXT_HEIGHT,r=0;this.textElement_&&(r=ye(this.textElement_),n+=r),this.isFullBlockField()||(i=Math.max(i,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=i,this.size_.width=n,this.positionTextElement_(e,r),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var n,i=this.getConstants(),r=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(n=this.getSourceBlock())&&n.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(i.FIELD_TEXT_BASELINE_CENTER?r:r-i.FIELD_TEXT_HEIGHT/2+i.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new mc(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new Md;if(this.isFullBlockField()){var n=this.sourceBlock_.getHeightWidth();const i=t.workspace.scale;e=this.getAbsoluteXY_(),t=(n.width+1)*i,n=(n.height+1)*i,ul?(e.x+=1.5*i,e.y+=1.5*i):(e.x-=.5*i,e.y-=.5*i)}else n=this.borderRect_.getBoundingClientRect(),e=Je(this.borderRect_),t=n.width,n=n.height;return new fc(e.y,e.y+n,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+""),e=e.replace(/\s/g,Pd.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+=""),e}getText(){const e=this.getText_();return String(null!==e?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(null!==e){var n=Fa.getGroup$$module$build$src$core$events$utils();n||Fa.setGroup$$module$build$src$core$events$utils(!0);try{const n=this.doClassValidation_(e),l=this.processValidation(e,n,t);if(!(l instanceof Error)){var i,r=null==(i=this.getValidator())?void 0:i.call(this,l),s=this.processValidation(l,r,t);if(!(s instanceof Error)){var o=this.sourceBlock_;if(!o||!o.disposed){var a=this.getValue();a===s?this.doValueUpdate_(s):(this.doValueUpdate_(s),t&&o&&ne()&&Y(new(oe(al.BLOCK_CHANGE))(o,"field",this.name||null,a,s)),this.isDirty_&&this.forceRerender())}}}}finally{Fa.setGroup$$module$build$src$core$events$utils(n)}}}processValidation(e,t,n){return null===t?(this.doValueInvalid_(e,n),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return null==e?null:e}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){const e=this.getClickTarget_();return Ii(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Je(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new Md;const n=t.inputList;for(let i=0;i<t.inputList.length;i++){const t=n[i],r=t.fieldRow;for(let n=0;n<r.length;n++)if(r[n]===this){e=t;break}}return e}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(!this.fieldGroup_)throw Error("This field currently has no representative DOM element.");return this.fieldGroup_}getFocusableTree(){const e=this.getSourceBlock();if(!e)throw new Md;return e.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};Pd.NBSP="",Pd.SKIP_SETUP=Symbol("SKIP_SETUP");var Md=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Fd={};Fd.Field=Pd,Fd.UnattachedFieldError=Md;var Bd,$d=null,Ud=null,Vd=null,Hd="blocklyWidgetDiv",Gd="",jd="",Kd=null,zd={};zd.createDom=ar,zd.getDiv=sr,zd.hide=cr,zd.hideIfOwner=dr,zd.hideIfOwnerIsInWorkspace=pr,zd.isVisible=ur,zd.positionWithAnchor=fr,zd.repositionForWindowResize=yr,zd.show=lr,zd.testOnly_setDiv=or;var Wd=null,qd={},Jd=null,Yd={};Yd.callbackFactory=Fa.callbackFactory$$module$build$src$core$contextmenu,Yd.dispose=wr,Yd.getCurrentBlock=br,Yd.hide=Cr,Yd.setCurrentBlock=vr,Yd.show=Tr;var Xd=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let t;return null!=(t=this.registeredItems.get(e))?t:null}getContextMenuOptions(e,t){const n=[];for(const i of this.registeredItems.values()){if(i.scopeType){if(i.scopeType===Zd.BLOCK&&!e.block)continue;if(i.scopeType===Zd.COMMENT&&!e.comment)continue;if(i.scopeType===Zd.WORKSPACE&&!e.workspace)continue}let r;if(r={scope:e,weight:i.weight},i.separator)r=Object.assign({},r,{separator:!0});else{const n=i.preconditionFn(e,t);if("hidden"===n)continue;const s="function"==typeof i.displayText?i.displayText(e):i.displayText;r=Object.assign({},r,{text:s,callback:i.callback,enabled:"enabled"===n})}n.push(r)}return n.sort(function(e,t){return e.weight-t.weight}),n}};!function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",t.COMMENT="comment",e.registry=new e}(Xd||(Xd={}));var Zd=Xd.ScopeType,Qd={};Qd.ContextMenuRegistry=Xd,Qd.ScopeType=Zd;var ep=50,tp=100,np={BLOCK:ep,BUBBLE:tp},ip=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){let e;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){let e;this.fireDragEndEvent(),this.fireMoveEvent(),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.comment,ep),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){const e=new(oe(al.COMMENT_DRAG))(this.comment,!0);Y(e)}fireDragEndEvent(){const e=new(oe(al.COMMENT_DRAG))(this.comment,!1);Y(e)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(oe(al.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),Y(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},rp=new WeakMap,sp={};sp.move=Nr,sp.start=Ar;var op=class{constructor(e,t,n){this.id=e,this.workspace=t,this.container=n}isVisible(){return this.icon.checkVisibility()}getParentComment(){const e=this.workspace.getCommentById(this.id);if(!e)throw Error(`Comment bar button ${this.id} has no corresponding comment`);return e}getSize(e=!1){var t=this.icon.getBBox();return t=fc.from(t),e&&(e=this.getMargin(),t.left-=e,t.top-=e,t.bottom+=e,t.right+=e),t}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return this.isVisible()}},ap="_collapse_bar_button",lp=class extends op{constructor(e,t,n){super(e,t,n),this.id=e,this.workspace=t,this.container=n,this.icon=le(hc.IMAGE,{class:"blocklyFoldoutIcon",href:`${this.workspace.options.pathToMedia}foldout-icon.svg`,id:`${this.id}${ap}`},this.container),this.bindId=g(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){y(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",`${e}`)}performAction(e){p();const t=this.getParentComment();t.view.bringToFront(),e&&e instanceof PointerEvent&&v(e)?e.stopPropagation():(t.setCollapsed(!t.isCollapsed()),this.workspace.hideChaff(),null==e||e.stopPropagation())}};({COMMENT_COLLAPSE_BAR_BUTTON_FOCUS_IDENTIFIER:ap}).CollapseCommentBarButton=lp;var cp="_comment_textarea_",up=class{constructor(e,t,n){this.workspace=e,this.onFinishEditing=n,this.textChangeListeners=[],this.text="",this.foreignObject=le(hc.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),(e=document.createElementNS(Pl,"body")).setAttribute("xmlns",Pl),e.className="blocklyMinimalBody",this.textArea=document.createElementNS(Pl,"textarea"),this.textArea.setAttribute("tabindex","-1"),ce(this.textArea,"blocklyCommentText"),ce(this.textArea,"blocklyTextarea"),ce(this.textArea,"blocklyText"),e.appendChild(this.textArea),this.foreignObject.appendChild(e),t&&(this.id=t+cp,this.textArea.setAttribute("id",this.id)),g(this.textArea,"change",this,this.onTextChange),g(this.textArea,"pointerdown",this,e=>{e.stopPropagation(),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),p()}),g(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}onTextChange(){const e=this.text;this.text=this.textArea.value;for(let t=this.textChangeListeners.length-1;t>=0;t--)this.textChangeListeners[t](e,this.text)}handleKeyDown(e){("Escape"===e.key||"Enter"===e.key&&(e.ctrlKey||e.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),e.stopPropagation())}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}setPlaceholderText(e){this.textArea.placeholder=e}setEditable(e){e?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(e,t){this.foreignObject.setAttribute("height",""+(e.height-t.height)),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${t.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",""+-e.width)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!!this.id}};({COMMENT_EDITOR_FOCUS_IDENTIFIER:cp}).CommentEditor=up;var dp="_delete_bar_button",pp=class extends op{constructor(e,t,n){super(e,t,n),this.id=e,this.workspace=t,this.container=n,this.icon=le(hc.IMAGE,{class:"blocklyDeleteIcon",href:`${this.workspace.options.pathToMedia}delete-icon.svg`,id:`${this.id}${dp}`},n),this.bindId=g(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){y(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("x","0");const t=this.container.getBBox();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",""+(t.width-this.getSize(!0).getWidth()))}performAction(e){p(),e&&e instanceof PointerEvent&&v(e)?e.stopPropagation():(this.getParentComment().dispose(),null==e||e.stopPropagation(),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}};({COMMENT_DELETE_BAR_BUTTON_FOCUS_IDENTIFIER:dp}).DeleteCommentBarButton=pp;var hp=class{constructor(e,t){let n;this.workspace=e,this.commentId=t,this.collapsed=!1,this.editable=!0,this.location=new pc(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=le(hc.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),({topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot)),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,e),null==(n=e.getLayerManager())||n.append(this,ep),this.size=hp.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new pc(0,0))}createHighlightRect(e){return le(hc.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e){e=le(hc.G,{class:"blocklyCommentTopbar"},e);const t=le(hc.RECT,{class:"blocklyCommentTopbarBackground"},e),n=new pp(this.commentId,this.workspace,e),i=new lp(this.commentId,this.workspace,e),r=le(hc.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),s=document.createTextNode("");return r.appendChild(s),{topBarGroup:e,topBarBackground:t,deleteButton:n,foldoutButton:i,textPreview:r,textPreviewNode:s}}createTextArea(){const e=new up(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(e.getDom()),e.addTextChangeListener((e,t)=>{this.updateTextPreview(t),this.setSize(this.size)}),e}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(e,t){return e=le(hc.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),g(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){const t=this.topBarBackground.getBBox(),n=this.textPreview.getBBox(),i=this.resizeHandle.getBBox();this.size=e=mc.max(e,this.calcMinSize(t)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.commentEditor.updateSize(e,t),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(e,t,n),this.updateResizeHandlePosition(e,i)}setSize(e){const t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e){var t;this.updateTextPreview(null!=(t=this.commentEditor.getText())?t:"");let n=t=ye(this.textPreview);return this.foldoutButton.isVisible()?n+=this.foldoutButton.getSize(!0).getWidth():t&&(n+=4),this.deleteButton.isVisible()?n+=this.deleteButton.getSize(!0).getWidth():t&&(n+=4),new mc(n,e.height+20)}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",""+-e.width)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextPreviewSize(e,t,n){t=(t.height-n.height)/2;const i=this.foldoutButton.getSize(!0),r=this.deleteButton.getSize(!0);e=e.width-i.getWidth()-r.getWidth(),this.textPreview.setAttribute("x",`${i.getWidth()}`),this.textPreview.setAttribute("y",`${t+n.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",""+(e.height-t.height)),this.resizeHandle.setAttribute("x",""+(e.width-t.width))}onSizeChange(e,t){for(let n=this.sizeChangeListeners.length-1;n>=0;n--)this.sizeChangeListeners[n](e,t)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),v(e)||(this.preResizeSize=this.getSize(),Ar(this.workspace,e,new pc(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=g(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=g(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){p(),this.resizePointerUpListener&&(y(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(y(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=Nr(this.workspace,e),this.setSizeWithoutFiringEvents(new mc(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?ce(this.svgRoot,"blocklyCollapsed"):de(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;e>=0;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(ce(this.svgRoot,"blocklyEditable"),de(this.svgRoot,"blocklyReadonly")):(de(this.svgRoot,"blocklyEditable"),ce(this.svgRoot,"blocklyReadonly")),this.commentEditor.setEditable(e)}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.commentEditor.getText()}setText(e){this.commentEditor.setText(e)}setPlaceholderText(e){this.commentEditor.setPlaceholderText(e)}addTextChangeListener(e){this.commentEditor.addTextChangeListener(e)}removeTextChangeListener(e){this.commentEditor.removeTextChangeListener(e)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return e.length>=12?`${e.substring(0,9)}...`:e}bringToFront(){const e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){p(),v(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,this.foldoutButton.dispose(),this.deleteButton.dispose(),he(this.svgRoot);for(let e=this.disposeListeners.length-1;e>=0;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}};hp.defaultCommentSize=new mc(120,100),Ge("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklyCommentText.blocklyActiveFocus {\n  border-color: #fc3;\n  border-width: 2px;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n");var fp=class{constructor(e,t){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new pc(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:E(),this.size=hp.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){ne()&&Y(new(oe(al.COMMENT_CREATE))(this))}fireDeleteEvent(){ne()&&Y(new(oe(al.COMMENT_DELETE))(this))}fireChangeEvent(e,t){ne()&&Y(new(oe(al.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){ne()&&Y(new(oe(al.COMMENT_COLLAPSE))(this,e))}setText(e){const t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){const t=new(oe(al.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),Y(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(e,t){const n=new(oe(al.COMMENT_MOVE))(this);t&&n.setReason(t),this.location=e,n.recordNew(),Y(n)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},mp=class extends fp{constructor(e,t){super(e,t),this.dragStrategy=new ip(this),this.workspace=e,this.view=new hp(e,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),g(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),g(this.view.getSvgRoot(),"wheel",this,e=>{e.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>{super.setText(t)}),this.view.addSizeChangeListener((e,t)=>{super.setSize(t)}),this.view.addOnCollapseListener(()=>{super.setCollapsed(this.view.isCollapsed())}),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY();var t,n;const i=null!=(n=null==(t=this.view)?void 0:t.getSize())?n:this.getSize();return this.workspace.RTL?(t=e.x-i.width,n=e.x):(t=e.x,n=e.x+i.width),new fc(e.y,e.y+i.height,t,n)}moveBy(e,t,n){const i=this.getRelativeToSurfaceXY();e=new pc(i.x+e,i.y+t),this.moveTo(e,n)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?ce(this.getSvgRoot(),"blocklyDragging"):de(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;const e=Fa.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){const t=this.workspace.getGesture(e);t&&(t.handleCommentStart(e,this),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){e?ce(this.getSvgRoot(),"blocklyDraggingDelete"):de(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){ce(this.getSvgRoot(),"blocklySelected"),Re(this)}unselect(){de(this.getSvgRoot(),"blocklySelected"),Re(null)}toCopyData(){return{paster:zc.TYPE,commentState:Et(this,{addCoordinates:!0})}}showContextMenu(e){const t=Xd.registry.getContextMenuOptions({comment:this,focusedNode:this},e);let n;n=e instanceof PointerEvent?new pc(e.clientX,e.clientY):st(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10),Tr(e,t,this.workspace.RTL,this.workspace,n)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){let e;this.select(),null==(e=this.workspace.getLayerManager())||e.append(this,ep)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},gp={};gp.appendDomToWorkspace=Gr,gp.blockToDom=Fr,gp.blockToDomWithXY=Lr,gp.clearWorkspaceAndLoadFromXml=Vr,gp.deleteNext=ns,gp.domToBlock=Fa.domToBlock$$module$build$src$core$xml,gp.domToBlockInternal=jr,gp.domToPrettyText=Ur,gp.domToText=$r,gp.domToVariables=Kr,gp.domToWorkspace=Fa.domToWorkspace$$module$build$src$core$xml,gp.loadWorkspaceComment=Hr,gp.saveWorkspaceComment=Or,gp.variablesToDom=Rr,gp.workspaceToDom=Dr;var _p=class extends ju{constructor(e){super(e),this.type=al.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Lr(e),this.ids=re(e),this.json=kn(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=$r(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new _p)).xml=Fa.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!yp(t,this.ids))if(e)Dn(this.json,t);else for(e=0;e<this.ids.length;e++){const n=this.ids[e],i=t.getBlockById(n);i?i.dispose(!1):n===this.blockId&&console.warn("Can't uncreate non-existent block: "+n)}}},yp=function(e,t){return t.map(t=>e.getBlockById(t)).filter(e=>e&&e.isShadow()).length===t.length};t(Ha.EVENT,al.BLOCK_CREATE,_p);var bp=class extends tc{constructor(e,t){super(t),this.type=al.THEME_CHANGE,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new bp)).themeName=e.themeName,t}};t(Ha.EVENT,al.THEME_CHANGE,bp);var vp,Tp=class extends tc{constructor(e,t,n,i,r){super(i),this.type=al.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=n,this.oldScale=r}toJson(){const e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Tp)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};t(Ha.EVENT,al.VIEWPORT_CHANGE,Tp),function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"}(vp||(vp={}));var kp=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const n=this.calculateIndexForYPos(t);if(n>=this.connections.length)return-1;t=e.y;let i=n;for(;i>=0&&this.connections[i].y===t;){if(this.connections[i]===e)return i;i--}for(i=n;i<this.connections.length&&this.connections[i].y===t;){if(this.connections[i]===e)return i;i++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,n=this.connections.length;for(;t<n;){const i=Math.floor((t+n)/2);if(this.connections[i].y<e)t=i+1;else{if(!(this.connections[i].y>e)){t=i;break}n=i}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function n(e){const n=r-i[e].x,o=s-i[e].y;return Math.sqrt(n*n+o*o)<=t&&l.push(i[e]),o<t}const i=this.connections,r=e.x,s=e.y;e=0;let o=i.length-2,a=o;for(;e<a;)i[a].y<s?e=a:o=a,a=Math.floor((e+o)/2);const l=[];if(o=e=a,i.length){for(;e>=0&&n(e);)e--;do{o++}while(o<i.length&&n(o))}return l}isInYRange(e,t,n){return Math.abs(this.connections[e].y-t)<=n}searchForClosest(e,t,n){if(!this.connections.length)return{connection:null,radius:t};const i=e.y,r=e.x;e.x=r+n.x,e.y=i+n.y;var s=this.calculateIndexForYPos(e.y);n=null;let o,a=t,l=s-1;for(;l>=0&&this.isInYRange(l,e.y,t);)o=this.connections[l],this.connectionChecker.canConnect(e,o,!0,a)&&(n=o,a=o.distanceFrom(e)),l--;for(;s<this.connections.length&&this.isInYRange(s,e.y,t);)o=this.connections[s],this.connectionChecker.canConnect(e,o,!0,a)&&(n=o,a=o.distanceFrom(e)),s++;return e.x=r,e.y=i,{connection:n,radius:a}}static init(e){const t=[];return t[vp.INPUT_VALUE]=new kp(e),t[vp.OUTPUT_VALUE]=new kp(e),t[vp.NEXT_STATEMENT]=new kp(e),t[vp.PREVIOUS_STATEMENT]=new kp(e),t}},xp=class extends tc{constructor(e,t,n){super(n),this.type=al.SELECTED,this.oldElementId=null!=e?e:void 0,this.newElementId=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new xp)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};t(Ha.EVENT,al.SELECTED,xp);var Ep=class extends ju{constructor(e){if(super(e),this.type=al.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Lr(e),this.ids=re(e),this.wasShadow=e.isShadow(),this.oldJson=kn(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=$r(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ep)).oldXml=Fa.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const n=this.ids[e],i=t.getBlockById(n);i?i.dispose(!1):n===this.blockId&&console.warn("Can't delete non-existent block: "+n)}else Dn(this.oldJson,t)}};t(Ha.EVENT,al.BLOCK_DELETE,Ep);var Sp={fromJsonInternal:os},Cp={TEST_ONLY:Sp};Cp.fromJson=Fa.fromJson$$module$build$src$core$field_registry,Cp.register=rs,Cp.unregister=ss;var wp=class extends Pd{constructor(e,t,n){super(Pd.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==Pd.SKIP_SETUP&&(this.setOptions(e),n&&this.configure_(n),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(wp,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=le(hc.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&ce(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(ce(this.fieldGroup_,"blocklyField"),ce(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){let e,t;this.arrow=le(hc.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?wp.ARROW_CHAR+" ":" "+wp.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),null!=(t=this.getSourceBlock())&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=le(hc.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(Ml,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new Md;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&"number"==typeof e.clientX?new pc(e.clientX,e.clientY):null,Qn(),e=this.menu_.render(Zn()),ce(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),e=this.sourceBlock_.getColourTertiary(),ei(t,e)),ni(this,this.dropdownDispose_.bind(this)),Zn().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new Md;const t=new Qc;t.setRole(Wc.LISTBOX),this.menu_=t;const n=this.getOptions(!1);this.selectedMenuItem=null;for(let r=0;r<n.length;r++){var i=n[r];if(i===wp.SEPARATOR){t.addChild(new eu);continue}const[s,o]=i;as(s)?((i=new Image(s.width,s.height)).src=s.src,i.alt=s.alt):i=s,(i=new Zc(i,o)).setRole(Wc.OPTION),i.setRightToLeft(e.RTL),i.setCheckable(!0),t.addChild(i),i.setChecked(o===this.value_),o===this.value_&&(this.selectedMenuItem=i),i.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){pi(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions)}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(e){return this.getOptions(!0).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t,n=0;t=e[n];n++)t[1]===this.value_&&(this.selectedOption=t)}applyColour(){const e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.menu_?this.borderRect_.setAttribute("fill",e.getColourTertiary()):this.borderRect_.setAttribute("fill","transparent")),e&&this.arrow&&(e.isShadow()?this.arrow.style.fill=e.getColourSecondary():this.arrow.style.fill=e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];as(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new Md;this.imageElement.style.display="",this.imageElement.setAttributeNS(Ml,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const n=Number(e.height);e=Number(e.width);var i=!!this.borderRect_;const r=Math.max(i?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+wp.IMAGE_Y_PADDING);let s;i=i?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,s=this.svgArrow?this.positionSVGArrow(e+i,r/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):ye(this.arrow),this.size_.width=e+s+2*i,this.size_.height=r;let o=0;t.RTL?this.imageElement.setAttribute("x",`${i+s}`):(o=e+s,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${i}`)),this.imageElement.setAttribute("y",String(r/2-n/2)),this.positionTextElement_(o+i,e+s)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();ce(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const n=ye(this.getTextElement());t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let i=0;this.svgArrow&&(i=this.positionSVGArrow(n+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=n+i+2*t,this.size_.height=e,this.positionTextElement_(t,n)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const n=this.getSourceBlock();if(!n)throw new Md;const i=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,r=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,s=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(n.RTL?i:e+r)+","+t+")"),s+r}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];if(as(e))return e.alt;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement){let t,n;return null!=(n=null!=(t=e.title)?t:e.ariaLabel)?n:e.innerText}return"string"==typeof e?e:(console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar."),null)}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let t=!1;const n=e.map(e=>{if(e===wp.SEPARATOR)return e;const[n,i]=e;return"string"==typeof n?[nr(n),i]:(t=!0,[as(n)?Object.assign({},n,{alt:nr(n.alt)}):Object.assign({},n),i])});if(t||e.length<2)return{options:n};var i=n.map(([e])=>e),r=_i(i);e=yi(i,r);const s=bi(i,r);return!e&&!s||r<=e+s?{options:n}:(r=e?i[0].substring(0,e-1):void 0,i=s?i[0].substr(1-s):void 0,{options:this.applyTrim(n,e,s),prefix:r,suffix:i})}applyTrim(e,t,n){return e.map(([e,i])=>[e.substring(t,e.length-n),i])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)||i===wp.SEPARATOR?"string"!=typeof i[1]?(t=!0,console.error(`Invalid option[${n}]: Each FieldDropdown option id must be a string. \n          Found ${i[1]} in: ${i}`)):!i[0]||"string"==typeof i[0]||as(i[0])||"undefined"!=typeof HTMLElement&&i[0]instanceof HTMLElement||(t=!0,console.error(`Invalid option[${n}]: Each FieldDropdown option must have a string \n          label, image description, or HTML element. Found ${i[0]} in: ${i}`)):(t=!0,console.error(`Invalid option[${n}]: Each FieldDropdown option must be an array or\n          the string literal 'separator'. Found: ${i}`))}if(t)throw TypeError("Found invalid FieldDropdown options.")}};wp.SEPARATOR="separator",wp.ARROW_CHAR="",wp.IMAGE_Y_OFFSET=5,wp.IMAGE_Y_PADDING=2*wp.IMAGE_Y_OFFSET,rs("field_dropdown",wp);var Ip,Ap=class{constructor(e,n,i,r){this.name=e,this.startHats=!1,this.blockStyles=n||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=r||Object.create(null),this.fontStyle=Object.create(null),t(Ha.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){const t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const n=new Ap(e);let i=t.base;if(i){if("string"==typeof i){let e;i=null!=(e=a(Ha.THEME,i))?e:void 0}i instanceof Ap&&(Ee(n,i),n.name=e)}return Ee(n.blockStyles,t.blockStyles),Ee(n.categoryStyles,t.categoryStyles),Ee(n.componentStyles,t.componentStyles),Ee(n.fontStyle,t.fontStyle),null!==t.startHats&&(n.startHats=t.startHats),n}},Np=new Ap("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Dp=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,n=!1;var i=!1,r=!1,s=!1,o=!1,a=!1;const l=!!e.readOnly;var c;l||(t=ct(null!=(c=e.toolbox)?c:null),n=pt(t),i=void 0===(i=e.trashcan)?n:i,r=void 0===(r=e.collapse)?n:r,s=void 0===(s=e.comments)?n:s,o=void 0===(o=e.disable)?n:o,a=void 0===(a=e.sounds)||a),c=e.maxTrashcanContents,i?void 0===c&&(c=32):c=0;const u=!!e.rtl;let d=e.horizontalLayout;void 0===d&&(d=!1);var p="end"!==e.toolboxPosition;p=d?p?Nc.TOP:Nc.BOTTOM:p===u?Nc.RIGHT:Nc.LEFT;let h=e.css;void 0===h&&(h=!0);let f="https://blockly-demo.appspot.com/static/media/";e.media&&(f=e.media.endsWith("/")?e.media:e.media+"/");const m=e.oneBasedIndex,g=e.renderer||"geras",_=e.plugins||{};let y,b,v,T=e.modalInputs;void 0===T&&(T=!0),this.RTL=u,this.oneBasedIndex=void 0===m||m,this.collapse=r,this.comments=s,this.disable=o,this.readOnly=l,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(y=e.maxInstances)?y:null,this.modalInputs=T,this.pathToMedia=f,this.hasCategories=n,this.moveOptions=Dp.parseMoveOptions(e,n),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=i,this.maxTrashcanContents=c,this.hasSounds=a,this.hasCss=h,this.horizontalLayout=d,this.languageTree=t,this.gridOptions=Dp.parseGridOptions(e),this.zoomOptions=Dp.parseZoomOptions(e),this.toolboxPosition=p,this.theme=Dp.parseThemeOptions(e),this.renderer=g,this.rendererOverrides=null!=(b=e.rendererOverrides)?b:null,this.parentWorkspace=null!=(v=e.parentWorkspace)?v:null,this.plugins=_}static parseMoveOptions(e,t){const n=e.move||{},i={};return void 0===n.scrollbars&&void 0===e.scrollbars?i.scrollbars=t:"object"==typeof n.scrollbars?(i.scrollbars={horizontal:!!n.scrollbars.horizontal,vertical:!!n.scrollbars.vertical},i.scrollbars.horizontal&&i.scrollbars.vertical?i.scrollbars=!0:i.scrollbars.horizontal||i.scrollbars.vertical||(i.scrollbars=!1)):i.scrollbars=!!n.scrollbars||!!e.scrollbars,i.wheel=i.scrollbars&&void 0!==n.wheel?!!n.wheel:"object"==typeof i.scrollbars,i.drag=!(!i.scrollbars||void 0!==n.drag&&!n.drag),i}static parseZoomOptions(e){e=e.zoom||{};const t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=t.spacing>0&&!!e.snap,t}static parseThemeOptions(e){return"string"==typeof(e=e.theme||Np)?a(Ha.THEME,e):e instanceof Ap?e:Ap.defineTheme(e.name||"builtin"+x(),e)}},Op=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null}isMovable(){return!0}startDrag(){let e;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){let e;this.workspace.setResizesEnabled(!0),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,tp),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},Rp=class{constructor(e,t,n,i){this.workspace=e,this.anchor=t,this.ownerRect=n,this.size=new mc(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Op(this,this.workspace),this.id=x(),this.svgRoot=le(hc.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=le(hc.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=le(hc.PATH,{class:"blocklyBubbleTail"},e),this.background=le(hc.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Ip.BORDER_WIDTH,ry:Ip.BORDER_WIDTH},e),this.contentContainer=le(hc.G,{},this.svgRoot),this.focusableElement=null!=i?i:this.svgRoot,this.focusableElement.setAttribute("id",this.id),g(this.background,"pointerdown",this,this.onMouseDown)}dispose(){he(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,Ip.MIN_SIZE),e.height=Math.max(e.height,Ip.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;null==(t=this.workspace.getGesture(e))||t.handleBubbleStart(e,this),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new fc(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft(t),i=this.getOptimalRelativeTop(t);const r={x:n,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},s={x:-this.size.width-30,y:i};i={x:e.getWidth(),y:i};var o={x:n,y:e.getHeight()};n=e.getWidth()<e.getHeight()?i:o,e=e.getWidth()<e.getHeight()?o:i,i=this.getOverlap(r,t),o=this.getOverlap(s,t);const a=this.getOverlap(n,t);t=this.getOverlap(e,t),i===(t=Math.max(i,o,a,t))?(this.relativeLeft=r.x,this.relativeTop=r.y):o===t?(this.relativeLeft=s.x,this.relativeTop=s.y):a===t?(this.relativeLeft=n.x,this.relativeTop=n.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var n=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(n+this.size.width,t.left+t.width)-Math.max(n,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var n=this.anchor.x-t;n-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):n>e.right&&(t=-(e.right-this.anchor.x))}else{const i=(n=t+this.anchor.x)+this.size.width;n<e.left?t=e.left-this.anchor.x:i>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const n=this.anchor.y+t,i=n+this.size.height;return n<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:i>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let n=e.top+e.height,i=e.left;return e=e.left+e.width,n-=this.getScrollbarThickness(),this.workspace.RTL?i-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new fc(t,n,i,e)}getScrollbarThickness(){return Tc.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,n=this.size.height/2,i=-this.relativeLeft,r=-this.relativeTop;if(t===i&&n===r)e.push("M "+t+","+n);else{r-=n,i-=t,this.workspace.RTL&&(i*=-1);var s=Math.sqrt(r*r+i*i),o=Math.acos(i/s);r<0&&(o=2*Math.PI-o);var a=o+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a);const c=Math.cos(a);let u=(this.size.width+this.size.height)/Ip.TAIL_THICKNESS;u=Math.min(u,this.size.width,this.size.height)/4,i=t+(a=1-Ip.ANCHOR_RADIUS/s)*i,r=n+a*r,a=t+u*c;const d=n+u*l;t-=u*c,n-=u*l,(l=o+(l=zn(this.workspace.RTL?-Ip.TAIL_ANGLE:Ip.TAIL_ANGLE)))>2*Math.PI&&(l-=2*Math.PI),o=Math.sin(l)*s/Ip.TAIL_BEND,s=Math.cos(l)*s/Ip.TAIL_BEND,e.push("M"+a+","+d),e.push("C"+(a+s)+","+(d+o)+" "+i+","+r+" "+i+","+r),e.push("C"+i+","+r+" "+(t+s)+","+(n+o)+" "+t+","+n)}let c;e.push("z"),null==(c=this.tail)||c.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==t?void 0:t.lastChild)===this.svgRoot||(null==t||t.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new pc(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){Re(this)}unselect(){Re(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};Ip=Rp,Rp.BORDER_WIDTH=6,Rp.DOUBLE_BORDER=2*Ip.BORDER_WIDTH,Rp.MIN_SIZE=Ip.DOUBLE_BORDER,Rp.TAIL_THICKNESS=1,Rp.TAIL_ANGLE=20,Rp.TAIL_BEND=4,Rp.ANCHOR_RADIUS=8;var Lp=class extends Rp{constructor(e,t,n,i){let r,s;super(t,n,i),this.workspace=t,this.anchor=n,this.ownerRect=i,this.autoLayout=!0,t=new Dp(e),this.validateWorkspaceOptions(t),this.svgDialog=le(hc.SVG,{x:Rp.BORDER_WIDTH,y:Rp.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Dp(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(hc.G),this.miniWorkspace.getCanvas()),null==(e=this.miniWorkspace.getFlyout())||e.init(this.miniWorkspace),null==e||e.show(t.languageTree)),ce(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(r=this.miniWorkspace.getFlyout())||null==(s=r.getWorkspace())||s.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(t.y<20&&e.moveBy(0,20-t.y),e.RTL){let n=-20;const i=this.miniWorkspace.getFlyout();i&&(n-=i.getWidth()),t.x>n&&e.moveBy(n-t.x,0)}else t.x<20&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress){this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress);var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<Lp.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<Lp.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new mc(t.width+Rp.DOUBLE_BORDER,t.height+Rp.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+Lp.MARGIN;e=e.height+Lp.MARGIN;const n=this.miniWorkspace.getFlyout();if(n){const i=n.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,i.height+20),t+=n.getWidth()}return new mc(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(const t of e.getAllBlocks(!1))t.setStyle(t.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};Lp.MINIMUM_VIEW_CHANGE=10,Lp.MARGIN=3*Rp.DOUBLE_BORDER;var Pp=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new pc(0,0),this.workspaceLocation=new pc(0,0),this.svgRoot=null,this.tooltip=e,this.id=x()}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=le(hc.G,{class:"blocklyIconGroup",id:this.id}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),g(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,Di(this.svgRoot)}}dispose(){Oi(this.svgRoot),he(this.svgRoot)}getWeight(){return-1}getSize(){return new mc(0,0)}setTooltip(e){this.tooltip=null!=e?e:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",Kn(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=pc.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){const e=this.svgRoot;if(!e)throw Error("Attempting to focus uninitialized icon.");return e}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}};Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Pp{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),le(hc.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),le(hc.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),le(hc.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),ce(this.svgRoot,"blocklyMutatorIcon"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new mc(17,17)}applyColour(){let e,t;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.getColour()),null==(t=this.miniWorkspaceBubble)||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.miniWorkspaceBubble)||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){const t=this;return(0,Ma.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Lt(),e){let e;t.miniWorkspaceBubble=new Lp(t.getMiniWorkspaceConfig(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour(),t.createRootBlock(),t.addSaveConnectionsListener(),null==(e=t.miniWorkspaceBubble)||e.addWorkspaceChangeListener(t.createMiniWorkspaceChangeListener())}else{let e;null==(e=t.miniWorkspaceBubble)||e.dispose(),t.miniWorkspaceBubble=null,t.saveConnectionsListener&&t.sourceBlock.workspace.removeChangeListener(t.saveConnectionsListener),t.saveConnectionsListener=null}Y(new(oe(al.BUBBLE_OPEN))(t.sourceBlock,e,"mutator"))}})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(e=>({kind:"block",type:e}))}),t}getAnchorLocation(){return pc.sum(this.workspaceLocation,new pc(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new fc(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();let t,n,i,r;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(r=null==(t=this.miniWorkspaceBubble)||null==(n=t.getWorkspace())||null==(i=n.getFlyout())?void 0:i.getWidth())?r:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||S(e)||w(e)&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=Fa.getGroup$$module$build$src$core$events$utils();e||Fa.setGroup$$module$build$src$core$events$utils(!0);var t=Ku.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var n=Ku.getExtraBlockState_(this.sourceBlock);t!==n&&Y(new(oe(al.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,n)),Fa.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}},Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Gu.MUTATOR,Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Mp=Object.create(null),Fp={allExtensions:Mp};Fa.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Ts);var Bp,$p={TEST_ONLY:Fp};$p.apply=us,$p.buildTooltipForDropdown=Fa.buildTooltipForDropdown$$module$build$src$core$extensions,$p.buildTooltipWithFieldText=Fa.buildTooltipWithFieldText$$module$build$src$core$extensions,$p.isRegistered=cs,$p.register=Fa.register$$module$build$src$core$extensions,$p.registerMixin=Fa.registerMixin$$module$build$src$core$extensions,$p.registerMutator=Fa.registerMutator$$module$build$src$core$extensions,$p.runAfterPageLoad=bs,$p.unregister=ls,function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"}(Bp||(Bp={}));var Up={};Up.arc=As,Up.curve=xs,Up.line=ws,Up.lineOnAxis=Is,Up.lineTo=Cs,Up.moveBy=Ss,Up.moveTo=Es,Up.point=ks;var Vp={};Vp.Coordinate=pc,Vp.KeyCodes=Bp,Vp.Rect=fc,Vp.Size=mc,Vp.Svg=hc,Vp.aria=Xc,Vp.array=rc,Vp.browserEvents=bl,Vp.colour=Rd,Vp.deprecation=Au,Vp.dom=Ul,Vp.extensions=$p,Vp.idGenerator=El,Vp.math=zu,Vp.object=Kl,Vp.parsing=Ld,Vp.string=pd,Vp.style=_c,Vp.svgMath=vc,Vp.svgPaths=Up,Vp.toolbox=Fc,Vp.userAgent=gl,Vp.xml=Ac;var Hp=class{constructor(e,t){if(this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e,e.id.includes("_connection"))throw Error(`Connection ID indicator is contained in block ID. This will cause problems with focus: ${e.id}.`);this.id=`${e.id}_connection_${x()}`}connect_(e){const t=vp.INPUT_VALUE,n=this.getSourceBlock();var i=e.getSourceBlock();let r,s;if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){const e=this.stashShadowState(),t=this.targetBlock();t.isShadow()?t.dispose(!1):(this.disconnectInternal(),r=t),this.applyShadowState(e)}ne()&&(s=new(oe(al.BLOCK_MOVE))(i),s.setReason(["connect"])),Ns(this,e),i.setParent(n),s&&(s.recordNew(),Y(s)),r&&(e=this.type===t?r.outputConnection:r.previousConnection)&&((i=Hp.getConnectionForOrphanedConnection(i,e))?e.connect(i):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===vp.INPUT_VALUE||this.type===vp.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=Fa.getGroup$$module$build$src$core$events$utils();t||Fa.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),Fa.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(!t||!n)throw Error("Source connection not connected.");const i=Fa.getGroup$$module$build$src$core$events$utils();let r;i||Fa.setGroup$$module$build$src$core$events$utils(!0),ne()&&(r=new(oe(al.BLOCK_MOVE))(n.getSourceBlock()),r.setReason(["disconnect"]));const s=this.targetConnection;s&&(s.targetConnection=null),this.targetConnection=null,e&&n.getSourceBlock().setParent(null),r&&(r.recordNew(),Y(r)),n.getSourceBlock().isShadow()||t.respawnShadow_(),Fa.setGroup$$module$build$src$core$events$utils(i)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){return!(this.getSourceBlock().isDeadOrDying()||(t=null==(n=e.getInput(t))?void 0:n.connection,(n=this.targetBlock())&&n!==e||!t||t.targetConnection===this||(t.isConnected()&&t.disconnect(),t.connect(this),0)));var n}targetBlock(){if(this.isConnected()){let e,t;return null!=(t=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Fr(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?kn(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let n=0;n<t.length;n++)if(t[n].connection===this){e=t[n];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let n,i=0;n=e.inputList[i];i++)if(n.connection===this){t=n;break}if(!t)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock();const n=this.getShadowState(),i=this.getShadowDom();if(t.isDeadOrDying()||!n&&!i)return null;if(n)return On(n,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(i){if(t=jr(i,t.workspace),e)if(this.type===vp.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==vp.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}return null}serializeShadow(e){e&&(this.shadowDom=Fr(e),this.shadowState=kn(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===vp.OUTPUT_VALUE)return Os(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const n=t.getConnectionChecker();return e&&n.canConnect(t,e,!1)?e:null}};Hp.CAN_CONNECT=0,Hp.REASON_SELF_CONNECTION=1,Hp.REASON_WRONG_TYPE=2,Hp.REASON_TARGET_NULL=3,Hp.REASON_CHECKS_FAILED=4,Hp.REASON_DIFFERENT_WORKSPACES=5,Hp.REASON_SHADOW_PARENT=6,Hp.REASON_DRAG_CHECKS_FAILED=7,Hp.REASON_PREVIOUS_AND_OUTPUT=8;var Gp=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},jp={};jp.DuplicateIconType=Gp,function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"}(Fa.Align$$module$build$src$core$inputs$align||(Fa.Align$$module$build$src$core$inputs$align={})),Fa.Align$$module$build$src$core$inputs$align;var Kp=class extends Pd{constructor(e,t,n){super(Pd.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==Pd.SKIP_SETUP&&(n?this.configure_(n):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&ce(this.getTextElement(),this.class),this.fieldGroup_&&ce(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return null==e?null:`${e}`}setClass(e){this.textElement_&&(this.class&&de(this.textElement_,this.class),e&&ce(this.textElement_,e)),this.class=e}static fromJson(e){return new this(nr(e.text),void 0,e)}};rs("field_label",Kp),Kp.prototype.DEFAULT_VALUE="";var zp=[];zp[vp.INPUT_VALUE]=vp.OUTPUT_VALUE,zp[vp.OUTPUT_VALUE]=vp.INPUT_VALUE,zp[vp.NEXT_STATEMENT]=vp.PREVIOUS_STATEMENT,zp[vp.PREVIOUS_STATEMENT]=vp.NEXT_STATEMENT;var Wp="RENAME_VARIABLE_ID",qp="DELETE_VARIABLE_ID",Jp=class extends Hp{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[zp[t]],this.offsetInBlock=new pc(0,0),this.trackedState=Jp.TrackedState.WILL_TRACK}dispose(){let e,t;super.dispose(),this.trackedState===Jp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var n=Fa.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),i=Fa.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),r=e.sourceBlock_.getRootBlock(),s=this.sourceBlock_.getRootBlock();if(!r.isInFlyout&&!s.isInFlyout){var o=!0;if(s.isMovable())r.isMovable()&&t&&(i=-i);else{if(!r.isMovable())return;o=!1,n=-n,i=-i}t=o?e:this,e=o?this:e,(r=o?s:r).RTL&&(n=-n),r.moveBy(t.x+n-e.x,t.y+i-e.y,["bump"])}}}moveTo(e,t){let n=!1;return this.trackedState===Jp.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Jp.TrackedState.TRACKED,n=!0):this.trackedState===Jp.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),n=!0),this.x=e,this.y=t,n}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=pc.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0;const e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;const e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Jp.TrackedState.TRACKED||!e&&this.trackedState===Jp.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Jp.TrackedState.TRACKED):(this.trackedState===Jp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Jp.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const n=e[t],i=n.getConnections_(!0);for(let e=0;e<i.length;e++)i[e].setTracking(!1);for(const e of n.getIcons())Kn(e)&&e.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==vp.INPUT_VALUE&&this.type!==vp.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let n;t.isCollapsed()?(n=[],t.outputConnection&&n.push(t.outputConnection),t.nextConnection&&n.push(t.nextConnection),t.previousConnection&&n.push(t.previousConnection)):n=t.getConnections_(!0);for(let t=0;t<n.length;t++)e.push(...n[t].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(J()){const n=Fa.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(Fa.setGroup$$module$build$src$core$events$utils(n),this.bumpAwayFrom(e),Fa.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),Fa.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(t&&n){var i=Fa.getGroup$$module$build$src$core$events$utils();i||Fa.setGroup$$module$build$src$core$events$utils(!0);var r=t.getSourceBlock(),s=n.getSourceBlock();super.disconnectInternal(e),r.queueRender(),s.updateDisabled(),s.queueRender(),s.getSvgRoot().style.display="block",Fa.setGroup$$module$build$src$core$events$utils(i)}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){const t=Xd.registry.getContextMenuOptions({focusedNode:this},e);if(t.length){var n=this.getSourceBlock(),i=n.workspace;if(e instanceof PointerEvent)var r=new pc(e.clientX,e.clientY);else r=new pc(this.x,this.y),r=st(i,r).translate(n.RTL?-5:5,5);Tr(e,t,n.RTL,i,r)}}getFocusableElement(){const e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight()}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}};!function(e){(e=e.TrackedState||(e.TrackedState={}))[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"}(Jp||(Jp={}));var Yp=Jp.TrackedState,Xp={};Xp.RenderedConnection=Jp,Xp.TrackedState=Yp;var Zp=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=Fa.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=Fa.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,n){if(e<0||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return t||""===t&&n?("string"==typeof t&&(t=Fa.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=n,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),e):e}removeField(e,t){for(let t,n=0;t=this.fieldRow[n];n++)if(t.name===e)return t.dispose(),this.fieldRow.splice(n,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let t,n=0;t=this.fieldRow[n];n++)t.setVisible(e);if(this.connection&&this.connection instanceof Jp){e?t=this.connection.startTrackingAll():this.connection.stopTrackingAll();const n=this.connection.targetBlock();n&&(n.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e,t=0;e=this.fieldRow[t];t++)e.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const e of this.fieldRow)e.init()}initModel(){for(const e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let e,t=0;e=this.fieldRow[t];t++)e.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},Qp=class extends Zp{constructor(e,t){super(e,t),this.name=e,this.type=Fa.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},eh=class extends Zp{constructor(e,t){super(e,t),this.name=e,this.type=Fa.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},th=class extends Zp{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=Fa.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(vp.NEXT_STATEMENT)}};Fa.ValueInput$$module$build$src$core$inputs$value_input=class extends Zp{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=Fa.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(vp.INPUT_VALUE)}},Fa.ValueInput$$module$build$src$core$inputs$value_input;var nh=class{constructor(e,t,n){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=n&&!e.getBlockById(n)?n:E(),e.setBlockById(this.id,this),this.xy=new pc(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(n=el[t])||"object"!=typeof n)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,n)}e.addTopBlock(this),e.addTypedBlock(this),new.target===nh&&this.doInit_()}doInit_(){const e=Fa.getGroup$$module$build$src$core$events$utils();e||Fa.setGroup$$module$build$src$core$events$utils(!0);const t=J();try{"function"==typeof this.init&&(Fa.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),Fa.setRecordUndo$$module$build$src$core$events$utils(t)),ne()&&Y(new(oe(al.BLOCK_CREATE))(this))}finally{Fa.setGroup$$module$build$src$core$events$utils(e),Fa.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),ne()&&Y(new(oe(al.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let t,n=null;null!=(t=this.outputConnection)&&t.isConnected()&&(n=this.outputConnection.targetConnection,this.outputConnection.disconnect()),n&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(null==(e=e.targetConnection)||e.disconnect(),this.workspace.connectionChecker.canConnect(e,n,!1)?n.connect(e):null==e||e.onFailedConnect(n))}getOnlyValueConnection(){let e=null;for(let t=0;t<this.inputList.length;t++){const n=this.inputList[t].connection;if(n&&n.type===vp.INPUT_VALUE&&n.targetConnection){if(e)return null;e=n}}return e}unplugFromStack(e){let t=null;var n;if(null!=(n=this.previousConnection)&&n.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),n=this.getNextBlock(),e&&n&&!n.isShadow()){let n,i;null==(e=null!=(i=null==(n=this.nextConnection)?void 0:n.targetConnection)?i:null)||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t,n=0;t=this.inputList[n];n++)t.connection&&e.push(t.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const n=t.targetBlock();if(!n||e&&n.isShadow())return t;t=n.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t,n=0;t=this.inputList[n];n++)if(t.connection&&t.connection.targetBlock()===e)return t;return null}getSurroundParent(){let e,t=this;do{if(e=t,t=t.getParent(),!t)return null}while(t.getNextBlock()===e);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do{e=t,t=e.parentBlock_}while(t);return e}getTopStackBlock(){let e,t=this;do{e=t.getPreviousBlock()}while(e&&e.getNextBlock()===t&&(t=e));return t}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let n,i=0;n=this.inputList[i];i++)if(n.connection){var t=n.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),n=!!t;if(n&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!n&&e)throw Error("Block not connected to new parent.");if(n&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?He(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],n=this.getChildren(e);for(let i,r=0;i=n[r];r++)t.push(...i.getDescendants(e));return t}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(Fe(this,!0))}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(const e of this.getFields())e.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||e.fieldRow.length>1)return!1;return!0}getMatchingConnection(e,t){const n=this.getConnections_(!0);if(e=e.getConnections_(!0),n.length!==e.length)throw Error("Connection lists did not match in length.");for(let i=0;i<e.length;i++)if(e[i]===t)return n[i];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return Ii(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=rr(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(const t of this.getFields())if(t.name===e)return t;return null}*getFields(){for(const e of this.inputList)for(const t of e.fieldRow)yield t}getVars(){const e=[];for(const t of this.getFields())t.referencesVariables()&&e.push(t.getValue());return e}getVarModels(){const e=[];for(const t of this.getFields())if(t.referencesVariables()){const n=this.workspace.getVariableById(t.getValue());n&&e.push(n)}return e}updateVarName(e){for(const t of this.getFields())t.referencesVariables()&&e.getId()===t.getValue()&&t.refreshVariableName()}renameVarById(e,t){for(const n of this.getFields())n.referencesVariables()&&e===n.getValue()&&n.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const n=this.getField(t);if(!n)throw Error('Field "'+t+'" not found.');n.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(vp.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(vp.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(vp.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(Y(new(oe(al.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Qp&&this.inputList[e]instanceof Qp)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof Qp)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof eh)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(iu)||t==iu||this.setDisabledReason(!1,iu),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),(e=new(oe(al.BLOCK_CHANGE))(this,"disabled",null,!e,e)).setDisabledReason(t),Y(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(Y(new(oe(al.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let e=2;e<t.length;e++)"("===t[e-2]&&")"===t[e]&&(t[e-2]=t[e-1],t.splice(e-1,2));let n="";return t=t.reduce((e,t)=>(e=e+("("===n||")"===t?"":" ")+t,n=t[t.length-1],e),""),t=t.trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){const t=[];for(const i of this.inputList)if(i.name!=tu){for(const e of i.fieldRow)t.push(e.getText());if(i.connection){const r=i.connection.targetBlock();if(r){var n=i.connection;let s=n.getCheck();!s&&n.targetConnection&&(s=n.targetConnection.getCheck()),(n=!!s&&(s.includes("Boolean")||s.includes("Number")))&&t.push("("),t.push(...r.toTokens(e)),n&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new Fa.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new th(e,this))}appendDummyInput(e=""){return this.appendInput(new Qp(e,this))}appendEndRowInput(e=""){return this.appendInput(new eh(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=o(Ha.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var n=0;e["args"+n];){if(void 0===e["message"+n])throw Error(t+`args${n} must have a corresponding message (message${n}).`);n++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),n=0;void 0!==e["message"+n];)this.interpolate(e["message"+n],e["args"+n]||[],e["implicitAlign"+n]||e["lastDummyAlign"+n],t),n++;if(void 0!==e.inputsInline&&(Fa.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),Fa.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(n=nr(e.tooltip),this.setTooltip(n)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(n=nr(e.helpUrl),this.setHelpUrl(n)),"string"==typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&us(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)us(e[t],this,!1)}jsonInitColour(e,t){if("colour"in e)if(void 0===e.colour)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(n){console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle(e,t){e=e.style;try{this.setStyle(e)}catch(n){console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(void 0!==t&&"boolean"!=typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const n in e)void 0!==this[n]&&t.push(n);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(e,t,n,i){e=tr(e),this.validateTokens(e,t.length),t=this.interpolateArguments(e,t,n),n=[];for(let r,s=0;r=t[s];s++)if(this.isInputKeyword(r.type)){if(e=this.inputFromJson(r,i)){for(let t,i=0;t=n[i];i++)e.appendField(t[0],t[1]);n.length=0}}else(e=this.fieldFromJson(r))&&n.push([e,r.name])}validateTokens(e,t){const n=[];let i=0;for(let r=0;r<e.length;r++){const s=e[r];if("number"==typeof s){if(s<1||s>t)throw Error('Block "'+this.type+'": Message index %'+s+" out of range.");if(n[s])throw Error('Block "'+this.type+'": Message index %'+s+" duplicated.");n[s]=!0,i++}}if(i!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments(e,t,n){const i=[];for(let s=0;s<e.length;s++){var r=e[s];if("number"==typeof r&&(r=t[r-1]),"string"==typeof r)if("\n"===r)r={type:"input_end_row"},n&&(r.align=n);else if(!(r=this.stringToFieldJson(r)))continue;i.push(r)}return(e=i.length)&&!this.isInputKeyword(i[e-1].type)&&(e={type:"input_dummy"},n&&(e.align=n),i.push(e)),i}fieldFromJson(e){const t=Fa.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){var n={LEFT:Fa.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:Fa.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:Fa.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:Fa.Align$$module$build$src$core$inputs$align.CENTRE};let i;switch(e.type){case"input_value":i=this.appendValueInput(e.name);break;case"input_statement":i=this.appendStatementInput(e.name);break;case"input_dummy":i=this.appendDummyInput(e.name);break;case"input_end_row":i=this.appendEndRowInput(e.name);break;default:i=this.appendInputFromRegistry(e.type,e.name)}return i?(e.check&&i.setCheck(e.check),e.align&&(void 0===(n=n[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):i.setAlign(n)),i):null}isInputKeyword(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||s(Ha.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var n=-1,i=t?-1:this.inputList.length;for(let r,s=0;r=this.inputList[s];s++)if(r.name===e){if(n=s,-1!==i)break}else if(t&&r.name===t&&(i=s,-1!==n))break;if(-1===n)throw Error('Named input "'+e+'" not found.');if(-1===i)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(n,i)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const n=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,n)}removeInput(e,t){for(let t,n=0;t=this.inputList[n];n++)if(t.name===e)return t instanceof th&&this.statementInputCount--,t.dispose(),this.inputList.splice(n,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t,n=0;t=this.inputList[n];n++)if(t.name===e)return t;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return null!=(t=null==(e=this.getIcon(Gu.COMMENT))?void 0:e.getText())?t:null}setCommentText(e){var t;let n;const i=null!=(n=null==(t=this.getIcon(Gu.COMMENT))?void 0:t.getText())?n:null;if(i!==e){if(null!==e){if(!(t=this.getIcon(Gu.COMMENT))){if(!(t=o(Ha.ICON,Gu.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!Ls(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}Fa.disable$$module$build$src$core$events$utils(),t.setText(e),Fa.enable$$module$build$src$core$events$utils()}else this.removeIcon(Gu.COMMENT);Y(new(oe(al.BLOCK_CHANGE))(this,"comment",null,i,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new Gp(e);return this.icons.push(e),this.icons.sort((e,t)=>e.getWeight()-t.getWeight()),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return null==(t=this.getIcon(e))||t.dispose(),this.icons=this.icons.filter(t=>!t.getType().equals(e)),!0}hasIcon(e){return this.icons.some(t=>t.getType().equals(e))}getIcon(e){return e instanceof Gu?this.icons.find(t=>t.getType().equals(e)):this.icons.find(t=>t.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const i=new(oe(al.BLOCK_MOVE))(this);n&&i.setReason(n),this.xy.translate(e,t),i.recordNew(),Y(i)}makeConnection_(e){return new Hp(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let n,i=0;n=this.inputList[i];i++)if(n.connection){var t=n.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return!(t=this.getNextBlock())||t.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};nh.COLLAPSED_INPUT_NAME=tu,nh.COLLAPSED_FIELD_NAME=nu;var ih=null,rh=null,sh={};sh.connectionUiEffect=Fs,sh.disconnectUiEffect=Bs,sh.disconnectUiStop=Us,sh.disposeUiEffect=Ps;var oh=class{paste(e,t,n){if(!t.isCapacityAvailable(e.typeCounts))return null;let i;n&&(e.blockState.x=n.x,e.blockState.y=n.y),n=n||new pc(e.blockState.x||0,e.blockState.y||0),Fa.disable$$module$build$src$core$events$utils();try{i=Dn(e.blockState,t),Vs(i,n)}finally{Fa.enable$$module$build$src$core$events$utils()}if(!i)return i;ne()&&!i.isShadow()&&Y(new(oe(al.BLOCK_CREATE))(i));const r=i;return Lt().then(()=>Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(r)),i}};oh.TYPE="block",Ct(oh.TYPE,new oh);var ah={};ah.BlockPaster=oh,ah.moveBlockToNotConflict=Vs;var lh={};lh.bumpIntoBounds=js,lh.bumpIntoBoundsHandler=Ks,lh.bumpTopObjectsIntoBounds=Ws;var ch=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new pc(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,t;return null!=(t=null==(e=this.block.getParent())?void 0:e.isMovable())&&t}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){var t;this.block.isShadow()?this.startDraggingShadow(e):(this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(c(Ha.CONNECTION_PREVIEWER,this.workspace.options))(this.block),ge(),this.workspace.setResizesEnabled(!1),Us(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0),null==(t=this.workspace.getLayerManager())||t.moveToDragLayer(this.block))}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){const t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=pc.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,n,i;if(this.startParentConn=null!=(i=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?i:null==(n=this.block.previousConnection)?void 0:n.targetConnection,e){let e;this.startChildConn=null==(e=this.block.nextConnection)?void 0:e.targetConnection}this.block.unplug(e),Bs(this.block)}fireDragStartEvent(){const e=new(oe(al.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));Y(e)}fireDragEndEvent(){const e=new(oe(al.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));Y(e)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(oe(al.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),Y(e)}}drag(e){if(this.block.isShadow()){let t;null==(t=this.block.getParent())||t.drag(pc.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,pc.difference(e,this.startLoc))}updateConnectionPreview(e,t){var n=this.connectionCandidate;const i=this.getConnectionCandidate(e,t);if(i){this.connectionCandidate=t=n&&this.currCandidateIsBetter(n,t,i)?n:i;var r,{local:s,neighbour:o}=t;if(t=s.type===vp.OUTPUT_VALUE||s.type===vp.PREVIOUS_STATEMENT,n=o.isConnected()&&!(null!=(r=o.targetBlock())&&r.isInsertionMarker()),t&&n&&!this.orphanCanConnectAtEnd(e,o.targetBlock(),s.type)){let e;null==(e=this.connectionPreviewer)||e.previewReplacement(s,o,o.targetBlock())}else{var a;null==(a=this.connectionPreviewer)||a.previewConnection(s,o)}}else{let e;null==(e=this.connectionPreviewer)||e.hidePreview(),this.connectionCandidate=null}}orphanCanConnectAtEnd(e,t,n){return!!Hp.getConnectionForOrphanedConnection(e,n===vp.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,n){const{local:i,neighbour:r}=e;e=new pc(i.x,i.y);const s=new pc(r.x,r.y);return t=pc.distance(pc.sum(e,t),s),n.distance>t-Fa.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let n=this.getSearchRadius(),i=null;for(const r of e){const{connection:e,radius:s}=r.closest(n,t);e&&(i={local:r,neighbour:e,distance:s},n=s)}return i}getSearchRadius(){return this.connectionCandidate?Fa.config$$module$build$src$core$config.connectingSnapRadius:Fa.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){const t=e.getConnections_(!1),n=e.lastConnectionInStack(!0);return n&&n!==e.nextConnection&&t.push(n),t}endDrag(e){if(this.block.isShadow()){let t;null==(t=this.block.getParent())||t.endDrag(e)}else{var t;if(this.originalEventGroup=Fa.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),_e(),Us(),null==(t=this.connectionPreviewer)||t.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let e;null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.block,ep),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep())}}disposeStep(){const e=Fa.getGroup$$module$build$src$core$events$utils();let t;Fa.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null==(t=this.connectionPreviewer)||t.dispose(),this.workspace.setResizesEnabled(!0),Fa.setGroup$$module$build$src$core$events$utils(e)}applyConnections(e){const{local:t,neighbour:n}=e;t.connect(n);const i=t.isSuperior()?n:t,r=this.block.getRootBlock();Lt().then(()=>{Fs(i.getSourceBlock()),setTimeout(()=>{r.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let e;null==(e=this.block.getParent())||e.revertDrag()}else{var e,t;if(null==(e=this.connectionPreviewer)||e.hidePreview(),this.connectionCandidate=null,null==(t=this.startChildConn)||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case vp.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case vp.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{let e;this.block.moveTo(this.startLoc,["drag"]),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.block,ep),js(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}},uh=class extends Rp{constructor(e,t,n,i){super(t,n,i),this.text=e,this.workspace=t,this.anchor=n,this.ownerRect=i,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),ce(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,he(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return le(hc.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${Rp.BORDER_WIDTH})`,style:"direction: "+(this.workspace.RTL?"rtl":"ltr")},e)}createTextFragments(e,t){let n=1;return t.split("\n").map(t=>{const i=le(hc.TEXT,{y:`${n}em`,x:Rp.BORDER_WIDTH},e);return t=document.createTextNode(t),i.appendChild(t),n+=1,i})}rightAlignTextFragments(e,t){for(const n of t)n.setAttribute("text-anchor","start"),n.setAttribute("x",`${e+Rp.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new mc(e.width+2*Rp.BORDER_WIDTH,e.height+2*Rp.BORDER_WIDTH),!0)}},dh=class extends Pp{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return dh.TYPE}initView(e){this.svgRoot||(super.initView(e),le(hc.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),le(hc.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),le(hc.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),ce(this.svgRoot,"blocklyWarningIcon"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return dh.WEIGHT}getSize(){return new mc(17,17)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.textBubble)||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;let n;return e?this.textMap.set(t,e):this.textMap.delete(t),null==(n=this.textBubble)||n.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){const t=this;return(0,Ma.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Lt(),e)t.textBubble=new uh(t.getText(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour();else{let e;null==(e=t.textBubble)||e.dispose(),t.textBubble=null}Y(new(oe(al.BUBBLE_OPEN))(t.sourceBlock,e,"warning"))}})}getBubble(){return this.textBubble}getAnchorLocation(){return pc.sum(this.workspaceLocation,new pc(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new fc(e.y,e.y+e.height,e.x,e.x+e.width)}};dh.TYPE=Gu.WARNING,dh.WEIGHT=2;var ph=class extends nh{constructor(e,t,n){if(super(e,t,n),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new pc(0,0),this.dragStrategy=new ch(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=le(hc.G,{}),t&&ce(this.svgGroup,t),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),(e=this.pathObject.svgPath).tooltip=this,Di(e),this.svgGroup.setAttribute("data-id",this.id),e.id=x(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(const e of this.getIcons())e.initView(this.createIconPointerDownListener(e)),e.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&g(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),Re(this)}unselect(){this.removeSelect(),Re(null)}setParent(e){var t=this.parentBlock_;if(e!==t){ge(),super.setParent(e),_e();var n=this.getSvgRoot();if(!this.workspace.isClearing&&n){var i,r=this.getRelativeToSurfaceXY(),s=Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),o=this.getSvgRoot().contains(null!=(i=null==s?void 0:s.getFocusableElement())?i:null);e?(e.getSvgRoot().appendChild(n),o&&s&&Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(s)):t&&((t=null==(e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?void 0:e.parentElement)===(i=this.workspace.getCanvas())?i.insertBefore(n,e):(i.appendChild(n),o&&s&&Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(s)),this.translate(r.x,r.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,n=0,i=this.getSvgRoot();if(i)do{const e=et(i);t+=e.x,n+=e.y,i=i.parentNode}while(i&&!e.hasLayer(i));return new pc(t,n)}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const i=ne();let r=null;i&&(r=new(oe(al.BLOCK_MOVE))(this),n&&r.setReason(n)),e=new pc(e,t),t=this.getRelativeToSurfaceXY(),e=pc.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),i&&r&&(r.recordNew(),Y(r)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new pc(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const n=this.getRelativeToSurfaceXY();this.moveBy(e.x-n.x,e.y-n.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){const t=this.getRelativeToSurfaceXY();let n,i;return this.RTL?(n=t.x-e.width,i=t.x):(n=t.x,i=t.x+e.width),new fc(t.y,t.y+e.height,n,i)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e,t=0;e=this.inputList[t];t++)e.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){const e=this.getChildren(!1);for(const t of e)if(t.getIcon(dh.TYPE)||t.childHasWarning())return!0;return!1}updateCollapsed(){var e=this.isCollapsed();const t=tu,n=nu;for(let n,i=0;n=this.inputList[i];i++)n.name!==t&&n.setVisible(!e);for(var i of this.getIcons())i.updateCollapsed();e?(ce(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(Fa.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,ph.COLLAPSED_WARNING_ID),e=this.toString(30),(i=this.getField(n))?i.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new Kp(e),n)):(this.updateDisabled(),this.removeInput(t),de(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,ph.COLLAPSED_WARNING_ID))}onMouseDown(e){if(!this.workspace.isReadOnly()){var t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}}showHelp(){const e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=Xd.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){if(e instanceof PointerEvent)return new pc(e.clientX,e.clientY);let t,n;e=st(this.workspace,this.getRelativeToSurfaceXY());const i=null==(t=this.inputList.filter(e=>e.isVisible()).flatMap(e=>e.fieldRow).find(e=>e.isVisible()))||null==(n=t.getSvgRoot())?void 0:n.getBoundingClientRect();return new pc(this.RTL?e.x-5:e.x+5,(i&&i.height?i.y+i.height:e.y+this.height)+5)}showContextMenu(e){const t=this.generateContextMenu(e),n=this.calculateContextMenuLocation(e);t&&t.length&&(Tr(e,t,this.RTL,this.workspace,n),vr(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(pc.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const n of t.fieldRow)n.onLocationChange(e)}addClass(e){ce(this.svgGroup,e)}removeClass(e){de(this.svgGroup,e)}setDragging(e){(this.dragging=e)?(this.translation="",Yl.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(Yl.length=0,this.removeClass("blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e?de(this.svgGroup,"blocklyNotEditable"):ce(this.svgGroup,"blocklyNotEditable"),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){this.disposing=!0,Mi(),Cr();const n=Fa.getFocusManager$$module$build$src$core$focus_manager();var i,r;if(this.getSvgRoot().contains(null!=(r=null==(i=n.getFocusedNode())?void 0:i.getFocusableElement())?r:null)){if(!(i=this.getParent())){let e;if(r=null!=(e=this.outputConnection)?e:this.previousConnection){let e;i=null==(e=r.closest(0,new pc(0,0)).connection)?void 0:e.getSourceBlock()}}i?n.focusNode(i):setTimeout(()=>n.focusTree(this.workspace),0)}t&&(this.unplug(e),Ps(this)),super.dispose(!!e),he(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(Fa.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),Fa.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:oh.TYPE,blockState:kn(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:Fe(this,!0)}}applyColour(){var e,t;for(null==(t=(e=this.pathObject).applyColour)||t.call(e,this),e=this.getIcons(),t=0;t<e.length;t++)e[t].applyColour();for(const e of this.getFields())e.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let e;null==(e=this.getNextBlock())||e.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const e of this.getChildren(!1))e.updateDisabled()}}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var n of this.warningTextDb.values())clearTimeout(n);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))},100));else if(this.isInFlyout&&(e=null),n=this.getIcon(dh.TYPE),e){let i=this.getSurroundParent(),r=null;for(;i;)i.isCollapsed()&&(r=i),i=i.getSurroundParent();r&&r.setWarningText(Fa.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,ph.COLLAPSED_WARNING_ID),n?n.addMessage(e,t):this.addIcon(new dh(this).addMessage(e,t))}else n&&(t?(n.addMessage("",t),n.getText()||this.removeIcon(dh.TYPE)):this.removeIcon(dh.TYPE))}setMutator(e){this.removeIcon(Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setDisabledReason(e,t){const n=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===n||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),e?de(this.svgGroup,"blocklyNotDeletable"):ce(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){let t,n;super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null==(n=(t=this.pathObject).setStyle)||n.call(t,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&de(this.svgGroup,this.styleName_),!t)throw Error("Invalid style name: "+e);{let n,i;this.hat=t.hat,null==(i=(n=this.pathObject).setStyle)||i.call(n,t),this.colour_=t.colourPrimary,this.style=t,this.applyColour(),ce(this.svgGroup,e),this.styleName_=e}}getStyle(){return this.style}bringToFront(e=!1){const t=Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();let n=this;if(!n.isDeadOrDying()){do{const t=n.getSvgRoot(),i=t.parentNode,r=i.childNodes;if(r[r.length-1]!==t&&i.appendChild(t),e)break;n=n.getParent()}while(n);t&&Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(t)}}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var n=this.inputList[t].connection;n&&(n.setTracking(e),(n=n.targetBlock())&&n.setConnectionTracking(e))}}getConnections_(e){const t=[];if(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)for(let e,n=0;e=this.inputList[n];n++)e.connection&&t.push(e.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Jp(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let e;null==(e=t.targetBlock())||e.bumpNeighbours()}for(const n of t.neighbours(Fa.config$$module$build$src$core$config.snapRadius))n.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&n.isConnected()||(t.isSuperior()?n.bumpAwayFrom(t,!1):t.bumpAwayFrom(n,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,n){if(e.type===vp.NEXT_STATEMENT||e.type===vp.INPUT_VALUE){let i=t.x;t=t.y,i+=n.x-e.getOffsetInBlock().x,t+=n.y-e.getOffsetInBlock().y,this.moveBy(i,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return Rt(this)}render(){this.queueRender(),Pt()}renderEfficiently(){ge(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),_e()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,t=this.width;var n=this.getNextBlock();if(n){n=n.getHeightWidth();const i=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=n.height-i,t=Math.max(t,n.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const e=Object.assign({},{kind:"BLOCK"},kn(this)),t=new Set(["id","height","width","pinned","enabled"]),n=function(e){for(const i in e)t.has(i)?delete e[i]:"object"==typeof e[i]&&n(e[i])};return n(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};ph.INLINE=-1,ph.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var hh=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},fh=class extends hh{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof ph?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(qs(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},mh=class{constructor(e,t){this.element=e,this.type=t}getElement(){return this.element}getType(){return this.type}},gh=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,n=0;return e&&(t=e.getWidth(),n=e.getHeight()),new mc(t,n)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const n=this.getToolboxMetrics(),i=this.getFlyoutMetrics(),r=!!this.workspace_.getToolbox();var s;const o=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=r?n.position:i.position)===Nc.TOP;return s===Nc.LEFT&&(r&&(e+=n.width),o&&(e+=i.width)),a&&(r&&(t+=n.height),o&&(t+=i.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),n=this.getToolboxMetrics(),i=this.getFlyoutMetrics(),r=!!this.workspace_.getToolbox();var s;const o=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=r?n.position:i.position)===Nc.LEFT||s===Nc.RIGHT;return s!==Nc.TOP&&s!==Nc.BOTTOM||(r&&(t.height-=n.height),o&&(t.height-=i.height)),a&&(r&&(t.width-=n.width),o&&(t.width-=i.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),n=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const i={};return n||(i.top=e.top,i.bottom=e.top+e.height),t||(i.left=e.left,i.right=e.left+e.width),i}getPaddedContent_(e,t){const n=t.top+t.height,i=t.left+t.width,r=e.width,s=r/2,o=(e=e.height)/2;return{top:Math.min(t.top-o,n-e),bottom:Math.max(n+o,t.top+e),left:Math.min(t.left-s,i-r),right:Math.max(i+s,t.left+r)}}getScrollMetrics(e,t,n){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var i=n||this.getContentMetrics();n=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,i),i=void 0!==n.top?n.top:t.top;const r=void 0!==n.left?n.left:t.left;return{top:i/e,left:r/e,width:((void 0!==n.right?n.right:t.right)-r)/e,height:((void 0!==n.bottom?n.bottom:t.bottom)-i)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),n=this.getSvgMetrics(),i=this.getAbsoluteMetrics(),r=this.getViewMetrics(),s=this.getContentMetrics(),o=this.getScrollMetrics(!1,r,s);return{contentHeight:s.height,contentWidth:s.width,contentTop:s.top,contentLeft:s.left,scrollHeight:o.height,scrollWidth:o.width,scrollTop:o.top,scrollLeft:o.left,viewHeight:r.height,viewWidth:r.width,viewTop:r.top,viewLeft:r.left,absoluteTop:i.top,absoluteLeft:i.left,svgHeight:n.height,svgWidth:n.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};t(Ha.METRICS_MANAGER,Va,gh);var _h=class extends gh{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,n){return t=n||this.getContentMetrics(),n=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*n)/e,width:(t.width+t.left+n)/e,top:0,left:0}}},yh=class{constructor(e,t,n,i){let r;this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=i,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=n.text,this.position=new pc(0,0),this.callbackKey=n.callbackKey||n.callbackkey,this.cssClass=n["web-class"]||null,this.info=n,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=x(),this.svgGroup=le(hc.G,{id:this.id,class:e},this.workspace.getCanvas()),this.isFlyoutLabel||(r=le(hc.RECT,{class:"blocklyFlyoutButtonShadow",rx:yh.BORDER_RADIUS,ry:yh.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=le(hc.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:yh.BORDER_RADIUS,ry:yh.BORDER_RADIUS},this.svgGroup),t=le(hc.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),n=nr(this.text),this.workspace.RTL&&(n+=""),t.textContent=n,this.isFlyoutLabel&&(this.svgText=t,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),i=qe(t,"fontSize");const s=qe(t,"fontWeight"),o=qe(t,"fontFamily");if(this.width=ve(t,i,s,o),n=Te(n,i,s,o),this.height=this.height||n.height,!this.isFlyoutLabel){let e,t;this.width+=2*yh.TEXT_MARGIN_X,this.height+=2*yh.TEXT_MARGIN_Y,null==(e=r)||e.setAttribute("width",String(this.width)),null==(t=r)||t.setAttribute("height",String(this.height))}e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(this.height/2-n.height/2+n.baseline)),this.updateTransform(),this.onMouseDownWrapper=g(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=g(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}moveBy(e,t,n){this.moveTo(this.position.x+e,this.position.y+t)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new fc(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){y(this.onMouseDownWrapper),y(this.onMouseUpWrapper),this.svgGroup&&he(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){const t=this.targetWorkspace.getGesture(e),n=this.targetWorkspace.getFlyout();t&&n&&t.handleFlyoutStart(e,n)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}};yh.TEXT_MARGIN_X=5,yh.TEXT_MARGIN_Y=2,yh.BORDER_RADIUS=4,Ge("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var bh=class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof yh}},vh=class{constructor(e,t){this.policy=e,this.flyout=t}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(e){const t=this.flyout.getContents();if(!t)return null;let n=t.findIndex(t=>t.getElement()===e);return-1===n?null:(n++,n>=t.length&&(n=0),t[n].getElement())}getPreviousSibling(e){const t=this.flyout.getContents();if(!t)return null;let n=t.findIndex(t=>t.getElement()===e);return-1===n?null:(n--,n<0&&(n=t.length-1),t[n].getElement())}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},Th=class{constructor(e,t){this.gap=e,this.axis=t,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new fc(this.y,this.y,this.x,this.x+this.gap);case"y":return new fc(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,t,n){this.x+=e,this.y+=t}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},kh=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof Th}},xh=class{getFirstChild(e){return Js(e,!0)[0]}getParent(e){var t;if(null!=(t=e.previousConnection)&&t.targetBlock()){if(t=e.getSurroundParent())return t}else{let t;if(null!=(t=e.outputConnection)&&t.targetBlock())return e.outputConnection.targetBlock()}return e.workspace}getNextSibling(e){let t,n;if(null!=(t=e.nextConnection)&&t.targetBlock()){let t;return null==(t=e.nextConnection)?void 0:t.targetBlock()}return null!=(n=e.outputConnection)&&n.targetBlock()?Xs(e,1):e.getSurroundParent()?Xs(e.getTopStackBlock(),1):this.getParent(e)instanceof Mf?Ys(e,1):null}getPreviousSibling(e){let t,n;if(null!=(t=e.previousConnection)&&t.targetBlock()){let t;return null==(t=e.previousConnection)?void 0:t.targetBlock()}return null!=(n=e.outputConnection)&&n.targetBlock()?Xs(e,-1):this.getParent(e)instanceof Mf?Ys(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof ph}},Eh={};Eh.BlockNavigationPolicy=xh,Eh.navigateBlock=Xs,Eh.navigateStacks=Ys;var Sh=class{getFirstChild(e){return null}getParent(e){return e.getParentComment()}getNextSibling(e){const t=e.getParentComment().view.getCommentBarButtons();return(e=t.indexOf(e))>=0&&e+1<t.length?t[e+1]:null}getPreviousSibling(e){const t=e.getParentComment().view.getCommentBarButtons();return(e=t.indexOf(e))>0?t[e-1]:null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof op}},Ch=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){if(e.getParentInput())return Xs(e,1);if(e.type===vp.NEXT_STATEMENT){const n=e.targetConnection;var t=e.getSourceBlock();if(!n&&t.getRootBlock().lastConnectionInStack(!1)===e){let n;return e=t.workspace.getTopBlocks(!0),(t=e.indexOf(t.getRootBlock())+1)>=e.length&&(t=0),t=e[t],null!=(n=this.getParentConnection(t))?n:t}return n}return e.getSourceBlock()}getPreviousSibling(e){if(e.getParentInput())return Xs(e,-1);if(e.type===vp.PREVIOUS_STATEMENT||e.type===vp.OUTPUT_VALUE){const n=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null;var t=e.getSourceBlock();if(!n&&this.getParentConnection(t.getRootBlock())===e){let n;return e=t.workspace.getTopBlocks(!0),(t=e.indexOf(t.getRootBlock())-1)<0&&(t=e.length-1),null!=(n=(t=e[t]).lastConnectionInStack(!1))?n:t}return n}return e.type===vp.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){let t;return!e.outputConnection||null!=(t=e.previousConnection)&&t.isConnected()?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Jp}},wh=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Xs(e,1)}getPreviousSibling(e){return Xs(e,-1)}isNavigable(e){let t;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!(null!=(t=e.getSourceBlock())&&t.isSimpleReporter()&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof Pd}},Ih=class{getFirstChild(e){if(e instanceof Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()&&Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e){let t,n;return null!=(n=null==(t=e.getBubble())?void 0:t.getWorkspace())?n:null}return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Xs(e,1)}getPreviousSibling(e){return Xs(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Pp}},Ah=class{getFirstChild(e){return e.view.getCommentBarButtons()[0]}getParent(e){return e.workspace}getNextSibling(e){return Ys(e,1)}getPreviousSibling(e){return Ys(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof mp}},Nh=class{getFirstChild(e){return(e=e.getTopBlocks(!0)).length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()&&!e.isMutator}isApplicable(e){return e instanceof Mf}},Dh=class{constructor(){this.rules=[new xh,new wh,new Ch,new Nh,new Ih,new Ah,new Sh]}addNavigationPolicy(e){this.rules.push(e)}get(e){return this.rules.find(t=>t.isApplicable(e))}getFirstChild(e){let t;const n=null==(t=this.get(e))?void 0:t.getFirstChild(e);if(!n)return null;let i;return null!=(i=this.get(n))&&i.isNavigable(n)?n:this.getFirstChild(n)||this.getNextSibling(n)}getParent(e){let t;const n=null==(t=this.get(e))?void 0:t.getParent(e);if(!n)return null;let i;return null!=(i=this.get(n))&&i.isNavigable(n)?n:this.getParent(n)}getNextSibling(e){let t;const n=null==(t=this.get(e))?void 0:t.getNextSibling(e);if(!n)return null;let i;return null!=(i=this.get(n))&&i.isNavigable(n)?n:this.getNextSibling(n)}getPreviousSibling(e){let t;const n=null==(t=this.get(e))?void 0:t.getPreviousSibling(e);if(!n)return null;let i;return null!=(i=this.get(n))&&i.isNavigable(n)?n:this.getPreviousSibling(n)}},Oh=class extends Dh{constructor(e){super(),this.rules.push(new bh,new kh),this.rules=this.rules.map(t=>new vh(t,e))}},Rh=class{constructor(e,t,n,i,r){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,n=void 0===n||n;const s=(t=void 0===t||t)&&n;t&&(this.hScroll=new Tc(e,!0,s,i,r)),n&&(this.vScroll=new Tc(e,!1,s,i,r)),s&&(this.corner_=le(hc.RECT,{height:Tc.scrollbarThickness,width:Tc.scrollbarThickness,class:"blocklyScrollbarBackground"}),fe(this.corner_,e.getBubbleCanvas()))}dispose(){he(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,n=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(n=!0)):n=t=!0,t||n){try{Fa.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&n&&this.vScroll.resize(e)}finally{Fa.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let e;null==(e=this.corner_)||e.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let e;null==(e=this.corner_)||e.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,n){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(n||void 0===n)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Lh="sep",Ph=class{load(e,t){return e=new Th(0,t.horizontalLayout?"x":"y"),new mh(e,Lh)}gapForItem(e,t){let n;return null!=(n=parseInt(String(e.gap)))?n:t}disposeItem(e){}getType(){return Lh}};t(Ha.FLYOUT_INFLATER,Lh,Ph),{SEPARATOR_TYPE:Lh}.SeparatorFlyoutInflater=Ph;var Mh=class extends fh{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Mf(e),this.workspace_.setMetricsManager(new _h(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new Oh(this)),this.id=E(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=le(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=le(hc.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new Rh(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(g(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(g(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:oc.ComponentWeight.FLYOUT_WEIGHT,capabilities:[oc.Capability.AUTOHIDEABLE,oc.Capability.DELETE_AREA,oc.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)y(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&he(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){const t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e,t;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(t=this.workspace_.scrollbar)||t.setContainerVisible(e)}positionAt_(e,t,n,i){let r,s;null==(r=this.svgGroup_)||r.setAttribute("width",`${e}`),null==(s=this.svgGroup_)||s.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&me(this.svgGroup_,"translate("+n+"px,"+i+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(n,i),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null))}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=dt(e),e=this.createFlyoutInfo(e),Pt(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=e=>{e.type!==al.BLOCK_CHANGE&&e.type!==al.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){const t=[],n=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const i of e)"custom"in i&&(e=this.getDynamicCategoryContents(i.custom),e=dt(e),t.push(...this.createFlyoutInfo(e))),e=i.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(t.push(e.load(i,this)),(e=e.gapForItem(i,n))&&t.push(new mh(new Th(e,this.horizontalLayout?"x":"y"),Lh)));return this.normalizeSeparators(t)}normalizeSeparators(e){for(let t=e.length-1;t>0;t--){const n=e[t].getType().toLowerCase(),i=e[t-1].getType().toLowerCase();n===Lh&&i===Lh&&e.splice(t-1,1)}return e}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){let e;this.getContents().forEach(e=>{let t;null==(t=this.getInflaterForType(e.getType()))||t.disposeItem(e)}),null==(e=this.workspace_.getPotentialVariableMap())||e.clear()}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let t=null;Fa.disable$$module$build$src$core$events$utils();var n=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{Fa.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=bn(this.targetWorkspace,n),ne()){for(Fa.setGroup$$module$build$src$core$events$utils(!0),n=0;n<e.length;n++){const t=e[n];Y(new(oe(al.VAR_CREATE))(t))}Y(new(oe(al.BLOCK_CREATE))(t))}return this.autoClose&&this.hide(),t}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const n=this.serializeBlock(e);return t.setResizesEnabled(!1),t=Dn(n,t),this.positionNewBlock(e,t),t}serializeBlock(e){return kn(e)}positionNewBlock(e,t){const n=this.targetWorkspace;var i=n.getOriginOffsetInPixels(),r=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),r=pc.sum(r,e),(i=pc.difference(r,i)).scale(1/n.scale),t.moveTo(new pc(i.x,i.y))}getInflaterForType(e){var t;return this.inflaters.has(e)?null!=(t=this.inflaters.get(e))?t:null:(t=o(Ha.FLYOUT_INFLATER,e))?(t=new t,this.inflaters.set(e,t),t):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,t){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},Fh=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},Bh=new Fh,$h={};$h.KeyboardNavigationController=Fh,$h.keyboardNavigationController=Bh;var Uh=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new pc(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=pc.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},Vh=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new pc(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new pc(0,0)}dispose(){p(),$i(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)y(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new pc(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),d()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=pc.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=pc.magnitude(this.currentDragDeltaXY)>(this.flyout?Fa.config$$module$build$src$core$config.flyoutDragRadius:Fa.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Fa.getGroup$$module$build$src$core$events$utils()||Fa.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),0))}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new Uh(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const t=De();t&&Zs(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(c(Ha.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,b(e)?this.cancel():(this.gestureHasStarted=!0,Us(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Xn(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,Bi(),v(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&u(e,this),this.mouseDownXY=new pc(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(g(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(g(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(g(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&d())}handleMove(e){this.isDragging()&&h(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),d())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!h(e))return;if(this.updateFromEvent(e),d(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(Bh.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(Bh.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=f(e);this.cachedPoints.set(t,this.getTouchPoint(e));var n=Array.from(this.cachedPoints.keys());2===n.length&&(t=this.cachedPoints.get(n[0]),n=this.cachedPoints.get(n[1]),this.startDistance=pc.distance(t,n),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){const t=f(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),n=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),n=pc.distance(n,t)/this.startDistance,this.previousScale>0&&this.previousScale<1/0){if(t=(t=n-this.previousScale)>0?5*t:6*t,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const i=this.startWorkspace_,r=T(e,i.getParentSvg(),i.getInverseScreenCTM());i.zoom(r.x,r.y,t)}this.previousScale=n,e.preventDefault()}handleTouchEnd(e){e=f(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new pc(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(d(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),Bh.setIsActive(!1),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),this.doStart(e)}fireWorkspaceClick(e){Y(new(oe(al.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.flyout.isBlockCreatable(this.targetBlock)){Fa.getGroup$$module$build$src$core$events$utils()||Fa.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours(),Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(oe(al.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),Y(e)}this.bringBlockToFront(),Fa.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}getCurrentDragger(){let e,t;return null!=(t=null!=(e=this.workspaceDragger)?e:this.dragger)?t:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const e=Ce();for(let t,n=0;t=e[n];n++)if(t.currentGesture_)return!0;return!1}},Hh=class{constructor(e,t){let n,i,r;this.pattern=e,this.scale=1,this.spacing=null!=(n=t.spacing)?n:0,this.length=null!=(i=t.length)?i:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(r=t.snap)&&r}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`);let n=(t=Math.floor(this.spacing/2)+.5)-this.length/2,i=t+this.length/2;t*=e,n*=e,i*=e,this.setLineAttributes(this.line1,e,n,i,t,t),this.setLineAttributes(this.line2,e,t,t,n,i)}setLineAttributes(e,t,n,i,r,s){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${n}`),e.setAttribute("y1",`${r}`),e.setAttribute("x2",`${i}`),e.setAttribute("y2",`${s}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}alignXY(e){var t=this.getSpacing();const n=t/2,i=Math.round(Math.round((e.x-n)/t)*t+n);return t=Math.round(Math.round((e.y-n)/t)*t+n),i===e.x&&t===e.y?e:new pc(i,t)}static createDom(e,t,n,i){let r,s;if(e=le(hc.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},n),(null!=(r=t.length)?r:1)>0&&(null!=(s=t.spacing)?s:0)>0){let n;le(hc.LINE,{stroke:t.colour},e),null!=(n=t.length)&&n&&le(hc.LINE,{stroke:t.colour},e)}else le(hc.LINE,{},e);return i&&i.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},Gh=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(ep),ce(e,"blocklyBlockCanvas"),e=this.createLayer(tp),ce(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=le(hc.SVG,{class:"blocklyBlockDragSurface",xmlns:Ll,"xmlns:html":Pl,"xmlns:xlink":Ml,version:"1.1"});return e.append(t),le(hc.G,{},t)}createAnimationLayer(e){const t=le(hc.SVG,{class:"blocklyAnimationLayer",xmlns:Ll,"xmlns:html":Pl,"xmlns:xlink":Ml,version:"1.1"});return e.append(t),le(hc.G,{},t)}appendToAnimationLayer(e){let t;const n=null==(t=this.dragLayer)?void 0:t.getAttribute("transform");if(n){let e;null==(e=this.animationLayer)||e.setAttribute("transform",n)}let i;null==(i=this.animationLayer)||i.appendChild(e.getSvgRoot())}translateLayers(e,t){let n;e=`translate(${e.x}, ${e.y}) scale(${t})`,null==(n=this.dragLayer)||n.setAttribute("transform",e);for(const[,t]of this.layers)t.setAttribute("transform",e)}moveToDragLayer(e){let t;null==(t=this.dragLayer)||t.appendChild(e.getSvgRoot()),e.canBeFocused()&&Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,t){this.append(e,t),e.canBeFocused()&&Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,t){let n;if(this.layers.has(t)||this.createLayer(t),e=e.getSvgRoot(),(null==(n=this.layers.get(t))?void 0:n.lastChild)!==e){let n;null==(n=this.layers.get(t))||n.appendChild(e)}}createLayer(e){const t=this.workspace.getSvgGroup(),n=le(hc.G,{});let i=!1;const r=[...this.layers].sort((e,t)=>e[0]-t[0]);for(const[s,o]of r)if(e<s){t.insertBefore(n,o),i=!0;break}return i||t.appendChild(n),this.layers.set(e,n),n}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(ep)}getBubbleLayer(){return this.layers.get(tp)}},jh=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof ph?e:e instanceof Pd||e instanceof Jp?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},Kh=class extends jh{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,e=>{let t;return e instanceof ph&&!(null!=(t=e.outputConnection)&&t.targetBlock())||e instanceof mp},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,e=>{let t;return e instanceof ph&&!(null!=(t=e.outputConnection)&&t.targetBlock())||e instanceof mp},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();return!!e&&this.getNextNode(e,()=>!0,!0)===(e=this.getNextNode(e,e=>{let t;return e instanceof ph&&!(null!=(t=e.outputConnection)&&t.targetBlock())},!0))}getNextNodeImpl(e,t,n=new Set){if(!e||n.has(e))return null;let i=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var r=e;r&&!i&&(r=this.workspace.getNavigator().getParent(r));)i=this.workspace.getNavigator().getNextSibling(r);return t(i)?i:i?(n.add(e),this.getNextNodeImpl(i,t,n)):null}getNextNode(e,t,n){return!e||!n&&this.getLastNode()===e?null:this.getNextNodeImpl(e,t)}getPreviousNodeImpl(e,t,n=new Set){if(!e||n.has(e))return null;const i=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e);return t(i)?i:i?(n.add(e),this.getPreviousNodeImpl(i,t,n)):null}getPreviousNode(e,t,n){return!e||!n&&this.getFirstNode()===e?null:this.getPreviousNodeImpl(e,t)}getRightMostChild(e,t){if(!e)return e;let n=this.workspace.getNavigator().getFirstChild(e);if(!n||n===t)return e;for(e=n;e&&e!==t;e=this.workspace.getNavigator().getNextSibling(n))n=e;return this.getRightMostChild(n,t)}preDelete(e){var t,n=this.getCurNode();let i,r;n=n?[n]:[];const s=null!=(r=null==(t=e.previousConnection)?void 0:t.targetConnection)?r:null==(i=e.outputConnection)?void 0:i.targetConnection;s&&n.push(s),(t=e.getNextBlock())&&n.push(t),(e=e.getParent())&&n.push(e),n.push(this.workspace),this.potentialNodes=n}postDelete(){const e=this.potentialNodes;if(this.potentialNodes=null,!e)throw Error("must call preDelete first");for(const t of e){let e;if(null==(e=this.getSourceBlockFromNode(t))||!e.disposed)return void this.setCurNode(t)}throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return Fa.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(e){Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e instanceof ph?e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof Pd?(e=e.getSourceBlock()).workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof mp&&e.workspace.scrollBoundsIntoView(e.getBoundingRectangle())}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){const e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}};t(Ha.CURSOR,Va,Kh);var zh=class{constructor(e){this.workspace=e,this.markers=new Map,this.cursor=new Kh(this.workspace)}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){const e=Object.keys(this.markers);for(let t,n=0;t=e[n];n++)this.unregisterMarker(t);this.markers.clear(),this.cursor.dispose()}};zh.LOCAL_MARKER="local_marker_1";var Wh=class extends Rp{constructor(e,t,n){super(e,t,n,Wh.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=n,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.locationChangeListeners=[],this.text="",this.DEFAULT_SIZE=new mc(160+Rp.DOUBLE_BORDER,80+Rp.DOUBLE_BORDER),this.MIN_SIZE=new mc(45+Rp.DOUBLE_BORDER,20+Rp.DOUBLE_BORDER),this.editable=!0,ce(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}static createTextArea(){const e=document.createElementNS(Pl,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){e=le(hc.FOREIGNOBJECT,{x:Rp.BORDER_WIDTH,y:Rp.BORDER_WIDTH},e);const n=document.createElementNS(Pl,"body");return n.setAttribute("xmlns",Pl),n.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),n.appendChild(t),e.appendChild(n),this.bindTextAreaEvents(t),e}bindTextAreaEvents(e){g(e,"wheel",this,e=>{e.stopPropagation()}),g(e,"pointerdown",this,e=>{e.stopPropagation(),p()}),g(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return e=le(hc.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),g(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const n=e.width-Rp.DOUBLE_BORDER,i=e.height-Rp.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${n}`),this.inputRoot.setAttribute("height",`${i}`),this.resizeGroup.setAttribute("y",`${i}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",""+-Rp.DOUBLE_BORDER):this.resizeGroup.setAttribute("x",`${n}`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,t){super.setPositionRelativeToAnchor(e,t),this.onLocationChange()}positionByRect(e=new fc(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),v(e)||(Ar(this.workspace,e,new pc(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=g(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=g(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){p(),this.resizePointerUpListener&&(y(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(y(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=Nr(this.workspace,e),this.setSize(new mc(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}onLocationChange(){for(const e of this.locationChangeListeners)e()}};Ge("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n");var qh={};qh.register=eo,qh.unregister=to;var Jh=class extends Pp{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new mc(160,80),this.bubbleVisiblity=!1}getType(){return Jh.TYPE}initView(e){this.svgRoot||(super.initView(e),le(hc.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),le(hc.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),le(hc.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),ce(this.svgRoot,"blocklyCommentIcon"))}dispose(){let e;super.dispose(),null==(e=this.textInputBubble)||e.dispose()}getWeight(){return Jh.WEIGHT}getSize(){return new mc(17,17)}applyColour(){super.applyColour();const e=this.sourceBlock.getColour();let t;null==(t=this.textInputBubble)||t.setColour(e)}updateEditable(){const e=this,t=()=>super.updateEditable;return(0,Ma.asyncExecutePromiseGeneratorFunction)(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){const t=this.workspaceLocation;let n;super.onLocationChange(e),this.bubbleLocation&&(e=pc.difference(this.workspaceLocation,t),this.bubbleLocation=pc.sum(this.bubbleLocation,e)),e=this.getAnchorLocation(),null==(n=this.textInputBubble)||n.setAnchorLocation(e)}setText(e){const t=this.text;let n;Y(new(oe(al.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e,null==(n=this.textInputBubble)||n.setText(this.text)}getText(){return this.text}setBubbleSize(e){let t;this.bubbleSize=e,null==(t=this.textInputBubble)||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){let t;this.bubbleLocation=e,null==(t=this.textInputBubble)||t.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){if(this.text){const e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},t=this.getBubbleLocation();return t&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(t.x+this.bubbleSize.width):t.x,e.y=t.y),e}return null}loadState(e){let t,n,i,r;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new mc(null!=(n=e.width)?n:160,null!=(i=e.height)?i:80),this.bubbleVisiblity=null!=(r=e.pinned)&&r,this.setBubbleVisible(this.bubbleVisiblity);let s=e.x;const o=e.y;Lt().then(()=>{s&&o&&(s=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(s+this.bubbleSize.width):s,this.setBubbleLocation(new pc(s,o)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(Y(new(oe(al.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){const t=this;return(0,Ma.asyncExecutePromiseGeneratorFunction)(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield Lt(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),Y(new(oe(al.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){let e,t;this.createBubble(),null==(e=this.textInputBubble)||e.addTextChangeListener(()=>this.onTextChange()),null==(t=this.textInputBubble)||t.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){let e;this.createBubble(),null==(e=this.textInputBubble)||e.setEditable(!1)}createBubble(){this.textInputBubble=new Wh(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){let e;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null}getAnchorLocation(){return pc.sum(this.workspaceLocation,new pc(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};Jh.TYPE=Gu.COMMENT,Jh.WEIGHT=3,eo(Jh.TYPE,Jh);var Yh={};Yh.CommentIcon=Jh,Yh.Icon=Pp,Yh.IconType=Gu,Yh.MutatorIcon=Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon,Yh.WarningIcon=dh,Yh.exceptions=jp,Yh.registry=qh,Fa.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=Fa.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),Fa.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let n=e;t===Fa.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(n=e),e=n.toLowerCase();const i=t===Fa.NameType$$module$build$src$core$names.VARIABLE||t===Fa.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const r=this.db.get(t);return r.has(e)?i+r.get(e):(t=this.getDistinctName(n,t),r.set(e,t.substr(i.length)),t)}getUserNames(e){let t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let n,i,r,s=null;for(;this.dbReverse.has(e+(null!=(n=s)?n:""))||this.reservedWords.has(e+(null!=(i=s)?i:""));)s=s?s+1:2;return e+=null!=(r=s)?r:"",this.dbReverse.add(e),(t===Fa.NameType$$module$build$src$core$names.VARIABLE||t===Fa.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=Fa.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){(e=e.NameType||(e.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(Fa.Names$$module$build$src$core$names||(Fa.Names$$module$build$src$core$names={})),Fa.NameType$$module$build$src$core$names=Fa.Names$$module$build$src$core$names.NameType,Fa.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=Fa.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:Fa.NameType$$module$build$src$core$names}.Names=Fa.Names$$module$build$src$core$names;var Xh,Zh,Qh=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t||(super.set(e,t),io(t)&&t.startPublishing()),this}delete(e){const t=this.get(e);return(e=super.delete(e))?(io(t)&&t.stopPublishing(),e):e}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}};Xh="PROCEDURE",Fa.DEFAULT_ARG$$module$build$src$core$procedures="x",(Zh={CATEGORY_NAME:Xh,DEFAULT_ARG:Fa.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Qh,Zh.allProcedures=ro,Zh.findLegalName=Fa.findLegalName$$module$build$src$core$procedures,Zh.flyoutCategory=uo,Zh.getCallers=mo,Zh.getDefinition=Fa.getDefinition$$module$build$src$core$procedures,Zh.internalFlyoutCategory=co,Zh.isNameUsed=ao,Zh.isProcedureBlock=no,Zh.mutateCallers=Fa.mutateCallers$$module$build$src$core$procedures,Zh.mutatorOpenListener=ho,Zh.rename=Fa.rename$$module$build$src$core$procedures;var ef=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return(e.type&this.FIELD)>=1}isHat(e){return(e.type&this.HAT)>=1}isIcon(e){return(e.type&this.ICON)>=1}isSpacer(e){return(e.type&this.SPACER)>=1}isInRowSpacer(e){return(e.type&this.IN_ROW_SPACER)>=1}isSpacerRow(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isInput(e){return(e.type&this.INPUT)>=1}isExternalInput(e){return(e.type&this.EXTERNAL_VALUE_INPUT)>=1}isInlineInput(e){return(e.type&this.INLINE_INPUT)>=1}isStatementInput(e){return(e.type&this.STATEMENT_INPUT)>=1}isPreviousConnection(e){return(e.type&this.PREVIOUS_CONNECTION)>=1}isNextConnection(e){return(e.type&this.NEXT_CONNECTION)>=1}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return(e.type&this.LEFT_ROUND_CORNER)>=1||(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.LEFT_ROUND_CORNER)>=1}isRightRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftSquareCorner(e){return(e.type&this.LEFT_SQUARE_CORNER)>=1}isRightSquareCorner(e){return(e.type&this.RIGHT_SQUARE_CORNER)>=1}isCorner(e){return(e.type&this.CORNER)>=1}isJaggedEdge(e){return(e.type&this.JAGGED_EDGE)>=1}isRow(e){return(e.type&this.ROW)>=1}isBetweenRowSpacer(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isTopRow(e){return(e.type&this.TOP_ROW)>=1}isBottomRow(e){return(e.type&this.BOTTOM_ROW)>=1}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return(e.type&this.INPUT_ROW)>=1}},tf=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=ef.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},nf=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=ef.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(ef.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(ef.isInRowSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(ef.isInRowSpacer(t))return t}return null}},rf=class extends nf{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=ef.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let i=0;i<this.elements.length;i++){const r=this.elements[i];t+=r.width,ef.isSpacer(r)||(ef.isNextConnection(r)?n=Math.max(n,r.height):e=Math.max(e,r.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},sf=class extends tf{constructor(e,t){super(e),this.connectionModel=t,this.type|=ef.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},of=class extends sf{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=ef.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},af=class extends of{constructor(e,t){super(e,t),this.height=0,this.type|=ef.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},lf=class extends tf{constructor(e,t,n){super(e),this.field=t,this.parentInput=n,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=ef.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},cf=class extends tf{constructor(e){super(e),this.type|=ef.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},uf=class extends tf{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=ef.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},df=class extends tf{constructor(e,t){super(e),this.type|=ef.SPACER|ef.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},pf=class extends of{constructor(e,t){super(e,t),this.type|=ef.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},hf=class extends nf{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=ef.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const n=this.elements[t];this.width+=n.width,ef.isInput(n)&&(ef.isStatementInput(n)?e+=n.connectedBlockWidth:ef.isExternalInput(n)&&0!==n.connectedBlockWidth&&(e+=n.connectedBlockWidth-n.connectionWidth)),ef.isSpacer(n)||(this.height=Math.max(this.height,n.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},ff=class extends tf{constructor(e){super(e),this.type|=ef.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},mf=class extends sf{constructor(e,t){super(e,t),this.type|=ef.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},gf=class extends sf{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=ef.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},_f=class extends sf{constructor(e,t){super(e,t),this.type|=ef.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},yf=class extends tf{constructor(e,t){super(e),this.type=(t&&"left"!==t?ef.RIGHT_ROUND_CORNER:ef.LEFT_ROUND_CORNER)|ef.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},bf=class extends nf{constructor(e,t,n){super(e),this.height=t,this.width=n,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=ef.SPACER|ef.BETWEEN_ROW_SPACER,this.elements=[new df(this.constants_,n)]}measure(){}},vf=class extends tf{constructor(e,t){super(e),this.type=(t&&"left"!==t?ef.RIGHT_SQUARE_CORNER:ef.LEFT_SQUARE_CORNER)|ef.CORNER,this.width=this.height=this.constants_.NO_PADDING}},Tf=class extends of{constructor(e,t){super(e,t),this.type|=ef.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},kf=class extends nf{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=ef.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,n=e.getPreviousBlock();return!!e.outputConnection||t||!!n&&n.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let i=0;i<this.elements.length;i++){const r=this.elements[i];t+=r.width,ef.isSpacer(r)||(ef.isHat(r)?n=Math.max(n,r.ascenderHeight):e=Math.max(e,r.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},xf=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=Ss(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const e in t)this.blockStyles[e]=this.validatedBlockStyle_(t[e]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=Te("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=rr(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?rr(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?rr(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Zi("#fff",e,.6)||e}generateTertiaryColour_(e){return Zi("#fff",e,.3)||e}dispose(){this.embossFilter&&he(this.embossFilter),this.disabledPattern&&he(this.disabledPattern),this.debugFilter&&he(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:ws([ks(t,e/4),ks(2*-t,e/2),ks(t,e/4)])}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:xs("c",[ks(30,-e),ks(70,-e),ks(t,0)])}}makePuzzleTab(){function e(e){const i=-(e=e?-1:1);var r=n/2;const s=r+2.5,o=r+.5,a=ks(-t,e*r);return r=ks(t,e*r),xs("c",[ks(0,e*s),ks(-t,i*o),a])+xs("s",[ks(t,2.5*i),r])}const t=this.TAB_WIDTH,n=this.TAB_HEIGHT,i=e(!0),r=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:n,pathDown:r,pathUp:i}}makeNotch(){function e(e){return ws([ks(e*i,n),ks(3*e,0),ks(e*i,-n)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,i=(t-3)/2,r=e(1),s=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:r,pathRight:s}}makeInsideCorners(){const e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:As("a","0 0,0",e,ks(-e,e)),pathBottom:As("a","0 0,0",e,ks(e,e))}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=Ss(0,e)+As("a","0 0,1",e,ks(e,-e)),n=As("a","0 0,1",e,ks(e,e)),i=As("a","0 0,1",e,ks(-e,-e));return{topLeft:t,topRight:n,bottomRight:As("a","0 0,1",e,ks(-e,e)),bottomLeft:i,rightHeight:e}}shapeFor(e){switch(e.type){case vp.INPUT_VALUE:case vp.OUTPUT_VALUE:return this.PUZZLE_TAB;case vp.PREVIOUS_STATEMENT:case vp.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,n,i){this.injectCSS_(t,n),this.defs=le(hc.DEFS,{},e),e=le(hc.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),le(hc.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=le(hc.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),le(hc.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),le(hc.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),le(hc.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=le(hc.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),le(hc.RECT,{width:10,height:10,fill:"#aaa"},e),le(hc.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),i&&(i.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),i.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),i.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){if(!this.debugFilter){const e=le(hc.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=le(hc.FECOMPONENTTRANSFER,{result:"outBlur"},e);le(hc.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),le(hc.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),le(hc.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const n=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=n:((t=document.createElement("style")).id=e,e=document.createTextNode(n),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect,`,`${e} .blocklyEditableField>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableField:not(.blocklyEditing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Ef={};Ef.ConstantProvider=xf,Ef.isDynamicShape=_o,Ef.isNotch=bo,Ef.isPuzzleTab=yo;var Sf=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=Ss(e.xPos,this.info_.startY);for(let e,n=0;e=t[n];n++)ef.isLeftRoundedCorner(e)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:ef.isRightRoundedCorner(e)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:ef.isPreviousConnection(e)?this.outlinePath_+=e.shape.pathLeft:ef.isHat(e)?this.outlinePath_+=this.constants_.START_HAT.path:ef.isSpacer(e)&&(this.outlinePath_+=Is("h",e.width));this.outlinePath_+=Is("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+Is("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const n=_o(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=Is("H",t.xPos+t.width)+n+Is("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var n=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+Is("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var i=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=Is("H",n)+t+Is("v",i)+this.constants_.INSIDE_CORNERS.pathBottom+Is("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=Is("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let n=0,i="";for(let r,s=t.length-1;r=t[s];s--)ef.isNextConnection(r)?i+=r.shape.pathRight:ef.isLeftSquareCorner(r)?i+=Is("H",e.xPos):ef.isLeftRoundedCorner(r)?i+=this.constants_.OUTSIDE_CORNERS.bottomLeft:ef.isRightRoundedCorner(r)?(i+=this.constants_.OUTSIDE_CORNERS.bottomRight,n=this.constants_.OUTSIDE_CORNERS.rightHeight):ef.isSpacer(r)&&(i+=Is("h",-1*r.width));this.outlinePath_+=Is("V",e.baseline-n),this.outlinePath_+=i}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=_o(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=Is("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e,t=0;e=this.info_.rows[t];t++)for(let t,n=0;t=e.elements[n];n++)ef.isInlineInput(t)?this.drawInlineInput_(t):(ef.isIcon(t)||ef.isField(t))&&this.layoutField_(t)}layoutField_(e){const t=e.centerline-e.height/2;let n=e.xPos;var i="";this.info_.RTL&&(n=-(n+e.width),e.flipRtl&&(n+=e.width,i="scale(-1 1)")),ef.isIcon(e)?((i=e.icon).setOffsetInBlock(new pc(n,t)),this.info_.isInsertionMarker&&i.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+n+","+t+")"+i),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,n=e.height,i=e.connectionOffsetY,r=e.connectionHeight+i;this.inlinePath_+=Es(e.xPos+e.connectionWidth,e.centerline-n/2)+Is("v",i)+e.shape.pathDown+Is("v",n-r)+Is("h",t-e.connectionWidth)+Is("v",-n)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const t of e.elements){if(!(t instanceof sf))continue;const e=this.drawConnectionHighlightPath(t);e&&(e.style.display=t.highlighted?"":"none")}}drawConnectionHighlightPath(e){const t=e.connectionModel;e=t.type===vp.INPUT_VALUE||t.type===vp.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const n=t.getSourceBlock();let i,r;return null==(r=(i=n.pathObject).addConnectionHighlight)?void 0:r.call(i,t,e,t.getOffsetInBlock(),n.RTL)}getExpressionConnectionHighlightPath(e){let t="";return _o(e.shape)?t=e.shape.pathDown(e.height):yo(e.shape)&&(t=e.shape.pathDown),e=this.constants_.TAB_OFFSET_FROM_TOP,Ss(0,-e)+Is("v",e)+t+Is("v",e)}getStatementConnectionHighlightPath(e){if(!bo(e.shape))throw Error("Statement connections should have notch shapes");const t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return Ss(-t,0)+Is("h",t)+e.shape.pathLeft+Is("h",t)}},Cf=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new gf(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new kf(this.constants_),this.bottomRow=new rf(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new hf(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let n,i=0;n=t[i];i++){const t=new uf(this.constants_,n);this.isCollapsed&&!n.isShownWhenCollapsed()||e.elements.push(t)}t=void 0;for(let n,i=0;n=this.block_.inputList[i];i++)if(n.isVisible()){this.shouldStartNewRow_(n,t)&&(this.rows.push(e),e=new hf(this.constants_),this.inputRows.push(e));for(let t,i=0;t=n.fieldRow[i];i++)e.elements.push(new lf(this.constants_,t,n));this.addInput_(n,e),t=n}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new ff(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let n=this.topRow.hasLeftSquareCorner(this.block_)?vf:yf;this.topRow.elements.push(new n(this.constants_)),t?(e=new cf(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new _f(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof th&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,n=this.topRow.hasRightSquareCorner(this.block_)?vf:yf,this.topRow.elements.push(new n(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof th?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new vf(this.constants_)):this.bottomRow.elements.push(new yf(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new mf(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new vf(this.constants_,"right")):this.bottomRow.elements.push(new yf(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new pf(this.constants_,e)),t.hasInlineInput=!0):e instanceof th?(t.elements.push(new Tf(this.constants_,e)),t.hasStatement=!0):e instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new af(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Qp||e instanceof eh)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof eh||e instanceof th||t instanceof th||(e instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Qp||t instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let e,t=0;e=this.rows[t];t++){const t=e.elements;if(e.elements=[],e.startsWithElemSpacer()&&e.elements.push(new df(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let n=0;n<t.length-1;n++){e.elements.push(t[n]);const i=this.getInRowSpacing_(t[n],t[n+1]);e.elements.push(new df(this.constants_,i))}e.elements.push(t[t.length-1]),e.endsWithElemSpacer()&&e.elements.push(new df(this.constants_,this.getInRowSpacing_(t[t.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&ef.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&ef.isInput(e)&&!t){if(ef.isExternalInput(e))return this.constants_.NO_PADDING;if(ef.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ef.isStatementInput(e))return this.constants_.NO_PADDING}return e&&ef.isLeftSquareCorner(e)&&t&&(ef.isPreviousConnection(t)||ef.isNextConnection(t))?t.notchOffset:e&&ef.isLeftRoundedCorner(e)&&t&&(ef.isPreviousConnection(t)||ef.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&ef.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,n=0;for(let r,s=0;r=this.rows[s];s++){if(r.measure(),t=Math.max(t,r.width),r.hasStatement){var i=r.getLastInput();let t,n;i=r.width-(null!=(n=null==(t=i)?void 0:t.width)?n:0),e=Math.max(e,i)}n=Math.max(n,r.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let e,t=0;e=this.rows[t];t++)e.hasStatement&&(e.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,n),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t,n=0;t=this.rows[n];n++)if(t.hasStatement)this.alignStatementRow_(t);else{var e=t.width;(e=this.getDesiredRowWidth_(t)-e)>0&&this.addAlignmentPadding_(t,e),ef.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const n=e.getFirstSpacer(),i=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===Fa.Align$$module$build$src$core$inputs$align.LEFT&&i)i.width+=t;else if(e.align===Fa.Align$$module$build$src$core$inputs$align.CENTRE&&n&&i)n.width+=t/2,i.width+=t/2;else if(e.align===Fa.Align$$module$build$src$core$inputs$align.RIGHT&&n)n.width+=t;else{if(!i)return;i.width+=t}e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var n=e.width-t.width,i=this.statementEdge;(n=i-n)>0&&this.addAlignmentPadding_(e,n),n=e.width,i=this.getDesiredRowWidth_(e),t.width+=i-n,t.height=Math.max(t.height,e.height),e.width+=i-n,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var n=this.getSpacerRowHeight_(e,t);const i=this.getSpacerRowWidth_(e,t);return n=new bf(this.constants_,n,i),e.hasStatement&&(n.followsStatement=!0),t.hasStatement&&(n.precedesStatement=!0),n}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return ef.isSpacer(t)?e.yPos+t.height/2:ef.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,ef.isNextConnection(t)?e+t.height/2:e-t.height/2):ef.isTopRow(e)?ef.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let n,i=0;n=e.elements[i];i++)ef.isSpacer(n)&&(n.height=e.height),n.xPos=t,n.centerline=this.getElemCenterline_(e,n),t+=n.width}finalize_(){let e=0,t=0;for(let n,i=0;n=this.rows[i];i++)n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks),this.recordElemPositions_(n);if(this.outputConnection&&this.block_.nextConnection){const t=this.block_.nextConnection.targetBlock();t&&(e=Math.max(e,t.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if((null==(t=this.outputConnection)?void 0:t.connectionModel)===e)return this.outputConnection;for(const t of this.rows)for(const n of t.elements)if(n instanceof sf&&n.connectionModel===e)return n;return null}},wf=class{constructor(e,t,n){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=n,this.style=t,this.svgRoot=e,this.svgPath=le(hc.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?ce(this.svgRoot,e):de(this.svgRoot,e))}updateHighlighted(e){e?this.setClass_("blocklyHighlighted",!0):this.setClass_("blocklyHighlighted",!1)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,n,i){return n=`translate(${n.x}, ${n.y})`+(i?" scale(-1 1)":""),(i=this.connectionHighlights.get(e))?(i.setAttribute("d",t),i.setAttribute("transform",n),i):(t=le(hc.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:t,transform:n},this.svgRoot),this.connectionHighlights.set(e,t),t)}removeConnectionHighlight(e){const t=this.connectionHighlights.get(e);t&&(he(t),this.connectionHighlights.delete(e))}},If=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t,n){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName(),n)}refreshDom(e,t,n){const i=this.getConstants();i.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=i.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t,n)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new xf}makeRenderInfo_(e){return new Cf(this,e)}makeDrawer_(e,t){return new Sf(e,t)}makePathObject(e,t){return new wf(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,n){return!!Hp.getConnectionForOrphanedConnection(e,n===vp.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},Af={};Af.BottomRow=rf,Af.Connection=sf,Af.ConstantProvider=xf,Af.Drawer=Sf,Af.ExternalValueInput=af,Af.Field=lf,Af.Hat=cf,Af.Icon=uf,Af.InRowSpacer=df,Af.InlineInput=pf,Af.InputConnection=of,Af.InputRow=hf,Af.JaggedEdge=ff,Af.Measurable=tf,Af.NextConnection=mf,Af.OutputConnection=gf,Af.PathObject=wf,Af.PreviousConnection=_f,Af.RenderInfo=Cf,Af.Renderer=If,Af.RoundCorner=yf,Af.Row=nf,Af.SpacerRow=bf,Af.SquareCorner=vf,Af.StatementInput=Tf,Af.TopRow=kf,Af.Types=ef,Af.init=ko,Af.register=vo,Af.unregister=To;var Nf=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&de(e,t),(t=this.theme.getClassName())&&ce(e,t));for(let e,t=0;e=this.subscribedWorkspaces[t];t++)e.refreshTheme();for(const[n,i]of this.componentDB)for(const r of i){e=r.element,t=r.propertyName;const i=this.theme&&this.theme.getComponentStyle(n);e.style.setProperty(t,i||"")}for(const e of this.subscribedWorkspaces)e.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!He(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,n){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:n}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(n,t||"")}unsubscribe(e){if(e)for(const[t,n]of this.componentDB){for(let t=n.length-1;t>=0;t--)n[t].element===e&&n.splice(t,1);n.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},Df="VARIABLE_DYNAMIC",Of={CATEGORY_NAME:Df};Of.flyoutCategory=wo,Of.flyoutCategoryBlocks=Ao,Of.internalFlyoutCategory=Co,Of.onCreateVariableButtonClick_Colour=So,Of.onCreateVariableButtonClick_Number=Eo,Of.onCreateVariableButtonClick_String=xo;var Rf=class{canConnect(e,t,n,i){return this.canConnectWithReason(e,t,n,i)===Hp.CAN_CONNECT}canConnectWithReason(e,t,n,i){const r=this.doSafetyChecks(e,t);return r!==Hp.CAN_CONNECT?r:this.doTypeChecks(e,t)?n&&!this.doDragChecks(e,t,i||0)?Hp.REASON_DRAG_CHECKS_FAILED:Hp.CAN_CONNECT:Hp.REASON_CHECKS_FAILED}getErrorMessage(e,t,n){switch(e){case Hp.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Hp.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Hp.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Hp.REASON_TARGET_NULL:return"Target connection is null.";case Hp.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+n.getCheck();case Hp.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Hp.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Hp.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return Hp.REASON_TARGET_NULL;let n,i,r;return e.isSuperior()?(n=e.getSourceBlock(),i=t.getSourceBlock(),r=t):(i=e.getSourceBlock(),n=t.getSourceBlock(),r=e,e=t),n===i?Hp.REASON_SELF_CONNECTION:r.type!==zp[e.type]?Hp.REASON_WRONG_TYPE:n.workspace!==i.workspace?Hp.REASON_DIFFERENT_WORKSPACES:n.isShadow()&&!i.isShadow()?Hp.REASON_SHADOW_PARENT:r.type===vp.OUTPUT_VALUE&&i.previousConnection&&i.previousConnection.isConnected()||r.type===vp.PREVIOUS_STATEMENT&&i.outputConnection&&i.outputConnection.isConnected()?Hp.REASON_PREVIOUS_AND_OUTPUT:Hp.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let n=0;n<e.length;n++)if(t.includes(e[n]))return!0;return!1}doDragChecks(e,t,n){if(e.distanceFrom(t)>n||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case vp.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case vp.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case vp.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case vp.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!Yl.includes(t)}canConnectToPrevious_(e,t){return!(e.targetConnection||Yl.includes(t)||t.targetConnection&&(!(e=t.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))}};t(Ha.CONNECTION_CHECKER,Va,Rf);var Lf=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Qh,this.readOnly=!1,this.potentialVariableMap=null,this.id=E(),we(this),this.options=e||new Dp({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(c(Ha.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),Ie(this)}sortObjects(e,t){const n=e=>({getBoundingRectangle:()=>{const t=e.getRelativeToSurfaceXY();return new fc(t.y,t.y,t.x,t.x)},moveBy:()=>{}});return this.sortByOrigin(n(e),n(t))}sortByOrigin(e,t){const n=Math.sin(zn(Lf.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getBoundingRectangle().getOrigin(),t=t.getBoundingRectangle().getOrigin(),e.y+n*e.x-(t.y+n*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!He(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const t=[].concat(this.topBlocks);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){He(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&e.length>1&&e.sort(this.sortObjects.bind(this)),e.filter(e=>!e.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!He(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const t=[].concat(this.topComments);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let n=0;n<t.length;n++)e.push(...t[n].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter(e=>!e.isInsertionMarker())}clear(){this.isClearing=!0;try{const e=Fa.getGroup$$module$build$src$core$events$utils();for(e||Fa.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();Fa.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){Qt("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,t)}createVariable(e,t,n){return Qt("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,null!=t?t:void 0,null!=n?n:void 0)}getVariableUsesById(e){return Qt("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Workspace.getVariableMap().getVariableUsesById"),Tn(this,e)}deleteVariableById(e){Qt("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");const t=this.variableMap.getVariableById(e);t?Fa.deleteVariable$$module$build$src$core$variables(this,t):console.warn(`Can't delete non-existent variable: ${e}`)}getVariable(e,t){return Qt("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,t)}getVariableById(e){return Qt("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return Qt("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(null!=e?e:"")}getAllVariables(){return Qt("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return Qt("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const n in e){if(e[n]>this.remainingCapacityOfType(n))return!1;t+=e[n]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,n=e?this.undoStack_:this.redoStack_;const i=t.pop();if(i){for(var r=[i];t.length&&i.group&&i.group===t[t.length-1].group;){const e=t.pop();e&&r.push(e)}for(t=0;t<r.length;t++)n.push(r[t]);Fa.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(n=0;n<r.length;n++)r[n].run(e)}finally{Fa.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,te()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){He(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&this.MAX_UNDO>=0;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return null!=(t=this.commentDB.get(e))?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let n=0;n<t.length;n++)if(!t[n].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return Se(e)}static getAll(){return Ce()}getVariableMapClass(){const e=c(Ha.VARIABLE_MAP,this.options,!0);if(!e)throw Error("No variable map is registered.");return e}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}};Lf.SCAN_ANGLE=3;var Pf=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var n=new globalThis.Audio}catch(e){return}for(let t=0;t<e.length;t++){const r=e[t],s=r.match(/\.(\w+)$/);if(s&&n.canPlayType("audio/"+s[1])){var i=new globalThis.Audio(r);break}}i&&this.sounds.set(t,i)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(void 0!==t?t.then(e.pause).catch(function(){}):e.pause(),pl||hl)break}}play(e,t){if(!this.muted){var n=this.sounds.get(e);n?(e=new Date,null!==this.lastSound&&e.getTime()-this.lastSound.getTime()<100||(this.lastSound=e,(n=pl||dl?n:n.cloneNode()).volume=void 0===t?1:t,n.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},Mf=class extends Lf{constructor(e){let t;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new Dh,this.metricsManager=new(c(Ha.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Mf.setTopLevelWorkspaceMetrics,this.componentManager=new oc,this.connectionDBList=kp.init(this.connectionChecker),this.audioManager=new Pf(e.parentWorkspace),this.grid=this.options.gridPattern?new Hh(this.options.gridPattern,e.gridOptions):null,this.markerManager=new zh(this),Ru&&en&&this.registerToolboxCategoryCallback(Nu,en),Of&&Co&&this.registerToolboxCategoryCallback(Df,Co),Zh&&co&&(this.registerToolboxCategoryCallback(Xh,co),this.addChangeListener(ho)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Nf(this,this.options.theme||Np),this.themeManager_.subscribeWorkspace(this),this.renderer=ko(this.options.renderer||"geras",this.getTheme(),null!=(t=this.options.rendererOverrides)?t:void 0),this.cachedParentSvgSize=new mc(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager.getMarker(e)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=Np),this.themeManager_.setTheme(e)}refreshTheme(){if(this.svgGroup_){var e=null===this.options.parentWorkspace;this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)}this.updateBlockStyles(this.getAllBlocks(!1).filter(e=>!!e.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),e=new(oe(al.THEME_CHANGE))(this.getTheme().name,this.id),Y(e)}updateBlockStyles(e){for(let t,n=0;t=e[n];n++){const e=t.getStyleName();e&&t.setStyle(e)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,n=0,i=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(i=this.scale);do{const r=et(e);e!==this.getCanvas()&&e!==this.getBubbleCanvas()||(i=1),t+=r.x*i,n+=r.y*i,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new pc(t,n)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new mc(e.width,e.height)}getOriginOffsetInPixels(){return tt(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=null!=t?t:null),this.svgGroup_=le(hc.G,{class:"blocklyWorkspace",id:this.id}),t&&Dt(this.svgGroup_,qc.LABEL,Fa.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=le(hc.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new Gh(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(g(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),g(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(c(Ha.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=c(Ha.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),Fa.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&he(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&he(e.parentNode)}this.resizeHandlerWrapper&&(y(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),Fa.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&Fa.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=Mf.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new Uc(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new Dp({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){const t=this.copyOptionsForFlyout();return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(c(Ha.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(c(Ha.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(oc.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),n=[];for(let i,r=0;i=e[r];r++){i.position(t,n);const e=i.getBoundingRectangle();e&&n.push(e)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){const e=it();pc.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const n=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,n.setAttribute("data-cached-width",`${e}`)),null!=t&&(this.cachedParentSvgSize.height=t,n.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(ne()){var e=this.scale,t=-this.scrollY,n=-this.scrollX;if(!(e===this.oldScale&&Math.abs(t-this.oldTop)<1&&Math.abs(n-this.oldLeft)<1)){var i=new(oe(al.VIEWPORT_CHANGE))(t,n,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=n,Y(i)}}}translate(e,t){let n,i;null==(n=this.layerManager)||n.translateLayers(new pc(e,t),this.scale),null==(i=this.grid)||i.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){const e=this.getAllBlocks(!1);for(let t=e.length-1;t>=0;t--)e[t].queueRender();this.getTopBlocks().flatMap(e=>e.getDescendants(!1)).filter(e=>e.isInsertionMarker()).forEach(e=>e.queueRender())}highlightBlock(e,t){if(void 0===t){for(let e,t=0;e=this.highlightedBlocks[t];t++)e.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):He(this.highlightedBlocks,e),e.setHighlighted(t))}variableChangeCallback(e){switch(e.type){case al.VAR_CREATE:case al.VAR_DELETE:case al.VAR_RENAME:case al.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){const e=this.componentManager.getComponents(oc.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t,n=0;t=e[n];n++){const e=t.getClientRect();e&&this.dragTargetAreas.push({component:t,clientRect:e})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t,n=0;t=this.dragTargetAreas[n];n++)if(t.clientRect.contains(e.clientX,e.clientY))return t.component;return null}onMouseDown(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){Ar(this,e,t)}moveDrag(e){return Nr(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(Vh.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,n=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||n){var i=k(e);if(fl)var r=e.metaKey;t&&(e.ctrlKey||r||!n)?(i=-i.y/50,t=T(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,i)):(t=this.scrollX-i.x,n=this.scrollY-i.y,e.shiftKey&&!i.x&&(t=this.scrollX-i.y,n=this.scrollY),this.scroll(t,n)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new fc(0,0,0,0);const t=e[0].getBoundingRectangle();for(let i=1;i<e.length;i++){var n=e[i];n.isInsertionMarker&&n.isInsertionMarker()||((n=n.getBoundingRectangle()).top<t.top&&(t.top=n.top),n.bottom>t.bottom&&(t.bottom=n.bottom),n.left<t.left&&(t.left=n.left),n.right>t.right&&(t.right=n.right))}return t}cleanUp(){this.setResizesEnabled(!1),Fa.setGroup$$module$build$src$core$events$utils(!0);var e=this.getTopBlocks(!0),t=e.filter(e=>e.isMovable());const n=e.filter(e=>!e.isMovable()).map(e=>e.getBoundingRectangle());e=function(e){for(const t of n)if(e.intersects(t))return t;return null};var i=0;const r=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(const n of t){for(t=n.getBoundingRectangle(),n.moveBy(-t.left,i-t.top,["cleanup"]),n.snapToGrid(),i=e(t=n.getBoundingRectangle());null!=i;)i=i.top+i.getHeight()+r,n.moveBy(0,i-t.top,["cleanup"]),n.snapToGrid(),i=e(t=n.getBoundingRectangle());i=n.getRelativeToSurfaceXY().y+n.getHeightWidth().height+r}Fa.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.isReadOnly()&&!this.isFlyout){var t=Xd.registry.getContextMenuOptions({workspace:this,focusedNode:this},e);this.configureContextMenu&&this.configureContextMenu(t,e);var n=e instanceof PointerEvent?new pc(e.clientX,e.clientY):st(this,new pc(5,5));Tr(e,t,this.RTL,this,n)}}updateToolbox(e){if(e=ct(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(pt(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(Ne(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,n){n=Math.pow(this.options.zoomOptions.scaleSpeed,n);const i=this.scale*n;if(this.scale!==i){i>this.options.zoomOptions.maxScale?n=this.options.zoomOptions.maxScale/this.scale:i<this.options.zoomOptions.minScale&&(n=this.options.zoomOptions.minScale/this.scale);var r=this.getCanvas().getCTM(),s=this.getParentSvg().createSVGPoint();s.x=e,s.y=t,e=(s=s.matrixTransform(r.inverse())).x,t=s.y,r=r.translate(e*(1-n),t*(1-n)).scale(n),this.scrollX=r.e,this.scrollY=r.f,this.setScale(i)}}zoomCenter(e){var t=this.getMetrics();let n;this.flyout?(n=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(n=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(n,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var n=this.getBlocksBoundingBox(),i=n.right-n.left+40;if(n=n.bottom-n.top+40,i){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),n+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),i+=this.flyout.getWidth()/this.scale)),t/=i,e/=n,Fa.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{Fa.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){ce(this.getCanvas(),"blocklyCanvasTransitioning"),ce(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){de(this.getCanvas(),"blocklyCanvasTransitioning"),de(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,n=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,n=-n-e.scrollTop,this.scroll(t,n)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var n=e?this.getBlockById(e):null;if(n){e=n.getRelativeToSurfaceXY(),n=t?{height:n.height,width:n.width}:n.getHeightWidth();var i=this.scale;t=(e.x+(this.RTL?-1:1)*n.width/2)*i,e=(e.y+n.height/2)*i,n=this.getMetrics(),this.scroll(-(t-n.viewWidth/2),-(e-n.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){const e=e=>{if(e.isFlyout){let t;const n=null==(t=e.targetWorkspace)?void 0:t.getFlyout();if(n instanceof Mh)return n.getFlyoutScale()}return e.getScale()},t=(n,i)=>n.options.parentWorkspace&&n.options.parentWorkspace.getSvgGroup().contains(n.getSvgGroup())?t(n.options.parentWorkspace,i*e(n)):i*e(n);return t(this,1)}scroll(e,t){this.hideChaff(!0);const n=this.getMetrics();e=Math.min(e,-n.scrollLeft),t=Math.min(t,-n.scrollTop);const i=n.scrollTop+Math.max(0,n.scrollHeight-n.viewHeight);e=Math.max(e,-(n.scrollLeft+Math.max(0,n.scrollWidth-n.viewWidth))),t=Math.max(t,-i),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+n.scrollLeft),-(t+n.scrollTop),!1),e+=n.absoluteLeft,t+=n.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getTopComments(e=!1){return super.getTopComments(e)}getCommentById(e){return super.getCommentById(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){He(this.topBoundedElements,e)}getTopBoundedElements(e=!1){const t=[].concat(this.topBoundedElements);return e&&t.sort(this.sortByOrigin.bind(this)),t}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!=typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return null!=(t=this.flyoutButtonCallbacks.get(e))?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!=typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){if(this.keyboardMoveInProgress)return e.preventDefault(),e.stopPropagation(),null;const t="pointerdown"===e.type;let n;return t&&null!=(n=this.currentGesture_)&&n.hasStarted()&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&t&&(this.currentGesture_=new Vh(e,this)),this.currentGesture_}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){Fi(),pr(this),fi(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(oc.Capability.AUTOHIDEABLE,!0).forEach(t=>t.autoHide(e))}static setTopLevelWorkspaceMetrics(e){const t=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}addClass(e){this.injectionDiv&&ce(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&de(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,t=10){if(!Vh.inProgress()){var n=this.getScale(),i=this.getMetricsManager().getViewMetrics(!0);if(i=new fc(i.top,i.top+i.height,i.left,i.left+i.width),!(e.left>=i.left&&e.top>=i.top&&e.right<=i.right&&e.bottom<=i.bottom)){(e=e.clone()).top-=t,e.bottom+=t,e.left-=t,e.right+=t;var r=t=0;e.left<i.left?t=this.RTL?Math.min(i.left-e.left,i.right-e.right):i.left-e.left:e.right>i.right&&(t=this.RTL?i.right-e.right:Math.max(i.right-e.right,i.left-e.left)),e.top<i.top?r=i.top-e.top:e.bottom>i.bottom&&(r=Math.max(i.bottom-e.bottom,i.top-e.top)),this.scroll(this.scrollX+t*n,this.scrollY+r*n)}}}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(e)return null;let t;return null!=(t=this.getTopBlocks(!0)[0])?t:null}getNestedTrees(){const e=this.getAllBlocks().map(e=>e.getIcons()).flat().filter(e=>e instanceof Fa.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()).map(e=>{let t;return null==(t=e.getBubble())?void 0:t.getWorkspace()}).filter(e=>!!e),t=this.getFlyout(!0);return t&&e.push(t.getWorkspace()),e}searchForWorkspaceComment(e){for(const t of this.getTopComments())if(t instanceof mp&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}lookUpFocusableNode(e){var t;const n=null==(t=this.targetWorkspace)?void 0:t.getFlyout();if(this.isFlyout&&n)for(var i of n.getContents())if(t=i.getElement(),ke(t)&&t.canBeFocused()&&t.getFocusableElement().id===e)return t;if(i=e.indexOf("_field_"),t=e.indexOf("_connection_"),-1!==i){var r=e.substring(0,i);if(r=this.getBlockById(r))for(var s of r.getFields())if(s.canBeFocused()&&s.getFocusableElement().id===e)return s;return null}if(-1!==t){if(r=e.substring(0,t),r=this.getBlockById(r))for(const t of r.getConnections_(!0))if(t.id===e)return t;return null}var o;if(-1!==(s=Math.max(e.indexOf(cp),e.indexOf(ap),e.indexOf(dp)))&&(s=e.substring(0,s),s=this.searchForWorkspaceComment(s)))return e.indexOf(cp)>-1?s.getEditorFocusableNode():null!=(o=s.view.getCommentBarButtons().find(t=>t.getFocusableElement().id.includes(e)))?o:null;if((o=this.getAllBlocks(!1).find(t=>t.getFocusableElement().id===e))||(o=this.searchForWorkspaceComment(e)))return o;for(r of o=this.getAllBlocks().map(e=>e.getIcons()).flat()){if(r.canBeFocused()&&r.getFocusableElement().id===e)return r;if(Kn(r)&&(o=r.getBubble())&&o.canBeFocused()&&o.getFocusableElement().id===e)return o}return null}onTreeFocus(e,t){}onTreeBlur(e){if(this.isFlyout&&this.targetWorkspace&&!Fa.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()){var t=this.targetWorkspace.getFlyout(),n=this.targetWorkspace.getToolbox();n&&e===n||(n&&n.clearSelection(),t&&Qs(t)&&t.autoHide(!1))}}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},Ff={};Ff.WorkspaceSvg=Mf,Ff.resizeSvgContents=No;var Bf=class extends ec{constructor(e){super(),this.isBlank=void 0===e,e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Bf)).varId=e.varId,t}},$f=class extends Bf{constructor(e){super(e),this.type=al.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new $f)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?t.createVariable(this.varName,this.varType,this.varId):(e=t.getVariableById(this.varId))&&t.deleteVariable(e)}};t(Ha.EVENT,al.VAR_CREATE,$f);var Uf=class{constructor(e,t,n,i){this.workspace=e,this.name=t,this.type=n||"",this.id=i||E()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){const e={name:this.getName(),id:this.getId()},t=this.getType();return t&&(e.type=t),e}static load(e,t){e=new this(t,e.name,e.type,e.id),t.getVariableMap().addVariable(e),Y(new(oe(al.VAR_CREATE))(e))}};t(Ha.VARIABLE_MODEL,Va,Uf);var Vf=class extends Bf{constructor(e){super(e),this.type=al.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Vf)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?(e=t.getVariableById(this.varId))&&t.deleteVariable(e):t.createVariable(this.varName,this.varType,this.varId)}};t(Ha.EVENT,al.VAR_DELETE,Vf);var Hf=class extends Bf{constructor(e,t){super(e),this.type=al.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=void 0===t?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Hf)).oldName=e.oldName,t.newName=e.newName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");const n=(t=t.getVariableMap()).getVariableById(this.varId);e?n&&t.renameVariable(n,this.newName):n&&t.renameVariable(n,this.oldName)}};t(Ha.EVENT,al.VAR_RENAME,Hf);var Gf=class{constructor(e,t=!1){this.workspace=e,this.potentialMap=t,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(const t of e.values())this.deleteVariable(t);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.getName()===t)return e;var n=e.getType();n=this.getVariable(t,n);const i=this.workspace.getAllBlocks(!1);let r="";this.potentialMap||(r=Fa.getGroup$$module$build$src$core$events$utils())||Fa.setGroup$$module$build$src$core$events$utils(!0);try{n&&n.getId()!==e.getId()?this.renameVariableWithConflict(e,t,n,i):this.renameVariableAndUses(e,t,i)}finally{this.potentialMap||Fa.setGroup$$module$build$src$core$events$utils(r)}return e}changeVariableType(e,t){var n;let i;return null==(n=this.variableMap.get(e.getType()))||n.delete(e.getId()),e.setType(t),(n=null!=(i=this.variableMap.get(t))?i:new Map).set(e.getId(),e),this.variableMap.has(t)||this.variableMap.set(t,n),e}renameVariableById(e,t){Qt("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");const n=this.getVariableById(e);if(!n)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(n,t)}renameVariableAndUses(e,t,n){for(this.potentialMap||Y(new(oe(al.VAR_RENAME))(e,t)),e.setName(t),t=0;t<n.length;t++)n[t].updateVarName(e)}renameVariableWithConflict(e,t,n,i){const r=e.getType();for(t!==n.getName()&&this.renameVariableAndUses(n,t,i),t=0;t<i.length;t++)i[t].renameVarById(e.getId(),n.getId());let s;this.potentialMap||Y(new(oe(al.VAR_DELETE))(e)),null==(s=this.variableMap.get(r))||s.delete(e.getId())}createVariable(e,t,n){var i=this.getVariable(e,t);if(i){if(n&&i.getId()!==n)throw Error('Variable "'+e+'" is already in use and its id is "'+i.getId()+'" which conflicts with the passed in id, "'+n+'".');return i}if(n&&this.getVariableById(n))throw Error('Variable id, "'+n+'", is already in use.');if(i=n||E(),t=t||"",!(n=a(Ha.VARIABLE_MODEL,Va,!0)))throw Error("No variable model is registered.");let r;return i=new n(this.workspace,e,t,i),(e=null!=(r=this.variableMap.get(t))?r:new Map).set(i.getId(),i),this.variableMap.has(t)||this.variableMap.set(t,e),this.potentialMap||Y(new(oe(al.VAR_CREATE))(i)),i}addVariable(e){const t=e.getType();let n;this.variableMap.has(t)||this.variableMap.set(t,new Map),null==(n=this.variableMap.get(t))||n.set(e.getId(),e)}deleteVariable(e){const t=Tn(this.workspace,e.getId());let n="";this.potentialMap||(n=Fa.getGroup$$module$build$src$core$events$utils())||Fa.setGroup$$module$build$src$core$events$utils(!0);try{for(let e=0;e<t.length;e++)t[e].dispose(!0);const n=this.variableMap.get(e.getType());n&&n.has(e.getId())&&(n.delete(e.getId()),this.potentialMap||Y(new(oe(al.VAR_DELETE))(e)),0===n.size&&this.variableMap.delete(e.getType()))}finally{this.potentialMap||Fa.setGroup$$module$build$src$core$events$utils(n)}}deleteVariableById(e){Qt("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&Fa.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(e,t){if(!(t=this.variableMap.get(t||"")))return null;let n;return null!=(n=[...t.values()].find(t=>Fa.Names$$module$build$src$core$names.equals(t.getName(),e)))?n:null}getVariableById(e){for(const t of this.variableMap.values())if(t.has(e)){let n;return null!=(n=t.get(e))?n:null}return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(...t.values());return e}getAllVariableNames(){Qt("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");const e=[];for(const t of this.variableMap.values())for(const n of t.values())e.push(n.getName());return e}getVariableUsesById(e){return Qt("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),Tn(this.workspace,e)}};t(Ha.VARIABLE_MAP,Va,Gf);var jf=class extends tc{constructor(e,t){super(t),this.type=al.TRASHCAN_OPEN,this.isOpen=e}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new jf)).isOpen=e.isOpen,t}};t(Ha.EVENT,al.TRASHCAN_OPEN,jf);var Kf=class extends fh{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===Nc.TOP?Nc.BOTTOM:Nc.TOP,this.flyout=new(c(Ha.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===Nc.RIGHT?Nc.LEFT:Nc.RIGHT,this.flyout=new(c(Ha.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=le(hc.G,{class:"blocklyTrash"});const t=String(Math.random()).substring(2);e=le(hc.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),le(hc.RECT,{width:zf,height:Wf,y:qf},e);const n=le(hc.IMAGE,{width:$c.width,x:-Zf,height:$c.height,y:-Qf,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return n.setAttributeNS(Ml,"xlink:href",this.workspace.options.pathToMedia+$c.url),e=le(hc.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),le(hc.RECT,{width:zf,height:qf},e),this.svgLid=le(hc.IMAGE,{width:$c.width,x:-Zf,height:$c.height,y:-Qf,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(Ml,"xlink:href",this.workspace.options.pathToMedia+$c.url),_(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),_(this.svgGroup,"pointerup",this,this.click),_(n,"pointerover",this,this.mouseOver),_(n,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){if(this.workspace.options.maxTrashcanContents>0){const e=this.flyout.createDom(hc.SVG);ce(e,"blocklyTrashcanFlyout"),fe(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)}this.workspace.getComponentManager().addComponent({component:this,weight:oc.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[oc.Capability.AUTOHIDEABLE,oc.Capability.DELETE_AREA,oc.Capability.DRAG_TARGET,oc.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&he(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(e){return JSON.parse(e)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let n,i;null==(n=this.flyout)||n.show(e),t.cursor="",null==(i=this.workspace.scrollbar)||i.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){var e,t;this.contentsIsOpen()&&(null==(e=this.flyout)||e.hide(),null==(t=this.workspace.scrollbar)||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var n,i,r=vt(this.workspace,e);e=bt(r,new mc(zf,Wf+qf),Yf,Jf,e,this.workspace),t=Tt(e,Jf,r.vertical===Rc.TOP?Pc.DOWN:Pc.UP,t),this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")"),null==(i=this.flyout)||i.position()}}getBoundingRectangle(){return new fc(this.top,this.top+Wf+qf,this.left,this.left+zf)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+Qf-Xf;return e=e.left+Zf-Xf,new fc(t,t+qf+Wf+2*Xf,e,e+zf+2*Xf)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=nm;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*sm),t=im+this.lidOpen*(rm-im),this.svgGroup&&(this.svgGroup.style.opacity=`${t}`),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),tm/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===Nc.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let n;null==(n=this.svgLid)||n.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:zf-4)+","+(qf-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*sm)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(oe(al.TRASHCAN_OPEN))(e,this.workspace.id),Y(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(this.workspace.options.maxTrashcanContents<=0||!C(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(em)}}}cleanBlockJson(e){return function e(t){if(t){if(delete t.id,delete t.x,delete t.y,delete t.enabled,delete t.disabledReasons,t.icons&&t.icons.comment){var n=t.icons.comment;delete n.height,delete n.width,delete n.pinned}for(var i in n=t.inputs){var r=n[i];const t=r.block;r=r.shadow,t&&e(t),r&&e(r)}t.next&&(t=(i=t.next).block,i=i.shadow,t&&e(t),i&&e(i))}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},zf=47,Wf=44,qf=16,Jf=20,Yf=20,Xf=10,Zf=0,Qf=32,em=.1,tm=80,nm=4,im=.4,rm=.8,sm=45,om=null,am=null,lm=void 0,cm={};cm.BlockPaster=oh,cm.copy=Do,cm.getLastCopiedData=Oo,cm.getLastCopiedLocation=Mo,cm.getLastCopiedWorkspace=Lo,cm.paste=Bo,cm.registry=Kc,cm.setLastCopiedData=Ro,cm.setLastCopiedLocation=Fo,cm.setLastCopiedWorkspace=Po;var um,dm={};dm.CollapseCommentBarButton=lp,dm.CommentBarButton=op,dm.CommentEditor=up,dm.CommentView=hp,dm.DeleteCommentBarButton=pp,dm.RenderedWorkspaceComment=mp,dm.WorkspaceComment=fp,function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"}(um||(um={})),Yo();var pm={};pm.names=um,pm.registerCopy=Ko,pm.registerCut=zo,pm.registerDefaultShortcuts=Yo,pm.registerDelete=Ho,pm.registerEscape=Vo,pm.registerPaste=Wo,pm.registerRedo=Jo,pm.registerUndo=qo;var hm={ProcedureSerializer:class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map(e=>Xo(e))).length?e:null}load(e,t){const n=t.getProcedureMap();for(const i of e)n.add(Zo(this.procedureModelClass,this.parameterModelClass,i,t))}clear(e){e.getProcedureMap().clear()}}};hm.loadProcedure=Zo,hm.saveProcedure=Xo;var fm=class{constructor(){this.priority=100}save(e){return(e=e.getAllVariables().map(e=>e.save())).length?e:null}load(e,t){const n=a(Ha.VARIABLE_MODEL,Va);e.forEach(e=>{null==n||n.load(e,t)})}clear(e){e.getVariableMap().clear()}};kt("variables",new fm);var mm={};mm.VariableSerializer=fm;var gm={};gm.load=ea,gm.save=Qo;var _m={blocks:Hu,exceptions:Uu,priorities:Vc,procedures:hm,registry:Hc,variables:mm,workspaceComments:jc,workspaces:gm};"Blockly"in globalThis||(globalThis.Blockly={Msg:ou});var ym="label",bm=class{load(e,t){return(e=new yh(t.getWorkspace(),t.targetWorkspace,e,!0)).show(),new mh(e,ym)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof yh&&e.dispose()}getType(){return ym}};t(Ha.FLYOUT_INFLATER,ym,bm);var vm=class extends xf{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&he(this.selectedGlowFilter),this.replacementGlowFilter&&he(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:xs("c",[ks(25,-e),ks(71,-e),ks(t,0)])}}makeHexagonal(){function e(e,n,i){var r=e/2;return Cs(-(i=i?-1:1)*(r=r>t?t:r),e=(n?-1:1)*e/2)+Cs(i*r,e)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeRounded(){function e(e,t,i){const r=e>n?e-n:0,s=i===t?"0":"1";return As("a","0 0,"+s,e=(e>n?n:e)/2,ks((i?1:-1)*e,(t?-1:1)*e))+Is("v",(t?-1:1)*r)+As("a","0 0,"+s,e,ks((i?-1:1)*e,(t?-1:1)*e))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,n=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeSquared(){function e(e,n,i){e-=2*t;const r=i===n?"0":"1";return As("a","0 0,"+r,t,ks((i?1:-1)*t,(n?-1:1)*t))+Is("v",(n?-1:1)*e)+As("a","0 0,"+r,t,ks((i?-1:1)*t,(n?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:e=>t,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case vp.INPUT_VALUE:case vp.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case vp.PREVIOUS_STATEMENT:case vp.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(e){return xs("c",[ks(e*r/2,0),ks(e*r*3/4,o/2),ks(e*r,o)])+ws([ks(e*r,s)])+xs("c",[ks(e*r/4,o/2),ks(e*r/2,o),ks(e*r,o)])+Is("h",e*i)+xs("c",[ks(e*r/2,0),ks(e*r*3/4,-o/2),ks(e*r,-o)])+ws([ks(e*r,-s)])+xs("c",[ks(e*r/4,-o/2),ks(e*r/2,-o),ks(e*r,-o)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,i=t/3,r=i/3,s=n/2,o=s/2,a=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:a,pathRight:l}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=As("a","0 0,0",e,ks(-e,e)),n=As("a","0 0,1",e,ks(-e,e));return{width:e,height:e,pathTop:t,pathBottom:As("a","0 0,0",e,ks(e,e)),rightWidth:e,rightHeight:e,pathTopRight:n,pathBottomRight:As("a","0 0,1",e,ks(e,e))}}generateSecondaryColour_(e){return Zi("#000",e,.15)||e}generateTertiaryColour_(e){return Zi("#000",e,.25)||e}createDom(e,t,n,i){super.createDom(e,t,n,i),e=le(hc.DEFS,{},e),t=le(hc.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),le(hc.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),n=le(hc.FECOMPONENTTRANSFER,{result:"outBlur"},t),le(hc.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),le(hc.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),le(hc.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=le(hc.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),le(hc.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=le(hc.FECOMPONENTTRANSFER,{result:"outBlur"},e),le(hc.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),le(hc.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),le(hc.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),le(hc.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,i&&(i.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),i.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableField>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text,`,`${e} .blocklyNonEditableField>g>text,`,`${e} .blocklyEditableField>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .blocklyMenuItem,`,`${e}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabledPattern > .blocklyOutlinePath {`,"fill: var(--blocklyDisabledPattern)","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",`${e} .blocklySelected>.blocklyPath.blocklyPathSelected {`,"fill: none;","filter: var(--blocklySelectedGlowFilter);","}",`${e} .blocklyReplaceable>.blocklyPath {`,"filter: var(--blocklyReplacementGlowFilter);","}"]}},Tm=class extends Sf{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(e.height<=0)){if(ef.isSpacer(e)){const i=e.precedesStatement;var t=e.followsStatement;if(i||t){const r=this.constants_.INSIDE_CORNERS;var n=r.rightHeight;return n=e.height-(i?n:0),t=t?r.pathBottomRight:"",e=n>0?Is("V",e.yPos+n):"",void(this.outlinePath_+=t+e+(i?r.pathTopRight:""))}}this.outlinePath_+=Is("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=Ss(e.xPos,this.info_.startY),this.outlinePath_+=Is("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=Is("V",e.baseline),this.outlinePath_+=Is("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=Es(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){const t=e.width-2*e.connectionWidth,n=e.height;return Is("h",t)+e.shape.pathRightDown(n)+Is("h",-t)+e.shape.pathUp(n)+"z"}drawStatementInput_(e){var t=e.getLastInput();const n=t.xPos+t.notchOffset+t.shape.width,i=this.constants_.INSIDE_CORNERS,r=t.shape.pathRight+Is("h",-(t.notchOffset-i.width))+i.pathTop,s=e.height-2*i.height;t=i.pathBottom+Is("h",t.notchOffset-i.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=Is("H",n)+r+Is("v",s)+t+Is("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const t=e.connectionModel;if(t.type===vp.NEXT_STATEMENT||t.type===vp.PREVIOUS_STATEMENT||t.type===vp.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=t.type===vp.INPUT_VALUE?Es(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):Es(e.width,-e.height/2)+e.shape.pathDown(e.height);const n=t.getSourceBlock();let i,r;return null==(r=(i=n.pathObject).addConnectionHighlight)?void 0:r.call(i,t,e,t.getOffsetInBlock(),n.RTL)}},km=class extends Pd{constructor(e,t,n,i,r,s,o){if(super(Pd.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",n=Number(nr(n)),t=Number(nr(t)),isNaN(n)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(n<=0||t<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new mc(t,n+km.Y_PADDING),this.imageHeight=n,"function"==typeof r&&(this.clickHandler=r),e!==Pd.SKIP_SETUP&&(o?this.configure_(o):(this.flipRtl=!!s,this.altText=nr(i)||""),this.setValue(nr(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=nr(e.alt))}initView(){this.imageElement=le(hc.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(Ml,"xlink:href",this.value_),this.fieldGroup_&&ce(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(Ml,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};km.Y_PADDING=1,rs("field_image",km),km.prototype.DEFAULT_VALUE="";var xm=class extends Pd{set size_(e){super.size_=e}get size_(){const e=super.size_;return e.width<14&&(e.width=14),e}constructor(e,t,n){super(Pd.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==Pd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new Md;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&ce(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new Md;let t;return this.fullBlockClickTarget_=!(null==(t=this.getConstants())||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&ne()&&this.value_!==e&&t&&Y(new(oe(al.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new Md;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(de(e,"blocklyInvalidInput"),Dt(e,qc.INVALID,!1)):(ce(e,"blocklyInvalidInput"),Dt(e,qc.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new Md;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1,n=!0){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(ml||dl||pl)?this.showPromptEditor():this.showInlineEditor(t,n)}showPromptEditor(){zt(Fa.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,t){const n=this.getSourceBlock();if(!n)throw new Md;lr(this,n.RTL,this.widgetDispose_.bind(this),this.workspace_,t),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new Md;Fa.setGroup$$module$build$src$core$events$utils(!0);const t=sr();var n=this.getClickTarget_();if(!n)throw Error("A click target has not been set.");ce(n,"blocklyEditing"),(n=document.createElement("input")).className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);const i=this.workspace_.getAbsoluteScale();var r=this.getConstants().FIELD_TEXT_FONTSIZE*i+"pt";return t.style.fontSize=r,n.style.fontSize=r,r=xm.BORDERRADIUS*i+"px",this.isFullBlockField()&&(r=((r=this.getScaledBBox()).bottom-r.top)/2+"px",e=e.getParent()?e.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),n.style.border=1*i+"px solid "+e,t.style.borderRadius=r,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*i+"px")),n.style.borderRadius=r,t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(n),n}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&ne()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(Y(new(oe(al.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),Fa.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=sr().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");de(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=g(e,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=g(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(y(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(y(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(e){if("Enter"===e.key)dr(this),fi();else if("Escape"===e.key)this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),dr(this),fi();else if("Tab"===e.key){e.preventDefault();var t,n=null==(t=this.workspace_)?void 0:t.getCursor();t=e=>(e instanceof xm||e instanceof ph&&e.isSimpleReporter())&&e!==this.getSourceBlock(),(e=(e=e.shiftKey?null==n?void 0:n.getPreviousNode(this,t,!1):null==n?void 0:n.getNextNode(this,t,!1))instanceof ph&&e.isSimpleReporter()?e.getFields().next().value:e)instanceof xm&&(dr(this),fi(),n=e.getSourceBlock(),e.isFullBlockField()&&n&&n instanceof ph?Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(n):Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e.showEditor())}}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&ne()&&this.value_!==e&&Y(new(oe(al.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){Lt().then(()=>{const e=this.getSourceBlock();if(!e)throw new Md;const t=sr(),n=this.getScaledBBox();t.style.width=n.right-n.left+"px",t.style.height=n.bottom-n.top+"px";const i=n.top;t.style.left=`${e.RTL?n.right-t.offsetWidth:n.left}px`,t.style.top=`${i}px`})}repositionForWindowResize(){let e;const t=null==(e=this.getSourceBlock())?void 0:e.getRootBlock();return t instanceof ph&&(js(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};xm.BORDERRADIUS=4,Fa.FieldTextInput$$module$build$src$core$field_textinput=class extends xm{constructor(e,t,n){super(e,t,n)}initView(){super.initView(),this.fieldGroup_&&ce(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return void 0===e?null:`${e}`}static fromJson(e){return new this(nr(e.text),void 0,e)}},rs("field_input",Fa.FieldTextInput$$module$build$src$core$field_textinput),Fa.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",Fa.FieldTextInput$$module$build$src$core$field_textinput;var Em=class extends rf{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Sm=class extends Tf{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},Cm=class extends tf{constructor(e){super(e),this.width=this.height=0,this.type|=ef.getType("RIGHT_CONNECTION")}},wm=class extends kf{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Im=class extends Cf{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new wm(this.constants_),this.bottomRow=new Em(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=t.statementInputCount>0,this.rightSide=this.outputConnection?new Cm(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof eh||e instanceof th||t instanceof th||(e instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Qp||e instanceof eh)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&ef.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&ef.isLeftRoundedCorner(e)&&t&&(ef.isPreviousConnection(t)||ef.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&ef.isLeftSquareCorner(e)&&t&&ef.isHat(t)||e&&ef.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(ef.isTopRow(e)&&ef.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const n=ef.isInputRow(e)&&e.hasStatement,i=ef.isInputRow(t)&&t.hasStatement;return i||n?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),i&&n?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):ef.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):ef.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const n=this.width-this.startX;return ef.isInputRow(e)&&e.hasStatement||ef.isInputRow(t)&&t.hasStatement?Math.max(n,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):n}getElemCenterline_(e,t){if(e.hasStatement&&!ef.isSpacer(t)&&!ef.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(ef.isInlineInput(t)){const n=t.connectedBlock;if(n&&n.outputConnection&&n.nextConnection)return e.yPos+n.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof Qp||e instanceof eh)&&t.hasDummyInput&&t.align===Fa.Align$$module$build$src$core$inputs$align.LEFT&&e.align===Fa.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof th)return t.elements.push(new Sm(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let n;for(let t=0;t<e.elements.length;t++){const i=e.elements[t];if(ef.isSpacer(i)&&(n=i),ef.isField(i)&&i.parentInput===this.rightAlignedDummyInputs.get(e))break}if(n)return n.width+=t,void(e.width+=t)}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let r=2;r<this.rows.length-1;r+=2){var n=this.rows[r-1];const s=this.rows[r];var i=this.rows[r+1];if(n=2===r?!!this.topRow.hasPreviousConnection:!!n.followsStatement,i=r+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!i.precedesStatement,ef.isInputRow(s)&&s.hasStatement){let n,i;s.measure(),t=s.width-(null!=(i=null==(n=s.getLastInput())?void 0:n.width)?i:0)+e}else if(n&&(2===r||i)&&ef.isInputRow(s)&&!s.hasStatement){i=s.xPos,n=null;for(let e=0;e<s.elements.length;e++){const r=s.elements[e];ef.isSpacer(r)&&(n=r),!(n&&(ef.isField(r)||ef.isInput(r))&&i<t)||ef.isField(r)&&(r.field instanceof Kp||r.field instanceof km)||(n.width+=t-i),i+=r.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,n=0;n<this.rows.length;n++){const e=this.rows[n];e.yPos=t,t+=e.height}this.height=t,n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(n),n=e.width(n),this.outputConnection.height=t,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(n),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=n,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=n,this.width+=n+e,this.widthWithChildren+=n+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var n=this.rows[t];if(!ef.isInputRow(n))continue;e=n.elements[n.elements.length-2];let i=this.getNegativeSpacing_(n.elements[1]),r=this.getNegativeSpacing_(e);e=i+r;const s=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<s&&(i=(e=this.width-s)/2,r=e/2),n.elements.unshift(new df(this.constants_,-i)),n.elements.push(new df(this.constants_,-r))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)n=this.rows[t],ef.isTopOrBottomRow(n)&&(n.elements[1].width-=e),n.width-=e,n.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var n=this.outputConnection.shape.type;const i=this.constants_;if(this.inputRows.length>1)return n===i.SHAPES.ROUND?(n=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,t-(n=this.height/2>n?n:this.height/2)*(1-Math.sin(Math.acos((n-this.constants_.SMALL_PADDING)/n)))):0;if(ef.isInlineInput(e)){const r=e.connectedBlock;return null==(e=r?r.pathObject.outputShapeType:e.shape.type)||r&&r.outputConnection&&(r.statementInputCount||r.nextConnection)||n===i.SHAPES.HEXAGONAL&&n!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][e]}return ef.isField(e)?n===i.SHAPES.ROUND&&e.field instanceof Fa.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*i.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][0]:ef.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let i=2;i<this.rows.length-1;i+=2){const r=this.rows[i-1],s=this.rows[i],o=this.rows[i+1];var e=2===i,t=i+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!o.precedesStatement;if(e?this.topRow.hasPreviousConnection:r.followsStatement){var n=s.elements[1];if(n=3===s.elements.length&&n instanceof lf&&(n.field instanceof Kp||n.field instanceof km),!e&&n)r.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING,s.height-=this.constants_.MEDIUM_PADDING;else if(e||t){if(t){for(e=!1,t=0;t<s.elements.length;t++)if(n=s.elements[t],ef.isInlineInput(n)&&n.connectedBlock&&!n.connectedBlock.isShadow()&&n.connectedBlock.getHeightWidth().height>=40){e=!0;break}e&&(r.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING)}}else r.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},Am=class extends wf{constructor(e,t,n){super(e,t,n),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=n}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.getColourTertiary());for(const e of this.outlines.values())e.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),de(this.svgPathSelected,Gl.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),de(this.svgPathSelected,Gl.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,le(hc.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,n;null==(t=this.outlines.get(e))||null==(n=t.parentNode)||n.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Nm=class extends If{constructor(e){super(e)}makeConstants_(){return new vm}makeRenderInfo_(e){return new Im(this,e)}makeDrawer_(e,t){return new Tm(e,t)}makePathObject(e,t){return new Am(e,t,this.getConstants())}getConstants(){return this.constants_}};vo("zelos",Nm);var Dm=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,n){Fa.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=n,n.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{Fa.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){Fa.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{Fa.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===vp.PREVIOUS_STATEMENT||t.type===vp.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof Nm)}previewMarker(e,t){const n=e.getSourceBlock(),i=this.createInsertionMarker(n),r=this.getMatchingConnection(n,i,e);if(!r)return null;i.queueRender(),Pt(),r.connect(t);const s={x:t.x-r.x,y:t.y-r.y},o=r.getOffsetInBlock().clone();return Lt().then(()=>{if(!i.isDeadOrDying()){Fa.disable$$module$build$src$core$events$utils();try{null==i||i.positionNearConnection(r,s,o),null==i||i.getSvgRoot().setAttribute("visibility","visible")}finally{Fa.enable$$module$build$src$core$events$utils()}}}),r}createInsertionMarker(e){const t=kn(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!t)throw Error(`Failed to serialize source block. ${e.toDevString()}`);e=Dn(t,this.workspace);for(const t of e.getDescendants(!1))t.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,t,n){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let i=0;i<e.length;i++)if(e[i]===n)return t[i];return null}hidePreview(){Fa.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{Fa.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const t=e.getSourceBlock(),n=t.outputConnection;let i;if(null!=(i=t.previousConnection)&&i.targetConnection||null!=n&&n.targetConnection)t.unplug(!0);else{let t;null==(t=e.targetBlock())||t.unplug(!1)}t.dispose()}dispose(){this.hidePreview()}};t(Ha.CONNECTION_PREVIEWER,Va,Dm);var Om={};Om.Align=Fa.Align$$module$build$src$core$inputs$align,Om.DummyInput=Qp,Om.EndRowInput=eh,Om.Input=Zp,Om.StatementInput=th,Om.ValueInput=Fa.ValueInput$$module$build$src$core$inputs$value_input,Om.inputTypes=Fa.inputTypes$$module$build$src$core$inputs$input_types;var Rm=!1;Fa.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=Ae());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let n,i=0;n=e[i];i++){let e=this.blockToCode(n);Array.isArray(e)&&(e=e[0]),e&&(n.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!n.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,n)+e),this.STATEMENT_SUFFIX&&!n.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,n))),t.push(e))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let n=0;n<e.length;n++){const i=e[n].getCommentText();i&&t.push(i)}return t.length&&t.push(""),t.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var n=this.forBlock[e.type];if("function"!=typeof n)throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(n=n.call(e,e,this),Array.isArray(n)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,n[0],t),n[1]]}if("string"==typeof n)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,e)+n),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,n,t);if(null===n)return"";throw SyntaxError("Invalid code generated: "+n)}valueToCode(e,t,n){if(isNaN(n))throw TypeError("Expecting valid order from block: "+e.type);var i=e.getInputTargetBlock(t);if(!i&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!i)return"";if(""===(t=this.blockToCode(i)))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${i.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+i.type);if(!e)return"";i=!1;var r=Math.floor(n);const s=Math.floor(t);if(r<=s&&(r!==s||0!==r&&99!==r))for(i=!0,r=0;r<this.ORDER_OVERRIDES.length;r++)if(this.ORDER_OVERRIDES[r][0]===n&&this.ORDER_OVERRIDES[r][1]===t){i=!1;break}return i&&(e="("+e+")"),e}statementToCode(e,t){const n=e.getInputTargetBlock(t);if(!n&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if("string"!=typeof(e=this.blockToCode(n)))throw TypeError("Expecting code from statement block: "+(n&&n.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const n=this.nameDB_.getDistinctName(e,Fa.NameType$$module$build$src$core$names.PROCEDURE);let i;for(this.functionNames_[e]=n,Array.isArray(t)&&(t=t.join("\n")),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);i!==t;)i=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,Fa.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,Fa.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,n){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},Fa.CodeGenerator$$module$build$src$core$generator;var Lm=class extends Mh{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),i=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(n.top+(n.height-i.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Nc.LEFT?e.width:n.width-this.getWidth():this.toolboxPosition_===Nc.LEFT?0:n.width:this.toolboxPosition_===Nc.LEFT?0:n.width+t.left-this.getWidth()}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height;var t=this.getWidth()-this.CORNER_RADIUS;this.setBackgroundPath(t,e.height-2*this.CORNER_RADIUS),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Nc.RIGHT;var i=e+this.CORNER_RADIUS;(i=["M "+(n?i:0)+",0"]).push("h",n?-e:e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("v",Math.max(0,t)),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("h",n?e:-e),i.push("z"),this.svgBackground_.setAttribute("d",i.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var t=k(e);if(t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let i;t=e.getViewMetrics().top-n.top+t.y,null==(i=this.workspace_.scrollbar)||i.setY(t),pr(this.workspace_),fi()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t=this.MARGIN;const n=this.RTL?t:t+this.tabWidth_;for(const i of e)i.getElement().moveBy(n,t),t+=i.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===Nc.LEFT?new fc(-1e9,1e9,-1e9,t+e.width):new fc(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getWidth()),0);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Tc.scrollbarThickness,this.getWidth()!==e){if(this.RTL)for(const t of this.getContents()){const n=t.getElement().getBoundingRectangle().left,i=e/this.workspace_.scale-t.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;t.getElement().moveBy(i-n,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Nc.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Lm.registryName="verticalFlyout",t(Ha.FLYOUTS_VERTICAL_TOOLBOX,Va,Lm);var Pm=class extends Mh{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),i=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(n.left+(n.width-i.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();e=e.getToolboxMetrics();const i=this.toolboxPosition_===Nc.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?i?e.height:n.height-this.getHeight():i?0:n.height:i?0:n.height+t.top-this.getHeight()}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,e=e.width-2*this.CORNER_RADIUS;var t=this.getHeight()-this.CORNER_RADIUS;this.setBackgroundPath(e,t),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Nc.TOP,i=["M 0,"+(n?0:this.CORNER_RADIUS)];n?(i.push("h",e+2*this.CORNER_RADIUS),i.push("v",t),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("h",-e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),i.push("h",e),i.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),i.push("v",t),i.push("h",-e-2*this.CORNER_RADIUS)),i.push("z"),this.svgBackground_.setAttribute("d",i.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var t=k(e);if(t=t.x||t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let i;t=e.getViewMetrics().left-n.left+t,null==(i=this.workspace_.scrollbar)||i.setX(t),pr(this.workspace_),fi()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;const t=this.MARGIN;let n=t+this.tabWidth_;this.RTL&&(e=e.reverse());for(const i of e)e=i.getElement().getBoundingRectangle(),e=this.RTL?n+e.getWidth():n,i.getElement().moveBy(e,t),n+=i.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===Nc.TOP?new fc(-1e9,t+e.height,-1e9,1e9):new fc(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getHeight()),0);e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Tc.scrollbarThickness,this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Nc.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}};t(Ha.FLYOUTS_HORIZONTAL_TOOLBOX,Va,Pm);var Mm=class extends wp{constructor(e,t,n,i,r){super(Pd.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=Mm.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new mc(0,0),e!==Pd.SKIP_SETUP&&(r?this.configure_(r):this.setTypes(n,i),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new Md;this.variable||(e=Fa.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),ce(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new Md;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var t=this.getSourceBlock();if(!t)throw new Md;const n=e.getAttribute("id"),i=e.textContent,r=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=Fa.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,n,i,r),null!==r&&r!==t.getType())throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.getType()+", and does not match variable field that references it: "+$r(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var t=this.saveLegacyState(Mm);return null!==t||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.getName(),t.type=this.variable.getType())),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new Md;this.loadLegacyState(Mm,e)||(e=Fa.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(!t)throw new Md;return(t=Fa.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.getType(),this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new Md;this.variable=Fa.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let n=0;n<t.length;n++)if(e===t[n])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){const t=this.sourceBlock_.workspace.getPotentialVariableMap();if(!t)return e;e=Array.from(new Set([...e,...t.getTypes()]))}return e}setTypes(e=null,t=""){var n=this.getText();if(Array.isArray(e)){if(0===e.length)throw Error(`'variableTypes' of field variable ${n} was an empty list. If you want to include all variable types, pass 'null' instead.`);n=!1;for(let i=0;i<e.length;i++)e[i]===t&&(n=!0);if(!n)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(null!==e)throw Error(`'variableTypes' was not an array or null in the definition of FieldVariable ${n}`);this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Wp&&this.variable)return void Fa.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===qp&&this.variable)return e=this.variable.getWorkspace(),void Fa.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_)}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(nr(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];var n=this.getSourceBlock();if(n&&!n.isDeadOrDying()){n=n.workspace;const e=this.getVariableTypes();for(let s=0;s<e.length;s++){const o=e[s],a=n.getVariableMap().getVariablesOfType(o);if(t=t.concat(a),n.isFlyout){var i=void 0,r=void 0;t=t.concat(null!=(r=null==(i=n.getPotentialVariableMap())?void 0:i.getVariablesOfType(o))?r:[])}}}for(t.sort(vn),i=[],r=0;r<t.length;r++)i[r]=[t[r].getName(),t[r].getId()];return i.push([Fa.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Wp]),Fa.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&i.push([Fa.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),qp]),i}};rs("field_variable",Mm);var Fm=class extends xm{constructor(e,t,n,i,r,s){super(Pd.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==Pd.SKIP_SETUP&&(s?this.configure_(s):this.setConstraints(t,n,i),this.setValue(e),r&&this.setValidator(r))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,n){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(n),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.includes("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const n=t.indexOf(".");this.decimalPlaces=-1===n?e?0:null:t.length-n-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e?null:(e=(e=(e=`${e}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e)?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e))}widgetCreate_(){const e=super.widgetCreate_();return this.min_>-1/0&&(e.min=`${this.min_}`,Dt(e,qc.VALUEMIN,this.min_)),this.max_<1/0&&(e.max=`${this.max_}`,Dt(e,qc.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&ce(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};rs("field_number",Fm),Fm.prototype.DEFAULT_VALUE=0;var Bm=class extends Kp{constructor(e,t,n){super(String(null!=e?e:""),t,n),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(nr(e.text),void 0,e)}};rs("field_label_serializable",Bm);var $m=class extends Pd{constructor(e,t,n){super(Pd.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=$m.CHECK_CHAR,e!==Pd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState($m);return null!==e?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();ce(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||$m.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};$m.CHECK_CHAR="",rs("field_checkbox",$m),$m.prototype.DEFAULT_VALUE=!1;var Um=class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){Fa.getGroup$$module$build$src$core$events$utils()||Fa.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),qs(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);const t=this.getRoot(this.draggable);if(this.dragTarget!==e){let n;null==(n=this.dragTarget)||n.onDragExit(t),null==e||e.onDragEnter(t)}null==e||e.onDragOver(t),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=pc.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return!(!(e=this.workspace.getDragTarget(e))||!this.workspace.getComponentManager().hasCapability(e.id,oc.Capability.DELETE_AREA))&&e.wouldDelete(t)}onDragEnd(e){const t=Fa.getGroup$$module$build$src$core$events$utils();var n=this.workspace.getDragTarget(e);const i=this.getRoot(this.draggable);if(n){let e;null==(e=this.dragTarget)||e.onDrop(i)}this.shouldReturnToStart(e,i)&&this.draggable.revertDrag(),(n=qs(i)&&this.wouldDeleteDraggable(e,i))&&this.draggable instanceof ph&&Ps(this.draggable.getRootBlock()),this.draggable.endDrag(e),n&&qs(i)&&(Fa.setGroup$$module$build$src$core$events$utils(t),i.dispose()),Fa.setGroup$$module$build$src$core$events$utils(!1),!n&&ke(this.draggable)&&Fa.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof ph?e.getRootBlock():e}shouldReturnToStart(e,t){return!!(e=this.workspace.getDragTarget(e))&&e.shouldPreventMove(t)}pixelsToWorkspaceUnits(e){return e=new pc(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};t(Ha.BLOCK_DRAGGER,Va,Um);var Vm={};Vm.BlockDragStrategy=ch,Vm.BubbleDragStrategy=Op,Vm.CommentDragStrategy=ip,Vm.Dragger=Um;var Hm=class extends tc{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type=al.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=n)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Hm)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};t(Ha.EVENT,al.BLOCK_DRAG,Hm);var Gm=class extends ju{constructor(e,t,n,i){super(e),this.type=al.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=n,this.newValue=i)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Gm)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};t(Ha.EVENT,al.BLOCK_FIELD_INTERMEDIATE_CHANGE,Gm);var jm=class extends ju{constructor(e){super(e),this.type=al.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new jm)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(n=e.oldCoordinate.split(","),t.oldCoordinate=new pc(Number(n[0]),Number(n[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(n=e.newCoordinate.split(","),t.newCoordinate=new pc(Number(n[0]),Number(n[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const n=t.getParent();return n?(e.parentId=n.id,(t=n.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&pc.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var n=t.getBlockById(this.blockId);if(n){var i=e?this.newParentId:this.oldParentId,r=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,i){var s=t.getBlockById(i);if(!s)return void console.warn("Can't connect to non-existent block: "+i)}if(n.getParent()&&n.unplug(),e)r=n.getRelativeToSurfaceXY(),n.moveBy(e.x-r.x,e.y-r.y,this.reason);else{let e,i;(!(t=n.outputConnection)||n.previousConnection&&n.previousConnection.isConnected())&&(t=n.previousConnection),n=null==(i=t)?void 0:i.type,r?(n=s.getInput(r))&&(e=n.connection):n===vp.PREVIOUS_STATEMENT&&(e=s.nextConnection),e&&t?t.connect(e):console.warn("Can't connect to non-existent input: "+r)}}else console.warn("Can't move non-existent block: "+this.blockId)}};t(Ha.EVENT,al.BLOCK_MOVE,jm);var Km,zm=class extends tc{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type=al.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=n)}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new zm)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}};!function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"}(Km||(Km={})),t(Ha.EVENT,al.BUBBLE_OPEN,zm);var Wm={};Wm.BubbleOpen=zm,Wm.BubbleType=Km;var qm=class extends ec{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=Fa.getGroup$$module$build$src$core$events$utils(),this.recordUndo=J())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new qm)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){const n=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");St(e.json,n)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=n.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},Jm=class extends qm{constructor(e,t,n){super(e),this.type=al.COMMENT_CHANGE,e&&(this.oldContents_=void 0===t?"":t,this.newContents_=void 0===n?"":n)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Jm)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var n=e?this.newContents_:this.oldContents_;if(void 0===n){if(e)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}t.setText(n)}else console.warn("Can't change non-existent comment: "+this.commentId)}};t(Ha.EVENT,al.COMMENT_CHANGE,Jm);var Ym=class extends qm{constructor(e,t){super(e),this.newCollapsed=t,this.type=al.COMMENT_COLLAPSE}toJson(){const e=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ym)).newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};t(Ha.EVENT,al.COMMENT_COLLAPSE,Ym);var Xm=class extends qm{constructor(e){super(e),this.type=al.COMMENT_CREATE,e&&(this.xml=Or(e),this.json=Et(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=$r(this.xml),e.json=this.json,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Xm)).xml=Fa.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){qm.CommentCreateDeleteHelper(this,e)}};t(Ha.EVENT,al.COMMENT_CREATE,Xm);var Zm=class extends qm{constructor(e){super(e),this.type=al.COMMENT_DELETE,e&&(this.xml=Or(e),this.json=Et(e,{addCoordinates:!0}))}run(e){qm.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=$r(this.xml),e.json=this.json,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Zm)).xml=Fa.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}};t(Ha.EVENT,al.COMMENT_DELETE,Zm);var Qm=class extends tc{constructor(e,t){super(e?e.workspace.id:void 0),this.type=al.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Qm)).isStart=e.isStart,t.commentId=e.commentId,t}};t(Ha.EVENT,al.COMMENT_DRAG,Qm);var eg=class extends qm{constructor(e){super(e),this.type=al.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,n){return t=super.fromJson(e,t,null!=n?n:new eg),n=e.oldCoordinate.split(","),t.oldCoordinate_=new pc(Number(n[0]),Number(n[1])),n=e.newCoordinate.split(","),t.newCoordinate_=new pc(Number(n[0]),Number(n[1])),t}isNull(){return pc.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};t(Ha.EVENT,al.COMMENT_MOVE,eg);var tg=class extends qm{constructor(e){super(e),this.type=al.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(e=e.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){const e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new tg)).oldSize=new mc(e.oldWidth,e.oldHeight),t.newSize=new mc(e.newWidth,e.newHeight),t}isNull(){return mc.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};t(Ha.EVENT,al.COMMENT_RESIZE,tg);var ng=class extends tc{constructor(e,t,n){super(n),this.type=al.TOOLBOX_ITEM_SELECT,this.oldItem=null!=e?e:void 0,this.newItem=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new ng)).oldItem=e.oldItem,t.newItem=e.newItem,t}};t(Ha.EVENT,al.TOOLBOX_ITEM_SELECT,ng);var ig=class extends Bf{constructor(e,t,n){super(e),this.oldType=t,this.newType=n,this.type=al.VAR_TYPE_CHANGE}toJson(){const e=super.toJson();if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");return e.oldType=this.oldType,e.newType=this.newType,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new ig)).oldType=e.oldType,t.newType=e.newType,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");const n=t.getVariableMap().getVariableById(this.varId);n&&(e?t.getVariableMap().changeVariableType(n,this.newType):t.getVariableMap().changeVariableType(n,this.oldType))}};t(Ha.EVENT,al.VAR_TYPE_CHANGE,ig);var rg,sg,og,ag,lg,cg,ug,dg,pg,hg,fg,mg,gg,_g,yg,bg,vg,Tg,kg,xg,Eg,Sg,Cg,wg,Ig,Ag=class extends ec{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=al.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};t(Ha.EVENT,al.FINISHED_LOADING,Ag),Fa.BLOCK_CHANGE$$module$build$src$core$events$events=al.BLOCK_CHANGE,Fa.BLOCK_CREATE$$module$build$src$core$events$events=al.BLOCK_CREATE,Fa.BLOCK_DELETE$$module$build$src$core$events$events=al.BLOCK_DELETE,rg=al.BLOCK_DRAG,Fa.BLOCK_MOVE$$module$build$src$core$events$events=al.BLOCK_MOVE,sg=al.BLOCK_FIELD_INTERMEDIATE_CHANGE,og=al.BUBBLE_OPEN,ag=al.BLOCK_CHANGE,lg=al.CLICK,cg=al.COMMENT_CHANGE,ug=al.COMMENT_CREATE,dg=al.COMMENT_DELETE,pg=al.COMMENT_MOVE,hg=al.COMMENT_RESIZE,fg=al.COMMENT_DRAG,mg=al.BLOCK_CREATE,gg=al.BLOCK_DELETE,_g=al.FINISHED_LOADING,yg=al.BLOCK_MOVE,bg=al.SELECTED,vg=al.THEME_CHANGE,Tg=al.TOOLBOX_ITEM_SELECT,kg=al.TRASHCAN_OPEN,xg=al.UI,Eg=al.VAR_CREATE,Sg=al.VAR_DELETE,Cg=al.VAR_RENAME,wg=al.VIEWPORT_CHANGE,(Ig={}).Abstract=ec,Ig.BLOCK_CHANGE=Fa.BLOCK_CHANGE$$module$build$src$core$events$events,Ig.BLOCK_CREATE=Fa.BLOCK_CREATE$$module$build$src$core$events$events,Ig.BLOCK_DELETE=Fa.BLOCK_DELETE$$module$build$src$core$events$events,Ig.BLOCK_DRAG=rg,Ig.BLOCK_FIELD_INTERMEDIATE_CHANGE=sg,Ig.BLOCK_MOVE=Fa.BLOCK_MOVE$$module$build$src$core$events$events,Ig.BUBBLE_OPEN=og,Ig.BUMP_EVENTS=vl,Ig.BlockBase=ju,Ig.BlockChange=Ku,Ig.BlockCreate=_p,Ig.BlockDelete=Ep,Ig.BlockDrag=Hm,Ig.BlockFieldIntermediateChange=Gm,Ig.BlockMove=jm,Ig.BubbleOpen=zm,Ig.BubbleType=Km,Ig.CHANGE=ag,Ig.CLICK=lg,Ig.COMMENT_CHANGE=cg,Ig.COMMENT_CREATE=ug,Ig.COMMENT_DELETE=dg,Ig.COMMENT_DRAG=fg,Ig.COMMENT_MOVE=pg,Ig.COMMENT_RESIZE=hg,Ig.CREATE=mg,Ig.Click=nc,Ig.ClickTarget=Ql,Ig.CommentBase=qm,Ig.CommentChange=Jm,Ig.CommentCollapse=Ym,Ig.CommentCreate=Xm,Ig.CommentDelete=Zm,Ig.CommentDrag=Qm,Ig.CommentMove=eg,Ig.CommentResize=tg,Ig.DELETE=gg,Ig.FINISHED_LOADING=_g,Ig.FinishedLoading=Ag,Ig.MOVE=yg,Ig.SELECTED=bg,Ig.Selected=xp,Ig.THEME_CHANGE=vg,Ig.TOOLBOX_ITEM_SELECT=Tg,Ig.TRASHCAN_OPEN=kg,Ig.ThemeChange=bp,Ig.ToolboxItemSelect=ng,Ig.TrashcanOpen=jf,Ig.UI=xg,Ig.UiBase=tc,Ig.VAR_CREATE=Eg,Ig.VAR_DELETE=Sg,Ig.VAR_RENAME=Cg,Ig.VIEWPORT_CHANGE=wg,Ig.VarBase=Bf,Ig.VarCreate=$f,Ig.VarDelete=Vf,Ig.VarRename=Hf,Ig.VarTypeChange=ig,Ig.ViewportChange=Tp,Ig.clearPendingUndo=te,Ig.disable=Fa.disable$$module$build$src$core$events$utils,Ig.disableOrphans=ae,Ig.enable=Fa.enable$$module$build$src$core$events$utils,Ig.filter=ee,Ig.fire=Y,Ig.fromJson=se,Ig.get=oe,Ig.getDescendantIds=re,Ig.getGroup=Fa.getGroup$$module$build$src$core$events$utils,Ig.getRecordUndo=J,Ig.isEnabled=ne,Ig.setGroup=Fa.setGroup$$module$build$src$core$events$utils,Ig.setRecordUndo=Fa.setRecordUndo$$module$build$src$core$events$utils;var Ng={};Ng.BottomRow=Em,Ng.ConstantProvider=vm,Ng.Drawer=Tm,Ng.PathObject=Am,Ng.RenderInfo=Im,Ng.Renderer=Nm,Ng.RightConnectionShape=Cm,Ng.StatementInput=Sm,Ng.TopRow=wm,Da();var Dg={};Dg.registerCleanup=ca,Dg.registerCollapse=da,Dg.registerCollapseExpandBlock=Ta,Dg.registerComment=ba,Dg.registerCommentCreate=wa,Dg.registerCommentDelete=Sa,Dg.registerCommentDuplicate=Ca,Dg.registerCommentOptions=Na,Dg.registerDefaultOptions=Da,Dg.registerDelete=xa,Dg.registerDeleteAll=ga,Dg.registerDisable=ka,Dg.registerDuplicate=ya,Dg.registerExpand=pa,Dg.registerHelp=Ea,Dg.registerInline=va,Dg.registerRedo=la,Dg.registerUndo=aa;var Og="button",Rg=class{load(e,t){return(e=new yh(t.getWorkspace(),t.targetWorkspace,e,!1)).show(),new mh(e,Og)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof yh&&e.dispose()}getType(){return Og}};t(Ha.FLYOUT_INFLATER,Og,Rg);var Lg={};Lg.Bubble=Rp,Lg.MiniWorkspaceBubble=Lp,Lg.TextBubble=uh,Lg.TextInputBubble=Wh;var Pg="block",Mg=class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,t){return this.setFlyout(t),(e=this.createBlock(e,t.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(e=>e.isInFlyout=!0),this.addBlockListeners(e),new mh(e,Pg)}createBlock(e,t){return e.blockxml?(e="string"==typeof e.blockxml?Fa.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,t=jr(e,t)):(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),void 0===e.disabledReasons&&!1===e.enabled&&(e.disabledReasons=[iu]),"x"in e&&delete e.x,"y"in e&&delete e.y,t=On(e,t)),t}gapForItem(e,t){let n;return e.gap?n=parseInt(String(e.gap)):e.blockxml&&(e="string"==typeof e.blockxml?Fa.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,n=parseInt(e.getAttribute("gap"))),!n||isNaN(n)?t:n}disposeItem(e){(e=e.getElement())instanceof ph&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){let t;(null!=(t=this.listeners.get(e))?t:[]).forEach(e=>y(e)),this.listeners.delete(e)}setFlyout(e){if(this.flyout!==e){if(this.flyout){let e;null==(e=this.flyout.targetWorkspace)||e.removeChangeListener(this.capacityWrapper)}var t;this.flyout=e,null==(t=this.flyout.targetWorkspace)||t.addChangeListener(this.capacityWrapper)}}updateStateBasedOnCapacity(e){let t,n;const i=null==(t=this.flyout)||null==(n=t.targetWorkspace)?void 0:n.isCapacityAvailable(Fe(e));for(;e;)e.setDisabledReason(!i,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}addBlockListeners(e){const t=[];t.push(g(e.getSvgRoot(),"pointerdown",e,t=>{let n,i;const r=null==(n=this.flyout)||null==(i=n.targetWorkspace)?void 0:i.getGesture(t);r&&this.flyout&&(r.setStartBlock(e),r.handleFlyoutStart(t,this.flyout))})),t.push(_(e.getSvgRoot(),"pointermove",null,()=>{let t,n;null!=(t=this.flyout)&&null!=(n=t.targetWorkspace)&&n.isDragging()||e.addSelect()})),t.push(_(e.getSvgRoot(),"pointerleave",null,()=>{let t,n;null!=(t=this.flyout)&&null!=(n=t.targetWorkspace)&&n.isDragging()||e.removeSelect()})),this.listeners.set(e.id,t)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==al.BLOCK_CREATE&&e.type!==al.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(e=>{this.permanentlyDisabledBlocks.has(e)||this.updateStateBasedOnCapacity(e)})}getType(){return Pg}};t(Ha.FLYOUT_INFLATER,Pg,Mg);var Fg=class extends xf{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Bg=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=Ss(e.xPos,this.info_.startY);for(let t,n=0;t=e.elements[n];n++)ef.isLeftSquareCorner(t)?this.steps_+=this.highlightConstants_.START_POINT:ef.isLeftRoundedCorner(t)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):ef.isPreviousConnection(t)?this.steps_+=this.notchPaths_.pathLeft:ef.isHat(t)?this.steps_+=this.startPaths_.path(this.RTL_):ef.isSpacer(t)&&0!==t.width&&(this.steps_+=Is("H",t.xPos+t.width-this.highlightOffset));this.steps_+=Is("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+Is("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const n=e.height-t.connectionHeight;this.steps_+=Es(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+Is("v",n)}else this.steps_+=Es(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const n=e.height-2*this.insideCornerPaths_.height;this.steps_+=Es(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+Is("v",n)+this.insideCornerPaths_.pathBottom(this.RTL_)+Cs(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Es(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Cs(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof bf&&e.followsStatement&&(this.steps_+=Is("H",t)),this.RTL_&&(this.steps_+=Is("H",t),e.height>this.highlightOffset&&(this.steps_+=Is("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=Is("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];ef.isLeftSquareCorner(t)?this.steps_+=Es(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):ef.isLeftRoundedCorner(t)&&(this.steps_+=Es(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=Es(this.info_.startX,e):(this.steps_+=Es(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=Is("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,ef.isLeftRoundedCorner(e.elements[0])?this.steps_+=Is("V",this.outsideCornerPaths_.height):this.steps_+=Is("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,n=e.xPos+e.connectionWidth;var i=e.centerline-e.height/2;const r=e.width-e.connectionWidth,s=i+t;this.RTL_?(i=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=Es(n-t,s)+Is("v",i)+this.puzzleTabPaths_.pathDown(this.RTL_)+Is("v",e)+Is("h",r)):this.inlineSteps_+=Es(e.xPos+e.width+t,s)+Is("v",e.height)+Is("h",-r)+Es(n,i+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},$g=class extends Sf{constructor(e,t){super(e,t),this.highlighter_=new Bg(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=Is("H",e.xPos+e.width)+Is("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;n=this.info_.RTL?-1*n:n+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(n,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-n:n)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},Ug=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=Ss(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e+t)-t,i=Ss(n,n)+As("a","0 0,0",e,ks(-n-t,e-n)),r=As("a","0 0,0",e+t,ks(e+t,e+t)),s=Ss(n,-n)+As("a","0 0,0",e+t,ks(e-n,n+t));return{width:e+t,height:e,pathTop:e=>e?i:"",pathBottom:e=>e?r:s}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e-t)+t,i=Ss(n,n)+As("a","0 0,1",e-t,ks(e-n,-n+t)),r=Ss(t,e)+As("a","0 0,1",e-t,ks(e,-e+t)),s=-n,o=Ss(n,s)+As("a","0 0,1",e-t,ks(-n+t,-s-e));return{height:e,topLeft:e=>e?i:r,bottomLeft:()=>o}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,n=Ss(-2,2.5-t+.9)+Cs(-.45*e,-2.1),i=Is("v",2.5)+Ss(.97*-e,2.5)+xs("q",[ks(.05*-e,10),ks(.3*e,9.5)])+Ss(.67*e,-1.9)+Is("v",2.5),r=Is("v",-1.5)+Ss(-.92*e,-.5)+xs("q",[ks(-.19*e,-5.5),ks(0,-11)])+Ss(.92*e,1),s=Ss(-5,t-.7)+Cs(.46*e,-2.1);return{width:e,height:t,pathUp:e=>e?n:r,pathDown:e=>e?i:s}}makeNotch(){return{pathLeft:Is("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Cs(5.1,2.6)+Ss(-10.2,6.8)+Cs(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=Ss(25,-8.7)+xs("c",[ks(29.7,-6.2),ks(57.2,-.5),ks(75,8.7)]),n=xs("c",[ks(17.8,-9.2),ks(45.3,-14.9),ks(75,-8.7)])+Es(100.5,e+.5);return{path:e=>e?t:n}}},Vg=class extends pf{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Hg=class extends Tf{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Gg=class extends Cf{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof th||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new Vg(this.constants_,e)),t.hasInlineInput=!0):e instanceof th?(t.elements.push(new Hg(this.constants_,e)),t.hasStatement=!0):e instanceof Fa.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new af(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Qp||e instanceof eh)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let t,n=0;t=this.rows[n];n++)t.hasExternalInput&&(e=!0);for(let n,i=0;n=this.rows[i];i++){var t=n.elements;if(n.elements=[],n.startsWithElemSpacer()&&n.elements.push(new df(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let e=0;e<t.length-1;e++){n.elements.push(t[e]);const i=this.getInRowSpacing_(t[e],t[e+1]);n.elements.push(new df(this.constants_,i))}n.elements.push(t[t.length-1]),n.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&n.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),n.elements.push(new df(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&ef.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&ef.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&ef.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!ef.isInput(e)&&(!t||ef.isStatementInput(t)))return ef.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:ef.isIcon(e)?2*this.constants_.LARGE_PADDING+1:ef.isHat(e)?this.constants_.NO_PADDING:ef.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:ef.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:ef.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(ef.isInput(e)&&!t){if(ef.isExternalInput(e))return this.constants_.NO_PADDING;if(ef.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ef.isStatementInput(e))return this.constants_.NO_PADDING}if(!ef.isInput(e)&&t&&ef.isInput(t)){if(ef.isField(e)&&e.isEditable){if(ef.isInlineInput(t)||ef.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(ef.isInlineInput(t)||ef.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(ef.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(ef.isIcon(e)&&t&&!ef.isInput(t))return this.constants_.LARGE_PADDING;if(ef.isInlineInput(e)&&t&&ef.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(ef.isLeftSquareCorner(e)&&t){if(ef.isHat(t))return this.constants_.NO_PADDING;if(ef.isPreviousConnection(t))return t.notchOffset;if(ef.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(ef.isLeftRoundedCorner(e)&&t){if(ef.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(ef.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return ef.isField(e)&&t&&ef.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&ef.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return ef.isTopRow(e)&&ef.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:ef.isTopRow(e)||ef.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(ef.isSpacer(t))return e.yPos+t.height/2;if(ef.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,ef.isNextConnection(t)?e+t.height/2:e-t.height/2;if(ef.isTopRow(e))return ef.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return ef.isField(t)||ef.isIcon(t)?(n+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(n+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):n=ef.isInlineInput(t)?n+t.height/2:n+e.height/2,n}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,n=null;for(let i,r=this.rows.length-1;i=this.rows[r];r--)t.set(i,e),ef.isInputRow(i)&&(i.hasStatement&&this.alignStatementRow_(i),n&&n.hasStatement&&i.width<n.width?t.set(i,n.width):e=i.hasStatement?i.width:Math.max(e,i.width),n=i);e=0;for(let i,r=0;i=this.rows[r];r++)i.hasStatement?e=this.getDesiredRowWidth_(i):ef.isSpacer(i)?i.width=Math.max(e,t.get(i)):(n=i.width,(e=Math.max(e,t.get(i))-n)>0&&this.addAlignmentPadding_(i,e),e=i.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let i,r=0;i=this.rows[r];r++){i.yPos=t,i.xPos=this.startX,t+=i.height,e=Math.max(e,i.widthWithConnectedBlocks);var n=t-this.topRow.ascenderHeight;i===this.bottomRow&&n<this.constants_.MIN_BLOCK_HEIGHT&&(n=this.constants_.MIN_BLOCK_HEIGHT-n,this.bottomRow.height+=n,t+=n),this.recordElemPositions_(i)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},jg=class extends wf{constructor(e,t,n){super(e,t,n),this.constants=n,this.colourDark="#000000",this.svgPathDark=le(hc.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=le(hc.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Zi("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Kg=class extends If{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t,n){super.refreshDom(e,t,n),this.getHighlightConstants().init()}makeConstants_(){return new Fg}makeRenderInfo_(e){return new Gg(this,e)}makeDrawer_(e,t){return new $g(e,t)}makePathObject(e,t){return new jg(e,t,this.getConstants())}makeHighlightConstants_(){return new Ug(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};vo("geras",Kg);var zg={};zg.ConstantProvider=Fg,zg.Drawer=$g,zg.HighlightConstantProvider=Ug,zg.Highlighter=Bg,zg.InlineInput=Vg,zg.PathObject=jg,zg.RenderInfo=Gg,zg.Renderer=Kg,zg.StatementInput=Hg;var Wg=class extends Cf{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const i=this.rows[t];var n=i.elements;if(i.elements=[],i.startsWithElemSpacer()&&i.elements.push(new df(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){i.elements.push(n[e]);const t=this.getInRowSpacing_(n[e],n[e+1]);i.elements.push(new df(this.constants_,t))}i.elements.push(n[n.length-1]),i.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),e&&i.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),i.elements.push(new df(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&ef.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&ef.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&ef.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!ef.isInput(e)&&!t)return ef.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:ef.isIcon(e)?2*this.constants_.LARGE_PADDING+1:ef.isHat(e)?this.constants_.NO_PADDING:ef.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:ef.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:ef.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(ef.isInput(e)&&!t){if(ef.isExternalInput(e))return this.constants_.NO_PADDING;if(ef.isInlineInput(e))return this.constants_.LARGE_PADDING;if(ef.isStatementInput(e))return this.constants_.NO_PADDING}if(!ef.isInput(e)&&t&&ef.isInput(t)){if(ef.isField(e)&&e.isEditable){if(ef.isInlineInput(t)||ef.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(ef.isInlineInput(t)||ef.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(ef.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(ef.isIcon(e)&&t&&!ef.isInput(t))return this.constants_.LARGE_PADDING;if(ef.isInlineInput(e)&&t&&ef.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(ef.isLeftSquareCorner(e)&&t){if(ef.isHat(t))return this.constants_.NO_PADDING;if(ef.isPreviousConnection(t)||ef.isNextConnection(t))return t.notchOffset}return ef.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:ef.isField(e)&&t&&ef.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&ef.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return ef.isTopRow(e)&&ef.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:ef.isTopRow(e)||ef.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(ef.isSpacer(t))return e.yPos+t.height/2;if(ef.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,ef.isNextConnection(t)?e+t.height/2:e-t.height/2;if(ef.isTopRow(e))return ef.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return ef.isField(t)&&e.hasStatement?n+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):n+e.height/2}finalize_(){let e=0,t=0;for(var n=0;n<this.rows.length;n++){const r=this.rows[n];r.yPos=t,r.xPos=this.startX,t+=r.height,e=Math.max(e,r.widthWithConnectedBlocks);var i=t-this.topRow.ascenderHeight;r===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,t+=i),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},qg=class extends If{constructor(e){super(e)}makeRenderInfo_(e){return new Wg(this,e)}};vo("thrasos",qg);var Jg={};Jg.RenderInfo=Wg,Jg.Renderer=qg;var Yg=new Ap("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),Xg={Classic:Np,Zelos:Yg},Zg=class{constructor(e,t,n){this.id_=e.toolboxitemid||x(),this.level_=(this.parent_=n||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){const e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(!(e instanceof HTMLElement))throw Error("Toolbox item div is unexpectedly not an HTML element.");return e}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},Qg=class extends Zg{constructor(e,t,n){super(e,t,n),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(n)}}parseCategoryDef_(e){this.name_="name"in e?nr(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Nt(this.htmlDiv_,Wc.TREEITEM),Dt(this.htmlDiv_,qc.SELECTED,!1),Dt(this.htmlDiv_,qc.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Nt(this.iconDom_,Wc.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&Dt(this.htmlDiv_,qc.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&ce(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&ce(e,t),t=Qg.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&ce(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ce(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&ce(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Qg.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(null==(e=nr(e))||""===e)return"";var t=Number(e);return isNaN(t)?(t=qi(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Qi(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&ue(e,t),(t=this.cssConfig_.openicon)&&ce(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&ue(e,t),(t=this.cssConfig_.closedicon)&&ce(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const e=this.parseColour(Qg.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||e,t&&ce(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&de(this.rowDiv_,t);Dt(this.htmlDiv_,qc.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:dt(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){he(this.htmlDiv_)}};Qg.registrationName="category",Qg.nestedPadding=19,Qg.borderWidth=8,Qg.defaultBackgroundColour="#57e",Ge('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),t(Ha.TOOLBOX_ITEM,Qg.registrationName,Qg);var e_=class extends Zg{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&ce(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){he(this.htmlDiv)}};e_.registrationName="sep",Ge('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),t(Ha.TOOLBOX_ITEM,e_.registrationName,e_);var t_=class extends Qg{constructor(e,t,n){super(e,t,n),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let n=0;n<t.length;n++){const i=t[n];!s(Ha.TOOLBOX_ITEM,i.kind)||i.kind.toLowerCase()===e_.registrationName&&e?(this.flyoutItems_.push(i),e=!0):(this.createToolboxItem(i),e=!1)}}}}createToolboxItem(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&ft(e)&&(t=t_.registrationName),e=new(o(Ha.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Nt(this.subcategoriesDiv_,Wc.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Dt(this.htmlDiv_,qc.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ce(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var n=this.cssConfig_.contents;for(n&&ce(t,n),n=0;n<e.length;n++){const i=e[n];i.init();const r=i.getDiv();if(t.appendChild(r),i.getClickTarget){let e;null==(e=i.getClickTarget())||e.setAttribute("id",i.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let e;null==(e=this.parentToolbox_.getFlyout())||e.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}Dt(this.htmlDiv_,qc.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let n=0;n<t.length;n++)t[n].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};t_.registrationName="collapsibleCategory",t(Ha.TOOLBOX_ITEM,t_.registrationName,t_);var n_=class extends fh{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_);const n=this.flyout.createDom("svg");ce(n,"blocklyToolboxFlyout"),fe(n,t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:oc.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[oc.Capability.AUTOHIDEABLE,oc.Capability.DELETE_AREA,oc.Capability.DRAG_TARGET]}),Fa.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return t.id=x(),this.contentsDiv_=this.createContentsContainer_(),Nt(this.contentsDiv_,Wc.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),ce(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return ce(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=g(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=g(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(v(e)||e.target===this.HtmlDiv)Ae().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),Ae().hideChaff(!0)}p()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=e.copyOptionsForFlyout();return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?c(Ha.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):c(Ha.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e,this.contents.forEach(e=>e.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let n=0;n<e.length;n++)this.createToolboxItem(e[n],t);this.contentsDiv_.appendChild(t)}createToolboxItem(e,t){var n=e.kind;"CATEGORY"===n.toUpperCase()&&ft(e)&&(n=t_.registrationName),(n=o(Ha.TOOLBOX_ITEM,n.toLowerCase()))&&((e=new n(e,this)).init(),this.addToolboxItem_(e),(n=e.getDiv())&&t.appendChild(n),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents.set(e.getId(),e),e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&ce(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&de(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,n=t+e.height,i=e.left;return e=i+e.width,this.toolboxPosition===Nc.TOP?new fc(-1e7,n,-1e7,1e7):this.toolboxPosition===Nc.BOTTOM?new fc(t,1e7,-1e7,1e7):this.toolboxPosition===Nc.LEFT?new fc(-1e7,1e7,-1e7,e):new fc(-1e7,1e7,i,1e7)}wouldDelete(e){return e instanceof ph?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(qs(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===Nc.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===Nc.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){const e=this.workspace_;var t=this.HtmlDiv.getBoundingClientRect();const n=this.getFlyout(),i=this.toolboxPosition===Nc.LEFT?e.scrollX+t.width+(null!=n&&n.isVisible()?n.getWidth():0):e.scrollX;t=this.toolboxPosition===Nc.TOP?e.scrollY+t.height+(null!=n&&n.isVisible()?n.getHeight():0):e.scrollY,e.translate(i,t),Me(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!La(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),Dt(this.contentsDiv_,qc.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),Dt(this.contentsDiv_,qc.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){const n=e&&e.getName();let i=t&&t.getName();e===t&&(i=null),e=new(oe(al.TOOLBOX_ITEM_SELECT))(n,i,this.workspace_.id),Y(e)}selectParent(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)+1;if(t>-1&&t<e.length){let n=e[t];for(;n&&!n.isSelectable();)n=e[++t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)-1;if(t>-1&&t<e.length){let n=e[t];for(;n&&!n.isSelectable();)n=e[--t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)y(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),he(this.HtmlDiv)),Fa.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(!this.HtmlDiv)throw Error("Toolbox DOM has not yet been created.");return this.HtmlDiv}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(!e||e===this){let e;return null!=(e=this.getToolboxItems().find(e=>e.isSelectable()))?e:null}return null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,t){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){let t;e&&e===(null==(t=this.flyout)?void 0:t.getWorkspace())||(this.clearSelection(),this.flyout&&Qs(this.flyout)&&this.flyout.autoHide(!1))}};Ge('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  box-sizing: border-box;\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),t(Ha.TOOLBOX,Va,n_);var i_=vp.INPUT_VALUE,r_=vp.OUTPUT_VALUE,s_=vp.NEXT_STATEMENT,o_=vp.PREVIOUS_STATEMENT,a_=Nc.TOP,l_=Nc.BOTTOM,c_=Nc.LEFT,u_=Nc.RIGHT;Lf.prototype.newBlock=function(e,t){return new nh(this,e,t)},Mf.prototype.newBlock=function(e,t){return new ph(this,e,t)},Lf.prototype.newComment=function(e){return new fp(this,e)},Mf.prototype.newComment=function(e){return new mp(this,e)},Mf.newTrashcan=function(e){return new Kf(e)},Lp.prototype.newWorkspaceSvg=function(e){return new Mf(e)},Fa.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=ro(e))[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],Fa.Names$$module$build$src$core$names.NameType.PROCEDURE)};var d_={};return d_.Block=nh,d_.BlockFlyoutInflater=Mg,d_.BlockNavigationPolicy=xh,d_.BlockSvg=ph,d_.Blocks=el,d_.ButtonFlyoutInflater=Rg,d_.COLLAPSED_FIELD_NAME=nu,d_.COLLAPSED_INPUT_NAME=tu,d_.COLLAPSE_CHARS=30,d_.CodeGenerator=Fa.CodeGenerator$$module$build$src$core$generator,d_.CollapsibleToolboxCategory=t_,d_.ComponentManager=oc,d_.Connection=Hp,d_.ConnectionChecker=Rf,d_.ConnectionDB=kp,d_.ConnectionNavigationPolicy=Ch,d_.ConnectionType=vp,d_.ContextMenu=Yd,d_.ContextMenuItems=Dg,d_.ContextMenuRegistry=Xd,d_.Css=dc,d_.DELETE_VARIABLE_ID=qp,d_.DeleteArea=fh,d_.DragTarget=hh,d_.DropDownDiv=dd,d_.Events=Ig,d_.Extensions=$p,d_.Field=Pd,d_.FieldCheckbox=$m,d_.FieldDropdown=wp,d_.FieldImage=km,d_.FieldLabel=Kp,d_.FieldLabelSerializable=Bm,d_.FieldNavigationPolicy=wh,d_.FieldNumber=Fm,d_.FieldTextInput=Fa.FieldTextInput$$module$build$src$core$field_textinput,d_.FieldVariable=Mm,d_.Flyout=Mh,d_.FlyoutButton=yh,d_.FlyoutButtonNavigationPolicy=bh,d_.FlyoutItem=mh,d_.FlyoutMetricsManager=_h,d_.FlyoutNavigationPolicy=vh,d_.FlyoutNavigator=Oh,d_.FlyoutSeparator=Th,d_.FlyoutSeparatorNavigationPolicy=kh,d_.FocusManager=Gl,d_.FocusableTreeTraverser=Vl,d_.Generator=Fa.CodeGenerator$$module$build$src$core$generator,d_.Gesture=Vh,d_.Grid=Hh,d_.HorizontalFlyout=Pm,d_.INPUT_VALUE=i_,d_.Input=Zp,d_.InsertionMarkerPreviewer=Dm,d_.KeyboardNavigationController=Fh,d_.LabelFlyoutInflater=bm,d_.LineCursor=Kh,d_.Marker=jh,d_.MarkerManager=zh,d_.Menu=Qc,d_.MenuItem=Zc,d_.MetricsManager=gh,d_.Msg=Fa.Msg$$module$build$src$core$msg,d_.NEXT_STATEMENT=s_,d_.Names=Fa.Names$$module$build$src$core$names,d_.Navigator=Dh,d_.OPPOSITE_TYPE=zp,d_.OUTPUT_VALUE=r_,d_.Options=Dp,d_.PREVIOUS_STATEMENT=o_,d_.PROCEDURE_CATEGORY_NAME=Xh,d_.Procedures=Zh,d_.RENAME_VARIABLE_ID=Wp,d_.RenderedConnection=Jp,d_.Scrollbar=Tc,d_.ScrollbarPair=Rh,d_.SeparatorFlyoutInflater=Ph,d_.ShortcutItems=pm,d_.ShortcutRegistry=zl,d_.TOOLBOX_AT_BOTTOM=l_,d_.TOOLBOX_AT_LEFT=c_,d_.TOOLBOX_AT_RIGHT=u_,d_.TOOLBOX_AT_TOP=a_,d_.Theme=Ap,d_.ThemeManager=Nf,d_.Themes=Xg,d_.Toast=_u,d_.Toolbox=n_,d_.ToolboxCategory=Qg,d_.ToolboxItem=Zg,d_.ToolboxSeparator=e_,d_.Tooltip=Ad,d_.Touch=ol,d_.Trashcan=Kf,d_.UnattachedFieldError=Md,d_.VARIABLE_CATEGORY_NAME=Nu,d_.VARIABLE_DYNAMIC_CATEGORY_NAME=Df,d_.VERSION="12.2.0",d_.VariableMap=Gf,d_.VariableModel=Uf,d_.Variables=Ru,d_.VariablesDynamic=Of,d_.VerticalFlyout=Lm,d_.WidgetDiv=zd,d_.Workspace=Lf,d_.WorkspaceAudio=Pf,d_.WorkspaceDragger=Uh,d_.WorkspaceNavigationPolicy=Nh,d_.WorkspaceSvg=Mf,d_.Xml=gp,d_.ZoomControls=Uc,d_.blockAnimations=sh,d_.blockRendering=Af,d_.browserEvents=bl,d_.bubbles=Lg,d_.bumpObjects=lh,d_.clipboard=cm,d_.comments=dm,d_.common=Zl,d_.config=Fa.config$$module$build$src$core$config,d_.constants=ru,d_.defineBlocksWithJsonArray=$e,d_.dialog=Cu,d_.dragging=Vm,d_.fieldRegistry=Cp,d_.geras=zg,d_.getFocusManager=Fa.getFocusManager$$module$build$src$core$focus_manager,d_.getMainWorkspace=Ae,d_.getSelected=De,d_.hasBubble=Kn,d_.hideChaff=Pa,d_.icons=Yh,d_.inject=ta,d_.inputs=Om,d_.isCopyable=Uo,d_.isDeletable=qs,d_.isDraggable=Zs,d_.isIcon=Rs,d_.isObservable=io,d_.isPaster=Oa,d_.isRenderedElement=Ra,d_.isSelectable=xe,d_.isSerializable=Ot,d_.isVariableBackedParameterModel=Zt,d_.keyboardNavigationController=Bh,d_.layers=np,d_.navigateBlock=Xs,d_.navigateStacks=Ys,d_.procedures=Zh,d_.registry=Ga,d_.renderManagement=hu,d_.serialization=_m,d_.setLocale=su,d_.setParentContainer=Pe,d_.svgResize=Me,d_.thrasos=Jg,d_.uiPosition=Bc,d_.utils=Vp,d_.zelos=Ng,d_.__namespace__=Fa,d_},"function"==typeof define&&define.amd?define([],r):"object"==typeof n?t.exports=r():i.Blockly=r()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],173:[function(e,t,n){t.exports=e("./blocks_compressed.js")},{"./blocks_compressed.js":174}],174:[function(e,t,n){var i,r;i=this,r=function(e){var t=e.__namespace__,n=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),i={customContextMenu:function(e){if(this.isInFlyout)"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(i={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:r(this)},o=this.getField("VAR").getText(),o={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",o),enabled:!0,callback:s(this)},e.unshift(i),e.unshift(o));else{if("variables_get_dynamic"===this.type)var n="variables_set_dynamic",i=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get_dynamic",i=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var o=this.getField("VAR");n={type:n,fields:{VAR:o.saveState(!0)}},e.push({enabled:this.workspace.remainingCapacity()>0,text:i.replace("%1",o.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}},onchange:function(e){e=this.getFieldValue("VAR"),e=t.getVariable$$module$build$src$core$variables(this.workspace,e),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(e.getType()):this.getInput("VALUE").connection.setCheck(e.getType())}},r=function(e){return function(){const n=e.workspace,i=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,i)}},s=function(e){return function(){const n=e.getField("VAR").getVariable();n&&t.deleteVariable$$module$build$src$core$variables(n.getWorkspace(),n,e)}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",i),t.defineBlocks$$module$build$src$core$common(n);var o={blocks:n},a=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),l={customContextMenu:function(e){if(this.isInFlyout)"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(i={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:c(this)},r=this.getField("VAR").getText(),r={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:u(this)},e.unshift(i),e.unshift(r));else{if("variables_get"===this.type)var n="variables_set",i=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get",i=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var r=this.getField("VAR");n={type:n,fields:{VAR:r.saveState(!0)}},e.push({enabled:this.workspace.remainingCapacity()>0,text:i.replace("%1",r.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}}},c=function(e){return function(){const n=e.workspace,i=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,i)}},u=function(e){return function(){const n=e.getField("VAR").getVariable();n&&t.deleteVariable$$module$build$src$core$variables(n.getWorkspace(),n,e)}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",l),t.defineBlocks$$module$build$src$core$common(a);var d={blocks:a},p=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),h={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);const e=e=>{const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});return n.setValidator(function(t){const n=this.getValue();(t="FROM_START"===t||"FROM_END"===t)!=("FROM_START"===n||"FROM_END"===n)&&this.getSourceBlock().updateAt_(e,t)}),n};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",`${n}`),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",`${n}`),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),2===e&&t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"))}};p.text_getSubstring=h,p.text_changeCase={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},p.text_trim={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},p.text_print={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var f={updateType_:function(e){this.outputConnection.setCheck("NUMBER"===e?"Number":"String")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}};p.text_prompt_ext=Object.assign({},f,{init:function(){var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendValueInput("TEXT").appendField(e,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),p.text_prompt=Object.assign({},f,{init:function(){this.mixin(m);var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendDummyInput().appendField(e,"TYPE").appendField(this.newQuote_(!0)).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),p.text_count={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},p.text_replace={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},p.text_reverse={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var m={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(e){for(let t,n=0;t=this.inputList[n];n++)for(let n,i=0;n=t.fieldRow[i];i++)if(e===n.name)return t.insertFieldAt(i,this.newQuote_(!0)),void t.insertFieldAt(i+2,this.newQuote_(!1));console.warn('field named "'+e+'" not found in '+this.toDevString())},newQuote_:function(e){return e=this.RTL?!e:e,t.fromJson$$module$build$src$core$field_registry({type:"field_image",src:e?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:e?"":""})}},g={itemCount_:0,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",`${this.itemCount_}`),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("text_create_join_container");t.initSvg();let n=t.getInput("STACK").connection;for(let t=0;t<this.itemCount_;t++){const t=e.newBlock("text_create_join_item");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&!e.includes(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);e.valueConnection_=n&&n.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}};t.register$$module$build$src$core$extensions("text_append_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var _={isAt_:!1,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("at",`${this.isAt_}`),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(e){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),e&&(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=e}};t.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>t.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),t.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(m),this.quoteField_("TEXT")}),t.registerMixin$$module$build$src$core$extensions("quote_image_mixin",m),t.registerMutator$$module$build$src$core$extensions("text_join_mutator",g,function(){this.mixin(m),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),t.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",_,function(){this.getField("WHERE").setValidator(function(e){e="FROM_START"===e||"FROM_END"===e;const t=this.getSourceBlock();e!==t.isAt_&&t.updateAt_(e)}),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("WHERE");let n=t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===e||"FROM_END"===e)&&(e="FROM_START"===e?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(n+="  "+e.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),n})}),t.defineBlocks$$module$build$src$core$common(p);var y={blocks:p},b={},v={setStatements_:function(e){this.hasStatements_!==e&&(e?(this.appendStatementInput("STACK").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=e)},updateParams_:function(){let e="";this.arguments_.length&&(e=t.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.disable$$module$build$src$core$events$utils();try{this.setFieldValue(e,"PARAMS")}finally{t.enable$$module$build$src$core$events$utils()}},mutationToDom:function(e){const n=t.createElement$$module$build$src$core$utils$xml("mutation");e&&n.setAttribute("name",this.getFieldValue("NAME"));for(let i=0;i<this.argumentVarModels_.length;i++){const r=t.createElement$$module$build$src$core$utils$xml("arg"),s=this.argumentVarModels_[i];r.setAttribute("name",s.getName()),r.setAttribute("varid",s.getId()),e&&this.paramIds_&&r.setAttribute("paramId",this.paramIds_[i]),n.appendChild(r)}return this.hasStatements_||n.setAttribute("statements","false"),n},domToMutation:function(e){this.arguments_=[],this.argumentVarModels_=[];for(let i,r=0;i=e.childNodes[r];r++)if("arg"===i.nodeName.toLowerCase()){var n=i;const e=n.getAttribute("name");n=n.getAttribute("varid")||n.getAttribute("varId"),this.arguments_.push(e),null!==(n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n,e,""))?this.argumentVarModels_.push(n):console.log(`Failed to create a variable named "${e}", ignoring.`)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==e.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const e=Object.create(null);if(this.argumentVarModels_.length){e.params=[];for(let t=0;t<this.argumentVarModels_.length;t++)e.params.push({name:this.argumentVarModels_[t].getName(),id:this.argumentVarModels_[t].getId()})}return this.hasStatements_||(e.hasStatements=!1),e},loadExtraState:function(e){if(this.arguments_=[],this.argumentVarModels_=[],e.params)for(let i=0;i<e.params.length;i++){var n=e.params[i];n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n.id,n.name,""),this.arguments_.push(n.getName()),this.argumentVarModels_.push(n)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==e.hasStatements)},decompose:function(e){const n=t.createElement$$module$build$src$core$utils$xml("block");n.setAttribute("type","procedures_mutatorcontainer");var i=t.createElement$$module$build$src$core$utils$xml("statement");i.setAttribute("name","STACK"),n.appendChild(i);for(let e=0;e<this.arguments_.length;e++){const n=t.createElement$$module$build$src$core$utils$xml("block");n.setAttribute("type","procedures_mutatorarg");var r=t.createElement$$module$build$src$core$utils$xml("field");r.setAttribute("name","NAME");const s=t.createTextNode$$module$build$src$core$utils$xml(this.arguments_[e]);r.appendChild(s),n.appendChild(r),r=t.createElement$$module$build$src$core$utils$xml("next"),n.appendChild(r),i.appendChild(n),i=r}return e=t.domToBlock$$module$build$src$core$xml(n,e),"procedures_defreturn"===this.type?e.setFieldValue(this.hasStatements_,"STATEMENTS"):e.removeInput("STATEMENT_INPUT"),t.mutateCallers$$module$build$src$core$procedures(this),e},compose:function(e){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let n=e.getInputTargetBlock("STACK");for(;n&&!n.isInsertionMarker();){var i=n.getFieldValue("NAME");this.arguments_.push(i),i=this.workspace.getVariable(i,""),this.argumentVarModels_.push(i),this.paramIds_.push(n.id),n=n.nextConnection&&n.nextConnection.targetBlock()}if(this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),null!==(e=e.getFieldValue("STATEMENTS"))&&(e="TRUE"===e,this.hasStatements_!==e))if(e){var r;this.setStatements_(!0),null==(r=this.statementConnection_)||r.reconnect(this,"STACK"),this.statementConnection_=null}else r=this.getInput("STACK").connection,(this.statementConnection_=r.targetConnection)&&((r=r.targetBlock()).unplug(),r.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(e,n){var i=this.workspace.getVariableById(e);if(""===i.getType()){i=i.getName(),n=this.workspace.getVariableById(n);var r=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e&&(this.arguments_[t]=n.getName(),this.argumentVarModels_[t]=n,r=!0);r&&(this.displayRenamedVar_(i,n.getName()),t.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(e){const n=e.getName();let i,r=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e.getId()&&(i=this.arguments_[t],this.arguments_[t]=n,r=!0);r&&(this.displayRenamedVar_(i,n),t.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(e,n){this.updateParams_();var i=this.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(i&&i.bubbleIsVisible()){i=i.getWorkspace().getAllBlocks(!1);for(let r,s=0;r=i[s];s++)"procedures_mutatorarg"===r.type&&t.Names$$module$build$src$core$names.equals(e,r.getFieldValue("NAME"))&&r.setFieldValue(n,"NAME")}},customContextMenu:function(e){if(!this.isInFlyout){var n=this.getFieldValue("NAME"),i={type:this.callType_,extraState:{name:n,params:this.arguments_}};if(e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",n),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,i)}),!this.isCollapsed())for(n=0;n<this.argumentVarModels_.length;n++){const r={type:"variables_get",fields:{VAR:{name:(i=this.argumentVarModels_[n]).getName(),id:i.getId(),type:i.getType()}}};e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",i.getName()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,r)})}}}};b.procedures_defnoreturn=Object.assign({},v,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),b.procedures_defreturn=Object.assign({},v,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT).appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var T={init:function(){this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};b.procedures_mutatorcontainer=T;var k=class extends t.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(e){super.showEditor_(e),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(e){super.onFinishEditing_(e),this.editingInteractively=!1}},x={init:function(){const e=new k(t.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(e){var t=this.getSourceBlock();const n=t.workspace.getRootWorkspace();if(!(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const i=(t.workspace.targetWorkspace||t.workspace).getAllBlocks(!1),r=e.toLowerCase();for(let e=0;e<i.length;e++){if(i[e].id===this.getSourceBlock().id)continue;const t=i[e].getFieldValue("NAME");if(t&&t.toLowerCase()===r)return null}return t.isInFlyout||((t=n.getVariable(e,""))&&t.getName()!==e&&n.renameVariableById(t.getId(),e),t||(this.editingInteractively?this.editingVariable?n.renameVariableById(this.editingVariable.getId(),e):this.editingVariable=n.createVariable(e,""):n.createVariable(e,""))),e}};b.procedures_mutatorarg=x;var E="DISABLED_PROCEDURE_DEFINITION",S={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,n){t.Names$$module$build$src$core$names.equals(e,this.getProcedureCall())&&(this.setFieldValue(n,"NAME"),this.setTooltip((this.outputConnection?t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",n)))},setProcedureParameters_:function(e,n){var i=t.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((i=(i=i&&i.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&i.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),e.join("\n")===this.arguments_.join("\n"))this.quarkIds_=n;else{if(n.length!==e.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var r=this.getInput("ARG"+e);r&&(r=r.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=r,i&&r&&!n.includes(this.quarkIds_[e])&&(r.disconnect(),r.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(e),this.argumentVarModels_=[],e=0;e<this.arguments_.length;e++)i=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[e],""),this.argumentVarModels_.push(i);if(this.updateShape_(),this.quarkIds_=n)for(n=0;n<this.arguments_.length;n++)if((e=this.quarkIds_[n])in this.quarkConnections_){let t;null!=(t=this.quarkConnections_[e])&&t.reconnect(this,"ARG"+n)||delete this.quarkConnections_[e]}}},updateShape_:function(){for(var e=0;e<this.arguments_.length;e++){var n=this.getField("ARGNAME"+e);if(n){t.disable$$module$build$src$core$events$utils();try{n.setValue(this.arguments_[e])}finally{t.enable$$module$build$src$core$events$utils()}}else n=t.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[e]}),this.appendValueInput("ARG"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT).appendField(n,"ARGNAME"+e)}for(e=this.arguments_.length;this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);(e=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||e.appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&e.removeField("WITH"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("name",this.getProcedureCall());for(let n=0;n<this.arguments_.length;n++){const i=t.createElement$$module$build$src$core$utils$xml("arg");i.setAttribute("name",this.arguments_[n]),e.appendChild(i)}return e},domToMutation:function(e){var t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t),t=[];const n=[];for(let i,r=0;i=e.childNodes[r];r++)"arg"===i.nodeName.toLowerCase()&&(t.push(i.getAttribute("name")),n.push(i.getAttribute("paramId")));this.setProcedureParameters_(t,n)},saveExtraState:function(){const e=Object.create(null);return e.name=this.getProcedureCall(),this.arguments_.length&&(e.params=this.arguments_),e},loadExtraState:function(e){if(this.renameProcedure(this.getProcedureCall(),e.name),e=e.params){const t=[];t.length=e.length,t.fill(null),this.setProcedureParameters_(e,t)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&e.recordUndo)if(e.type===t.BLOCK_CREATE$$module$build$src$core$events$events&&e.ids.includes(this.id)){var n=this.getProcedureCall(),i=t.getDefinition$$module$build$src$core$procedures(n,this.workspace);if(!i||i.type===this.defType_&&JSON.stringify(i.getVars())===JSON.stringify(this.arguments_)||(i=null),i)i.isEnabled()||(this.setDisabledReason(!0,E),this.setWarningText(t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",n)));else{t.setGroup$$module$build$src$core$events$utils(e.group),e=t.createElement$$module$build$src$core$utils$xml("xml"),(n=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var r=(i=this.getRelativeToSurfaceXY()).y+2*t.config$$module$build$src$core$config.snapRadius;n.setAttribute("x",`${i.x+t.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),n.setAttribute("y",`${r}`),i=this.mutationToDom(),n.appendChild(i),(i=t.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),r=this.getProcedureCall();const s=t.findLegalName$$module$build$src$core$procedures(r,this);r!==s&&this.renameProcedure(r,s),i.appendChild(t.createTextNode$$module$build$src$core$utils$xml(r)),n.appendChild(i),e.appendChild(n),t.domToWorkspace$$module$build$src$core$xml(e,this.workspace),t.setGroup$$module$build$src$core$events$utils(!1)}}else e.type===t.BLOCK_DELETE$$module$build$src$core$events$events?(n=this.getProcedureCall(),t.getDefinition$$module$build$src$core$procedures(n,this.workspace)||(t.setGroup$$module$build$src$core$events$utils(e.group),this.dispose(!0),t.setGroup$$module$build$src$core$events$utils(!1))):e.type===t.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===e.element&&(n=this.getProcedureCall(),(r=t.getDefinition$$module$build$src$core$procedures(n,this.workspace))&&r.id===e.blockId&&((i=t.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),t.setGroup$$module$build$src$core$events$utils(e.group),e=r.isEnabled(),this.setDisabledReason(!e,E),this.setWarningText(e?null:t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",n)),t.setGroup$$module$build$src$core$events$utils(i)))},customContextMenu:function(e){if(this.workspace.isMovable()){var n=this.getProcedureCall(),i=this.workspace;e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const e=t.getDefinition$$module$build$src$core$procedures(n,i);e&&(i.centerOnBlock(e.id),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}})}}};b.procedures_callnoreturn=Object.assign({},S,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),b.procedures_callreturn=Object.assign({},S,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"});var C={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("value",String(Number(this.hasReturnValue_))),e},domToMutation:function(e){this.hasReturnValue_="1"===e.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(e){if(!(this.workspace.isDragging&&this.workspace.isDragging()||e.type!==t.BLOCK_MOVE$$module$build$src$core$events$events&&e.type!==t.BLOCK_CREATE$$module$build$src$core$events$events)){e=!1;var n=this;do{if(this.FUNCTION_TYPES.includes(n.type)){e=!0;break}n=n.getSurroundParent()}while(n);if(e?("procedures_defnoreturn"===n.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==n.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{t.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"UNPARENTED_IFRETURN")}finally{t.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};b.procedures_ifreturn=C,t.defineBlocks$$module$build$src$core$common(b);var w={blocks:b},I=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);t.register$$module$build$src$core$extensions("math_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"}));var A={mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",String(n)),e},domToMutation:function(e){e="true"===e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){const t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}};t.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",A,function(){this.getField("PROPERTY").setValidator(function(e){e="DIVISIBLE_BY"===e,this.getSourceBlock().updateShape_(e)})}),t.register$$module$build$src$core$extensions("math_change_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var N={updateType_:function(e){"MODE"===e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){if(null===(e=e.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(e)}};t.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",N,function(){this.getField("OP").setValidator(function(e){this.updateType_(e)}.bind(this))}),t.defineBlocks$$module$build$src$core$common(I);var D={blocks:I},O=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);t.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),t.register$$module$build$src$core$extensions("controls_flow_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"}));var R={customContextMenu:function(e){if(!this.isInFlyout){var n=this.getField("VAR"),i=n.getVariable().getName();this.isCollapsed()||null===i||(n={type:"variables_get",fields:{VAR:n.saveState(!0)}},e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",i),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)}))}}};t.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",R),t.register$$module$build$src$core$extensions("controls_for_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.register$$module$build$src$core$extensions("controls_forEach_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var L=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),P={getSurroundLoop:function(){let e=this;do{if(L.has(e.type))return e;e=e.getSurroundParent()}while(e);return null},onchange:function(e){const n=this.workspace;if(n.isDragging&&!n.isDragging()&&(e.type===t.BLOCK_MOVE$$module$build$src$core$events$events||e.type===t.BLOCK_CREATE$$module$build$src$core$events$events)&&(e=!!this.getSurroundLoop(),this.setWarningText(e?null:t.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{t.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"CONTROL_FLOW_NOT_IN_LOOP")}finally{t.setRecordUndo$$module$build$src$core$events$utils(!0)}}};t.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",P),t.defineBlocks$$module$build$src$core$common(O);var M={blocks:O,loopTypes:L},F=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);t.register$$module$build$src$core$extensions("logic_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"}));var B={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=t.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&e.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&e.setAttribute("else","1"),e},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=Object.create(null);return this.elseifCount_&&(e.elseIfCount=this.elseifCount_),this.elseCount_&&(e.hasElse=!0),e},loadExtraState:function(e){this.elseifCount_=e.elseIfCount||0,this.elseCount_=e.hasElse?1:0,this.updateShape_()},decompose:function(e){const t=e.newBlock("controls_if_if");t.initSvg();let n=t.nextConnection;for(let t=1;t<=this.elseifCount_;t++){const t=e.newBlock("controls_if_elseif");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return this.elseCount_&&((e=e.newBlock("controls_if_else")).initSvg(),n.connect(e.previousConnection)),t},compose:function(e){e=e.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const t=[null],n=[null];let i=null;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":this.elseifCount_++,t.push(e.valueConnection_),n.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++,i=e.statementConnection_;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(t,n,i)},saveConnections:function(e){e=e.nextConnection.targetBlock();let t=1;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":var n=this.getInput("IF"+t);const i=this.getInput("DO"+t);e.valueConnection_=n&&n.connection.targetConnection,e.statementConnection_=i&&i.connection.targetConnection,t++;break;case"controls_if_else":n=this.getInput("ELSE"),e.statementConnection_=n&&n.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}},rebuildShape_:function(){const e=[null],t=[null];let n=null;this.getInput("ELSE")&&(n=this.getInput("ELSE").connection.targetConnection);for(let n=1;this.getInput("IF"+n);n++){const i=this.getInput("IF"+n),r=this.getInput("DO"+n);e.push(i.connection.targetConnection),t.push(r.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(e,t,n)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var e=1;this.getInput("IF"+e);e++)this.removeInput("IF"+e),this.removeInput("DO"+e);for(e=1;e<=this.elseifCount_;e++)this.appendValueInput("IF"+e).setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+e).appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(e,t,n){for(let n=1;n<=this.elseifCount_;n++){let i,r;null==(i=e[n])||i.reconnect(this,"IF"+n),null==(r=t[n])||r.reconnect(this,"DO"+n)}null==n||n.reconnect(this,"ELSE")}};t.registerMutator$$module$build$src$core$extensions("controls_if_mutator",B,null,["controls_if_elseif","controls_if_else"]),t.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))});var $={onchange:function(e){this.prevBlocks_||(this.prevBlocks_=[null,null]);var n=this.getInputTargetBlock("A");const i=this.getInputTargetBlock("B");n&&i&&!this.workspace.connectionChecker.doTypeChecks(n.outputConnection,i.outputConnection)&&(t.setGroup$$module$build$src$core$events$utils(e.group),(e=this.prevBlocks_[0])!==n&&(n.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("A").connection.connect(e.outputConnection)),(n=this.prevBlocks_[1])!==i&&(i.unplug(),!n||n.isDisposed()||n.isShadow()||this.getInput("B").connection.connect(n.outputConnection)),this.bumpNeighbours(),t.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};t.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin($)});var U={prevParentConnection_:null,onchange:function(e){const n=this.getInputTargetBlock("THEN"),i=this.getInputTargetBlock("ELSE"),r=this.outputConnection.targetConnection;if((n||i)&&r)for(let s=0;s<2;s++){const o=1===s?n:i;o&&!o.workspace.connectionChecker.doTypeChecks(o.outputConnection,r)&&(t.setGroup$$module$build$src$core$events$utils(e.group),r===this.prevParentConnection_?(this.unplug(),r.getSourceBlock().bumpNeighbours()):(o.unplug(),o.bumpNeighbours()),t.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=r}};t.registerMixin$$module$build$src$core$extensions("logic_ternary",U),t.defineBlocks$$module$build$src$core$common(F);var V={blocks:F},H=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),G={init:function(){this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",String(this.itemCount_)),e},domToMutation:function(e){if(!(e=e.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(e,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("lists_create_with_container");t.initSvg();let n=t.getInput("STACK").connection;for(let t=0;t<this.itemCount_;t++){const t=e.newBlock("lists_create_with_item");if(t.initSvg(),!t.previousConnection)throw Error("itemBlock has no previousConnection");n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&!e.includes(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);let i;e.valueConnection_=null==(i=n)?void 0:i.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}};H.lists_create_with=G;var j={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};H.lists_create_with_container=j;var K={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};H.lists_create_with_item=K;var z={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(e,"END"),this.setInputsInline(!0),this.setTooltip(()=>t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}};H.lists_indexOf=z;var W={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(function(e){e="REMOVE"===e,this.getSourceBlock().updateStatement_(e)}),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){const t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!=("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let i="";switch(e+" "+n){case"GET FROM_START":case"GET FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(i+="  "+("FROM_START"===n?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i})},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("statement",String(!this.outputConnection));const n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("statement");this.updateStatement_(t),e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(e){e.isStatement?this.updateStatement_(!0):"string"==typeof e&&this.domToMutation(t.textToDom$$module$build$src$core$utils$xml(e))},updateStatement_:function(e){e!==!this.outputConnection&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};H.lists_getIndex=W;var q={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){const t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!=("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let i="";switch(e+" "+n){case"SET FROM_START":case"SET FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":i=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(i+="  "+t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i})},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}};H.lists_setIndex=q;var J={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);const e=e=>{const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});return n.setValidator(function(t){const n=this.getValue();(t="FROM_START"===t||"FROM_END"===t)!=("FROM_START"===n||"FROM_END"===n)&&this.getSourceBlock().updateAt_(e,t)}),n};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",String(n)),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};H.lists_getSublist=J,H.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},H.lists_split={init:function(){const e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!e)throw Error("field_dropdown not found");e.setValidator(e=>{this.updateType_(e)}),this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const e=this.getFieldValue("MODE");if("SPLIT"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)})},updateType_:function(e){if(this.getFieldValue("MODE")!==e){const e=this.getInput("INPUT").connection;e.setShadowDom(null);const t=e.targetBlock();t&&(e.disconnect(),t.isShadow()?t.dispose(!1):this.bumpNeighbours())}"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(e){this.updateType_(e.mode)}},t.defineBlocks$$module$build$src$core$common(H);var Y={blocks:H},X={blocks:Object.assign({},H,F,O,I,b,p,a,n),lists:Y,logic:V,loops:M,math:D,procedures:w,texts:y,variables:d,variablesDynamic:o};return X.__namespace__=t,X},"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],r):"object"==typeof n?t.exports=r(e("./blockly_compressed.js")):i.Blockly.libraryBlocks=r(i.Blockly)},{"./blockly_compressed.js":172}],175:[function(e,t,n){t.exports=e("./blockly_compressed.js")},{"./blockly_compressed.js":172}],176:[function(e,t,n){var i,r;i=this,r=function(e,t,n){return e.setLocale(t),e},"function"==typeof define&&define.amd?define(["blockly/core","blockly/msg/en","blockly/blocks"],r):"object"==typeof n?t.exports=r(e("blockly/core"),e("blockly/msg/en"),e("blockly/blocks")):i.Blockly=r(i.Blockly,i.Blockly.Msg,i.Blockly.Blocks)},{"blockly/blocks":173,"blockly/core":175,"blockly/msg/en":177}],177:[function(e,t,n){!function(e,i){if("function"==typeof define&&define.amd)define([],i);else if("object"==typeof n)t.exports=i();else{var r=i();for(var s in r)e.Blockly.Msg[s]=r[s]}}(this,function(){var e=e||{Msg:Object.create(null)};return e.Msg.ADD_COMMENT="Add Comment",e.Msg.ALT_KEY="Alt",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CHROME_OS="ChromeOS",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.CLOSE="Close",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.COMMAND_KEY=" Command",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.CONTROL_KEY="Ctrl",e.Msg.COPY_SHORTCUT="Copy",e.Msg.CUT_SHORTCUT="Cut",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DIALOG_CANCEL="Cancel",e.Msg.DIALOG_OK="OK",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",e.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",e.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",e.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",e.Msg.LINUX="Linux",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MAC_OS="macOS",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1  %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.MOVE_BLOCK="Move Block",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.OPTION_KEY=" Option",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PASTE_SHORTCUT="Paste",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",e.Msg.SHORTCUTS_EDITING="Editing",e.Msg.SHORTCUTS_GENERAL="General",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNKNOWN="Unknown",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",e.Msg.WINDOWS="Windows",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg})},{}]},{},[166]);